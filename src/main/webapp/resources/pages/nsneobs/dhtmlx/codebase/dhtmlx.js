/*
===================================================================
Copyright UAB Dinamenta. http://www.dhtmlx.com
This code is obfuscated and not allowed for any purposes except 
using on sites which belongs to UAB Dinamenta.

Please contact sales@dhtmlx.com to obtain necessary 
license for usage of dhtmlx components.
===================================================================
*/
//modify code by zzm 20160724
var _dhtmlx_global_quirks_static_value = 2;
var _dhtmlx_global_border_static_value = 0;

if (typeof(window.dhx4) == "undefined") {
	window.dhx4 = {
		version: "4.2",
		skin: null,
		skinDetect: function(a) {
			return {
				10: "dhx_skyblue",
				20: "dhx_web",
				30: "dhx_terrace"
			}[this.readFromCss(a + "_skin_detect")] || null
		},
		readFromCss: function(g, l) {
			var c = document.createElement("DIV");
			c.className = g;
			if (document.body.firstChild != null) {
				document.body.insertBefore(c, document.body.firstChild)
			} else {
				document.body.appendChild(c)
			}
			var a = c[l || "offsetWidth"];
			c.parentNode.removeChild(c);
			c = null;
			return a
		},
		lastId: 1,
		newId: function() {
			return this.lastId++
		},
		zim: {
			data: {},
			step: 5,
			first: function() {
				return 100
			},
			last: function() {
				var g = this.first();
				for (var c in this.data) {
					g = Math.max(g, this.data[c])
				}
				return g
			},
			reserve: function(a) {
				this.data[a] = this.last() + this.step;
				return this.data[a]
			},
			clear: function(a) {
				if (this.data[a] != null) {
					this.data[a] = null;
					delete this.data[a]
				}
			}
		},
		s2b: function(a) {
			if (typeof(a) == "string") {
				a = a.toLowerCase()
			}
			return (a == true || a == 1 || a == "true" || a == "1" || a == "yes" || a == "y")
		},
		s2j: function(s) {
			var obj = null;
			dhx4.temp = null;
			try {
				eval("dhx4.temp=" + s)
			} catch (e) {
				dhx4.temp = null
			}
			obj = dhx4.temp;
			dhx4.temp = null;
			return obj
		},
		absLeft: function(a) {
			if (typeof(a) == "string") {
				a = document.getElementById(a)
			}
			return this.getOffset(a).left
		},
		absTop: function(a) {
			if (typeof(a) == "string") {
				a = document.getElementById(a)
			}
			return this.getOffset(a).top
		},
		_aOfs: function(a) {
			var g = 0,
				c = 0;
			while (a) {
				g = g + parseInt(a.offsetTop);
				c = c + parseInt(a.offsetLeft);
				a = a.offsetParent
			}
			return {
				top: g,
				left: c
			}
		},
		_aOfsRect: function(l) {
			var o = l.getBoundingClientRect();
			var q = document.body;
			var c = document.documentElement;
			var a = window.pageYOffset || c.scrollTop || q.scrollTop;
			var m = window.pageXOffset || c.scrollLeft || q.scrollLeft;
			var n = c.clientTop || q.clientTop || 0;
			var r = c.clientLeft || q.clientLeft || 0;
			var s = o.top + a - n;
			var g = o.left + m - r;
			return {
				top: Math.round(s),
				left: Math.round(g)
			}
		},
		getOffset: function(a) {
			if (a.getBoundingClientRect) {
				return this._aOfsRect(a)
			} else {
				return this._aOfs(a)
			}
		},
		_isObj: function(a) {
			return (a != null && typeof(a) == "object" && typeof(a.length) == "undefined")
		},
		_copyObj: function(l) {
			if (this._isObj(l)) {
				var g = {};
				for (var c in l) {
					if (typeof(l[c]) == "object" && l[c] != null) {
						g[c] = this._copyObj(l[c])
					} else {
						g[c] = l[c]
					}
				}
			} else {
				var g = [];
				for (var c = 0; c < l.length; c++) {
					if (typeof(l[c]) == "object" && l[c] != null) {
						g[c] = this._copyObj(l[c])
					} else {
						g[c] = l[c]
					}
				}
			}
			return g
		},
		screenDim: function() {
			var a = (navigator.userAgent.indexOf("MSIE") >= 0);
			var c = {};
			c.left = document.body.scrollLeft;
			c.right = c.left + (window.innerWidth || document.body.clientWidth);
			c.top = Math.max((a ? document.documentElement : document.getElementsByTagName("html")[0]).scrollTop, document.body.scrollTop);
			c.bottom = c.top + (a ? Math.max(document.documentElement.clientHeight || 0, document.documentElement.offsetHeight || 0) : window.innerHeight);
			return c
		},
		selectTextRange: function(l, n, c) {
			l = (typeof(l) == "string" ? document.getElementById(l) : l);
			var a = l.value.length;
			n = Math.max(Math.min(n, a), 0);
			c = Math.min(c, a);
			if (l.setSelectionRange) {
				try {
					l.setSelectionRange(n, c)
				} catch (m) {}
			} else {
				if (l.createTextRange) {
					var g = l.createTextRange();
					g.moveStart("character", n);
					g.moveEnd("character", c - a);
					try {
						g.select()
					} catch (m) {}
				}
			}
		},
		transData: null,
		transDetect: function() {
			if (this.transData == null) {
				this.transData = {
					transProp: false,
					transEv: null
				};
				var g = {
					MozTransition: "transitionend",
					WebkitTransition: "webkitTransitionEnd",
					OTransition: "oTransitionEnd",
					msTransition: "transitionend",
					transition: "transitionend"
				};
				for (var c in g) {
					if (this.transData.transProp == false && document.documentElement.style[c] != null) {
						this.transData.transProp = c;
						this.transData.transEv = g[c]
					}
				}
				g = null
			}
			return this.transData
		},
		_xmlNodeValue: function(a) {
			var g = "";
			for (var c = 0; c < a.childNodes.length; c++) {
				g += (a.childNodes[c].nodeValue != null ? a.childNodes[c].nodeValue.toString().replace(/^[\n\r\s]{0,}/, "").replace(/[\n\r\s]{0,}$/, "") : "")
			}
			return g
		}
	};
	window.dhx4.isIE = (navigator.userAgent.indexOf("MSIE") >= 0 || navigator.userAgent.indexOf("Trident") >= 0);
	window.dhx4.isIE6 = (window.XMLHttpRequest == null && navigator.userAgent.indexOf("MSIE") >= 0);
	window.dhx4.isIE7 = (navigator.userAgent.indexOf("MSIE 7.0") >= 0 && navigator.userAgent.indexOf("Trident") < 0);
	window.dhx4.isIE8 = (navigator.userAgent.indexOf("MSIE 8.0") >= 0 && navigator.userAgent.indexOf("Trident") >= 0);
	window.dhx4.isOpera = (navigator.userAgent.indexOf("Opera") >= 0);
	window.dhx4.isChrome = (navigator.userAgent.indexOf("Chrome") >= 0);
	window.dhx4.isKHTML = (navigator.userAgent.indexOf("Safari") >= 0 || navigator.userAgent.indexOf("Konqueror") >= 0);
	window.dhx4.isFF = (navigator.userAgent.indexOf("Firefox") >= 0);
	window.dhx4.isIPad = (navigator.userAgent.search(/iPad/gi) >= 0)
}
if (typeof(window.dhx4.template) == "undefined") {
	window.dhx4.trim = function(a) {
		return String(a).replace(/^\s{1,}/, "").replace(/\s{1,}$/, "")
	};
	window.dhx4.template = function(c, g, a) {
		return c.replace(/#([a-z0-9_-]{1,})(\|([^#]*))?#/gi, function() {
			var o = arguments[1];
			var n = window.dhx4.trim(arguments[3]);
			var r = null;
			var m = [g[o]];
			if (n.length > 0) {
				n = n.split(":");
				var l = [];
				for (var s = 0; s < n.length; s++) {
					if (s > 0 && l[l.length - 1].match(/\\$/) != null) {
						l[l.length - 1] = l[l.length - 1].replace(/\\$/, "") + ":" + n[s]
					} else {
						l.push(n[s])
					}
				}
				r = l[0];
				for (var s = 1; s < l.length; s++) {
					m.push(l[s])
				}
			}
			if (typeof(r) == "string" && typeof(window.dhx4.template[r]) == "function") {
				return window.dhx4.template[r].apply(window.dhx4.template, m)
			}
			if (o.length > 0 && typeof(g[o]) != "undefined") {
				if (a == true) {
					return window.dhx4.trim(g[o])
				}
				return String(g[o])
			}
			return ""
		})
	};
	window.dhx4.template.date = function(a, c) {
		if (a != null) {
			if (a instanceof Date) {
				return window.dhx4.date2str(a, c)
			} else {
				a = a.toString();
				if (a.match(/^\d*$/) != null) {
					return window.dhx4.date2str(new Date(parseInt(a)), c)
				}
				return a
			}
		}
		return ""
	};
	window.dhx4.template.maxlength = function(c, a) {
		return String(c).substr(0, a)
	};
	window.dhx4.template.number_format = function(l, m, g, a) {
		var c = window.dhx4.template._parseFmt(m, g, a);
		if (c == false) {
			return l
		}
		return window.dhx4.template._getFmtValue(l, c)
	};
	window.dhx4.template.lowercase = function(a) {
		if (typeof(a) == "undefined" || a == null) {
			a = ""
		}
		return String(a).toLowerCase()
	};
	window.dhx4.template.uppercase = function(a) {
		if (typeof(a) == "undefined" || a == null) {
			a = ""
		}
		return String(a).toUpperCase()
	};
	window.dhx4.template._parseFmt = function(o, g, a) {
		var l = o.match(/^([^\.\,0-9]*)([0\.\,]*)([^\.\,0-9]*)/);
		if (l == null || l.length != 4) {
			return false
		}
		var c = {
			i_len: false,
			i_sep: (typeof(g) == "string" ? g : ","),
			d_len: false,
			d_sep: (typeof(a) == "string" ? a : "."),
			s_bef: (typeof(l[1]) == "string" ? l[1] : ""),
			s_aft: (typeof(l[3]) == "string" ? l[3] : "")
		};
		var n = l[2].split(".");
		if (n[1] != null) {
			c.d_len = n[1].length
		}
		var m = n[0].split(",");
		if (m.length > 1) {
			c.i_len = m[m.length - 1].length
		}
		return c
	};
	window.dhx4.template._getFmtValue = function(value, fmt) {
		var r = String(value).match(/^(-)?([0-9]{1,})(\.([0-9]{1,}))?$/);
		if (r != null && r.length == 5) {
			var v0 = "";
			if (r[1] != null) {
				v0 += r[1]
			}
			v0 += fmt.s_bef;
			if (fmt.i_len !== false) {
				var i = 0;
				var v1 = "";
				for (var q = r[2].length - 1; q >= 0; q--) {
					v1 = "" + r[2].charAt(q) + v1;
					if (++i == fmt.i_len && q > 0) {
						v1 = fmt.i_sep + v1;
						i = 0
					}
				}
				v0 += v1
			} else {
				v0 += r[2]
			}
			if (fmt.d_len !== false) {
				if (r[4] == null) {
					r[4] = ""
				}
				while (r[4].length < fmt.d_len) {
					r[4] += "0"
				}
				eval("dhx4.temp = new RegExp(/\\d{" + fmt.d_len + "}/);");
				var t1 = (r[4]).match(dhx4.temp);
				if (t1 != null) {
					v0 += fmt.d_sep + t1
				}
				dhx4.temp = t1 = null
			}
			v0 += fmt.s_aft;
			return v0
		}
		return value
	}
}
if (typeof(window.dhx4.dateLang) == "undefined") {
	window.dhx4.dateLang = "en";
	window.dhx4.dateStrings = {
		en: {
			monthFullName: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
			monthShortName: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
			dayFullName: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
			dayShortName: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"]
		}
	};
	window.dhx4.dateFormat = {
		en: "%Y-%m-%d"
	};
	window.dhx4.date2str = function(n, l, a) {
		if (l == null || typeof(l) == "undefnied") {
			l = window.dhx4.dateFormat[window.dhx4.dateLang]
		}
		if (a == null || typeof(a) == "undefnied") {
			a = window.dhx4.dateStrings[window.dhx4.dateLang]
		}
		if (n instanceof Date) {
			var m = function(o) {
				return (String(o).length == 1 ? "0" + String(o) : o)
			};
			var c = function(q) {
				switch (q) {
					case "%d":
						return m(n.getDate());
					case "%j":
						return n.getDate();
					case "%D":
						return a.dayShortName[n.getDay()];
					case "%l":
						return a.dayFullName[n.getDay()];
					case "%m":
						return m(n.getMonth() + 1);
					case "%n":
						return n.getMonth() + 1;
					case "%M":
						return a.monthShortName[n.getMonth()];
					case "%F":
						return a.monthFullName[n.getMonth()];
					case "%y":
						return m(n.getYear() % 100);
					case "%Y":
						return n.getFullYear();
					case "%g":
						return (n.getHours() + 11) % 12 + 1;
					case "%h":
						return m((n.getHours() + 11) % 12 + 1);
					case "%G":
						return n.getHours();
					case "%H":
						return m(n.getHours());
					case "%i":
						return m(n.getMinutes());
					case "%s":
						return m(n.getSeconds());
					case "%a":
						return (n.getHours() > 11 ? "pm" : "am");
					case "%A":
						return (n.getHours() > 11 ? "PM" : "AM");
					case "%%":
						return "%";
					case "%u":
						return n.getMilliseconds();
					case "%P":
						if (window.dhx4.temp_calendar != null && window.dhx4.temp_calendar.tz != null) {
							return window.dhx4.temp_calendar.tz
						}
						var s = n.getTimezoneOffset();
						var r = Math.abs(Math.floor(s / 60));
						var o = Math.abs(s) - r * 60;
						return (s > 0 ? "-" : "+") + m(r) + ":" + m(o);
					default:
						return q
				}
			};
			var g = String(l || window.dhx4.dateFormat).replace(/%[a-zA-Z]/g, c)
		}
		return (g || String(n))
	};
	window.dhx4.str2date = function(m, C, F) {
		if (C == null || typeof(C) == "undefnied") {
			C = window.dhx4.dateFormat[window.dhx4.dateLang]
		}
		if (F == null || typeof(F) == "undefnied") {
			F = window.dhx4.dateStrings[window.dhx4.dateLang]
		}
		C = C.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\\:|]/g, "\\$&");
		var E = [];
		var s = [];
		C = C.replace(/%[a-z]/gi, function(q) {
			switch (q) {
				case "%d":
				case "%m":
				case "%y":
				case "%h":
				case "%H":
				case "%i":
				case "%s":
					s.push(q);
					return "(\\d{2})";
				case "%D":
				case "%l":
				case "%M":
				case "%F":
					s.push(q);
					return "([a-zéûä\u0430-\u044F\u0451]{1,})";
				case "%j":
				case "%n":
				case "%g":
				case "%G":
					s.push(q);
					return "(\\d{1,2})";
				case "%Y":
					s.push(q);
					return "(\\d{4})";
				case "%a":
					s.push(q);
					return "([am|pm])";
				case "%A":
					s.push(q);
					return "([AM|PM])";
				case "%u":
					s.push(q);
					return "(\\d{1,6})";
				case "%P":
					s.push(q);
					return "([+-]\\d{1,2}:\\d{1,2})"
			}
			return q
		});
		var H = new RegExp(C, "i");
		var u = m.match(H);
		if (u == null || u.length - 1 != s.length) {
			return "Invalid Date"
		}
		for (var c = 1; c < u.length; c++) {
			E.push(u[c])
		}
		var g = {
			"%y": 1,
			"%Y": 1,
			"%n": 2,
			"%m": 2,
			"%M": 2,
			"%F": 2,
			"%d": 3,
			"%j": 3,
			"%a": 4,
			"%A": 4,
			"%H": 5,
			"%G": 5,
			"%h": 5,
			"%g": 5,
			"%i": 6,
			"%s": 7,
			"%u": 7,
			"%P": 7
		};
		var x = {};
		var o = {};
		for (var c = 0; c < s.length; c++) {
			if (typeof(g[s[c]]) != "undefined") {
				var l = g[s[c]];
				if (!x[l]) {
					x[l] = [];
					o[l] = []
				}
				x[l].push(E[c]);
				o[l].push(s[c])
			}
		}
		E = [];
		s = [];
		for (var c = 1; c <= 7; c++) {
			if (x[c] != null) {
				for (var A = 0; A < x[c].length; A++) {
					E.push(x[c][A]);
					s.push(o[c][A])
				}
			}
		}
		var a = new Date();
		a.setDate(1);
		a.setHours(0);
		a.setMinutes(0);
		a.setSeconds(0);
		a.setMilliseconds(0);
		var y = function(w, r) {
			for (var v = 0; v < r.length; v++) {
				if (r[v].toLowerCase() == w) {
					return v
				}
			}
			return -1
		};
		for (var c = 0; c < E.length; c++) {
			switch (s[c]) {
				case "%d":
				case "%j":
				case "%n":
				case "%m":
				case "%Y":
				case "%H":
				case "%G":
				case "%i":
				case "%s":
				case "%u":
					if (!isNaN(E[c])) {
						a[{
							"%d": "setDate",
							"%j": "setDate",
							"%n": "setMonth",
							"%m": "setMonth",
							"%Y": "setFullYear",
							"%H": "setHours",
							"%G": "setHours",
							"%i": "setMinutes",
							"%s": "setSeconds",
							"%u": "setMilliseconds"
						}[s[c]]](Number(E[c]) + (s[c] == "%m" || s[c] == "%n" ? -1 : 0))
					}
					break;
				case "%M":
				case "%F":
					var n = y(E[c].toLowerCase(), F[{
						"%M": "monthShortName",
						"%F": "monthFullName"
					}[s[c]]]);
					if (n >= 0) {
						a.setMonth(n)
					}
					break;
				case "%y":
					if (!isNaN(E[c])) {
						var D = Number(E[c]);
						a.setFullYear(D + (D > 50 ? 1900 : 2000))
					}
					break;
				case "%g":
				case "%h":
					if (!isNaN(E[c])) {
						var D = Number(E[c]);
						if (D <= 12 && D >= 0) {
							a.setHours(D + (y("pm", E) >= 0 ? (D == 12 ? 0 : 12) : (D == 12 ? -12 : 0)))
						}
					}
					break;
				case "%P":
					if (window.dhx4.temp_calendar != null) {
						window.dhx4.temp_calendar.tz = E[c]
					}
					break
			}
		}
		return a
	}
}
if (typeof(window.dhx4.ajax) == "undefined") {
	window.dhx4.ajax = {
		cache: false,
		method: "get",
		parse: function(a) {
			if (typeof a !== "string") {
				return a
			}
			a = a.replace(/^[\s]+/, "");
			if (window.DOMParser && !dhx4.isIE) {
				var c = (new window.DOMParser()).parseFromString(a, "text/xml")
			} else {
				if (window.ActiveXObject !== window.undefined) {
					var c = new window.ActiveXObject("Microsoft.XMLDOM");
					c.async = "false";
					c.loadXML(a)
				}
			}
			return c
		},
		xmltop: function(a, l, g) {
			if (typeof l.status == "undefined" || l.status < 400) {
				xml = (!l.responseXML) ? dhx4.ajax.parse(l.responseText || l) : (l.responseXML || l);
				if (xml && xml.documentElement !== null) {
					try {
						if (!xml.getElementsByTagName("parsererror").length) {
							return xml.getElementsByTagName(a)[0]
						}
					} catch (c) {}
				}
			}
			if (g !== -1) {
				dhx4.callEvent("onLoadXMLError", ["Incorrect XML", arguments[1], g])
			}
			return document.createElement("DIV")
		},
		xpath: function(g, a) {
			if (!a.nodeName) {
				a = a.responseXML || a
			}
			if (dhx4.isIE) {
				try {
					return a.selectNodes(g) || []
				} catch (m) {
					return []
				}
			} else {
				var l = [];
				var n;
				var c = (a.ownerDocument || a).evaluate(g, a, null, XPathResult.ANY_TYPE, null);
				while (n = c.iterateNext()) {
					l.push(n)
				}
				return l
			}
		},
		query: function(a) {
			dhx4.ajax._call((a.method || "GET"), a.url, a.data || "", (a.async || true), a.callback, null, a.headers)
		},
		get: function(a, c) {
			return this._call("GET", a, null, true, c)
		},
		getSync: function(a) {
			return this._call("GET", a, null, false)
		},
		put: function(c, a, g) {
			return this._call("PUT", c, a, true, g)
		},
		del: function(c, a, g) {
			return this._call("DELETE", c, a, true, g)
		},
		post: function(c, a, g) {
			if (arguments.length == 1) {
				a = ""
			} else {
				if (arguments.length == 2 && (typeof(a) == "function" || typeof(window[a]) == "function")) {
					g = a;
					a = ""
				} else {
					a = String(a)
				}
			}
			return this._call("POST", c, a, true, g)
		},
		postSync: function(c, a) {
			a = (a == null ? "" : String(a));
			return this._call("POST", c, a, false)
		},
		getLong: function(a, c) {
			this._call("GET", a, null, true, c, {
				url: a
			})
		},
		postLong: function(c, a, g) {
			if (arguments.length == 2 && (typeof(a) == "function" || typeof(window[a]))) {
				g = a;
				a = ""
			}
			this._call("POST", c, a, true, g, {
				url: c,
				postData: a
			})
		},
		_call: function(a, c, g, m, o, s, l) {
			var r = (window.XMLHttpRequest && !dhx4.isIE ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP"));
			var n = (navigator.userAgent.match(/AppleWebKit/) != null && navigator.userAgent.match(/Qt/) != null && navigator.userAgent.match(/Safari/) != null);
			if (m == true) {
				r.onreadystatechange = function() {
					if ((r.readyState == 4) || (n == true && r.readyState == 3)) {
						if (r.status != 200 || r.responseText == "") {
							if (!dhx4.callEvent("onAjaxError", [r])) {
								return
							}
						}
						window.setTimeout(function() {
							if (typeof(o) == "function") {
								o.apply(window, [{
									xmlDoc: r,
									filePath: c,
									async: m
								}])
							}
							if (s != null) {
								if (typeof(s.postData) != "undefined") {
									dhx4.ajax.postLong(s.url, s.postData, o)
								} else {
									dhx4.ajax.getLong(s.url, o)
								}
							}
							o = null;
							r = null
						}, 1)
					}
				}
			}
			if (a == "GET" && this.cache != true) {
				c += (c.indexOf("?") >= 0 ? "&" : "?") + "dhxr" + new Date().getTime() + "=1"
			}
			r.open(a, c, m);
			if (l != null) {
				for (var q in l) {
					r.setRequestHeader(q, l[q])
				}
			} else {
				if (a == "POST" || a == "PUT" || a == "DELETE") {
					r.setRequestHeader("Content-Type", "application/x-www-form-urlencoded")
				} else {
					if (a == "GET") {
						g = null
					}
				}
			}
			r.setRequestHeader("X-Requested-With", "XMLHttpRequest");
			r.send(g);
			return {
				xmlDoc: r,
				filePath: c,
				async: m
			}
		}
	}
}
if (typeof(window.dhx4._enableDataLoading) == "undefined") {
	window.dhx4._enableDataLoading = function(o, g, n, m, q) {
		if (q == "clear") {
			for (var c in o._dhxdataload) {
				o._dhxdataload[c] = null;
				delete o._dhxdataload[c]
			}
			o._loadData = null;
			o._dhxdataload = null;
			o.load = null;
			o.loadStruct = null;
			o = null;
			return
		}
		o._dhxdataload = {
			initObj: g,
			xmlToJson: n,
			xmlRootTag: m,
			onBeforeXLS: null
		};
		o._loadData = function(w, x, y) {
			if (arguments.length == 2) {
				y = x;
				x = null
			}
			var v = null;
			if (arguments.length == 3) {
				y = arguments[2]
			}
			if (typeof(w) == "string") {
				var u = w.replace(/^\s{1,}/, "").replace(/\s{1,}$/, "");
				var D = new RegExp("^<" + this._dhxdataload.xmlRootTag);
				if (D.test(u.replace(/^<\?xml[^\?]*\?>\s*/, ""))) {
					v = dhx4.ajax.parse(w);
					if (v != null) {
						v = this[this._dhxdataload.xmlToJson].apply(this, [v])
					}
				}
				if (v == null && (u.match(/^\{.*\}$/) != null || u.match(/^\[.*\]$/) != null)) {
					v = dhx4.s2j(u)
				}
				if (v == null) {
					this.callEvent("onXLS", []);
					var s = [];
					if (typeof(this._dhxdataload.onBeforeXLS) == "function") {
						var u = this._dhxdataload.onBeforeXLS.apply(this, [w]);
						if (u != null && typeof(u) == "object") {
							if (u.url != null) {
								w = u.url
							}
							if (u.params != null) {
								for (var A in u.params) {
									s.push(A + "=" + encodeURIComponent(u.params[A]))
								}
							}
						}
					}
					var C = this;
					var r = function(a) {
						var E = null;
						if ((a.xmlDoc.getResponseHeader("Content-Type") || "").search(/xml/gi) >= 0 || (a.xmlDoc.responseText.replace(/^\s{1,}/, "")).match(/^</) != null) {
							E = C[C._dhxdataload.xmlToJson].apply(C, [a.xmlDoc.responseXML])
						} else {
							E = dhx4.s2j(a.xmlDoc.responseText)
						}
						if (E != null) {
							C[C._dhxdataload.initObj].apply(C, [E, w])
						}
						C.callEvent("onXLE", []);
						if (y != null) {
							if (typeof(y) == "function") {
								y.apply(C, [])
							} else {
								if (typeof(window[y]) == "function") {
									window[y].apply(C, [])
								}
							}
						}
						r = y = null;
						E = a = C = null
					};
					s = s.join("&") + (typeof(x) == "string" ? "&" + x : "");
					if (dhx4.ajax.method == "post") {
						dhx4.ajax.post(w, s, r)
					} else {
						if (dhx4.ajax.method == "get") {
							dhx4.ajax.get(w + (s.length > 0 ? (w.indexOf("?") > 0 ? "&" : "?") + s : ""), r)
						}
					}
					return
				}
			} else {
				if (typeof(w.documentElement) == "object" || (typeof(w.tagName) != "undefined" && typeof(w.getElementsByTagName) != "undefined" && w.getElementsByTagName(this._dhxdataload.xmlRootTag).length > 0)) {
					v = this[this._dhxdataload.xmlToJson].apply(this, [w])
				} else {
					v = window.dhx4._copyObj(w)
				}
			}
			if (v != null) {
				this[this._dhxdataload.initObj].apply(this, [v])
			}
			if (y != null) {
				if (typeof(y) == "function") {
					y.apply(this, [])
				} else {
					if (typeof(window[y]) == "function") {
						window[y].apply(this, [])
					}
				}
				y = null
			}
		};
		if (q != null) {
			var l = {
				struct: "loadStruct",
				data: "load"
			};
			for (var c in q) {
				if (q[c] == true) {
					o[l[c]] = function() {
						return this._loadData.apply(this, arguments)
					}
				}
			}
		}
		o = null
	}
}
if (typeof(window.dhx4._eventable) == "undefined") {
	window.dhx4._eventable = function(a, c) {
		if (c == "clear") {
			a.detachAllEvents();
			a.dhxevs = null;
			a.attachEvent = null;
			a.detachEvent = null;
			a.checkEvent = null;
			a.callEvent = null;
			a.detachAllEvents = null;
			a = null;
			return
		}
		a.dhxevs = {
			data: {}
		};
		a.attachEvent = function(g, m) {
			g = String(g).toLowerCase();
			if (!this.dhxevs.data[g]) {
				this.dhxevs.data[g] = {}
			}
			var l = window.dhx4.newId();
			this.dhxevs.data[g][l] = m;
			return l
		};
		a.detachEvent = function(n) {
			for (var l in this.dhxevs.data) {
				var m = 0;
				for (var g in this.dhxevs.data[l]) {
					if (g == n) {
						this.dhxevs.data[l][g] = null;
						delete this.dhxevs.data[l][g]
					} else {
						m++
					}
				}
				if (m == 0) {
					this.dhxevs.data[l] = null;
					delete this.dhxevs.data[l]
				}
			}
		};
		a.checkEvent = function(g) {
			g = String(g).toLowerCase();
			return (this.dhxevs.data[g] != null)
		};
		a.callEvent = function(l, n) {
			l = String(l).toLowerCase();
			if (this.dhxevs.data[l] == null) {
				return true
			}
			var m = true;
			for (var g in this.dhxevs.data[l]) {
				m = this.dhxevs.data[l][g].apply(this, n) && m
			}
			return m
		};
		a.detachAllEvents = function() {
			for (var l in this.dhxevs.data) {
				for (var g in this.dhxevs.data[l]) {
					this.dhxevs.data[l][g] = null;
					delete this.dhxevs.data[l][g]
				}
				this.dhxevs.data[l] = null;
				delete this.dhxevs.data[l]
			}
		};
		a = null
	};
	dhx4._eventable(dhx4)
}
if (!window.dhtmlxValidation) {
	dhtmlxValidation = function() {};
	dhtmlxValidation.prototype = {
		isEmpty: function(a) {
			return a == ""
		},
		isNotEmpty: function(a) {
			return (a instanceof Array ? a.length > 0 : !a == "")
		},
		isValidBoolean: function(a) {
			return !!a.toString().match(/^(0|1|true|false)$/)
		},
		isValidEmail: function(a) {
			return !!a.toString().match(/(^[a-z0-9]([0-9a-z\-_\.]*)@([0-9a-z_\-\.]*)([.][a-z]{3})$)|(^[a-z]([0-9a-z_\.\-]*)@([0-9a-z_\-\.]*)(\.[a-z]{2,4})$)/i)
		},
		isValidInteger: function(a) {
			return !!a.toString().match(/(^-?\d+$)/)
		},
		isValidNumeric: function(a) {
			return !!a.toString().match(/(^-?\d\d*[\.|,]\d*$)|(^-?\d\d*$)|(^-?[\.|,]\d\d*$)/)
		},
		isValidAplhaNumeric: function(a) {
			return !!a.toString().match(/^[_\-a-z0-9]+$/gi)
		},
		isValidDatetime: function(c) {
			var a = c.toString().match(/^(\d{4})-(\d{2})-(\d{2})\s(\d{2}):(\d{2}):(\d{2})$/);
			return a && !!(a[1] <= 9999 && a[2] <= 12 && a[3] <= 31 && a[4] <= 59 && a[5] <= 59 && a[6] <= 59) || false
		},
		isValidDate: function(a) {
			var c = a.toString().match(/^(\d{4})-(\d{2})-(\d{2})$/);
			return c && !!(c[1] <= 9999 && c[2] <= 12 && c[3] <= 31) || false
		},
		isValidTime: function(c) {
			var a = c.toString().match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/);
			return a && !!(a[1] <= 24 && a[2] <= 59 && a[3] <= 59) || false
		},
		isValidIPv4: function(a) {
			var c = a.toString().match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);
			return c && !!(c[1] <= 255 && c[2] <= 255 && c[3] <= 255 && c[4] <= 255) || false
		},
		isValidCurrency: function(a) {
			return a.toString().match(/^\$?\s?\d+?([\.,\,]?\d+)?\s?\$?$/) && true || false
		},
		isValidSSN: function(a) {
			return a.toString().match(/^\d{3}\-?\d{2}\-?\d{4}$/) && true || false
		},
		isValidSIN: function(a) {
			return a.toString().match(/^\d{9}$/) && true || false
		}
	};
	dhtmlxValidation = new dhtmlxValidation()
}
if (typeof(window.dhtmlx) == "undefined") {
	window.dhtmlx = {
		extend: function(g, c) {
			for (var l in c) {
				if (!g[l]) {
					g[l] = c[l]
				}
			}
			return g
		},
		extend_api: function(a, l, g) {
			var c = window[a];
			if (!c) {
				return
			}
			window[a] = function(o) {
				if (o && typeof o == "object" && !o.tagName) {
					var n = c.apply(this, (l._init ? l._init(o) : arguments));
					for (var m in dhtmlx) {
						if (l[m]) {
							this[l[m]](dhtmlx[m])
						}
					}
					for (var m in o) {
						if (l[m]) {
							this[l[m]](o[m])
						} else {
							if (m.indexOf("on") === 0) {
								this.attachEvent(m, o[m])
							}
						}
					}
				} else {
					var n = c.apply(this, arguments)
				}
				if (l._patch) {
					l._patch(this)
				}
				return n || this
			};
			window[a].prototype = c.prototype;
			if (g) {
				dhtmlx.extend(window[a].prototype, g)
			}
		},
		url: function(a) {
			if (a.indexOf("?") != -1) {
				return "&"
			} else {
				return "?"
			}
		}
	}
}

function dhtmlDragAndDropObject() {
	if (window.dhtmlDragAndDrop) {
		return window.dhtmlDragAndDrop
	}
	this.lastLanding = 0;
	this.dragNode = 0;
	this.dragStartNode = 0;
	this.dragStartObject = 0;
	this.tempDOMU = null;
	this.tempDOMM = null;
	this.waitDrag = 0;
	window.dhtmlDragAndDrop = this;
	return this
}
dhtmlDragAndDropObject.prototype.removeDraggableItem = function(a) {
	a.onmousedown = null;
	a.dragStarter = null;
	a.dragLanding = null
};
dhtmlDragAndDropObject.prototype.addDraggableItem = function(a, c) {
	a.onmousedown = this.preCreateDragCopy;
	a.dragStarter = c;
	this.addDragLanding(a, c)
};
dhtmlDragAndDropObject.prototype.addDragLanding = function(a, c) {
	a.dragLanding = c
};
dhtmlDragAndDropObject.prototype.preCreateDragCopy = function(a) {
	if ((a || window.event) && (a || event).button == 2) {
		return
	}
	if (window.dhtmlDragAndDrop.waitDrag) {
		window.dhtmlDragAndDrop.waitDrag = 0;
		document.body.onmouseup = window.dhtmlDragAndDrop.tempDOMU;
		document.body.onmousemove = window.dhtmlDragAndDrop.tempDOMM;
		return false
	}
	if (window.dhtmlDragAndDrop.dragNode) {
		window.dhtmlDragAndDrop.stopDrag(a)
	}
	window.dhtmlDragAndDrop.waitDrag = 1;
	window.dhtmlDragAndDrop.tempDOMU = document.body.onmouseup;
	window.dhtmlDragAndDrop.tempDOMM = document.body.onmousemove;
	window.dhtmlDragAndDrop.dragStartNode = this;
	window.dhtmlDragAndDrop.dragStartObject = this.dragStarter;
	document.body.onmouseup = window.dhtmlDragAndDrop.preCreateDragCopy;
	document.body.onmousemove = window.dhtmlDragAndDrop.callDrag;
	window.dhtmlDragAndDrop.downtime = new Date().valueOf();
	if ((a) && (a.preventDefault)) {
		a.preventDefault();
		return false
	}
	return false
};
dhtmlDragAndDropObject.prototype.callDrag = function(g) {
	if (!g) {
		g = window.event
	}
	dragger = window.dhtmlDragAndDrop;
	if ((new Date()).valueOf() - dragger.downtime < 100) {
		return
	}
	if (!dragger.dragNode) {
		if (dragger.waitDrag) {
			dragger.dragNode = dragger.dragStartObject._createDragNode(dragger.dragStartNode, g);
			if (!dragger.dragNode) {
				return dragger.stopDrag()
			}
			dragger.dragNode.onselectstart = function() {
				return false
			};
			dragger.gldragNode = dragger.dragNode;
			document.body.appendChild(dragger.dragNode);
			document.body.onmouseup = dragger.stopDrag;
			dragger.waitDrag = 0;
			dragger.dragNode.pWindow = window;
			dragger.initFrameRoute()
		} else {
			return dragger.stopDrag(g, true)
		}
	}
	if (dragger.dragNode.parentNode != window.document.body && dragger.gldragNode) {
		var a = dragger.gldragNode;
		if (dragger.gldragNode.old) {
			a = dragger.gldragNode.old
		}
		a.parentNode.removeChild(a);
		var c = dragger.dragNode.pWindow;
		if (a.pWindow && a.pWindow.dhtmlDragAndDrop.lastLanding) {
			a.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(a.pWindow.dhtmlDragAndDrop.lastLanding)
		}
		if (_isIE) {
			var m = document.createElement("Div");
			m.innerHTML = dragger.dragNode.outerHTML;
			dragger.dragNode = m.childNodes[0]
		} else {
			dragger.dragNode = dragger.dragNode.cloneNode(true)
		}
		dragger.dragNode.pWindow = window;
		dragger.gldragNode.old = dragger.dragNode;
		document.body.appendChild(dragger.dragNode);
		c.dhtmlDragAndDrop.dragNode = dragger.dragNode
	}
	dragger.dragNode.style.left = g.clientX + 15 + (dragger.fx ? dragger.fx * (-1) : 0) + (document.body.scrollLeft || document.documentElement.scrollLeft) + "px";
	dragger.dragNode.style.top = g.clientY + 3 + (dragger.fy ? dragger.fy * (-1) : 0) + (document.body.scrollTop || document.documentElement.scrollTop) + "px";
	if (!g.srcElement) {
		var l = g.target
	} else {
		l = g.srcElement
	}
	dragger.checkLanding(l, g)
};
dhtmlDragAndDropObject.prototype.calculateFramePosition = function(m) {
	if (window.name) {
		var g = parent.frames[window.name].frameElement.offsetParent;
		var l = 0;
		var c = 0;
		while (g) {
			l += g.offsetLeft;
			c += g.offsetTop;
			g = g.offsetParent
		}
		if ((parent.dhtmlDragAndDrop)) {
			var a = parent.dhtmlDragAndDrop.calculateFramePosition(1);
			l += a.split("_")[0] * 1;
			c += a.split("_")[1] * 1
		}
		if (m) {
			return l + "_" + c
		} else {
			this.fx = l
		}
		this.fy = c
	}
	return "0_0"
};
dhtmlDragAndDropObject.prototype.checkLanding = function(c, a) {
	if ((c) && (c.dragLanding)) {
		if (this.lastLanding) {
			this.lastLanding.dragLanding._dragOut(this.lastLanding)
		}
		this.lastLanding = c;
		this.lastLanding = this.lastLanding.dragLanding._dragIn(this.lastLanding, this.dragStartNode, a.clientX, a.clientY, a);
		this.lastLanding_scr = (_isIE ? a.srcElement : a.target)
	} else {
		if ((c) && (c.tagName != "BODY")) {
			this.checkLanding(c.parentNode, a)
		} else {
			if (this.lastLanding) {
				this.lastLanding.dragLanding._dragOut(this.lastLanding, a.clientX, a.clientY, a)
			}
			this.lastLanding = 0;
			if (this._onNotFound) {
				this._onNotFound()
			}
		}
	}
};
dhtmlDragAndDropObject.prototype.stopDrag = function(c, g) {
	dragger = window.dhtmlDragAndDrop;
	if (!g) {
		dragger.stopFrameRoute();
		var a = dragger.lastLanding;
		dragger.lastLanding = null;
		if (a) {
			a.dragLanding._drag(dragger.dragStartNode, dragger.dragStartObject, a, (_isIE ? event.srcElement : c.target))
		}
	}
	dragger.lastLanding = null;
	if ((dragger.dragNode) && (dragger.dragNode.parentNode == document.body)) {
		dragger.dragNode.parentNode.removeChild(dragger.dragNode)
	}
	dragger.dragNode = 0;
	dragger.gldragNode = 0;
	dragger.fx = 0;
	dragger.fy = 0;
	dragger.dragStartNode = 0;
	dragger.dragStartObject = 0;
	document.body.onmouseup = dragger.tempDOMU;
	document.body.onmousemove = dragger.tempDOMM;
	dragger.tempDOMU = null;
	dragger.tempDOMM = null;
	dragger.waitDrag = 0
};
dhtmlDragAndDropObject.prototype.stopFrameRoute = function(g) {
	if (g) {
		window.dhtmlDragAndDrop.stopDrag(1, 1)
	}
	for (var a = 0; a < window.frames.length; a++) {
		try {
			if ((window.frames[a] != g) && (window.frames[a].dhtmlDragAndDrop)) {
				window.frames[a].dhtmlDragAndDrop.stopFrameRoute(window)
			}
		} catch (c) {}
	}
	try {
		if ((parent.dhtmlDragAndDrop) && (parent != window) && (parent != g)) {
			parent.dhtmlDragAndDrop.stopFrameRoute(window)
		}
	} catch (c) {}
};
dhtmlDragAndDropObject.prototype.initFrameRoute = function(g, l) {
	if (g) {
		window.dhtmlDragAndDrop.preCreateDragCopy();
		window.dhtmlDragAndDrop.dragStartNode = g.dhtmlDragAndDrop.dragStartNode;
		window.dhtmlDragAndDrop.dragStartObject = g.dhtmlDragAndDrop.dragStartObject;
		window.dhtmlDragAndDrop.dragNode = g.dhtmlDragAndDrop.dragNode;
		window.dhtmlDragAndDrop.gldragNode = g.dhtmlDragAndDrop.dragNode;
		window.document.body.onmouseup = window.dhtmlDragAndDrop.stopDrag;
		window.waitDrag = 0;
		if (((!_isIE) && (l)) && ((!_isFF) || (_FFrv < 1.8))) {
			window.dhtmlDragAndDrop.calculateFramePosition()
		}
	}
	try {
		if ((parent.dhtmlDragAndDrop) && (parent != window) && (parent != g)) {
			parent.dhtmlDragAndDrop.initFrameRoute(window)
		}
	} catch (c) {}
	for (var a = 0; a < window.frames.length; a++) {
		try {
			if ((window.frames[a] != g) && (window.frames[a].dhtmlDragAndDrop)) {
				window.frames[a].dhtmlDragAndDrop.initFrameRoute(window, ((!g || l) ? 1 : 0))
			}
		} catch (c) {}
	}
};
_isFF = false;
_isIE = false;
_isOpera = false;
_isKHTML = false;
_isMacOS = false;
_isChrome = false;
_FFrv = false;
_KHTMLrv = false;
_OperaRv = false;
if (navigator.userAgent.indexOf("Macintosh") != -1) {
	_isMacOS = true
}
if (navigator.userAgent.toLowerCase().indexOf("chrome") > -1) {
	_isChrome = true
}
if ((navigator.userAgent.indexOf("Safari") != -1) || (navigator.userAgent.indexOf("Konqueror") != -1)) {
	_KHTMLrv = parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari") + 7, 5));
	if (_KHTMLrv > 525) {
		_isFF = true;
		_FFrv = 1.9
	} else {
		_isKHTML = true
	}
} else {
	if (navigator.userAgent.indexOf("Opera") != -1) {
		_isOpera = true;
		_OperaRv = parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera") + 6, 3))
	} else {
		if (navigator.appName.indexOf("Microsoft") != -1) {
			_isIE = true;
			if ((navigator.appVersion.indexOf("MSIE 8.0") != -1 || navigator.appVersion.indexOf("MSIE 9.0") != -1 || navigator.appVersion.indexOf("MSIE 10.0") != -1 || document.documentMode > 7) && document.compatMode != "BackCompat") {
				_isIE = 8
			}
		} else {
			if (navigator.appName == "Netscape" && navigator.userAgent.indexOf("Trident") != -1) {
				_isIE = 8
			} else {
				_isFF = true;
				_FFrv = parseFloat(navigator.userAgent.split("rv:")[1])
			}
		}
	}
}
if (typeof(window.dhtmlxEvent) == "undefined") {
	function dhtmlxEvent(c, g, a) {
		if (c.addEventListener) {
			c.addEventListener(g, a, false)
		} else {
			if (c.attachEvent) {
				c.attachEvent("on" + g, a)
			}
		}
	}
}
if (dhtmlxEvent.touchDelay == null) {
	dhtmlxEvent.touchDelay = 2000
}
if (typeof(dhtmlxEvent.initTouch) == "undefined") {
	dhtmlxEvent.initTouch = function() {
		var l;
		var m;
		var c, a;
		dhtmlxEvent(document.body, "touchstart", function(n) {
			m = n.touches[0].target;
			c = n.touches[0].clientX;
			a = n.touches[0].clientY;
			l = window.setTimeout(g, dhtmlxEvent.touchDelay)
		});

		function g() {
			if (m) {
				var n = document.createEvent("HTMLEvents");
				n.initEvent("dblclick", true, true);
				m.dispatchEvent(n);
				l = m = null
			}
		}
		dhtmlxEvent(document.body, "touchmove", function(n) {
			if (l) {
				if (Math.abs(n.touches[0].clientX - c) > 50 || Math.abs(n.touches[0].clientY - a) > 50) {
					window.clearTimeout(l);
					l = m = false
				}
			}
		});
		dhtmlxEvent(document.body, "touchend", function(n) {
			if (l) {
				window.clearTimeout(l);
				l = m = false
			}
		});
		dhtmlxEvent.initTouch = function() {}
	}
}
if (!window.dhtmlx) {
	dhtmlx = {}
}
dhtmlx.assert = function(c, a) {
	if (!c) {
		dhtmlx.error(a)
	}
};
dhtmlx.assert_enabled = function() {
	return false
};
dhtmlx.assert_event = function(n, g) {
	if (!n._event_check) {
		n._event_check = {};
		n._event_check_size = {}
	}
	for (var c in g) {
		n._event_check[c.toLowerCase()] = g[c];
		var m = -1;
		for (var l in g[c]) {
			m++
		}
		n._event_check_size[c.toLowerCase()] = m
	}
};
dhtmlx.assert_method_info = function(m, c, l, n) {
	var a = [];
	for (var g = 0; g < n.length; g++) {
		a.push(n[g][0] + " : " + n[g][1] + "\n   " + n[g][2].describe() + (n[g][3] ? "; optional" : ""))
	}
	return m.name + "." + c + "\n" + l + "\n Arguments:\n - " + a.join("\n - ")
};
dhtmlx.assert_method = function(g, a) {
	for (var c in a) {
		dhtmlx.assert_method_process(g, c, a[c].descr, a[c].args, (a[c].min || 99), a[c].skip)
	}
};
dhtmlx.assert_method_process = function(n, c, m, o, g, l) {
	var a = n[c];
	if (!l) {
		n[c] = function() {
			if (arguments.length != o.length && arguments.length < g) {
				dhtmlx.log("warn", "Incorrect count of parameters\n" + n[c].describe() + "\n\nExpecting " + o.length + " but have only " + arguments.length)
			} else {
				for (var q = 0; q < o.length; q++) {
					if (!o[q][3] && !o[q][2](arguments[q])) {
						dhtmlx.log("warn", "Incorrect method call\n" + n[c].describe() + "\n\nActual value of " + (q + 1) + " parameter: {" + (typeof arguments[q]) + "} " + arguments[q])
					}
				}
			}
			return a.apply(this, arguments)
		}
	}
	n[c].describe = function() {
		return dhtmlx.assert_method_info(n, c, m, o)
	}
};
dhtmlx.assert_event_call = function(g, c, a) {
	if (g._event_check) {
		if (!g._event_check[c]) {
			dhtmlx.log("warn", "Not expected event call :" + c)
		} else {
			if (dhtmlx.isNotDefined(a)) {
				dhtmlx.log("warn", "Event without parameters :" + c)
			} else {
				if (g._event_check_size[c] != a.length) {
					dhtmlx.log("warn", "Incorrect event call, expected " + g._event_check_size[c] + " parameter(s), but have " + a.length + " parameter(s), for " + c + " event")
				}
			}
		}
	}
};
dhtmlx.assert_event_attach = function(c, a) {
	if (c._event_check && !c._event_check[a]) {
		dhtmlx.log("warn", "Unknown event name: " + a)
	}
};
dhtmlx.assert_property = function(c, a) {
	if (!c._settings_check) {
		c._settings_check = {}
	}
	dhtmlx.extend(c._settings_check, a)
};
dhtmlx.assert_check = function(g, c) {
	if (typeof g == "object") {
		for (var a in g) {
			dhtmlx.assert_settings(a, g[a], c)
		}
	}
};
dhtmlx.assert_settings = function(q, m, l) {
	l = l || this._settings_check;
	if (l) {
		if (!l[q]) {
			return dhtmlx.log("warn", "Unknown propery: " + q)
		}
		var o = "";
		var c = "";
		var a = false;
		for (var g = 0; g < l[q].length; g++) {
			var n = l[q][g];
			if (typeof n == "string") {
				continue
			}
			if (typeof n == "function") {
				a = a || n(m)
			} else {
				if (typeof n == "object" && typeof n[1] == "function") {
					a = a || n[1](m);
					if (a && n[2]) {
						dhtmlx.assert_check(m, n[2])
					}
				}
			}
			if (a) {
				break
			}
		}
		if (!a) {
			dhtmlx.log("warn", "Invalid configuration\n" + dhtmlx.assert_info(q, l) + "\nActual value: {" + (typeof m) + "} " + m)
		}
	}
};
dhtmlx.assert_info = function(c, n) {
	var a = n[c];
	var m = "";
	var l = [];
	for (var g = 0; g < a.length; g++) {
		if (typeof rule == "string") {
			m = a[g]
		} else {
			if (a[g].describe) {
				l.push(a[g].describe())
			} else {
				if (a[g][1] && a[g][1].describe) {
					l.push(a[g][1].describe())
				}
			}
		}
	}
	return "Property: " + c + ", " + m + " \nExpected value: \n - " + l.join("\n - ")
};
if (dhtmlx.assert_enabled()) {
	dhtmlx.assert_rule_color = function(a) {
		if (typeof a != "string") {
			return false
		}
		if (a.indexOf("#") !== 0) {
			return false
		}
		if (a.substr(1).replace(/[0-9A-F]/gi, "") !== "") {
			return false
		}
		return true
	};
	dhtmlx.assert_rule_color.describe = function() {
		return "{String} Value must start from # and contain hexadecimal code of color"
	};
	dhtmlx.assert_rule_template = function(a) {
		if (typeof a == "function") {
			return true
		}
		if (typeof a == "string") {
			return true
		}
		return false
	};
	dhtmlx.assert_rule_template.describe = function() {
		return "{Function},{String} Value must be a function which accepts data object and return text string, or a sting with optional template markers"
	};
	dhtmlx.assert_rule_boolean = function(a) {
		if (typeof a == "boolean") {
			return true
		}
		return false
	};
	dhtmlx.assert_rule_boolean.describe = function() {
		return "{Boolean} true or false"
	};
	dhtmlx.assert_rule_object = function(a, c) {
		if (typeof a == "object") {
			return true
		}
		return false
	};
	dhtmlx.assert_rule_object.describe = function() {
		return "{Object} Configuration object"
	};
	dhtmlx.assert_rule_string = function(a) {
		if (typeof a == "string") {
			return true
		}
		return false
	};
	dhtmlx.assert_rule_string.describe = function() {
		return "{String} Plain string"
	};
	dhtmlx.assert_rule_htmlpt = function(a) {
		return !!dhtmlx.toNode(a)
	};
	dhtmlx.assert_rule_htmlpt.describe = function() {
		return "{Object},{String} HTML node or ID of HTML Node"
	};
	dhtmlx.assert_rule_notdocumented = function(a) {
		return false
	};
	dhtmlx.assert_rule_notdocumented.describe = function() {
		return "This options wasn't documented"
	};
	dhtmlx.assert_rule_key = function(c) {
		var a = function(g) {
			return c[g]
		};
		a.describe = function() {
			var l = [];
			for (var g in c) {
				l.push(g)
			}
			return "{String} can take one of next values: " + l.join(", ")
		};
		return a
	};
	dhtmlx.assert_rule_dimension = function(a) {
		if (a * 1 == a && !isNaN(a) && a >= 0) {
			return true
		}
		return false
	};
	dhtmlx.assert_rule_dimension.describe = function() {
		return "{Integer} value must be a positive number"
	};
	dhtmlx.assert_rule_number = function(a) {
		if (typeof a == "number") {
			return true
		}
		return false
	};
	dhtmlx.assert_rule_number.describe = function() {
		return "{Integer} value must be a number"
	};
	dhtmlx.assert_rule_function = function(a) {
		if (typeof a == "function") {
			return true
		}
		return false
	};
	dhtmlx.assert_rule_function.describe = function() {
		return "{Function} value must be a custom function"
	};
	dhtmlx.assert_rule_any = function(a) {
		return true
	};
	dhtmlx.assert_rule_any.describe = function() {
		return "Any value"
	};
	dhtmlx.assert_rule_mix = function(g, c) {
		var l = function(a) {
			if (g(a) || c(a)) {
				return true
			}
			return false
		};
		l.describe = function() {
			return g.describe()
		};
		return l
	}
}
dhtmlx.version = "3.0";
dhtmlx.codebase = "./";
dhtmlx.copy = function(c) {
	var a = dhtmlx.copy._function;
	a.prototype = c;
	return new a()
};
dhtmlx.copy._function = function() {};
dhtmlx.extend = function(c, a) {
	for (var g in a) {
		c[g] = a[g]
	}
	if (dhtmlx.assert_enabled() && a._assert) {
		c._assert();
		c._assert = null
	}
	dhtmlx.assert(c, "Invalid nesting target");
	dhtmlx.assert(a, "Invalid nesting source");
	if (a._init) {
		c._init()
	}
	return c
};
dhtmlx.proto_extend = function() {
	var n = arguments;
	var g = n[0];
	var c = [];
	for (var m = n.length - 1; m > 0; m--) {
		if (typeof n[m] == "function") {
			n[m] = n[m].prototype
		}
		for (var l in n[m]) {
			if (l == "_init") {
				c.push(n[m][l])
			} else {
				if (!g[l]) {
					g[l] = n[m][l]
				}
			}
		}
	}
	if (n[0]._init) {
		c.push(n[0]._init)
	}
	g._init = function() {
		for (var o = 0; o < c.length; o++) {
			c[o].apply(this, arguments)
		}
	};
	g.base = n[1];
	var a = function(o) {
		this._init(o);
		if (this._parseSettings) {
			this._parseSettings(o, this.defaults)
		}
	};
	a.prototype = g;
	g = n = null;
	return a
};
dhtmlx.bind = function(c, a) {
	return function() {
		return c.apply(a, arguments)
	}
};
dhtmlx.require = function(a) {
	if (!dhtmlx._modules[a]) {
		dhtmlx.assert(dhtmlx.ajax, "load module is required");
		dhtmlx.exec(dhtmlx.ajax().sync().get(dhtmlx.codebase + a).responseText);
		dhtmlx._modules[a] = true
	}
};
dhtmlx._modules = {};
dhtmlx.exec = function(code) {
	if (window.execScript) {
		window.execScript(code)
	} else {
		window.eval(code)
	}
};
dhtmlx.methodPush = function(a, g, c) {
	return function() {
		var l = false;
		l = a[g].apply(a, arguments);
		return l
	}
};
dhtmlx.isNotDefined = function(c) {
	return typeof c == "undefined"
};
dhtmlx.delay = function(l, c, g, a) {
	setTimeout(function() {
		var m = l.apply(c, g);
		l = c = g = null;
		return m
	}, a || 1)
};
dhtmlx.uid = function() {
	if (!this._seed) {
		this._seed = (new Date).valueOf()
	}
	this._seed++;
	return this._seed
};
dhtmlx.toNode = function(a) {
	if (typeof a == "string") {
		return document.getElementById(a)
	}
	return a
};
dhtmlx.toArray = function(a) {
	return dhtmlx.extend((a || []), dhtmlx.PowerArray)
};
dhtmlx.toFunctor = function(str) {
	return (typeof(str) == "string") ? eval(str) : str
};
dhtmlx._events = {};
dhtmlx.event = function(l, g, a, c) {
	l = dhtmlx.toNode(l);
	var m = dhtmlx.uid();
	dhtmlx._events[m] = [l, g, a];
	if (c) {
		a = dhtmlx.bind(a, c)
	}
	if (l.addEventListener) {
		l.addEventListener(g, a, false)
	} else {
		if (l.attachEvent) {
			l.attachEvent("on" + g, a)
		}
	}
	return m
};
dhtmlx.eventRemove = function(c) {
	if (!c) {
		return
	}
	dhtmlx.assert(this._events[c], "Removing non-existing event");
	var a = dhtmlx._events[c];
	if (a[0].removeEventListener) {
		a[0].removeEventListener(a[1], a[2], false)
	} else {
		if (a[0].detachEvent) {
			a[0].detachEvent("on" + a[1], a[2])
		}
	}
	delete this._events[c]
};
dhtmlx.log = function(c, g, a) {
	if (window.console && console.log) {
		c = c.toLowerCase();
		if (window.console[c]) {
			window.console[c](g || "unknown error")
		} else {
			window.console.log(c + ": " + g)
		}
		if (a) {
			window.console.log(a)
		}
	}
};
dhtmlx.log_full_time = function(a) {
	dhtmlx._start_time_log = new Date();
	dhtmlx.log("Info", "Timing start [" + a + "]");
	window.setTimeout(function() {
		var c = new Date();
		dhtmlx.log("Info", "Timing end [" + a + "]:" + (c.valueOf() - dhtmlx._start_time_log.valueOf()) / 1000 + "s")
	}, 1)
};
dhtmlx.log_time = function(a) {
	var g = "_start_time_log" + a;
	if (!dhtmlx[g]) {
		dhtmlx[g] = new Date();
		dhtmlx.log("Info", "Timing start [" + a + "]")
	} else {
		var c = new Date();
		dhtmlx.log("Info", "Timing end [" + a + "]:" + (c.valueOf() - dhtmlx[g].valueOf()) / 1000 + "s");
		dhtmlx[g] = null
	}
};
dhtmlx.error = function(c, a) {
	dhtmlx.log("error", c, a)
};
dhtmlx.EventSystem = {
	_init: function() {
		this._events = {};
		this._handlers = {};
		this._map = {}
	},
	block: function() {
		this._events._block = true
	},
	unblock: function() {
		this._events._block = false
	},
	mapEvent: function(a) {
		dhtmlx.extend(this._map, a)
	},
	callEvent: function(g, m) {
		if (this._events._block) {
			return true
		}
		g = g.toLowerCase();
		dhtmlx.assert_event_call(this, g, m);
		var l = this._events[g.toLowerCase()];
		var a = true;
		if (dhtmlx.debug) {
			dhtmlx.log("info", "[" + this.name + "] event:" + g, m)
		}
		if (l) {
			for (var c = 0; c < l.length; c++) {
				if (l[c].apply(this, (m || [])) === false) {
					a = false
				}
			}
		}
		if (this._map[g] && !this._map[g].callEvent(g, m)) {
			a = false
		}
		return a
	},
	attachEvent: function(c, a, l) {
		c = c.toLowerCase();
		dhtmlx.assert_event_attach(this, c);
		l = l || dhtmlx.uid();
		a = dhtmlx.toFunctor(a);
		var g = this._events[c] || dhtmlx.toArray();
		g.push(a);
		this._events[c] = g;
		this._handlers[l] = {
			f: a,
			t: c
		};
		return l
	},
	detachEvent: function(l) {
		if (this._handlers[l]) {
			var c = this._handlers[l].t;
			var a = this._handlers[l].f;
			var g = this._events[c];
			g.remove(a);
			delete this._handlers[l]
		}
	}
};
dhtmlx.PowerArray = {
	removeAt: function(c, a) {
		if (c >= 0) {
			this.splice(c, (a || 1))
		}
	},
	remove: function(a) {
		this.removeAt(this.find(a))
	},
	insertAt: function(c, g) {
		if (!g && g !== 0) {
			this.push(c)
		} else {
			var a = this.splice(g, (this.length - g));
			this[g] = c;
			this.push.apply(this, a)
		}
	},
	find: function(a) {
		for (i = 0; i < this.length; i++) {
			if (a == this[i]) {
				return i
			}
		}
		return -1
	},
	each: function(a, g) {
		for (var c = 0; c < this.length; c++) {
			a.call((g || this), this[c])
		}
	},
	map: function(a, g) {
		for (var c = 0; c < this.length; c++) {
			this[c] = a.call((g || this), this[c])
		}
		return this
	}
};
dhtmlx.env = {};
if (navigator.userAgent.indexOf("Opera") != -1) {
	dhtmlx._isOpera = true
} else {
	dhtmlx._isIE = !!document.all;
	dhtmlx._isFF = !document.all;
	dhtmlx._isWebKit = (navigator.userAgent.indexOf("KHTML") != -1);
	if (navigator.appVersion.indexOf("MSIE 8.0") != -1 && document.compatMode != "BackCompat") {
		dhtmlx._isIE = 8
	}
	if (navigator.appVersion.indexOf("MSIE 9.0") != -1 && document.compatMode != "BackCompat") {
		dhtmlx._isIE = 9
	}
}
dhtmlx.env = {};
(function() {
	dhtmlx.env.transform = false;
	dhtmlx.env.transition = false;
	var a = {};
	a.names = ["transform", "transition"];
	a.transform = ["transform", "WebkitTransform", "MozTransform", "oTransform", "msTransform"];
	a.transition = ["transition", "WebkitTransition", "MozTransition", "oTransition"];
	var l = document.createElement("DIV");
	var g;
	for (var c = 0; c < a.names.length; c++) {
		while (p = a[a.names[c]].pop()) {
			if (typeof l.style[p] != "undefined") {
				dhtmlx.env[a.names[c]] = true
			}
		}
	}
})();
dhtmlx.env.transform_prefix = (function() {
	var a;
	if (dhtmlx._isOpera) {
		a = "-o-"
	} else {
		a = "";
		if (dhtmlx._isFF) {
			a = "-moz-"
		}
		if (dhtmlx._isWebKit) {
			a = "-webkit-"
		}
	}
	return a
})();
dhtmlx.env.svg = (function() {
	return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure", "1.1")
})();
dhtmlx.zIndex = {
	drag: 10000
};
dhtmlx.html = {
	create: function(c, a, g) {
		a = a || {};
		var l = document.createElement(c);
		for (var m in a) {
			l.setAttribute(m, a[m])
		}
		if (a.style) {
			l.style.cssText = a.style
		}
		if (a["class"]) {
			l.className = a["class"]
		}
		if (g) {
			l.innerHTML = g
		}
		return l
	},
	getValue: function(a) {
		a = dhtmlx.toNode(a);
		if (!a) {
			return ""
		}
		return dhtmlx.isNotDefined(a.value) ? a.innerHTML : a.value
	},
	remove: function(c) {
		if (c instanceof Array) {
			for (var a = 0; a < c.length; a++) {
				this.remove(c[a])
			}
		} else {
			if (c && c.parentNode) {
				c.parentNode.removeChild(c)
			}
		}
	},
	insertBefore: function(c, g, a) {
		if (!c) {
			return
		}
		if (g) {
			g.parentNode.insertBefore(c, g)
		} else {
			a.appendChild(c)
		}
	},
	locate: function(c, l) {
		c = c || event;
		var a = c.target || c.srcElement;
		while (a) {
			if (a.getAttribute) {
				var g = a.getAttribute(l);
				if (g) {
					return g
				}
			}
			a = a.parentNode
		}
		return null
	},
	offset: function(l) {
		if (l.getBoundingClientRect) {
			var o = l.getBoundingClientRect();
			var q = document.body;
			var c = document.documentElement;
			var a = window.pageYOffset || c.scrollTop || q.scrollTop;
			var m = window.pageXOffset || c.scrollLeft || q.scrollLeft;
			var n = c.clientTop || q.clientTop || 0;
			var r = c.clientLeft || q.clientLeft || 0;
			var s = o.top + a - n;
			var g = o.left + m - r;
			return {
				y: Math.round(s),
				x: Math.round(g)
			}
		} else {
			var s = 0,
				g = 0;
			while (l) {
				s = s + parseInt(l.offsetTop, 10);
				g = g + parseInt(l.offsetLeft, 10);
				l = l.offsetParent
			}
			return {
				y: s,
				x: g
			}
		}
	},
	pos: function(a) {
		a = a || event;
		if (a.pageX || a.pageY) {
			return {
				x: a.pageX,
				y: a.pageY
			}
		}
		var c = ((dhtmlx._isIE) && (document.compatMode != "BackCompat")) ? document.documentElement : document.body;
		return {
			x: a.clientX + c.scrollLeft - c.clientLeft,
			y: a.clientY + c.scrollTop - c.clientTop
		}
	},
	preventEvent: function(a) {
		if (a && a.preventDefault) {
			a.preventDefault()
		}
		dhtmlx.html.stopEvent(a)
	},
	stopEvent: function(a) {
		(a || event).cancelBubble = true;
		return false
	},
	addCss: function(c, a) {
		c.className += " " + a
	},
	removeCss: function(c, a) {
		c.className = c.className.replace(RegExp(a, "g"), "")
	}
};
(function() {
	var a = document.getElementsByTagName("SCRIPT");
	dhtmlx.assert(a.length, "Can't locate codebase");
	if (a.length) {
		a = (a[a.length - 1].getAttribute("src") || "").split("/");
		a.splice(a.length - 1, 1);
		dhtmlx.codebase = a.slice(0, a.length).join("/") + "/"
	}
})();
if (!dhtmlx.ui) {
	dhtmlx.ui = {}
}
dhtmlx.Destruction = {
	_init: function() {
		dhtmlx.destructors.push(this)
	},
	destructor: function() {
		this.destructor = function() {};
		this._htmlmap = null;
		this._htmlrows = null;
		if (this._html) {
			document.body.appendChild(this._html)
		}
		this._html = null;
		if (this._obj) {
			this._obj.innerHTML = "";
			this._obj._htmlmap = null
		}
		this._obj = this._dataobj = null;
		this.data = null;
		this._events = this._handlers = {};
		if (this.render) {
			this.render = function() {}
		}
	}
};
dhtmlx.destructors = [];
dhtmlx.event(window, "unload", function() {
	if (dhtmlx.destructors) {
		for (var g = 0; g < dhtmlx.destructors.length; g++) {
			dhtmlx.destructors[g].destructor()
		}
		dhtmlx.destructors = []
	}
	for (var c in dhtmlx._events) {
		var l = dhtmlx._events[c];
		if (l[0].removeEventListener) {
			l[0].removeEventListener(l[1], l[2], false)
		} else {
			if (l[0].detachEvent) {
				l[0].detachEvent("on" + l[1], l[2])
			}
		}
		delete dhtmlx._events[c]
	}
});
dhtmlx.ajax = function(a, c, g) {
	if (arguments.length !== 0) {
		var l = new dhtmlx.ajax();
		if (g) {
			l.master = g
		}
		l.get(a, null, c)
	}
	if (!this.getXHR) {
		return new dhtmlx.ajax()
	}
	return this
};
dhtmlx.ajax.prototype = {
	getXHR: function() {
		if (dhtmlx._isIE) {
			return new ActiveXObject("Microsoft.xmlHTTP")
		} else {
			return new XMLHttpRequest()
		}
	},
	send: function(m, r, o) {
		var c = this.getXHR();
		if (typeof o == "function") {
			o = [o]
		}
		if (typeof r == "object") {
			var n = [];
			for (var g in r) {
				var q = r[g];
				if (q === null || q === dhtmlx.undefined) {
					q = ""
				}
				n.push(g + "=" + encodeURIComponent(q))
			}
			r = n.join("&")
		}
		if (r && !this.post) {
			m = m + (m.indexOf("?") != -1 ? "&" : "?") + r;
			r = null
		}
		c.open(this.post ? "POST" : "GET", m, !this._sync);
		if (this.post) {
			c.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
		}
		var l = this;
		c.onreadystatechange = function() {
			if (!c.readyState || c.readyState == 4) {
				if (o && l) {
					for (var a = 0; a < o.length; a++) {
						if (o[a]) {
							o[a].call((l.master || l), c.responseText, c.responseXML, c)
						}
					}
				}
				l.master = null;
				o = l = null
			}
		};
		c.send(r || null);
		return c
	},
	get: function(a, g, c) {
		this.post = false;
		return this.send(a, g, c)
	},
	post: function(a, g, c) {
		this.post = true;
		return this.send(a, g, c)
	},
	sync: function() {
		this._sync = true;
		return this
	}
};
dhtmlx.AtomDataLoader = {
	_init: function(a) {
		this.data = {};
		if (a) {
			this._settings.datatype = a.datatype || "json";
			this._after_init.push(this._load_when_ready)
		}
	},
	_load_when_ready: function() {
		this._ready_for_data = true;
		if (this._settings.url) {
			this.url_setter(this._settings.url)
		}
		if (this._settings.data) {
			this.data_setter(this._settings.data)
		}
	},
	url_setter: function(a) {
		if (!this._ready_for_data) {
			return a
		}
		this.load(a, this._settings.datatype);
		return a
	},
	data_setter: function(a) {
		if (!this._ready_for_data) {
			return a
		}
		this.parse(a, this._settings.datatype);
		return true
	},
	load: function(a, c) {
		this.callEvent("onXLS", []);
		if (typeof c == "string") {
			this.data.driver = dhtmlx.DataDriver[c];
			c = arguments[2]
		} else {
			this.data.driver = dhtmlx.DataDriver.xml
		}
		dhtmlx.ajax(a, [this._onLoad, c], this)
	},
	parse: function(c, a) {
		this.callEvent("onXLS", []);
		this.data.driver = dhtmlx.DataDriver[a || "xml"];
		this._onLoad(c, null)
	},
	_onLoad: function(m, c, a) {
		var g = this.data.driver;
		var l = g.getRecords(g.toObject(m, c))[0];
		this.data = (g ? g.getDetails(l) : m);
		this.callEvent("onXLE", [])
	},
	_check_data_feed: function(c) {
		if (!this._settings.dataFeed || this._ignore_feed || !c) {
			return true
		}
		var a = this._settings.dataFeed;
		if (typeof a == "function") {
			return a.call(this, (c.id || c), c)
		}
		a = a + (a.indexOf("?") == -1 ? "?" : "&") + "action=get&id=" + encodeURIComponent(c.id || c);
		this.callEvent("onXLS", []);
		dhtmlx.ajax(a, function(l, g) {
			this._ignore_feed = true;
			this.setValues(dhtmlx.DataDriver.json.toObject(l)[0]);
			this._ignore_feed = false;
			this.callEvent("onXLE", [])
		}, this);
		return false
	}
};
dhtmlx.DataDriver = {};
dhtmlx.DataDriver.json = {
	toObject: function(data) {
		if (!data) {
			data = "[]"
		}
		if (typeof data == "string") {
			eval("dhtmlx.temp=" + data);
			return dhtmlx.temp
		}
		return data
	},
	getRecords: function(a) {
		if (a && !(a instanceof Array)) {
			return [a]
		}
		return a
	},
	getDetails: function(a) {
		return a
	},
	getInfo: function(a) {
		return {
			_size: (a.total_count || 0),
			_from: (a.pos || 0),
			_key: (a.dhx_security)
		}
	}
};
dhtmlx.DataDriver.json_ext = {
	toObject: function(data) {
		if (!data) {
			data = "[]"
		}
		if (typeof data == "string") {
			var temp;
			eval("temp=" + data);
			dhtmlx.temp = [];
			var header = temp.header;
			for (var i = 0; i < temp.data.length; i++) {
				var item = {};
				for (var j = 0; j < header.length; j++) {
					if (typeof(temp.data[i][j]) != "undefined") {
						item[header[j]] = temp.data[i][j]
					}
				}
				dhtmlx.temp.push(item)
			}
			return dhtmlx.temp
		}
		return data
	},
	getRecords: function(a) {
		if (a && !(a instanceof Array)) {
			return [a]
		}
		return a
	},
	getDetails: function(a) {
		return a
	},
	getInfo: function(a) {
		return {
			_size: (a.total_count || 0),
			_from: (a.pos || 0)
		}
	}
};
dhtmlx.DataDriver.html = {
	toObject: function(c) {
		if (typeof c == "string") {
			var a = null;
			if (c.indexOf("<") == -1) {
				a = dhtmlx.toNode(c)
			}
			if (!a) {
				a = document.createElement("DIV");
				a.innerHTML = c
			}
			return a.getElementsByTagName(this.tag)
		}
		return c
	},
	getRecords: function(a) {
		if (a.tagName) {
			return a.childNodes
		}
		return a
	},
	getDetails: function(a) {
		return dhtmlx.DataDriver.xml.tagToObject(a)
	},
	getInfo: function(a) {
		return {
			_size: 0,
			_from: 0
		}
	},
	tag: "LI"
};
dhtmlx.DataDriver.jsarray = {
	toObject: function(data) {
		if (typeof data == "string") {
			eval("dhtmlx.temp=" + data);
			return dhtmlx.temp
		}
		return data
	},
	getRecords: function(a) {
		return a
	},
	getDetails: function(g) {
		var a = {};
		for (var c = 0; c < g.length; c++) {
			a["data" + c] = g[c]
		}
		return a
	},
	getInfo: function(a) {
		return {
			_size: 0,
			_from: 0
		}
	}
};
dhtmlx.DataDriver.csv = {
	toObject: function(a) {
		return a
	},
	getRecords: function(a) {
		return a.split(this.row)
	},
	getDetails: function(g) {
		g = this.stringToArray(g);
		var a = {};
		for (var c = 0; c < g.length; c++) {
			a["data" + c] = g[c]
		}
		return a
	},
	getInfo: function(a) {
		return {
			_size: 0,
			_from: 0
		}
	},
	stringToArray: function(c) {
		c = c.split(this.cell);
		for (var a = 0; a < c.length; a++) {
			c[a] = c[a].replace(/^[ \t\n\r]*(\"|)/g, "").replace(/(\"|)[ \t\n\r]*$/g, "")
		}
		return c
	},
	row: "\n",
	cell: ","
};
dhtmlx.DataDriver.xml = {
	toObject: function(c, a) {
		if (a && (a = this.checkResponse(c, a))) {
			return a
		}
		if (typeof c == "string") {
			return this.fromString(c)
		}
		return c
	},
	getRecords: function(a) {
		return this.xpath(a, this.records)
	},
	records: "/*/item",
	getDetails: function(a) {
		return this.tagToObject(a, {})
	},
	getInfo: function(a) {
		return {
			_size: (a.documentElement.getAttribute("total_count") || 0),
			_from: (a.documentElement.getAttribute("pos") || 0),
			_key: (a.documentElement.getAttribute("dhx_security"))
		}
	},
	xpath: function(l, r) {
		if (window.XPathResult) {
			var g = l;
			if (l.nodeName.indexOf("document") == -1) {
				l = l.ownerDocument
			}
			var o = [];
			var c = l.evaluate(r, g, null, XPathResult.ANY_TYPE, null);
			var q = c.iterateNext();
			while (q) {
				o.push(q);
				q = c.iterateNext()
			}
			return o
		} else {
			var n = true;
			try {
				if (typeof(l.selectNodes) == "undefined") {
					n = false
				}
			} catch (m) {}
			if (n) {
				return l.selectNodes(r)
			} else {
				var a = r.split("/").pop();
				return l.getElementsByTagName(a)
			}
		}
	},
	tagToObject: function(g, r) {
		r = r || {};
		var m = false;
		var l = g.attributes;
		if (l && l.length) {
			for (var o = 0; o < l.length; o++) {
				r[l[o].name] = l[o].value
			}
			m = true
		}
		var c = g.childNodes;
		var q = {};
		for (var o = 0; o < c.length; o++) {
			if (c[o].nodeType == 1) {
				var n = c[o].tagName;
				if (typeof r[n] != "undefined") {
					if (!(r[n] instanceof Array)) {
						r[n] = [r[n]]
					}
					r[n].push(this.tagToObject(c[o], {}))
				} else {
					r[c[o].tagName] = this.tagToObject(c[o], {})
				}
				m = true
			}
		}
		if (!m) {
			return this.nodeValue(g)
		}
		r.value = this.nodeValue(g);
		return r
	},
	nodeValue: function(a) {
		if (a.firstChild) {
			return a.firstChild.wholeText || a.firstChild.data
		}
		return ""
	},
	fromString: function(c) {
		if (window.DOMParser && !dhtmlx._isIE) {
			return (new DOMParser()).parseFromString(c, "text/xml")
		}
		if (window.ActiveXObject) {
			var a = new ActiveXObject("Microsoft.xmlDOM");
			a.loadXML(c);
			return a
		}
		dhtmlx.error("Load from xml string is not supported")
	},
	checkResponse: function(l, g) {
		if (g && (g.firstChild && g.firstChild.tagName != "parsererror")) {
			return g
		}
		var c = this.fromString(l.replace(/^[\s]+/, ""));
		if (c) {
			return c
		}
		dhtmlx.error("xml can't be parsed", l)
	}
};
dhtmlx.DataLoader = {
	_init: function(a) {
		a = a || "";
		this.name = "DataStore";
		this.data = (a.datastore) || (new dhtmlx.DataStore());
		this._readyHandler = this.data.attachEvent("onStoreLoad", dhtmlx.bind(this._call_onready, this))
	},
	load: function(a, c) {
		dhtmlx.AtomDataLoader.load.apply(this, arguments);
		if (!this.data.feed) {
			this.data.feed = function(l, g) {
				if (this._load_count) {
					return this._load_count = [l, g]
				} else {
					this._load_count = true
				}
				this.load(a + ((a.indexOf("?") == -1) ? "?" : "&") + "posStart=" + l + "&count=" + g, function() {
					var m = this._load_count;
					this._load_count = false;
					if (typeof m == "object") {
						this.data.feed.apply(this, m)
					}
				})
			}
		}
	},
	_onLoad: function(g, c, a) {
		this.data._parse(this.data.driver.toObject(g, c));
		this.callEvent("onXLE", []);
		if (this._readyHandler) {
			this.data.detachEvent(this._readyHandler);
			this._readyHandler = null
		}
	},
	dataFeed_setter: function(a) {
		this.data.attachEvent("onBeforeFilter", dhtmlx.bind(function(o, n) {
			if (this._settings.dataFeed) {
				var m = {};
				if (!o && !m) {
					return
				}
				if (typeof o == "function") {
					if (!n) {
						return
					}
					o(n, m)
				} else {
					m = {
						text: n
					}
				}
				this.clearAll();
				var c = this._settings.dataFeed;
				if (typeof c == "function") {
					return c.call(this, n, m)
				}
				var l = [];
				for (var g in m) {
					l.push("dhx_filter[" + g + "]=" + encodeURIComponent(m[g]))
				}
				this.load(c + (c.indexOf("?") < 0 ? "?" : "&") + l.join("&"), this._settings.datatype);
				return false
			}
		}, this));
		return a
	},
	_call_onready: function() {
		if (this._settings.ready) {
			var a = dhtmlx.toFunctor(this._settings.ready);
			if (a && a.call) {
				a.apply(this, arguments)
			}
		}
	}
};
dhtmlx.DataStore = function() {
	this.name = "DataStore";
	dhtmlx.extend(this, dhtmlx.EventSystem);
	this.setDriver("xml");
	this.pull = {};
	this.order = dhtmlx.toArray()
};
dhtmlx.DataStore.prototype = {
	setDriver: function(a) {
		dhtmlx.assert(dhtmlx.DataDriver[a], "incorrect DataDriver");
		this.driver = dhtmlx.DataDriver[a]
	},
	_parse: function(m) {
		this.callEvent("onParse", [this.driver, m]);
		if (this._filter_order) {
			this.filter()
		}
		var n = this.driver.getInfo(m);
		if (n._key) {
			dhtmlx.security_key = n._key
		}
		var l = this.driver.getRecords(m);
		var q = (n._from || 0) * 1;
		if (q === 0 && this.order[0]) {
			q = this.order.length
		}
		var c = 0;
		for (var g = 0; g < l.length; g++) {
			var a = this.driver.getDetails(l[g]);
			var o = this.id(a);
			if (!this.pull[o]) {
				this.order[c + q] = o;
				c++
			}
			this.pull[o] = a;
			if (this.extraParser) {
				this.extraParser(a)
			}
			if (this._scheme) {
				if (this._scheme.$init) {
					this._scheme.$update(a)
				} else {
					if (this._scheme.$update) {
						this._scheme.$update(a)
					}
				}
			}
		}
		for (var g = 0; g < n._size; g++) {
			if (!this.order[g]) {
				var o = dhtmlx.uid();
				var a = {
					id: o,
					$template: "loading"
				};
				this.pull[o] = a;
				this.order[g] = o
			}
		}
		this.callEvent("onStoreLoad", [this.driver, m]);
		this.refresh()
	},
	id: function(a) {
		return a.id || (a.id = dhtmlx.uid())
	},
	changeId: function(c, a) {
		dhtmlx.assert(this.pull[c], "Can't change id, for non existing item: " + c);
		this.pull[a] = this.pull[c];
		this.pull[a].id = a;
		this.order[this.order.find(c)] = a;
		if (this._filter_order) {
			this._filter_order[this._filter_order.find(c)] = a
		}
		this.callEvent("onIdChange", [c, a]);
		if (this._render_change_id) {
			this._render_change_id(c, a)
		}
	},
	get: function(a) {
		return this.item(a)
	},
	set: function(c, a) {
		return this.update(c, a)
	},
	item: function(a) {
		return this.pull[a]
	},
	update: function(c, a) {
		if (this._scheme && this._scheme.$update) {
			this._scheme.$update(a)
		}
		if (this.callEvent("onBeforeUpdate", [c, a]) === false) {
			return false
		}
		this.pull[c] = a;
		this.refresh(c)
	},
	refresh: function(a) {
		if (this._skip_refresh) {
			return
		}
		if (a) {
			this.callEvent("onStoreUpdated", [a, this.pull[a], "update"])
		} else {
			this.callEvent("onStoreUpdated", [null, null, null])
		}
	},
	silent: function(a) {
		this._skip_refresh = true;
		a.call(this);
		this._skip_refresh = false
	},
	getRange: function(l, g) {
		if (l) {
			l = this.indexById(l)
		} else {
			l = this.startOffset || 0
		}
		if (g) {
			g = this.indexById(g)
		} else {
			g = Math.min((this.endOffset || Infinity), (this.dataCount() - 1));
			if (g < 0) {
				g = 0
			}
		}
		if (l > g) {
			var c = g;
			g = l;
			l = c
		}
		return this.getIndexRange(l, g)
	},
	getIndexRange: function(l, g) {
		g = Math.min((g || Infinity), this.dataCount() - 1);
		var a = dhtmlx.toArray();
		for (var c = (l || 0); c <= g; c++) {
			a.push(this.item(this.order[c]))
		}
		return a
	},
	dataCount: function() {
		return this.order.length
	},
	exists: function(a) {
		return !!(this.pull[a])
	},
	move: function(a, l) {
		if (a < 0 || l < 0) {
			dhtmlx.error("DataStore::move", "Incorrect indexes");
			return
		}
		var g = this.idByIndex(a);
		var c = this.item(g);
		this.order.removeAt(a);
		this.order.insertAt(g, Math.min(this.order.length, l));
		this.callEvent("onStoreUpdated", [g, c, "move"])
	},
	scheme: function(a) {
		this._scheme = a
	},
	sync: function(m, l, a) {
		if (typeof l != "function") {
			a = l;
			l = null
		}
		if (dhtmlx.debug_bind) {
			this.debug_sync_master = m;
			dhtmlx.log("[sync] " + this.debug_bind_master.name + "@" + this.debug_bind_master._settings.id + " <= " + this.debug_sync_master.name + "@" + this.debug_sync_master._settings.id)
		}
		var g = m;
		if (m.name != "DataStore") {
			m = m.data
		}
		var c = dhtmlx.bind(function(q, n, o) {
			if (o != "update" || l) {
				q = null
			}
			if (!q) {
				this.order = dhtmlx.toArray([].concat(m.order));
				this._filter_order = null;
				this.pull = m.pull;
				if (l) {
					this.silent(l)
				}
				if (this._on_sync) {
					this._on_sync()
				}
			}
			if (dhtmlx.debug_bind) {
				dhtmlx.log("[sync:request] " + this.debug_sync_master.name + "@" + this.debug_sync_master._settings.id + " <= " + this.debug_bind_master.name + "@" + this.debug_bind_master._settings.id)
			}
			if (!a) {
				this.refresh(q)
			} else {
				a = false
			}
		}, this);
		m.attachEvent("onStoreUpdated", c);
		this.feed = function(o, n) {
			g.loadNext(n, o)
		};
		c()
	},
	add: function(m, a) {
		if (this._scheme) {
			m = m || {};
			for (var c in this._scheme) {
				m[c] = m[c] || this._scheme[c]
			}
			if (this._scheme) {
				if (this._scheme.$init) {
					this._scheme.$update(m)
				} else {
					if (this._scheme.$update) {
						this._scheme.$update(m)
					}
				}
			}
		}
		var n = this.id(m);
		var l = this.dataCount();
		if (dhtmlx.isNotDefined(a) || a < 0) {
			a = l
		}
		if (a > l) {
			dhtmlx.log("Warning", "DataStore:add", "Index of out of bounds");
			a = Math.min(this.order.length, a)
		}
		if (this.callEvent("onBeforeAdd", [n, m, a]) === false) {
			return false
		}
		if (this.exists(n)) {
			return dhtmlx.error("Not unique ID")
		}
		this.pull[n] = m;
		this.order.insertAt(n, a);
		if (this._filter_order) {
			var g = this._filter_order.length;
			if (!a && this.order.length) {
				g = 0
			}
			this._filter_order.insertAt(n, g)
		}
		this.callEvent("onafterAdd", [n, a]);
		this.callEvent("onStoreUpdated", [n, m, "add"]);
		return n
	},
	remove: function(g) {
		if (g instanceof Array) {
			for (var a = 0; a < g.length; a++) {
				this.remove(g[a])
			}
			return
		}
		if (this.callEvent("onBeforeDelete", [g]) === false) {
			return false
		}
		if (!this.exists(g)) {
			return dhtmlx.error("Not existing ID", g)
		}
		var c = this.item(g);
		this.order.remove(g);
		if (this._filter_order) {
			this._filter_order.remove(g)
		}
		delete this.pull[g];
		this.callEvent("onafterdelete", [g]);
		this.callEvent("onStoreUpdated", [g, c, "delete"])
	},
	clearAll: function() {
		this.pull = {};
		this.order = dhtmlx.toArray();
		this.feed = null;
		this._filter_order = null;
		this.callEvent("onClearAll", []);
		this.refresh()
	},
	idByIndex: function(a) {
		if (a >= this.order.length || a < 0) {
			dhtmlx.log("Warning", "DataStore::idByIndex Incorrect index")
		}
		return this.order[a]
	},
	indexById: function(c) {
		var a = this.order.find(c);
		return a
	},
	next: function(c, a) {
		return this.order[this.indexById(c) + (a || 1)]
	},
	first: function() {
		return this.order[0]
	},
	last: function() {
		return this.order[this.order.length - 1]
	},
	previous: function(c, a) {
		return this.order[this.indexById(c) - (a || 1)]
	},
	sort: function(n, c, a) {
		var g = n;
		if (typeof n == "function") {
			g = {
				as: n,
				dir: c
			}
		} else {
			if (typeof n == "string") {
				g = {
					by: n,
					dir: c,
					as: a
				}
			}
		}
		var m = [g.by, g.dir, g.as];
		if (!this.callEvent("onbeforesort", m)) {
			return
		}
		if (this.order.length) {
			var o = dhtmlx.sort.create(g);
			var l = this.getRange(this.first(), this.last());
			l.sort(o);
			this.order = l.map(function(q) {
				return this.id(q)
			}, this)
		}
		this.refresh();
		this.callEvent("onaftersort", m)
	},
	filter: function(m, l) {
		if (!this.callEvent("onBeforeFilter", [m, l])) {
			return
		}
		if (this._filter_order) {
			this.order = this._filter_order;
			delete this._filter_order
		}
		if (!this.order.length) {
			return
		}
		if (m) {
			var c = m;
			l = l || "";
			if (typeof m == "string") {
				m = dhtmlx.Template.fromHTML(m);
				l = l.toString().toLowerCase();
				c = function(q, o) {
					return m(q).toLowerCase().indexOf(o) != -1
				}
			}
			var g = dhtmlx.toArray();
			for (var a = 0; a < this.order.length; a++) {
				var n = this.order[a];
				if (c(this.item(n), l)) {
					g.push(n)
				}
			}
			this._filter_order = this.order;
			this.order = g
		}
		this.refresh();
		this.callEvent("onAfterFilter", [])
	},
	each: function(g, c) {
		for (var a = 0; a < this.order.length; a++) {
			g.call((c || this), this.item(this.order[a]))
		}
	},
	provideApi: function(l, c) {
		this.debug_bind_master = l;
		if (c) {
			this.mapEvent({
				onbeforesort: l,
				onaftersort: l,
				onbeforeadd: l,
				onafteradd: l,
				onbeforedelete: l,
				onafterdelete: l,
				onbeforeupdate: l
			})
		}
		var g = ["get", "set", "sort", "add", "remove", "exists", "idByIndex", "indexById", "item", "update", "refresh", "dataCount", "filter", "next", "previous", "clearAll", "first", "last", "serialize"];
		for (var a = 0; a < g.length; a++) {
			l[g[a]] = dhtmlx.methodPush(this, g[a])
		}
		if (dhtmlx.assert_enabled()) {
			this.assert_event(l)
		}
	},
	serialize: function() {
		var g = this.order;
		var a = [];
		for (var c = 0; c < g.length; c++) {
			a.push(this.pull[g[c]])
		}
		return a
	}
};
dhtmlx.sort = {
	create: function(a) {
		return dhtmlx.sort.dir(a.dir, dhtmlx.sort.by(a.by, a.as))
	},
	as: {
		"int": function(g, c) {
			g = g * 1;
			c = c * 1;
			return g > c ? 1 : (g < c ? -1 : 0)
		},
		string_strict: function(g, c) {
			g = g.toString();
			c = c.toString();
			return g > c ? 1 : (g < c ? -1 : 0)
		},
		string: function(g, c) {
			g = g.toString().toLowerCase();
			c = c.toString().toLowerCase();
			return g > c ? 1 : (g < c ? -1 : 0)
		}
	},
	by: function(c, a) {
		if (!c) {
			return a
		}
		if (typeof a != "function") {
			a = dhtmlx.sort.as[a || "string"]
		}
		c = dhtmlx.Template.fromHTML(c);
		return function(l, g) {
			return a(c(l), c(g))
		}
	},
	dir: function(c, a) {
		if (c == "asc") {
			return a
		}
		return function(l, g) {
			return a(l, g) * -1
		}
	}
};
dhtmlx.KeyEvents = {
	_init: function() {
		dhtmlx.event(this._obj, "keypress", this._onKeyPress, this)
	},
	_onKeyPress: function(c) {
		c = c || event;
		var a = c.which || c.keyCode;
		this.callEvent((this._edit_id ? "onEditKeyPress" : "onKeyPress"), [a, c.ctrlKey, c.shiftKey, c])
	}
};
dhtmlx.MouseEvents = {
	_init: function() {
		if (this.on_click) {
			dhtmlx.event(this._obj, "click", this._onClick, this);
			dhtmlx.event(this._obj, "contextmenu", this._onContext, this)
		}
		if (this.on_dblclick) {
			dhtmlx.event(this._obj, "dblclick", this._onDblClick, this)
		}
		if (this.on_mouse_move) {
			dhtmlx.event(this._obj, "mousemove", this._onMouse, this);
			dhtmlx.event(this._obj, (dhtmlx._isIE ? "mouseleave" : "mouseout"), this._onMouse, this)
		}
	},
	_onClick: function(a) {
		return this._mouseEvent(a, this.on_click, "ItemClick")
	},
	_onDblClick: function(a) {
		return this._mouseEvent(a, this.on_dblclick, "ItemDblClick")
	},
	_onContext: function(a) {
		var c = dhtmlx.html.locate(a, this._id);
		if (c && !this.callEvent("onBeforeContextMenu", [c, a])) {
			return dhtmlx.html.preventEvent(a)
		}
	},
	_onMouse: function(a) {
		if (dhtmlx._isIE) {
			a = document.createEventObject(event)
		}
		if (this._mouse_move_timer) {
			window.clearTimeout(this._mouse_move_timer)
		}
		this.callEvent("onMouseMoving", [a]);
		this._mouse_move_timer = window.setTimeout(dhtmlx.bind(function() {
			if (a.type == "mousemove") {
				this._onMouseMove(a)
			} else {
				this._onMouseOut(a)
			}
		}, this), 500)
	},
	_onMouseMove: function(a) {
		if (!this._mouseEvent(a, this.on_mouse_move, "MouseMove")) {
			this.callEvent("onMouseOut", [a || event])
		}
	},
	_onMouseOut: function(a) {
		this.callEvent("onMouseOut", [a || event])
	},
	_mouseEvent: function(n, m, c) {
		n = n || event;
		var a = n.target || n.srcElement;
		var g = "";
		var o = null;
		var l = false;
		while (a && a.parentNode) {
			if (!l && a.getAttribute) {
				o = a.getAttribute(this._id);
				if (o) {
					if (a.getAttribute("userdata")) {
						this.callEvent("onLocateData", [o, a])
					}
					if (!this.callEvent("on" + c, [o, n, a])) {
						return
					}
					l = true
				}
			}
			g = a.className;
			if (g) {
				g = g.split(" ");
				g = g[0] || g[1];
				if (m[g]) {
					return m[g].call(this, n, o || dhtmlx.html.locate(n, this._id), a)
				}
			}
			a = a.parentNode
		}
		return l
	}
};
dhtmlx.Settings = {
	_init: function() {
		this._settings = this.config = {}
	},
	define: function(c, a) {
		if (typeof c == "object") {
			return this._parseSeetingColl(c)
		}
		return this._define(c, a)
	},
	_define: function(c, a) {
		dhtmlx.assert_settings.call(this, c, a);
		var g = this[c + "_setter"];
		return this._settings[c] = g ? g.call(this, a) : a
	},
	_parseSeetingColl: function(g) {
		if (g) {
			for (var c in g) {
				this._define(c, g[c])
			}
		}
	},
	_parseSettings: function(g, a) {
		var c = dhtmlx.extend({}, a);
		if (typeof g == "object" && !g.tagName) {
			dhtmlx.extend(c, g)
		}
		this._parseSeetingColl(c)
	},
	_mergeSettings: function(a, g) {
		for (var c in g) {
			switch (typeof a[c]) {
				case "object":
					a[c] = this._mergeSettings((a[c] || {}), g[c]);
					break;
				case "undefined":
					a[c] = g[c];
					break;
				default:
					break
			}
		}
		return a
	},
	_parseContainer: function(c, a, g) {
		if (typeof c == "object" && !c.tagName) {
			c = c.container
		}
		this._obj = this.$view = dhtmlx.toNode(c);
		if (!this._obj && g) {
			this._obj = g(c)
		}
		dhtmlx.assert(this._obj, "Incorrect html container");
		this._obj.className += " " + a;
		this._obj.onselectstart = function() {
			//return false 原始值
			//modify code by zzm 20180117 dhtmlx 表格对象区域鼠标可选择
			return false;
		};
		this._dataobj = this._obj
	},
	_set_type: function(a) {
		if (typeof a == "object") {
			return this.type_setter(a)
		}
		dhtmlx.assert(this.types, "RenderStack :: Types are not defined");
		dhtmlx.assert(this.types[a], "RenderStack :: Inccorect type name", a);
		this.type = dhtmlx.extend({}, this.types[a]);
		this.customize()
	},
	customize: function(a) {
		if (a) {
			dhtmlx.extend(this.type, a)
		}
		this.type._item_start = dhtmlx.Template.fromHTML(this.template_item_start(this.type));
		this.type._item_end = this.template_item_end(this.type);
		this.render()
	},
	type_setter: function(a) {
		this._set_type(typeof a == "object" ? dhtmlx.Type.add(this, a) : a);
		return a
	},
	template_setter: function(a) {
		return this.type_setter({
			template: a
		})
	},
	css_setter: function(a) {
		this._obj.className += " " + a;
		return a
	}
};
dhtmlx.Template = {
	_cache: {},
	empty: function() {
		return ""
	},
	setter: function(a) {
		return dhtmlx.Template.fromHTML(a)
	},
	obj_setter: function(c) {
		var a = dhtmlx.Template.setter(c);
		var g = this;
		return function() {
			return a.apply(g, arguments)
		}
	},
	fromHTML: function(a) {
		if (typeof a == "function") {
			return a
		}
		if (this._cache[a]) {
			return this._cache[a]
		}
		a = (a || "").toString();
		a = a.replace(/[\r\n]+/g, "\\n");
		a = a.replace(/\{obj\.([^}?]+)\?([^:]*):([^}]*)\}/g, '"+(obj.$1?"$2":"$3")+"');
		a = a.replace(/\{common\.([^}\(]*)\}/g, '"+common.$1+"');
		a = a.replace(/\{common\.([^\}\(]*)\(\)\}/g, '"+(common.$1?common.$1(obj):"")+"');
		a = a.replace(/\{obj\.([^}]*)\}/g, '"+obj.$1+"');
		a = a.replace(/#([a-z0-9_]+)#/gi, '"+obj.$1+"');
		a = a.replace(/\{obj\}/g, '"+obj+"');
		a = a.replace(/\{-obj/g, "{obj");
		a = a.replace(/\{-common/g, "{common");
		a = 'return "' + a + '";';
		return this._cache[a] = Function("obj", "common", a)
	}
};
dhtmlx.Type = {
	add: function(g, c) {
		if (!g.types && g.prototype.types) {
			g = g.prototype
		}
		if (dhtmlx.assert_enabled()) {
			this.assert_event(c)
		}
		var a = c.name || "default";
		this._template(c);
		this._template(c, "edit");
		this._template(c, "loading");
		g.types[a] = dhtmlx.extend(dhtmlx.extend({}, (g.types[a] || this._default)), c);
		return a
	},
	_default: {
		css: "default",
		template: function() {
			return ""
		},
		template_edit: function() {
			return ""
		},
		template_loading: function() {
			return "..."
		},
		width: 150,
		height: 80,
		margin: 5,
		padding: 0
	},
	_template: function(g, a) {
		a = "template" + (a ? ("_" + a) : "");
		var c = g[a];
		if (c && (typeof c == "string")) {
			if (c.indexOf("->") != -1) {
				c = c.split("->");
				switch (c[0]) {
					case "html":
						c = dhtmlx.html.getValue(c[1]).replace(/\"/g, '\\"');
						break;
					case "http":
						c = new dhtmlx.ajax().sync().get(c[1], {
							uid: (new Date()).valueOf()
						}).responseText;
						break;
					default:
						break
				}
			}
			g[a] = dhtmlx.Template.fromHTML(c)
		}
	}
};
dhtmlx.SingleRender = {
	_init: function() {},
	_toHTML: function(a) {
		return this.type._item_start(a, this.type) + this.type.template(a, this.type) + this.type._item_end
	},
	render: function() {
		if (!this.callEvent || this.callEvent("onBeforeRender", [this.data])) {
			if (this.data) {
				this._dataobj.innerHTML = this._toHTML(this.data)
			}
			if (this.callEvent) {
				this.callEvent("onAfterRender", [])
			}
		}
	}
};
dhtmlx.ui.Tooltip = function(a) {
	this.name = "Tooltip";
	this.version = "3.0";
	if (dhtmlx.assert_enabled()) {
		this._assert()
	}
	if (typeof a == "string") {
		a = {
			template: a
		}
	}
	dhtmlx.extend(this, dhtmlx.Settings);
	dhtmlx.extend(this, dhtmlx.SingleRender);
	this._parseSettings(a, {
		type: "default",
		dy: 0,
		dx: 20
	});
	this._dataobj = this._obj = document.createElement("DIV");
	this._obj.className = "dhx_tooltip";
	dhtmlx.html.insertBefore(this._obj, document.body.firstChild)
};
dhtmlx.ui.Tooltip.prototype = {
	show: function(a, c) {
		if (this._disabled) {
			return
		}
		if (this.data != a) {
			this.data = a;
			this.render(a)
		}
		this._obj.style.top = c.y + this._settings.dy + "px";
		this._obj.style.left = c.x + this._settings.dx + "px";
		this._obj.style.display = "block"
	},
	hide: function() {
		this.data = null;
		this._obj.style.display = "none"
	},
	disable: function() {
		this._disabled = true
	},
	enable: function() {
		this._disabled = false
	},
	types: {
		"default": dhtmlx.Template.fromHTML("{obj.id}")
	},
	template_item_start: dhtmlx.Template.empty,
	template_item_end: dhtmlx.Template.empty
};
dhtmlx.AutoTooltip = {
	tooltip_setter: function(c) {
		var a = new dhtmlx.ui.Tooltip(c);
		this.attachEvent("onMouseMove", function(l, g) {
			a.show(this.get(l), dhtmlx.html.pos(g))
		});
		this.attachEvent("onMouseOut", function(l, g) {
			a.hide()
		});
		this.attachEvent("onMouseMoving", function(l, g) {
			a.hide()
		});
		return a
	}
};
dhtmlx.compat = function(a, c) {
	if (dhtmlx.compat[a]) {
		dhtmlx.compat[a](c)
	}
};
if (!dhtmlx.attaches) {
	dhtmlx.attaches = {}
}
dhtmlx.attaches.attachAbstract = function(c, a) {
	var m = document.createElement("DIV");
	m.id = "CustomObject_" + dhtmlx.uid();
	m.style.width = "100%";
	m.style.height = "100%";
	m.cmp = "grid";
	document.body.appendChild(m);
	this.attachObject(m.id);
	a.container = m.id;
	var l = this.vs[this.av];
	l.grid = new window[c](a);
	l.gridId = m.id;
	l.gridObj = m;
	l.grid.setSizes = function() {
		if (this.resize) {
			this.resize()
		} else {
			this.render()
		}
	};
	var g = "_viewRestore";
	return this.vs[this[g]()].grid
};
dhtmlx.attaches.attachDataView = function(a) {
	return this.attachAbstract("dhtmlXDataView", a)
};
dhtmlx.attaches.attachChart = function(a) {
	return this.attachAbstract("dhtmlXChart", a)
};
dhtmlx.compat.layout = function() {};

function dhtmlXCellObject(g, a) {
	this.cell = document.createElement("DIV");
	this.cell.className = "dhx_cell" + (a || "");
	this._idd = g;
	this._isCell = true;
	this.conf = {
		borders: true,
		idx: {},
		css: a || "",
		idx_data: {
			cont: "dhx_cell_cont",
			pr1: "dhx_cell_progress_bar",
			pr2: "dhx_cell_progress_img",
			menu: "dhx_cell_menu",
			toolbar: "dhx_cell_toolbar",
			ribbon: "dhx_cell_ribbon",
			sb: "dhx_cell_statusbar",
			cover: "dhx_cell_cover"
		},
		ofs_nodes: {
			t: {},
			b: {}
		}
	};
	this.dataNodes = {};
	this.views = {};
	var c = document.createElement("DIV");
	c.className = "dhx_cell_cont" + this.conf.css;
	this.cell.appendChild(c);
	c = null;
	this._updateIdx = function() {
		for (var l in this.conf.idx) {
			this.conf.idx[l] = null;
			delete this.conf.idx[l]
		}
		for (var o = 0; o < this.cell.childNodes.length; o++) {
			var m = this.cell.childNodes[o].className;
			for (var l in this.conf.idx_data) {
				var n = new RegExp(this.conf.idx_data[l]);
				if (m.match(n) != null) {
					this.conf.idx[l] = o
				}
			}
		}
		this.callEvent("_onIdxUpdated", [])
	};
	this._adjustAttached = function() {
		for (var l in this.dataNodes) {
			if (this.dataNodes[l] != null && typeof(this.dataNodes[l].setSizes) == "function") {
				this.dataNodes[l].setSizes()
			}
		}
		if (this.dataObj != null && typeof(this.dataObj.setSizes) == "function") {
			if (this.dataType == "layout" && typeof(window.dhtmlXLayoutCell) != "undefined" && this instanceof window.dhtmlXLayoutCell && this.dataObj._getMainInst() != this.layout._getMainInst()) {
				this.dataObj.setSizes();
				return
			}
			this.dataObj.setSizes.apply(this.dataObj, arguments)
		}
	};
	this._setSize = function(v, s, A, o, q, r, m, n) {
		if (this.conf.size == null) {
			this.conf.size = {}
		}
		if (n == null) {
			n = {}
		}
		var C = {
			left: "x",
			top: "y",
			width: "w",
			height: "h"
		};
		this.conf.size.x = v;
		this.conf.size.y = s;
		this.conf.size.w = Math.max(A, 0);
		this.conf.size.h = Math.max(o, 0);
		for (var u in C) {
			var l = (n[u] || u);
			this.cell.style[l] = this.conf.size[C[u]] + "px"
		}
		this.callEvent("_onSetSize", []);
		if (r !== true) {
			this._adjustCont(q, m)
		} else {
			this._adjustAttached(q)
		}
		this._adjustProgress()
	};
	this._adjustCont = function(r, o) {
		var q = this.cell.childNodes[this.conf.idx.cont];
		var n = 0;
		for (var l in this.conf.ofs_nodes.t) {
			var m = this.conf.ofs_nodes.t[l];
			n += (m == "func" ? this[l]() : (m == true ? this.cell.childNodes[this.conf.idx[l]].offsetHeight : 0))
		}
		var s = 0;
		for (var l in this.conf.ofs_nodes.b) {
			var m = this.conf.ofs_nodes.b[l];
			s += (m == "func" ? this[l]() : (m == true ? this.cell.childNodes[this.conf.idx[l]].offsetHeight : 0))
		}
		q.style.left = "0px";
		q.style.top = n + "px";
		if (!this.conf.cells_cont) {
			this.conf.cells_cont = {};
			q.style.width = this.cell.offsetWidth + "px";
			q.style.height = Math.max(this.cell.offsetHeight - n - s, 0) + "px";
			this.conf.cells_cont.w = parseInt(q.style.width) - q.offsetWidth;
			this.conf.cells_cont.h = parseInt(q.style.height) - q.offsetHeight
		}
		q.style.left = "0px";
		q.style.top = n + "px";
		q.style.width = Math.max(this.cell.offsetWidth + this.conf.cells_cont.w, 0) + "px";
		q.style.height = Math.max(this.conf.size.h - n - s + this.conf.cells_cont.h, 0) + "px";
		q = null;
		this._adjustAttached(r);
		if (o == "expand" && this.dataType == "editor" && this.dataObj != null) {
			this.dataObj._prepareContent(true)
		}
	};
	this._mtbUpdBorder = function() {
		var m = ["menu", "toolbar", "ribbon"];
		for (var o = 0; o < m.length; o++) {
			if (this.conf.idx[m[o]] != null) {
				var r = this.cell.childNodes[this.conf.idx[m[o]]];
				var n = "dhx_cell_" + m[o] + "_no_borders";
				var l = "dhx_cell_" + m[o] + "_def";
				r.className = r.className.replace(new RegExp(this.conf.borders ? n : l), this.conf.borders ? l : n);
				r = null
			}
		}
	};
	this._resetSizeState = function() {
		this.conf.cells_cont = null
	};
	this.conf.view = "def";
	this.conf.views_loaded = {};
	this.conf.views_loaded[this.conf.view] = true;
	this._viewSave = function(n) {
		this.views[n] = {
			borders: this.conf.borders,
			ofs_nodes: {
				t: {},
				b: {}
			},
			url_data: this.conf.url_data,
			dataType: this.dataType,
			dataObj: this.dataObj,
			cellCont: [],
			dataNodes: {},
			dataNodesCont: {}
		};
		var o = this.cell.childNodes[this.conf.idx.cont];
		while (o.childNodes.length > 0) {
			this.views[n].cellCont.push(o.firstChild);
			o.removeChild(o.firstChild)
		}
		o = null;
		this.dataType = null;
		this.dataObj = null;
		this.conf.url_data = null;
		for (var m in this.dataNodes) {
			for (var l in this.conf.ofs_nodes) {
				if (typeof(this.conf.ofs_nodes[l][m]) != "undefined") {
					this.views[n].ofs_nodes[l][m] = this.conf.ofs_nodes[l][m];
					this.conf.ofs_nodes[l][m] = null;
					delete this.conf.ofs_nodes[l][m]
				}
			}
			this.views[n].dataNodesCont[m] = this.cell.childNodes[this.conf.idx[m]];
			this.cell.removeChild(this.cell.childNodes[this.conf.idx[m]]);
			this.views[n].dataNodes[m] = this.dataNodes[m];
			this.dataNodes[m] = null;
			delete this.dataNodes[m];
			this._updateIdx()
		}
		this.callEvent("_onViewSave", [n])
	};
	this._viewRestore = function(n) {
		if (this.views[n] == null) {
			return
		}
		this.dataObj = this.views[n].dataObj;
		this.dataType = this.views[n].dataType;
		this.conf.url_data = this.views[n].url_data;
		for (var o = 0; o < this.views[n].cellCont.length; o++) {
			this.cell.childNodes[this.conf.idx.cont].appendChild(this.views[n].cellCont[o])
		}
		for (var m in this.views[n].dataNodes) {
			this.dataNodes[m] = this.views[n].dataNodes[m];
			if (m == "menu") {
				this.cell.insertBefore(this.views[n].dataNodesCont[m], this.cell.childNodes[this.conf.idx.toolbar || this.conf.idx.cont])
			}
			if (m == "toolbar") {
				this.cell.insertBefore(this.views[n].dataNodesCont[m], this.cell.childNodes[this.conf.idx.cont])
			}
			if (m == "sb") {
				this.cell.appendChild(this.views[n].dataNodesCont[m])
			}
			this._updateIdx()
		}
		for (var m in this.views[n].ofs_nodes) {
			for (var l in this.views[n].ofs_nodes[m]) {
				this.conf.ofs_nodes[m][l] = this.views[n].ofs_nodes[m][l]
			}
		}
		if (this.conf.borders != this.views[n].borders) {
			this[this.views[n].borders ? "_showBorders" : "_hideBorders"](true)
		}
		if (this.dataType == "url" && this.conf.url_data != null && this.conf.url_data.ajax == false && this.conf.url_data.post_data != null) {
			this.reloadURL()
		}
		this.callEvent("_onViewRestore", [n]);
		this._viewDelete(n)
	};
	this._viewDelete = function(n) {
		if (this.views[n] == null) {
			return
		}
		this.views[n].borders = null;
		for (var m in this.views[n].ofs_nodes) {
			for (var l in this.views[n].ofs_nodes[m]) {
				this.views[n].ofs_nodes[m][l] = null
			}
			this.views[n].ofs_nodes[m] = null
		}
		this.views[n].dataType = null;
		this.views[n].dataObj = null;
		this.views[n].url_data = null;
		for (var o = 0; o < this.views[n].cellCont.length; o++) {
			this.views[n].cellCont[o] = null
		}
		this.views[n].cellCont = null;
		for (var m in this.views[n].dataNodes) {
			this.views[n].dataNodes[m] = null;
			this.views[n].dataNodesCont[m] = null
		}
		this.views[n].dataNodes = this.views[n].dataNodesCont = null;
		this.views[n] = null;
		delete this.views[n]
	};
	window.dhx4._eventable(this);
	this._updateIdx();
	return this
}
dhtmlXCellObject.prototype.showView = function(a) {
	if (this.conf.view == a) {
		return false
	}
	this._viewSave(this.conf.view);
	this._viewRestore(a);
	this._updateIdx();
	this._adjustCont();
	this.conf.view = a;
	var c = (typeof(this.conf.views_loaded[this.conf.view]) == "undefined");
	this.conf.views_loaded[this.conf.view] = true;
	return c
};
dhtmlXCellObject.prototype.getViewName = function() {
	return this.conf.view
};
dhtmlXCellObject.prototype.unloadView = function(l) {
	if (l == this.conf.view) {
		var m = this.conf.unloading;
		this.conf.unloading = true;
		if (typeof(this.detachMenu) == "function") {
			this.detachMenu()
		}
		if (typeof(this.detachToolbar) == "function") {
			this.detachToolbar()
		}
		if (typeof(this.detachRibbon) == "function") {
			this.detachRibbon()
		}
		this.detachStatusBar();
		this._detachObject(null, true);
		this.conf.unloading = m;
		if (!this.conf.unloading) {
			this._adjustCont(this._idd)
		}
		return
	}
	if (this.views[l] == null) {
		return
	}
	var g = this.views[l];
	for (var c in g.dataNodes) {
		if (typeof(g.dataNodes[c].unload) == "function") {
			g.dataNodes[c].unload()
		}
		g.dataNodes[c] = null;
		g.dataNodesCont[c] = null
	}
	if (g.dataType == "url") {
		if (g.cellCont != null && g.cellCont[0] != "null") {
			this._detachURLEvents(g.cellCont[0])
		}
	} else {
		if (g.dataObj != null) {
			if (typeof(g.dataObj.unload) == "function") {
				g.dataObj.unload()
			} else {
				if (typeof(g.dataObj.destructor) == "function") {
					g.dataObj.destructor()
				}
			}
			g.dataObj = null
		}
	}
	g = null;
	this._viewDelete(l);
	if (typeof(this.conf.views_loaded[l]) != "undefined") {
		delete this.conf.views_loaded[l]
	}
};
dhtmlXCellObject.prototype.getId = function() {
	return this._idd
};
dhtmlXCellObject.prototype.progressOn = function() {
	if (this.conf.progress == true) {
		return
	}
	this.conf.progress = true;
	var c = document.createElement("DIV");
	c.className = this.conf.idx_data.pr1;
	var a = document.createElement("DIV");
	a.className = this.conf.idx_data.pr2;
	if (this.conf.idx.cover != null) {
		this.cell.insertBefore(a, this.cell.childNodes[this.conf.idx.cover])
	} else {
		this.cell.appendChild(a)
	}
	this.cell.insertBefore(c, a);
	c = a = null;
	this._updateIdx();
	this._adjustProgress()
};
dhtmlXCellObject.prototype.progressOff = function() {
	if (this.conf.progress != true) {
		return
	}
	this.cell.childNodes[this.conf.idx.pr2].parentNode.removeChild(this.cell.childNodes[this.conf.idx.pr2]);
	this.cell.childNodes[this.conf.idx.pr1].parentNode.removeChild(this.cell.childNodes[this.conf.idx.pr1]);
	this.conf.progress = false;
	this._updateIdx()
};
dhtmlXCellObject.prototype._adjustProgress = function() {
	if (this.conf.idx.pr1 == null) {
		return
	}
	if (!this.conf.pr) {
		this.conf.pr = {}
	}
	var c = this.cell.childNodes[this.conf.idx.pr1];
	var a = this.cell.childNodes[this.conf.idx.pr2];
	if (!this.conf.pr.ofs) {
		a.style.width = c.offsetWidth + "px";
		a.style.height = c.offsetHeight + "px";
		this.conf.pr.ofs = {
			w: a.offsetWidth - a.clientWidth,
			h: a.offsetHeight - a.clientHeight
		}
	}
	a.style.width = c.offsetWidth - this.conf.pr.ofs.w + "px";
	a.style.height = c.offsetHeight - this.conf.pr.ofs.h + "px";
	c = a = null
};
dhtmlXCellObject.prototype._showCellCover = function() {
	if (this.conf.cover == true) {
		return
	}
	this.conf.cover = true;
	var a = document.createElement("DIV");
	a.className = this.conf.idx_data.cover;
	this.cell.appendChild(a);
	a = null;
	this._updateIdx()
};
dhtmlXCellObject.prototype._hideCellCover = function() {
	if (this.conf.cover != true) {
		return
	}
	this.cell.removeChild(this.cell.childNodes[this.conf.idx.cover]);
	this._updateIdx();
	this.conf.cover = false
};
dhtmlXCellObject.prototype._showBorders = function(a) {
	if (this.conf.borders) {
		return
	}
	this.conf.borders = true;
	this.cell.childNodes[this.conf.idx.cont].className = "dhx_cell_cont" + this.conf.css;
	this.conf.cells_cont = null;
	this._mtbUpdBorder();
	this.callEvent("_onBorderChange", [true]);
	if (a !== true) {
		this._adjustCont(this._idd)
	}
};
dhtmlXCellObject.prototype._hideBorders = function(a) {
	if (!this.conf.borders) {
		return
	}
	this.conf.borders = false;
	this.cell.childNodes[this.conf.idx.cont].className = "dhx_cell_cont" + this.conf.css + " dhx_cell_cont_no_borders";
	this.conf.cells_cont = null;
	this._mtbUpdBorder();
	this.callEvent("_onBorderChange", [false]);
	if (a !== true) {
		this._adjustCont(this._idd)
	}
};
dhtmlXCellObject.prototype._getWidth = function() {
	return this.cell.offsetWidth
};
dhtmlXCellObject.prototype._getHeight = function() {
	return this.cell.offsetHeight
};
dhtmlXCellObject.prototype.showInnerScroll = function() {
	this.cell.childNodes[this.conf.idx.cont].style.overflow = "auto"
};
dhtmlXCellObject.prototype._unload = function() {
	this.conf.unloading = true;
	this.callEvent("_onCellUnload", []);
	this.progressOff();
	this.unloadView(this.conf.view);
	this.dataNodes = null;
	this.cell.parentNode.removeChild(this.cell);
	this.cell = null;
	window.dhx4._eventable(this, "clear");
	for (var c in this.views) {
		this.unloadView(c)
	}
	this.conf = null;
	for (var c in this) {
		this[c] = null
	}
};
dhtmlXCellObject.prototype.attachObject = function(l, g) {
	if (window.dhx4.s2b(g) && !(typeof(window.dhtmlXWindowsCell) != "undefined" && (this instanceof window.dhtmlXWindowsCell))) {
		g = false
	}
	if (typeof(l) == "string") {
		l = document.getElementById(l)
	}
	if (l.parentNode == this.cell.childNodes[this.conf.idx.cont]) {
		l = null;
		return
	}
	if (g) {
		l.style.display = "";
		var a = l.offsetWidth;
		var c = l.offsetHeight
	}
	this._attachObject(l);
	this.dataType = "obj";
	l.style.display = "";
	l = null;
	if (g) {
		this._adjustByCont(a, c)
	}
};
dhtmlXCellObject.prototype.appendObject = function(a) {
	if (typeof(a) == "string") {
		a = document.getElementById(a)
	}
	if (a.parentNode == this.cell.childNodes[this.conf.idx.cont]) {
		a = null;
		return
	}
	if (!this.conf.append_mode) {
		this.cell.childNodes[this.conf.idx.cont].style.overflow = "auto";
		this.conf.append_mode = true
	}
	this._attachObject(a, null, null, true);
	this.dataType = "obj";
	a.style.display = "";
	a = null
};
dhtmlXCellObject.prototype.detachObject = function(c, a) {
	this._detachObject(null, c, a)
};
dhtmlXCellObject.prototype.getAttachedStatusBar = function() {
	return this.dataNodes.sb
};
dhtmlXCellObject.prototype.getAttachedObject = function() {
	return this.dataObj
};
dhtmlXCellObject.prototype.attachURL = function(c, s, g) {
	if (g == true) {
		g = {}
	}
	var l = (typeof(g) != "undefined" && g != false && g != null);
	if (!this.conf.url_data) {
		this.conf.url_data = {}
	}
	this.conf.url_data.url = c;
	this.conf.url_data.ajax = (s == true);
	this.conf.url_data.post_data = (g == true ? {} : (g || null));
	if (s == true) {
		var r = this;
		if (l) {
			var m = "";
			for (var q in g) {
				m += "&" + encodeURIComponent(q) + "=" + encodeURIComponent(g[q])
			}
			dhx4.ajax.post(c, m, function(a) {
				r.attachHTMLString("<div style='position:relative;width:100%;height:100%;overflow:auto;'>" + a.xmlDoc.responseText + "</div>");
				if (typeof(r._doOnFrameContentLoaded) == "function") {
					r._doOnFrameContentLoaded()
				}
				r.dataType = "url-ajax";
				r = a = null
			})
		} else {
			dhx4.ajax.get(c, function(a) {
				r.attachHTMLString("<div style='position:relative;width:100%;height:100%;overflow:auto;'>" + a.xmlDoc.responseText + "</div>");
				if (typeof(r._doOnFrameContentLoaded) == "function") {
					r._doOnFrameContentLoaded()
				}
				r.dataType = "url-ajax";
				r = a = null
			})
		}
	} else {
		if (this.dataType == "url") {
			var n = this.getFrame()
		} else {
			var n = document.createElement("IFRAME");
			n.frameBorder = 0;
			n.border = 0;
			n.style.width = "100%";
			n.style.height = "100%";
			n.style.position = "relative";
			this._attachObject(n);
			this.dataType = "url";
			this._attachURLEvents()
		}
		if (l) {
			var o = (typeof(this.conf.url_data.post_ifr) == "undefined");
			this.conf.url_data.post_ifr = true;
			if (o) {
				this._attachURLEvents()
			}
			n.src = "about:blank"
		} else {
			n.src = c + (window.dhx4.ajax.cache != true ? (c.indexOf("?") >= 0 ? "&" : "?") + "dhxr" + new Date().getTime() : "")
		}
		n = null
	}
	n = null
};
dhtmlXCellObject.prototype.reloadURL = function() {
	if (!(this.dataType == "url" || this.dataType == "url-ajax")) {
		return
	}
	if (this.conf.url_data == null) {
		return
	}
	this.attachURL(this.conf.url_data.url, this.conf.url_data.ajax, this.conf.url_data.post_data)
};
dhtmlXCellObject.prototype.attachHTMLString = function(str) {
	this._attachObject(null, null, str);
	var z = str.match(/<script[^>]*>[^\f]*?<\/script>/g) || [];
	for (var i = 0; i < z.length; i++) {
		var s = z[i].replace(/<([\/]{0,1})script[^>]*>/gi, "");
		if (s) {
			if (window.execScript) {
				window.execScript(s)
			} else {
				window.eval(s)
			}
		}
	}
};
dhtmlXCellObject.prototype.attachScheduler = function(a, o, c, l) {
	l = l || window.scheduler;
	var m = false;
	if (c) {
		var n = document.getElementById(c);
		if (n) {
			m = true
		}
	}
	if (!m) {
		var g = c || '<div class="dhx_cal_tab" name="day_tab" style="right:204px;"></div><div class="dhx_cal_tab" name="week_tab" style="right:140px;"></div><div class="dhx_cal_tab" name="month_tab" style="right:76px;"></div>';
		var n = document.createElement("DIV");
		n.id = "dhxSchedObj_" + new Date().getTime();
		n.style.width = "100%";
		n.style.height = "100%";
		n.style.position = "relative";
		n.style.overflow = "hidden";
		n.className = "dhx_cal_container";
		n.innerHTML = '<div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;</div><div class="dhx_cal_next_button">&nbsp;</div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div>' + g + '</div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div>'
	}
	this._attachObject(n);
	this.dataType = "scheduler";
	this.dataObj = l;
	this.dataObj.setSizes = function() {
		this.update_view()
	};
	l.init(n.id, a, o);
	n = null;
	this.callEvent("_onContentAttach", []);
	return this.dataObj
};
dhtmlXCellObject.prototype.attachMap = function(a) {
	var c = document.createElement("DIV");
	c.id = "GMapsObj_" + this._genStr(12);
	c.style.width = "100%";
	c.style.height = "100%";
	c.style.position = "relative";
	c.style.overflow = "hidden";
	this._attachObject(c);
	if (!a) {
		a = {
			center: new google.maps.LatLng(40.719837, -73.992348),
			zoom: 11,
			mapTypeId: google.maps.MapTypeId.ROADMAP
		}
	}
	this.dataType = "maps";
	this.dataObj = new google.maps.Map(c, a);
	this.dataObj.setSizes = function() {
		google.maps.event.trigger(this, "resize")
	};
	c = null;
	this.callEvent("_onContentAttach", []);
	return this.dataObj
};
dhtmlXCellObject.prototype._createNode_sb = function(o, l, n, a, m) {
	if (typeof(m) != "undefined") {
		o = m
	} else {
		var c = l || {};
		var q = (typeof(c.text) == "string" && c.text.length > 0 ? c.text : "&nbsp;");
		var g = (typeof(c.height) == "number" ? c.height : false);
		var o = document.createElement("DIV");
		o.className = "dhx_cell_statusbar_def";
		o.innerHTML = "<div class='" + (c.paging == true ? "dhx_cell_statusbar_paging" : "dhx_cell_statusbar_text") + "'>" + q + "</div>";
		if (g != false) {
			o.firstChild.style.height = o.firstChild.style.lineHeight = g + "px"
		}
	}
	if (this.conf.idx.pr1 != null) {
		this.cell.insertBefore(o, this.cell.childNodes[this.conf.idx.pr1])
	} else {
		this.cell.appendChild(o)
	}
	this.conf.ofs_nodes.b.sb = true;
	this._updateIdx();
	this._adjustCont(this._idd);
	return o
};
dhtmlXCellObject.prototype.attachStatusBar = function(a) {
	if (this.dataNodes.sb) {
		return
	}
	if (a != null && window.dhx4.s2b(a.paging) == true) {
		a.height = null
	}
	if (this.conf.skin == "dhx_skyblue" && typeof(window.dhtmlXWindowsCell) != "undefined" && (this instanceof dhtmlXWindowsCell)) {
		this.cell.childNodes[this.conf.idx.cont].className += " dhx_cell_statusbar_attached"
	}
	this.dataNodes.sb = this._attachObject("sb", a);
	this.dataNodes.sb.setText = function(c) {
		this.childNodes[0].innerHTML = c
	};
	this.dataNodes.sb.getText = function() {
		return this.childNodes[0].innerHTML
	};
	this.dataNodes.sb.onselectstart = function(c) {
		return false
	};
	return this.dataNodes.sb
};
dhtmlXCellObject.prototype.detachStatusBar = function() {
	if (!this.dataNodes.sb) {
		return
	}
	if (this.conf.skin == "dhx_skyblue" && typeof(window.dhtmlXWindowsCell) != "undefined" && (this instanceof dhtmlXWindowsCell)) {
		this.cell.childNodes[this.conf.idx.cont].className = this.cell.childNodes[this.conf.idx.cont].className.replace(/\s{0,}dhx_cell_statusbar_attached/, "")
	}
	this.dataNodes.sb.setText = this.dataNodes.sb.getText = this.dataNodes.sb.onselectstart = null;
	this.dataNodes.sb = null;
	delete this.dataNodes.sb;
	this._detachObject("sb")
};
dhtmlXCellObject.prototype.showStatusBar = function() {
	this._mtbShowHide("sb", "")
};
dhtmlXCellObject.prototype.hideStatusBar = function() {
	this._mtbShowHide("sb", "none")
};
dhtmlXCellObject.prototype._mtbShowHide = function(c, a) {
	if (!this.dataNodes[c]) {
		return
	}
	this.cell.childNodes[this.conf.idx[c]].style.display = a;
	this._adjustCont()
};
dhtmlXCellObject.prototype.getFrame = dhtmlXCellObject.prototype._getFrame = function() {
	if (this.dataType != "url") {
		return null
	}
	return this.cell.childNodes[this.conf.idx.cont].firstChild
};
dhtmlXCellObject.prototype._genStr = function() {
	if (!this._genStrId) {
		this._genStrId = new Date().getTime()
	}
	return this._genStrId++
};
dhtmlXCellObject.prototype._attachURLEvents = function() {
	if (this.dataType != "url") {
		return
	}
	var g = this;
	var c = this._idd;
	var a = this.cell.childNodes[this.conf.idx.cont].firstChild;
	if (typeof(this._doOnFrameMouseDown) != "function") {
		this._doOnFrameMouseDown = function(l) {
			g.callEvent("_onContentMouseDown", [c, l || event])
		}
	}
	if (typeof(window.addEventListener) == "function") {
		a.onload = function() {
			try {
				if (typeof(g._doOnFrameMouseDown) == "function") {
					this.contentWindow.document.body.addEventListener("mousedown", g._doOnFrameMouseDown, false)
				}
			} catch (l) {}
			try {
				if (typeof(g._doOnFrameContentLoaded) == "function") {
					g._doOnFrameContentLoaded()
				}
			} catch (l) {}
		}
	} else {
		a.onreadystatechange = function(l) {
			if (this.readyState == "complete") {
				try {
					if (typeof(g._doOnFrameMouseDown) == "function") {
						this.contentWindow.document.body.attachEvent("onmousedown", g._doOnFrameMouseDown)
					}
				} catch (m) {}
				try {
					if (typeof(g._doOnFrameContentLoaded) == "function") {
						g._doOnFrameContentLoaded()
					}
				} catch (m) {}
			}
		}
	}
};
dhtmlXCellObject.prototype._doOnFrameContentLoaded = function() {
	if (this.conf.url_data.post_ifr == true) {
		var n = this.getFrame().contentWindow.document;
		var m = n.createElement("FORM");
		m.method = "POST";
		m.action = this.conf.url_data.url;
		n.body.appendChild(m);
		var g = {};
		if (window.dhx4.ajax.cache != true) {
			g["dhxr" + new Date().getTime()] = "1"
		}
		for (var c in this.conf.url_data.post_data) {
			g[c] = this.conf.url_data.post_data[c]
		}
		for (var c in g) {
			var l = n.createElement("INPUT");
			l.type = "hidden";
			l.name = c;
			l.value = g[c];
			m.appendChild(l);
			l = null
		}
		this.conf.url_data.post_ifr = false;
		m.submit()
	} else {
		this.callEvent("_onContentLoaded", [this._idd])
	}
};
dhtmlXCellObject.prototype._detachURLEvents = function(a) {
	if (a == null) {
		if (this.dataType != "url") {
			return
		}
		a = this.cell.childNodes[this.conf.idx.cont].firstChild
	}
	if (typeof(window.addEventListener) == "function") {
		a.onload = null;
		try {
			a.contentWindow.document.body.removeEventListener("mousedown", this._doOnFrameMouseDown, false)
		} catch (c) {}
	} else {
		a.onreadystatechange = null;
		try {
			a.contentWindow.document.body.detachEvent("onmousedown", this._doOnFrameMouseDown)
		} catch (c) {}
	}
	a = null
};
dhtmlXCellObject.prototype._attachObject = function(m, c, l, a, g) {
	if (typeof(m) == "string" && {
			menu: 1,
			toolbar: 1,
			ribbon: 1,
			sb: 1
		}[m] == 1) {
		return this["_createNode_" + m].apply(this, arguments)
	}
	if (a != true) {
		this._detachObject(null, true, null)
	}
	if (typeof(l) == "string") {
		this.cell.childNodes[this.conf.idx.cont].innerHTML = l
	} else {
		this.cell.childNodes[this.conf.idx.cont].appendChild(m)
	}
	m = null
};
dhtmlXCellObject.prototype._detachObject = function(m, c, a) {
	this.callEvent("_onBeforeContentDetach", []);
	if (m == "menu" || m == "toolbar" || m == "ribbon" || m == "sb") {
		var l = this.cell.childNodes[this.conf.idx[m]];
		l.parentNode.removeChild(l);
		l = null;
		this.conf.ofs_nodes[m == "sb" ? "b" : "t"][m] = false;
		this._updateIdx();
		if (!this.conf.unloading) {
			this._adjustCont(this._idd)
		}
		return
	}
	if (c == true) {
		a = false
	} else {
		if (typeof(a) == "undefined") {
			a = document.body
		} else {
			if (typeof(a) == "string") {
				a = document.getElementById(a)
			}
		}
	}
	if (a === false) {
		if (this.dataType == "url") {
			this._detachURLEvents()
		} else {
			if (this.dataObj != null) {
				if (typeof(this.dataObj.unload) == "function") {
					this.dataObj.unload()
				} else {
					if (typeof(this.dataObj.destructor) == "function") {
						this.dataObj.destructor()
					}
				}
			}
		}
	}
	var l = this.cell.childNodes[this.conf.idx.cont];
	while (l.childNodes.length > 0) {
		if (a === false) {
			l.removeChild(l.lastChild)
		} else {
			l.firstChild.style.display = "none";
			a.appendChild(l.firstChild)
		}
	}
	if (this.conf.append_mode) {
		l.style.overflow = "";
		this.conf.append_mode = false
	}
	var g = (this.dataType == "tabbar");
	this.dataObj = null;
	this.dataType = null;
	a = l = null;
	if (this.conf.unloading != true && g) {
		this.showHeader(true);
		this._showBorders()
	}
};
dhtmlXCellObject.prototype._attachFromCell = function(c) {
	this.detachObject(true);
	var l = "layout";
	if (typeof(window.dhtmlXWindowsCell) != "undefined" && this instanceof window.dhtmlXWindowsCell) {
		l = "window"
	}
	if (typeof(window.dhtmlXWindowsCell) != "undefined" && c instanceof window.dhtmlXWindowsCell && c.wins.w[c._idd].conf.parked) {
		c.wins._winCellSetOpacity(c._idd, "open", false)
	}
	if (typeof(window.dhtmlXAccordionCell) != "undefined" && c instanceof window.dhtmlXAccordionCell && c.conf.opened == false) {
		c._cellSetOpacity("open", false)
	}
	for (var g in c.dataNodes) {
		this._attachObject(g, null, null, null, c.cell.childNodes[c.conf.idx[g]]);
		this.dataNodes[g] = c.dataNodes[g];
		c.dataNodes[g] = null;
		c.conf.ofs_nodes[g == "sb" ? "b" : "t"][g] = false;
		c._updateIdx()
	}
	this._mtbUpdBorder();
	if (c.dataType != null && c.dataObj != null) {
		this.dataType = c.dataType;
		this.dataObj = c.dataObj;
		while (c.cell.childNodes[c.conf.idx.cont].childNodes.length > 0) {
			this.cell.childNodes[this.conf.idx.cont].appendChild(c.cell.childNodes[c.conf.idx.cont].firstChild)
		}
		c.dataType = null;
		c.dataObj = null;
		if (this.dataType == "grid") {
			if (l == "window" && this.conf.skin == "dhx_skyblue") {
				this.dataObj.entBox.style.border = "1px solid #a4bed4";
				this.dataObj._sizeFix = 0
			} else {
				this.dataObj.entBox.style.border = "0px solid white";
				this.dataObj._sizeFix = 2
			}
		}
	} else {
		while (c.cell.childNodes[c.conf.idx.cont].childNodes.length > 0) {
			this.cell.childNodes[this.conf.idx.cont].appendChild(c.cell.childNodes[c.conf.idx.cont].firstChild)
		}
	}
	this.conf.view = c.conf.view;
	c.conf.view = "def";
	for (var g in c.views) {
		this.views[g] = c.views[g];
		c.views[g] = null;
		delete c.views[g]
	}
	c._updateIdx();
	c._adjustCont();
	this._updateIdx();
	this._adjustCont();
	if (c.conf.progress == true) {
		c.progressOff();
		this.progressOn()
	} else {
		this.progressOff()
	}
	if (l == "window" && this.wins.w[this._idd].conf.parked) {
		this.wins._winCellSetOpacity(this._idd, "close", false)
	}
};

function dhtmlXCellTop(l, c) {
	if (arguments.length == 0 || typeof(l) == "undefined") {
		return
	}
	var a = this;
	this.dataNodes = {};
	this.conf.ofs = {
		t: 0,
		b: 0,
		l: 0,
		r: 0
	};
	this.conf.ofs_nodes = {
		t: {},
		b: {}
	};
	this.conf.progress = false;
	this.conf.fs_mode = false;
	this.conf.fs_tm = null;
	this.conf.fs_resize = false;
	if (l == document.body) {
		this.conf.fs_mode = true;
		this.base = l;
		if (this.base == document.body) {
			var g = {
				dhx_skyblue: {
					t: 2,
					b: 2,
					l: 2,
					r: 2
				},
				dhx_web: {
					t: 8,
					b: 8,
					l: 8,
					r: 8
				},
				dhx_terrace: {
					t: 9,
					b: 9,
					l: 8,
					r: 8
				}
			};
			this.conf.ofs = (g[this.conf.skin] != null ? g[this.conf.skin] : g.dhx_skyblue)
		}
	} else {
		this.base = (typeof(l) == "string" ? document.getElementById(l) : l)
	}
	this.base.className += " " + this.conf.css + "_base_" + this.conf.skin;
	this.cont = document.createElement("DIV");
	this.cont.className = this.conf.css + "_cont";
	this.base.appendChild(this.cont);
	if (c != null) {
		this.setOffsets(c, false)
	} else {
		if (this.base._ofs != null) {
			this.setOffsets(this.base._ofs, false);
			this.base._ofs = null;
			try {
				delete this.base._ofs
			} catch (m) {}
		}
	}
	this._adjustCont = function() {
		var q = this.conf.ofs.t;
		for (var o in this.conf.ofs_nodes.t) {
			q += (this.conf.ofs_nodes.t[o] == true ? this.dataNodes[o].offsetHeight : 0)
		}
		var n = this.conf.ofs.b;
		for (var o in this.conf.ofs_nodes.b) {
			n += (this.conf.ofs_nodes.b[o] == true ? this.dataNodes[o].offsetHeight : 0)
		}
		this.cont.style.left = this.conf.ofs.l + "px";
		this.cont.style.width = this.base.offsetWidth - this.conf.ofs.l - this.conf.ofs.r + "px";
		this.cont.style.top = q + "px";
		this.cont.style.height = this.base.offsetHeight - q - n + "px"
	};
	this._setBaseSkin = function(n) {
		this.base.className = this.base.className.replace(new RegExp(this.conf.css + "_base_" + this.conf.skin, "gi"), this.conf.css + "_base_" + n)
	};
	this._initFSResize = function() {
		if (this.conf.fs_resize == true) {
			return
		}
		this._doOnResizeStart = function() {
			window.clearTimeout(a.conf.fs_tm);
			a.conf.fs_tm = window.setTimeout(a._doOnResizeEnd, 200)
		};
		this._doOnResizeEnd = function() {
			a.setSizes()
		};
		if (typeof(window.addEventListener) == "function") {
			window.addEventListener("resize", this._doOnResizeStart, false)
		} else {
			window.attachEvent("onresize", this._doOnResizeStart)
		}
		this.conf.fs_resize = true
	};
	if (this.conf.fs_mode == true) {
		this._initFSResize()
	}
	this._unloadTop = function() {
		this._mtbUnload();
		this.detachHeader();
		this.detachFooter();
		if (this.conf.fs_mode == true) {
			if (typeof(window.addEventListener) == "function") {
				window.removeEventListener("resize", this._doOnResizeStart, false)
			} else {
				window.detachEvent("onresize", this._doOnResizeStart)
			}
		}
		this.base.removeChild(this.cont);
		var n = new RegExp("s{0,}" + this.conf.css + "_base_" + this.conf.skin, "gi");
		this.base.className = this.base.className.replace(n, "");
		this.cont = this.base = null;
		a = null
	};
	l = null
}
dhtmlXCellTop.prototype.setOffsets = function(n, m) {
	var l = false;
	for (var c in n) {
		var g = c.charAt(0);
		if (typeof(this.conf.ofs[g]) != "undefined" && !isNaN(n[c])) {
			this.conf.ofs[g] = parseInt(n[c]);
			l = true
		}
	}
	if (m !== false && typeof(this.setSizes) == "function" && l == true) {
		this.setSizes()
	}
};
dhtmlXCellTop.prototype.attachMenu = function(a) {
	if (this.dataNodes.menu != null) {
		return
	}
	this.dataNodes.menuObj = document.createElement("DIV");
	this.dataNodes.menuObj.className = "dhxcelltop_menu";
	this.base.insertBefore(this.dataNodes.menuObj, this.dataNodes.toolbarObj || this.dataNodes.ribbonObj || this.cont);
	if (typeof(a) != "object" || a == null) {
		a = {}
	}
	a.skin = this.conf.skin;
	a.parent = this.dataNodes.menuObj;
	this.dataNodes.menu = new dhtmlXMenuObject(a);
	this.dataNodes.menuEv = this.attachEvent("_onSetSizes", function() {
		if (this.dataNodes.menuObj.style.display == "none") {
			return
		}
		this.dataNodes.menuObj.style.left = this.conf.ofs.l + "px";
		this.dataNodes.menuObj.style.marginTop = (this.dataNodes.haObj != null ? 0 : this.conf.ofs.t) + "px";
		this.dataNodes.menuObj.style.width = this.base.offsetWidth - this.conf.ofs.l - this.conf.ofs.r + "px"
	});
	this.conf.ofs_nodes.t.menuObj = true;
	this.setSizes();
	a.parnt = null;
	a = null;
	return this.dataNodes.menu
};
dhtmlXCellTop.prototype.detachMenu = function() {
	if (this.dataNodes.menu == null) {
		return
	}
	this.dataNodes.menu.unload();
	this.dataNodes.menu = null;
	this.dataNodes.menuObj.parentNode.removeChild(this.dataNodes.menuObj);
	this.dataNodes.menuObj = null;
	this.detachEvent(this.dataNodes.menuEv);
	this.dataNodes.menuEv = null;
	delete this.dataNodes.menu;
	delete this.dataNodes.menuObj;
	delete this.dataNodes.menuEv;
	this.conf.ofs_nodes.t.menuObj = false;
	if (!this.conf.unloading) {
		this.setSizes()
	}
};
dhtmlXCellTop.prototype.attachToolbar = function(a) {
	if (!(this.dataNodes.ribbon == null && this.dataNodes.toolbar == null)) {
		return
	}
	this.dataNodes.toolbarObj = document.createElement("DIV");
	this.dataNodes.toolbarObj.className = "dhxcelltop_toolbar";
	this.base.insertBefore(this.dataNodes.toolbarObj, this.cont);
	this.dataNodes.toolbarObj.appendChild(document.createElement("DIV"));
	if (typeof(a) != "object" || a == null) {
		a = {}
	}
	a.skin = this.conf.skin;
	a.parent = this.dataNodes.toolbarObj.firstChild;
	this.dataNodes.toolbar = new dhtmlXToolbarObject(a);
	this.dataNodes.toolbarEv = this.attachEvent("_onSetSizes", function() {
		if (this.dataNodes.toolbarObj.style.display == "none") {
			return
		}
		this.dataNodes.toolbarObj.style.left = this.conf.ofs.l + "px";
		this.dataNodes.toolbarObj.style.marginTop = (this.dataNodes.haObj != null || this.dataNodes.menuObj != null ? 0 : this.conf.ofs.t) + "px";
		this.dataNodes.toolbarObj.style.width = this.base.offsetWidth - this.conf.ofs.l - this.conf.ofs.r + "px"
	});
	this.dataNodes.toolbar._masterCell = this;
	this.dataNodes.toolbar.attachEvent("_onIconSizeChange", function() {
		this._masterCell.setSizes()
	});
	this.conf.ofs_nodes.t.toolbarObj = true;
	this.setSizes();
	a.parnt = null;
	a = null;
	return this.dataNodes.toolbar
};
dhtmlXCellTop.prototype.detachToolbar = function() {
	if (this.dataNodes.toolbar == null) {
		return
	}
	this.dataNodes.toolbar._masterCell = null;
	this.dataNodes.toolbar.unload();
	this.dataNodes.toolbar = null;
	this.dataNodes.toolbarObj.parentNode.removeChild(this.dataNodes.toolbarObj);
	this.dataNodes.toolbarObj = null;
	this.detachEvent(this.dataNodes.toolbarEv);
	this.dataNodes.toolbarEv = null;
	this.conf.ofs_nodes.t.toolbarObj = false;
	delete this.dataNodes.toolbar;
	delete this.dataNodes.toolbarObj;
	delete this.dataNodes.toolbarEv;
	if (!this.conf.unloading) {
		this.setSizes()
	}
};
dhtmlXCellTop.prototype.attachRibbon = function(a) {
	if (!(this.dataNodes.ribbon == null && this.dataNodes.toolbar == null)) {
		return
	}
	this.dataNodes.ribbonObj = document.createElement("DIV");
	this.dataNodes.ribbonObj.className = "dhxcelltop_ribbon";
	this.base.insertBefore(this.dataNodes.ribbonObj, this.cont);
	this.dataNodes.ribbonObj.appendChild(document.createElement("DIV"));
	if (typeof(a) != "object" || a == null) {
		a = {}
	}
	a.skin = this.conf.skin;
	a.parent = this.dataNodes.ribbonObj.firstChild;
	this.dataNodes.ribbon = new dhtmlXRibbon(a);
	this.dataNodes.ribbonEv = this.attachEvent("_onSetSizes", function() {
		if (this.dataNodes.ribbonObj.style.display == "none") {
			return
		}
		this.dataNodes.ribbonObj.style.left = this.conf.ofs.l + "px";
		this.dataNodes.ribbonObj.style.marginTop = (this.dataNodes.haObj != null || this.dataNodes.menuObj != null ? 0 : this.conf.ofs.t) + "px";
		this.dataNodes.ribbonObj.style.width = this.base.offsetWidth - this.conf.ofs.l - this.conf.ofs.r + "px";
		this.dataNodes.ribbon.setSizes()
	});
	this.conf.ofs_nodes.t.ribbonObj = true;
	var c = this;
	this.dataNodes.ribbon.attachEvent("_onHeightChanged", function() {
		c.setSizes()
	});
	this.setSizes();
	a.parnt = null;
	a = null;
	return this.dataNodes.ribbon
};
dhtmlXCellTop.prototype.detachRibbon = function() {
	if (this.dataNodes.ribbon == null) {
		return
	}
	this.dataNodes.ribbon.unload();
	this.dataNodes.ribbon = null;
	this.dataNodes.ribbonObj.parentNode.removeChild(this.dataNodes.ribbonObj);
	this.dataNodes.ribbonObj = null;
	this.detachEvent(this.dataNodes.ribbonEv);
	this.dataNodes.ribbonEv = null;
	this.conf.ofs_nodes.t.ribbonObj = false;
	delete this.dataNodes.ribbon;
	delete this.dataNodes.ribbonObj;
	delete this.dataNodes.ribbonEv;
	if (!this.conf.unloading) {
		this.setSizes()
	}
};
dhtmlXCellTop.prototype.attachStatusBar = function(a) {
	if (this.dataNodes.sbObj) {
		return
	}
	if (typeof(a) == "undefined") {
		a = {}
	}
	this.dataNodes.sbObj = document.createElement("DIV");
	this.dataNodes.sbObj.className = "dhxcelltop_statusbar";
	if (this.cont.nextSibling != null) {
		this.base.insertBefore(this.dataNodes.sbObj, this.cont.nextSibling)
	} else {
		this.base.appendChild(this.dataNodes.sbObj)
	}
	this.dataNodes.sbObj.innerHTML = "<div class='dhxcont_statusbar'>" + (typeof(a.text) == "string" && a.text.length > 0 ? a.text : "&nbsp;") + "</div>";
	if (typeof(a.height) == "number") {
		this.dataNodes.sbObj.firstChild.style.height = this.dataNodes.sbObj.firstChild.style.lineHeight = a.height + "px"
	}
	this.dataNodes.sbObj.setText = function(c) {
		this.childNodes[0].innerHTML = c
	};
	this.dataNodes.sbObj.getText = function() {
		return this.childNodes[0].innerHTML
	};
	this.dataNodes.sbObj.onselectstart = function(c) {
		return false
	};
	this.dataNodes.sbEv = this.attachEvent("_onSetSizes", function() {
		if (this.dataNodes.sbObj.style.display == "none") {
			return
		}
		this.dataNodes.sbObj.style.left = this.conf.ofs.l + "px";
		this.dataNodes.sbObj.style.bottom = (this.dataNodes.faObj != null ? this.dataNodes.faObj.offsetHeight : 0) + this.conf.ofs.t + "px";
		this.dataNodes.sbObj.style.width = this.base.offsetWidth - this.conf.ofs.l - this.conf.ofs.r + "px"
	});
	this.conf.ofs_nodes.b.sbObj = true;
	this.setSizes();
	return this.dataNodes.sbObj
};
dhtmlXCellTop.prototype.detachStatusBar = function() {
	if (!this.dataNodes.sbObj) {
		return
	}
	this.dataNodes.sbObj.setText = this.dataNodes.sbObj.getText = this.dataNodes.sbObj.onselectstart = null;
	this.dataNodes.sbObj.parentNode.removeChild(this.dataNodes.sbObj);
	this.dataNodes.sbObj = null;
	this.detachEvent(this.dataNodes.sbEv);
	this.dataNodes.sbEv = null;
	this.conf.ofs_nodes.b.sbObj = false;
	delete this.dataNodes.sb;
	delete this.dataNodes.sbObj;
	delete this.dataNodes.sbEv;
	if (!this.conf.unloading) {
		this.setSizes()
	}
};
dhtmlXCellTop.prototype.showMenu = function() {
	this._mtbShowHide("menuObj", "")
};
dhtmlXCellTop.prototype.hideMenu = function() {
	this._mtbShowHide("menuObj", "none")
};
dhtmlXCellTop.prototype.showToolbar = function() {
	this._mtbShowHide("toolbarObj", "")
};
dhtmlXCellTop.prototype.hideToolbar = function() {
	this._mtbShowHide("toolbarObj", "none")
};
dhtmlXCellTop.prototype.showRibbon = function() {
	this._mtbShowHide("ribbonObj", "")
};
dhtmlXCellTop.prototype.hideRibbon = function() {
	this._mtbShowHide("ribbonObj", "none")
};
dhtmlXCellTop.prototype.showStatusBar = function() {
	this._mtbShowHide("sbObj", "")
};
dhtmlXCellTop.prototype.hideStatusBar = function() {
	this._mtbShowHide("sbObj", "none")
};
dhtmlXCellTop.prototype._mtbShowHide = function(c, a) {
	if (this.dataNodes[c] == null) {
		return
	}
	this.dataNodes[c].style.display = a;
	this.setSizes()
};
dhtmlXCellTop.prototype._mtbUnload = function(c, a) {
	this.detachMenu();
	this.detachToolbar();
	this.detachStatusBar();
	this.detachRibbon()
};
dhtmlXCellTop.prototype.getAttachedMenu = function() {
	return this.dataNodes.menu
};
dhtmlXCellTop.prototype.getAttachedToolbar = function() {
	return this.dataNodes.toolbar
};
dhtmlXCellTop.prototype.getAttachedRibbon = function() {
	return this.dataNodes.ribbon
};
dhtmlXCellTop.prototype.getAttachedStatusBar = function() {
	return this.dataNodes.sbObj
};
dhtmlXCellTop.prototype.progressOn = function() {
	if (this.conf.progress) {
		return
	}
	this.conf.progress = true;
	var c = document.createElement("DIV");
	c.className = "dhxcelltop_progress";
	this.base.appendChild(c);
	var a = document.createElement("DIV");
	a.className = "dhxcelltop_progress_img";
	this.base.appendChild(a);
	c = a = null
};
dhtmlXCellTop.prototype.progressOff = function() {
	if (!this.conf.progress) {
		return
	}
	var l = {
		dhxcelltop_progress: true,
		dhxcelltop_progress_img: true
	};
	for (var g = 0; g < this.base.childNodes.length; g++) {
		if (typeof(this.base.childNodes[g].className) != "undefined" && l[this.base.childNodes[g].className] == true) {
			l[this.base.childNodes[g].className] = this.base.childNodes[g]
		}
	}
	for (var c in l) {
		if (l[c] != true) {
			this.base.removeChild(l[c])
		}
		l[c] = null
	}
	this.conf.progress = false;
	l = null
};
dhtmlXCellTop.prototype.attachHeader = function(c, a) {
	if (this.dataNodes.haObj != null) {
		return
	}
	if (typeof(c) != "object") {
		c = document.getElementById(c)
	}
	this.dataNodes.haObj = document.createElement("DIV");
	this.dataNodes.haObj.className = "dhxcelltop_hdr";
	this.dataNodes.haObj.style.height = (a || c.offsetHeight) + "px";
	this.base.insertBefore(this.dataNodes.haObj, this.dataNodes.menuObj || this.dataNodes.toolbarObj || this.cont);
	this.dataNodes.haObj.appendChild(c);
	c.style.visibility = "visible";
	c = null;
	this.dataNodes.haEv = this.attachEvent("_onSetSizes", function() {
		this.dataNodes.haObj.style.left = this.conf.ofs.l + "px";
		this.dataNodes.haObj.style.marginTop = this.conf.ofs.t + "px";
		this.dataNodes.haObj.style.width = this.base.offsetWidth - this.conf.ofs.l - this.conf.ofs.r + "px"
	});
	this.conf.ofs_nodes.t.haObj = true;
	this.setSizes()
};
dhtmlXCellTop.prototype.detachHeader = function() {
	if (!this.dataNodes.haObj) {
		return
	}
	while (this.dataNodes.haObj.childNodes.length > 0) {
		this.dataNodes.haObj.lastChild.style.visibility = "hidden";
		document.body.appendChild(this.dataNodes.haObj.lastChild)
	}
	this.dataNodes.haObj.parentNode.removeChild(this.dataNodes.haObj);
	this.dataNodes.haObj = null;
	this.detachEvent(this.dataNodes.haEv);
	this.dataNodes.haEv = null;
	this.conf.ofs_nodes.t.haObj = false;
	delete this.dataNodes.haEv;
	delete this.dataNodes.haObj;
	if (!this.conf.unloading) {
		this.setSizes()
	}
};
dhtmlXCellTop.prototype.attachFooter = function(g, a) {
	if (this.dataNodes.faObj != null) {
		return
	}
	if (typeof(g) != "object") {
		g = document.getElementById(g)
	}
	this.dataNodes.faObj = document.createElement("DIV");
	this.dataNodes.faObj.className = "dhxcelltop_ftr";
	this.dataNodes.faObj.style.height = (a || g.offsetHeight) + "px";
	var c = (this.dataNodes.sbObj || this.cont);
	if (this.base.lastChild == c) {
		this.base.appendChild(this.dataNodes.faObj)
	} else {
		this.base.insertBefore(this.dataNodes.faObj, c.nextSibling)
	}
	this.dataNodes.faEv = this.attachEvent("_onSetSizes", function() {
		this.dataNodes.faObj.style.left = this.conf.ofs.l + "px";
		this.dataNodes.faObj.style.bottom = this.conf.ofs.b + "px";
		this.dataNodes.faObj.style.width = this.base.offsetWidth - this.conf.ofs.l - this.conf.ofs.r + "px"
	});
	this.dataNodes.faObj.appendChild(g);
	g.style.visibility = "visible";
	c = g = null;
	this.conf.ofs_nodes.b.faObj = true;
	this.setSizes()
};
dhtmlXCellTop.prototype.detachFooter = function() {
	if (!this.dataNodes.faObj) {
		return
	}
	while (this.dataNodes.faObj.childNodes.length > 0) {
		this.dataNodes.faObj.lastChild.style.visibility = "hidden";
		document.body.appendChild(this.dataNodes.faObj.lastChild)
	}
	this.dataNodes.faObj.parentNode.removeChild(this.dataNodes.faObj);
	this.dataNodes.faObj = null;
	this.detachEvent(this.dataNodes.faEv);
	this.dataNodes.faEv = null;
	this.conf.ofs_nodes.b.faObj = false;
	delete this.dataNodes.faEv;
	delete this.dataNodes.faObj;
	if (!this.conf.unloading) {
		this.setSizes()
	}
};

function dhtmlXCalendarObject(n, v) {
	this.i = {};
	var g = null;
	if (typeof(n) == "string") {
		var l = document.getElementById(n)
	} else {
		var l = n
	}
	if (l && typeof(l) == "object" && l.tagName && String(l.tagName).toLowerCase() != "input") {
		g = l
	}
	l = null;
	if (typeof(n) != "object" || !n.length) {
		n = [n]
	}
	for (var c = 0; c < n.length; c++) {
		if (typeof(n[c]) == "string") {
			n[c] = (document.getElementById(n[c]) || null)
		}
		if (n[c] != null && n[c].tagName && String(n[c].tagName).toLowerCase() == "input") {
			this.i[window.dhx4.newId()] = {
				input: n[c]
			}
		} else {
			if (!(n[c] instanceof Array) && n[c] instanceof Object && (n[c].input != null || n[c].button != null)) {
				if (n[c].input != null && typeof(n[c].input) == "string") {
					n[c].input = document.getElementById(n[c].input)
				}
				if (n[c].button != null && typeof(n[c].button) == "string") {
					n[c].button = document.getElementById(n[c].button)
				}
				this.i[window.dhx4.newId()] = n[c]
			}
		}
		n[c] = null
	}
	this.conf = {
		skin: (v || window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhtmlxcalendar") || "dhx_skyblue"),
		zi: window.dhx4.newId(),
		touch: !window.dhx4.isIE,
		ws_first: true
	};
	this.setSkin = function(q, a) {
		if (this.conf.skin == q && !a) {
			return
		}
		this.conf.skin = q;
		this.base.className = "dhtmlxcalendar_" + this.conf.skin;
		this._ifrSize()
	};
	this.base = document.createElement("DIV");
	this.base.style.display = "none";
	this.base.appendChild(document.createElement("DIV"));
	if (g != null) {
		this._hasParent = true;
		g.appendChild(this.base);
		g = null
	} else {
		document.body.appendChild(this.base)
	}
	this.setParent = function(a) {
		if (this._hasParent) {
			if (typeof(a) == "object") {
				a.appendChild(this.base)
			} else {
				if (typeof(a) == "string") {
					document.getElementById(a).appendChild(this.base)
				}
			}
		}
	};
	this.setSkin(this.conf.skin, true);
	this.base.onclick = function(a) {
		a = a || event;
		if (a.preventDefault) {
			a.preventDefault()
		}
		a.cancelBubble = true
	};
	this.base.onmousedown = function() {
		return false
	};
	if (this.conf.touch) {
		this.base.ontouchstart = this.base.onclick
	}
	this.loadUserLanguage = function(A) {
		if (!this.langData[A]) {
			return
		}
		this.lang = A;
		this.setWeekStartDay(this.langData[this.lang].weekstart);
		this.setDateFormat(this.langData[this.lang].dateformat || "%Y-%m-%d");
		if (this.msCont) {
			var y = 0;
			for (var x = 0; x < this.msCont.childNodes.length; x++) {
				for (var a = 0; a < this.msCont.childNodes[x].childNodes.length; a++) {
					this.msCont.childNodes[x].childNodes[a].innerHTML = this.langData[this.lang].monthesSNames[y++]
				}
			}
		}
	};
	this.contMonth = document.createElement("DIV");
	this.contMonth.className = "dhtmlxcalendar_month_cont";
	this.contMonth.onselectstart = function(a) {
		a = a || event;
		a.cancelBubble = true;
		if (a.preventDefault) {
			a.preventDefault()
		} else {
			a.returnValue = false
		}
		return false
	};
	this.base.firstChild.appendChild(this.contMonth);
	var o = document.createElement("UL");
	o.className = "dhtmlxcalendar_line";
	this.contMonth.appendChild(o);
	var u = document.createElement("LI");
	u.className = "dhtmlxcalendar_cell dhtmlxcalendar_month_hdr";
	u.innerHTML = "<div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_left\";'></div><span></span><div class='dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right' onmouseover='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right_hover\";' onmouseout='this.className=\"dhtmlxcalendar_month_arrow dhtmlxcalendar_month_arrow_right\";'></div>";
	o.appendChild(u);
	var m = this;
	u.onclick = function(x) {
		x = x || event;
		if (x.type == "touchstart" && x.preventDefault != null) {
			x.preventDefault()
		}
		var q = (x.target || x.srcElement);
		if (q.className && q.className.indexOf("dhtmlxcalendar_month_arrow") === 0) {
			m._hideSelector();
			var w = (q.parentNode.firstChild == q ? -1 : 1);
			var a = new Date(m._activeMonth);
			m._drawMonth(new Date(m._activeMonth.getFullYear(), m._activeMonth.getMonth() + w, 1, 0, 0, 0, 0));
			m._evOnArrowClick([a, new Date(m._activeMonth)]);
			return
		}
		if (q.className && q.className == "dhtmlxcalendar_month_label_month") {
			x.cancelBubble = true;
			m._showSelector("month", Math.round(q.offsetLeft + q.offsetWidth / 2), q.offsetTop + q.offsetHeight + 2, "selector_month", true);
			return
		}
		if (q.className && q.className == "dhtmlxcalendar_month_label_year") {
			x.cancelBubble = true;
			m._showSelector("year", Math.round(q.offsetLeft + q.offsetWidth / 2), q.offsetTop + q.offsetHeight + 2, "selector_year", true);
			return
		}
		m._hideSelector()
	};
	if (this.conf.touch == true) {
		u.ontouchstart = u.onclick
	}
	this.contDays = document.createElement("DIV");
	this.contDays.className = "dhtmlxcalendar_days_cont";
	this.base.firstChild.appendChild(this.contDays);
	this.setWeekStartDay = function(a) {
		if (a == 0) {
			a = 7
		}
		this._wStart = Math.min(Math.max((isNaN(a) ? 1 : a), 1), 7);
		this._drawDaysOfWeek()
	};
	this._drawDaysOfWeek = function() {
		if (this.contDays.childNodes.length == 0) {
			var A = document.createElement("UL");
			A.className = "dhtmlxcalendar_line";
			this.contDays.appendChild(A)
		} else {
			var A = this.contDays.firstChild
		}
		var x = this._wStart;
		var y = this.langData[this.lang].daysSNames;
		y.push(String(this.langData[this.lang].daysSNames[0]).valueOf());
		for (var C = 0; C < 8; C++) {
			if (A.childNodes[C] == null) {
				var a = document.createElement("LI");
				A.appendChild(a)
			} else {
				var a = A.childNodes[C]
			}
			if (C == 0) {
				a.className = "dhtmlxcalendar_cell_wn";
				a.innerHTML = "<div class='dhtmlxcalendar_label'>" + (this.langData[this.lang].weekname || "w") + "</div>"
			} else {
				a.className = "dhtmlxcalendar_cell" + (x >= 6 ? " dhtmlxcalendar_day_weekday_cell" : "") + (C == 1 ? "_first" : "");
				a.innerHTML = y[x];
				if (++x > 7) {
					x = 1
				}
			}
		}
		if (this._activeMonth != null) {
			this._drawMonth(this._activeMonth)
		}
	};
	this._wStart = this.langData[this.lang].weekstart;
	this.setWeekStartDay(this._wStart);
	this.contDates = document.createElement("DIV");
	this.contDates.className = "dhtmlxcalendar_dates_cont";
	this.base.firstChild.appendChild(this.contDates);
	this.contDates.onclick = function(A) {
		A = A || event;
		if (A.type == "touchstart" && A.preventDefault != null) {
			A.preventDefault()
		}
		var q = (A.target || A.srcElement);
		if (q.parentNode != null && q.parentNode._date != null) {
			q = q.parentNode
		}
		if (q._date != null && !q._css_dis) {
			var x = m._activeDate.getHours();
			var w = m._activeDate.getMinutes();
			var y = q._date;
			if (m.checkEvent("onBeforeChange")) {
				if (!m.callEvent("onBeforeChange", [new Date(q._date.getFullYear(), q._date.getMonth(), q._date.getDate(), x, w)])) {
					return
				}
			}
			if (m._activeDateCell != null) {
				m._activeDateCell._css_date = false;
				m._updateCellStyle(m._activeDateCell._q, m._activeDateCell._w)
			}
			var a = (m._activeDate.getFullYear() + "_" + m._activeDate.getMonth() != y.getFullYear() + "_" + y.getMonth());
			m._nullDate = false;
			m._activeDate = new Date(y.getFullYear(), y.getMonth(), y.getDate(), x, w);
			m._activeDateCell = q;
			m._activeDateCell._css_date = true;
			m._activeDateCell._css_hover = false;
			m._updateCellStyle(m._activeDateCell._q, m._activeDateCell._w);
			if (a) {
				m._drawMonth(m._activeDate)
			}
			if (m._activeInp && m.i[m._activeInp] && m.i[m._activeInp].input != null) {
				m.i[m._activeInp].input.value = m._dateToStr(new Date(m._activeDate.getTime()))
			}
			if (!m._hasParent) {
				if (A.type == "touchstart") {
					window.setTimeout(function() {
						m._hide()
					}, 400)
				} else {
					m._hide()
				}
			}
			m._evOnClick([new Date(m._activeDate.getTime())])
		}
	};
	if (this.conf.touch == true) {
		this.contDates.ontouchstart = this.contDates.onclick
	}
	this.contDates.onmouseover = function(q) {
		q = q || event;
		var a = (q.target || q.srcElement);
		if (a.parentNode != null && a.parentNode._date != null) {
			a = a.parentNode
		}
		if (a._date != null) {
			if (m._lastHover == a || a._css_hover) {
				return
			}
			a._css_hover = true;
			m._updateCellStyle(a._q, a._w);
			m._lastHover = a;
			m._evOnMouseOver([new Date(a._date.getFullYear(), a._date.getMonth(), a._date.getDate(), 0, 0, 0, 0), q]);
			a = null
		}
	};
	this.contDates.onmouseout = function(a) {
		m._clearDayHover(a || event)
	};
	this._lastHover = null;
	this._clearDayHover = function(a) {
		if (!this._lastHover) {
			return
		}
		this._lastHover._css_hover = false;
		this._updateCellStyle(this._lastHover._q, this._lastHover._w);
		m._evOnMouseOut([new Date(this._lastHover._date.getFullYear(), this._lastHover._date.getMonth(), this._lastHover._date.getDate(), 0, 0, 0, 0), a]);
		this._lastHover = null
	};
	for (var c = 0; c < 6; c++) {
		var o = document.createElement("UL");
		o.className = "dhtmlxcalendar_line";
		this.contDates.appendChild(o);
		for (var s = 0; s <= 7; s++) {
			var u = document.createElement("LI");
			if (s == 0) {
				u.className = "dhtmlxcalendar_cell_wn"
			} else {
				u.className = "dhtmlxcalendar_cell"
			}
			o.appendChild(u)
		}
	}
	this.contTime = document.createElement("DIV");
	this.contTime.className = "dhtmlxcalendar_time_cont";
	this.base.firstChild.appendChild(this.contTime);
	this.showTime = function() {
		this.contTime.style.display = "";
		this._ifrSize()
	};
	this.hideTime = function() {
		this.contTime.style.display = "none";
		this._ifrSize()
	};
	var o = document.createElement("UL");
	o.className = "dhtmlxcalendar_line";
	this.contTime.appendChild(o);
	var u = document.createElement("LI");
	u.className = "dhtmlxcalendar_cell dhtmlxcalendar_time_hdr";
	u.innerHTML = "<div class='dhtmlxcalendar_time_img'></div><span class='dhtmlxcalendar_label_hours'></span><span class='dhtmlxcalendar_label_colon'> : </span><span class='dhtmlxcalendar_label_minutes'></span>";
	o.appendChild(u);
	u.onclick = function(w) {
		w = w || event;
		if (w.type == "touchstart" && w.preventDefault != null) {
			w.preventDefault()
		}
		var a = (w.target || w.srcElement);
		if (a.tagName != null && a.tagName.toLowerCase() == "span" && a._par == true && a.parentNode != null) {
			a = a.parentNode
		}
		if (a.className && a.className == "dhtmlxcalendar_label_hours") {
			w.cancelBubble = true;
			var q = m.contMonth.offsetHeight + m.contDays.offsetHeight + m.contDates.offsetHeight + a.offsetTop;
			m._showSelector("hours", Math.round(a.offsetLeft + a.offsetWidth / 2), q - 2, "selector_hours", true);
			return
		}
		if (a.className && a.className == "dhtmlxcalendar_label_minutes") {
			w.cancelBubble = true;
			if (m._minutesInterval == 1) {
				var x = m.getFormatedDate("%i");
				a.innerHTML = "<span class='dhtmlxcalendar_selected_date'>" + x.charAt(0) + "</span>" + x.charAt(1);
				a.firstChild._par = true;
				m._selectorMode = 1
			}
			var q = m.contMonth.offsetHeight + m.contDays.offsetHeight + m.contDates.offsetHeight + a.offsetTop;
			m._showSelector("minutes", Math.round(a.offsetLeft + a.offsetWidth / 2), q - 2, "selector_minutes", true);
			return
		}
		m._hideSelector()
	};
	if (this.conf.touch == true) {
		u.ontouchstart = u.onclick
	}
	this._activeMonth = null;
	this._activeDate = new Date();
	this._activeDateCell = null;
	this.setDate = function(q) {
		window.dhx4.temp_calendar = {
			tz: null
		};
		this._nullDate = (typeof(q) == "undefined" || q === "" || !q);
		if (!(q instanceof Date)) {
			q = this._strToDate(String(q || ""));
			if (q == "Invalid Date") {
				q = new Date()
			} else {
				this.conf.tz = window.dhx4.temp_calendar.tz
			}
			window.dhx4.temp_calendar = null
		}
		if (this.conf.tz == null) {
			this.conf.tz = window.dhx4.date2str(q, "%P")
		}
		var a = q.getTime();
		if (this._isOutOfRange(a)) {
			return
		}
		this._activeDate = new Date(a);
		this._drawMonth(this._nullDate ? new Date() : this._activeDate);
		this._updateVisibleHours();
		this._updateVisibleMinutes()
	};
	this.getDate = function(w) {
		if (this._nullDate) {
			return null
		}
		var a = new Date(this._activeDate.getTime());
		if (w) {
			window.dhx4.temp_calendar = {
				tz: this.conf.tz
			};
			var q = this._dateToStr(a);
			window.dhx4.temp_calendar = null;
			return q
		}
		return a
	};
	this._drawMonth = function(I) {
		if (!(I instanceof Date)) {
			return
		}
		if (isNaN(I.getFullYear())) {
			I = new Date(this._activeMonth.getFullYear(), this._activeMonth.getMonth(), 1, 0, 0, 0, 0)
		}
		this._activeMonth = new Date(I.getFullYear(), I.getMonth(), 1, 0, 0, 0, 0);
		this._activeDateCell = null;
		var F = new Date(this._activeMonth.getTime());
		var y = F.getDay();
		var L = y - this._wStart;
		if (L < 0) {
			L = L + 7
		}
		F.setDate(F.getDate() - L);
		var O = I.getMonth();
		var P = new Date(this._activeDate.getFullYear(), this._activeDate.getMonth(), this._activeDate.getDate(), 0, 0, 0, 0).getTime();
		var D = 0;
		for (var x = 0; x < 6; x++) {
			var H = this._wStart;
			for (var N = 0; N <= 7; N++) {
				if (N == 0) {
					var M = this.getWeekNumber(new Date(F.getFullYear(), F.getMonth(), F.getDate() + D, 0, 0, 0, 0));
					if (M >= 52 && this.conf.ws_first == true && this._activeMonth.getMonth() == 0) {
						var C = this.getWeekNumber(new Date(F.getFullYear(), F.getMonth(), F.getDate() + D + 7, 0, 0, 0, 0));
						if (C < M && C > 1) {
							M = 1
						}
					}
					this.contDates.childNodes[x].childNodes[N].innerHTML = "<div class='dhtmlxcalendar_label'>" + M + "</div>"
				} else {
					var a = new Date(F.getFullYear(), F.getMonth(), F.getDate() + D, 0, 0, 0, 0);
					if (a.getHours() != 0) {
						var E = (a.getHours() > 12 ? 24 - a.getHours() : a.getHours());
						a.setTime(a.getTime() + 60 * 60 * 1000 * E)
					}
					var K = a.getDay();
					var A = a.getTime();
					var J = "dhtmlxcalendar_label";
					if (this._tipData[A] != null) {
						if (this._tipData[A].usePopup && typeof(window.dhtmlXPopup) == "function") {
							this.contDates.childNodes[x].childNodes[N].removeAttribute("title");
							this._initTooltipPopup()
						} else {
							this.contDates.childNodes[x].childNodes[N].setAttribute("title", this._tipData[A].text)
						}
						if (this._tipData[A].showIcon) {
							J += " dhtmlxcalendar_label_title"
						}
					} else {
						this.contDates.childNodes[x].childNodes[N].removeAttribute("title")
					}
					this.contDates.childNodes[x].childNodes[N].innerHTML = "<div class='" + J + "'>" + a.getDate() + "</div>";
					this.contDates.childNodes[x].childNodes[N]._date = new Date(A);
					this.contDates.childNodes[x].childNodes[N]._q = x;
					this.contDates.childNodes[x].childNodes[N]._w = N;
					this.contDates.childNodes[x].childNodes[N]._css_month = (a.getMonth() == O);
					this.contDates.childNodes[x].childNodes[N]._css_date = (!this._nullDate && A == P);
					this.contDates.childNodes[x].childNodes[N]._css_weekend = (H >= 6);
					this.contDates.childNodes[x].childNodes[N]._css_dis = this._isOutOfRange(A);
					this.contDates.childNodes[x].childNodes[N]._css_holiday = (this._holidays[A] == true);
					this._updateCellStyle(x, N);
					if (A == P) {
						this._activeDateCell = this.contDates.childNodes[x].childNodes[N]
					}
					if (++H > 7) {
						H = 1
					}
					D++
				}
			}
		}
		this.contMonth.firstChild.firstChild.childNodes[1].innerHTML = this._buildMonthHdr(I)
	};
	this._updateCellStyle = function(A, a) {
		var y = this.contDates.childNodes[A].childNodes[a];
		var x = "dhtmlxcalendar_cell dhtmlxcalendar_cell";
		x += (y._css_month ? "_month" : "");
		x += (y._css_date ? "_date" : "");
		x += (y._css_weekend ? "_weekend" : "");
		x += (y._css_holiday ? "_holiday" : "");
		x += (y._css_dis ? "_dis" : "");
		x += (y._css_hover && !y._css_dis ? "_hover" : "");
		y.className = x;
		y = null
	};
	this._minutesInterval = 5;
	this._initSelector = function(F, A) {
		if (!this._selCover) {
			this._selCover = document.createElement("DIV");
			this._selCover.className = "dhtmlxcalendar_selector_cover";
			this.base.firstChild.appendChild(this._selCover)
		}
		if (!this._sel) {
			this._sel = document.createElement("DIV");
			this._sel.className = "dhtmlxcalendar_selector_obj";
			this.base.firstChild.appendChild(this._sel);
			this._sel.appendChild(document.createElement("TABLE"));
			this._sel.firstChild.className = "dhtmlxcalendar_selector_table";
			this._sel.firstChild.cellSpacing = 0;
			this._sel.firstChild.cellPadding = 0;
			this._sel.firstChild.border = 0;
			this._sel.firstChild.appendChild(document.createElement("TBODY"));
			this._sel.firstChild.firstChild.appendChild(document.createElement("TR"));
			this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD"));
			this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD"));
			this._sel.firstChild.firstChild.firstChild.appendChild(document.createElement("TD"));
			this._sel.firstChild.firstChild.firstChild.childNodes[0].className = "dhtmlxcalendar_selector_cell_left";
			this._sel.firstChild.firstChild.firstChild.childNodes[1].className = "dhtmlxcalendar_selector_cell_middle";
			this._sel.firstChild.firstChild.firstChild.childNodes[2].className = "dhtmlxcalendar_selector_cell_right";
			this._sel.firstChild.firstChild.firstChild.childNodes[0].innerHTML = "&nbsp;";
			this._sel.firstChild.firstChild.firstChild.childNodes[2].innerHTML = "&nbsp;";
			this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseover = function() {
				this.className = "dhtmlxcalendar_selector_cell_left dhtmlxcalendar_selector_cell_left_hover"
			};
			this._sel.firstChild.firstChild.firstChild.childNodes[0].onmouseout = function() {
				this.className = "dhtmlxcalendar_selector_cell_left"
			};
			this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseover = function() {
				this.className = "dhtmlxcalendar_selector_cell_right dhtmlxcalendar_selector_cell_right_hover"
			};
			this._sel.firstChild.firstChild.firstChild.childNodes[2].onmouseout = function() {
				this.className = "dhtmlxcalendar_selector_cell_right"
			};
			this._sel.onmouseover = function(w) {
				w = w || event;
				var q = (w.target || w.srcElement);
				if (q._cell === true) {
					if (m._selHover != q) {
						m._clearSelHover()
					}
					if (String(q.className).match(/^\s{0,}dhtmlxcalendar_selector_cell\s{0,}$/gi) != null) {
						q.className += " dhtmlxcalendar_selector_cell_hover";
						m._selHover = q
					}
				}
			};
			this._sel.onmouseout = function() {
				m._clearSelHover()
			};
			this._sel.firstChild.firstChild.firstChild.childNodes[0].onclick = function(q) {
				q = q || event;
				if (q.type == "touchstart" && q.preventDefault != null) {
					q.preventDefault()
				}
				q.cancelBubble = true;
				m._scrollYears(-1)
			};
			this._sel.firstChild.firstChild.firstChild.childNodes[2].onclick = function(q) {
				q = q || event;
				if (q.type == "touchstart" && q.preventDefault != null) {
					q.preventDefault()
				}
				q.cancelBubble = true;
				m._scrollYears(1)
			};
			if (this.conf.touch == true) {
				this._sel.firstChild.firstChild.firstChild.childNodes[0].ontouchstart = this._sel.firstChild.firstChild.firstChild.childNodes[0].onclick;
				this._sel.firstChild.firstChild.firstChild.childNodes[2].ontouchstart = this._sel.firstChild.firstChild.firstChild.childNodes[2].onclick
			}
			this._sel._ta = {};
			this._selHover = null;
			this._sel.appendChild(document.createElement("DIV"));
			this._sel.lastChild.className = "dhtmlxcalendar_selector_obj_arrow"
		}
		if (this._sel._ta[F] == true) {
			return
		}
		if (F == "month") {
			this._msCells = {};
			this.msCont = document.createElement("DIV");
			this.msCont.className = "dhtmlxcalendar_area_" + A;
			this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.msCont);
			var x = 0;
			for (var a = 0; a < 4; a++) {
				var E = document.createElement("UL");
				E.className = "dhtmlxcalendar_selector_line";
				this.msCont.appendChild(E);
				for (var H = 0; H < 3; H++) {
					var I = document.createElement("LI");
					I.innerHTML = this.langData[this.lang].monthesSNames[x];
					I.className = "dhtmlxcalendar_selector_cell";
					E.appendChild(I);
					I._month = x;
					I._cell = true;
					this._msCells[x++] = I
				}
			}
			this.msCont.onclick = function(w) {
				w = w || event;
				if (w.type == "touchstart" && w.preventDefault != null) {
					w.preventDefault()
				}
				w.cancelBubble = true;
				var q = (w.target || w.srcElement);
				if (q._month != null) {
					m._hideSelector();
					m._updateActiveMonth();
					m._drawMonth(new Date(m._activeMonth.getFullYear(), q._month, 1, 0, 0, 0, 0));
					m._doOnSelectorChange()
				}
			};
			if (this.conf.touch == true) {
				this.msCont.ontouchstart = this.msCont.onclick
			}
		}
		if (F == "year") {
			this._ysCells = {};
			this.ysCont = document.createElement("DIV");
			this.ysCont.className = "dhtmlxcalendar_area_" + A;
			this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.ysCont);
			for (var a = 0; a < 4; a++) {
				var E = document.createElement("UL");
				E.className = "dhtmlxcalendar_selector_line";
				this.ysCont.appendChild(E);
				for (var H = 0; H < 3; H++) {
					var I = document.createElement("LI");
					I.className = "dhtmlxcalendar_selector_cell";
					I._cell = true;
					E.appendChild(I)
				}
			}
			this.ysCont.onclick = function(w) {
				w = w || event;
				if (w.type == "touchstart" && w.preventDefault != null) {
					w.preventDefault()
				}
				w.cancelBubble = true;
				var q = (w.target || w.srcElement);
				if (q._year != null) {
					m._hideSelector();
					m._drawMonth(new Date(q._year, m._activeMonth.getMonth(), 1, 0, 0, 0, 0));
					m._doOnSelectorChange()
				}
			};
			if (this.conf.touch == true) {
				this.ysCont.ontouchstart = this.ysCont.onclick
			}
		}
		if (F == "hours") {
			this._hsCells = {};
			this.hsCont = document.createElement("DIV");
			this.hsCont.className = "dhtmlxcalendar_area_" + A;
			this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.hsCont);
			var x = 0;
			for (var a = 0; a < 4; a++) {
				var E = document.createElement("UL");
				E.className = "dhtmlxcalendar_selector_line";
				this.hsCont.appendChild(E);
				for (var H = 0; H < 6; H++) {
					var I = document.createElement("LI");
					I.innerHTML = this._fixLength(x, 2);
					I.className = "dhtmlxcalendar_selector_cell";
					E.appendChild(I);
					I._hours = x;
					I._cell = true;
					this._hsCells[x++] = I
				}
			}
			this.hsCont.onclick = function(w) {
				w = w || event;
				if (w.type == "touchstart" && w.preventDefault != null) {
					w.preventDefault()
				}
				w.cancelBubble = true;
				var q = (w.target || w.srcElement);
				if (q._hours != null) {
					m._hideSelector();
					m._activeDate.setHours(q._hours);
					m._updateActiveHours();
					m._updateVisibleHours();
					m._doOnSelectorChange();
					m.callEvent("onTimeChange", [new Date(m._activeDate.getTime())])
				}
			};
			if (this.conf.touch == true) {
				this.hsCont.ontouchstart = this.hsCont.onclick
			}
		}
		if (F == "minutes") {
			var D = 4;
			var y = 3;
			var C = 2;
			if (this._minutesInterval == 1) {
				if (this._selectorMode == 1) {
					D = 2;
					y = 3;
					C = 1
				} else {
					D = 2;
					y = 5;
					C = 1;
					A += "5"
				}
			}
			if (this._minutesInterval == 10) {
				D = 2
			}
			if (this._minutesInterval == 15) {
				D = 1;
				y = 4;
				A += "4"
			}
			this._rsCells = {};
			this.rsCont = document.createElement("DIV");
			this.rsCont.className = "dhtmlxcalendar_area_" + A;
			this._sel.firstChild.firstChild.firstChild.childNodes[1].appendChild(this.rsCont);
			var x = 0;
			for (var a = 0; a < D; a++) {
				var E = document.createElement("UL");
				E.className = "dhtmlxcalendar_selector_line";
				this.rsCont.appendChild(E);
				for (var H = 0; H < y; H++) {
					var I = document.createElement("LI");
					I.innerHTML = (C > 1 ? this._fixLength(x, C) : x);
					I.className = "dhtmlxcalendar_selector_cell";
					E.appendChild(I);
					I._minutes = x;
					I._cell = true;
					this._rsCells[x] = I;
					x += this._minutesInterval
				}
			}
			this.rsCont.onclick = function(J) {
				J = J || event;
				if (J.type == "touchstart" && J.preventDefault != null) {
					J.preventDefault()
				}
				J.cancelBubble = true;
				var w = (J.target || J.srcElement);
				if (w._minutes != null) {
					if (m._minutesInterval == 1) {
						var q = m.getFormatedDate("%i");
						if (m._selectorMode == 1) {
							q = w._minutes.toString() + q.charAt(1)
						} else {
							q = q.charAt(0) + w._minutes.toString()
						}
						m._activeDate.setMinutes(Number(q));
						m.callEvent("onTimeChange", [new Date(m._activeDate.getTime())]);
						m._hideSelector();
						if (m._selectorMode == 1) {
							m._updateVisibleMinutes(true);
							m._selectorMode = 2;
							m._showSelector("minutes", m._sel._x, m._sel._y, "selector_minutes", true);
							m._updateActiveMinutes();
							return
						} else {
							m._selectorMode = 1
						}
					} else {
						m._hideSelector();
						m._activeDate.setMinutes(w._minutes);
						m._updateActiveMinutes();
						m.callEvent("onTimeChange", [new Date(m._activeDate.getTime())])
					}
					m._updateVisibleMinutes();
					m._doOnSelectorChange()
				}
			};
			if (this.conf.touch == true) {
				this.rsCont.ontouchstart = this.rsCont.onclick
			}
		}
		this._sel._ta[F] = true
	};
	this._showSelector = function(C, q, D, A, a) {
		if (a === true && this._sel != null && this._isSelectorVisible() && C == this._sel._t) {
			this._hideSelector();
			return
		}
		if (this.conf.skin == "dhx_terrace") {
			q += 12
		}
		if (!this._sel || !this._sel._ta[C]) {
			this._initSelector(C, A)
		}
		if (C != this._sel._t && this._sel._t == "minutes" && this._minutesInterval == 1) {
			this.contTime.firstChild.firstChild.childNodes[3].innerHTML = this.getFormatedDate("%i")
		}
		this._sel._x = q;
		this._sel._y = D;
		this._sel.style.visibility = "hidden";
		this._sel.style.display = "";
		this._selCover.style.width = this.base.offsetWidth - 2 + "px";
		this._selCover.style.top = this.contMonth.offsetHeight + "px";
		this._selCover.style.height = this.contDates.offsetHeight + this.contDays.offsetHeight - 1 + "px";
		this._selCover.style.display = "";
		this._sel._t = C;
		this._sel.className = "dhtmlxcalendar_selector_obj dhtmlxcalendar_" + A;
		this._sel.childNodes[0].firstChild.firstChild.childNodes[0].style.display = this._sel.childNodes[0].firstChild.firstChild.childNodes[2].style.display = (C == "year" ? "" : "none");
		var w = Math.max(0, q - Math.round(this._sel.offsetWidth / 2));
		if (w + this._sel.offsetWidth > this._sel.parentNode.offsetWidth) {
			w = this._sel.parentNode.offsetWidth - this._sel.offsetWidth
		}
		this._sel.style.left = w + "px";
		if (C == "hours" || C == "minutes") {
			this._sel.style.top = D - this._sel.offsetHeight + "px"
		} else {
			this._sel.style.top = D + "px"
		}
		this._sel.childNodes[1].style.width = this._sel.childNodes[0].offsetWidth + "px";
		this._sel.style.visibility = "visible";
		this._doOnSelectorShow(C)
	};
	this._doOnSelectorShow = function(a) {
		if (a == "month") {
			this._updateActiveMonth()
		}
		if (a == "year") {
			this._updateYearsList(this._activeMonth)
		}
		if (a == "hours") {
			this._updateActiveHours()
		}
		if (a == "minutes") {
			this._updateActiveMinutes()
		}
	};
	this._hideSelector = function(a) {
		if (!this._sel) {
			return
		}
		this._sel.style.display = "none";
		this._sel.style.visible = "hidden";
		this._selCover.style.display = "none";
		if (this._sel._t == "minutes" && this._minutesInterval == 1) {
			this.contTime.firstChild.firstChild.childNodes[3].innerHTML = this.getFormatedDate("%i");
			this._unloadSelector("minutes")
		}
	};
	this._isSelectorVisible = function() {
		if (!this._sel) {
			return false
		}
		return (this._sel.style.display != "none")
	};
	this._doOnSelectorChange = function(a) {
		this.callEvent("onChange", [new Date(this._activeMonth.getFullYear(), this._activeMonth.getMonth(), this._activeDate.getDate(), this._activeDate.getHours(), this._activeDate.getMinutes(), this._activeDate.getSeconds()), a === true])
	};
	this._clearSelHover = function() {
		if (!this._selHover) {
			return
		}
		this._selHover.className = String(this._selHover.className.replace(/dhtmlxcalendar_selector_cell_hover/gi, ""));
		this._selHover = null
	};
	this._unloadSelector = function(w) {
		if (!this._sel) {
			return
		}
		if (!this._sel._ta[w]) {
			return
		}
		if (w == "month") {
			this.msCont.onclick = this.msCont.ontouchstart = null;
			this._msActive = null;
			for (var q in this._msCells) {
				this._msCells[q]._cell = null;
				this._msCells[q]._month = null;
				this._msCells[q].parentNode.removeChild(this._msCells[q]);
				this._msCells[q] = null
			}
			this._msCells = null;
			while (this.msCont.childNodes.length > 0) {
				this.msCont.removeChild(this.msCont.lastChild)
			}
			this.msCont.parentNode.removeChild(this.msCont);
			this.msCont = null
		}
		if (w == "year") {
			this.ysCont.onclick = this.ysCont.ontouchstart = null;
			for (var q in this._ysCells) {
				this._ysCells[q]._cell = null;
				this._ysCells[q]._year = null;
				this._ysCells[q].parentNode.removeChild(this._ysCells[q]);
				this._ysCells[q] = null
			}
			this._ysCells = null;
			while (this.ysCont.childNodes.length > 0) {
				this.ysCont.removeChild(this.ysCont.lastChild)
			}
			this.ysCont.parentNode.removeChild(this.ysCont);
			this.ysCont = null
		}
		if (w == "hours") {
			this.hsCont.onclick = this.hsCont.ontouchstart = null;
			this._hsActive = null;
			for (var q in this._hsCells) {
				this._hsCells[q]._cell = null;
				this._hsCells[q]._hours = null;
				this._hsCells[q].parentNode.removeChild(this._hsCells[q]);
				this._hsCells[q] = null
			}
			this._hsCells = null;
			while (this.hsCont.childNodes.length > 0) {
				this.hsCont.removeChild(this.hsCont.lastChild)
			}
			this.hsCont.parentNode.removeChild(this.hsCont);
			this.hsCont = null
		}
		if (w == "minutes") {
			this.rsCont.onclick = this.rsCont.ontouchstart = null;
			this._rsActive = null;
			for (var q in this._rsCells) {
				this._rsCells[q]._cell = null;
				this._rsCells[q]._minutes = null;
				this._rsCells[q].parentNode.removeChild(this._rsCells[q]);
				this._rsCells[q] = null
			}
			this._rsCells = null;
			while (this.rsCont.childNodes.length > 0) {
				this.rsCont.removeChild(this.rsCont.lastChild)
			}
			this.rsCont.parentNode.removeChild(this.rsCont);
			this.rsCont = null
		}
		this._sel._ta[w] = null
	};
	this.setMinutesInterval = function(a) {
		if (!(a == 1 || a == 5 || a == 10 || a == 15)) {
			return
		}
		this._minutesInterval = a;
		this._unloadSelector("minutes")
	};
	this._updateActiveMonth = function() {
		if (typeof(this._msActive) != "undefined" && typeof(this._msCells[this._msActive]) != "undefined") {
			this._msCells[this._msActive].className = "dhtmlxcalendar_selector_cell"
		}
		this._msActive = this._activeMonth.getMonth();
		this._msCells[this._msActive].className = "dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"
	};
	this._updateActiveYear = function() {
		var a = this._activeMonth.getFullYear();
		if (this._ysCells[a]) {
			this._ysCells[a].className = "dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"
		}
	};
	this._updateYearsList = function(D) {
		for (var y in this._ysCells) {
			this._ysCells[y] = null;
			delete this._ysCells[y]
		}
		var A = 12 * Math.floor(D.getFullYear() / 12);
		for (var C = 0; C < 4; C++) {
			for (var x = 0; x < 3; x++) {
				this.ysCont.childNodes[C].childNodes[x].innerHTML = A;
				this.ysCont.childNodes[C].childNodes[x]._year = A;
				this.ysCont.childNodes[C].childNodes[x].className = "dhtmlxcalendar_selector_cell";
				this._ysCells[A++] = this.ysCont.childNodes[C].childNodes[x]
			}
		}
		this._updateActiveYear()
	};
	this._scrollYears = function(a) {
		var w = (a < 0 ? this.ysCont.firstChild.firstChild._year : this.ysCont.lastChild.lastChild._year) + a;
		var q = new Date(w, this._activeMonth.getMonth(), 1, 0, 0, 0, 0);
		this._updateYearsList(q)
	};
	this._updateActiveHours = function() {
		if (typeof(this._hsActive) != "undefined" && typeof(this._hsCells[this._hsActive]) != "undefined") {
			this._hsCells[this._hsActive].className = "dhtmlxcalendar_selector_cell"
		}
		this._hsActive = this._activeDate.getHours();
		this._hsCells[this._hsActive].className = "dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"
	};
	this._updateVisibleHours = function() {
		this.contTime.firstChild.firstChild.childNodes[1].innerHTML = this._fixLength(this._activeDate.getHours(), 2)
	};
	this._updateActiveMinutes = function() {
		if (this._rsActive != null && typeof(this._rsActive) != "undefined" && typeof(this._rsCells[this._rsActive]) != "undefined") {
			this._rsCells[this._rsActive].className = "dhtmlxcalendar_selector_cell"
		}
		if (this._minutesInterval == 1) {
			this._rsActive = (this.getFormatedDate("%i").toString()).charAt(this._selectorMode == 1 ? 0 : 1)
		} else {
			this._rsActive = this._activeDate.getMinutes()
		}
		if (typeof(this._rsCells[this._rsActive]) != "undefined") {
			this._rsCells[this._rsActive].className = "dhtmlxcalendar_selector_cell dhtmlxcalendar_selector_cell_active"
		}
	};
	this._updateVisibleMinutes = function(q) {
		var a = this._fixLength(this._activeDate.getMinutes(), 2).toString();
		if (q == true) {
			a = a.charAt(0) + "<span class='dhtmlxcalendar_selected_date'>" + a.charAt(1) + "</span>"
		}
		this.contTime.firstChild.firstChild.childNodes[3].innerHTML = a;
		if (q == true) {
			this.contTime.firstChild.firstChild.childNodes[3].lastChild._par = true
		}
	};
	this._fixLength = function(a, q) {
		while (String(a).length < q) {
			a = "0" + String(a)
		}
		return a
	};
	this._dateFormat = "";
	this._dateFormatRE = null;
	this.setDateFormat = function(y) {
		var x = {};
		if (this._strToDate != null) {
			for (var q in this.i) {
				if (this.i[q].input != null && this.i[q].input.value.length > 0) {
					var A = this._strToDate(this.i[q].input.value, this._dateFormat || this.langData[this.lang].dateformat || "%Y-%m-%d");
					if (A instanceof Date) {
						x[q] = A
					}
				}
			}
		}
		this._dateFormat = y;
		var w = String(this._dateFormat).replace(/%[a-zA-Z]+/g, function(a) {
			var C = a.replace(/%/, "");
			switch (C) {
				case "n":
				case "h":
				case "j":
				case "g":
				case "G":
					return "\\d{1,2}";
				case "m":
				case "d":
				case "H":
				case "i":
				case "s":
				case "y":
					return "\\d{2}";
				case "Y":
					return "\\d{4}";
				case "M":
					return "(" + m.langData[m.lang].monthesSNames.join("|").toLowerCase() + "){1,}";
				case "F":
					return "(" + m.langData[m.lang].monthesFNames.join("|").toLowerCase() + "){1,}";
				case "D":
					return "[a-z]{2}";
				case "a":
				case "A":
					return "AM|PM";
				case "u":
					return "\\d{1,6}";
				case "P":
					return "[\\+\\-]\\d{1,2}\\:\\d{1,2}"
			}
			return a
		});
		this._dateFormatRE = new RegExp(w, "i");
		for (var q in x) {
			this.i[q].input.value = this._dateToStr(x[q])
		}
		x = null
	};
	this.setDateFormat(this.langData[this.lang].dateformat || "%Y-%m-%d");
	this._updateDateStr = function(q) {
		if (!this._dateFormatRE || !q.match(this._dateFormatRE)) {
			return
		}
		if (q == this.getFormatedDate()) {
			return
		}
		var a = this._strToDate(q);
		if (!(a instanceof Date)) {
			return
		}
		if (this.checkEvent("onBeforeChange")) {
			if (!this.callEvent("onBeforeChange", [new Date(a.getFullYear(), a.getMonth(), a.getDate(), a.getHours(), a.getMinutes(), a.getSeconds())])) {
				if (this.i != null && this._activeInp != null && this.i[this._activeInp] != null && this.i[this._activeInp].input != null) {
					this.i[this._activeInp].input.value = this.getFormatedDate()
				}
				return
			}
		}
		this._nullDate = false;
		this._activeDate = a;
		this._drawMonth(this._nullDate ? new Date() : this._activeDate);
		this._updateVisibleMinutes();
		this._updateVisibleHours();
		if (this._sel && this._isSelectorVisible()) {
			this._doOnSelectorShow(this._sel._t)
		}
		this._doOnSelectorChange(true)
	};
	this.showMonth = function(a) {
		if (typeof(a) == "string") {
			a = this._strToDate(a)
		}
		if (!(a instanceof Date)) {
			return
		}
		this._drawMonth(a)
	};
	this.setFormatedDate = function(y, A, q, x) {
		var w = this._strToDate(A, y);
		if (x) {
			return w
		}
		this.setDate(w)
	};
	this.getFormatedDate = function(q, a) {
		if (!(a && a instanceof Date)) {
			if (this._nullDate) {
				return ""
			}
			a = new Date(this._activeDate)
		}
		return this._dateToStr(a, q)
	};
	this.getWeekNumber = function(A) {
		if (typeof(A) == "string") {
			A = this._strToDate(A)
		}
		if (!(A instanceof Date)) {
			return "Invalid Date"
		}
		if (typeof(this._ftDay) == "undefined") {
			this._ftDay = 4
		}
		var I = this._wStart;
		var y = I + 7;
		var H = 4;
		var w = new Date(A.getFullYear(), 0, 1, 0, 0, 0, 0);
		var x = w.getDay();
		if (x == 0) {
			x = 7
		}
		if (H < I) {
			H += 7;
			x += 7
		}
		var E = 0;
		if (x >= I && x <= H) {} else {
			E = 1
		}
		var D = x - I;
		var F = new Date(A.getFullYear(), 0, 1 - D + E * 7, 0, 0, 0, 0);
		var K = 604800000;
		var q = new Date(A.getFullYear(), A.getMonth(), A.getDate() + 1, 0, 0, 0, 0);
		var J = Math.ceil((q.getTime() - F.getTime()) / K);
		if (J == 0) {
			var C = new Date(A.getFullYear(), A.getMonth(), A.getDate(), 0, 0, 0, 0);
			var a = C.getDay() - this._wStart;
			if (a < 0) {
				a = a + 7
			}
			C.setDate(C.getDate() - a);
			J = this.getWeekNumber(C)
		}
		return J
	};
	this.showWeekNumbers = function() {
		this.base.firstChild.className = "dhtmlxcalendar_wn"
	};
	this.hideWeekNumbers = function() {
		this.base.firstChild.className = ""
	};
	this.show = function(w) {
		if (!w && this._hasParent) {
			this._show();
			return
		}
		if (typeof(w) == "object" && typeof(w._dhtmlxcalendar_uid) != "undefined" && this.i[w._dhtmlxcalendar_uid] == w) {
			this._show(w._dhtmlxcalendar_uid);
			return
		}
		if (typeof(w) == "undefined") {
			for (var q in this.i) {
				if (!w) {
					w = q
				}
			}
		}
		if (!w) {
			return
		}
		this._show(w)
	};
	this.hide = function() {
		if (this._isVisible()) {
			this._hide()
		}
	};
	this.isVisible = function() {
		return this._isVisible()
	};
	this._activeInp = null;
	this.pos = "bottom";
	this.setPosition = function(a, q) {
		this._px = null;
		this._py = null;
		if (a == "right" || a == "bottom") {
			this.pos = a
		} else {
			this.pos = "int";
			if (typeof(a) != "undefined" && !isNaN(a)) {
				this.base.style.left = a + "px";
				this._px = a
			}
			if (typeof(q) != "undefined" && !isNaN(q)) {
				this.base.style.top = q + "px";
				this._py = q
			}
			this._ifrSize()
		}
	};
	this._show = function(C, a) {
		if (a === true && this._activeInp == C && this._isVisible()) {
			this._hide();
			return
		}
		this.base.style.visibility = "hidden";
		this.base.style.display = "";
		if (!C) {
			if (this._px && this._py) {
				this.base.style.left = this._px + "px";
				this.base.style.top = this._py + "px"
			} else {
				this.base.style.left = "0px";
				this.base.style.top = "0px"
			}
		} else {
			if (this.base.className.indexOf("dhtmlxcalendar_in_input") == -1) {
				this.base.className += " dhtmlxcalendar_in_input"
			}
			var x = (this.i[C].input || this.i[C].button);
			var q = (navigator.appVersion.indexOf("MSIE") != -1);
			var y = Math.max((q ? document.documentElement : document.getElementsByTagName("html")[0]).scrollTop, document.body.scrollTop);
			var w = y + (q ? Math.max(document.documentElement.clientHeight || 0, document.documentElement.offsetHeight || 0, document.body.clientHeight || 0) : window.innerHeight);
			if (this.pos == "right") {
				this.base.style.left = this._getLeft(x) + x.offsetWidth + "px";
				this.base.style.top = Math.min(this._getTop(x), w - this.base.offsetHeight) + "px"
			} else {
				if (this.pos == "bottom") {
					var A = this._getTop(x) + x.offsetHeight + 1;
					if (A + this.base.offsetHeight > w) {
						A = this._getTop(x) - this.base.offsetHeight
					}
					this.base.style.left = this._getLeft(x) + "px";
					this.base.style.top = A + "px"
				} else {
					this.base.style.left = (this._px || 0) + "px";
					this.base.style.top = (this._py || 0) + "px"
				}
			}
			this._activeInp = C;
			x = null
		}
		this._hideSelector();
		this.base.style.visibility = "visible";
		this.base.style.zIndex = window.dhx4.zim.reserve(this.conf.zi);
		this._ifrSize();
		if (this._ifr) {
			this._ifr.style.display = ""
		}
		this.callEvent("onShow", [])
	};
	this._hide = function() {
		this._hideSelector();
		this.base.style.display = "none";
		window.dhx4.zim.clear(this.conf.zi);
		if (this.base.className.indexOf("dhtmlxcalendar_in_input") >= 0) {
			this.base.className = this.base.className.replace(/\s{0,}dhtmlxcalendar_in_input/gi, "")
		}
		this._activeInp = null;
		if (this._ifr) {
			this._ifr.style.display = "none"
		}
		this.callEvent("onHide", [])
	};
	this._isVisible = function() {
		return (this.base.style.display != "none")
	};
	this._getLeft = function(a) {
		return this._posGetOffset(a).left
	};
	this._getTop = function(a) {
		return this._posGetOffset(a).top
	};
	this._posGetOffsetSum = function(a) {
		var w = 0,
			q = 0;
		while (a) {
			w = w + parseInt(a.offsetTop);
			q = q + parseInt(a.offsetLeft);
			a = a.offsetParent
		}
		return {
			top: w,
			left: q
		}
	};
	this._posGetOffsetRect = function(x) {
		var C = x.getBoundingClientRect();
		var D = document.body;
		var q = document.documentElement;
		var a = window.pageYOffset || q.scrollTop || D.scrollTop;
		var y = window.pageXOffset || q.scrollLeft || D.scrollLeft;
		var A = q.clientTop || D.clientTop || 0;
		var E = q.clientLeft || D.clientLeft || 0;
		var F = C.top + a - A;
		var w = C.left + y - E;
		return {
			top: Math.round(F),
			left: Math.round(w)
		}
	};
	this._posGetOffset = function(a) {
		return this[a.getBoundingClientRect ? "_posGetOffsetRect" : "_posGetOffsetSum"](a)
	};
	this._rangeActive = false;
	this._rangeFrom = null;
	this._rangeTo = null;
	this._rangeSet = {};
	this.setInsensitiveDays = function(x) {
		var a = this._extractDates(x);
		for (var w = 0; w < a.length; w++) {
			this._rangeSet[new Date(a[w].getFullYear(), a[w].getMonth(), a[w].getDate(), 0, 0, 0, 0).getTime()] = true
		}
		this._drawMonth(this._activeMonth)
	};
	this.clearInsensitiveDays = function() {
		this._clearRangeSet();
		this._drawMonth(this._activeMonth)
	};
	this._holidays = {};
	this.setHolidays = function(w) {
		if (w == null) {
			this._clearHolidays()
		} else {
			if (w != null) {
				var a = this._extractDates(w);
				for (var x = 0; x < a.length; x++) {
					this._holidays[new Date(a[x].getFullYear(), a[x].getMonth(), a[x].getDate(), 0, 0, 0, 0).getTime()] = true
				}
			}
		}
		this._drawMonth(this._activeMonth)
	};
	this._extractDates = function(y) {
		if (typeof(y) == "string" || y instanceof Date) {
			y = [y]
		}
		var x = [];
		for (var A = 0; A < y.length; A++) {
			if (typeof(y[A]) == "string") {
				var C = y[A].split(",");
				for (var a = 0; a < C.length; a++) {
					x.push(this._strToDate(C[a]))
				}
			} else {
				if (y[A] instanceof Date) {
					x.push(y[A])
				}
			}
		}
		return x
	};
	this._clearRange = function() {
		this._rangeActive = false;
		this._rangeType = null;
		this._rangeFrom = null;
		this._rangeTo = null
	};
	this._clearRangeSet = function() {
		for (var q in this._rangeSet) {
			this._rangeSet[q] = null;
			delete this._rangeSet[q]
		}
	};
	this._clearHolidays = function() {
		for (var q in this._holidays) {
			this._holidays[q] = null;
			delete this._holidays[q]
		}
	};
	this._isOutOfRange = function(q) {
		if (this._rangeSet[q] == true) {
			return true
		}
		if (this._rangeActive) {
			if (this._rangeType == "in" && (q < this._rangeFrom || q > this._rangeTo)) {
				return true
			}
			if (this._rangeType == "out" && (q >= this._rangeFrom && q <= this._rangeTo)) {
				return true
			}
			if (this._rangeType == "from" && q < this._rangeFrom) {
				return true
			}
			if (this._rangeType == "to" && q > this._rangeTo) {
				return true
			}
		}
		var a = new Date(q);
		if (this._rangeWeek) {
			if (this._rangeWeekData[a.getDay()] === true) {
				return true
			}
		}
		if (this._rangeMonth) {
			if (this._rangeMonthData[a.getDate()] === true) {
				return true
			}
		}
		if (this._rangeYear) {
			if (this._rangeYearData[a.getMonth() + "_" + a.getDate()] === true) {
				return true
			}
		}
		return false
	};
	this.clearSensitiveRange = function() {
		this._clearRange();
		this._drawMonth(this._activeMonth)
	};
	this.setSensitiveRange = function(x, w, a) {
		var q = false;
		if (x != null && w != null) {
			if (!(x instanceof Date)) {
				x = this._strToDate(x)
			}
			if (!(w instanceof Date)) {
				w = this._strToDate(w)
			}
			if (x.getTime() > w.getTime()) {
				return
			}
			this._rangeFrom = new Date(x.getFullYear(), x.getMonth(), x.getDate(), 0, 0, 0, 0).getTime();
			this._rangeTo = new Date(w.getFullYear(), w.getMonth(), w.getDate(), 0, 0, 0, 0).getTime();
			this._rangeActive = true;
			this._rangeType = "in";
			q = true
		}
		if (!q && x != null && w == null) {
			if (!(x instanceof Date)) {
				x = this._strToDate(x)
			}
			this._rangeFrom = new Date(x.getFullYear(), x.getMonth(), x.getDate(), 0, 0, 0, 0).getTime();
			this._rangeTo = null;
			if (a === true) {
				this._rangeFrom++
			}
			this._rangeActive = true;
			this._rangeType = "from";
			q = true
		}
		if (!q && x == null && w != null) {
			if (!(w instanceof Date)) {
				w = this._strToDate(w)
			}
			this._rangeFrom = null;
			this._rangeTo = new Date(w.getFullYear(), w.getMonth(), w.getDate(), 0, 0, 0, 0).getTime();
			if (a === true) {
				this._rangeTo--
			}
			this._rangeActive = true;
			this._rangeType = "to";
			q = true
		}
		if (q) {
			this._drawMonth(this._activeMonth)
		}
	};
	this.setInsensitiveRange = function(q, a) {
		if (q != null && a != null) {
			if (!(q instanceof Date)) {
				q = this._strToDate(q)
			}
			if (!(a instanceof Date)) {
				a = this._strToDate(a)
			}
			if (q.getTime() > a.getTime()) {
				return
			}
			this._rangeFrom = new Date(q.getFullYear(), q.getMonth(), q.getDate(), 0, 0, 0, 0).getTime();
			this._rangeTo = new Date(a.getFullYear(), a.getMonth(), a.getDate(), 0, 0, 0, 0).getTime();
			this._rangeActive = true;
			this._rangeType = "out";
			this._drawMonth(this._activeMonth);
			return
		}
		if (q != null && a == null) {
			this.setSensitiveRange(null, q, true);
			return
		}
		if (q == null && a != null) {
			this.setSensitiveRange(a, null, true);
			return
		}
	};
	this.disableDays = function(C, A) {
		if (C == "week") {
			if (typeof(A) != "object" && typeof(A.length) == "undefined") {
				A = [A]
			}
			if (!this._rangeWeekData) {
				this._rangeWeekData = {}
			}
			for (var w in this._rangeWeekData) {
				this._rangeWeekData[w] = false;
				delete this._rangeWeekData[w]
			}
			for (var y = 0; y < A.length; y++) {
				this._rangeWeekData[A[y]] = true;
				if (A[y] == 7) {
					this._rangeWeekData[0] = true
				}
			}
			this._rangeWeek = true
		}
		if (C == "month") {
			if (typeof(A) != "object" && typeof(A.length) == "undefined") {
				A = [A]
			}
			if (!this._rangeMonthData) {
				this._rangeMonthData = {}
			}
			for (var w in this._rangeMonthData) {
				this._rangeMonthData[w] = false;
				delete this._rangeMonthData[w]
			}
			for (var y = 0; y < A.length; y++) {
				this._rangeMonthData[A[y]] = true
			}
			this._rangeMonth = true
		}
		if (C == "year") {
			var x = this._extractDates(A);
			if (!this._rangeYearData) {
				this._rangeYearData = {}
			}
			for (var w in this._rangeYearData) {
				this._rangeYearData[w] = false;
				delete this._rangeYearData[w]
			}
			for (var y = 0; y < x.length; y++) {
				this._rangeYearData[x[y].getMonth() + "_" + x[y].getDate()] = true
			}
			this._rangeYear = true
		}
		this._drawMonth(this._activeMonth)
	};
	this.enableDays = function(a) {
		if (a == "week") {
			this._rangeWeek = false
		}
		if (a == "month") {
			this._rangeMonth = false
		}
		if (a == "year") {
			this._rangeYear = false
		}
		this._drawMonth(this._activeMonth)
	};
	this._tipData = {};
	this._tipTM = null;
	this._tipTMTime = 400;
	this._tipEvs = false;
	this._tipPopup = null;
	this._tipCellDate = null;
	this._tipCellDim = null;
	this.setTooltip = function(x, C, D, a) {
		var y = this._extractDates(x);
		for (var A = 0; A < y.length; A++) {
			var w = new Date(y[A].getFullYear(), y[A].getMonth(), y[A].getDate(), 0, 0, 0, 0).getTime();
			this._tipData[w] = {
				text: C,
				showIcon: D,
				usePopup: a
			}
		}
		this._drawMonth(this._activeMonth)
	};
	this.clearTooltip = function(w) {
		var x = this._extractDates(w);
		for (var y = 0; y < x.length; y++) {
			var a = new Date(x[y].getFullYear(), x[y].getMonth(), x[y].getDate(), 0, 0, 0, 0).getTime();
			this._tipData[a] = null;
			delete this._tipData[a]
		}
		this._drawMonth(this._activeMonth)
	};
	this._initTooltipPopup = function() {
		if (this._tipEvs) {
			return
		}
		this.attachEvent("onMouseOver", function(q) {
			var a = new Date(q.getFullYear(), q.getMonth(), q.getDate(), 0, 0, 0, 0).getTime();
			if (this._tipData[a] != null) {
				if (this._tipTM) {
					window.clearTimeout(this._tipTM)
				}
				this._tipCellDate = q;
				this._tipCellDim = this.getCellDimension(q);
				this._tipText = this._tipData[a].text;
				this._tipTM = window.setTimeout(this._showTooltipPopup, this._tipTMTime)
			}
		});
		this.attachEvent("onMouseOut", this._hideTooltipPopup);
		this._tipEvs = true
	};
	this._showTooltipPopup = function(C, a, D, q, A) {
		if (!m._tipPopup) {
			m._tipPopup = new dhtmlXPopup({
				mode: "top"
			})
		}
		m._tipPopup.attachHTML(m._tipText);
		m._tipPopup.show(m._tipCellDim.x, m._tipCellDim.y, m._tipCellDim.w, m._tipCellDim.h);
		m.callEvent("onPopupShow", [m._tipCellDate])
	};
	this._hideTooltipPopup = function() {
		if (this._tipTM) {
			window.clearTimeout(this._tipTM)
		}
		if (this._tipPopup != null && this._tipPopup.isVisible()) {
			this._tipPopup.hide();
			this.callEvent("onPopupHide", [this._tipCellDate])
		}
	};
	this.getPopup = function() {
		return this._tipPopup
	};
	this.getCellDimension = function(y) {
		if (typeof(y) == "string") {
			y = this._strToDate(y)
		}
		if (!(y instanceof Date)) {
			return null
		}
		var A = new Date(y.getFullYear(), y.getMonth(), y.getDate(), 0, 0, 0, 0).getTime();
		var x = null;
		for (var C = 0; C < this.contDates.childNodes.length; C++) {
			for (var a = 0; a < this.contDates.childNodes[C].childNodes.length; a++) {
				var D = this.contDates.childNodes[C].childNodes[a];
				if (D._date != null && D._date.getTime() == A) {
					x = {
						x: this._getLeft(D),
						y: this._getTop(D),
						w: D.offsetWidth,
						h: D.offsetHeight
					}
				}
				D = null
			}
		}
		return x
	};
	this._updateFromInput = function(a) {
		if (this._nullInInput && ((a.value).replace(/\s/g, "")).length == 0) {
			if (this.checkEvent("onBeforeChange")) {
				if (!this.callEvent("onBeforeChange", [null])) {
					if (this.i != null && this._activeInp != null && this.i[this._activeInp] != null && this.i[this._activeInp].input != null) {
						this.i[this._activeInp].input.value = this.getFormatedDate()
					}
					return
				}
			}
			this.setDate(null)
		} else {
			this._updateDateStr(a.value)
		}
		a = null
	};
	this._doOnClick = function(q) {
		q = q || event;
		var a = (q.target || q.srcElement);
		if (a._dhtmlxcalendar_uid && a._dhtmlxcalendar_uid != m._activeInp && m._isVisible() && m._activeInp) {
			m._hide();
			return
		}
		if (!a._dhtmlxcalendar_uid || !m.i[a._dhtmlxcalendar_uid]) {
			if (m._isSelectorVisible()) {
				m._hideSelector()
			} else {
				if (!m._hasParent && m._isVisible()) {
					m._hide()
				}
			}
		}
	};
	this._doOnKeyDown = function(a) {
		a = a || event;
		if (a.keyCode == 27 || a.keyCode == 13) {
			if (m._isSelectorVisible()) {
				m._hideSelector()
			} else {
				if (m._isVisible() && !m._hasParent) {
					m._hide()
				}
			}
		}
	};
	this._doOnInpClick = function(q) {
		q = q || event;
		if (q.type == "touchstart" && q.preventDefault != null) {
			q.preventDefault()
		}
		var a = (q.target || q.srcElement);
		if (!a._dhtmlxcalendar_uid) {
			return
		}
		if (!m._listenerEnabled) {
			m._updateFromInput(a)
		}
		m._show(a._dhtmlxcalendar_uid, true)
	};
	this._doOnInpKeyUp = function(q) {
		q = q || event;
		var a = (q.target || q.srcElement);
		if (q.keyCode == 13 || !a._dhtmlxcalendar_uid) {
			return
		}
		if (!m._listenerEnabled) {
			m._updateFromInput(a)
		}
	};
	this._doOnBtnClick = function(q) {
		q = q || event;
		if (q.type == "touchstart" && q.preventDefault != null) {
			q.preventDefault()
		}
		var a = (q.target || q.srcElement);
		if (!a._dhtmlxcalendar_uid) {
			return
		}
		if (m.i[a._dhtmlxcalendar_uid].input != null) {
			m._updateFromInput(m.i[a._dhtmlxcalendar_uid].input)
		}
		m._show(a._dhtmlxcalendar_uid, true)
	};
	this._doOnUnload = function() {
		if (m && m.unload) {
			m.unload()
		}
	};
	if (typeof(window.addEventListener) == "function") {
		document.body.addEventListener("click", m._doOnClick, false);
		window.addEventListener("keydown", m._doOnKeyDown, false);
		window.addEventListener("unload", m._doOnUnload, false);
		if (this.conf.touch == true) {
			document.body.addEventListener("touchstart", m._doOnClick, false)
		}
	} else {
		document.body.attachEvent("onclick", m._doOnClick);
		document.body.attachEvent("onkeydown", m._doOnKeyDown);
		window.attachEvent("onunload", m._doOnUnload)
	}
	this.attachObj = function(w) {
		var q = window.dhx4.newId();
		if (typeof(w) == "string") {
			this.i[q] = {
				input: document.getElementById(w)
			}
		} else {
			if (typeof(w.tagName) != "undefined") {
				this.i[q] = {
					input: w
				}
			} else {
				if (typeof(w) == "object" && (w.input != null || w.button != null)) {
					this.i[q] = {};
					if (w.input != null) {
						this.i[q].input = (typeof(w.input) == "string" ? document.getElementById(w.input) : w.input)
					}
					if (w.button != null) {
						this.i[q].button = (typeof(w.button) == "string" ? document.getElementById(w.button) : w.button)
					}
				}
			}
		}
		this._attachEventsToObject(q);
		return q
	};
	this.detachObj = function(x) {
		var w = null;
		if (this.i[x] != null) {
			w = x
		} else {
			if (typeof(x) == "string") {
				x = document.getElementById(x);
				w = x._dhtmlxcalendar_uid
			} else {
				if (typeof(x.tagName) != "undefined") {
					w = x._dhtmlxcalendar_uid
				} else {
					if (typeof(x) == "object" && (x.input != null || x.button != null)) {
						if (w == null && x.input != null) {
							w = (typeof(x.input) == "string" ? document.getElementById(x.input) : x.input)._dhtmlxcalendar_uid
						}
						if (w == null && x.button != null) {
							w = (typeof(x.button) == "string" ? document.getElementById(x.button) : x.button)._dhtmlxcalendar_uid
						}
					}
				}
			}
		}
		if (w != null && this.i[w] != null) {
			this._detachEventsFromObject(w);
			for (var q in this.i[q]) {
				this.i[w][q]._dhtmlxcalendar_uid = null;
				this.i[w][q] = null;
				delete this.i[w][q]
			}
			this.i[w] = null;
			delete this.i[w];
			return true
		}
		return false
	};
	this._attachEventsToObject = function(q) {
		if (this.i[q].button != null) {
			this.i[q].button._dhtmlxcalendar_uid = q;
			if (typeof(window.addEventListener) == "function") {
				this.i[q].button.addEventListener("click", m._doOnBtnClick, false);
				if (this.conf.touch == true) {
					this.i[q].button.addEventListener("touchstart", m._doOnBtnClick, false)
				}
			} else {
				this.i[q].button.attachEvent("onclick", m._doOnBtnClick)
			}
		} else {
			if (this.i[q].input != null) {
				this.i[q].input._dhtmlxcalendar_uid = q;
				if (typeof(window.addEventListener) == "function") {
					this.i[q].input.addEventListener("click", m._doOnInpClick, false);
					this.i[q].input.addEventListener("keyup", m._doOnInpKeyUp, false);
					if (this.conf.touch == true) {
						this.i[q].input.addEventListener("touchstart", m._doOnInpClick, false)
					}
				} else {
					this.i[q].input.attachEvent("onclick", m._doOnInpClick);
					this.i[q].input.attachEvent("onkeyup", m._doOnInpKeyUp)
				}
			}
		}
	};
	this._detachEventsFromObject = function(q) {
		if (this.i[q].button != null) {
			if (typeof(window.addEventListener) == "function") {
				this.i[q].button.removeEventListener("click", m._doOnBtnClick, false);
				if (this.conf.touch == true) {
					this.i[q].button.removeEventListener("touchstart", m._doOnBtnClick, false)
				}
			} else {
				this.i[q].button.detachEvent("onclick", m._doOnBtnClick)
			}
		} else {
			if (this.i[q].input != null) {
				if (typeof(window.addEventListener) == "function") {
					this.i[q].input.removeEventListener("click", m._doOnInpClick, false);
					this.i[q].input.removeEventListener("keyup", m._doOnInpKeyUp, false);
					if (this.conf.touch == true) {
						this.i[q].input.removeEventListener("touchstart", m._doOnInpClick, false)
					}
				} else {
					this.i[q].input.detachEvent("onclick", m._doOnInpClick);
					this.i[q].input.detachEvent("onkeyup", m._doOnInpKeyUp)
				}
			}
		}
	};
	this.enableListener = function(a) {
		if (!a) {
			return
		}
		if (typeof(window.addEventListener) == "function") {
			a.addEventListener("focus", m._listenerEvFocus, false);
			a.addEventListener("blur", m._listenerEvBlur, false)
		} else {
			a.attachEvent("onfocus", m._listenerEvFocus);
			a.attachEvent("onblur", m._listenerEvBlur)
		}
		a = null
	};
	this.disableListener = function(a) {
		if (!a) {
			return
		}
		a._f0 = false;
		if (this._tmListener) {
			window.clearTimeout(this._tmListener)
		}
		if (typeof(window.addEventListener) == "function") {
			a.removeEventListener("focus", m._listenerEvFocus, false);
			a.removeEventListener("blur", m._listenerEvBlur, false)
		} else {
			a.detachEvent("onfocus", m._listenerEvFocus);
			a.detachEvent("onblur", m._listenerEvBlur)
		}
		a = null
	};
	this._startListener = function(a) {
		if (this._tmListener) {
			window.clearTimeout(this._tmListener)
		}
		if (typeof(a._v1) == "undefined") {
			a._v1 = a.value
		}
		if (a._v1 != a.value) {
			this._updateFromInput(a);
			a._v1 = a.value
		}
		if (a._f0) {
			this._tmListener = window.setTimeout(function() {
				m._startListener(a)
			}, 100)
		}
	};
	this._listenerEvFocus = function(q) {
		q = q || event;
		var a = q.target || q.srcElement;
		a._f0 = true;
		m._startListener(a);
		a = null
	};
	this._listenerEvBlur = function(q) {
		q = q || event;
		var a = q.target || q.srcElement;
		a._f0 = false;
		a = null
	};
	for (var r in this.i) {
		this._attachEventsToObject(r)
	}
	window.dhx4._eventable(this);
	this._evOnArrowClick = function(a) {
		return this.callEvent("onArrowClick", a)
	};
	this._evOnClick = function(a) {
		return this.callEvent("onClick", a)
	};
	this._evOnMouseOut = function(a) {
		return this.callEvent("onMouseOut", a)
	};
	this._evOnMouseOver = function(a) {
		return this.callEvent("onMouseOver", a)
	};
	this.unload = function() {
		this._activeDate = null;
		this._activeDateCell = null;
		this._activeInp = null;
		this._activeMonth = null;
		this._dateFormat = null;
		this._dateFormatRE = null;
		this._lastHover = null;
		if (this._tmListener) {
			window.clearTimeout(this._tmListener)
		}
		this._tmListener = null;
		if (typeof(window.addEventListener) == "function") {
			document.body.removeEventListener("click", m._doOnClick, false);
			window.removeEventListener("keydown", m._doOnKeyDown, false);
			window.removeEventListener("unload", m._doOnUnload, false);
			if (this.conf.touch == true) {
				document.body.removeEventListener("touchstart", m._doOnClick, false)
			}
		} else {
			document.body.detachEvent("onclick", m._doOnClick);
			document.body.detachEvent("onkeydown", m._doOnKeyDown);
			window.detachEvent("onunload", m._doOnKeyDown)
		}
		this._doOnClick = null;
		this._doOnKeyDown = null;
		this._doOnUnload = null;
		for (var q in this.i) {
			this.i[q]._dhtmlxcalendar_uid = null;
			this._detachEventsFromObject(q);
			this.disableListener(this.i[q].input);
			this.i[q] = null;
			delete this.i[q]
		}
		this.i = null;
		this._doOnInpClick = null;
		this._doOnInpKeyUp = null;
		window.dhx4._eventable(this, "clear");
		this.contMonth.onselectstart = null;
		this.contMonth.firstChild.firstChild.onclick = null;
		this.contMonth.firstChild.firstChild.ontouchstart = null;
		this.contMonth.firstChild.firstChild.firstChild.onmouseover = null;
		this.contMonth.firstChild.firstChild.firstChild.onmouseout = null;
		this.contMonth.firstChild.firstChild.lastChild.onmouseover = null;
		this.contMonth.firstChild.firstChild.lastChild.onmouseout = null;
		while (this.contMonth.firstChild.firstChild.childNodes.length > 0) {
			this.contMonth.firstChild.firstChild.removeChild(this.contMonth.firstChild.firstChild.lastChild)
		}
		this.contMonth.firstChild.removeChild(this.contMonth.firstChild.firstChild);
		this.contMonth.removeChild(this.contMonth.firstChild);
		this.contMonth.parentNode.removeChild(this.contMonth);
		this.contMonth = null;
		while (this.contDays.firstChild.childNodes.length > 0) {
			this.contDays.firstChild.removeChild(this.contDays.firstChild.lastChild)
		}
		this.contDays.removeChild(this.contDays.firstChild);
		this.contDays.parentNode.removeChild(this.contDays);
		this.contDays = null;
		this.contDates.onclick = null;
		this.contDates.ontouchstart = null;
		this.contDates.onmouseover = null;
		this.contDates.onmouseout = null;
		while (this.contDates.childNodes.length > 0) {
			while (this.contDates.lastChild.childNodes.length > 0) {
				this.contDates.lastChild.lastChild._css_date = null;
				this.contDates.lastChild.lastChild._css_month = null;
				this.contDates.lastChild.lastChild._css_weekend = null;
				this.contDates.lastChild.lastChild._css_hover = null;
				this.contDates.lastChild.lastChild._date = null;
				this.contDates.lastChild.lastChild._q = null;
				this.contDates.lastChild.lastChild._w = null;
				this.contDates.lastChild.removeChild(this.contDates.lastChild.lastChild)
			}
			this.contDates.removeChild(this.contDates.lastChild)
		}
		this.contDates.parentNode.removeChild(this.contDates);
		this.contDates = null;
		this.contTime.firstChild.firstChild.onclick = null;
		this.contTime.firstChild.firstChild.ontouchstart = null;
		while (this.contTime.firstChild.firstChild.childNodes.length > 0) {
			this.contTime.firstChild.firstChild.removeChild(this.contTime.firstChild.firstChild.lastChild)
		}
		this.contTime.firstChild.removeChild(this.contTime.firstChild.firstChild);
		this.contTime.removeChild(this.contTime.firstChild);
		this.contTime.parentNode.removeChild(this.contTime);
		this.contTime = null;
		this._lastHover = null;
		this._unloadSelector("month");
		this._unloadSelector("year");
		this._unloadSelector("hours");
		this._unloadSelector("minutes");
		if (this._selCover) {
			this._selCover.parentNode.removeChild(this._selCover);
			this._selCover = null
		}
		if (this._sel) {
			for (var q in this._sel._ta) {
				this._sel._ta[q] = null
			}
			this._sel._ta = null;
			this._sel._t = null;
			this._sel.onmouseover = null;
			this._sel.onmouseout = null;
			while (this._sel.firstChild.firstChild.firstChild.childNodes.length > 0) {
				this._sel.firstChild.firstChild.firstChild.lastChild.onclick = null;
				this._sel.firstChild.firstChild.firstChild.lastChild.onmouseover = null;
				this._sel.firstChild.firstChild.firstChild.lastChild.onmouseout = null;
				this._sel.firstChild.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild.lastChild)
			}
			this._sel.firstChild.firstChild.removeChild(this._sel.firstChild.firstChild.firstChild);
			this._sel.firstChild.removeChild(this._sel.firstChild.firstChild);
			while (this._sel.childNodes.length > 0) {
				this._sel.removeChild(this._sel.lastChild)
			}
			this._sel.parentNode.removeChild(this._sel);
			this._sel = null
		}
		this.base.onclick = null;
		this.base.onmousedown = null;
		this.base.ontouchstart = null;
		this.base.onmouseout = null;
		this.base.parentNode.removeChild(this.base);
		this.base = null;
		this._clearDayHover = null;
		this._clearSelHover = null;
		this._doOnSelectorChange = null;
		this._doOnSelectorShow = null;
		this._drawMonth = null;
		this._fixLength = null;
		this._getLeft = null;
		this._getTop = null;
		this._ifrSize = null;
		this._hide = null;
		this._hideSelector = null;
		this._initSelector = null;
		this._isSelectorVisible = null;
		this._isVisible = null;
		this._posGetOffset = null;
		this._posGetOffsetRect = null;
		this._posGetOffsetSum = null;
		this._scrollYears = null;
		this._show = null;
		this._showSelector = null;
		this._strToDate = null;
		this._updateActiveHours = null;
		this._updateActiveMinutes = null;
		this._updateActiveMonth = null;
		this._updateActiveYear = null;
		this._updateCellStyle = null;
		this._updateDateStr = null;
		this._updateVisibleHours = null;
		this._updateVisibleMinutes = null;
		this._updateYearsList = null;
		this.enableIframe = null;
		this.hide = null;
		this.hideTime = null;
		this.setDate = null;
		this.setDateFormat = null;
		this.setYearsRange = null;
		this.show = null;
		this.showTime = null;
		this.unload = null;
		if (this._tipPopup != null) {
			this._tipPopup.unload();
			this._tipPopup = null
		}
		for (var q in this) {
			delete this[q]
		}
		q = m = null
	};
	this.setDate(this._activeDate);
	return this
}
dhtmlXCalendarObject.prototype.lang = "en";
dhtmlXCalendarObject.prototype.langData = {
	en: {
		dateformat: "%Y-%m-%d",
		hdrformat: "%F %Y",
		monthesFNames: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
		monthesSNames: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
		daysFNames: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
		daysSNames: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
		weekstart: 1,
		weekname: "w"
	}
};
dhtmlXCalendarObject.prototype._buildMonthHdr = function(m) {
	var c = this;
	var l = function(n) {
		return (String(n).length == 1 ? "0" + String(n) : n)
	};
	var a = function(n, o) {
		return "<span class='dhtmlxcalendar_month_label_" + n + "'>" + o + "</span>"
	};
	var g = String(this.langData[this.lang].hdrformat || ("%F %Y")).replace(/%[a-z]/gi, function(n) {
		switch (n) {
			case "%m":
				return a("month", l(m.getMonth() + 1));
			case "%n":
				return a("month", m.getMonth() + 1);
			case "%M":
				return a("month", c.langData[c.lang].monthesSNames[m.getMonth()]);
			case "%F":
				return a("month", c.langData[c.lang].monthesFNames[m.getMonth()]);
			case "%y":
				return a("year", l(m.getYear() % 100));
			case "%Y":
				return a("year", m.getFullYear());
			case "%%":
				return "%";
			default:
				return n
		}
	});
	c = l = a = null;
	return g
};
dhtmlXCalendarObject.prototype.enableIframe = function(a) {
	if (a == true) {
		if (!this._ifr) {
			this._ifr = document.createElement("IFRAME");
			this._ifr.frameBorder = 0;
			this._ifr.border = 0;
			this._ifr.setAttribute("src", "javascript:false;");
			this._ifr.className = "dhtmlxcalendar_ifr";
			this._ifr.onload = function() {
				this.onload = null;
				this.contentWindow.document.open("text/html", "replace");
				this.contentWindow.document.write("<html><head><style>html,body{width:100%;height:100%;overflow:hidden;margin:0px;}</style></head><body</body></html>")
			};
			this.base.parentNode.insertBefore(this._ifr, this.base);
			this._ifrSize()
		}
	} else {
		if (this._ifr) {
			this._ifr.parentNode.removeChild(this._ifr);
			this._ifr = null
		}
	}
};
dhtmlXCalendarObject.prototype._ifrSize = function() {
	if (this._ifr) {
		this._ifr.style.left = this.base.style.left;
		this._ifr.style.top = this.base.style.top;
		this._ifr.style.width = this.base.offsetWidth + "px";
		this._ifr.style.height = this.base.offsetHeight + "px"
	}
};
dhtmlxCalendarObject = dhtmlXCalendarObject;
dhtmlXCalendarObject.prototype._dateStrings = function() {
	var a = this.langData[this.lang];
	return {
		monthFullName: a.monthesFNames,
		monthShortName: a.monthesSNames,
		dayFullName: a.daysFNames,
		dayShortName: a.daysSNames
	}
};
dhtmlXCalendarObject.prototype._strToDate = function(c, a) {
	return window.dhx4.str2date(c, a || this._dateFormat, this._dateStrings())
};
dhtmlXCalendarObject.prototype._dateToStr = function(c, a) {
	return window.dhx4.date2str(c, a || this._dateFormat, this._dateStrings())
};
window.dhtmlxDblCalendarObject = window.dhtmlXDoubleCalendarObject = window.dhtmlXDoubleCalendar = function(c) {
	var a = this;
	this.leftCalendar = new dhtmlXCalendarObject(c);
	this.leftCalendar.hideTime();
	this.rightCalendar = new dhtmlXCalendarObject(c);
	this.rightCalendar.hideTime();
	this.leftCalendar.attachEvent("onClick", function(g) {
		a._updateRange("rightCalendar", g, null);
		a._evOnClick(["left", g])
	});
	this.rightCalendar.attachEvent("onClick", function(g) {
		a._updateRange("leftCalendar", null, g);
		a._evOnClick(["right", g])
	});
	this.leftCalendar.attachEvent("onBeforeChange", function(g) {
		return a._evOnBeforeChange(["left", g])
	});
	this.rightCalendar.attachEvent("onBeforeChange", function(g) {
		return a._evOnBeforeChange(["right", g])
	});
	this.show = function() {
		this.leftCalendar.show();
		this.rightCalendar.base.style.marginLeft = this.leftCalendar.base.offsetWidth - 1 + "px";
		this.rightCalendar.show()
	};
	this.hide = function() {
		this.leftCalendar.hide();
		this.rightCalendar.hide()
	};
	this.setDateFormat = function(g) {
		this.leftCalendar.setDateFormat(g);
		this.rightCalendar.setDateFormat(g)
	};
	this.setDates = function(l, g) {
		if (l != null) {
			this.leftCalendar.setDate(l)
		}
		if (g != null) {
			this.rightCalendar.setDate(g)
		}
		this._updateRange()
	};
	this._updateRange = function(g, m, l) {
		if (arguments.length == 3) {
			(g == "leftCalendar" ? this.leftCalendar : this.rightCalendar).setSensitiveRange(m, l)
		} else {
			this.leftCalendar.setSensitiveRange(null, this.rightCalendar.getDate());
			this.rightCalendar.setSensitiveRange(this.leftCalendar.getDate(), null)
		}
	};
	this.getFormatedDate = function() {
		return this.leftCalendar.getFormatedDate.apply(this.leftCalendar, arguments)
	};
	this.unload = function() {
		window.dhx4._eventable(this, "clear");
		this.leftCalendar.unload();
		this.rightCalendar.unload();
		this.leftCalendar = this.rightCalendar = null;
		this._updateRange = null;
		this._evOnClick = null;
		this._evOnBeforeChange = null;
		this.show = null;
		this.hide = null;
		this.setDateFormat = null;
		this.setDates = null;
		this.getFormatedDate = null;
		this.unload = null;
		a = null
	};
	this._evOnClick = function(g) {
		return this.callEvent("onClick", g)
	};
	this._evOnBeforeChange = function(g) {
		return this.callEvent("onBeforeChange", g)
	};
	window.dhx4._eventable(this);
	return this
};

function dhtmlXCombo(n, u, g, r, m) {
	var o = this;
	var l = null;
	var v = null;
	if (typeof(n) == "object" && !n.tagName) {
		l = n;
		n = l.parent;
		g = l.width;
		u = l.name;
		r = l.mode;
		v = l.skin
	}
	this.cont = (typeof(n) == "string" ? document.getElementById(n) : n);
	this.conf = {
		skin: null,
		form_name: u || "dhxcombo",
		combo_width: (parseInt(g) || this.cont.offsetWidth || 120) - (dhx4.isFF || dhx4.isIE || dhx4.isChrome || dhx4.isOpera ? 2 : 0),
		combo_image: false,
		combo_focus: false,
		opts_type: (typeof(r) == "string" && typeof(this.modes[r]) != "undefined" ? r : "option"),
		opts_count: 8,
		opts_count_min: 3,
		opts_width: null,
		item_h: null,
		list_zi_id: window.dhx4.newId(),
		allow_free_text: true,
		allow_empty_value: true,
		enabled: true,
		img_path: "",
		img_def: "",
		img_def_dis: true,
		template: {
			input: "#text#",
			option: "#text#"
		},
		f_func: null,
		f_mode: false,
		f_url: false,
		f_cache: false,
		f_cache_data: {},
		f_dyn: false,
		f_dyn_end: false,
		f_mask: "",
		f_ac: true,
		f_ac_text: "",
		f_server_tm: null,
		f_server_last: "",
		f_loading: false,
		s_tm: null,
		s_time: 200,
		s_mode: "select",
		last_hover: null,
		last_selected: null,
		last_match: null,
		last_text: "",
		last_value: "",
		tm_hover: null,
		tm_confirm_blur: null,
		clear_click: false,
		clear_blur: false,
		clear_bsp: false,
		clear_key: false,
		sp: {
			dhx_skyblue: {
				list_ofs: 1,
				hdr_ofs: 1,
				scr_ofs: 1
			},
			dhx_web: {
				list_ofs: 0,
				hdr_ofs: 1,
				scr_ofs: 0
			},
			dhx_terrace: {
				list_ofs: 1,
				hdr_ofs: 1,
				scr_ofs: 1
			}
		},
		col_w: null
	};
	this.conf.combo_image = (this.modes[this.conf.opts_type].image == true);
	this.t = {};
	this.base = document.createElement("DIV");
	this.base.style.width = this.conf.combo_width + "px";
	this.base.innerHTML = "<input type='text' class='dhxcombo_input' style='width:" + (this.conf.combo_width - 24 - (this.conf.combo_image ? 23 : 0)) + "px;" + (this.conf.combo_image ? "margin-left:23px;" : "") + "' autocomplete='off'><input type='hidden' value=''><input type='hidden' value='false'><div class='dhxcombo_select_button'><div class='dhxcombo_select_img'></div></div>" + (this.conf.combo_image ? "<div class='dhxcombo_top_image'>" + this.modes[this.conf.opts_type].getTopImage(null, this.conf.enabled) + "</div>" : "");
	this.cont.appendChild(this.base);
	this.list = document.createElement("DIV");
	this.list._listId = window.dhx4.newId();
	this.list.style.display = "none";
	document.body.insertBefore(this.list, document.body.firstChild);
	this._doOnListScroll = function() {
		if (o.conf.s_tm != null) {
			window.clearTimeout(o.conf.s_tm)
		}
		o.conf.s_tm = window.setTimeout(o._doOnListScrollAction, o.conf.s_time)
	};
	this._doOnListScrollAction = function() {
		o.conf.s_tm = null;
		if (o.conf.s_mode == "scroll" && o.list.scrollHeight - o.list.scrollTop - 10 < o.list.clientHeight) {
			o._subloadRequest()
		}
	};
	if (typeof(window.addEventListener) == "function") {
		this.list.addEventListener("scroll", this._doOnListScroll, false)
	} else {
		this.list.attachEvent("onscroll", this._doOnListScroll)
	}
	this.setSkin(v || window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhxcombo") || "dhx_skyblue");
	this._updateTopImage = function(a) {
		if (!this.conf.combo_image) {
			return
		}
		if (a != null) {
			this.base.lastChild.innerHTML = this.t[a].obj.getTopImage(this.t[a].item, this.conf.enabled)
		} else {
			this.base.lastChild.innerHTML = this.modes[this.conf.opts_type].getTopImage(null, this.conf.enabled)
		}
	};
	this._filterOpts = function(D) {
		if (this.conf.f_server_tm) {
			window.clearTimeout(this.conf.f_server_tm)
		}
		var y = String(this.base.firstChild.value).replace(new RegExp(this.conf.f_ac_text + "$", "i"), "");
		if (this.conf.f_server_last == y.toLowerCase()) {
			this._checkForMatch();
			return
		}
		if (this.conf.f_url != null && this.checkEvent("onDynXLS")) {
			this.conf.f_server_last = y.toLowerCase();
			this.callEvent("onDynXLS", [y]);
			return
		}
		if (this.conf.f_url != null) {
			if (y.length == 0) {
				this.conf.f_server_last = y.toLowerCase();
				this.clearAll();
				return
			}
			if (this.conf.f_cache == true && this.conf.f_cache_data[y] != null) {
				this.clearAll();
				this.conf.f_server_last = y.toLowerCase();
				for (var x = 0; x < this.conf.f_cache_data[y].data.length; x++) {
					this.load(this.conf.f_cache_data[y].data[x])
				}
				if (this.conf.f_dyn) {
					this.conf.f_dyn_end = this.conf.f_cache_data[y].dyn_end;
					this.conf.f_mask = this.conf.f_cache_data[y].mask
				}
				if (D !== true) {
					this._showList(true);
					this._checkForMatch()
				}
			} else {
				this.conf.f_server_tm = window.setTimeout(function() {
					o.conf.f_server_last = y.toLowerCase();
					o.conf.f_mask = y;
					var q = "mask=" + encodeURIComponent(y);
					if (o.conf.f_dyn) {
						q += "&pos=0";
						o.conf.f_dyn_end = false
					}
					var a = function(K) {
						if (o.conf.f_cache) {
							if (!o.conf.f_cache_data[y]) {
								o.conf.f_cache_data[y] = {
									data: [],
									dyn_end: false,
									mask: y
								}
							}
							o.conf.f_cache_data[y].data.push(K.xmlDoc.responseXML)
						}
						o.clearAll();
						o.load(K.xmlDoc.responseXML);
						var J = (o.base.offsetWidth > 0 && o.base.offsetHeight > 0);
						if (J == true && o.conf.enabled == true && o.conf.combo_focus == true && D !== true) {
							if (o.conf.f_ac && o.conf.f_mode == "start" && o.conf.clear_bsp == false && o.list.firstChild != null) {
								var I = o.list.firstChild._optId;
								var L = String(o.t[I].obj.getText(o.list.firstChild, true));
								if (String(L).toLowerCase().indexOf(String(y).toLowerCase()) === 0) {
									o.base.firstChild.value = L;
									o._selectRange(y.length, L.length)
								}
							}
							o._showList(true);
							o._checkForMatch()
						}
						a = null
					};
					if (window.dhx4.ajax.method == "post") {
						window.dhx4.ajax.post(o.conf.f_url, q, a)
					} else {
						if (window.dhx4.ajax.method == "get") {
							window.dhx4.ajax.get(o.conf.f_url + (String(o.conf.f_url).indexOf("?") >= 0 ? "&" : "?") + q, a)
						}
					}
				}, 200)
			}
		} else {
			this.conf.f_server_last = y.toLowerCase();
			var w = (y.length == 0 ? true : new RegExp((this.conf.f_mode == "start" ? "^" : "") + String(y).replace(/[\\\^\$\*\+\?\.\(\)\|\{\}\[\]]/gi, "\\$&"), "i"));
			var A = null;
			for (var E in this.t) {
				var H = false;
				if (w !== true) {
					if (this.conf.f_func != null) {
						var C = this._getOption(this.t[E].item._optId, x);
						H = (this.conf.f_func.apply(window, [y, C]) == true)
					} else {
						var F = this.t[E].obj.getText(this.t[E].item, true);
						H = (w.test(F) == true)
					}
				}
				if (w === true || H == true) {
					this.t[E].item.style.display = "";
					if (A == null && y.length > 0) {
						A = String(this.t[E].obj.getText(this.t[E].item, true))
					}
				} else {
					this.t[E].item.style.display = "none"
				}
			}
			if (this.conf.f_ac && this.conf.f_mode == "start" && this.conf.clear_bsp == false && A != null) {
				this.conf.f_ac_text = A.replace(new RegExp("^" + y, "i"), "");
				this.base.firstChild.value = A;
				this._selectRange(this.conf.f_server_last.length, this.base.firstChild.value.length)
			}
			if (this.conf.f_mode == "between" && this.conf.clear_bsp == true) {
				this._checkForMatch(true)
			}
			if (D !== true) {
				this._showList(true);
				this._checkForMatch()
			}
		}
	};
	this._initObj = function(a) {
		if (typeof(a.template) != "undefined") {
			this.setTemplate(a.template)
		}
		if (a.add != true && this.conf.f_loading != true) {
			this.clearAll(false)
		}
		this.addOption(a.options)
	};
	this._xmlToObj = function(S, A, y) {
		var E = {
			add: false,
			options: []
		};
		var L = (A == true ? S : S.getElementsByTagName("complete"));
		if (L.length > 0) {
			if (window.dhx4.s2b(L[0].getAttribute("add")) == true) {
				E.add = true
			}
			var K = L[0].childNodes;
			for (var I = 0; I < K.length; I++) {
				if (typeof(K[I].tagName) != "undefined") {
					if (String(K[I].tagName).toLowerCase() == "template") {
						var Q = {};
						for (var D = 0; D < K[I].childNodes.length; D++) {
							var J = K[I].childNodes[D];
							if (J.tagName != null) {
								var M = J.tagName;
								if (typeof(this.conf.template[M]) != "undefined") {
									Q[M] = window.dhx4._xmlNodeValue(J)
								}
								if (M == "columns") {
									for (var O = 0; O < J.childNodes.length; O++) {
										var C = J.childNodes[O];
										if (C.tagName != null && C.tagName == "column") {
											var H = {};
											for (var P in {
													width: 1,
													css: 1,
													header: 1,
													option: 1
												}) {
												if (C.getAttribute(P) != null) {
													H[P] = C.getAttribute(P)
												}
											}
											for (var P in {
													header: 1,
													option: 1
												}) {
												var N = C.getElementsByTagName(P);
												if (N[0] != null && N[0].firstChild != null) {
													H[P] = window.dhx4._xmlNodeValue(N[0])
												}
											}
											if (Q.columns == null) {
												Q.columns = []
											}
											Q.columns.push(H)
										}
										C = null
									}
								}
							}
							J = null
						}
						this.setTemplate(Q)
					}
					if (String(K[I].tagName).toLowerCase() == "option") {
						var F = false;
						if (A == true) {
							F = (E.options.length == y)
						} else {
							F = window.dhx4.s2b(K[I].getAttribute("selected"))
						}
						var x = {
							value: K[I].getAttribute("value"),
							text: window.dhx4._xmlNodeValue(K[I]),
							selected: F,
							checked: window.dhx4.s2b(K[I].getAttribute("checked"))
						};
						for (var P in {
								img: 1,
								img_dis: 1,
								img_src: 1,
								img_src_dis: 1,
								css: 1
							}) {
							if (K[I].getAttribute(P) != null) {
								x[P] = K[I].getAttribute(P)
							}
						}
						for (var D = 0; D < K[I].childNodes.length; D++) {
							if (K[I].childNodes[D].tagName != null && String(K[I].childNodes[D].tagName).toLowerCase() == "text") {
								x.text = {};
								var J = K[I].childNodes[D];
								for (var O = 0; O < J.childNodes.length; O++) {
									if (J.childNodes[O].tagName != null) {
										x.text[J.childNodes[O].tagName] = window.dhx4._xmlNodeValue(J.childNodes[O])
									}
								}
							}
						}
						E.options.push(x)
					}
				}
			}
			L = K = null
		}
		return E
	};
	window.dhx4._enableDataLoading(this, "_initObj", "_xmlToObj", "complete", {
		data: true
	});
	window.dhx4._eventable(this);
	this._getNearItem = function(w, q) {
		var a = null;
		while (w != null) {
			w = w[q < 0 ? "previousSibling" : "nextSibling"];
			if (a == null && w != null && w.style.display == "" && w._optId != null) {
				a = w;
				w = null
			}
		}
		return a
	};
	this.setName(this.conf.form_name);
	this._doOnListMouseMove = function(q) {
		q = q || event;
		var a = q.target || q.srcElement;
		while (a != null && a != this) {
			if (typeof(a._optId) != "undefined") {
				if (o.conf.tm_hover) {
					window.clearTimeout(o.conf.tm_hover)
				}
				o._setSelected(a._optId)
			}
			a = a.parentNode
		}
		a = null
	};
	this._doOnListMouseDown = function(a) {
		a = a || event;
		a.cancelBubble = true;
		o.conf.clear_click = true;
		window.setTimeout(function() {
			o.base.firstChild.focus()
		}, 1)
	};
	this._doOnListMouseUp = function(w) {
		w = w || event;
		var a = w.target || w.srcElement;
		while (a != null && a != this) {
			if (typeof(a._optId) != "undefined") {
				var q = true;
				if (typeof(o.t[a._optId].obj.optionClick) == "function" && o.t[a._optId].obj.optionClick(a, w, o) !== true) {
					q = false
				}
				if (q) {
					o._setSelected(a._optId, null, true);
					o._confirmSelect("click")
				}
			}
			a = a.parentNode
		}
		a = null
	};
	this._doOnListMouseOut = function(a) {
		if (o.conf.tm_hover) {
			window.clearTimeout(o.conf.tm_hover)
		}
		o.conf.tm_hover = window.setTimeout(function() {
			var q = o.conf.last_match || o.conf.last_selected;
			if (o.conf.last_match == null && o.t[q] != null) {
				if (o.base.firstChild.value != o.t[q].obj.getText(o.t[q].item, true)) {
					q = null
				}
			}
			o._setSelected(q, null, true)
		}, 1)
	};
	this._doOnBaseMouseDown = function(y) {
		if (!o.conf.enabled) {
			return
		}
		o.conf.clear_click = true;
		y = y || event;
		var q = y.target || y.srcElement;
		if (q != this.firstChild) {
			window.setTimeout(function() {
				o.base.firstChild.focus()
			}, 1);
			var x = q;
			while (x != this && x != null) {
				if (x == this.lastChild) {
					if (typeof(o.modes[o.conf.opts_type].topImageClick) == "function") {
						var w = (o.conf.last_hover || o.conf.last_selected);
						var a = (w != null ? o.t[w].item : null);
						if (o.modes[o.conf.opts_type].topImageClick(a, o) !== true) {
							w = a = null;
							return
						}
					}
					x = null
				} else {
					x = x.parentNode
				}
			}
		}
		if (o._isListVisible()) {
			o._hideList()
		} else {
			if (q != this.firstChild) {
				o.conf.clear_blur = true
			}
			o._showList();
			o._setSelected(o.conf.last_selected, true, true)
		}
		q = null
	};
	this._doOnBodyMouseDown = function() {
		if (o.conf.clear_click) {
			o.conf.clear_click = false;
			return
		}
		o._confirmSelect("blur")
	};
	this._doOnInputFocus = function() {
		o.conf.clear_blur = false;
		if (o.conf.tm_confirm_blur) {
			window.clearTimeout(o.conf.tm_confirm_blur)
		}
		if (o.conf.combo_focus == false) {
			o.conf.combo_focus = true;
			o.callEvent("onFocus", [])
		}
	};
	this._doOnInputBlur = function() {
		if (o.conf.clear_blur == true) {
			o.conf.clear_blur = false;
			return
		}
		if (o.conf.tm_confirm_blur) {
			window.clearTimeout(o.conf.tm_confirm_blur)
		}
		o.conf.tm_confirm_blur = window.setTimeout(function() {
			if (o.conf.clear_click == false) {
				o._confirmSelect("blur");
				o.conf.combo_focus = false;
				o.callEvent("onBlur", [])
			}
		}, 20)
	};
	this._doOnInputKeyUp = function(a) {
		a = a || event;
		if (o.conf.f_mode != false) {
			o.conf.clear_bsp = (a.keyCode == 8 || a.keyCode == 46);
			o._filterOpts();
			return
		} else {
			o._checkForMatch()
		}
	};
	this._doOnInputKeyDown = function(a) {
		a = a || event;
		if ((a.keyCode == 38 || a.keyCode == 40) && !a.ctrlKey && !a.shiftKey && !a.altKey) {
			if (a.preventDefault) {
				a.preventDefault()
			} else {
				a.returnValue = false
			}
			a.cancelBubble = true;
			o._keyOnUpDown(a.keyCode == 38 ? -1 : 1)
		}
		if (a.keyCode == 113) {
			if (!o._isListVisible()) {
				o._showList();
				if (o.base.firstChild.value == o.conf.last_text) {
					o._setSelected(o.conf.last_selected, true, true);
					o.base.firstChild.value = o.conf.last_text;
					o.conf.f_server_last = o.base.firstChild.value.toLowerCase()
				} else {
					o.conf.f_server_last = o.base.firstChild.value.toLowerCase();
					if (o.conf.f_mode == false) {
						o._checkForMatch()
					}
				}
			} else {}
		}
		if (a.keyCode == 27) {
			if (a.preventDefault) {
				a.preventDefault()
			} else {
				a.returnValue = false
			}
			a.cancelBubble = true;
			o._cancelSelect()
		}
		if (a.keyCode == 13) {
			if (a.preventDefault) {
				a.preventDefault()
			}
			o._confirmSelect("kbd")
		}
		o.conf.clear_key = true;
		o.callEvent("onKeyPressed", [a.keyCode || a.charCode])
	};
	this._doOnInputKeyPress = function(a) {
		if (o.conf.clear_key) {
			o.conf.clear_key = false;
			return
		}
		a = a || event;
		o.callEvent("onKeyPressed", [a.keyCode || a.charCode])
	};
	this._keyOnUpDown = function(a) {
		var q = null;
		if (this.conf.last_hover) {
			q = this.t[this.conf.last_hover].item
		} else {
			if (this.conf.last_selected) {
				q = this.t[this.conf.last_selected].item
			}
		}
		if (!q && this._getListVisibleCount() == 0) {
			return
		}
		if (q != null && q.style.display != "") {
			q = null
		}
		this._showList();
		if (q != null) {
			if (this.t[q._optId].obj.isSelected(q)) {
				q = this._getNearItem(q, a)
			}
		} else {
			q = this.list.firstChild;
			if (q.style.display != "") {
				q = this._getNearItem(q, 1)
			}
		}
		if (q == null) {
			return
		}
		this._setSelected(q._optId, true, true);
		if (this.conf.f_mode == false) {
			this.base.firstChild.value = this.t[q._optId].obj.getText(q, true)
		} else {
			var w = String(this.t[q._optId].obj.getText(q, true));
			if (this.conf.f_mode == "start" && this.conf.f_ac == true) {
				if (w.toLowerCase().indexOf(this.conf.f_server_last) === 0) {
					this.conf.f_ac_text = w.substring(this.conf.f_server_last.length, w.length);
					this.base.firstChild.value = w;
					this._selectRange(this.conf.f_server_last.length, this.base.firstChild.value.length)
				} else {
					this.base.firstChild.value = w;
					this.conf.f_server_last = this.base.firstChild.value.toLowerCase();
					this._selectRange(0, this.base.firstChild.value.length)
				}
			} else {
				this.base.firstChild.value = w;
				this.conf.f_server_last = this.base.firstChild.value.toLowerCase()
			}
		}
		q = null
	};
	this.conf.evs_nodes = [{
		node: document.body,
		evs: {
			mousedown: "_doOnBodyMouseDown"
		}
	}, {
		node: this.base,
		evs: {
			mousedown: "_doOnBaseMouseDown"
		}
	}, {
		node: this.base.firstChild,
		evs: {
			keyup: "_doOnInputKeyUp",
			keydown: "_doOnInputKeyDown",
			keypress: "_doOnInputKeyPress",
			focus: "_doOnInputFocus",
			blur: "_doOnInputBlur"
		}
	}, {
		node: this.list,
		evs: {
			mousemove: "_doOnListMouseMove",
			mousedown: "_doOnListMouseDown",
			mouseup: "_doOnListMouseUp",
			mouseout: "_doOnListMouseOut"
		}
	}];
	for (var c = 0; c < this.conf.evs_nodes.length; c++) {
		for (var s in this.conf.evs_nodes[c].evs) {
			if (typeof(window.addEventListener) == "function") {
				this.conf.evs_nodes[c].node.addEventListener(s, this[this.conf.evs_nodes[c].evs[s]], false)
			} else {
				this.conf.evs_nodes[c].node.attachEvent("on" + s, this[this.conf.evs_nodes[c].evs[s]])
			}
		}
	}
	this.unload = function() {
		this.clearAll();
		this.t = null;
		for (var x = 0; x < this.conf.evs_nodes.length; x++) {
			for (var w in this.conf.evs_nodes[x].evs) {
				if (typeof(window.addEventListener) == "function") {
					this.conf.evs_nodes[x].node.removeEventListener(w, this[this.conf.evs_nodes[x].evs[w]], false)
				} else {
					this.conf.evs_nodes[x].node.detachEvent("on" + w, this[this.conf.evs_nodes[x].evs[w]])
				}
				this.conf.evs_nodes[x].evs[w] = null;
				delete this.conf.evs_nodes[x].evs[w]
			}
			this.conf.evs_nodes[x].node = null;
			this.conf.evs_nodes[x].evs = null;
			delete this.conf.evs_nodes[x].node;
			delete this.conf.evs_nodes[x].evs;
			this.conf.evs_nodes[x] = null
		}
		window.dhx4._eventable(this, "clear");
		window.dhx4._enableDataLoading(this, null, null, null, "clear");
		this._mcDetachHeader();
		this.DOMelem_input = this.DOMelem_button = this.DOMlist = this.DOMelem = this.DOMParent = null;
		for (var w in this.conf) {
			this.conf[w] = null;
			delete this.conf[w]
		}
		this.conf = null;
		if (typeof(window.addEventListener) == "function") {
			this.list.removeEventListener("scroll", this._doOnListScroll, false)
		} else {
			this.list.detachEvent("onscroll", this._doOnListScroll)
		}
		this.base.parentNode.removeChild(this.base);
		this.list.parentNode.removeChild(this.list);
		this.base = this.list = this.cont = null;
		this.modes = null;
		for (var w in this) {
			if (typeof(this[w]) == "function") {
				this[w] = null
			}
		}
		o = null
	};
	this.DOMelem_input = this.base.firstChild;
	this.DOMelem_button = this.base.childNodes[this.base.childNodes.length - (this.conf.combo_image ? 2 : 1)];
	this.DOMlist = this.list;
	this.DOMelem = this.base;
	this.DOMParent = n;
	n = null;
	if (l != null) {
		if (l.filter != null) {
			if (typeof(l.filter) == "string") {
				this.enableFilteringMode(true, l.filter, window.dhx4.s2b(l.filter_cache), window.dhx4.s2b(l.filter_sub_load))
			} else {
				this.enableFilteringMode(true)
			}
		}
		if (l.image_path != null) {
			this.setImagePath(l.image_path)
		}
		if (l.default_image != null || l.default_image_dis != null) {
			this.setDefaultImage(l.default_image, l.default_image_dis)
		}
		if (l.items || l.options) {
			this.addOption(l.items || l.options)
		}
		if (l.xml || l.json) {
			this.load(l.xml || l.json)
		}
		if (typeof(l.readonly) != "undefined") {
			this.readonly(l.readonly)
		}
		l = null
	}
	return this
}

function dhtmlXComboFromSelect(g) {
	if (typeof(g) == "string") {
		g = document.getElementById(g)
	}
	var c = g.offsetWidth;
	var s = g.getAttribute("name") || null;
	var l = document.createElement("SPAN");
	g.parentNode.insertBefore(l, g);
	var n = g.getAttribute("mode") || g.getAttribute("opt_type") || "option";
	var m = new dhtmlXCombo(l, s, c, n);
	l = null;
	var q = g.getAttribute("imagePath");
	if (q) {
		m.setImagePath(q)
	}
	var r = g.getAttribute("defaultImage");
	var o = g.getAttribute("defaultImageDis");
	if (window.dhx4.s2b(o) == true) {
		o = true
	}
	if (r != null || o != null) {
		m.setDefaultImage(r, o)
	}
	var a = m._xmlToObj([g], true, g.selectedIndex);
	if (a.options.length > 0) {
		m.addOption(a.options)
	}
	a = null;
	g.parentNode.removeChild(g);
	g = null;
	return m
}
dhtmlXCombo.prototype.setName = function(a) {
	this.conf.form_name = a;
	this.base.childNodes[1].name = a;
	this.base.childNodes[2].name = a.replace(/(\[.*)?$/, "_new_value$1")
};
dhtmlXCombo.prototype.readonly = function(a) {
	if (window.dhx4.s2b(a)) {
		this.base.firstChild.setAttribute("readOnly", "true")
	} else {
		this.base.firstChild.removeAttribute("readOnly")
	}
};
dhtmlXCombo.prototype.setPlaceholder = function(a) {
	if (typeof(a) == "undefined" || a == null) {
		a = ""
	}
	this.base.firstChild.setAttribute("placeholder", String(a))
};
dhtmlXCombo.prototype.setTemplate = function(g) {
	for (var c in g) {
		if (typeof(this.conf.template[c]) != "undefined") {
			this.conf.template[c] = String(g[c])
		}
	}
	if (g.columns != null) {
		this._mcMakeTemplate(g.columns)
	} else {
		this._mcDetachHeader()
	}
	for (var c in this.t) {
		this.t[c].obj.setText(this.t[c].item, this.t[c].item._conf.text)
	}
	this._confirmSelect()
};
dhtmlXCombo.prototype.setSkin = function(a) {
	if (a == this.conf.skin) {
		return
	}
	this.conf.skin = a;
	this.base.className = "dhxcombo_" + this.conf.skin + (this.conf.enabled ? "" : " dhxcombo_disabled");
	this.list.className = "dhxcombolist_" + this.conf.skin + (this.hdr != null ? " dhxcombolist_multicolumn" : "");
	if (this.hdr != null) {
		this.hdr.className = "dhxcombolist_" + this.conf.skin + " dhxcombolist_hdr"
	}
};
dhtmlXCombo.prototype.getInput = function() {
	return this.base.firstChild
};
dhtmlXCombo.prototype.getButton = function() {
	return this.base.childNodes[this.base.childNodes.length - (this.conf.combo_image ? 2 : 1)]
};
dhtmlXCombo.prototype.getList = function() {
	return this.list
};
dhtmlXCombo.prototype.getBase = function() {
	return this.base
};
dhtmlXCombo.prototype.getParent = function() {
	return this.DOMParent
};
dhtmlXCombo.prototype.forEachOption = function(a) {
	for (var c = 0; c < this.list.childNodes.length; c++) {
		a.apply(window, [this._getOption(this.list.childNodes[c]._optId, c)])
	}
};
dhtmlXCombo.prototype.setFocus = function() {
	if (this.conf.enabled) {
		this.base.firstChild.focus()
	}
};
dhtmlXCombo.prototype.setFontSize = function(a, c) {
	if (a != null) {
		this.base.firstChild.style.fontSize = a
	}
	if (c != null) {
		this.list.style.fontSize = c
	}
};
dhtmlXCombo.prototype.getOption = function(m) {
	var n = null;
	var g = null;
	for (var l = 0; l < this.list.childNodes.length; l++) {
		if (n == null) {
			var c = this.list.childNodes[l]._optId;
			if (this.t[c].obj.getValue(this.t[c].item) == m) {
				n = c;
				g = l
			}
		}
	}
	return (n == null ? null : this._getOption(n, g))
};
dhtmlXCombo.prototype.getOptionByIndex = function(a) {
	if (a < 0) {
		return null
	}
	if (this.list.childNodes[a] == null) {
		return null
	}
	return this._getOption(this.list.childNodes[a]._optId, a)
};
dhtmlXCombo.prototype.getOptionByLabel = function(m) {
	var n = null;
	var g = null;
	for (var l = 0; l < this.list.childNodes.length; l++) {
		if (n == null) {
			var c = this.list.childNodes[l]._optId;
			if (this.t[c].obj.getText(this.t[c].item, true) == m) {
				n = c;
				g = l
			}
		}
	}
	return (n == null ? null : this._getOption(n, g))
};
dhtmlXCombo.prototype.getSelectedIndex = function() {
	return this._getOptionProp(this.conf.last_selected, "index", -1)
};
dhtmlXCombo.prototype.getSelectedText = function() {
	return this._getOptionProp(this.conf.last_selected, "text", "")
};
dhtmlXCombo.prototype.getSelectedValue = function() {
	return this._getOptionProp(this.conf.last_selected, "value", null)
};
dhtmlXCombo.prototype.getActualValue = function() {
	return this.base.childNodes[1].value
};
dhtmlXCombo.prototype.getComboText = function() {
	return this.base.childNodes[0].value
};
dhtmlXCombo.prototype.getIndexByValue = function(c) {
	var a = this.getOption(c);
	return (a != null ? a.index : -1)
};
dhtmlXCombo.prototype.setComboText = function(a) {
	if (this.conf.allow_free_text != true) {
		return
	}
	this.unSelectOption();
	this.conf.last_text = this.base.firstChild.value = a;
	this.conf.f_server_last = this.base.firstChild.value.toLowerCase()
};
dhtmlXCombo.prototype.setComboValue = function(c) {
	var a = this.getOption(c);
	if (a != null) {
		this.selectOption(a.index)
	} else {
		this.conf.last_value = c;
		this.base.childNodes[1].value = this.conf.last_value;
		this.base.childNodes[2].value = "true"
	}
};
dhtmlXCombo.prototype.selectOption = function(c, g, a) {
	if (c < 0 || c >= this.list.childNodes.length) {
		return
	}
	var l = this.list.childNodes[c]._optId;
	this._setSelected(l, this._isListVisible(), true);
	this._confirmSelect("script")
};
dhtmlXCombo.prototype.unSelectOption = function() {
	if (this.conf.last_hover != null) {
		this.t[this.conf.last_hover].obj.setSelected(this.t[this.conf.last_hover].item, false);
		this.conf.last_hover = null
	}
	this.base.firstChild.value = "";
	if (this.conf.f_mode != false) {
		this._filterOpts(true)
	}
	this._hideList();
	this._updateTopImage(null);
	this._confirmSelect("script")
};
dhtmlXCombo.prototype.confirmValue = function() {
	this._confirmSelect("script")
};
dhtmlXCombo.prototype.enable = function(a) {
	a = (typeof(a) == "undefined" ? true : window.dhx4.s2b(a));
	if (this.conf.enabled == a) {
		return
	}
	this.conf.enabled = a;
	if (a) {
		this.base.className = "dhxcombo_" + this.conf.skin;
		this.base.firstChild.removeAttribute("disabled")
	} else {
		this._hideList();
		this.base.className = "dhxcombo_" + this.conf.skin + " dhxcombo_disabled";
		this.base.firstChild.setAttribute("disabled", "true")
	}
	this._updateTopImage(this.conf.last_selected)
};
dhtmlXCombo.prototype.disable = function(a) {
	a = (typeof(a) == "undefined" ? true : window.dhx4.s2b(a));
	this.enable(!a)
};
dhtmlXCombo.prototype.isEnabled = function() {
	return (this.conf.enabled == true)
};
dhtmlXCombo.prototype.show = function(a) {
	if (typeof(a) == "undefined") {
		a = true
	} else {
		a = window.dhx4.s2b(a)
	}
	this.base.style.display = (a == true ? "" : "none")
};
dhtmlXCombo.prototype.hide = function(a) {
	if (typeof(a) == "undefined") {
		a = true
	}
	this.show(!a)
};
dhtmlXCombo.prototype.isVisible = function() {
	return (this.base.style.display == "")
};
dhtmlXCombo.prototype.setFilterHandler = function(a) {
	if (typeof(a) == "function") {
		this.conf.f_func = a;
		this.conf.f_mode = true;
		this.conf.f_dyn = this.conf.f_cache = this.conf.f_url = null
	} else {
		if (typeof(a) == "string" && typeof(window[a]) == "function") {
			this.conf.f_func = window[a];
			this.conf.f_mode = true;
			this.conf.f_dyn = this.conf.f_cache = this.conf.f_url = null
		} else {
			this.conf.f_func = null
		}
	}
};
dhtmlXCombo.prototype.enableFilteringMode = function(l, c, a, g) {
	if (l == true || l == "between") {
		this.conf.f_mode = (l == true ? "start" : "between");
		if (c != null) {
			this.conf.f_url = c;
			this.conf.f_cache = window.dhx4.s2b(a);
			this.conf.f_dyn = window.dhx4.s2b(g)
		} else {
			this.conf.f_url = null;
			this.conf.f_cache = false;
			this.conf.f_dyn = false
		}
	} else {
		this.conf.f_mode = false;
		this.conf.f_url = null;
		this.conf.f_cache = false;
		this.conf.f_dyn = false
	}
};
dhtmlXCombo.prototype.filter = function(g, a) {
	for (var l = 0; l < this.list.childNodes.length; l++) {
		var c = g.apply(window, [this._getOption(this.list.childNodes[l]._optId, l)]);
		this.list.childNodes[l].style.display = (c === true ? "" : "none")
	}
	if (typeof(a) == "undefined" || a == true) {
		this._showList(true)
	}
};
dhtmlXCombo.prototype.sort = function(g) {
	var a = [];
	for (var c = 0; c < this.list.childNodes.length; c++) {
		var l = this.list.childNodes[c]._optId;
		a.push([l, this._getOption(l, c)])
	}
	if (g == "asc" || g == "desc") {
		k = true;
		a.sort(function(n, m) {
			n = n[1].text_option.toLowerCase();
			m = m[1].text_option.toLowerCase();
			var o = (g == "asc" ? 1 : -1);
			return (n > m ? o : -1 * o)
		})
	} else {
		if (typeof(g) == "function" || typeof(window[g]) == "function") {
			if (typeof(window[g]) == "function") {
				g = window[g]
			}
			a.sort(function(n, m) {
				return g.apply(window, [n[1], m[1]])
			})
		}
	}
	while (this.list.childNodes.length > 0) {
		this.list.removeChild(this.list.lastChild)
	}
	for (var c = 0; c < a.length; c++) {
		this.list.appendChild(this.t[a[c][0]].item)
	}
};
dhtmlXCombo.prototype.enableAutocomplete = function(a) {
	if (typeof(a) == "undefined") {
		a = true
	} else {
		a = window.dhx4.s2b(a)
	}
	this.conf.f_ac = a
};
dhtmlXCombo.prototype.disableAutocomplete = function(a) {
	if (typeof(a) == "undefined") {
		a = true
	} else {
		a = window.dhx4.s2b(a)
	}
	this.enableAutocomplete(!a)
};
dhtmlXCombo.prototype.allowFreeText = function(a) {
	this.conf.allow_free_text = (typeof(a) == "undefined" ? true : window.dhx4.s2b(a))
};
dhtmlXCombo.prototype._checkForMatch = function(l) {
	var a = window.dhx4.trim(this.base.firstChild.value).toLowerCase();
	var m = null;
	var c = this.list.firstChild;
	while (c != null) {
		if (c.style.display == "" && c._optId != null) {
			var g = window.dhx4.trim(this.t[c._optId].obj.getText(c, true)).toLowerCase();
			if (a == g) {
				m = c._optId;
				c = null
			}
		}
		if (c != null) {
			c = c.nextSibling
		}
	}
	if (this.conf.last_match == null) {
		if (m != null) {
			this._setSelected(m, true, true);
			this.conf.last_match = m
		} else {
			if (this.conf.f_mode != "between" || l == true) {
				this._setSelected(null, true, true);
				this.conf.last_match = null
			}
		}
	} else {
		if (m != null) {
			if (m != this.conf.last_match) {
				this._setSelected(m, true, true);
				this.conf.last_match = m
			}
		} else {
			this._setSelected(null, true, true);
			this.conf.last_match = null
		}
	}
};
dhtmlXCombo.prototype._selectRange = function(c, a) {
	if (this.conf.combo_focus == true) {
		window.dhx4.selectTextRange(this.base.firstChild, c, a)
	}
};
dhtmlXCombo.prototype.openSelect = function() {
	if (!this._isListVisible()) {
		this._showList()
	}
};
dhtmlXCombo.prototype.closeAll = function() {
	this._hideList()
};
dhtmlXCombo.prototype._showList = function(a) {
	if (this._getListVisibleCount() == 0) {
		if (a && this._isListVisible()) {
			this._hideList()
		}
		return
	}
	if (this._isListVisible()) {
		this._checkListHeight();
		return
	}
	this.list.style.zIndex = window.dhx4.zim.reserve(this.conf.list_zi_id);
	if (this.hdr != null) {
		this.hdr.style.zIndex = Number(this.list.style.zIndex) + 1
	}
	this.list.style.visibility = "hidden";
	this.list.style.display = "";
	if (this.hdr != null) {
		this.hdr.style.visibility = this.list.style.visibility;
		this.hdr.style.display = this.list.style.display
	}
	var c = (this.hdr != null ? this.hdr.offsetHeight : 0);
	this.list.style.width = Math.max(this.conf.opts_width || this.conf.col_w || 0, this.conf.combo_width) + "px";
	this.list.style.top = window.dhx4.absTop(this.base) + c + this.base.offsetHeight - 1 + "px";
	this.list.style.left = window.dhx4.absLeft(this.base) + "px";
	if (this.hdr != null) {
		this.hdr.style.width = this.list.style.width;
		this.hdr.style.left = this.list.style.left;
		this.hdr.style.top = parseInt(this.list.style.top) - c + "px"
	}
	this._checkListHeight();
	this.list.style.visibility = "visible";
	if (this.hdr != null) {
		this.hdr.style.visibility = "visible"
	}
	this.callEvent("onOpen", [])
};
dhtmlXCombo.prototype._hideList = function() {
	if (!this._isListVisible()) {
		return
	}
	window.dhx4.zim.clear(this.conf.list_zi_id);
	this.list.style.display = "none";
	if (this.hdr != null) {
		this.hdr.style.display = "none"
	}
	this.conf.clear_click = false;
	this.callEvent("onClose", [])
};
dhtmlXCombo.prototype._isListVisible = function() {
	return (this.list.style.display == "")
};
dhtmlXCombo.prototype._getListVisibleCount = function() {
	var a = 0;
	for (var c = 0; c < this.list.childNodes.length; c++) {
		a += (this.list.childNodes[c].style.display == "" ? 1 : 0)
	}
	return a
};
dhtmlXCombo.prototype._checkListHeight = function() {
	if (!this._isListVisible()) {
		return
	}
	if (this.conf.item_h == null) {
		var r = this.list.firstChild;
		while (r != null) {
			if (r.style.display == "") {
				this.conf.item_h = r.offsetHeight + (this.hdr != null ? -1 : 0);
				r = null
			} else {
				r = r.nextSibling
			}
		}
		r = null
	}
	var u = window.dhx4.screenDim();
	var n = window.dhx4.absTop(this.base);
	var c = this.base.offsetHeight;
	var a = (this.hdr != null ? this.hdr.offsetHeight : 0);
	var g = Math.max(0, Math.floor((n + a - u.top) / this.conf.item_h));
	var q = Math.max(0, Math.floor((u.bottom - (n + c + a)) / this.conf.item_h));
	var v = this._getListVisibleCount();
	if (q < Math.min(this.conf.opts_count_min, v) && g > q) {
		q = null
	}
	var o = Math.min((q == null ? g : q), this.conf.opts_count, v);
	var l = (o < v ? (o * this.conf.item_h) + "px" : "");
	var m = this.conf.sp[this.conf.skin][this.hdr != null ? "hdr_ofs" : "list_ofs"];
	this.list.style.height = l;
	this.list.style.top = (q == null ? n - this.list.offsetHeight + m : n + c + a - m) + "px";
	if (this.hdr != null) {
		this.hdr.style.top = (q == null ? n - a - this.list.offsetHeight + m : n + c - m) + "px"
	}
};
dhtmlXCombo.prototype._scrollToItem = function(m) {
	var l = this.t[m].item.offsetTop;
	var g = l + this.t[m].item.offsetHeight;
	var c = this.list.scrollTop;
	var a = c + this.list.clientHeight;
	if (l < c) {
		this.list.scrollTop = l + (this.hdr != null ? 1 : 0)
	} else {
		if (g > a) {
			this.list.scrollTop = g - this.list.clientHeight + (this.hdr != null ? -this.conf.sp[this.conf.skin].scr_ofs : 0)
		}
	}
};
dhtmlXCombo.prototype._setSelected = function(g, c, a) {
	if (a) {
		this._updateTopImage(g)
	}
	if (g != null && this.conf.last_hover == g) {
		if (c) {
			this._scrollToItem(g)
		}
		return
	}
	if (this.conf.last_hover != null) {
		this.t[this.conf.last_hover].obj.setSelected(this.t[this.conf.last_hover].item, false);
		this.conf.last_hover = null;
		if (g == null) {
			this.callEvent("onSelectionChange", [])
		}
	}
	if (g != null) {
		this.t[g].obj.setSelected(this.t[g].item, true);
		this.conf.last_hover = g;
		this.callEvent("onSelectionChange", []);
		if (this.conf.s_mode == "select" && this.t[g].item == this.t[g].item.parentNode.lastChild) {
			this._subloadRequest()
		}
		if (c) {
			this._scrollToItem(g)
		}
	}
};
dhtmlXCombo.prototype._subloadRequest = function() {
	if (this.conf.f_url != null && this.conf.f_dyn == true && this.conf.f_dyn_end == false) {
		var g = "mask=" + encodeURIComponent(this.conf.f_mask) + "&pos=" + this.list.childNodes.length;
		var a = this;
		var c = function(m) {
			if (a.conf.f_cache) {
				a.conf.f_cache_data[a.conf.f_mask].data.push(m.xmlDoc.responseXML)
			}
			var l = a.list.childNodes.length;
			a.conf.f_loading = true;
			a.load(m.xmlDoc.responseXML);
			a.conf.f_loading = false;
			if (l == a.list.childNodes.length) {
				a.conf.f_dyn_end = true;
				if (a.conf.f_cache) {
					a.conf.f_cache_data[a.conf.f_mask].dyn_end = true
				}
			}
			c = a = null
		};
		if (window.dhx4.ajax.method == "post") {
			window.dhx4.ajax.post(this.conf.f_url, g, c)
		} else {
			if (window.dhx4.ajax.method == "get") {
				window.dhx4.ajax.get(this.conf.f_url + (String(this.conf.f_url).indexOf("?") >= 0 ? "&" : "?") + g, c)
			}
		}
	}
};
dhtmlXCombo.prototype.addOption = function(n, o, c, a, l) {
	var g = null;
	if (!(n instanceof Array)) {
		var r = this._renderOption({
			value: n,
			text: o,
			css: c,
			img: a
		});
		if (g == null && window.dhx4.s2b(l) == true) {
			g = r
		}
	} else {
		for (var m = 0; m < n.length; m++) {
			if (typeof(n[m]) == "undefined") {
				continue
			}
			if (n[m] instanceof Array) {
				r = this._renderOption({
					value: n[m][0],
					text: n[m][1],
					css: n[m][2],
					img: n[m][3]
				});
				if (g == null && window.dhx4.s2b(n[m][4]) == true) {
					g = r
				}
			} else {
				var r = this._renderOption(n[m]);
				if (g == null && window.dhx4.s2b(n[m].selected) == true) {
					g = r
				}
			}
		}
	}
	if (g != null) {
		this._setSelected(g, this._isListVisible(), true);
		this._confirmSelect("onInit")
	}
};
dhtmlXCombo.prototype.updateOption = function(a, g, c, l) {
	var m = this._getOptionId(a);
	if (m == null) {
		return
	}
	this.t[m].obj.update(this.t[m].item, {
		value: g,
		text: c,
		css: l
	});
	if (this.conf.last_selected == m) {
		this.conf.last_text = this.base.firstChild.value = this.t[m].obj.getText(this.t[m].item, true);
		this.conf.f_server_last = this.base.firstChild.value.toLowerCase()
	}
};
dhtmlXCombo.prototype.deleteOption = function(l) {
	for (var c in this.t) {
		var g = this.t[c].obj.getValue(this.t[c].item);
		if (g == l) {
			this._removeOption(c)
		}
	}
	if (this._isListVisible()) {
		this._showList(true)
	}
};
dhtmlXCombo.prototype.clearAll = function(c) {
	c = (typeof(c) == "undefined" ? true : window.dhx4.s2b(c));
	for (var g in this.t) {
		this._removeOption(g)
	}
	if (this.conf.tm_hover) {
		window.clearTimeout(this.conf.tm_hover)
	}
	this.conf.last_hover = null;
	this.conf.last_selected = null;
	this.list.scrollTop = 0;
	if (c == true) {
		this._hideList()
	}
};
dhtmlXCombo.prototype._renderOption = function(l) {
	var m = window.dhx4.newId();
	var g = document.createElement("DIV");
	g._optId = m;
	g._tpl = this.conf.template;
	if (typeof(l.img) == "undefined" && typeof(l.img_src) != "undefined") {
		l.img = l.img_src;
		delete l.img_src
	}
	if (typeof(l.img_dis) == "undefined" && typeof(l.img_src_dis) != "undefined") {
		l.img_dis = l.img_src_dis;
		delete l.img_src_dis
	}
	l.img_path = this.conf.img_path;
	l.img_def = this.conf.img_def;
	l.img_def_dis = this.conf.img_def_dis;
	this.list.appendChild(g);
	var c = (this._isListVisible() && window.dhx4.isFF == true);
	if (c == true) {
		var a = this.list.scrollTop;
		this.list.scrollTop -= 1
	}
	if (this.hdr != null) {
		l.multicol = true
	}
	this.t[g._optId] = {
		obj: this.modes[this.conf.opts_type].render(g, l),
		item: g,
		conf: {
			type: this.conf.opts_type
		}
	};
	g = null;
	if (c == true) {
		this.list.scrollTop += 1
	}
	return m
};
dhtmlXCombo.prototype._removeOption = function(a) {
	this.t[a].obj.destruct(this.t[a].item);
	this.t[a].obj = null;
	this.t[a].item.parentNode.removeChild(this.t[a].item);
	this.t[a].item = null;
	this.t[a].conf = null;
	this.t[a] = null;
	delete this.t[a];
	if (this.conf.last_hover == a) {
		this.conf.last_hover = null
	}
	if (this.conf.last_selected == a) {
		this.conf.last_selected = null;
		this._confirmSelect("onDelete")
	}
};
dhtmlXCombo.prototype._confirmSelect = function(c) {
	var a = false;
	if (this.conf.f_server_tm) {
		window.clearTimeout(this.conf.f_server_tm)
	}
	if (this.conf.last_hover != null) {
		a = a || (this.conf.last_value != this._getOptionValue(this.conf.last_hover));
		this.conf.last_match = this.conf.last_selected = this.conf.last_hover;
		this.conf.last_value = this._getOptionValue(this.conf.last_selected);
		this.conf.last_text = this.base.firstChild.value = this.t[this.conf.last_selected].obj.getText(this.t[this.conf.last_selected].item, true);
		this.conf.f_server_last = this.base.firstChild.value.toLowerCase();
		this.base.childNodes[1].value = this.conf.last_value;
		this.base.childNodes[2].value = "false"
	} else {
		if (this.conf.allow_free_text || (this.base.firstChild.value == "" && this.conf.allow_empty_value)) {
			a = a || (this.conf.last_text != this.base.firstChild.value);
			this.conf.last_match = this.conf.last_value = this.conf.last_selected = null;
			this.conf.last_text = this.base.firstChild.value;
			this.conf.f_server_last = this.base.firstChild.value.toLowerCase();
			this.base.childNodes[1].value = this.conf.last_text;
			this.base.childNodes[2].value = "true"
		} else {
			this._cancelSelect();
			this._updateTopImage(this.conf.last_selected);
			return
		}
	}
	if (this.conf.f_ac && this.conf.f_mode == "start") {
		this.conf.f_ac_text = "";
		if (c != "blur") {
			this._selectRange(this.base.firstChild.value.length, this.base.firstChild.value.length)
		}
	}
	this._hideList();
	if (a == true && c != "onInit" && c != "onDelete") {
		this.callEvent("onChange", [this.conf.last_value, this.conf.last_text])
	}
};
dhtmlXCombo.prototype._cancelSelect = function() {
	this._hideList();
	this.base.firstChild.value = this.conf.last_text;
	if (this.conf.f_mode != false) {
		this._filterOpts(true)
	}
};
dhtmlXCombo.prototype._getOption = function(o, l) {
	if (!this.t[o]) {
		return null
	}
	if (typeof(l) == "undefined") {
		l = -1
	}
	if (l < 0) {
		for (var n = 0; n < this.list.childNodes.length; n++) {
			if (l < 0 && this.list.childNodes[n]._optId == o) {
				l = n
			}
		}
	}
	var m = {
		value: this.t[o].obj.getValue(this.t[o].item),
		text: this.t[o].obj.getText(this.t[o].item),
		text_input: this.t[o].obj.getText(this.t[o].item, true),
		text_option: this.t[o].obj.getText(this.t[o].item, null, true),
		css: this.t[o].obj.getCss(this.t[o].item),
		selected: (o == this.conf.last_selected),
		index: l
	};
	if (typeof(this.t[o].obj.getExtraData) == "function") {
		var g = this.t[o].obj.getExtraData(this.t[o].item);
		for (var c in g) {
			if (typeof(m[c]) == "undefined") {
				m[c] = g[c]
			}
		}
	}
	return m
};
dhtmlXCombo.prototype._getOptionProp = function(l, g, c) {
	if (l != null) {
		var a = this._getOption(l);
		if (a != null) {
			return a[g]
		}
	}
	return c
};
dhtmlXCombo.prototype._getOptionId = function(c) {
	var l = null;
	for (var a = 0; a < this.list.childNodes.length; a++) {
		if (l == null) {
			var g = this.list.childNodes[a]._optId;
			if (c == this.t[g].obj.getValue(this.t[g].item)) {
				l = g
			}
		}
	}
	return l
};
dhtmlXCombo.prototype._getOptionValue = function(a) {
	return this._getOptionProp(a, "value", null)
};
dhtmlXCombo.prototype.setSize = function(a) {
	this.conf.combo_width = parseInt(a) - (dhx4.isFF || dhx4.isIE || dhx4.isChrome || dhx4.isOpera ? 2 : 0);
	this.base.style.width = Math.max(0, this.conf.combo_width) + "px";
	this._adjustBase()
};
dhtmlXCombo.prototype._adjustBase = function() {
	this.base.firstChild.style.width = Math.max(0, (this.conf.combo_width - 24 - (this.conf.combo_image ? 23 : 0))) + "px";
	this.base.firstChild.style.marginLeft = (this.conf.combo_image ? "23px" : "0px")
};
dhtmlXCombo.prototype.setOptionWidth = function(a) {
	this.conf.opts_width = (parseInt(a) || null)
};
dhtmlXCombo.prototype.setOptionIndex = function(g, a) {
	if (isNaN(a) || a < 0) {
		return
	}
	var l = this.getOption(g);
	if (l == null) {
		return
	}
	if (a == l.index) {
		return
	}
	var c = this.list.childNodes[l.index];
	c.parentNode.removeChild(c);
	if (this.list.childNodes[a] != null) {
		this.list.insertBefore(c, this.list.childNodes[a])
	} else {
		this.list.appendChild(c)
	}
	c = null
};
dhtmlXCombo.prototype.getOptionsCount = function() {
	return this.list.childNodes.length
};
dhtmlXCombo.prototype._mcMakeTemplate = function(r) {
	var m = "";
	var l = "";
	this.conf.col_w = 0;
	for (var n = 0; n < r.length; n++) {
		var a = Number(parseInt(r[n].width) || 50);
		var g = (r[n].css || "");
		var o = (n == 0 && window.dhx4.isIE6 == true ? "_first" : "");
		l += "<div class='dhxcombo_cell" + o + " " + g + "' style='width:" + a + "px;'><div class='dhxcombo_cell_text'>" + (r[n].option || "&nbsp;") + "</div></div>";
		m += "<div class='dhxcombo_hdrcell" + o + " " + g + "' style='width:" + a + "px;'><div class='dhxcombo_hdrcell_text'>" + (r[n].header || "&nbsp;") + "</div></div>";
		this.conf.col_w += a + 1
	}
	var a = 500;
	var c = document.createElement("DIV");
	c.style.position = "absolute";
	c.style.top = "10px";
	c.style.left = -a * 2 + "px";
	c.style.width = a + "px";
	c.style.height = "50px";
	c.style.overflowY = "scroll";
	c.innerHTML = "<div>&nbsp;</div>";
	document.body.appendChild(c);
	this.conf.col_w += a - c.firstChild.offsetWidth + 10;
	c.parentNode.removeChild(c);
	c = null;
	this.conf.template.option = l;
	this._mcAttachHeader(m);
	this.list.className += " dhxcombolist_multicolumn"
};
dhtmlXCombo.prototype._mcAttachHeader = function(a) {
	if (this.hdr == null) {
		this.hdr = document.createElement("DIV");
		this.hdr.className = "dhxcombolist_" + this.conf.skin + " dhxcombolist_hdr";
		this.hdr.style.display = "none";
		this.list.parentNode.insertBefore(this.hdr, this.list);
		if (typeof(window.addEventListener) == "function") {
			this.hdr.addEventListener("mousedown", this._doOnListMouseDown, false)
		} else {
			this.hdr.attachEvent("onmousedown", this._doOnListMouseDown)
		}
		if (this.conf.opts_type == "checkbox" && this.conf.combo_image == true) {
			this.conf.combo_image = false;
			if (this.base.lastChild.className.match(/dhxcombo_top_image/) != null) {
				this.base.removeChild(this.base.lastChild)
			}
			this._adjustBase()
		}
	}
	this.hdr.innerHTML = "<div class='dhxcombo_hdrtext'>" + a + "</div>"
};
dhtmlXCombo.prototype._mcDetachHeader = function() {
	if (this.hdr != null) {
		if (typeof(window.addEventListener) == "function") {
			this.hdr.removeEventListener("mousedown", this._doOnListMouseDown, false)
		} else {
			this.hdr.detachEvent("onmousedown", this._doOnListMouseDown)
		}
		this.hdr.parentNode.removeChild(this.hdr);
		this.hdr = null
	}
	this.conf.col_w = null;
	this.conf.item_h = null
};
dhtmlXCombo.prototype.modes = {};
dhtmlXCombo.prototype.doWithItem = function(a, o, m, g) {
	var n = (a >= 0 && a < this.list.childNodes.length ? this.list.childNodes[a]._optId : null);
	if (n == null) {
		return null
	}
	if (typeof(this.t[n].obj[o]) != "function") {
		return null
	}
	var l = [this.t[n].item];
	for (var c = 2; c < arguments.length; c++) {
		l.push(arguments[c])
	}
	return this.t[n].obj[o].apply(this.t[n].obj, l)
};

function dhtmlXComboExtend(l, g) {
	for (var c in dhtmlXCombo.prototype.modes[g]) {
		if (typeof(dhtmlXCombo.prototype.modes[l][c]) == "undefined") {
			dhtmlXCombo.prototype.modes[l][c] = dhtmlXCombo.prototype.modes[g][c]
		}
	}
}
dhtmlXCombo.prototype.modes.option = {
	image: false,
	option_css: "dhxcombo_option_text",
	render: function(a, c) {
		a._conf = {
			value: c.value,
			css: ""
		};
		a.className = "dhxcombo_option";
		a.innerHTML = "<div class='" + this.option_css + "'>&nbsp;</div>";
		if (c.css != null) {
			a.lastChild.style.cssText = c.css;
			a._conf.css = c.css
		}
		this.setText(a, c.text);
		return this
	},
	destruct: function(a) {
		a._conf = null
	},
	update: function(a, c) {
		a._conf.value = c.value;
		a._conf.css = c.css;
		a.lastChild.style.cssText = c.css;
		this.setText(a, c.text)
	},
	setText: function(c, g) {
		c._conf.text = g;
		var a = (typeof(g) == "object" ? window.dhx4.template(c._tpl.option, c._conf.text, true) : window.dhx4.trim(c._conf.text || ""));
		c.lastChild.innerHTML = (a.length == 0 ? "&nbsp;" : a)
	},
	getText: function(g, a, c) {
		if (window.dhx4.s2b(a) && typeof(g._conf.text) == "object") {
			return window.dhx4.template(g._tpl.input, g._conf.text, true)
		}
		if (window.dhx4.s2b(c) && typeof(g._conf.text) == "object") {
			return window.dhx4.template(g._tpl.option, g._conf.text, true)
		}
		return g._conf.text
	},
	getValue: function(a) {
		return a._conf.value
	},
	getCss: function(a) {
		return a._conf.css
	},
	setSelected: function(a, c) {
		a.className = "dhxcombo_option" + (c ? " dhxcombo_option_selected" : "")
	},
	isSelected: function(a) {
		return String(a.className).indexOf("dhxcombo_option_selected") >= 0
	},
	getExtraData: function(a) {
		return {
			type: "option"
		}
	}
};
dhtmlXCombo.prototype.modes.checkbox = {
	image: true,
	image_css: "dhxcombo_checkbox dhxcombo_chbx_#state#",
	option_css: "dhxcombo_option_text dhxcombo_option_text_chbx",
	render: function(a, c) {
		if (this.image_css_regexp == null) {
			this.image_css_regexp = new RegExp(this.image_css.replace("#state#", "\\d*"))
		}
		a._conf = {
			value: c.value,
			css: "",
			checked: window.dhx4.s2b(c.checked)
		};
		a.className = "dhxcombo_option";
		if (c.multicol == true) {
			c.text.checkbox = "<div class='" + String(this.image_css).replace("#state#", (a._conf.checked ? "1" : "0")) + "'></div>&nbsp;";
			a.innerHTML = "<div class='" + dhtmlXCombo.prototype.modes.option.option_css + "'></div>"
		} else {
			a.innerHTML = "<div class='" + String(this.image_css).replace("#state#", (a._conf.checked ? "1" : "0")) + "'></div><div class='" + this.option_css + "'>&nbsp;</div>"
		}
		if (c.css != null) {
			a.lastChild.style.cssText += c.css;
			a._conf.css = c.css
		}
		this.setText(a, c.text);
		return this
	},
	setChecked: function(c, g) {
		c._conf.checked = window.dhx4.s2b(g);
		var a = String(this.image_css).replace("#state#", (c._conf.checked ? "1" : "0"));
		this._changeChbxCss(c.childNodes, a)
	},
	_changeChbxCss: function(a, c) {
		for (var g = 0; g < a.length; g++) {
			if (a[g].tagName != null && a[g].className != null && a[g].className.match(this.image_css_regexp) != null) {
				a[g].className = c
			} else {
				if (a[g].childNodes.length > 0) {
					this._changeChbxCss(a[g].childNodes, c)
				}
			}
		}
	},
	isChecked: function(a) {
		return (a._conf.checked == true)
	},
	getExtraData: function(a) {
		return {
			type: "checkbox",
			checked: a._conf.checked
		}
	},
	optionClick: function(l, g, m) {
		var c = true;
		var a = (g.target || g.srcElement);
		while (c == true && a != null && a != l && a.className != null) {
			if (a.className.match(this.image_css_regexp) != null) {
				if (m.callEvent("onCheck", [l._conf.value, !l._conf.checked]) === true) {
					this.setChecked(l, !this.isChecked(l))
				}
				c = false
			} else {
				a = a.parentNode
			}
		}
		a = m = l = null;
		return c
	},
	getTopImage: function(c, a) {
		return ""
	},
	topImageClick: function(a, c) {
		return true
	}
};
dhtmlXComboExtend("checkbox", "option");
dhtmlXCombo.prototype.setChecked = function(a, c) {
	this.doWithItem(a, "setChecked", c)
};
dhtmlXCombo.prototype.getChecked = function(a) {
	var c = [];
	for (var g = 0; g < this.list.childNodes.length; g++) {
		if (this.isChecked(g)) {
			c.push(this._getOptionProp(this.list.childNodes[g]._optId, "value", ""))
		}
	}
	return c
};
dhtmlXCombo.prototype.isChecked = function(a) {
	return this.doWithItem(a, "isChecked")
};
dhtmlXCombo.prototype.modes.image = {
	image: true,
	image_css: "dhxcombo_image",
	option_css: "dhxcombo_option_text dhxcombo_option_text_image",
	render: function(a, c) {
		a._conf = {
			value: c.value,
			css: ""
		};
		a.className = "dhxcombo_option";
		a.innerHTML = "<div class='" + this.image_css + "'></div><div class='" + this.option_css + "'>&nbsp;</div>";
		if (c.css != null) {
			a.lastChild.style.cssText += c.css;
			a._conf.css = c.css
		}
		this.setText(a, c.text);
		this.setImage(a, c.img, c.img_dis, c.img_path, c.img_def, c.img_def_dis);
		return this
	},
	update: function(a, c) {
		a._conf.value = c.value;
		a._conf.css = c.css;
		a.lastChild.style.cssText = c.css;
		this.setText(a, c.text);
		this.setImage(a, c.img, c.img_dis, c.img_path, c.img_def, c.img_def_dis)
	},
	setImage: function(g, a, m, n, l, c) {
		if (a != null && a.length > 0) {
			a = n + a
		} else {
			if (l != null && l.length > 0) {
				a = n + l
			} else {
				a = null
			}
		}
		if (m != null && m.length > 0) {
			m = n + m
		} else {
			if (c != null && c.length > 0) {
				m = n + c
			} else {
				if (c == true) {
					m = a
				} else {
					m = null
				}
			}
		}
		g._conf.img = a;
		g._conf.img_dis = m;
		g.firstChild.style.backgroundImage = (a != null ? "url(" + a + ")" : "none")
	},
	getExtraData: function(a) {
		return {
			type: "image"
		}
	},
	getTopImage: function(l, g) {
		var c = (g ? "img" : "img_dis");
		if (l != null && l._conf[c] != null) {
			return "<div class='" + this.image_css + "' style='background-image:url(" + l._conf[c] + ");'></div>"
		}
		return ""
	}
};
dhtmlXComboExtend("image", "option");
dhtmlXCombo.prototype.setDefaultImage = function(a, c) {
	if (a != null) {
		this.conf.img_def = a
	}
	if (c != null) {
		this.conf.img_def_dis = c
	}
};
dhtmlXCombo.prototype.setImagePath = function(a) {
	this.conf.img_path = a
};

function dhtmlXColorPicker(q) {
	if (!(this instanceof dhtmlXColorPicker)) {
		return new dhtmlXColorPicker(q)
	}
	dhx4._eventable(this);
	var n = this,
		m = undefined,
		o = null,
		g, a, c;
	this._nodes = [];
	this.activeNode = null;
	this._inputListenerId = null;
	this.base = null;
	this._globalNode = null;
	this.memory = null;
	this.skin = null;
	this.conf = {
		cp_id: dhx4.newId(),
		x: 0,
		y: 0,
		c: 0,
		indent: 2,
		position: "right",
		customColors: false,
		selectedColor: null,
		hide: false,
		hideOnSelect: false,
		lang: "en",
		closeable: true
	};
	this.value = {
		red: -1,
		blue: -1,
		green: -1,
		hue: -1,
		sat: -1,
		lum: -1
	};
	this._initMoveSelection = function(l) {
		l = l || event;
		if (typeof(window.addEventListener) == "function") {
			n._controllerNodes.colorArea.addEventListener("mousemove", n._setMoveSelection, false);
			document.body.addEventListener("mouseup", n._cleanMoveSelection, false)
		} else {
			n._controllerNodes.colorArea.attachEvent("onmousemove", n._setMoveSelection);
			document.body.attachEvent("onmouseup", n._cleanMoveSelection)
		}
		n._setMoveSelection(l, n._controllerNodes.colorArea);
		return false
	};
	this._cleanMoveSelection = function() {
		if (typeof(window.removeEventListener) == "function") {
			n._controllerNodes.colorArea.removeEventListener("mousemove", n._setMoveSelection, false);
			document.body.removeEventListener("mouseup", n._cleanMoveSelection, false)
		} else {
			n._controllerNodes.colorArea.detachEvent("onmousemove", n._setMoveSelection);
			document.body.detachEvent("onmouseup", n._cleanMoveSelection)
		}
		return false
	};
	this._setMoveSelection = function(l) {
		l = l || event;
		var r = n._getOffsetPosition(l, n._controllerNodes.colorArea);
		if (n._controllerNodes.fr_cover) {
			setTimeout(function() {
				n._setColorAreaXY(r.x, r.y);
				n._setColorByXYC()
			}, 0)
		} else {
			n._setColorAreaXY(r.x, r.y);
			n._setColorByXYC()
		}
		return false
	};
	this._initMoveContrast = function(l) {
		l = l || event;
		if (typeof(window.addEventListener) == "function") {
			document.body.addEventListener("mousemove", n._setMoveContrast, false);
			document.body.addEventListener("mouseup", n._cleanMoveContrast, false)
		} else {
			document.body.attachEvent("onmousemove", n._setMoveContrast);
			document.body.attachEvent("onmouseup", n._cleanMoveContrast)
		}
		n._setMoveContrast(l, n._controllerNodes.contrastArea)
	};
	this._cleanMoveContrast = function() {
		if (typeof(window.removeEventListener) == "function") {
			document.body.removeEventListener("mousemove", n._setMoveContrast, false);
			document.body.removeEventListener("mouseup", n._cleanMoveContrast, false)
		} else {
			document.body.detachEvent("onmousemove", n._setMoveContrast);
			document.body.detachEvent("onmouseup", n._cleanMoveContrast)
		}
	};
	this._setMoveContrast = function(l) {
		l = l || event;
		var r = n._getOffsetPosition(l, n._controllerNodes.contrastArea);
		n._setContrastY(r.y);
		n._setColorByXYC(true)
	};
	this._doOnSelectColor = function() {
		var l = n.colorAIP.rgb2hex({
			r: n.value.red,
			g: n.value.green,
			b: n.value.blue
		});
		if (n.activeNode != null) {
			if (n.activeNode.valueCont) {
				n.activeNode.valueCont.value = l
			}
			if (n.activeNode.valueColor) {
				n.activeNode.valueColor.style.backgroundColor = l
			}
		}
		if (n.base._dhx_remove || n.conf.hideOnSelect) {
			n.hide()
		}
		n.callEvent("onSelect", [l, ((n.activeNode) ? n.activeNode.node : null)])
	};
	this._doOnCancel = function() {
		if (n.callEvent("onCancel", [((n.activeNode) ? n.activeNode.node : null)]) == true && n.conf.closeable == true) {
			n.hide()
		}
	};
	this._doOnFocusByInput = function() {
		var r = (this != window) ? this : event.srcElement;
		var l = (n.activeNode && n.activeNode.valueCont && n.activeNode.valueCont == r) ? n.activeNode : n._getNodeByValueCont(r);
		n.activeNode = l;
		if (l && l == n.activeNode) {
			n._initListenerInput()
		}
	};
	this._doOnBlurByInput = function() {
		var r = (this != window) ? this : event.srcElement;
		var l = (n.activeNode && n.activeNode.valueCont && n.activeNode.valueCont == r) ? n.activeNode : n._getNodeByValueCont(r);
		if (l && l == n.activeNode) {
			n._removeListenerInput()
		}
	};
	this._doOnClickByNode = function(r) {
		r = r || event;
		var l = (this != window) ? this : event.srcElement;
		n.activeNode = (n.activeNode.node != l) ? n._getNodeByElement(l) : n.activeNode;
		if (!n.isVisible()) {
			n.show()
		}
	};
	this.saveColor = function() {
		n.memory.setValue(n.value)
	};
	this._onSelectMemoryEl = function(r) {
		var l;
		n._refreshCoordinatesByHSL(r.value.hue, r.value.sat, r.value.lum);
		for (l in r.value) {
			n.value[l] = r.value[l]
		}
		n._refreshContrast();
		n._refreshInputValues();
		n._refreshColorValue()
	};
	this._doOnClickByBody = function(s) {
		s = s || event;
		var l = true,
			r = s.target || s.srcElement;
		if (n._isBaseNode(r)) {
			l = false
		}
		if (l && n.activeNode && (n.activeNode.node == r || n.activeNode.valueCont == r)) {
			l = false
		}
		if (l) {
			n.hide()
		}
	};
	this._doOnChangeHSL = function() {
		var s = parseInt(n._controllerNodes.hue.value),
			r = parseInt(n._controllerNodes.sat.value),
			l = parseInt(n._controllerNodes.lum.value),
			u;
		if (isNaN(s) || s > 359 || s < 0) {
			n._controllerNodes.hue.value = n.value.hue
		} else {
			n.value.hue = s
		}
		if (isNaN(r) || r > 100 || r < 0) {
			n._controllerNodes.sat.value = n.value.sat
		} else {
			n.value.sat = r
		}
		if (isNaN(l) || l > 100 || l < 0) {
			n._controllerNodes.lum.value = n.value.lum
		} else {
			n.value.lum = l
		}
		u = n.colorAIP.hsl2rgb(n.value.hue, n.value.sat / 100, n.value.lum / 100);
		n.value.red = Math.round(255 * u.r);
		n.value.green = Math.round(255 * u.g);
		n.value.blue = Math.round(255 * u.b);
		n._refreshCoordinatesByHSL(n.value.hue, n.value.sat, n.value.lum);
		n._refreshContrast();
		n._refreshInputValues();
		n._refreshColorValue()
	};
	this._doOnChangeRGB = function() {
		var u = parseInt(n._controllerNodes.red.value),
			s = parseInt(n._controllerNodes.green.value),
			l = parseInt(n._controllerNodes.blue.value),
			r;
		if (isNaN(u) || u > 255 || u < 0) {
			n._controllerNodes.red.value = n.value.red
		} else {
			n.value.red = u
		}
		if (isNaN(s) || s > 255 || s < 0) {
			n._controllerNodes.green.value = n.value.green
		} else {
			n.value.green = s
		}
		if (isNaN(l) || l > 255 || l < 0) {
			n._controllerNodes.blue.value = n.value.blue
		} else {
			n.value.blue = l
		}
		r = n.colorAIP.rgb2hsl(n.value.red / 255, n.value.green / 255, n.value.blue / 255);
		n.value.hue = Math.round(r.h);
		n.value.sat = Math.round(r.s * 100);
		n.value.lum = Math.round(r.l * 100);
		n._refreshCoordinatesByHSL(n.value.hue, n.value.sat, n.value.lum);
		n._refreshContrast();
		n._refreshInputValues();
		n._refreshColorValue()
	};
	this._doOnChangeHSV = function() {
		n._controllerNodes.hsv.value = n.setColor(n._controllerNodes.hsv.value)
	};
	this._checkType = function(r) {
		var l;
		if (r instanceof Array) {
			l = n._checkType(r[0]);
			switch (l) {
				case "string":
					return "array_string";
					break;
				case "input":
				case "textarea":
					return "array_input";
					break;
				case "object":
					return "array_object";
					break;
				default:
					return undefined
			}
		} else {
			if (r == undefined) {
				return null
			} else {
				if (typeof(r) == "string") {
					return "string"
				} else {
					if (r.tagName && r.tagName.toLowerCase() == "input") {
						return "input"
					} else {
						if (r.tagName && r.tagName.toLowerCase() == "textarea") {
							return "textarea"
						} else {
							if (r.tagName) {
								return "container"
							} else {
								if (typeof(r) == "object") {
									return "object"
								} else {
									return undefined
								}
							}
						}
					}
				}
			}
		}
	};
	this._initByObject = function(l) {
		if (l.parent && l.parent.tagName) {
			n.base = l.parent
		} else {
			if (typeof(l.parent) == "string") {
				n.base = document.getElementById(l.parent)
			} else {
				n.base = document.createElement("div");
				n.base._dhx_remove = true
			}
		}
		if (l.color) {
			n.conf.selectedColor = l.color
		}
		if (typeof(l.closeable) != "undefined") {
			this.conf.closeable = dhx4.s2b(l.closeable)
		}
		if (l.custom_colors) {
			this._tempInitCC = function() {
				var u, s;
				this.initMemoryColors();
				this.conf.customColors = true;
				if (l.custom_colors instanceof Array) {
					s = l.custom_colors.length;
					for (u = 0; u < s; u++) {
						this.setCustomColors(l.custom_colors[u])
					}
				}
				if (this.base.parentNode) {
					this.showMemory()
				}
				delete this._tempInitCC
			}
		}
		if (l.hide) {
			n.conf.hide = true
		}
		if (l.input) {
			n._addNode(l.input, l.target_color, l.target_value)
		}
		var r = l.skin || window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhxcolorpicker") || "dhx_skyblue";
		n.setSkin(r);
		if (l.colors) {
			n.initMemoryColors();
			n.conf.customColors = true
		}
		if (l.link) {
			n._addNode(l.link)
		}
	};
	this.unload = function() {
		var u, r, s;
		if (this.isVisible()) {
			this.hide()
		}
		this.destructMemory();
		r = this._nodes.length;
		for (u = 0; u < r; u++) {
			this._detachEventsFromNode(this._nodes[u]);
			for (s in this._nodes[u]) {
				this._nodes[u][s] = null
			}
			delete this._nodes[u]
		}
		this._nodes = null;
		if (!this.base._dhx_remove) {
			this.base.className = this.base.className.replace(/\s?dhtmlxcp_\S*/, "")
		} else {
			delete this.base._dhx_remove
		}
		if (typeof(window.addEventListener) == "function") {
			this._controllerNodes.colorArea.removeEventListener("mousedown", this._initMoveSelection, false);
			this._controllerNodes.colorArea.removeEventListener("dblclick", this._doOnSelectColor, false);
			this._controllerNodes.contrastArea.removeEventListener("mousedown", this._initMoveContrast, false);
			this._controllerNodes.button_save.removeEventListener("click", this._doOnSelectColor, false);
			this._controllerNodes.button_cancel.removeEventListener("click", this._doOnCancel, false);
			this._controllerNodes.hue.removeEventListener("change", this._doOnChangeHSL, false);
			this._controllerNodes.sat.removeEventListener("change", this._doOnChangeHSL, false);
			this._controllerNodes.lum.removeEventListener("change", this._doOnChangeHSL, false);
			this._controllerNodes.red.removeEventListener("change", this._doOnChangeRGB, false);
			this._controllerNodes.green.removeEventListener("change", this._doOnChangeRGB, false);
			this._controllerNodes.blue.removeEventListener("change", this._doOnChangeRGB, false);
			this._controllerNodes.hsv.removeEventListener("change", this._doOnChangeHSV, false)
		} else {
			this._controllerNodes.colorArea.detachEvent("onmousedown", this._initMoveSelection);
			this._controllerNodes.colorArea.detachEvent("ondblclick", this._doOnSelectColor);
			this._controllerNodes.contrastArea.detachEvent("onmousedown", this._initMoveContrast);
			this._controllerNodes.button_save.detachEvent("onclick", this._doOnSelectColor);
			this._controllerNodes.button_cancel.detachEvent("onclick", this._doOnCancel);
			this._controllerNodes.hue.detachEvent("onchange", this._doOnChangeHSL);
			this._controllerNodes.sat.detachEvent("onchange", this._doOnChangeHSL);
			this._controllerNodes.lum.detachEvent("onchange", this._doOnChangeHSL);
			this._controllerNodes.red.detachEvent("onchange", this._doOnChangeRGB);
			this._controllerNodes.green.detachEvent("onchange", this._doOnChangeRGB);
			this._controllerNodes.blue.detachEvent("onchange", this._doOnChangeRGB);
			this._controllerNodes.hsv.detachEvent("onchange", this._doOnChangeHSV)
		}
		if (this._controllerNodes.fr_cover) {
			if (this._controllerNodes.fr_cover.parentNode) {
				this._controllerNodes.fr_cover.parentNode.removeChild(this._controllerNodes.fr_cover)
			}
			delete this._controllerNodes.fr_cover
		}
		dhx4.zim.clear(this.conf.cp_id);
		dhx4._eventable(this, "clear");
		for (s in this) {
			this[s] = null
		}
		n = null, o = null, c = null
	};
	m = this._checkType(q);
	switch (m) {
		case "object":
			n._initByObject(q);
			break;
		case "input":
		case "textarea":
			n._initByObject({});
			this._addNode(q);
			break;
		case "string":
			o = document.getElementById(q);
			return new dhtmlXColorPicker(o);
			break;
		case "container":
			n._initByObject({
				parent: q
			});
			break;
		case null:
			n._initByObject({});
			break;
		case "array_string":
		case "array_input":
			n._initByObject({});
			a = q.length;
			for (g = 0; g < a; g++) {
				this._addNode(q[g])
			}
			break;
		case "array_object":
			n._initByObject({});
			a = q.length;
			for (g = 0; g < a; g++) {
				c = this._addNode(q[g].input, q[g].target_color, q[g].target_value).conf;
				c.customColors = (q[g].custom_colors != undefined) ? dhx4.s2b(q[g].custom_colors) : c.customColors;
				c.selectedColor = (q[g].color != undefined) ? q[g].color : c.selectedColor
			}
			break
	}
	this.base.innerHTML = "<div class='dhxcp_g_area'><div class='dhxcp_sub_area'><div class='dhxcp_g_color_area'><div class='dhxcp_color_selector'><div class='dhxcp_v_line'></div><div class='dhxcp_h_line'></div></div><div class='dhxcp_contrast_area'><div class='dhxcp_h_line'></div></div></div><div class='dhxcp_g_input_area'><div class='dhxcp_value_cont'><div class='dhxcp_value_color'></div><input type='text' class='dhxcp_value'/></div><table class='dhxcp_inputs_cont' cellpadding='0' cellspacing='0' border='0'><tr><td class='dhxcp_label_hsl'>" + this.i18n[this.conf.lang].labelHue + "</td><td class='dhxcp_input_hsl'><input type='text' class='dhxcp_input_hsl'/></td><td class='dhxcp_label_rgb'>" + this.i18n[this.conf.lang].labelRed + "</td><td class='dhxcp_input_rgb'><input type='text' class='dhxcp_input_rgb'/></td></tr><tr><td class='dhxcp_label_hsl'>" + this.i18n[this.conf.lang].labelSat + "</td><td class='dhxcp_input_hsl'><input type='text' class='dhxcp_input_hsl'/></td><td class='dhxcp_label_rgb'>" + this.i18n[this.conf.lang].labelGreen + "</td><td class='dhxcp_input_rgb'><input type='text' class='dhxcp_input_rgb'/></td></tr><tr><td class='dhxcp_label_hsl'>" + this.i18n[this.conf.lang].labelLum + "</td><td class='dhxcp_input_hsl'><input type='text' class='dhxcp_input_hsl'/></td><td class='dhxcp_label_rgb'>" + this.i18n[this.conf.lang].labelBlue + "</td><td class='dhxcp_input_rgb'><input type='text' class='dhxcp_input_rgb'/></td></tr></table></div><div class='dhxcp_g_memory_area'></div><div class='dhxcp_buttons_area'><button class='dhx_button_save'>" + this.i18n[this.conf.lang].btnSelect + "</button><button class='dhx_button_cancel'>" + this.i18n[this.conf.lang].btnCancel + "</button></div></div>";
	"</div>";
	this._globalNode = this.base.firstChild;
	this._controllerNodes = {
		colorArea: this._globalNode.firstChild.firstChild.firstChild,
		v_line: this._globalNode.firstChild.firstChild.firstChild.childNodes[0],
		h_line: this._globalNode.firstChild.firstChild.firstChild.childNodes[1],
		contrastArea: this._globalNode.firstChild.firstChild.childNodes[1],
		contrast_line: this._globalNode.firstChild.firstChild.childNodes[1].firstChild,
		color: this._globalNode.firstChild.childNodes[1].childNodes[0].firstChild,
		hsv: this._globalNode.firstChild.childNodes[1].childNodes[0].childNodes[1],
		hue: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[0].childNodes[1].firstChild,
		sat: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[1].childNodes[1].firstChild,
		lum: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[2].childNodes[1].firstChild,
		red: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[0].childNodes[3].firstChild,
		green: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[1].childNodes[3].firstChild,
		blue: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[2].childNodes[3].firstChild,
		memory_block: this._globalNode.firstChild.childNodes[2],
		button_save: this._globalNode.firstChild.childNodes[3].firstChild,
		button_cancel: this._globalNode.firstChild.childNodes[3].childNodes[1]
	};
	this._labelNodes = {
		labelHue: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[0].firstChild,
		labelSat: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[1].firstChild,
		labelLum: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[2].firstChild,
		labelRed: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[0].childNodes[2],
		labelGreen: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[1].childNodes[2],
		labelBlue: this._globalNode.firstChild.childNodes[1].childNodes[1].firstChild.childNodes[2].childNodes[2],
		btnAddColor: null,
		btnSelect: this._globalNode.firstChild.childNodes[3].firstChild,
		btnCancel: this._globalNode.firstChild.childNodes[3].childNodes[1]
	};
	if (typeof(this._tempInitCC) == "function") {
		this._tempInitCC()
	}
	if (typeof(window.addEventListener) == "function") {
		this._controllerNodes.colorArea.addEventListener("mousedown", this._initMoveSelection, false);
		this._controllerNodes.colorArea.addEventListener("dblclick", this._doOnSelectColor, false);
		this._controllerNodes.contrastArea.addEventListener("mousedown", this._initMoveContrast, false);
		this._controllerNodes.button_save.addEventListener("click", this._doOnSelectColor, false);
		this._controllerNodes.button_cancel.addEventListener("click", this._doOnCancel, false);
		this._controllerNodes.hue.addEventListener("change", this._doOnChangeHSL, false);
		this._controllerNodes.sat.addEventListener("change", this._doOnChangeHSL, false);
		this._controllerNodes.lum.addEventListener("change", this._doOnChangeHSL, false);
		this._controllerNodes.red.addEventListener("change", this._doOnChangeRGB, false);
		this._controllerNodes.green.addEventListener("change", this._doOnChangeRGB, false);
		this._controllerNodes.blue.addEventListener("change", this._doOnChangeRGB, false);
		this._controllerNodes.hsv.addEventListener("change", this._doOnChangeHSV, false)
	} else {
		this._controllerNodes.colorArea.attachEvent("onmousedown", this._initMoveSelection);
		this._controllerNodes.colorArea.attachEvent("ondblclick", this._doOnSelectColor);
		this._controllerNodes.contrastArea.attachEvent("onmousedown", this._initMoveContrast);
		this._controllerNodes.button_save.attachEvent("onclick", this._doOnSelectColor);
		this._controllerNodes.button_cancel.attachEvent("onclick", this._doOnCancel);
		this._controllerNodes.hue.attachEvent("onchange", this._doOnChangeHSL);
		this._controllerNodes.sat.attachEvent("onchange", this._doOnChangeHSL);
		this._controllerNodes.lum.attachEvent("onchange", this._doOnChangeHSL);
		this._controllerNodes.red.attachEvent("onchange", this._doOnChangeRGB);
		this._controllerNodes.green.attachEvent("onchange", this._doOnChangeRGB);
		this._controllerNodes.blue.attachEvent("onchange", this._doOnChangeRGB);
		this._controllerNodes.hsv.attachEvent("onchange", this._doOnChangeHSV)
	}
	this.setColor(this.conf.selectedColor || "#ffffff");
	if (this._nodes.length) {
		for (var g = 0; g < this._nodes.length; g++) {
			this._attachEventsToNode(this._nodes[g])
		}
	}
	if (this.conf.hide) {
		this.hide()
	}
	if (typeof(this._cpInitFRM) == "function") {
		this._cpInitFRM()
	}
}
dhtmlXColorPicker.prototype.linkTo = function(c, g, l) {
	if (arguments.length == 1) {
		g = l = c
	}
	var a;
	c = c || null;
	l = l || null;
	if (typeof(g) == "string") {
		g = document.getElementById(g)
	}
	a = this._addNode(g, c, l);
	if (a) {
		this._attachEventsToNode(a)
	}
	return a
};
dhtmlXColorPicker.prototype._isBaseNode = function(a) {
	if (a == this.base) {
		return true
	}
	if (a.parentElement == document.body) {
		return false
	} else {
		if (!a.parentElement) {
			return false
		} else {
			return this._isBaseNode(a.parentElement)
		}
	}
};
dhtmlXColorPicker.prototype._hasInput = function(g) {
	var c, a, m = false;
	a = this._nodes.length;
	for (c = 0; c < a; c++) {
		if (this._nodes[c].valueCont == g) {
			m = true;
			break
		}
	}
	return m
};
dhtmlXColorPicker.prototype._findNodesByArray = function(n) {
	var g, a, c, m = [];
	a = n.length;
	for (g = 0; g < a; g++) {
		if (typeof(n[g]) == "string") {
			c = document.getElementById(n[g])
		} else {
			c = n[g]
		}
		if (c) {
			this._addNode(c)
		}
	}
};
dhtmlXColorPicker.prototype._addNode = function(m, o, n) {
	var c, l, g, a;
	if (typeof(m) == "string") {
		c = document.getElementById(m)
	} else {
		c = m
	}
	if (typeof(o) == "string") {
		o = document.getElementById(o)
	}
	if (typeof(n) == "string") {
		n = document.getElementById(n)
	}
	if (!c) {
		return null
	}
	if (dhx4.s2b(c.getAttribute("colorbox"))) {
		l = document.createElement("div");
		l.style.width = c.offsetWidth + "px";
		l.style.height = c.offsetHeight + "px";
		c.style.width = c.offsetWidth - (c.offsetHeight + 8) + "px";
		c.parentNode.insertBefore(l, c);
		l.style.position = "relative";
		g = document.createElement("div");
		l.appendChild(c);
		l.appendChild(g);
		g.className = "dhxcp_colorBox";
		c.className += " dhxcp_colorInput";
		g.style.width = g.style.height = c.offsetHeight + "px"
	}
	a = {
		node: c,
		valueColor: (o != undefined) ? o : g || c,
		valueCont: (n != undefined) ? n : c,
		conf: {
			customColors: (c.getAttribute("customcolors") != null) ? dhx4.s2b(c.getAttribute("customcolors")) : null,
			selectedColor: c.getAttribute("selectedcolor")
		}
	};
	this._nodes.push(a);
	if (!this.activeNode) {
		this.activeNode = a
	}
	return a
};
dhtmlXColorPicker.prototype.getNode = function(g) {
	var a = null,
		c = null;
	if (typeof(g) == "string") {
		a = document.getElementById(g)
	} else {
		a = g
	}
	if (a.tagName != undefined) {
		c = this._getNodeByElement(a)
	}
	return c
};
dhtmlXColorPicker.prototype._getNodeByElement = function(g) {
	var m = null,
		c, a;
	a = this._nodes.length;
	for (c = 0; c < a; c++) {
		if (this._nodes[c].node == g) {
			m = this._nodes[c]
		}
	}
	return m
};
dhtmlXColorPicker.prototype._getNodeByValueCont = function(g) {
	var m = null,
		c, a;
	a = this._nodes.length;
	for (c = 0; c < a; c++) {
		if (this._nodes[c].valueCont && this._nodes[c].valueCont == g) {
			m = this._nodes[c]
		}
	}
	return m
};
dhtmlXColorPicker.prototype.initMemoryColors = function() {
	var c = this;
	this._controllerNodes.memory_block.innerHTML = "<div class='dhxcp_memory_button_cont'><button class='dhxcp_save_to_memory'><div class='dhxcp_label_bm'>" + this.i18n[this.conf.lang].btnAddColor + "</div></button></div><div class='dhxcp_memory_els_cont'><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a><a class='dhxcp_memory_el'></a></div>";
	this.memory = new this.Memory(this._controllerNodes.memory_block.childNodes[1]);
	this.memory.onSelect = this._onSelectMemoryEl;
	this.memory.onSave = function(l) {
		var g = c.colorAIP.rgb2hex({
			r: l.red,
			g: l.green,
			b: l.blue
		});
		c.callEvent("onSaveColor", [g])
	};
	var a = this._controllerNodes.memory_block.childNodes[0].firstChild;
	this._labelNodes.btnAddColor = this._controllerNodes.memory_block.childNodes[0].firstChild.firstChild;
	if (typeof(window.addEventListener) == "function") {
		a.addEventListener("click", this.saveColor, false)
	} else {
		a.attachEvent("onclick", this.saveColor)
	}
};
dhtmlXColorPicker.prototype._refreshCoordinatesByHSL = function(o, n, c) {
	var a, m, g;
	a = Math.round((this.configColorArea.maxX - this.configColorArea.minX) * o / 359) + this.configColorArea.minX;
	m = Math.round((this.configColorArea.maxY - this.configColorArea.minY) * (100 - c) / 100) + this.configColorArea.minY;
	g = Math.round((this.configColorArea.maxY - this.configColorArea.minY) * (100 - n) / 100) + this.configColorArea.minY;
	this._setColorAreaXY(a, m);
	this._setContrastY(g)
};
dhtmlXColorPicker.prototype._parseColor = function(g) {
	if (g instanceof Array) {
		var c = {
			r: parseInt(g[0]),
			g: parseInt(g[1]),
			b: parseInt(g[2])
		}
	} else {
		if (typeof(g) == "string") {
			g = g.replace(/\s/g, "");
			if (/^rgb\((\d{1,3})\,(\d{1,3})\,(\d{1,3})\)$/i.test(g)) {
				var a = g.match(/^rgb\((\d{1,3})\,(\d{1,3})\,(\d{1,3})\)$/i);
				var c = {
					r: parseInt(a[1]),
					g: parseInt(a[2]),
					b: parseInt(a[3])
				}
			} else {
				var c = this.colorAIP.hex2rgb(g)
			}
		}
	}
	return c
};
dhtmlXColorPicker.prototype.setColor = function(n) {
	var c = this.colorAIP.rgb2hex({
		r: this.value.red,
		g: this.value.green,
		b: this.value.blue
	});
	var g = this._parseColor(n);
	var m = (g instanceof Object);
	m = m && (0 <= g.r && g.r <= 255);
	m = m && (0 <= g.g && g.g <= 255);
	m = m && (0 <= g.b && g.b <= 255);
	if (!m) {
		return c
	}
	var l = this.colorAIP.rgb2hex({
		r: g.r,
		g: g.g,
		b: g.b
	});
	if (l == c) {
		return c
	}
	this.value.red = g.r;
	this.value.green = g.g;
	this.value.blue = g.b;
	var a = this.colorAIP.rgb2hsl(g.r / 255, g.g / 255, g.b / 255);
	this.value.hue = Math.round(a.h);
	this.value.sat = Math.round(a.s * 100);
	this.value.lum = Math.round(a.l * 100);
	this._refreshCoordinatesByHSL(this.value.hue, this.value.sat, this.value.lum);
	this._refreshContrast();
	this._refreshInputValues();
	this._refreshColorValue();
	return l
};
dhtmlXColorPicker.prototype.getSelectedColor = function() {
	return [this.colorAIP.rgb2hex({
			r: this.value.red,
			g: this.value.green,
			b: this.value.blue
		}), [this.value.red, this.value.green, this.value.blue],
		[this.value.hue, this.value.sat, this.value.lum]
	]
};
dhtmlXColorPicker.prototype._attachEventsToNode = function(a) {
	if (typeof(window.addEventListener) == "function") {
		a.node.addEventListener("click", this._doOnClickByNode, false)
	} else {
		a.node.attachEvent("onclick", this._doOnClickByNode)
	}
	if (a.valueCont && a.valueCont.tagName.toLowerCase() == "input") {
		if (typeof(window.addEventListener) == "function") {
			a.valueCont.addEventListener("focus", this._doOnFocusByInput, false);
			a.valueCont.addEventListener("blur", this._doOnBlurByInput, false)
		} else {
			a.valueCont.attachEvent("onfocus", this._doOnFocusByInput);
			a.valueCont.attachEvent("onblur", this._doOnBlurByInput)
		}
	}
};
dhtmlXColorPicker.prototype._detachEventsFromNode = function(a) {
	if (typeof(window.addEventListener) == "function") {
		a.node.removeEventListener("click", this._doOnClickByNode, false)
	} else {
		a.node.detachEvent("onclick", this._doOnClickByNode)
	}
	if (a.valueCont && a.valueCont.tagName.toLowerCase() == "input") {
		if (typeof(window.addEventListener) == "function") {
			a.valueCont.removeEventListener("focus", this._doOnFocusByInput, false);
			a.valueCont.removeEventListener("blur", this._doOnBlurByInput, false)
		} else {
			a.valueCont.detachEvent("onfocus", this._doOnFocusByInput);
			a.valueCont.detachEvent("onblur", this._doOnBlurByInput)
		}
	}
};
dhtmlXColorPicker.prototype.show = function(c) {
	var a = false;
	if (c != undefined) {
		this.activeNode = this.getNode(c) || this.activeNode
	}
	if (this.activeNode && this.activeNode.valueCont && this.activeNode.valueCont.value) {
		this.setColor(this.activeNode.valueCont.value)
	}
	if (this.activeNode) {
		a = (this.activeNode.conf.customColors != null ? this.activeNode.conf.customColors : this.conf.customColors);
		this.setColor(this.activeNode.conf.selectedColor)
	} else {
		a = this.conf.customColors
	}
	if (a) {
		this.showMemory()
	} else {
		this.hideMemory()
	}
	if (this.base._dhx_remove) {
		this.base.firstChild.style.zIndex = dhx4.zim.reserve(this.conf.cp_id);
		this.base.style.visibility = "hidden";
		if (document.body.firstChild) {
			document.body.insertBefore(this.base, document.body.firstChild)
		} else {
			document.body.appendChild(this.base)
		}
		this._refreshPosition();
		this.base.style.visibility = "visible";
		if (typeof(window.addEventListener) == "function") {
			document.body.addEventListener("mousedown", this._doOnClickByBody, false)
		} else {
			document.body.attachEvent("onmousedown", this._doOnClickByBody)
		}
	} else {
		this.base.appendChild(this._globalNode)
	}
	if (this._controllerNodes.fr_cover) {
		this.base.insertBefore(this._controllerNodes.fr_cover, this._globalNode)
	}
	this.callEvent("onShow", [((this.activeNode) ? this.activeNode.node : null)])
};
dhtmlXColorPicker.prototype.setPosition = function(c, m) {
	var l = null;
	var a = parseInt(c);
	var g = parseInt(m);
	if (isNaN(a)) {
		l = ({
			right: "right",
			bottom: "bottom"
		}[c.toLowerCase()] ? c : null)
	}
	if (this.base._dhx_remove) {
		if (l == null) {} else {
			this.conf.position = l;
			this._refreshPosition(l)
		}
	} else {
		if (isNaN(a) || isNaN(g)) {} else {
			this._globalNode.style.left = a + "px";
			this._globalNode.style.top = g + "px";
			if (this._controllerNodes.fr_cover) {
				this._controllerNodes.fr_cover.style.left = this._globalNode.style.left;
				this._controllerNodes.fr_cover.style.top = this._globalNode.style.top
			}
		}
	}
};
dhtmlXColorPicker.prototype._initListenerInput = function() {
	var a = this;
	this._inputListenerId = this._inputListenerId || setInterval(function() {
		a._refreshValueByInput()
	}, 70)
};
dhtmlXColorPicker.prototype._removeListenerInput = function() {
	if (this._inputListenerId) {
		clearInterval(this._inputListenerId);
		this._inputListenerId = null
	}
};
dhtmlXColorPicker.prototype._refreshValueByInput = function() {
	var c = this.activeNode.valueCont.value,
		a = this.getSelectedColor()[0];
	if (this._inputListenerId) {
		if (/^#[\da-f]{6}$/i.test(c) && c != a) {
			this.setColor(c);
			this.callEvent("onSelect", [c, this.activeNode.node])
		}
	}
};
dhtmlXColorPicker.prototype._refreshPosition = function(c) {
	if (this.activeNode == null) {
		return
	}
	var q = dhx4.absTop(this.activeNode.node);
	var a = dhx4.absLeft(this.activeNode.node);
	var l = dhx4.screenDim();
	var g = this._globalNode.offsetWidth;
	var m = this._globalNode.offsetHeight;
	var o = 0;
	c = c || this.conf.position;
	switch (c) {
		case "bottom":
			var o = q + this.activeNode.node.offsetHeight + this.conf.indent;
			var n = a;
			if (n + g > l.left + l.right) {
				n = a + this.activeNode.node.offsetWidth - g
			}
			if (n < l.left) {
				n = a
			}
			if (o + m > l.top + l.bottom) {
				o = q - m - this.conf.indent
			}
			if (o - l.top < 0) {
				o = l.top + this.conf.indent
			}
			this._globalNode.style.top = o + "px";
			this._globalNode.style.left = n + "px";
			break;
		default:
			var n = a + this.activeNode.node.offsetWidth + this.conf.indent;
			o = q;
			if (c == "right") {
				if (n + g > l.left + l.right) {
					n = a - g - this.conf.indent
				}
				if (n < l.left) {
					n = a + this.activeNode.node.offsetWidth + this.conf.indent
				}
			}
			if (l.bottom - (o + m) <= 0) {
				o = q + this.activeNode.node.offsetHeight - m
			}
			if (o - l.top < 0) {
				o = l.top + this.conf.indent
			}
			this._globalNode.style.left = n + "px";
			this._globalNode.style.top = o + "px"
	}
	if (this._controllerNodes.fr_cover) {
		this._controllerNodes.fr_cover.style.left = this._globalNode.style.left;
		this._controllerNodes.fr_cover.style.top = this._globalNode.style.top
	}
};
dhtmlXColorPicker.prototype.isVisible = function() {
	var a = false;
	if (this.base._dhx_remove) {
		a = this.base.parentNode == document.body
	} else {
		a = this._globalNode.parentNode == this.base
	}
	return a
};
dhtmlXColorPicker.prototype.hide = function() {
	if (this.base._dhx_remove) {
		if (this.base.parentNode) {
			this.base.parentNode.removeChild(this.base);
			dhx4.zim.clear(this.conf.cp_id);
			if (typeof(window.addEventListener) == "function") {
				document.body.removeEventListener("mousedown", this._doOnClickByBody, false)
			} else {
				document.body.detachEvent("onmousedown", this._doOnClickByBody)
			}
		}
	} else {
		if (this.isVisible() == false) {
			return
		}
		this.base.removeChild(this._globalNode)
	}
	if (this._controllerNodes.fr_cover && this._controllerNodes.fr_cover.parentNode) {
		this._controllerNodes.fr_cover.parentNode.removeChild(this._controllerNodes.fr_cover)
	}
	if (this.callEvent != undefined) {
		this.callEvent("onHide", [((this.activeNode) ? this.activeNode.node : null)])
	}
};
dhtmlXColorPicker.prototype.configColorArea = {
	minX: 1,
	maxX: 209,
	minY: 1,
	maxY: 119
};
dhtmlXColorPicker.prototype._skinCollection = {
	dhx_skyblue: true,
	dhx_web: true,
	dhx_terrace: true
};
dhtmlXColorPicker.prototype.i18n = {
	en: {
		labelHue: "Hue",
		labelSat: "Sat",
		labelLum: "Lum",
		labelRed: "Red",
		labelGreen: "Green",
		labelBlue: "Blue",
		btnAddColor: "Save the color",
		btnSelect: "Select",
		btnCancel: "Cancel"
	}
};
dhtmlXColorPicker.prototype.loadUserLanguage = function(a) {
	if (typeof(this._mergeLangModules) == "function") {
		this._mergeLangModules()
	}
	this.conf.lang = a;
	this._refreshLanguage()
};
dhtmlXColorPicker.prototype._refreshLanguage = function() {
	var a, c = this.i18n[this.conf.lang];
	for (a in c) {
		if (this._labelNodes[a]) {
			this._labelNodes[a].innerHTML = c[a]
		}
	}
};
dhtmlXColorPicker.prototype._setColorAreaXY = function(a, g) {
	var c = this.configColorArea;
	a = parseInt(a);
	if (c.minX > a) {
		this.conf.x = c.minX
	} else {
		if (a > c.maxX) {
			this.conf.x = c.maxX
		} else {
			if (!isNaN(a)) {
				this.conf.x = a
			}
		}
	}
	g = parseInt(g);
	if (c.minY > g) {
		this.conf.y = c.minY
	} else {
		if (g > c.maxY) {
			this.conf.y = c.maxY
		} else {
			if (!isNaN(g)) {
				this.conf.y = g
			}
		}
	}
	this._refreshLines()
};
dhtmlXColorPicker.prototype._setColorByXYC = function(c) {
	c = c || false;
	this.value.hue = Math.round((359 * (this.conf.x - this.configColorArea.minX)) / (this.configColorArea.maxX - this.configColorArea.minX));
	this.value.lum = Math.round(100 - (100 * (this.conf.y - this.configColorArea.minY)) / (this.configColorArea.maxY - this.configColorArea.minY));
	this.value.sat = Math.round(100 - (100 * (this.conf.c - this.configColorArea.minY)) / (this.configColorArea.maxY - this.configColorArea.minY));
	var a = this.colorAIP.hsl2rgb(this.value.hue, this.value.sat / 100, this.value.lum / 100);
	this.value.red = Math.round(255 * a.r);
	this.value.green = Math.round(255 * a.g);
	this.value.blue = Math.round(255 * a.b);
	if (!c) {
		this._refreshContrast()
	}
	this._refreshInputValues();
	this._refreshColorValue()
};
dhtmlXColorPicker.prototype._setContrastY = function(c) {
	var a = this.configColorArea;
	c = parseInt(c);
	if (!isNaN(c)) {
		this.conf.c = Math.min(Math.max(a.minY, c), a.maxY)
	}
	this._refreshContrastLine()
};
dhtmlXColorPicker.prototype._refreshInputValues = function() {
	this._controllerNodes.hue.value = this.value.hue;
	this._controllerNodes.sat.value = this.value.sat;
	this._controllerNodes.lum.value = this.value.lum;
	this._controllerNodes.red.value = this.value.red;
	this._controllerNodes.green.value = this.value.green;
	this._controllerNodes.blue.value = this.value.blue
};
dhtmlXColorPicker.prototype._refreshColorValue = function() {
	this._controllerNodes.color.style.backgroundColor = "rgb(" + [this.value.red, this.value.green, this.value.blue].join(", ") + ")";
	var a = this.colorAIP.rgb2hex({
		r: this.value.red,
		g: this.value.green,
		b: this.value.blue
	});
	this._controllerNodes.hsv.value = a;
	this.callEvent("onChange", [a])
};
dhtmlXColorPicker.prototype._refreshContrast = function() {
	var l = this.colorAIP.hsl2rgb(this.value.hue, 0, this.value.lum / 100);
	var m = this.colorAIP.hsl2rgb(this.value.hue, 1, this.value.lum / 100);
	var g = this._checkIeVersion();
	if (g && g <= 9) {
		var n = this._controllerNodes.contrastArea.firstChild;
		if (n == this._controllerNodes.contrast_line) {
			n = document.createElement("div");
			n.className += "dhxcp_ie_gradient";
			this._controllerNodes.contrastArea.appendChild(n);
			this._controllerNodes.contrastArea.appendChild(this._controllerNodes.contrast_line)
		}
		var c = this.colorAIP.rgb2hex({
			r: Math.round(255 * l.r),
			g: Math.round(255 * l.g),
			b: Math.round(255 * l.b)
		});
		var a = this.colorAIP.rgb2hex({
			r: Math.round(255 * m.r),
			g: Math.round(255 * m.g),
			b: Math.round(255 * m.b)
		});
		n.style.filter = "progid:DXImageTransform.Microsoft.gradient(startColorstr='" + a + "', endColorstr='" + c + "', GradientType=0)"
	} else {
		l = [Math.round(255 * l.r), Math.round(255 * l.g), Math.round(255 * l.b)];
		m = [Math.round(255 * m.r), Math.round(255 * m.g), Math.round(255 * m.b)];
		this._controllerNodes.contrastArea.style.backgroundImage = "linear-gradient(to top, rgb(" + l.join(",") + "), rgb(" + m.join(",") + "))"
	}
};
dhtmlXColorPicker.prototype._refreshLines = function() {
	this._controllerNodes.v_line.style.left = this.conf.x + "px";
	this._controllerNodes.h_line.style.top = this.conf.y + "px"
};
dhtmlXColorPicker.prototype._refreshContrastLine = function() {
	this._controllerNodes.contrast_line.style.top = this.conf.c + "px"
};
dhtmlXColorPicker.prototype._getOffsetPosition = function(l, a) {
	var c = {
			x: NaN,
			y: NaN
		},
		g = l.target || l.srcElement;
	if (g == a) {
		c.x = (l.offsetX != undefined) ? l.offsetX : l.layerX;
		c.y = (l.offsetY != undefined) ? l.offsetY : l.layerY
	} else {
		if (g == this._controllerNodes.v_line) {
			c.y = (l.offsetY != undefined) ? l.offsetY : l.layerY
		} else {
			c.x = (l.offsetX != undefined) ? l.offsetX : l.layerX
		}
	}
	return c
};
dhtmlXColorPicker.prototype.colorAIP = {
	hex2rgb: function(c) {
		var a = c.match(/^(#)([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i);
		if (a != null) {
			return {
				r: parseInt("0x" + a[2]),
				g: parseInt("0x" + a[3]),
				b: parseInt("0x" + a[4])
			}
		} else {
			return null
		}
	},
	rgb2hex: function(m) {
		var l = parseInt(m.r),
			c = parseInt(m.g),
			a = parseInt(m.b);
		l = l || 0, c = c || 0, a = a || 0;
		return "#" + ((l) ? ((l < 16) ? "0" + l.toString(16) : l.toString(16)) : "00") + ((c) ? ((c < 16) ? "0" + c.toString(16) : c.toString(16)) : "00") + ((a) ? ((a < 16) ? "0" + a.toString(16) : a.toString(16)) : "00")
	},
	rgb2hsl: function(s, q, l) {
		var o, n, c;
		var a = Math.max(s, q, l),
			m = Math.min(s, q, l);
		c = 0.5 * (a + m);
		if (a == m) {
			o = 0
		} else {
			if (a == s) {
				o = 60 * (q - l) / (a - m);
				if (q < l) {
					o += 360
				}
			} else {
				if (a == q) {
					o = 60 * (l - s) / (a - m) + 120
				} else {
					o = 60 * (s - q) / (a - m) + 240
				}
			}
		}
		if (c == 0 || a == m) {
			n = 0
		} else {
			if (c <= 0.5) {
				n = 0.5 * (a - m) / c
			} else {
				n = 0.5 * (a - m) / (1 - c)
			}
		}
		return {
			h: o,
			s: n,
			l: c
		}
	},
	hsl2rgb: function(r, g, o) {
		var m, n, q;
		var c = [],
			a = [];
		if (o <= 0.5) {
			m = o * (1 + g)
		} else {
			m = o + g - (o * g)
		}
		n = 2 * o - m;
		q = r / 360;
		c.push(q + 1 / 3);
		c.push(q);
		c.push(q - 1 / 3);
		for (var l = 0; l < 3; l++) {
			if (c[l] < 0) {
				c[l] += 1
			} else {
				if (c[l] > 1) {
					c[l] -= 1
				}
			}
			if (c[l] < 1 / 6) {
				a.push(n + (m - n) * 6 * c[l])
			} else {
				if (c[l] < 0.5) {
					a.push(m)
				} else {
					if (c[l] < 2 / 3) {
						a.push(n + (m - n) * (2 / 3 - c[l]) * 6)
					} else {
						a.push(n)
					}
				}
			}
		}
		return {
			r: a[0],
			g: a[1],
			b: a[2]
		}
	}
};
dhtmlXColorPicker.prototype._checkIeVersion = function() {
	var a;
	var c = navigator.userAgent.match(/(MSIE)\s(\d\.\d)/i);
	a = (c && c[2]) ? parseInt(c[2]) : null;
	return a
};
dhtmlXColorPicker.prototype.setCustomColors = function() {
	if (this.memory == null) {
		this.initMemoryColors();
		this.conf.customColors = true
	}
	var m, g, o, c, n, a;
	g = arguments.length;
	for (m = 0; m < g; m++) {
		if (arguments[m] instanceof Array) {
			o = this._rgb2value(arguments[m][0], arguments[m][1], arguments[m][2]);
			this.memory.setValue(o, null, false);
			continue
		} else {
			if (typeof(arguments[m]) == "string") {
				c = arguments[m].match(/^rgb\((\d{1,3})\,(\d{1,3})\,(\d{1,3})\)$/i);
				if (c instanceof Array) {
					o = this._rgb2value(c[1], c[2], c[3]);
					this.memory.setValue(o, null, false);
					continue
				}
				c = arguments[m].match(/(#[\da-f]{6})/ig);
				if (c instanceof Array) {
					a = c.length;
					for (n = 0; n < a; n++) {
						o = this._hex2value(c[n]);
						this.memory.setValue(o, null, false)
					}
				}
			}
		}
	}
};
dhtmlXColorPicker.prototype.getCustomColors = function() {
	var c = [];
	if (this.memory != null && this.conf.customColors == true) {
		for (var g = 0; g < this.memory.controllers.length; g++) {
			var a = this.memory.controllers[g].value;
			c.push(this.colorAIP.rgb2hex({
				r: a.red,
				g: a.green,
				b: a.blue
			}))
		}
	}
	return c
};
dhtmlXColorPicker.prototype._rgb2value = function(m, l, a) {
	var c = this.colorAIP.rgb2hsl(m / 255, l / 255, a / 255);
	return {
		red: m,
		green: l,
		blue: a,
		hue: Math.round(c.h),
		sat: Math.round(c.s * 100),
		lum: Math.round(c.l * 100)
	}
};
dhtmlXColorPicker.prototype._hex2value = function(g) {
	var c, a;
	c = this.colorAIP.hex2rgb(g);
	a = this.colorAIP.rgb2hsl(c.r / 255, c.g / 255, c.b / 255);
	return {
		red: c.r,
		green: c.g,
		blue: c.b,
		hue: Math.round(a.h),
		sat: Math.round(a.s * 100),
		lum: Math.round(a.l * 100)
	}
};
dhtmlXColorPicker.prototype.showMemory = function() {
	if (this.memory == null) {
		this.initMemoryColors()
	}
	if (!this._globalNode.className.match(/dhxcp_add_memory/)) {
		this._globalNode.className += " dhxcp_add_memory"
	}
	this.conf.customColors = true
};
dhtmlXColorPicker.prototype.hideMemory = function() {
	if (this.memory != null) {
		this._globalNode.className = this._globalNode.className.replace(/\sdhxcp_add_memory/, "")
	}
	this.conf.customColors = false
};
dhtmlXColorPicker.prototype.setSkin = function(m) {
	m = m.toLowerCase();
	var g, c = -1,
		a, l = "dhtmlxcp";
	g = this.base.className.match(/\S\w+/ig);
	if (g instanceof Array) {
		for (a in this._skinCollection) {
			if (c == -1) {
				c = this._indexOf(g, l + "_" + a)
			} else {
				break
			}
		}
		c = (c == -1) ? g.length : c
	} else {
		g = [];
		c = 0
	}
	g[c] = l + "_" + m;
	this.base.className = g.join(" ");
	this.skin = m
};
dhtmlXColorPicker.prototype.hideOnSelect = function(a) {
	a = dhx4.s2b(a);
	this.conf.hideOnSelect = a
};
dhtmlXColorPicker.prototype._indexOf = function(a, m) {
	var g, c, n = -1;
	c = a.length;
	for (g = c; g >= 0; g--) {
		if (a[g] == m) {
			n = g;
			break
		}
	}
	return n
};
dhtmlXColorPicker.prototype.destructMemory = function() {
	if (this.memory == null) {
		return
	}
	this.hideMemory();
	var a = this._controllerNodes.memory_block.childNodes[0].firstChild;
	this._labelNodes.btnAddColor = null;
	if (typeof(window.addEventListener) == "function") {
		a.removeEventListener("click", this.saveColor, false)
	} else {
		a.detachEvent("onclick", this.saveColor)
	}
	this.memory.remove();
	this._controllerNodes.memory_block.innerHTML = "";
	this.memory = null
};
dhtmlXColorPicker.prototype.Memory = function(g) {
	var c = this,
		a = null,
		l = {
			red: 255,
			blue: 255,
			green: 255,
			hue: 0,
			sat: 0,
			lum: 100
		};
	this.select = function() {
		var n = (this != window) ? this : event.srcElement;
		var m = m || n.dhxpc_memory;
		if (a != null) {
			c.unSelect()
		}
		a = m;
		m.domElement.className += " dhxcp_memory_el_select";
		if (typeof(c.onSelect) == "function") {
			c.onSelect(m)
		}
	};
	this.onSelect = null;
	this.onSave = null;
	this._createMemoryController = function(m) {
		var n = {
			domElement: m,
			value: dhx4._copyObj(l)
		};
		m.dhxpc_memory = n;
		if (typeof(window.addEventListener) == "function") {
			m.addEventListener("click", c.select, false)
		} else {
			m.attachEvent("onclick", c.select)
		}
		return n
	};
	this._findMemoryControllers = function(r) {
		var o = r.getElementsByTagName("a"),
			n, m, q = [];
		m = o.length;
		for (n = 0; n < m; n++) {
			q.push(this._createMemoryController(o[n]))
		}
		return q
	};
	this.controllers = this._findMemoryControllers(g);
	this.unSelect = function() {
		if (a) {
			a.domElement.className = a.domElement.className.replace(/\s.*$/i, "")
		}
		a = null
	};
	this.setActiveNext = function() {
		var n = null,
			m;
		if (a == null) {
			a = this.controllers[0]
		} else {
			n = this.getIndex(a);
			m = this.controllers.length;
			this.unSelect();
			a = (n + 1 < m) ? this.controllers[n + 1] : this.controllers[0]
		}
		a.domElement.className += " dhxcp_memory_el_next";
		return a
	};
	this.setValue = function(n, m, o) {
		a = m || a;
		if (a == null) {
			a = this.controllers[0]
		}
		a.value.red = n.red;
		a.value.blue = n.blue;
		a.value.green = n.green;
		a.value.hue = n.hue;
		a.value.sat = n.sat;
		a.value.lum = n.lum;
		a.domElement.style.backgroundColor = "rgb(" + [n.red, n.green, n.blue].join(", ") + ")";
		this.setActiveNext();
		if ((o != false) && (typeof(this.onSave) == "function")) {
			this.onSave(n)
		}
	};
	this.clean = function() {
		var m = this.controllers.length,
			o;
		for (var n = 0; n < m; n++) {
			o = this.controllers[n];
			o.value = dhx4._copyObj(l);
			o.domElement.style.backgroundColor = "rgb(" + [l.red, l.green, l.blue].join(", ") + ")"
		}
		this.unSelect();
		a = this.controllers[0]
	};
	this.getIndex = function(o) {
		var n, m, q = -1;
		m = this.controllers.length;
		for (n = 0; n < m; n++) {
			if (this.controllers[n] == o) {
				q = n;
				break
			}
		}
		return q
	};
	this.remove = function() {
		var n, m;
		m = this.controllers.length;
		for (n = 0; n < m; n++) {
			if (typeof(window.addEventListener) == "function") {
				this.controllers[n].domElement.removeEventListener("click", this.select, false)
			} else {
				this.controllers[n].domElement.detachEvent("onclick", this.select)
			}
			delete this.controllers[n].domElement.dhxpc_memory
		}
		delete this.onSelect;
		delete this.controllers;
		delete this.onSave
	}
};
if (window.dhx4.isIE6) {
	dhtmlXColorPicker.prototype._cpInitFRM = function() {
		var a;
		if (!this._controllerNodes.fr_cover) {
			a = document.createElement("IFRAME");
			a.className = "dhxcp_frm";
			a.border = 0;
			a.frameBorder = 0;
			this._controllerNodes.fr_cover = a
		}
		if (!this.base._dhx_remove) {
			this.base.insertBefore(a, this._globalNode)
		}
	}
}

function dhtmlXSlider(c) {
	var a = this;
	this.conf = {
		size: null,
		skin: null,
		vertical: false,
		min: 0,
		max: 99,
		value: 0,
		step: 1,
		decimals: 0,
		margin: 2,
		border: 1,
		inverse: false,
		disabled: false,
		tooltip: false,
		visible: true,
		linkTo: undefined
	};
	this._attachedNode = {};
	this._movingInitialValues = null;
	this.base = null;
	if (arguments.length > 1) {
		return new dhtmlXSlider(this._renderArgumets(arguments))
	} else {
		if (typeof(c) == "string" || (typeof(c) == "object" && c.tagName)) {
			return new dhtmlXSlider({
				parent: c
			})
		}
	}
	if (typeof(c.parent) == "string") {
		this.base = document.getElementById(c.parent)
	} else {
		this.base = c.parent
	}
	this._mergeConfig(this._readAttFormNode(this.base));
	this._mergeConfig(c);
	this._detectDecimals();
	if (this.conf.size == null || this.conf.size == undefined) {
		if (this.conf.vertical) {
			this.conf.size = this.base.offsetHeight
		} else {
			this.conf.size = this.base.offsetWidth
		}
	}
	var g = this.conf.skin || window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhxslider") || "dhx_skyblue";
	this.setSkin(g);
	this.base.innerHTML = "<div class='dhxsl_container'><div class='dhxsl_track'></div><div class='dhxsl_runner'></div></div>";
	this._nodes = {
		cont: this.base.firstChild,
		track: this.base.firstChild.firstChild,
		runner: this.base.firstChild.childNodes[1]
	};
	this._nodes.cont.onmousedown = this._nodes.track.onmousedown = this._nodes.cont.onselectstart = this._nodes.track.onselectstart = function(l) {
		l = l || event;
		if (typeof(l.preventDefault) == "function") {
			l.preventDefault()
		} else {
			l.returnValue = false
		}
		return false
	};
	this.conf.value = this._normalize(this.conf.value);
	this._setOrient(this.conf.vertical);
	this.setSize(this.conf.size);
	this._initMover = function(m) {
		m = m || event;
		if (typeof(m.preventDefault) == "function") {
			m.preventDefault()
		}
		a._nodes.runner.className = "dhxsl_runner dhxsl_runner_actv";
		var l = (m.type == "mousedown" ? "client" : "page") + (a.conf.vertical ? "Y" : "X");
		a._movingInitialValues = {};
		a._movingInitialValues.value = a.conf.value;
		a._movingInitialValues.coord = (typeof(m[l]) != "undefined" ? m[l] : m.touches[0][l]);
		if (a.conf.disabled == false) {
			if (typeof(window.addEventListener) == "function") {
				window.addEventListener("mousemove", a._move, false);
				window.addEventListener("mouseup", a._cleanMove, false);
				window.addEventListener("touchmove", a._move, false);
				window.addEventListener("touchend", a._cleanMove, false)
			} else {
				document.body.attachEvent("onmousemove", a._move);
				document.body.attachEvent("onmouseup", a._cleanMove)
			}
		}
		a.callEvent("_onRunnerMouseDown", []);
		return false
	};
	this._move = function(r) {
		r = r || event;
		if (typeof(r.preventDefault) == "function") {
			r.preventDefault()
		}
		var o = (r.type == "mousemove" ? "client" : "page") + (a.conf.vertical ? "Y" : "X");
		var q = (a.conf.vertical) ? a._nodes.runner.offsetHeight : a._nodes.runner.offsetWidth;
		var m = a.conf.max - a.conf.min;
		var l = (typeof(r[o]) != "undefined" ? r[o] : r.touches[0][o]);
		var n = a._movingInitialValues.value + (l - a._movingInitialValues.coord) * m / (a.conf.size - q) * (a.conf.inverse ? -1 : 1);
		a.setValue(n, true)
	};
	this._cleanMove = function(l) {
		if (typeof(window.addEventListener) == "function") {
			window.removeEventListener("mousemove", a._move, false);
			window.removeEventListener("mouseup", a._cleanMove, false);
			window.removeEventListener("touchmove", a._move, false);
			window.removeEventListener("touchend", a._cleanMove, false)
		} else {
			document.body.detachEvent("onmousemove", a._move);
			document.body.detachEvent("onmouseup", a._cleanMove)
		}
		a._movingInitialValues = null;
		a._nodes.runner.className = a._nodes.runner.className.replace(/\s{0,}dhxsl_runner_actv/gi, "");
		a.callEvent("onSlideEnd", [a.conf.value]);
		a.callEvent("_onRunnerMouseUp", [])
	};
	this._doOnSetValue = function(q) {
		if (a._movingInitialValues != null) {
			return false
		}
		q = q || event;
		if (typeof(q.preventDefault) == "function") {
			q.preventDefault()
		}
		var o = (a.conf.vertical) ? (q.offsetY || q.layerY) : (q.offsetX || q.layerX);
		var n = (a.conf.vertical) ? a._nodes.runner.offoffsetHeightsetHe : a._nodes.runner.offsetWidth;
		var l = a.conf.max - a.conf.min;
		var m = o * l / (a.conf.size) + a.conf.min;
		a.setValue(m, true);
		if (a._movingInitialValues == null) {
			a._initMover(q)
		}
		return false
	};
	this._doOnChangeInput = function(m) {
		m = m || event;
		var l = m.target || m.srcElement;
		a.setValue(l.value)
	};
	this._doOnKeyDown = function(m) {
		m = m || event;
		var l = m.target || m.srcElement;
		if (m.keyCode == 13) {
			a.setValue(l.value)
		}
	};
	this._attachEvents(this._nodes);
	this.unload = function() {
		dhx4._eventable(this, "clear");
		this._detachNode();
		this._detachEvents(this._nodes);
		this.base.removeChild(this._nodes.cont);
		this._nodes.cont.onmousedown = this._nodes.track.onmousedown = this._nodes.cont.onselectstart = this._nodes.track.onselectstart = null;
		delete this._nodes.cont;
		delete this._nodes.track;
		delete this._nodes.max;
		delete this._nodes.min;
		delete this._nodes.runner;
		if (/\s?dhtmlxslider_\S*/.test(this.base.className)) {
			this.base.className = this.base.className.replace(/\s?dhtmlxslider_\S*/, "")
		}
		for (var l in this) {
			this[l] = null
		}
		a = null
	};
	dhx4._eventable(this);
	if (this.conf.disabled) {
		this.disable()
	}
	if (this.conf.tooltip) {
		this.enableTooltip()
	}
	if (!this.conf.visible) {
		this.hide()
	}
	if (this.conf.linkTo) {
		this.linkTo(this.conf.linkTo)
	}
	return this
}
dhtmlXSlider.prototype._setOrient = function(a) {
	a = a || false;
	if (/\s?dhxsl_cont_hr/i.test(this._nodes.cont.className)) {
		this._nodes.cont.className = this._nodes.cont.className.replace(/\s?dhxsl_cont_hr/i, "")
	}
	if (/\s?dhxsl_cont_vr/i.test(this._nodes.cont.className)) {
		this._nodes.cont.className = this._nodes.cont.className.replace(/\s?dhxsl_cont_vr/i, "")
	}
	if (a) {
		this._nodes.cont.className += " dhxsl_cont_vr"
	} else {
		this._nodes.cont.className += " dhxsl_cont_hr"
	}
};
dhtmlXSlider.prototype._attachEvents = function(a) {
	if (typeof(window.addEventListener) == "function") {
		a.runner.addEventListener("mousedown", this._initMover, false);
		a.runner.addEventListener("touchstart", this._initMover, false);
		a.cont.addEventListener("mousedown", this._doOnSetValue, false);
		a.cont.addEventListener("touchstart", this._doOnSetValue, false)
	} else {
		a.runner.attachEvent("onmousedown", this._initMover);
		a.cont.attachEvent("onmousedown", this._doOnSetValue)
	}
};
dhtmlXSlider.prototype._detachEvents = function(a) {
	if (typeof(window.addEventListener) == "function") {
		a.runner.removeEventListener("mousedown", this._initMover, false);
		a.runner.removeEventListener("touchstart", this._initMover, false);
		a.cont.removeEventListener("mousedown", this._doOnSetValue, false);
		a.cont.removeEventListener("touchstart", this._doOnSetValue, false)
	} else {
		a.runner.detachEvent("onmousedown", this._initMover);
		a.cont.detachEvent("onmousedown", this._doOnSetValue)
	}
};
dhtmlXSlider.prototype._mergeConfig = function(c) {
	for (var a in c) {
		switch (a.toLowerCase()) {
			case "min":
			case "max":
			case "size":
			case "step":
			case "value":
			case "inverse":
				this.conf[a] = c[a];
				break;
			case "tooltip":
			case "visible":
			case "vertical":
			case "disabled":
				this.conf[a] = dhx4.s2b(c[a]);
				break;
			case "parent":
				continue;
				break;
			default:
				this.conf[a] = c[a]
		}
	}
};
dhtmlXSlider.prototype._readAttFormNode = function(m) {
	var o = m.attributes,
		a = o.length,
		g, n = {},
		c;
	for (g = 0; g < a; g++) {
		c = o[g];
		switch (c.name.toLowerCase()) {
			case "size":
			case "min":
			case "max":
			case "value":
			case "step":
				n[c.name] = c.value;
				break;
			case "skin":
				n.skin = c.value;
				break;
			case "vertical":
			case "disabled":
			case "visible":
				n[c.name] = dhx4.s2b(c.value);
				break;
			case "linkto":
				n.linkTo = c.value;
				break;
			case "tooltip":
				n.tooltip = dhx4.s2b(c.value);
				break
		}
	}
	return n
};
dhtmlXSlider.prototype._renderArgumets = function(a) {
	var m = {},
		g, c;
	c = a.length;
	for (g = 0; g < c; g++) {
		switch (g) {
			case 0:
				m.parent = a[g];
				break;
			case 1:
				m.size = a[g];
				break;
			case 2:
				m.skin = a[g];
				break;
			case 3:
				m.vertical = a[g];
				break;
			case 4:
				m.min = a[g];
				break;
			case 5:
				m.max = a[g];
				break;
			case 6:
				m.value = a[g];
				break;
			case 7:
				m.step = a[g];
				break
		}
	}
	return m
};
dhtmlXSlider.prototype._skinCollection = {
	dhx_skyblue: true,
	dhx_web: true,
	dhx_terrace: true
};
dhtmlXSlider.prototype._indexOf = function(a, m) {
	var g, c, n = -1;
	c = a.length;
	for (g = c; g >= 0; g--) {
		if (a[g] == m) {
			n = g;
			break
		}
	}
	return n
};
dhtmlXSlider.prototype._refreshRunner = function() {
	var a, c;
	if (this.conf.vertical) {
		a = this._nodes.cont.offsetHeight - this._nodes.runner.offsetHeight;
		c = this._getCoord(a);
		this._nodes.runner.style.top = c + this.conf.border + "px";
		this._nodes.runner.style.left = Math.round((this._nodes.cont.offsetWidth - this._nodes.runner.offsetWidth) / 2) + "px"
	} else {
		a = this._nodes.cont.offsetWidth - this._nodes.runner.offsetWidth;
		c = this._getCoord(a);
		this._nodes.runner.style.left = c + this.conf.border + "px";
		this._nodes.runner.style.top = Math.round((this._nodes.cont.offsetHeight - this._nodes.runner.offsetHeight) / 2) + "px"
	}
};
dhtmlXSlider.prototype._setValueByCoord = function(l) {
	var a = dhx4.absLeft(this._nodes.cont),
		m = dhx4.absTop(this._nodes.cont),
		g, c;
	if (this.conf.vertical) {
		c = (l.y - m - this._nodes.runner.offsetHeight / 2) / (this._nodes.cont.offsetHeight - this._nodes.runner.offsetHeight)
	} else {
		c = (l.x - a - this._nodes.runner.offsetWidth / 2) / (this._nodes.cont.offsetWidth - this._nodes.runner.offsetWidth)
	}
	g = (this.conf.max - this.conf.min) * c + this.conf.min;
	this.setValue(g, true)
};
dhtmlXSlider.prototype._getCoord = function(a) {
	var g = (this.conf.inverse ? this._inverseValue(this.conf.value) : this.conf.value);
	var c = (g - this.conf.min) / (this.conf.max - this.conf.min);
	return Math.round(a * c)
};
dhtmlXSlider.prototype._normalize = function(c) {
	c = Number(c);
	c = Math.round(c / this.conf.step) * this.conf.step;
	var a = Math.pow(10, this.conf.decimals);
	c = Math.round(c * a) / a;
	c = Math.max(this.conf.min, Math.min(this.conf.max, c));
	return c
};
dhtmlXSlider.prototype._attachNode = function(c) {
	var a = c.tagName.toLowerCase();
	if (!a) {
		return
	}
	this._attachedNode.node = c;
	switch (a) {
		case "input":
		case "select":
			if (typeof(window.addEventListener) == "function") {
				c.addEventListener("change", this._doOnChangeInput, false);
				c.addEventListener("keydown", this._doOnKeyDown, false)
			} else {
				c.attachEvent("onchange", this._doOnChangeInput);
				c.attachEvent("onkeydown", this._doOnKeyDown)
			}
			this._attachedNode.setValue = function(n, g) {
				n = String(n);
				if (g > 0) {
					var l = n.match(/\.\d{1,}$/);
					if (l != null) {
						g = Math.max(g - l[0].length + 1)
					}
					n += (n.indexOf(".") < 0 ? "." : "");
					for (var m = 0; m < g; m++) {
						n += "0"
					}
				}
				this.node.value = n
			};
			break;
		default:
			this._attachedNode.setValue = function(g) {
				this.node.innerHTML = g
			}
	}
	this._attachedNode.setValue(this.conf.value, this.conf.decimals)
};
dhtmlXSlider.prototype._detachNode = function() {
	var c = this._attachedNode.node;
	if (!c) {
		return
	}
	var a = c.tagName;
	switch (a) {
		case "input":
		case "select":
			if (typeof(window.addEventListener) == "function") {
				c.removeEventListener("change", this._doOnChangeInput, false);
				c.removeEventListener("keydown", this._doOnChangeInput, false)
			} else {
				c.detachEvent("change", this._doOnChangeInput);
				c.detachEvent("keydown", this._doOnChangeInput)
			}
			break
	}
	delete this._attachedNode.node;
	delete this._attachedNode.setValue
};
dhtmlXSlider.prototype._detectDecimals = function() {
	var a = this.conf.step.toString().match(/\.(\d*)$/);
	this.conf.decimals = (a != null ? a[1].length : 0)
};
dhtmlXSlider.prototype.setSize = function(a) {
	if (!isNaN(a)) {
		if (this.conf.vertical) {
			if (this._nodes.cont.style.width) {
				delete this._nodes.cont.style.width
			}
			this._nodes.cont.style.height = a - this.conf.margin + "px"
		} else {
			if (this._nodes.cont.style.height) {
				delete this._nodes.cont.style.height
			}
			this._nodes.cont.style.width = a - this.conf.margin + "px"
		}
		this._refreshRunner()
	}
};
dhtmlXSlider.prototype.setSkin = function(m) {
	m = m.toLowerCase();
	var g, c = -1,
		a, l = "dhtmlxslider";
	g = this.base.className.match(/\S\w+/ig);
	if (g instanceof Array) {
		for (a in this._skinCollection) {
			if (c == -1) {
				c = this._indexOf(g, l + "_" + a)
			} else {
				break
			}
		}
		c = (c == -1) ? g.length : c
	} else {
		g = [];
		c = 0
	}
	g[c] = l + "_" + m;
	this.base.className = g.join(" ");
	this.conf.skin = m;
	if (this._nodes) {
		this._refreshRunner()
	}
};
dhtmlXSlider.prototype.setValue = function(a, c) {
	c = c || false;
	if (!isNaN(a)) {
		a = this._normalize(a);
		if (this.conf.value != a) {
			this.conf.value = a;
			this._refreshRunner();
			if (this.conf.tooltip) {
				this._nodes.cont.title = a
			}
			if (c) {
				this.callEvent("onChange", [a, this])
			}
		}
	}
	if (typeof(this._attachedNode.setValue) == "function") {
		this._attachedNode.setValue(this.conf.value, this.conf.decimals)
	}
};
dhtmlXSlider.prototype.getValue = function() {
	return this.conf.value
};
dhtmlXSlider.prototype._inverseValue = function() {
	return this.conf.max + this.conf.min - this.conf.value
};
dhtmlXSlider.prototype.disable = function(g) {
	g = (g == false) ? false : true;
	var c = null;
	if (g) {
		for (var a in this._nodes) {
			if (a == "cont") {
				continue
			}
			c = new RegExp("\\s?dhxsl_" + a + "_dis", "i");
			if (!c.test(this._nodes[a].className)) {
				this._nodes[a].className += " dhxsl_" + a + "_dis"
			}
		}
		this.conf.disabled = true
	} else {
		this.enable()
	}
};
dhtmlXSlider.prototype.enable = function() {
	var c;
	for (var a in this._nodes) {
		if (a == "cont") {
			continue
		}
		c = new RegExp("\\s?dhxsl_" + a + "_dis", "i");
		if (c.test(this._nodes[a].className)) {
			this._nodes[a].className = this._nodes[a].className.replace(c, "")
		}
	}
	this.conf.disabled = false
};
dhtmlXSlider.prototype.isEnabled = function() {
	return !this.conf.disabled
};
dhtmlXSlider.prototype.disableTooltip = function() {
	this._nodes.cont.removeAttribute("title");
	this.conf.tooltip = false
};
dhtmlXSlider.prototype.enableTooltip = function(a) {
	if (typeof(a) == "undefined") {
		a = true
	} else {
		a = dhx4.s2b(a)
	}
	if (a) {
		this._nodes.cont.title = this.conf.value;
		this.conf.tooltip = true
	} else {
		this.disableTooltip()
	}
};
dhtmlXSlider.prototype.setMax = function(a) {
	if (!isNaN(a) && this.conf.min < a) {
		this.conf.max = a;
		this.setValue(this.conf.value)
	}
};
dhtmlXSlider.prototype.getMax = function() {
	return this.conf.max
};
dhtmlXSlider.prototype.setMin = function(a) {
	if (!isNaN(a) && this.conf.max > a) {
		this.conf.min = a;
		this.setValue(this.conf.value)
	}
};
dhtmlXSlider.prototype.getMin = function() {
	return this.conf.min
};
dhtmlXSlider.prototype.setStep = function(a) {
	var c = this.conf.max - this.conf.min;
	if (!isNaN(a) && a < c) {
		this.conf.step = a;
		this._detectDecimals();
		this.setValue(this.conf.value)
	}
};
dhtmlXSlider.prototype.getStep = function() {
	return this.conf.step
};
dhtmlXSlider.prototype.show = function() {
	if (/\s?dhxsl_hidden/i.test(this._nodes.cont.className)) {
		this._nodes.cont.className = this._nodes.cont.className.replace(/\s?dhxsl_hidden/i, "")
	}
	this.conf.visible = true
};
dhtmlXSlider.prototype.hide = function() {
	if (!/\s?dhxsl_hidden/i.test(this._nodes.cont.className)) {
		this._nodes.cont.className += " dhxsl_hidden"
	}
	this.conf.visible = false
};
dhtmlXSlider.prototype.isVisible = function() {
	return this.conf.visible
};
dhtmlXSlider.prototype.linkTo = function(a) {
	if (typeof(a) == "string") {
		a = document.getElementById(a)
	}
	if (this._attachedNode.node) {
		this._detachNode()
	}
	this._attachNode(a)
};

function dhtmlXPopup(g) {
	var l = this;
	this.conf = g || {};
	g = null;
	this.mode = (this.conf.mode || "bottom");
	this.conf.zi = window.dhx4.newId();
	this.conf.context = (this.conf.context == null ? true : window.dhx4.s2b(this.conf.context));
	this.conf.IE6_display_fix = (this.conf.IE6_display_fix == null ? false : window.dhx4.s2b(this.conf.IE6_display_fix));
	this.conf.last_p_click = this.conf.last_body_click = null;
	this.p = document.createElement("DIV");
	this.p.style.display = "none";
	this.p.innerHTML = "<div class='dhx_popup_area" + (window.dhx4.isIE ? " dhx_popup_area_ie" : "") + "'><table cellspacing='0' cellpadding='0' border='0' class='dhx_popup_table'><tbody></tbody></table></div><div class='dhx_popup_arrow dhx_popup_arrow_" + this.mode + "'></div>";
	document.body.appendChild(this.p);
	this.p.oncontextmenu = function(a) {
		if (l.conf.context == false) {
			a = a || event;
			a.returnValue = false;
			return false
		}
	};
	this.skinParams = {
		dhx_terrace: {
			t0: 19,
			t1: 9,
			t2: 19,
			t3: 9
		},
		dhx_skyblue: {
			t0: 12,
			t1: 9,
			t2: 12,
			t3: 9
		},
		dhx_web: {
			t0: 12,
			t1: 9,
			t2: 12,
			t3: 9
		}
	};
	this.p.ontouchstart = this.p.onclick = function(n) {
		n = n || event;
		var m = (l.conf.last_p_click != null && l.conf.last_p_click != n.type);
		l.conf.last_p_click = n.type;
		if (m == true) {
			return
		}
		l._clearClick = true;
		if (l._nodeObj != null) {
			l.callEvent("onContentClick", []);
			return true
		}
		var a = (n.target || n.srcElement);
		var o = null;
		while (a != l.p && a != null) {
			if (typeof(a._idd) != "undefined" && !a._isSeparator) {
				o = a._idd;
				a = null
			} else {
				a = a.parentNode
			}
		}
		a = null;
		if (o != null) {
			l.callEvent("onClick", [o]);
			if (l != null && l.isVisible != null && l.isVisible() && l.callEvent("onBeforeHide", ["select", n, o]) === true) {
				n.cancelBubble = true;
				l.hide()
			}
		}
	};
	this.separator = "DHXSEP_" + window.dhx4.newId();
	this.tpl = [];
	this._setTemplate = function(a) {
		this.tpl = a.split(",")
	};
	this.show = function(m) {
		var a = null;
		if (arguments.length == 1) {
			if (!m) {
				m = this.conf.id[0]
			} else {
				if (!this._idExists(m)) {
					return
				}
			}
			if (this.conf.toolbar) {
				a = this.conf.toolbar._getItemDim(m)
			}
			if (this.conf.ribbon) {
				a = this.conf.ribbon._getItemDim(m)
			}
			if (this.conf.form) {
				a = this.conf.form._getItemDim(m)
			}
		} else {
			if (arguments.length == 4) {
				this._clearClick = true;
				a = {
					left: arguments[0],
					top: arguments[1],
					width: arguments[2],
					height: arguments[3]
				};
				m = null
			}
		}
		if (!a) {
			return
		}
		this.p.style.visibility = "hidden";
		this.p.style.display = "";
		this._setPos(a);
		this.p.style.zIndex = window.dhx4.zim.reserve(this.conf.zi);
		this.p.style.visibility = "visible";
		this._lastId = m;
		this.callEvent("onShow", [m])
	};
	this._setPos = function(J, o) {
		var A = J.left;
		var u = J.top;
		var D = J.width;
		var M = J.height;
		this._posData = {
			left: A,
			top: u,
			width: D,
			height: M
		};
		var O = window.dhx4.screenDim();
		var H = o || this.mode;
		if (typeof(o) == "undefined") {
			o = false
		}
		var Q = {
			top: (u - this.p.offsetHeight) - O.top,
			bottom: O.bottom - (u + M + this.p.offsetHeight),
			left: A - this.p.offsetWidth - O.left,
			right: O.right - (A + D + this.p.offsetWidth)
		};
		if (!o && Q[H] < 0) {
			var K = this._getAvailPos(H, Q);
			if (K !== false) {
				this._setPos(J, K);
				return
			}
		}
		if (H == "top" || H == "bottom") {
			var E = this.skinParams[this.conf.skin].t2;
			var C = this.skinParams[this.conf.skin].t3;
			var s = Math.round(this.p.offsetWidth / 2);
			var a = Math.round(this.p.lastChild.offsetWidth / 2);
			if (A < O.left) {
				var N = Math.min(A + D, O.left);
				D = A + D - N;
				A = N
			}
			if (A + D > O.right) {
				D = O.right - A
			}
			var v = Math.round(A + D / 2);
			var n = v - s;
			var L = v - E - a;
			var r = v + a + E - this.p.offsetWidth;
			if (n < O.left - C) {
				n = Math.min(O.left - C, L)
			} else {
				if (n + this.p.offsetWidth > O.right + C) {
					n = Math.max(r, O.right + C - this.p.offsetWidth)
				}
			}
			this.p.style.left = n + "px";
			this.p.style.top = (H == "top" ? u - this.p.offsetHeight : u + M) + "px";
			v = v - n - a;
			this.p.lastChild.className = "dhx_popup_arrow dhx_popup_arrow_" + H;
			this.p.lastChild.style.top = (H == "top" ? this.p.offsetHeight - this.p.lastChild.offsetHeight : 0) + "px";
			this.p.lastChild.style.left = v + "px"
		}
		if (H == "left" || H == "right") {
			var E = this.skinParams[this.conf.skin].t0;
			var C = this.skinParams[this.conf.skin].t1;
			var q = Math.round(this.p.offsetHeight / 2);
			var T = Math.round(this.p.lastChild.offsetHeight / 2);
			if (u < O.top) {
				var m = Math.min(u + M, O.top);
				M = u + M - m;
				u = m
			}
			if (u + M > O.bottom) {
				M = O.bottom - u
			}
			var v = Math.round(u + M / 2);
			var I = v - q;
			var S = v - E - T;
			var P = v + T + E - this.p.offsetHeight;
			if (I < O.top - C) {
				I = Math.min(O.top - C, S)
			} else {
				if (I + this.p.offsetHeight > O.bottom + C) {
					I = Math.max(P, O.bottom + C - this.p.offsetHeight)
				}
			}
			this.p.style.left = (H == "left" ? A - this.p.offsetWidth : A + D) + "px";
			this.p.style.top = I + "px";
			v = v - I - T;
			this.p.lastChild.className = "dhx_popup_arrow dhx_popup_arrow_" + H;
			this.p.lastChild.style.left = (H == "left" ? this.p.offsetWidth - this.p.lastChild.offsetWidth : 0) + "px";
			this.p.lastChild.style.top = v + "px"
		}
		if (this._IEDisp && this._nodeId != null) {
			var F = document.getElementById(this._nodeId);
			if (this.conf.IE6_display_fix == true) {
				F.style.visibility = "hidden"
			}
			window.setTimeout(function() {
				F.style.visibility = "visible";
				F = null
			}, 1)
		}
	};
	this._getAvailPos = function(u, s) {
		var n = {
			top: ["bottom", "right", "left"],
			bottom: ["top", "right", "left"],
			left: ["right", "bottom", "top"],
			right: ["left", "bottom", "top"]
		};
		var o = null;
		for (var r = 0; r < n[u].length; r++) {
			if (o == null && s[n[u][r]] > 0) {
				o = n[u][r]
			}
		}
		if (o == null) {
			o = "bottom";
			for (var m in s) {
				if (s[m] > s[o]) {
					o = m
				}
			}
		}
		if (o == u) {
			return false
		}
		return o
	};
	this._repaint = function() {
		if (this.isVisible()) {
			this._setPos(this._posData)
		}
	};
	this.clear = function() {
		if (this._nodeObj) {
			if (window.dhx4.isIE && typeof(window.dhtmlXLayoutObject) != "undefined" && this._nodeObj instanceof dhtmlXLayoutObject) {
				this.p.onmousedown = null
			}
			if (this._nodeObj.unload) {
				this._nodeObj.unload()
			} else {
				if (this._nodeObj.destruct) {
					this._nodeObj.destruct()
				}
			}
			this._nodeObj = this._nodeId = null;
			if (this._nodeObjEv != null) {
				for (var m = 0; m < this._nodeObjEv.length; m++) {
					this.detachEvent(this._nodeObjEv[m])
				}
				this._nodeObjEv = null
			}
		}
		if (this._IEHoverInited) {
			this._IEHoverClear()
		}
		var a = this.p.firstChild.firstChild.firstChild;
		while (a.childNodes.length > 0) {
			a.removeChild(a.lastChild)
		}
		a = null;
		this.itemData = {}
	};
	this.hide = function() {
		if (this.p.style.display != "none") {
			this.p.style.display = "none";
			window.dhx4.zim.clear(this.conf.zi);
			var a = this._lastId;
			this._lastId = null;
			this.callEvent("onHide", [a]);
			this.conf.last_p_click = this.conf.last_body_click = null
		}
	};
	this.isVisible = function() {
		return (this.p.style.display == "")
	};
	this.itemData = {};
	this.getItemData = function(a) {
		if (!a) {
			return this.itemData
		}
		if (this.itemData[a]) {
			return this.itemData[a]
		}
		return {}
	};
	this.setSkin = function(a) {
		this.conf.skin = a;
		this.p.className = "dhx_popup_" + this.conf.skin;
		if (this._nodeObj != null && typeof(this._nodeObj.setSkin) == "function") {
			this._nodeObj.setSkin(this.conf.skin)
		}
		this._repaint()
	};
	this.attachList = function(n, v) {
		this._setTemplate(n);
		this.clear();
		var o = this.p.firstChild.firstChild.firstChild;
		for (var u = 0; u < v.length; u++) {
			var s = document.createElement("TR");
			if (v[u] != this.separator) {
				if (typeof(v[u].id) == "undefined" || v[u].id == null) {
					s._idd = window.dhx4.newId();
					while (this.itemData[s._idd] != null) {
						s._idd = window.dhx4.newId()
					}
				} else {
					s._idd = v[u].id
				}
				this.itemData[s._idd] = v[u]
			}
			o.appendChild(s);
			if (v[u] == this.separator) {
				s.className = "dhx_popup_sep";
				s._isSeparator = true;
				var x = document.createElement("TD");
				x.className = "dhx_popup_sep";
				x.colSpan = this.tpl.length;
				x.innerHTML = "<div class='dhx_popup_sep'>&nbsp;</div>";
				s.appendChild(x);
				x = null
			} else {
				for (var a = 0; a < this.tpl.length; a++) {
					var m = "dhx_popup_td";
					if (this._IEFirstLast && (this.tpl.length == 1 || a == 0 || a == this.tpl.length - 1)) {
						if (this.tpl.length == 1) {
							m += " dhx_popup_td_single"
						} else {
							m += (a == 0 ? " dhx_popup_td_first" : " dhx_popup_td_last")
						}
					}
					var x = document.createElement("TD");
					x.className = m;
					x.innerHTML = v[u][this.tpl[a]] || "&nbsp;";
					s.appendChild(x);
					x = null
				}
				if (this._IEHover) {
					s._IEHover = true;
					if (!this._IEHoverInited) {
						this._IEHoverInit()
					}
				}
			}
			s = null
		}
		o = null;
		this._repaint()
	};
	this._attachNode = function(o, n) {
		this.clear();
		this._nodeId = "dhxpopup_node_" + window.dhx4.newId();
		var a = this.p.firstChild.firstChild.firstChild;
		var m = document.createElement("TR");
		m.className = "dhxnode";
		a.appendChild(m);
		var q = document.createElement("TD");
		q.className = "dhx_popup_td";
		q.innerHTML = "<div id='" + this._nodeId + "' style='position:relative;'></div>";
		if (n.width) {
			q.firstChild.style.width = n.width + "px"
		}
		if (n.height) {
			q.firstChild.style.height = n.height + "px"
		}
		m.appendChild(q);
		q = m = a = null;
		if (typeof(this["_attach_init_" + o]) == "function") {
			this["_attach_init_" + o](n);
			this._enableIEVFix()
		}
		this._repaint();
		return this._nodeObj
	};
	this.unload = function() {
		if (typeof(window.addEventListener) == "function") {
			window.removeEventListener("touchstart", this._doOnClick, false);
			window.removeEventListener("click", this._doOnClick, false);
			window.removeEventListener("keyup", this._doOnKeyUp, false);
			window.removeEventListener("unload", this._doOnUnload, false)
		} else {
			document.body.detachEvent("onclick", this._doOnClick, false);
			document.body.detachEvent("onkeyup", this._doOnKeyUp, false);
			document.body.detachEvent("onunload", this._doOnUnload, false)
		}
		this.clear();
		if (this.conf.toolbarEvent != null && this.conf.toolbar != null) {
			if (this.conf.toolbar.detachEvent != null) {
				this.conf.toolbar.detachEvent(this.conf.toolbarEvent)
			} else {
				this.conf.toolbar._getItemDim = null
			}
		}
		if (this.conf.ribbonEvent != null && this.conf.ribbon != null) {
			if (this.conf.ribbon.detachEvent != null) {
				this.conf.ribbon.detachEvent(this.conf.ribbonEvent)
			} else {
				this.conf.ribbon._getItemDim = null
			}
		}
		if (this.conf.slider != null) {
			for (var n = 0; n < this.conf.slider_events.length; n++) {
				this.conf.slider.detachEvent(this.conf.slider_events[n])
			}
			this.conf.slider_events = null;
			this._sliderShow = this._sliderHide = null;
			this.conf.slider = null
		}
		window.dhx4._eventable(this, "clear");
		this.p.onclick = this.p.ontouchstart = this.p.oncontextmenu = null;
		this.p.parentNode.removeChild(this.p);
		this.p = null;
		for (var m in this.conf) {
			this.conf[m] = null
		}
		for (var m in this) {
			this[m] = null
		}
		l = null
	};
	window.dhx4._eventable(this);
	this._doOnClick = function(u) {
		u = u || event;
		var a = (l.conf.last_body_click != null && l.conf.last_body_click != u.type);
		l.conf.last_body_click = u.type;
		if (a == true) {
			return
		}
		if (l._clearClick == true) {
			l._clearClick = false;
			return
		}
		if (l.conf.form != null) {
			var n;
			var v = (u.target || u.srcElement);
			if ((v.tagName || "").toLowerCase() == "option") {
				v = v.parentNode
			}
			if (v.className != null && v.className.search("dhxform") >= 0) {
				if (v.parentNode != null && v.parentNode.parentNode != null && v.parentNode.parentNode._idd != null) {
					n = v.parentNode.parentNode._idd;
					if (v.parentNode.parentNode._type == "ra") {
						n = [v.parentNode.parentNode._group, v.parentNode.parentNode._value]
					}
				}
			} else {
				var q = true;
				var s = false;
				while (q && !s) {
					var o = (v.className || "").toLowerCase();
					if (o.length > 0) {
						s = (o == "dhxform_btn" || o.search(/dhxeditor_inside/gi) >= 0 || o == "dhxcombo_input" || o.search(/dhxcombolist/gi) >= 0)
					}
					v = v.parentNode;
					q = (v != null)
				}
				if (s) {
					return
				}
			}
			v = null;
			if (n != null && l._idExists(n)) {
				return
			}
		}
		if (typeof(window.dhtmlXForm) != "undefined" && l._nodeObj instanceof window.dhtmlXForm) {
			var w = {};
			var o = 0;
			var m = l._nodeObj;
			m.forEachItem(function(r) {
				if (m.getItemType(r) == "combo") {
					w[m.getCombo(r).list._listId] = true;
					o++
				}
			});
			m = null;
			if (o > 0) {
				var v = (u.target || u.srcElement);
				var q = true;
				var s = false;
				while (q == true && s != true) {
					var o = (v.className || "").toLowerCase();
					if (o.length > 0 && o.search(/^dhxcombolist/gi) >= 0 && v._listId != null && w[v._listId] == true) {
						s = true;
						v = null
					} else {
						v = v.parentNode;
						q = (v != null)
					}
				}
				if (s == true) {
					return
				}
			}
		}
		if (l.isVisible() && l.callEvent("onBeforeHide", ["click", u]) === true) {
			l.hide()
		}
	};
	this._doOnKeyUp = function(a) {
		a = a || event;
		if (a.keyCode == 27) {
			if (l.isVisible() && l.callEvent("onBeforeHide", ["esc", a]) === true) {
				l.hide()
			}
		}
	};
	this._doOnUnload = function() {
		l.unload()
	};
	if (typeof(window.addEventListener) == "function") {
		window.addEventListener("touchstart", this._doOnClick, false);
		window.addEventListener("click", this._doOnClick, false);
		window.addEventListener("keyup", this._doOnKeyUp, false);
		window.addEventListener("unload", this._doOnUnload, false)
	} else {
		document.body.attachEvent("onclick", this._doOnClick, false);
		document.body.attachEvent("onkeyup", this._doOnKeyUp, false);
		document.body.attachEvent("onunload", this._doOnUnload, false)
	}
	this._idExists = function(n) {
		var a = false;
		for (var m = 0; m < this.conf.id.length; m++) {
			if (this.conf.id[m] instanceof Array) {
				a = a || (this.conf.id[m][0] == n[0] && this.conf.id[m][1] == n[1])
			} else {
				a = a || this.conf.id[m] == n
			}
		}
		return a
	};
	this._IEDisp = (window.dhx4.isIE6 || document.compatMode != "CSS1Compat");
	this._IEHover = (window.dhx4.isIE6 == true);
	if (this._IEHover) {
		this._IEHoverInit = function() {
			this.p.onmouseover = function() {
				var a = event.srcElement;
				while (a != this && a._IEHover != true) {
					a = a.parentNode
				}
				if (a._IEHover) {
					if (l._IEHoverTM) {
						window.clearTimeout(l._IEHoverTM)
					}
					if (l._lastIEHover == a) {
						return
					}
					l._IEHoverRender(a);
					a = null
				}
			};
			this.p.onmouseout = function() {
				if (l._IEHoverTM) {
					window.clearTimeout(l._IEHoverTM)
				}
				l._IEHoverTM = window.setTimeout(function() {
					l._IEHoverRender(null)
				}, 1)
			};
			this._IEHoverRender = function(a) {
				if (this._lastIEHover != null) {
					if (this._lastIEHover.className.search(/tr_hover/gi) >= 0) {
						this._lastIEHover.className = this._lastIEHover.className.replace(/\s{0,}tr_hover/gi, "");
						this._lastIEHover = null
					}
				}
				if (a != null && a.className.search(/tr_hover/gi) < 0) {
					a.className += " tr_hover";
					l._lastIEHover = a
				}
			};
			this._IEHoverInited = true
		};
		this._IEHoverClear = function() {
			this.p.onmouseover = null;
			this.p.onmouseout = null;
			this._IEHoverInited = false
		}
	}
	this._IEFirstLast = (window.dhx4.isIE6 || window.dhx4.isIE7 || window.dhx4.isIE8);
	this._enableIEVFix = function() {
		if (window.dhx4.isIE6 || window.dhx4.isIE7) {
			var m = this.attachEvent("onHide", function() {
				document.getElementById(this._nodeId).style.visibility = "hidden"
			});
			var a = this.attachEvent("onShow", function() {
				document.getElementById(this._nodeId).style.visibility = "visible"
			});
			if (this._nodeObjEv == null) {
				this._nodeObjEv = []
			}
			this._nodeObjEv.push(m, a)
		}
	};
	if (typeof(window.dhtmlXToolbarObject) != "undefined" && this.conf.toolbar != null && this.conf.toolbar instanceof window.dhtmlXToolbarObject && this.conf.id != null) {
		if (!(this.conf.id instanceof Array)) {
			this.conf.id = [this.conf.id]
		}
		this.skinParent = this.conf.toolbar.conf.skin;
		this._doOnToolbarClick = function(m) {
			for (var a = 0; a < l.conf.id.length; a++) {
				if (m == l.conf.id[a]) {
					if (m != l._lastId) {
						l.show(m);
						l._clearClick = true
					}
				}
			}
		};
		if (typeof(dhtmlXToolbarObject.prototype._getItemDim) == "undefined") {
			dhtmlXToolbarObject.prototype._getItemDim = function(n) {
				var a = this.objPull[this.idPrefix + n];
				var m = {
					left: window.dhx4.absLeft(a.obj),
					top: window.dhx4.absTop(a.obj),
					width: a.obj.offsetWidth + (a.arw ? a.arw.offsetWidth : 0),
					height: a.obj.offsetHeight
				};
				a = null;
				return m
			}
		}
		this.conf.toolbarEvent = this.conf.toolbar.attachEvent("onClick", this._doOnToolbarClick)
	}
	if (typeof(window.dhtmlXRibbon) != "undefined" && this.conf.ribbon != null && this.conf.ribbon instanceof window.dhtmlXRibbon && this.conf.id != null) {
		if (!(this.conf.id instanceof Array)) {
			this.conf.id = [this.conf.id]
		}
		this.skinParent = this.conf.ribbon.conf.skin;
		this._doOnRibbonClick = function(m) {
			for (var a = 0; a < l.conf.id.length; a++) {
				if (m == l.conf.id[a]) {
					if (m != l._lastId) {
						l.show(m);
						l._clearClick = true
					}
				}
			}
		};
		if (typeof(dhtmlXRibbon.prototype._getItemDim) == "undefined") {
			dhtmlXRibbon.prototype._getItemDim = function(n) {
				var a = this._items[n].base;
				var m = {
					left: window.dhx4.absLeft(a),
					top: window.dhx4.absTop(a),
					width: a.offsetWidth,
					height: a.offsetHeight
				};
				a = null;
				return m
			}
		}
		this.conf.ribbonEvent = this.conf.ribbon.attachEvent("_showPopup", this._doOnRibbonClick)
	}
	if (typeof(window.dhtmlXForm) != "undefined" && this.conf.form != null && this.conf.form instanceof window.dhtmlXForm && this.conf.id != null) {
		if (!(this.conf.id instanceof Array)) {
			this.conf.id = [this.conf.id]
		}
		if (!this.conf.mode) {
			this.mode = "right"
		}
		this.skinParent = this.conf.form.skin;
		if (typeof(dhtmlXForm.prototype._getItemDim) == "undefined") {
			dhtmlXForm.prototype._getItemDim = function(a, m) {
				return this.doWithItem(a, "_getDim")
			};
			for (var c in {
					input: 1,
					password: 1,
					select: 1,
					multiselect: 1,
					checkbox: 1,
					radio: 1,
					button: 1,
					combo: 1,
					btn2state: 1,
					calendar: 1,
					colorpicker: 1,
					editor: 1
				}) {
				if (dhtmlXForm.prototype.items[c] != null) {
					dhtmlXForm.prototype.items[c]._getDim = function(m) {
						var a = m;
						if ({
								ta: true,
								pw: true,
								se: true,
								calendar: true,
								colorpicker: 1,
								editor: true
							}[m._type]) {
							a = m.childNodes[m._ll ? 1 : 0].childNodes[0]
						}
						if ({
								ch: true,
								ra: true,
								btn2state: true
							}[m._type]) {
							a = m.childNodes[m._ll ? 1 : 0].childNodes[1]
						}
						if ({
								bt: true
							}[m._type]) {
							a = m.firstChild
						}
						if ({
								combo: true
							}[m._type]) {
							a = m._combo.DOMParent.firstChild
						}
						var n = {
							left: window.dhx4.absLeft(a),
							top: window.dhx4.absTop(a),
							width: a.offsetWidth,
							height: a.offsetHeight
						};
						a = null;
						return n
					}
				}
			}
		}
	}
	if (typeof(window.dhtmlXSlider) != "undefined" && this.conf.slider != null && this.conf.slider instanceof window.dhtmlXSlider) {
		if (!this.conf.mode) {
			this.mode = "top"
		}
		this.conf.slider_tm = null;
		this._sliderShow = function() {
			if (l.conf.slider_tm) {
				window.clearTimeout(l.conf.slider_tm)
			}
			var a = l.conf.slider._nodes.runner;
			var m = {
				left: window.dhx4.absLeft(a),
				top: window.dhx4.absTop(a),
				width: a.offsetWidth,
				height: a.offsetHeight
			};
			l.show(m.left, m.top, m.width, m.height)
		};
		this._sliderHide = function() {
			l.conf.slider_tm = window.setTimeout(function() {
				l.hide()
			}, 200)
		};
		this.conf.slider_events = [this.conf.slider.attachEvent("_onRunnerMouseDown", this._sliderShow), this.conf.slider.attachEvent("_onRunnerMouseUp", this._sliderHide), this.conf.slider.attachEvent("onChange", this._sliderShow)]
	}
	this.setSkin(this.skinParent || this.conf.skin || window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhx_popup") || "dhx_skyblue");
	return this
}
dhtmlXPopup.prototype.attachObject = function(a) {
	return this._attachNode("object", {
		obj: a
	})
};
dhtmlXPopup.prototype._attach_init_object = function(a) {
	this._nodeObj = (typeof(a.obj) == "string" ? document.getElementById(a.obj) : a.obj);
	a.obj = null;
	document.getElementById(this._nodeId).appendChild(this._nodeObj);
	this._nodeObj.style.display = "";
	this._nodeObj.style.visibility = "visible"
};
dhtmlXPopup.prototype.attachHTML = function(a) {
	return this._attachNode("html", {
		html: a
	})
};
dhtmlXPopup.prototype._attach_init_html = function(a) {
	document.getElementById(this._nodeId).innerHTML = a.html;
	this._nodeObj = {
		text: a.html
	}
};
dhtmlXPopup.prototype.attachForm = function(c, a) {
	return this._attachNode("form", {
		struct: c,
		width: a
	})
};
dhtmlXPopup.prototype._attach_init_form = function(c) {
	var a = this;
	this._nodeObj = new dhtmlXForm(this._nodeId, c.struct);
	this._nodeObj.setSkin(this.conf.skin);
	this._nodeObj.attachEvent("_onBeforeEditorAccess", function() {
		a._clearClick = true
	});
	if (this.conf.editorEv != null && this.checkEvent(this.conf.editorEv) == false) {
		this.conf.editorEv = null
	}
	if (dhtmlXForm.prototype.items.editor != null && this.conf.editorEv == null) {
		this.conf.editorEv = this.attachEvent("onShow", function() {
			var m = dhtmlXForm.prototype.items.editor.editor;
			for (var g in m) {
				var n = m[g].base;
				var l = false;
				while (n != null) {
					if (n == this.p) {
						l = true;
						n = null
					} else {
						n = n.parentNode
					}
				}
				n = null;
				if (l == true) {
					m[g].cell.conf.cells_cont = null;
					m[g].setSizes()
				}
			}
			m = null;
			this.detachEvent(this.conf.editorEv);
			this.conf.editorEv = null
		});
		if (this._nodeObjEv == null) {
			this._nodeObjEv = []
		}
		this._nodeObjEv.push(this.conf.editorEv)
	}
};
dhtmlXPopup.prototype.attachCalendar = function() {
	return this._attachNode("calendar", {})
};
dhtmlXPopup.prototype._attach_init_calendar = function(a) {
	this._nodeObj = new dhtmlXCalendarObject(this._nodeId);
	this._nodeObj.setSkin(this.conf.skin);
	this._nodeObj.show()
};
dhtmlXPopup.prototype.attachGrid = function(c, a) {
	return this._attachNode("grid", {
		width: c || 400,
		height: a || 200
	})
};
dhtmlXPopup.prototype._attach_init_grid = function() {
	this._nodeObj = new dhtmlXGridObject(this._nodeId);
	this._nodeObj.setSkin(this.conf.skin)
};
dhtmlXPopup.prototype.attachTree = function(g, c, a) {
	return this._attachNode("tree", {
		width: g || 400,
		height: c || 200,
		rootId: a || 0
	})
};
dhtmlXPopup.prototype._attach_init_tree = function(a) {
	this._nodeObj = new dhtmlXTreeObject(this._nodeId, "100%", "100%", (a.rootId))
};
dhtmlXPopup.prototype.attachLayout = function(c, a, g) {
	return this._attachNode("layout", {
		width: c || 400,
		height: a || 200,
		pattern: g || "3L"
	})
};
dhtmlXPopup.prototype._attach_init_layout = function(a) {
	this._nodeObj = new dhtmlXLayoutObject(this._nodeId, a.pattern, this.conf.skin)
};
dhtmlXPopup.prototype.attachAccordion = function(g, a, c) {
	return this._attachNode("accordion", {
		width: g || 400,
		height: a || 200,
		conf: c || {}
	})
};
dhtmlXPopup.prototype._attach_init_accordion = function(a) {
	a.conf.parent = this._nodeId;
	a.conf.skin = this.conf.skin;
	this._nodeObj = new dhtmlXAccordion(a.conf)
};
dhtmlXPopup.prototype.attachTabbar = function(g, a, c) {
	if (typeof(c) == "string") {
		c = {
			mode: c
		}
	} else {
		if (typeof(c) != "object" || c == null) {
			c = {}
		}
	}
	return this._attachNode("tabbar", {
		width: g || 400,
		height: a || 200,
		conf: c
	})
};
dhtmlXPopup.prototype._attach_init_tabbar = function(a) {
	a.conf.parent = this._nodeId;
	a.conf.skin = this.conf.skin;
	this._nodeObj = new dhtmlXTabBar(a.conf)
};
dhtmlXPopup.prototype.attachSidebar = function(g, a, c) {
	if (c == null) {
		c = {}
	}
	return this._attachNode("tabbar", {
		width: g || 400,
		height: a || 200,
		conf: c
	})
};
dhtmlXPopup.prototype._attach_init_tabbar = function(a) {
	a.conf.parent = this._nodeId;
	a.conf.skin = this.conf.skin;
	this._nodeObj = new dhtmlXSideBar(a.conf)
};
dhtmlXPopup.prototype.attachEditor = function(g, a, c) {
	return this._attachNode("editor", {
		width: g || 400,
		height: a || 200,
		conf: c || {}
	})
};
dhtmlXPopup.prototype._attach_init_editor = function(c) {
	document.getElementById(this._nodeId).className = "dhxeditor_" + this.conf.skin;
	c.conf.parent = this._nodeId;
	if (c.conf.skin == null) {
		c.conf.skin = this.conf.skin
	}
	this._nodeObj = new dhtmlXEditor(c.conf);
	var a = this.attachEvent("onShow", function() {
		if (this._nodeObj instanceof window.dhtmlXEditor) {
			this._nodeObj.setSizes()
		}
	});
	if (this._nodeObjEv == null) {
		this._nodeObjEv = []
	}
	this._nodeObjEv.push(a)
};
dhtmlXPopup.prototype.attachColorPicker = function(a) {
	if (typeof(a) != "object" || a == null) {
		a = {}
	}
	return this._attachNode("colorpicker", {
		conf: a
	})
};
dhtmlXPopup.prototype._attach_init_colorpicker = function(a) {
	a.conf.skin = this.conf.skin;
	a.conf.parent = this._nodeId;
	this._nodeObj = new dhtmlXColorPicker(a.conf)
};

function dhtmlXMenuObject(m, n) {
	var l = this;
	this.conf = {
		skin: (n || window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhxmenu") || "dhx_skyblue"),
		mode: "web",
		align: "left",
		is_touched: false,
		selected: -1,
		last_click: -1,
		fixed_pos: false,
		rtl: false,
		icons_path: "",
		arrow_ff_fix: (navigator.userAgent.indexOf("MSIE") >= 0 && document.compatMode == "BackCompat"),
		live_id: window.dhx4.newId(),
		tags: {
			root: "menu",
			item: "item",
			text_ext: "itemtext",
			userdata: "userdata",
			tooltip: "tooltip",
			hotkey: "hotkey",
			href: "href"
		},
		autoload: {},
		hide_tm: {},
		top_mode: true,
		top_tmtime: 200,
		v_enabled: false,
		v: {
			x1: null,
			x2: null,
			y1: null,
			y2: null
		},
		dir_toplv: "bottom",
		dir_sublv: "right",
		auto_overflow: false,
		overflow_limit: 0,
		of_utm: null,
		of_utime: 20,
		of_ustep: 3,
		of_dtm: null,
		of_dtime: 20,
		of_dstep: 3,
		tm_sec: 400,
		tm_handler: null,
		dload: false,
		dload_url: "",
		dload_icon: false,
		dload_params: {
			action: "loadMenu"
		},
		dload_pid: "parentId",
		tl_botmarg: 1,
		tl_rmarg: 0,
		tl_ofsleft: 1,
		context: false,
		ctx_zoneid: false,
		ctx_autoshow: true,
		ctx_autohide: true,
		ctx_hideall: true,
		ctx_zones: {},
		ctx_baseid: null,
		selected_sub: [],
		opened_poly: []
	};
	if (typeof(m) == "object" && m != null && typeof(m.tagName) == "undefined") {
		if (m.icons_path != null || m.icon_path != null) {
			this.conf.icons_path = (m.icons_path || m.icon_path)
		}
		if (m.skin != null) {
			this.conf.skin = m.skin
		}
		if (m.visible_area) {
			this.conf.v_enabled = true;
			this.conf.v = {
				x1: m.visible_area.x1,
				x2: m.visible_area.x2,
				y1: m.visible_area.y1,
				y2: m.visible_area.y2
			}
		}
		for (var g in {
				json: 1,
				xml: 1,
				items: 1,
				top_text: 1,
				align: 1,
				open_mode: 1,
				overflow: 1,
				dynamic: 1,
				dynamic_icon: 1,
				context: 1,
				onload: 1,
				onclick: 1,
				oncheckboxclick: 1,
				onradioclick: 1
			}) {
			if (m[g] != null) {
				this.conf.autoload[g] = m[g]
			}
		}
		m = m.parent
	}
	if (m == null) {
		this.base = document.body
	} else {
		var c = (typeof(m) == "string" ? document.getElementById(m) : m);
		if (c != null) {
			this.base = c;
			if (!this.base.id) {
				this.base.id = (new Date()).valueOf()
			}
			this.base.className += " dhtmlxMenu_" + this.conf.skin + "_Middle dir_left";
			this.base._autoSkinUpdate = true;
			if (this.base.oncontextmenu) {
				this.base._oldContextMenuHandler = this.base.oncontextmenu
			}
			this.conf.ctx_baseid = this.base.id;
			this.base.onselectstart = function(a) {
				a = a || event;
				if (a.preventDefault) {
					a.preventDefault()
				} else {
					a.returnValue = false
				}
				return false
			};
			this.base.oncontextmenu = function(a) {
				a = a || event;
				if (a.preventDefault) {
					a.preventDefault()
				} else {
					a.returnValue = false
				}
				return false
			}
		} else {
			this.base = document.body
		}
	}
	this.idPrefix = "";
	this.topId = "dhxWebMenuTopId";
	this.idPull = {};
	this.itemPull = {};
	this.userData = {};
	this.radio = {};
	this.setSkin = function(q) {
		var r = this.conf.skin;
		this.conf.skin = q;
		switch (this.conf.skin) {
			case "dhx_skyblue":
			case "dhx_web":
				this.conf.tl_botmarg = 2;
				this.conf.tl_rmarg = 1;
				this.conf.tl_ofsleft = 1;
				break;
			case "dhx_terrace":
				this.conf.tl_botmarg = 0;
				this.conf.tl_rmarg = 0;
				this.conf.tl_ofsleft = 0;
				break
		}
		if (this.base._autoSkinUpdate) {
			this.base.className = this.base.className.replace("dhtmlxMenu_" + r + "_Middle", "") + " dhtmlxMenu_" + this.conf.skin + "_Middle"
		}
		for (var o in this.idPull) {
			this.idPull[o].className = String(this.idPull[o].className).replace(r, this.conf.skin)
		}
	};
	this.setSkin(this.conf.skin);
	this._addSubItemToSelected = function(r, o) {
		var a = true;
		for (var s = 0; s < this.conf.selected_sub.length; s++) {
			if ((this.conf.selected_sub[s][0] == r) && (this.conf.selected_sub[s][1] == o)) {
				a = false
			}
		}
		if (a == true) {
			this.conf.selected_sub.push(new Array(r, o))
		}
		return a
	};
	this._removeSubItemFromSelected = function(s, r) {
		var a = new Array();
		var o = false;
		for (var u = 0; u < this.conf.selected_sub.length; u++) {
			if ((this.conf.selected_sub[u][0] == s) && (this.conf.selected_sub[u][1] == r)) {
				o = true
			} else {
				a[a.length] = this.conf.selected_sub[u]
			}
		}
		if (o == true) {
			this.conf.selected_sub = a
		}
		return o
	};
	this._getSubItemToDeselectByPolygon = function(s) {
		var a = new Array();
		for (var u = 0; u < this.conf.selected_sub.length; u++) {
			if (this.conf.selected_sub[u][1] == s) {
				a[a.length] = this.conf.selected_sub[u][0];
				a = a.concat(this._getSubItemToDeselectByPolygon(this.conf.selected_sub[u][0]));
				var r = true;
				for (var o = 0; o < this.conf.opened_poly.length; o++) {
					if (this.conf.opened_poly[o] == this.conf.selected_sub[u][0]) {
						r = false
					}
				}
				if (r == true) {
					this.conf.opened_poly[this.conf.opened_poly.length] = this.conf.selected_sub[u][0]
				}
				this.conf.selected_sub[u][0] = -1;
				this.conf.selected_sub[u][1] = -1
			}
		}
		return a
	};
	this._hidePolygon = function(a) {
		if (this.idPull["polygon_" + a] != null) {
			if (this.idPull["polygon_" + a]._zId != null) {
				window.dhx4.zim.clear(this.idPull["polygon_" + a]._zId)
			}
			if (typeof(this._menuEffect) != "undefined" && this._menuEffect !== false) {
				this._hidePolygonEffect("polygon_" + a)
			} else {
				if (this.idPull["polygon_" + a].style.display == "none") {
					return
				}
				this.idPull["polygon_" + a].style.display = "none";
				if (this.idPull["arrowup_" + a] != null) {
					this.idPull["arrowup_" + a].style.display = "none"
				}
				if (this.idPull["arrowdown_" + a] != null) {
					this.idPull["arrowdown_" + a].style.display = "none"
				}
				this._updateItemComplexState(a, true, false);
				if (window.dhx4.isIE6 && this.idPull["polygon_" + a + "_ie6cover"] != null) {
					this.idPull["polygon_" + a + "_ie6cover"].style.display = "none"
				}
			}
			a = String(a).replace(this.idPrefix, "");
			if (a == this.topId) {
				a = null
			}
			this.callEvent("onHide", [a]);
			if (a != null && this.conf.skin == "dhx_terrace" && this.itemPull[this.idPrefix + a].parent == this.idPrefix + this.topId) {
				this._improveTerraceButton(this.idPrefix + a, true)
			}
		}
	};
	this._showPolygon = function(J, q) {
		var O = this._countVisiblePolygonItems(J);
		if (O == 0) {
			return
		}
		var K = "polygon_" + J;
		if ((this.idPull[K] != null) && (this.idPull[J] != null)) {
			if (this.conf.top_mode && this.conf.mode == "web" && !this.conf.context) {
				if (!this.idPull[J]._mouseOver && q == this.conf.dir_toplv) {
					return
				}
			}
			if (!this.conf.fixed_pos) {
				this._autoDetectVisibleArea()
			}
			var L = 0;
			var N = 0;
			var Q = null;
			var F = null;
			if (this.idPull[K]._zId == null) {
				this.idPull[K]._zId = window.dhx4.newId()
			}
			this.idPull[K]._zInd = window.dhx4.zim.reserve(this.idPull[K]._zId);
			this.idPull[K].style.visibility = "hidden";
			this.idPull[K].style.left = "0px";
			this.idPull[K].style.top = "0px";
			this.idPull[K].style.display = "";
			this.idPull[K].style.zIndex = this.idPull[K]._zInd;
			if (this.conf.auto_overflow) {
				if (this.idPull[K].childNodes[1].childNodes[0].offsetHeight > this.conf.v.y1 + this.conf.v.y2) {
					var E = Math.floor((this.conf.v.y2 - this.conf.v.y1 - 35) / 24);
					this.conf.overflow_limit = E
				} else {
					this.conf.overflow_limit = 0;
					if (this.idPull["arrowup_" + J] != null) {
						this._removeUpArrow(String(J).replace(this.idPrefix, ""))
					}
					if (this.idPull["arrowdown_" + J] != null) {
						this._removeDownArrow(String(J).replace(this.idPrefix, ""))
					}
				}
			}
			if (this.conf.overflow_limit > 0 && this.conf.overflow_limit < O) {
				if (this.idPull["arrowup_" + J] == null) {
					this._addUpArrow(String(J).replace(this.idPrefix, ""))
				}
				if (this.idPull["arrowdown_" + J] == null) {
					this._addDownArrow(String(J).replace(this.idPrefix, ""))
				}
				Q = this.idPull["arrowup_" + J];
				Q.style.display = "none";
				F = this.idPull["arrowdown_" + J];
				F.style.display = "none"
			}
			if (this.conf.overflow_limit > 0) {
				if (this.conf.overflow_limit < O) {
					this.idPull[K].childNodes[1].style.height = 24 * this.conf.overflow_limit + "px";
					Q.style.width = F.style.width = this.idPull[K].childNodes[1].style.width = this.idPull[K].childNodes[1].childNodes[0].offsetWidth + "px";
					this.idPull[K].childNodes[1].scrollTop = 0;
					Q.style.display = "";
					L = Q.offsetHeight;
					F.style.display = "";
					N = F.offsetHeight
				} else {
					this.idPull[K].childNodes[1].style.height = "";
					this.idPull[K].childNodes[1].style.width = ""
				}
			}
			if (this.itemPull[J] != null) {
				var C = "polygon_" + this.itemPull[J]["parent"]
			} else {
				if (this.conf.context) {
					var C = this.idPull[this.idPrefix + this.topId]
				}
			}
			var a = (this.idPull[J].tagName != null ? window.dhx4.absLeft(this.idPull[J]) : this.idPull[J][0]);
			var P = (this.idPull[J].tagName != null ? window.dhx4.absTop(this.idPull[J]) : this.idPull[J][1]);
			var o = (this.idPull[J].tagName != null ? this.idPull[J].offsetWidth : 0);
			var r = (this.idPull[J].tagName != null ? this.idPull[J].offsetHeight : 0);
			var A = 0;
			var v = 0;
			var D = this.idPull[K].offsetWidth;
			var M = this.idPull[K].childNodes[1].offsetHeight + L + N;
			if (q == "bottom") {
				if (this.conf.rtl) {
					A = a + (o != null ? o : 0) - D
				} else {
					if (this.conf.align == "right") {
						A = a + o - D
					} else {
						A = a - 1 + (q == this.conf.dir_toplv ? this.conf.tl_rmarg : 0)
					}
				}
				v = P - 1 + r + this.conf.tl_botmarg
			}
			if (q == "right") {
				A = a + o - 1;
				v = P + 2
			}
			if (q == "left") {
				A = a - this.idPull[K].offsetWidth + 2;
				v = P + 2
			}
			if (q == "top") {
				A = a - 1;
				v = P - M + 2
			}
			if (this.conf.fixed_pos) {
				var I = 65536;
				var H = 65536
			} else {
				var I = (this.conf.v.x2 != null ? this.conf.v.x2 : 0);
				var H = (this.conf.v.y2 != null ? this.conf.v.y2 : 0);
				if (I == 0) {
					if (window.innerWidth) {
						I = window.innerWidth;
						H = window.innerHeight
					} else {
						I = document.body.offsetWidth;
						H = document.body.scrollHeight
					}
				}
			}
			if (A + D > I && !this.conf.rtl) {
				A = a - D + 2
			}
			if (A < this.conf.v.x1 && this.conf.rtl) {
				A = a + o - 2
			}
			if (A < 0) {
				A = 0
			}
			if (v + M > H && this.conf.v.y2 != null) {
				v = Math.max(P + r - M + 2, (this.conf.v_enabled ? this.conf.v.y1 + 2 : 2));
				if (this.conf.context && this.idPrefix + this.topId == J && F != null) {
					v = v - 2
				}
				if (this.itemPull[J] != null && !this.conf.context) {
					if (this.itemPull[J]["parent"] == this.idPrefix + this.topId) {
						v = v - this.base.offsetHeight
					}
				}
			}
			this.idPull[K].style.left = A + "px";
			this.idPull[K].style.top = v + "px";
			if (typeof(this._menuEffect) != "undefined" && this._menuEffect !== false) {
				this._showPolygonEffect(K)
			} else {
				this.idPull[K].style.visibility = "";
				if (this.conf.overflow_limit > 0 && this.conf.overflow_limit < O) {
					this.idPull[K].childNodes[1].scrollTop = 0;
					this._checkArrowsState(J)
				}
				if (window.dhx4.isIE6) {
					var u = K + "_ie6cover";
					if (this.idPull[u] == null) {
						var s = document.createElement("IFRAME");
						s.className = "dhtmlxMenu_IE6CoverFix_" + this.conf.skin;
						s.frameBorder = 0;
						s.setAttribute("src", "javascript:false;");
						document.body.insertBefore(s, document.body.firstChild);
						this.idPull[u] = s
					}
					this.idPull[u].style.left = A + "px";
					this.idPull[u].style.top = v + "px";
					this.idPull[u].style.width = this.idPull[K].offsetWidth + "px";
					this.idPull[u].style.height = this.idPull[K].offsetHeight + "px";
					this.idPull[u].style.zIndex = this.idPull[K].style.zIndex - 1;
					this.idPull[u].style.display = ""
				}
			}
			J = String(J).replace(this.idPrefix, "");
			if (J == this.topId) {
				J = null
			}
			this.callEvent("onShow", [J]);
			if (J != null && this.conf.skin == "dhx_terrace" && this.itemPull[this.idPrefix + J].parent == this.idPrefix + this.topId) {
				this._improveTerraceButton(this.idPrefix + J, false)
			}
		}
	};
	this._redistribSubLevelSelection = function(u, s) {
		while (this.conf.opened_poly.length > 0) {
			this.conf.opened_poly.pop()
		}
		var a = this._getSubItemToDeselectByPolygon(s);
		this._removeSubItemFromSelected(-1, -1);
		for (var o = 0; o < a.length; o++) {
			if ((this.idPull[a[o]] != null) && (a[o] != u)) {
				if (this.itemPull[a[o]]["state"] == "enabled") {
					this.idPull[a[o]].className = "sub_item"
				}
			}
		}
		for (var o = 0; o < this.conf.opened_poly.length; o++) {
			if (this.conf.opened_poly[o] != s) {
				this._hidePolygon(this.conf.opened_poly[o])
			}
		}
		if (this.itemPull[u]["state"] == "enabled") {
			this.idPull[u].className = "sub_item_selected";
			if (this.itemPull[u]["complex"] && this.conf.dload && (this.itemPull[u]["loaded"] == "no")) {
				if (this.conf.dload_icon == true) {
					this._updateLoaderIcon(u, true)
				}
				this.itemPull[u].loaded = "get";
				var r = u.replace(this.idPrefix, "");
				this._dhxdataload.onBeforeXLS = function() {
					var v = {
						params: {}
					};
					v.params[this.conf.dload_pid] = r;
					for (var q in this.conf.dload_params) {
						v.params[q] = this.conf.dload_params[q]
					}
					return v
				};
				this.loadStruct(this.conf.dload_url)
			}
			if (this.itemPull[u]["complex"] || (this.conf.dload && (this.itemPull[u]["loaded"] == "yes"))) {
				if ((this.itemPull[u]["complex"]) && (this.idPull["polygon_" + u] != null)) {
					this._updateItemComplexState(u, true, true);
					this._showPolygon(u, this.conf.dir_sublv)
				}
			}
			this._addSubItemToSelected(u, s);
			this.conf.selected = u
		}
	};
	this._doOnClick = function(o, y, s) {
		this.conf.last_click = o;
		if (this.itemPull[this.idPrefix + o]["href_link"] != null && this.itemPull[this.idPrefix + o].state == "enabled") {
			var u = document.createElement("FORM");
			var w = String(this.itemPull[this.idPrefix + o]["href_link"]).split("?");
			u.action = w[0];
			if (w[1] != null) {
				var r = String(w[1]).split("&");
				for (var a = 0; a < r.length; a++) {
					var x = String(r[a]).split("=");
					var v = document.createElement("INPUT");
					v.type = "hidden";
					v.name = (x[0] || "");
					v.value = (x[1] || "");
					u.appendChild(v)
				}
			}
			if (this.itemPull[this.idPrefix + o]["href_target"] != null) {
				u.target = this.itemPull[this.idPrefix + o]["href_target"]
			}
			u.style.display = "none";
			document.body.appendChild(u);
			u.submit();
			if (u != null) {
				document.body.removeChild(u);
				u = null
			}
			return
		}
		if (y.charAt(0) == "c") {
			return
		}
		if (y.charAt(1) == "d") {
			return
		}
		if (y.charAt(2) == "s") {
			return
		}
		if (this.checkEvent("onClick")) {
			this.callEvent("onClick", [o, this.conf.ctx_zoneid, s])
		} else {
			if ((y.charAt(1) == "d") || (this.conf.mode == "win" && y.charAt(2) == "t")) {
				return
			}
		}
		if (this.conf.context && this._isContextMenuVisible() && this.conf.ctx_autohide) {
			this._hideContextMenu()
		} else {
			if (this._clearAndHide) {
				this._clearAndHide()
			}
		}
	};
	this._doOnTouchMenu = function(a) {
		if (this.conf.is_touched == false) {
			this.conf.is_touched = true;
			if (this.checkEvent("onTouch")) {
				this.callEvent("onTouch", [a])
			}
		}
	};
	this._searchMenuNode = function(r, u) {
		var a = new Array();
		for (var s = 0; s < u.length; s++) {
			if (typeof(u[s]) == "object") {
				if (u[s].length == 5) {
					if (typeof(u[s][0]) != "object") {
						if ((u[s][0].replace(this.idPrefix, "") == r) && (s == 0)) {
							a = u
						}
					}
				}
				var o = this._searchMenuNode(r, u[s]);
				if (o.length > 0) {
					a = o
				}
			}
		}
		return a
	};
	this._getMenuNodes = function(r) {
		var o = new Array;
		for (var q in this.itemPull) {
			if (this.itemPull[q]["parent"] == r) {
				o[o.length] = q
			}
		}
		return o
	};
	this._genStr = function(a) {
		var o = "";
		var u = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
		for (var r = 0; r < a; r++) {
			o += u.charAt(Math.round(Math.random() * (u.length - 1)))
		}
		return o
	};
	this.getItemType = function(a) {
		a = this.idPrefix + a;
		if (this.itemPull[a] == null) {
			return null
		}
		return this.itemPull[a]["type"]
	};
	this.forEachItem = function(q) {
		for (var o in this.itemPull) {
			q(String(o).replace(this.idPrefix, ""))
		}
	};
	this._clearAndHide = function() {
		l.conf.selected = -1;
		l.conf.last_click = -1;
		while (l.conf.opened_poly.length > 0) {
			l.conf.opened_poly.pop()
		}
		for (var a = 0; a < l.conf.selected_sub.length; a++) {
			var o = l.conf.selected_sub[a][0];
			if (l.idPull[o] != null) {
				if (l.itemPull[o]["state"] == "enabled") {
					if (l.idPull[o].className == "sub_item_selected") {
						l.idPull[o].className = "sub_item"
					}
					if (l.idPull[o].className == "dhtmlxMenu_" + l.conf.skin + "_TopLevel_Item_Selected") {
						if (l.itemPull[o]["cssNormal"] != null) {
							l.idPull[o].className = l.itemPull[o]["cssNormal"]
						} else {
							l.idPull[o].className = "dhtmlxMenu_" + l.conf.skin + "_TopLevel_Item_Normal"
						}
					}
				}
			}
			l._hidePolygon(o)
		}
		l.conf.is_touched = false;
		if (l.conf.context && l.conf.ctx_hideall) {
			l._hidePolygon(l.idPrefix + l.topId)
		}
	};
	this._showSubLevelItem = function(o, a) {
		if (document.getElementById("arrow_" + this.idPrefix + o) != null) {
			document.getElementById("arrow_" + this.idPrefix + o).style.display = (a ? "none" : "")
		}
		if (document.getElementById("image_" + this.idPrefix + o) != null) {
			document.getElementById("image_" + this.idPrefix + o).style.display = (a ? "none" : "")
		}
		if (document.getElementById(this.idPrefix + o) != null) {
			document.getElementById(this.idPrefix + o).style.display = (a ? "" : "none")
		}
	};
	this._hideSubLevelItem = function(a) {
		this._showSubLevelItem(a, true)
	};
	this.idPrefix = this._genStr(12) + "_";
	this._bodyClick = function(a) {
		a = a || event;
		if (a.button == 2 || (window.dhx4.isOpera && a.ctrlKey == true)) {
			return
		}
		if (l.conf.context) {
			if (l.conf.ctx_autohide && (!window.dhx4.isOpera || (l._isContextMenuVisible() && window.dhx4.isOpera))) {
				l._hideContextMenu()
			}
		} else {
			if (l._clearAndHide) {
				l._clearAndHide()
			}
		}
	};
	this._bodyContext = function(q) {
		q = q || event;
		var o = String((q.srcElement || q.target).className);
		if (o.search("dhtmlxMenu") != -1 && o.search("SubLevelArea") != -1) {
			return
		}
		var a = true;
		var r = q.target || q.srcElement;
		while (r != null) {
			if (r.id != null) {
				if (l.isContextZone(r.id)) {
					a = false
				}
			}
			if (r == document.body) {
				a = false
			}
			r = r.parentNode
		}
		if (a) {
			l.hideContextMenu()
		}
	};
	if (typeof(window.addEventListener) != "undefined") {
		window.addEventListener("click", this._bodyClick, false);
		window.addEventListener("contextmenu", this._bodyContext, false)
	} else {
		document.body.attachEvent("onclick", this._bodyClick);
		document.body.attachEvent("oncontextmenu", this._bodyContext)
	}
	this.unload = function() {
		window.dhx4._eventable(this, "clear");
		dhtmlXMenuObject.prototype.liveInst[this.conf.live_id] = null;
		try {
			delete dhtmlXMenuObject.prototype.liveInst[this.conf.live_id]
		} catch (q) {}
		this.conf.live_id = null;
		if (typeof(window.addEventListener) == "function") {
			window.removeEventListener("click", this._bodyClick, false);
			window.removeEventListener("contextmenu", this._bodyContext, false)
		} else {
			document.body.detachEvent("onclick", this._bodyClick);
			document.body.detachEvent("oncontextmenu", this._bodyContext)
		}
		this._bodyClick = null;
		this._bodyContext = null;
		this.removeItem(this.idPrefix + this.topId, true);
		this.itemPull = null;
		this.idPull = null;
		if (this.conf.context) {
			for (var o in this.conf.ctx_zones) {
				this.removeContextZone(o)
			}
		}
		if (this.cont != null) {
			this.cont.className = "";
			this.cont.parentNode.removeChild(this.cont);
			this.cont = null
		}
		if (this.base != null) {
			if (!this.conf.context) {
				this.base.className = ""
			}
			if (!this.conf.context) {
				this.base.oncontextmenu = (this.base._oldContextMenuHandler || null)
			}
			this.base.onselectstart = null;
			this.base = null
		}
		for (var o in this) {
			this[o] = null
		}
		l = null
	};
	dhtmlXMenuObject.prototype.liveInst[this.conf.live_id] = this;
	window.dhx4._enableDataLoading(this, "_initObj", "_xmlToJson", this.conf.tags.root, {
		struct: true
	});
	window.dhx4._eventable(this);
	if (window.dhx4.s2b(this.conf.autoload.context) == true) {
		this.renderAsContextMenu()
	}
	if (this.conf.autoload.dynamic != null) {
		this.enableDynamicLoading(this.conf.autoload.dynamic, window.dhx4.s2b(this.conf.autoload.dynamic_icon))
	} else {
		if (this.conf.autoload.items != null) {
			this.loadStruct(this.conf.autoload.items, this.conf.autoload.onload)
		} else {
			if (this.conf.autoload.json != null) {
				this.loadStruct(this.conf.autoload.json, this.conf.autoload.onload)
			} else {
				if (this.conf.autoload.xml != null) {
					this.loadStruct(this.conf.autoload.xml, this.conf.autoload.onload)
				}
			}
		}
	}
	for (var g in {
			onclick: 1,
			oncheckboxclick: 1,
			onradioclick: 1
		}) {
		if (this.conf.autoload[g] != null) {
			if (typeof(this.conf.autoload[g]) == "function") {
				this.attachEvent(g, this.conf.autoload[g])
			} else {
				if (typeof(window[this.conf.autoload[g]]) == "function") {
					this.attachEvent(g, window[this.conf.autoload[g]])
				}
			}
		}
	}
	if (this.conf.autoload.top_text != null) {
		this.setTopText(this.conf.autoload.top_text)
	}
	if (this.conf.autoload.align != null) {
		this.setAlign(this.conf.autoload.align)
	}
	if (this.conf.autoload.open_mode != null) {
		this.setOpenMode(this.conf.autoload.open_mode)
	}
	if (this.conf.autoload.overflow != null) {
		this.setOverflowHeight(this.conf.autoload.overflow)
	}
	for (var g in this.conf.autoload) {
		this.conf.autoload[g] = null;
		delete this.conf.autoload[g]
	}
	this.conf.autoload = null;
	return this
}
dhtmlXMenuObject.prototype._init = function() {
	if (this._isInited == true) {
		return
	}
	if (this.conf.dload) {
		this._dhxdataload.onBeforeXLS = function() {
			var g = {
				params: {}
			};
			for (var c in this.conf.dload_params) {
				g.params[c] = this.conf.dload_params[c]
			}
			return g
		};
		this.loadStruct(this.conf.dload_url)
	} else {
		this._initTopLevelMenu();
		this._isInited = true
	}
};
dhtmlXMenuObject.prototype._countVisiblePolygonItems = function(n) {
	var l = 0;
	for (var c in this.itemPull) {
		var g = this.itemPull[c]["parent"];
		var m = this.itemPull[c]["type"];
		if (this.idPull[c] != null) {
			if (g == n && (m == "item" || m == "radio" || m == "checkbox") && this.idPull[c].style.display != "none") {
				l++
			}
		}
	}
	return l
};
dhtmlXMenuObject.prototype._redefineComplexState = function(c) {
	if (this.idPrefix + this.topId == c) {
		return
	}
	if ((this.idPull["polygon_" + c] != null) && (this.idPull[c] != null)) {
		var a = this._countVisiblePolygonItems(c);
		if ((a > 0) && (!this.itemPull[c]["complex"])) {
			this._updateItemComplexState(c, true, false)
		}
		if ((a == 0) && (this.itemPull[c]["complex"])) {
			this._updateItemComplexState(c, false, false)
		}
	}
};
dhtmlXMenuObject.prototype._updateItemComplexState = function(m, g, l) {
	if ((!this.conf.context) && (this._getItemLevelType(m.replace(this.idPrefix, "")) == "TopLevel")) {
		this.itemPull[m]["complex"] = g;
		return
	}
	if ((this.idPull[m] == null) || (this.itemPull[m] == null)) {
		return
	}
	this.itemPull[m]["complex"] = g;
	if (m == this.idPrefix + this.topId) {
		return
	}
	var a = null;
	var c = this.idPull[m].childNodes[this.conf.rtl ? 0 : 2];
	if (c.childNodes[0]) {
		if (String(c.childNodes[0].className).search("complex_arrow") === 0) {
			a = c.childNodes[0]
		}
	}
	if (this.itemPull[m]["complex"]) {
		if (a == null) {
			a = document.createElement("DIV");
			a.className = "complex_arrow";
			a.id = "arrow_" + m;
			while (c.childNodes.length > 0) {
				c.removeChild(c.childNodes[0])
			}
			c.appendChild(a)
		}
		if (this.conf.dload && (this.itemPull[m].loaded == "get") && this.conf.dload_icon) {
			if (a.className != "complex_arrow_loading") {
				a.className = "complex_arrow_loading"
			}
		} else {
			a.className = "complex_arrow"
		}
		return
	}
	if ((!this.itemPull[m]["complex"]) && (a != null)) {
		c.removeChild(a);
		if (this.itemPull[m]["hotkey_backup"] != null && this.setHotKey) {
			this.setHotKey(m.replace(this.idPrefix, ""), this.itemPull[m]["hotkey_backup"])
		}
	}
};
dhtmlXMenuObject.prototype._getItemLevelType = function(a) {
	return (this.itemPull[this.idPrefix + a]["parent"] == this.idPrefix + this.topId ? "TopLevel" : "SubLevelArea")
};
dhtmlXMenuObject.prototype.setIconsPath = function(a) {
	this.conf.icons_path = a
};
dhtmlXMenuObject.prototype._updateItemImage = function(g, l) {
	g = this.idPrefix + g;
	var r = this.itemPull[g]["type"];
	if (r == "checkbox" || r == "radio") {
		return
	}
	var m = (this.itemPull[g]["parent"] == this.idPrefix + this.topId && !this.conf.context);
	var n = null;
	if (m) {
		for (var a = 0; a < this.idPull[g].childNodes.length; a++) {
			try {
				if (this.idPull[g].childNodes[a].className == "dhtmlxMenu_TopLevel_Item_Icon") {
					n = this.idPull[g].childNodes[a]
				}
			} catch (o) {}
		}
	} else {
		try {
			var n = this.idPull[g].childNodes[this.conf.rtl ? 2 : 0].childNodes[0]
		} catch (o) {}
		if (!(n != null && typeof(n.className) != "undefined" && n.className == "sub_icon")) {
			n = null
		}
	}
	var u = this.itemPull[g][(this.itemPull[g]["state"] == "enabled" ? "imgen" : "imgdis")];
	if (u.length > 0) {
		if (n != null) {
			n.src = this.conf.icons_path + u
		} else {
			if (m) {
				var n = document.createElement("IMG");
				n.className = "dhtmlxMenu_TopLevel_Item_Icon";
				n.src = this.conf.icons_path + u;
				n.border = "0";
				n.id = "image_" + g;
				if (!this.conf.rtl && this.idPull[g].childNodes.length > 0) {
					this.idPull[g].insertBefore(n, this.idPull[g].childNodes[0])
				} else {
					this.idPull[g].appendChild(n)
				}
			} else {
				var n = document.createElement("IMG");
				n.className = "sub_icon";
				n.src = this.conf.icons_path + u;
				n.border = "0";
				n.id = "image_" + g;
				var s = this.idPull[g].childNodes[this.conf.rtl ? 2 : 0];
				while (s.childNodes.length > 0) {
					s.removeChild(s.childNodes[0])
				}
				s.appendChild(n)
			}
		}
	} else {
		if (n != null) {
			var c = n.parentNode;
			c.removeChild(n);
			c.innerHTML = "&nbsp;";
			c = n = null
		}
	}
};
dhtmlXMenuObject.prototype._getAllParents = function(n) {
	var g = new Array();
	for (var c in this.itemPull) {
		if (this.itemPull[c]["parent"] == n) {
			g[g.length] = this.itemPull[c]["id"];
			if (this.itemPull[c]["complex"]) {
				var l = this._getAllParents(this.itemPull[c]["id"]);
				for (var m = 0; m < l.length; m++) {
					g[g.length] = l[m]
				}
			}
		}
	}
	return g
};
dhtmlXMenuObject.prototype._autoDetectVisibleArea = function() {
	if (this.conf.v_enabled) {
		return
	}
	var a = window.dhx4.screenDim();
	this.conf.v.x1 = a.left;
	this.conf.v.x2 = a.right;
	this.conf.v.y1 = a.top;
	this.conf.v.y2 = a.bottom
};
dhtmlXMenuObject.prototype.getItemPosition = function(m) {
	m = this.idPrefix + m;
	var l = -1;
	if (this.itemPull[m] == null) {
		return l
	}
	var a = this.itemPull[m]["parent"];
	var g = (this.idPull["polygon_" + a] != null ? this.idPull["polygon_" + a].tbd : this.cont);
	for (var c = 0; c < g.childNodes.length; c++) {
		if (g.childNodes[c] == this.idPull["separator_" + m] || g.childNodes[c] == this.idPull[m]) {
			l = c
		}
	}
	return l
};
dhtmlXMenuObject.prototype.setItemPosition = function(o, n) {
	o = this.idPrefix + o;
	if (this.idPull[o] == null) {
		return
	}
	var c = (this.itemPull[o]["parent"] == this.idPrefix + this.topId);
	var a = this.idPull[o];
	var l = this.getItemPosition(o.replace(this.idPrefix, ""));
	var g = this.itemPull[o]["parent"];
	var m = (this.idPull["polygon_" + g] != null ? this.idPull["polygon_" + g].tbd : this.cont);
	m.removeChild(m.childNodes[l]);
	if (n < 0) {
		n = 0
	}
	if (c && n < 1) {
		n = 1
	}
	if (n < m.childNodes.length) {
		m.insertBefore(a, m.childNodes[n])
	} else {
		m.appendChild(a)
	}
};
dhtmlXMenuObject.prototype.getParentId = function(a) {
	a = this.idPrefix + a;
	if (this.itemPull[a] == null) {
		return null
	}
	return ((this.itemPull[a]["parent"] != null ? this.itemPull[a]["parent"] : this.topId).replace(this.idPrefix, ""))
};
dhtmlXMenuObject.prototype.hide = function() {
	this._clearAndHide()
};
dhtmlXMenuObject.prototype.clearAll = function() {
	this.removeItem(this.idPrefix + this.topId, true);
	this._isInited = false;
	this.idPrefix = this._genStr(12) + "_";
	this.itemPull = {}
};
if (typeof(dhtmlXMenuObject.prototype.liveInst) == "undefined") {
	dhtmlXMenuObject.prototype.liveInst = {}
}
dhtmlXMenuObject.prototype._redistribTopLevelSelection = function(l, c) {
	var a = this._getSubItemToDeselectByPolygon("parent");
	this._removeSubItemFromSelected(-1, -1);
	for (var g = 0; g < a.length; g++) {
		if (a[g] != l) {
			this._hidePolygon(a[g])
		}
		if ((this.idPull[a[g]] != null) && (a[g] != l)) {
			this.idPull[a[g]].className = this.idPull[a[g]].className.replace(/Selected/g, "Normal")
		}
	}
	if (this.itemPull[this.idPrefix + l]["state"] == "enabled") {
		this.idPull[this.idPrefix + l].className = "dhtmlxMenu_" + this.conf.skin + "_TopLevel_Item_Selected";
		this._addSubItemToSelected(this.idPrefix + l, "parent");
		this.conf.selected = (this.conf.mode == "win" ? (this.conf.selected != -1 ? l : this.conf.selected) : l);
		if ((this.itemPull[this.idPrefix + l]["complex"]) && (this.conf.selected != -1)) {
			this._showPolygon(this.idPrefix + l, this.conf.dir_toplv)
		}
	}
};
dhtmlXMenuObject.prototype._initTopLevelMenu = function() {
	this.conf.dir_toplv = "bottom";
	this.conf.dir_sublv = (this.conf.rtl ? "left" : "right");
	if (this.conf.context) {
		this.idPull[this.idPrefix + this.topId] = new Array(0, 0);
		this._addSubMenuPolygon(this.idPrefix + this.topId, this.idPrefix + this.topId)
	} else {
		var a = this._getMenuNodes(this.idPrefix + this.topId);
		for (var c = 0; c < a.length; c++) {
			if (this.itemPull[a[c]]["type"] == "item") {
				this._renderToplevelItem(a[c], null)
			}
			if (this.itemPull[a[c]]["type"] == "separator") {
				this._renderSeparator(a[c], null)
			}
		}
	}
};
dhtmlXMenuObject.prototype._renderToplevelItem = function(q, o) {
	var n = this;
	var a = document.createElement("DIV");
	a.id = q;
	if (this.itemPull[q]["state"] == "enabled" && this.itemPull[q]["cssNormal"] != null) {
		a.className = this.itemPull[q]["cssNormal"]
	} else {
		a.className = "dhtmlxMenu_" + this.conf.skin + "_TopLevel_Item_" + (this.itemPull[q]["state"] == "enabled" ? "Normal" : "Disabled")
	}
	if (this.itemPull[q]["title"] != "") {
		var l = document.createElement("DIV");
		l.className = "top_level_text";
		l.innerHTML = this.itemPull[q]["title"];
		a.appendChild(l)
	}
	if (this.itemPull[q]["tip"].length > 0) {
		a.title = this.itemPull[q]["tip"]
	}
	if ((this.itemPull[q]["imgen"] != "") || (this.itemPull[q]["imgdis"] != "")) {
		var g = this.itemPull[q][(this.itemPull[q]["state"] == "enabled") ? "imgen" : "imgdis"];
		if (g) {
			var c = document.createElement("IMG");
			c.border = "0";
			c.id = "image_" + q;
			c.src = this.conf.icons_path + g;
			c.className = "dhtmlxMenu_TopLevel_Item_Icon";
			if (a.childNodes.length > 0 && !this.conf.rtl) {
				a.insertBefore(c, a.childNodes[0])
			} else {
				a.appendChild(c)
			}
		}
	}
	a.onselectstart = function(m) {
		m = m || event;
		if (m.preventDefault) {
			m.preventDefault()
		} else {
			m.returnValue = false
		}
		return false
	};
	a.oncontextmenu = function(m) {
		m = m || event;
		if (m.preventDefault) {
			m.preventDefault()
		} else {
			m.returnValue = false
		}
		return false
	};
	if (!this.cont) {
		this.cont = document.createElement("DIV");
		this.cont.dir = "ltr";
		this.cont.className = (this.conf.align == "right" ? "align_right" : "align_left");
		this.base.appendChild(this.cont)
	}
	if (o != null) {
		o++;
		if (o < 0) {
			o = 0
		}
		if (o > this.cont.childNodes.length - 1) {
			o = null
		}
	}
	if (o != null) {
		this.cont.insertBefore(a, this.cont.childNodes[o])
	} else {
		this.cont.appendChild(a)
	}
	this.idPull[a.id] = a;
	if (this.itemPull[q]["complex"] && (!this.conf.dload)) {
		this._addSubMenuPolygon(this.itemPull[q]["id"], this.itemPull[q]["id"])
	}
	a.onmouseover = function() {
		if (n.conf.mode == "web") {
			window.clearTimeout(n.conf.tm_handler)
		}
		var m = n._getSubItemToDeselectByPolygon("parent");
		n._removeSubItemFromSelected(-1, -1);
		for (var s = 0; s < m.length; s++) {
			if (m[s] != this.id) {
				n._hidePolygon(m[s])
			}
			if ((n.idPull[m[s]] != null) && (m[s] != this.id)) {
				if (n.itemPull[m[s]]["cssNormal"] != null) {
					n.idPull[m[s]].className = n.itemPull[m[s]]["cssNormal"]
				} else {
					if (n.idPull[m[s]].className == "sub_item_selected") {
						n.idPull[m[s]].className = "sub_item"
					}
					n.idPull[m[s]].className = n.idPull[m[s]].className.replace(/Selected/g, "Normal")
				}
			}
		}
		if (n.itemPull[this.id]["state"] == "enabled") {
			this.className = "dhtmlxMenu_" + n.conf.skin + "_TopLevel_Item_Selected";
			n._addSubItemToSelected(this.id, "parent");
			n.conf.selected = (n.conf.mode == "win" ? (n.conf.selected != -1 ? this.id : n.conf.selected) : this.id);
			if (n.conf.dload) {
				if (n.itemPull[this.id].loaded == "no") {
					this._dynLoadTM = new Date().getTime();
					n.itemPull[this.id].loaded = "get";
					var u = this.id.replace(n.idPrefix, "");
					n._dhxdataload.onBeforeXLS = function() {
						var w = {
							params: {}
						};
						w.params[this.conf.dload_pid] = u;
						for (var v in this.conf.dload_params) {
							w.params[v] = this.conf.dload_params[v]
						}
						return w
					};
					n.loadStruct(n.conf.dload_url)
				}
				if (n.conf.top_mode && n.conf.mode == "web" && !n.conf.context) {
					this._mouseOver = true
				}
			}
			if ((!n.conf.dload) || (n.conf.dload && (!n.itemPull[this.id]["loaded"] || n.itemPull[this.id]["loaded"] == "yes"))) {
				if ((n.itemPull[this.id]["complex"]) && (n.conf.selected != -1)) {
					if (n.conf.top_mode && n.conf.mode == "web" && !n.conf.context) {
						this._mouseOver = true;
						var r = this.id;
						this._menuOpenTM = window.setTimeout(function() {
							n._showPolygon(r, n.conf.dir_toplv)
						}, n.conf.top_tmtime)
					} else {
						n._showPolygon(this.id, n.conf.dir_toplv)
					}
				}
			}
		}
		n._doOnTouchMenu(this.id.replace(n.idPrefix, ""))
	};
	a.onmouseout = function() {
		if (!((n.itemPull[this.id]["complex"]) && (n.conf.selected != -1)) && (n.itemPull[this.id]["state"] == "enabled")) {
			if (n.itemPull[this.id]["cssNormal"] != null) {
				a.className = n.itemPull[this.id]["cssNormal"]
			} else {
				a.className = "dhtmlxMenu_" + n.conf.skin + "_TopLevel_Item_Normal"
			}
		}
		if (n.conf.mode == "web") {
			window.clearTimeout(n.conf.tm_handler);
			n.conf.tm_handler = window.setTimeout(function() {
				n._clearAndHide()
			}, n.conf.tm_sec, "JavaScript")
		}
		if (n.conf.top_mode && n.conf.mode == "web" && !n.conf.context) {
			this._mouseOver = false;
			window.clearTimeout(this._menuOpenTM)
		}
	};
	a.onclick = function(v) {
		if (n.conf.mode == "web") {
			window.clearTimeout(n.conf.tm_handler)
		}
		if (n.conf.mode != "web" && n.itemPull[this.id]["state"] == "disabled") {
			return
		}
		v = v || event;
		v.cancelBubble = true;
		if (v.preventDefault) {
			v.preventDefault()
		} else {
			v.returnValue = false
		}
		if (n.conf.mode == "win") {
			if (n.itemPull[this.id]["complex"]) {
				if (n.conf.selected == this.id) {
					n.conf.selected = -1;
					var u = false
				} else {
					n.conf.selected = this.id;
					var u = true
				}
				if (u) {
					n._showPolygon(this.id, n.conf.dir_toplv)
				} else {
					n._hidePolygon(this.id)
				}
			}
		}
		var m = (n.itemPull[this.id]["complex"] ? "c" : "-");
		var w = (n.itemPull[this.id]["state"] != "enabled" ? "d" : "-");
		var r = {
			ctrl: v.ctrlKey,
			alt: v.altKey,
			shift: v.shiftKey
		};
		n._doOnClick(this.id.replace(n.idPrefix, ""), m + w + "t", r);
		return false
	};
	if (this.conf.skin == "dhx_terrace") {
		this._improveTerraceSkin()
	}
};
dhtmlXMenuObject.prototype._addSubMenuPolygon = function(n, m) {
	var c = this._renderSublevelPolygon(n, m);
	var a = this._getMenuNodes(m);
	for (g = 0; g < a.length; g++) {
		if (this.itemPull[a[g]]["type"] == "separator") {
			this._renderSeparator(a[g], null)
		} else {
			this._renderSublevelItem(a[g], null)
		}
	}
	if (n == m) {
		var l = "topLevel"
	} else {
		var l = "subLevel"
	}
	for (var g = 0; g < a.length; g++) {
		if (this.itemPull[a[g]]["complex"]) {
			this._addSubMenuPolygon(n, this.itemPull[a[g]]["id"])
		}
	}
};
dhtmlXMenuObject.prototype._renderSublevelPolygon = function(m, l) {
	var c = document.createElement("DIV");
	c.className = "dhtmlxMenu_" + this.conf.skin + "_SubLevelArea_Polygon " + (this.conf.rtl ? "dir_right" : "");
	c.dir = "ltr";
	c.oncontextmenu = function(n) {
		n = n || event;
		if (n.preventDefault) {
			n.preventDefault()
		} else {
			n.returnValue = false
		}
		n.cancelBubble = true;
		return false
	};
	c.id = "polygon_" + l;
	c.onclick = function(n) {
		n = n || event;
		n.cancelBubble = true
	};
	c.style.display = "none";
	document.body.insertBefore(c, document.body.firstChild);
	c.innerHTML = '<div style="position:relative;"></div><div style="position: relative; overflow:hidden;"></div><div style="position:relative;"></div>';
	var g = document.createElement("TABLE");
	g.className = "dhtmlxMebu_SubLevelArea_Tbl";
	g.cellSpacing = 0;
	g.cellPadding = 0;
	g.border = 0;
	var a = document.createElement("TBODY");
	g.appendChild(a);
	c.childNodes[1].appendChild(g);
	c.tbl = g;
	c.tbd = a;
	this.idPull[c.id] = c;
	if (this.sxDacProc != null) {
		this.idPull["sxDac_" + l] = new this.sxDacProc(c, c.className);
		if (window.dhx4.isIE) {
			this.idPull["sxDac_" + l]._setSpeed(this.dacSpeedIE);
			this.idPull["sxDac_" + l]._setCustomCycle(this.dacCyclesIE)
		} else {
			this.idPull["sxDac_" + l]._setSpeed(this.dacSpeed);
			this.idPull["sxDac_" + l]._setCustomCycle(this.dacCycles)
		}
	}
	return c
};
dhtmlXMenuObject.prototype._renderSublevelItem = function(a, s) {
	var q = this;
	var r = document.createElement("TR");
	r.className = (this.itemPull[a]["state"] == "enabled" ? "sub_item" : "sub_item_dis");
	var o = document.createElement("TD");
	o.className = "sub_item_icon";
	var u = this.itemPull[a][(this.itemPull[a]["state"] == "enabled" ? "imgen" : "imgdis")];
	if (u != "") {
		var x = this.itemPull[a]["type"];
		if (x == "checkbox" || x == "radio") {
			var m = document.createElement("DIV");
			m.id = "image_" + this.itemPull[a]["id"];
			m.className = "sub_icon " + u;
			o.appendChild(m)
		}
		if (!(x == "checkbox" || x == "radio")) {
			var m = document.createElement("IMG");
			m.id = "image_" + this.itemPull[a]["id"];
			m.className = "sub_icon";
			m.src = this.conf.icons_path + u;
			o.appendChild(m)
		}
	} else {
		o.innerHTML = "&nbsp;"
	}
	var n = document.createElement("TD");
	n.className = "sub_item_text";
	if (this.itemPull[a]["title"] != "") {
		var w = document.createElement("DIV");
		w.className = "sub_item_text";
		w.innerHTML = this.itemPull[a]["title"];
		n.appendChild(w)
	} else {
		n.innerHTML = "&nbsp;"
	}
	var l = document.createElement("TD");
	l.className = "sub_item_hk";
	if (this.itemPull[a]["complex"]) {
		var c = document.createElement("DIV");
		c.className = "complex_arrow";
		c.id = "arrow_" + this.itemPull[a]["id"];
		l.appendChild(c)
	} else {
		if (this.itemPull[a]["hotkey"].length > 0 && !this.itemPull[a]["complex"]) {
			var g = document.createElement("DIV");
			g.className = "sub_item_hk";
			g.innerHTML = this.itemPull[a]["hotkey"];
			l.appendChild(g)
		} else {
			l.innerHTML = "&nbsp;"
		}
	}
	r.appendChild(this.conf.rtl ? l : o);
	r.appendChild(n);
	r.appendChild(this.conf.rtl ? o : l);
	r.id = this.itemPull[a]["id"];
	r.parent = this.itemPull[a]["parent"];
	if (this.itemPull[a]["tip"].length > 0) {
		r.title = this.itemPull[a]["tip"]
	}
	r.onselectstart = function(y) {
		y = y || event;
		if (y.preventDefault) {
			y.preventDefault()
		} else {
			y.returnValue = false
		}
		return false
	};
	r.onmouseover = function(y) {
		if (q.conf.hide_tm[this.id]) {
			window.clearTimeout(q.conf.hide_tm[this.id])
		}
		if (q.conf.mode == "web") {
			window.clearTimeout(q.conf.tm_handler)
		}
		if (!this._visible) {
			q._redistribSubLevelSelection(this.id, this.parent)
		}
		this._visible = true
	};
	r.onmouseout = function() {
		if (q.conf.mode == "web") {
			if (q.conf.tm_handler) {
				window.clearTimeout(q.conf.tm_handler)
			}
			q.conf.tm_handler = window.setTimeout(function() {
				if (q && q._clearAndHide) {
					q._clearAndHide()
				}
			}, q.conf.tm_sec, "JavaScript")
		}
		var y = this;
		if (q.conf.hide_tm[this.id]) {
			window.clearTimeout(q.conf.hide_tm[this.id])
		}
		q.conf.hide_tm[this.id] = window.setTimeout(function() {
			y._visible = false
		}, 50)
	};
	r.onclick = function(A) {
		if (!q.checkEvent("onClick") && q.itemPull[this.id]["complex"]) {
			return
		}
		A = A || event;
		A.cancelBubble = true;
		if (A.preventDefault) {
			A.preventDefault()
		} else {
			A.returnValue = false
		}
		tc = (q.itemPull[this.id]["complex"] ? "c" : "-");
		td = (q.itemPull[this.id]["state"] == "enabled" ? "-" : "d");
		var y = {
			ctrl: A.ctrlKey,
			alt: A.altKey,
			shift: A.shiftKey
		};
		switch (q.itemPull[this.id]["type"]) {
			case "checkbox":
				q._checkboxOnClickHandler(this.id.replace(q.idPrefix, ""), tc + td + "n", y);
				break;
			case "radio":
				q._radioOnClickHandler(this.id.replace(q.idPrefix, ""), tc + td + "n", y);
				break;
			case "item":
				q._doOnClick(this.id.replace(q.idPrefix, ""), tc + td + "n", y);
				break
		}
		return false
	};
	var v = this.idPull["polygon_" + this.itemPull[a]["parent"]];
	if (s != null) {
		s++;
		if (s < 0) {
			s = 0
		}
		if (s > v.tbd.childNodes.length - 1) {
			s = null
		}
	}
	if (s != null && v.tbd.childNodes[s] != null) {
		v.tbd.insertBefore(r, v.tbd.childNodes[s])
	} else {
		v.tbd.appendChild(r)
	}
	this.idPull[r.id] = r
};
dhtmlXMenuObject.prototype._renderSeparator = function(c, o) {
	var a = (this.conf.context ? "SubLevelArea" : (this.itemPull[c]["parent"] == this.idPrefix + this.topId ? "TopLevel" : "SubLevelArea"));
	if (a == "TopLevel" && this.conf.context) {
		return
	}
	var m = this;
	if (a != "TopLevel") {
		var n = document.createElement("TR");
		n.className = "sub_sep";
		var g = document.createElement("TD");
		g.colSpan = "3";
		n.appendChild(g)
	}
	var l = document.createElement("DIV");
	l.id = "separator_" + c;
	l.className = (a == "TopLevel" ? "top_sep" : "sub_sep");
	l.onselectstart = function(s) {
		s = s || event;
		if (s.preventDefault) {
			s.preventDefault()
		} else {
			s.returnValue = false
		}
	};
	l.onclick = function(u) {
		u = u || event;
		u.cancelBubble = true;
		var s = {
			ctrl: u.ctrlKey,
			alt: u.altKey,
			shift: u.shiftKey
		};
		m._doOnClick(this.id.replace("separator_" + m.idPrefix, ""), "--s", s)
	};
	if (a == "TopLevel") {
		if (o != null) {
			o++;
			if (o < 0) {
				o = 0
			}
			if (this.cont.childNodes[o] != null) {
				this.cont.insertBefore(l, this.cont.childNodes[o])
			} else {
				this.cont.appendChild(l)
			}
		} else {
			var r = this.cont.childNodes[this.cont.childNodes.length - 1];
			if (String(r).search("TopLevel_Text") == -1) {
				this.cont.appendChild(l)
			} else {
				this.cont.insertBefore(l, r)
			}
		}
		this.idPull[l.id] = l
	} else {
		var q = this.idPull["polygon_" + this.itemPull[c]["parent"]];
		if (o != null) {
			o++;
			if (o < 0) {
				o = 0
			}
			if (o > q.tbd.childNodes.length - 1) {
				o = null
			}
		}
		if (o != null && q.tbd.childNodes[o] != null) {
			q.tbd.insertBefore(n, q.tbd.childNodes[o])
		} else {
			q.tbd.appendChild(n)
		}
		g.appendChild(l);
		this.idPull[l.id] = n
	}
};
dhtmlXMenuObject.prototype.addNewSeparator = function(a, c) {
	c = this.idPrefix + (c != null ? c : this._genStr(24));
	var g = this.idPrefix + this.getParentId(a);
	this._addItemIntoGlobalStrorage(c, g, "", "separator", false, "", "");
	this._renderSeparator(c, this.getItemPosition(a))
};
dhtmlXMenuObject.prototype._initObj = function(v, w, o) {
	if (!(v instanceof Array)) {
		o = v.parentId;
		if (o != null && String(o).indexOf(this.idPrefix) !== 0) {
			o = this.idPrefix + String(o)
		}
		v = v.items
	}
	for (var g = 0; g < v.length; g++) {
		if (typeof(v[g].id) == "undefined" || v[g].id == null) {
			v[g].id = this._genStr(24)
		}
		if (v[g].text == null) {
			v[g].text = ""
		}
		if (String(v[g].id).indexOf(this.idPrefix) !== 0) {
			v[g].id = this.idPrefix + String(v[g].id)
		}
		var l = {
			type: "item",
			tip: "",
			hotkey: "",
			state: "enabled",
			imgen: "",
			imgdis: ""
		};
		for (var x in l) {
			if (typeof(v[g][x]) == "undefined") {
				v[g][x] = l[x]
			}
		}
		if (v[g].imgen == "" && v[g].img != null) {
			v[g].imgen = v[g].img
		}
		if (v[g].imgdis == "" && v[g].img_disabled != null) {
			v[g].imgdis = v[g].img_disabled
		}
		if (v[g].title == null && v[g].text != null) {
			v[g].title = v[g].text
		}
		if (v[g].href != null) {
			if (v[g].href.link != null) {
				v[g].href_link = v[g].href.link
			}
			if (v[g].href.target != null) {
				v[g].href_target = v[g].href.target
			}
		}
		if (v[g].userdata != null) {
			for (var x in v[g].userdata) {
				this.userData[v[g].id + "_" + x] = v[g].userdata[x]
			}
		}
		if (typeof(v[g].enabled) != "undefined" && window.dhx4.s2b(v[g].enabled) == false) {
			v[g].state = "disabled"
		} else {
			if (typeof(v[g].disabled) != "undefined" && window.dhx4.s2b(v[g].disabled) == true) {
				v[g].state = "disabled"
			}
		}
		if (typeof(v[g].parent) == "undefined") {
			v[g].parent = (o != null ? o : this.idPrefix + this.topId)
		}
		if (v[g].type == "checkbox") {
			v[g].checked = window.dhx4.s2b(v[g].checked);
			v[g].imgen = v[g].imgdis = "chbx_" + (v[g].checked ? "1" : "0")
		}
		if (v[g].type == "radio") {
			v[g].checked = window.dhx4.s2b(v[g].checked);
			v[g].imgen = v[g].imgdis = "rdbt_" + (v[g].checked ? "1" : "0");
			if (typeof(v[g].group) == "undefined" || v[g].group == null) {
				v[g].group = this._genStr(24)
			}
			if (this.radio[v[g].group] == null) {
				this.radio[v[g].group] = []
			}
			this.radio[v[g].group].push(v[g].id)
		}
		this.itemPull[v[g].id] = v[g];
		if (v[g].items != null && v[g].items.length > 0) {
			this.itemPull[v[g].id].complex = true;
			this._initObj(v[g].items, true, v[g].id)
		} else {
			if (this.conf.dload && v[g].complex == true) {
				this.itemPull[v[g].id].loaded = "no"
			}
		}
		this.itemPull[v[g].id].items = null
	}
	if (w !== true) {
		if (this.conf.dload == true) {
			if (o == null) {
				this._initTopLevelMenu()
			} else {
				this._addSubMenuPolygon(o, o);
				if (this.conf.selected == o) {
					var u = (this.itemPull[o].parent == this.idPrefix + this.topId);
					var c = (u && !this.conf.context ? this.conf.dir_toplv : this.conf.dir_sublv);
					var m = false;
					if (u && this.conf.top_mode && this.conf.mode == "web" && !this.conf.context) {
						var y = this.idPull[o];
						if (y._mouseOver == true) {
							var n = this.conf.top_tmtime - (new Date().getTime() - y._dynLoadTM);
							if (n > 1) {
								var s = o;
								var r = this;
								y._menuOpenTM = window.setTimeout(function() {
									r._showPolygon(s, c);
									r = s = null
								}, n);
								m = true
							}
						}
					}
					if (!m) {
						this._showPolygon(o, c)
					}
				}
				this.itemPull[o].loaded = "yes";
				if (this.conf.dload_icon == true) {
					this._updateLoaderIcon(o, false)
				}
			}
		} else {
			this._init()
		}
	}
};
dhtmlXMenuObject.prototype._xmlToJson = function(m, l) {
	var o = [];
	if (l == null) {
		var s = m.getElementsByTagName(this.conf.tags.root);
		if (s == null || (s != null && s.length == 0)) {
			return {
				items: []
			}
		}
		s = s[0]
	} else {
		s = m
	}
	if (s.getAttribute("parentId") != null) {
		l = this.idPrefix + s.getAttribute("parentId")
	}
	for (var c = 0; c < s.childNodes.length; c++) {
		if (typeof(s.childNodes[c].tagName) != "undefined" && String(s.childNodes[c].tagName).toLowerCase() == this.conf.tags.item) {
			var a = s.childNodes[c];
			var x = {
				id: this.idPrefix + (a.getAttribute("id") || this._genStr(24)),
				title: a.getAttribute("text") || "",
				imgen: a.getAttribute("img") || "",
				imgdis: a.getAttribute("imgdis") || "",
				tip: "",
				hotkey: "",
				type: a.getAttribute("type") || "item"
			};
			if (a.getAttribute("cssNormal") != null) {
				x.cssNormal = a.getAttribute("cssNormal")
			}
			if (x.type == "checkbox") {
				x.checked = a.getAttribute("checked")
			}
			if (x.type == "radio") {
				x.checked = a.getAttribute("checked");
				x.group = a.getAttribute("group")
			}
			x.state = "enabled";
			if (a.getAttribute("enabled") != null && window.dhx4.s2b(a.getAttribute("enabled")) == false) {
				x.state = "disabled"
			} else {
				if (a.getAttribute("disabled") != null && window.dhx4.s2b(a.getAttribute("disabled")) == true) {
					x.state = "disabled"
				}
			}
			x.parent = (l != null ? l : this.idPrefix + this.topId);
			if (this.conf.dload) {
				x.complex = (a.getAttribute("complex") != null);
				if (x.complex) {
					x.loaded = "no"
				}
			} else {
				var g = this._xmlToJson(a, x.id);
				x.items = g.items;
				x.complex = (x.items.length > 0)
			}
			for (var u = 0; u < a.childNodes.length; u++) {
				if (typeof(a.childNodes[u].tagName) != "undefined") {
					var v = String(a.childNodes[u].tagName || "").toLowerCase();
					if (v == this.conf.tags.userdata) {
						var n = a.childNodes[u];
						if (n.getAttribute("name") != null) {
							this.userData[x.id + "_" + n.getAttribute("name")] = (n.firstChild != null && n.firstChild.nodeValue != null ? n.firstChild.nodeValue : "")
						}
					}
					if (v == this.conf.tags.text_ext) {
						x.title = a.childNodes[u].firstChild.nodeValue
					}
					if (v == this.conf.tags.tooltip) {
						x.tip = a.childNodes[u].firstChild.nodeValue
					}
					if (v == this.conf.tags.hotkey) {
						x.hotkey = a.childNodes[u].firstChild.nodeValue
					}
					if (v == this.conf.tags.href && x.type == "item") {
						x.href_link = a.childNodes[u].firstChild.nodeValue;
						if (a.childNodes[u].getAttribute("target") != null) {
							x.href_target = a.childNodes[u].getAttribute("target")
						}
					}
				}
			}
			o.push(x)
		}
	}
	var a = {
		parentId: l,
		items: o
	};
	return a
};
dhtmlXMenuObject.prototype.enableDynamicLoading = function(a, c) {
	this.conf.dload = true;
	this.conf.dload_url = a;
	this.conf.dload_sign = (String(this.conf.dload_url).search(/\?/) == -1 ? "?" : "&");
	this.conf.dload_icon = c;
	this._init()
};
dhtmlXMenuObject.prototype._updateLoaderIcon = function(l, g) {
	if (this.idPull[l] == null) {
		return
	}
	if (String(this.idPull[l].className).search("TopLevel_Item") >= 0) {
		return
	}
	var c = (this.conf.rtl ? 0 : 2);
	if (!this.idPull[l].childNodes[c]) {
		return
	}
	if (!this.idPull[l].childNodes[c].childNodes[0]) {
		return
	}
	var a = this.idPull[l].childNodes[c].childNodes[0];
	if (String(a.className).search("complex_arrow") === 0) {
		a.className = "complex_arrow" + (g ? "_loading" : "")
	}
};
dhtmlXMenuObject.prototype.addNewSibling = function(l, m, a, c, g, q) {
	var o = this.idPrefix + (m != null ? m : this._genStr(24));
	var n = this.idPrefix + (l != null ? this.getParentId(l) : this.topId);
	this._addItemIntoGlobalStrorage(o, n, a, "item", c, g, q);
	if ((n == this.idPrefix + this.topId) && (!this.conf.context)) {
		this._renderToplevelItem(o, this.getItemPosition(l))
	} else {
		this._renderSublevelItem(o, this.getItemPosition(l))
	}
};
dhtmlXMenuObject.prototype.addNewChild = function(o, n, l, a, c, g, m) {
	if (o == null) {
		if (this.conf.context) {
			o = this.topId
		} else {
			this.addNewSibling(o, l, a, c, g, m);
			if (n != null) {
				this.setItemPosition(l, n)
			}
			return
		}
	}
	l = this.idPrefix + (l != null ? l : this._genStr(24));
	if (this.setHotKey) {
		this.setHotKey(o, "")
	}
	o = this.idPrefix + o;
	this._addItemIntoGlobalStrorage(l, o, a, "item", c, g, m);
	if (this.idPull["polygon_" + o] == null) {
		this._renderSublevelPolygon(o, o)
	}
	this._renderSublevelItem(l, n - 1);
	this._redefineComplexState(o)
};
dhtmlXMenuObject.prototype.removeItem = function(l, n, m) {
	if (!n) {
		l = this.idPrefix + l
	}
	var o = null;
	if (l != this.idPrefix + this.topId) {
		if (this.itemPull[l] == null) {
			return
		}
		if (this.idPull["polygon_" + l] && this.idPull["polygon_" + l]._tmShow) {
			window.clearTimeout(this.idPull["polygon_" + l]._tmShow)
		}
		var w = this.itemPull[l]["type"];
		if (w == "separator") {
			var v = this.idPull["separator_" + l];
			if (this.itemPull[l]["parent"] == this.idPrefix + this.topId) {
				v.onclick = null;
				v.onselectstart = null;
				v.id = null;
				v.parentNode.removeChild(v)
			} else {
				v.childNodes[0].childNodes[0].onclick = null;
				v.childNodes[0].childNodes[0].onselectstart = null;
				v.childNodes[0].childNodes[0].id = null;
				v.childNodes[0].removeChild(v.childNodes[0].childNodes[0]);
				v.removeChild(v.childNodes[0]);
				v.parentNode.removeChild(v)
			}
			this.idPull["separator_" + l] = null;
			this.itemPull[l] = null;
			delete this.idPull["separator_" + l];
			delete this.itemPull[l];
			v = null
		} else {
			o = this.itemPull[l]["parent"];
			var v = this.idPull[l];
			v.onclick = null;
			v.oncontextmenu = null;
			v.onmouseover = null;
			v.onmouseout = null;
			v.onselectstart = null;
			v.id = null;
			while (v.childNodes.length > 0) {
				v.removeChild(v.childNodes[0])
			}
			v.parentNode.removeChild(v);
			this.idPull[l] = null;
			this.itemPull[l] = null;
			delete this.idPull[l];
			delete this.itemPull[l];
			v = null
		}
		w = null
	}
	for (var s in this.itemPull) {
		if (this.itemPull[s]["parent"] == l) {
			this.removeItem(s, true, true)
		}
	}
	var u = new Array(l);
	if (o != null && !m) {
		if (this.idPull["polygon_" + o] != null) {
			if (this.idPull["polygon_" + o].tbd.childNodes.length == 0) {
				u.push(o);
				this._updateItemComplexState(o, false, false)
			}
		}
	}
	for (var c = 0; c < u.length; c++) {
		if (this.idPull["polygon_" + u[c]]) {
			var g = this.idPull["polygon_" + u[c]];
			g.onclick = null;
			g.oncontextmenu = null;
			g.tbl.removeChild(g.tbd);
			g.tbd = null;
			g.childNodes[1].removeChild(g.tbl);
			g.tbl = null;
			g.id = null;
			g.parentNode.removeChild(g);
			g = null;
			if (window.dhx4.isIE6) {
				var r = "polygon_" + u[c] + "_ie6cover";
				if (this.idPull[r] != null) {
					document.body.removeChild(this.idPull[r]);
					delete this.idPull[r]
				}
			}
			if (this.idPull["arrowup_" + l] != null && this._removeArrow) {
				this._removeArrow("arrowup_" + l)
			}
			if (this.idPull["arrowdown_" + l] != null && this._removeArrow) {
				this._removeArrow("arrowdown_" + l)
			}
			this.idPull["polygon_" + u[c]] = null;
			delete this.idPull["polygon_" + u[c]]
		}
	}
	u = null;
	if (this.conf.skin == "dhx_terrace" && arguments.length == 1) {
		this._improveTerraceSkin()
	}
};
dhtmlXMenuObject.prototype._addItemIntoGlobalStrorage = function(q, a, g, o, l, c, n) {
	var m = {
		id: q,
		title: g,
		imgen: (c != null ? c : ""),
		imgdis: (n != null ? n : ""),
		type: o,
		state: (l == true ? "disabled" : "enabled"),
		parent: a,
		complex: false,
		hotkey: "",
		tip: ""
	};
	this.itemPull[m.id] = m
};
dhtmlXMenuObject.prototype.renderAsContextMenu = function() {
	this.conf.context = true;
	if (this.base._autoSkinUpdate == true) {
		this.base.className = this.base.className.replace("dhtmlxMenu_" + this.conf.skin + "_Middle", "");
		this.base._autoSkinUpdate = false
	}
	if (this.conf.ctx_baseid != null) {
		this.addContextZone(this.conf.ctx_baseid)
	}
};
dhtmlXMenuObject.prototype.addContextZone = function(c) {
	if (c == document.body) {
		c = "document.body." + this.idPrefix;
		var l = document.body
	} else {
		if (typeof(c) == "string") {
			var l = document.getElementById(c)
		} else {
			var l = c
		}
	}
	var n = false;
	for (var g in this.conf.ctx_zones) {
		n = n || (g == c) || (this.conf.ctx_zones[g] == l)
	}
	if (n == true) {
		return false
	}
	this.conf.ctx_zones[c] = l;
	var m = this;
	if (window.dhx4.isOpera) {
		this.operaContext = function(a) {
			m._doOnContextMenuOpera(a, m)
		};
		l.addEventListener("mouseup", this.operaContext, false)
	} else {
		if (l.oncontextmenu != null && !l._oldContextMenuHandler) {
			l._oldContextMenuHandler = l.oncontextmenu
		}
		l.oncontextmenu = function(o) {
			for (var a in dhtmlXMenuObject.prototype.liveInst) {
				if (a != m.conf.live_id) {
					if (dhtmlXMenuObject.prototype.liveInst[a].context) {
						dhtmlXMenuObject.prototype.liveInst[a]._hideContextMenu()
					}
				}
			}
			o = o || event;
			o.cancelBubble = true;
			if (o.preventDefault) {
				o.preventDefault()
			} else {
				o.returnValue = false
			}
			m._doOnContextBeforeCall(o, this);
			return false
		}
	}
};
dhtmlXMenuObject.prototype._doOnContextMenuOpera = function(g, a) {
	for (var c in dhtmlXMenuObject.prototype.liveInst) {
		if (c != a.conf.live_id) {
			if (dhtmlXMenuObject.prototype.liveInst[c].context) {
				dhtmlXMenuObject.prototype.liveInst[c]._hideContextMenu()
			}
		}
	}
	g.cancelBubble = true;
	if (g.preventDefault) {
		g.preventDefault()
	} else {
		g.returnValue = false
	}
	if (g.button == 0 && g.ctrlKey == true) {
		a._doOnContextBeforeCall(g, this)
	}
	return false
};
dhtmlXMenuObject.prototype.removeContextZone = function(a) {
	if (!this.isContextZone(a)) {
		return false
	}
	if (a == document.body) {
		a = "document.body." + this.idPrefix
	}
	var c = this.conf.ctx_zones[a];
	if (window.dhx4.isOpera) {
		c.removeEventListener("mouseup", this.operaContext, false)
	} else {
		c.oncontextmenu = (c._oldContextMenuHandler != null ? c._oldContextMenuHandler : null);
		c._oldContextMenuHandler = null
	}
	try {
		this.conf.ctx_zones[a] = null;
		delete this.conf.ctx_zones[a]
	} catch (g) {}
	return true
};
dhtmlXMenuObject.prototype.isContextZone = function(a) {
	if (a == document.body && this.conf.ctx_zones["document.body." + this.idPrefix] != null) {
		return true
	}
	var c = false;
	if (this.conf.ctx_zones[a] != null) {
		if (this.conf.ctx_zones[a] == document.getElementById(a)) {
			c = true
		}
	}
	return c
};
dhtmlXMenuObject.prototype._isContextMenuVisible = function() {
	if (this.idPull["polygon_" + this.idPrefix + this.topId] == null) {
		return false
	}
	return (this.idPull["polygon_" + this.idPrefix + this.topId].style.display == "")
};
dhtmlXMenuObject.prototype._showContextMenu = function(c, g, a) {
	this._clearAndHide();
	if (this.idPull["polygon_" + this.idPrefix + this.topId] == null) {
		return false
	}
	window.clearTimeout(this.conf.tm_handler);
	this.idPull[this.idPrefix + this.topId] = new Array(c, g);
	this._showPolygon(this.idPrefix + this.topId, "bottom");
	this.callEvent("onContextMenu", [a])
};
dhtmlXMenuObject.prototype._hideContextMenu = function() {
	if (this.idPull["polygon_" + this.idPrefix + this.topId] == null) {
		return false
	}
	this._clearAndHide();
	this._hidePolygon(this.idPrefix + this.topId)
};
dhtmlXMenuObject.prototype._doOnContextBeforeCall = function(m, o) {
	this.conf.ctx_zoneid = o.id;
	this._clearAndHide();
	this._hideContextMenu();
	var l = (m.srcElement || m.target);
	var c = (window.dhx4.isIE || window.dhx4.isOpera || window.dhx4.isKHTML ? m.offsetX : m.layerX);
	var a = (window.dhx4.isIE || window.dhx4.isOpera || window.dhx4.isKHTML ? m.offsetY : m.layerY);
	var n = window.dhx4.absLeft(l) + c;
	var g = window.dhx4.absTop(l) + a;
	if (this.checkEvent("onBeforeContextMenu")) {
		if (this.callEvent("onBeforeContextMenu", [o.id, m])) {
			if (this.conf.ctx_autoshow) {
				this._showContextMenu(n, g, o.id);
				this.callEvent("onAfterContextMenu", [o.id, m])
			}
		}
	} else {
		if (this.conf.ctx_autoshow) {
			this._showContextMenu(n, g, o.id);
			this.callEvent("onAfterContextMenu", [o.id])
		}
	}
};
dhtmlXMenuObject.prototype.showContextMenu = function(a, c) {
	this._showContextMenu(a, c, false)
};
dhtmlXMenuObject.prototype.hideContextMenu = function() {
	this._hideContextMenu()
};
dhtmlXMenuObject.prototype.setAutoShowMode = function(a) {
	this.conf.ctx_autoshow = (a == true ? true : false)
};
dhtmlXMenuObject.prototype.setAutoHideMode = function(a) {
	this.conf.ctx_autohide = (a == true ? true : false)
};
dhtmlXMenuObject.prototype.setContextMenuHideAllMode = function(a) {
	this.conf.ctx_hideall = (a == true ? true : false)
};
dhtmlXMenuObject.prototype.getContextMenuHideAllMode = function() {
	return this.conf.ctx_hideall
};
dhtmlXMenuObject.prototype._improveTerraceSkin = function() {
	for (var g in this.itemPull) {
		if (this.itemPull[g].parent == this.idPrefix + this.topId && this.idPull[g] != null) {
			var m = false;
			var l = false;
			if (this.idPull[g].parentNode.firstChild == this.idPull[g]) {
				m = true
			}
			if (this.idPull[g].parentNode.lastChild == this.idPull[g]) {
				l = true
			}
			for (var c in this.itemPull) {
				if (this.itemPull[c].type == "separator" && this.itemPull[c].parent == this.idPrefix + this.topId) {
					if (this.idPull[g].nextSibling == this.idPull["separator_" + c]) {
						l = true
					}
					if (this.idPull[g].previousSibling == this.idPull["separator_" + c]) {
						m = true
					}
				}
			}
			this.idPull[g].style.borderLeftWidth = (m ? "1px" : "0px");
			this.idPull[g].style.borderTopLeftRadius = this.idPull[g].style.borderBottomLeftRadius = (m ? "3px" : "0px");
			this.idPull[g].style.borderTopRightRadius = this.idPull[g].style.borderBottomRightRadius = (l ? "3px" : "0px");
			this.idPull[g]._bl = m;
			this.idPull[g]._br = l
		}
	}
};
dhtmlXMenuObject.prototype._improveTerraceButton = function(c, a) {
	if (a) {
		this.idPull[c].style.borderBottomLeftRadius = (this.idPull[c]._bl ? "3px" : "0px");
		this.idPull[c].style.borderBottomRightRadius = (this.idPull[c]._br ? "3px" : "0px")
	} else {
		this.idPull[c].style.borderBottomLeftRadius = "0px";
		this.idPull[c].style.borderBottomRightRadius = "0px"
	}
};
if (typeof(window.dhtmlXCellObject) != "undefined") {
	dhtmlXCellObject.prototype._createNode_menu = function(m, c, l, a, g) {
		if (typeof(g) != "undefined") {
			m = g
		} else {
			m = document.createElement("DIV");
			m.className = "dhx_cell_menu_" + (this.conf.borders ? "def" : "no_borders");
			m.appendChild(document.createElement("DIV"))
		}
		this.cell.insertBefore(m, this.cell.childNodes[this.conf.idx.toolbar || this.conf.idx.cont]);
		this.conf.ofs_nodes.t.menu = true;
		this._updateIdx();
		return m
	};
	dhtmlXCellObject.prototype.attachMenu = function(a) {
		if (this.dataNodes.menu) {
			return
		}
		this.callEvent("_onBeforeContentAttach", ["menu"]);
		if (typeof(a) == "undefined") {
			a = {}
		}
		if (typeof(a.skin) == "undefined") {
			a.skin = this.conf.skin
		}
		a.parent = this._attachObject("menu").firstChild;
		this.dataNodes.menu = new dhtmlXMenuObject(a);
		this._adjustCont(this._idd);
		a.parent = null;
		a = null;
		this.callEvent("_onContentAttach", []);
		return this.dataNodes.menu
	};
	dhtmlXCellObject.prototype.detachMenu = function() {
		if (!this.dataNodes.menu) {
			return
		}
		this.dataNodes.menu.unload();
		this.dataNodes.menu = null;
		delete this.dataNodes.menu;
		this._detachObject("menu")
	};
	dhtmlXCellObject.prototype.showMenu = function() {
		this._mtbShowHide("menu", "")
	};
	dhtmlXCellObject.prototype.hideMenu = function() {
		this._mtbShowHide("menu", "none")
	};
	dhtmlXCellObject.prototype.getAttachedMenu = function() {
		return this.dataNodes.menu
	}
}
dhtmlXMenuObject.prototype.setItemEnabled = function(a) {
	this._changeItemState(a, "enabled", this._getItemLevelType(a))
};
dhtmlXMenuObject.prototype.setItemDisabled = function(a) {
	this._changeItemState(a, "disabled", this._getItemLevelType(a))
};
dhtmlXMenuObject.prototype.isItemEnabled = function(a) {
	return (this.itemPull[this.idPrefix + a] != null ? (this.itemPull[this.idPrefix + a]["state"] == "enabled") : false)
};
dhtmlXMenuObject.prototype._changeItemState = function(m, l, c) {
	var g = false;
	var a = this.idPrefix + m;
	if ((this.itemPull[a] != null) && (this.idPull[a] != null)) {
		if (this.itemPull[a]["state"] != l) {
			this.itemPull[a]["state"] = l;
			if (this.itemPull[a]["parent"] == this.idPrefix + this.topId && !this.conf.context) {
				this.idPull[a].className = "dhtmlxMenu_" + this.conf.skin + "_TopLevel_Item_" + (this.itemPull[a]["state"] == "enabled" ? "Normal" : "Disabled")
			} else {
				this.idPull[a].className = "sub_item" + (this.itemPull[a]["state"] == "enabled" ? "" : "_dis")
			}
			this._updateItemComplexState(this.idPrefix + m, this.itemPull[this.idPrefix + m]["complex"], false);
			this._updateItemImage(m, c);
			if ((this.idPrefix + this.conf.last_click == a) && (c != "TopLevel")) {
				this._redistribSubLevelSelection(a, this.itemPull[a]["parent"])
			}
			if (c == "TopLevel" && !this.conf.context) {}
		}
	}
	return g
};
dhtmlXMenuObject.prototype.getItemText = function(a) {
	return (this.itemPull[this.idPrefix + a] != null ? this.itemPull[this.idPrefix + a]["title"] : "")
};
dhtmlXMenuObject.prototype.setItemText = function(m, l) {
	m = this.idPrefix + m;
	if ((this.itemPull[m] != null) && (this.idPull[m] != null)) {
		this._clearAndHide();
		this.itemPull[m]["title"] = l;
		if (this.itemPull[m]["parent"] == this.idPrefix + this.topId && !this.conf.context) {
			var g = null;
			for (var a = 0; a < this.idPull[m].childNodes.length; a++) {
				try {
					if (this.idPull[m].childNodes[a].className == "top_level_text") {
						g = this.idPull[m].childNodes[a]
					}
				} catch (c) {}
			}
			if (String(this.itemPull[m]["title"]).length == "" || this.itemPull[m]["title"] == null) {
				if (g != null) {
					g.parentNode.removeChild(g)
				}
			} else {
				if (!g) {
					g = document.createElement("DIV");
					g.className = "top_level_text";
					if (this.conf.rtl && this.idPull[m].childNodes.length > 0) {
						this.idPull[m].insertBefore(g, this.idPull[m].childNodes[0])
					} else {
						this.idPull[m].appendChild(g)
					}
				}
				g.innerHTML = this.itemPull[m]["title"]
			}
		} else {
			var g = null;
			for (var a = 0; a < this.idPull[m].childNodes[1].childNodes.length; a++) {
				if (String(this.idPull[m].childNodes[1].childNodes[a].className || "") == "sub_item_text") {
					g = this.idPull[m].childNodes[1].childNodes[a]
				}
			}
			if (String(this.itemPull[m]["title"]).length == "" || this.itemPull[m]["title"] == null) {
				if (g) {
					g.parentNode.removeChild(g);
					g = null;
					this.idPull[m].childNodes[1].innerHTML = "&nbsp;"
				}
			} else {
				if (!g) {
					g = document.createElement("DIV");
					g.className = "sub_item_text";
					this.idPull[m].childNodes[1].innerHTML = "";
					this.idPull[m].childNodes[1].appendChild(g)
				}
				g.innerHTML = this.itemPull[m]["title"]
			}
		}
	}
};
dhtmlXMenuObject.prototype.loadFromHTML = function(g, n, l) {
	var c = this.conf.tags.item;
	this.conf.tags.item = "div";
	var m = (typeof(g) == "string" ? document.getElementById(g) : g);
	var a = this._xmlToJson(m, this.idPrefix + this.topId);
	this._initObj(a);
	this.conf.tags.item = c;
	if (n) {
		m.parentNode.removeChild(m)
	}
	m = objOd = null;
	if (onload != null) {
		if (typeof(l) == "function") {
			l()
		} else {
			if (typeof(window[l]) == "function") {
				window[l]()
			}
		}
	}
};
dhtmlXMenuObject.prototype.hideItem = function(a) {
	this._changeItemVisible(a, false)
};
dhtmlXMenuObject.prototype.showItem = function(a) {
	this._changeItemVisible(a, true)
};
dhtmlXMenuObject.prototype.isItemHidden = function(c) {
	var a = null;
	if (this.idPull[this.idPrefix + c] != null) {
		a = (this.idPull[this.idPrefix + c].style.display == "none")
	}
	return a
};
dhtmlXMenuObject.prototype._changeItemVisible = function(g, c) {
	var a = this.idPrefix + g;
	if (this.itemPull[a] == null) {
		return
	}
	if (this.itemPull[a]["type"] == "separator") {
		a = "separator_" + a
	}
	if (this.idPull[a] == null) {
		return
	}
	this.idPull[a].style.display = (c ? "" : "none");
	this._redefineComplexState(this.itemPull[this.idPrefix + g]["parent"])
};
dhtmlXMenuObject.prototype.setUserData = function(g, a, c) {
	this.userData[this.idPrefix + g + "_" + a] = c
};
dhtmlXMenuObject.prototype.getUserData = function(c, a) {
	return (this.userData[this.idPrefix + c + "_" + a] != null ? this.userData[this.idPrefix + c + "_" + a] : null)
};
dhtmlXMenuObject.prototype.setOpenMode = function(a) {
	this.conf.mode = (a == "win" ? "win" : "web")
};
dhtmlXMenuObject.prototype.setWebModeTimeout = function(a) {
	this.conf.tm_sec = (!isNaN(a) ? a : 400)
};
dhtmlXMenuObject.prototype.getItemImage = function(c) {
	var a = new Array(null, null);
	c = this.idPrefix + c;
	if (this.itemPull[c]["type"] == "item") {
		a[0] = this.itemPull[c]["imgen"];
		a[1] = this.itemPull[c]["imgdis"]
	}
	return a
};
dhtmlXMenuObject.prototype.setItemImage = function(g, a, c) {
	if (this.itemPull[this.idPrefix + g]["type"] != "item") {
		return
	}
	this.itemPull[this.idPrefix + g]["imgen"] = a;
	this.itemPull[this.idPrefix + g]["imgdis"] = c;
	this._updateItemImage(g, this._getItemLevelType(g))
};
dhtmlXMenuObject.prototype.clearItemImage = function(a) {
	this.setItemImage(a, "", "")
};
dhtmlXMenuObject.prototype.setVisibleArea = function(c, a, l, g) {
	this.conf.v_enabled = true;
	this.conf.v.x1 = c;
	this.conf.v.x2 = a;
	this.conf.v.y1 = l;
	this.conf.v.y2 = g
};
dhtmlXMenuObject.prototype.setTooltip = function(c, a) {
	c = this.idPrefix + c;
	if (!(this.itemPull[c] != null && this.idPull[c] != null)) {
		return
	}
	this.idPull[c].title = (a.length > 0 ? a : null);
	this.itemPull[c]["tip"] = a
};
dhtmlXMenuObject.prototype.getTooltip = function(a) {
	if (this.itemPull[this.idPrefix + a] == null) {
		return null
	}
	return this.itemPull[this.idPrefix + a]["tip"]
};
dhtmlXMenuObject.prototype.setTopText = function(a) {
	if (this.conf.context) {
		return
	}
	if (this._topText == null) {
		this._topText = document.createElement("DIV");
		this._topText.className = "dhtmlxMenu_TopLevel_Text_" + (this.conf.rtl ? "left" : (this.conf.align == "left" ? "right" : "left"));
		this.base.appendChild(this._topText)
	}
	this._topText.innerHTML = a
};
dhtmlXMenuObject.prototype.setAlign = function(a) {
	if (this.conf.align == a) {
		return
	}
	if (a == "left" || a == "right") {
		this.conf.align = a;
		if (this.cont) {
			this.cont.className = (this.conf.align == "right" ? "align_right" : "align_left")
		}
		if (this._topText != null) {
			this._topText.className = "dhtmlxMenu_TopLevel_Text_" + (this.conf.align == "left" ? "right" : "left")
		}
	}
};
dhtmlXMenuObject.prototype.setHref = function(g, a, c) {
	if (this.itemPull[this.idPrefix + g] == null) {
		return
	}
	this.itemPull[this.idPrefix + g]["href_link"] = a;
	if (c != null) {
		this.itemPull[this.idPrefix + g]["href_target"] = c
	}
};
dhtmlXMenuObject.prototype.clearHref = function(a) {
	if (this.itemPull[this.idPrefix + a] == null) {
		return
	}
	delete this.itemPull[this.idPrefix + a]["href_link"];
	delete this.itemPull[this.idPrefix + a]["href_target"]
};
dhtmlXMenuObject.prototype.getCircuit = function(c) {
	var a = new Array(c);
	while (this.getParentId(c) != this.topId) {
		c = this.getParentId(c);
		a[a.length] = c
	}
	return a.reverse()
};
dhtmlXMenuObject.prototype._getCheckboxState = function(a) {
	if (this.itemPull[this.idPrefix + a] == null) {
		return null
	}
	return this.itemPull[this.idPrefix + a]["checked"]
};
dhtmlXMenuObject.prototype._setCheckboxState = function(c, a) {
	if (this.itemPull[this.idPrefix + c] == null) {
		return
	}
	this.itemPull[this.idPrefix + c]["checked"] = a
};
dhtmlXMenuObject.prototype._updateCheckboxImage = function(c) {
	if (this.idPull[this.idPrefix + c] == null) {
		return
	}
	this.itemPull[this.idPrefix + c]["imgen"] = "chbx_" + (this._getCheckboxState(c) ? "1" : "0");
	this.itemPull[this.idPrefix + c]["imgdis"] = this.itemPull[this.idPrefix + c]["imgen"];
	try {
		this.idPull[this.idPrefix + c].childNodes[(this.conf.rtl ? 2 : 0)].childNodes[0].className = "sub_icon " + this.itemPull[this.idPrefix + c]["imgen"]
	} catch (a) {}
};
dhtmlXMenuObject.prototype._checkboxOnClickHandler = function(l, a, c) {
	if (a.charAt(1) == "d") {
		return
	}
	if (this.itemPull[this.idPrefix + l] == null) {
		return
	}
	var g = this._getCheckboxState(l);
	if (this.checkEvent("onCheckboxClick")) {
		if (this.callEvent("onCheckboxClick", [l, g, this.conf.ctx_zoneid, c])) {
			this.setCheckboxState(l, !g)
		}
	} else {
		this.setCheckboxState(l, !g)
	}
	if (this.checkEvent("onClick")) {
		this.callEvent("onClick", [l])
	}
};
dhtmlXMenuObject.prototype.setCheckboxState = function(c, a) {
	this._setCheckboxState(c, a);
	this._updateCheckboxImage(c)
};
dhtmlXMenuObject.prototype.getCheckboxState = function(a) {
	return this._getCheckboxState(a)
};
dhtmlXMenuObject.prototype.addCheckbox = function(q, l, r, s, u, a, m) {
	if (this.conf.context && l == this.topId) {} else {
		if (this.itemPull[this.idPrefix + l] == null) {
			return
		}
		if (q == "child" && this.itemPull[this.idPrefix + l]["type"] != "item") {
			return
		}
	}
	var n = "chbx_" + (a ? "1" : "0");
	var g = n;
	if (q == "sibling") {
		var c = this.idPrefix + (s != null ? s : this._genStr(24));
		var o = this.idPrefix + this.getParentId(l);
		this._addItemIntoGlobalStrorage(c, o, u, "checkbox", m, n, g);
		this.itemPull[c]["checked"] = a;
		this._renderSublevelItem(c, this.getItemPosition(l))
	} else {
		var c = this.idPrefix + (s != null ? s : this._genStr(24));
		var o = this.idPrefix + l;
		this._addItemIntoGlobalStrorage(c, o, u, "checkbox", m, n, g);
		this.itemPull[c]["checked"] = a;
		if (this.idPull["polygon_" + o] == null) {
			this._renderSublevelPolygon(o, o)
		}
		this._renderSublevelItem(c, r - 1);
		this._redefineComplexState(o)
	}
};
dhtmlXMenuObject.prototype.setHotKey = function(n, a) {
	n = this.idPrefix + n;
	if (!(this.itemPull[n] != null && this.idPull[n] != null)) {
		return
	}
	if (this.itemPull[n]["parent"] == this.idPrefix + this.topId && !this.conf.context) {
		return
	}
	if (this.itemPull[n]["complex"]) {
		return
	}
	var c = this.itemPull[n]["type"];
	if (!(c == "item" || c == "checkbox" || c == "radio")) {
		return
	}
	var m = null;
	try {
		if (this.idPull[n].childNodes[this.conf.rtl ? 0 : 2].childNodes[0].className == "sub_item_hk") {
			m = this.idPull[n].childNodes[this.conf.rtl ? 0 : 2].childNodes[0]
		}
	} catch (l) {}
	if (a.length == 0) {
		this.itemPull[n]["hotkey_backup"] = this.itemPull[n]["hotkey"];
		this.itemPull[n]["hotkey"] = "";
		if (m != null) {
			m.parentNode.removeChild(m)
		}
	} else {
		this.itemPull[n]["hotkey"] = a;
		this.itemPull[n]["hotkey_backup"] = null;
		if (m == null) {
			m = document.createElement("DIV");
			m.className = "sub_item_hk";
			var g = this.idPull[n].childNodes[this.conf.rtl ? 0 : 2];
			while (g.childNodes.length > 0) {
				g.removeChild(g.childNodes[0])
			}
			g.appendChild(m)
		}
		m.innerHTML = a
	}
};
dhtmlXMenuObject.prototype.getHotKey = function(a) {
	if (this.itemPull[this.idPrefix + a] == null) {
		return null
	}
	return this.itemPull[this.idPrefix + a]["hotkey"]
};
dhtmlXMenuObject.prototype._clearAllSelectedSubItemsInPolygon = function(a) {
	var g = this._getSubItemToDeselectByPolygon(a);
	for (var c = 0; c < this.conf.opened_poly.length; c++) {
		if (this.conf.opened_poly[c] != a) {
			this._hidePolygon(this.conf.opened_poly[c])
		}
	}
	for (var c = 0; c < g.length; c++) {
		if (this.idPull[g[c]] != null && this.itemPull[g[c]]["state"] == "enabled") {
			this.idPull[g[c]].className = "dhtmlxMenu_" + this.conf.skin + "_SubLevelArea_Item_Normal"
		}
	}
};
dhtmlXMenuObject.prototype._checkArrowsState = function(l) {
	var c = this.idPull["polygon_" + l].childNodes[1];
	var g = this.idPull["arrowup_" + l];
	var a = this.idPull["arrowdown_" + l];
	if (c.scrollTop == 0) {
		g.className = "dhtmlxMenu_" + this.conf.skin + "_SubLevelArea_ArrowUp_Disabled"
	} else {
		g.className = "dhtmlxMenu_" + this.conf.skin + "_SubLevelArea_ArrowUp" + (g.over ? "_Over" : "")
	}
	if (c.scrollTop + c.offsetHeight < c.scrollHeight) {
		a.className = "dhtmlxMenu_" + this.conf.skin + "_SubLevelArea_ArrowDown" + (a.over ? "_Over" : "")
	} else {
		a.className = "dhtmlxMenu_" + this.conf.skin + "_SubLevelArea_ArrowDown_Disabled"
	}
	c = g = a = null
};
dhtmlXMenuObject.prototype._addUpArrow = function(l) {
	var c = this;
	var g = document.createElement("DIV");
	g.pId = this.idPrefix + l;
	g.id = "arrowup_" + this.idPrefix + l;
	g.className = "dhtmlxMenu_" + this.conf.skin + "_SubLevelArea_ArrowUp";
	g.over = false;
	g.onselectstart = function(m) {
		m = m || event;
		if (m.preventDefault) {
			m.preventDefault()
		} else {
			m.returnValue = false
		}
		return false
	};
	g.oncontextmenu = function(m) {
		m = m || event;
		if (m.preventDefault) {
			m.preventDefault()
		} else {
			m.returnValue = false
		}
		return false
	};
	g.onmouseover = function() {
		if (c.conf.mode == "web") {
			window.clearTimeout(c.conf.tm_handler)
		}
		c._clearAllSelectedSubItemsInPolygon(this.pId);
		if (this.className == "dhtmlxMenu_" + c.conf.skin + "_SubLevelArea_ArrowUp_Disabled") {
			return
		}
		this.className = "dhtmlxMenu_" + c.conf.skin + "_SubLevelArea_ArrowUp_Over";
		this.over = true;
		c._canScrollUp = true;
		c._doScrollUp(this.pId, true)
	};
	g.onmouseout = function() {
		if (c.conf.mode == "web") {
			window.clearTimeout(c.conf.tm_handler);
			c.conf.tm_handler = window.setTimeout(function() {
				c._clearAndHide()
			}, c.conf.tm_sec, "JavaScript")
		}
		this.over = false;
		c._canScrollUp = false;
		if (this.className == "dhtmlxMenu_" + c.conf.skin + "_SubLevelArea_ArrowUp_Disabled") {
			return
		}
		this.className = "dhtmlxMenu_" + c.conf.skin + "_SubLevelArea_ArrowUp";
		window.clearTimeout(c.conf.of_utm)
	};
	g.onclick = function(m) {
		m = m || event;
		if (m.preventDefault) {
			m.preventDefault()
		} else {
			m.returnValue = false
		}
		m.cancelBubble = true;
		return false
	};
	var a = this.idPull["polygon_" + this.idPrefix + l];
	a.childNodes[0].appendChild(g);
	this.idPull[g.id] = g;
	a = g = null
};
dhtmlXMenuObject.prototype._addDownArrow = function(l) {
	var c = this;
	var g = document.createElement("DIV");
	g.pId = this.idPrefix + l;
	g.id = "arrowdown_" + this.idPrefix + l;
	g.className = "dhtmlxMenu_" + this.conf.skin + "_SubLevelArea_ArrowDown";
	g.over = false;
	g.onselectstart = function(m) {
		m = m || event;
		if (m.preventDefault) {
			m.preventDefault()
		} else {
			m.returnValue = false
		}
		return false
	};
	g.oncontextmenu = function(m) {
		m = m || event;
		if (m.preventDefault) {
			m.preventDefault()
		} else {
			m.returnValue = false
		}
		return false
	};
	g.onmouseover = function() {
		if (c.conf.mode == "web") {
			window.clearTimeout(c.conf.tm_handler)
		}
		c._clearAllSelectedSubItemsInPolygon(this.pId);
		if (this.className == "dhtmlxMenu_" + c.conf.skin + "_SubLevelArea_ArrowDown_Disabled") {
			return
		}
		this.className = "dhtmlxMenu_" + c.conf.skin + "_SubLevelArea_ArrowDown_Over";
		this.over = true;
		c._canScrollDown = true;
		c._doScrollDown(this.pId, true)
	};
	g.onmouseout = function() {
		if (c.conf.mode == "web") {
			window.clearTimeout(c.conf.tm_handler);
			c.conf.tm_handler = window.setTimeout(function() {
				c._clearAndHide()
			}, c.conf.tm_sec, "JavaScript")
		}
		this.over = false;
		c._canScrollDown = false;
		if (this.className == "dhtmlxMenu_" + c.conf.skin + "_SubLevelArea_ArrowDown_Disabled") {
			return
		}
		this.className = "dhtmlxMenu_" + c.conf.skin + "_SubLevelArea_ArrowDown";
		window.clearTimeout(c.conf.of_dtm)
	};
	g.onclick = function(m) {
		m = m || event;
		if (m.preventDefault) {
			m.preventDefault()
		} else {
			m.returnValue = false
		}
		m.cancelBubble = true;
		return false
	};
	var a = this.idPull["polygon_" + this.idPrefix + l];
	a.childNodes[2].appendChild(g);
	this.idPull[g.id] = g;
	a = g = null
};
dhtmlXMenuObject.prototype._removeUpArrow = function(c) {
	var a = "arrowup_" + this.idPrefix + c;
	this._removeArrow(a)
};
dhtmlXMenuObject.prototype._removeDownArrow = function(c) {
	var a = "arrowdown_" + this.idPrefix + c;
	this._removeArrow(a)
};
dhtmlXMenuObject.prototype._removeArrow = function(a) {
	var c = this.idPull[a];
	c.onselectstart = null;
	c.oncontextmenu = null;
	c.onmouseover = null;
	c.onmouseout = null;
	c.onclick = null;
	if (c.parentNode) {
		c.parentNode.removeChild(c)
	}
	c = null;
	this.idPull[a] = null;
	try {
		delete this.idPull[a]
	} catch (g) {}
};
dhtmlXMenuObject.prototype._isArrowExists = function(a) {
	if (this.idPull["arrowup_" + a] != null && this.idPull["arrowdown_" + a] != null) {
		return true
	}
	return false
};
dhtmlXMenuObject.prototype._doScrollUp = function(n, l) {
	var a = this.idPull["polygon_" + n].childNodes[1];
	if (this._canScrollUp && a.scrollTop > 0) {
		var g = false;
		var m = a.scrollTop - this.conf.of_ustep;
		if (m < 0) {
			g = true;
			m = 0
		}
		a.scrollTop = m;
		if (!g) {
			var c = this;
			this.conf.of_utm = window.setTimeout(function() {
				c._doScrollUp(n, false);
				c = null
			}, this.conf.of_utime)
		} else {
			l = true
		}
	} else {
		this._canScrollUp = false;
		this._checkArrowsState(n)
	}
	if (l) {
		this._checkArrowsState(n)
	}
};
dhtmlXMenuObject.prototype._doScrollDown = function(n, l) {
	var a = this.idPull["polygon_" + n].childNodes[1];
	if (this._canScrollDown && a.scrollTop + a.offsetHeight <= a.scrollHeight) {
		var g = false;
		var m = a.scrollTop + this.conf.of_dstep;
		if (m + a.offsetHeight >= a.scrollHeight) {
			g = true;
			m = a.scrollHeight - a.offsetHeight
		}
		a.scrollTop = m;
		if (!g) {
			var c = this;
			this.conf.of_dtm = window.setTimeout(function() {
				c._doScrollDown(n, false);
				c = null
			}, this.conf.of_dtime)
		} else {
			l = true
		}
	} else {
		this._canScrollDown = false;
		this._checkArrowsState(n)
	}
	if (l) {
		this._checkArrowsState(n)
	}
};
dhtmlXMenuObject.prototype._countPolygonItems = function(n) {
	var l = 0;
	for (var c in this.itemPull) {
		var g = this.itemPull[c]["parent"];
		var m = this.itemPull[c]["type"];
		if (g == this.idPrefix + n && (m == "item" || m == "radio" || m == "checkbox")) {
			l++
		}
	}
	return l
};
dhtmlXMenuObject.prototype.setOverflowHeight = function(l) {
	if (l === "auto") {
		this.conf.overflow_limit = 0;
		this.conf.auto_overflow = true;
		return
	}
	if (this.conf.overflow_limit == 0 && l <= 0) {
		return
	}
	this._clearAndHide();
	if (this.conf.overflow_limit >= 0 && l > 0) {
		this.conf.overflow_limit = l;
		return
	}
	if (this.conf.overflow_limit > 0 && l <= 0) {
		for (var g in this.itemPull) {
			if (this._isArrowExists(g)) {
				var c = String(g).replace(this.idPrefix, "");
				this._removeUpArrow(c);
				this._removeDownArrow(c);
				this.idPull["polygon_" + g].childNodes[1].style.height = ""
			}
		}
		this.conf.overflow_limit = 0;
		return
	}
};
dhtmlXMenuObject.prototype._getRadioImgObj = function(g) {
	try {
		var a = this.idPull[this.idPrefix + g].childNodes[(this.conf.rtl ? 2 : 0)].childNodes[0]
	} catch (c) {
		var a = null
	}
	return a
};
dhtmlXMenuObject.prototype._setRadioState = function(l, g) {
	var c = this._getRadioImgObj(l);
	if (c != null) {
		var a = this.itemPull[this.idPrefix + l];
		a.checked = g;
		a.imgen = "rdbt_" + (a.checked ? "1" : "0");
		a.imgdis = a.imgen;
		c.className = "sub_icon " + a.imgen
	}
};
dhtmlXMenuObject.prototype._radioOnClickHandler = function(l, a, c) {
	if (a.charAt(1) == "d" || this.itemPull[this.idPrefix + l]["group"] == null) {
		return
	}
	var g = this.itemPull[this.idPrefix + l]["group"];
	if (this.checkEvent("onRadioClick")) {
		if (this.callEvent("onRadioClick", [g, this.getRadioChecked(g), l, this.conf.ctx_zoneid, c])) {
			this.setRadioChecked(g, l)
		}
	} else {
		this.setRadioChecked(g, l)
	}
	if (this.checkEvent("onClick")) {
		this.callEvent("onClick", [l])
	}
};
dhtmlXMenuObject.prototype.getRadioChecked = function(l) {
	var n = null;
	for (var g = 0; g < this.radio[l].length; g++) {
		var m = this.radio[l][g].replace(this.idPrefix, "");
		var a = this._getRadioImgObj(m);
		if (a != null) {
			var c = (a.className).match(/rdbt_1$/gi);
			if (c != null) {
				n = m
			}
		}
	}
	return n
};
dhtmlXMenuObject.prototype.setRadioChecked = function(c, l) {
	if (this.radio[c] == null) {
		return
	}
	for (var a = 0; a < this.radio[c].length; a++) {
		var g = this.radio[c][a].replace(this.idPrefix, "");
		this._setRadioState(g, (g == l))
	}
};
dhtmlXMenuObject.prototype.addRadioButton = function(r, m, s, u, v, w, a, n) {
	if (this.conf.context && m == this.topId) {} else {
		if (this.itemPull[this.idPrefix + m] == null) {
			return
		}
		if (r == "child" && this.itemPull[this.idPrefix + m]["type"] != "item") {
			return
		}
	}
	var g = this.idPrefix + (u != null ? u : this._genStr(24));
	var o = "rdbt_" + (a ? "1" : "0");
	var c = o;
	if (r == "sibling") {
		var q = this.idPrefix + this.getParentId(m);
		this._addItemIntoGlobalStrorage(g, q, v, "radio", n, o, c);
		this._renderSublevelItem(g, this.getItemPosition(m))
	} else {
		var q = this.idPrefix + m;
		this._addItemIntoGlobalStrorage(g, q, v, "radio", n, o, c);
		if (this.idPull["polygon_" + q] == null) {
			this._renderSublevelPolygon(q, q)
		}
		this._renderSublevelItem(g, s - 1);
		this._redefineComplexState(q)
	}
	var l = (w != null ? w : this._genStr(24));
	this.itemPull[g]["group"] = l;
	if (this.radio[l] == null) {
		this.radio[l] = new Array()
	}
	this.radio[l][this.radio[l].length] = g;
	if (a == true) {
		this.setRadioChecked(l, String(g).replace(this.idPrefix, ""))
	}
};
dhtmlXMenuObject.prototype.serialize = function() {
	var a = "<menu>" + this._readLevel(this.idPrefix + this.topId) + "</menu>";
	return a
};
dhtmlXMenuObject.prototype._readLevel = function(l) {
	var m = "";
	for (var r in this.itemPull) {
		if (this.itemPull[r]["parent"] == l) {
			var c = "";
			var g = "";
			var u = "";
			var q = String(this.itemPull[r]["id"]).replace(this.idPrefix, "");
			var o = "";
			var s = (this.itemPull[r]["title"] != "" ? ' text="' + this.itemPull[r]["title"] + '"' : "");
			var n = "";
			if (this.itemPull[r]["type"] == "item") {
				if (this.itemPull[r]["imgen"] != "") {
					c = ' img="' + this.itemPull[r]["imgen"] + '"'
				}
				if (this.itemPull[r]["imgdis"] != "") {
					g = ' imgdis="' + this.itemPull[r]["imgdis"] + '"'
				}
				if (this.itemPull[r]["hotkey"] != "") {
					u = "<hotkey>" + this.itemPull[r]["hotkey"] + "</hotkey>"
				}
			}
			if (this.itemPull[r]["type"] == "separator") {
				o = ' type="separator"'
			} else {
				if (this.itemPull[r]["state"] == "disabled") {
					n = ' enabled="false"'
				}
			}
			if (this.itemPull[r]["type"] == "checkbox") {
				o = ' type="checkbox"' + (this.itemPull[r]["checked"] ? ' checked="true"' : "")
			}
			if (this.itemPull[r]["type"] == "radio") {
				o = ' type="radio" group="' + this.itemPull[r]["group"] + '" ' + (this.itemPull[r]["checked"] ? ' checked="true"' : "")
			}
			m += "<item id='" + q + "'" + s + o + c + g + n + ">";
			m += u;
			if (this.itemPull[r]["complex"]) {
				m += this._readLevel(r)
			}
			m += "</item>"
		}
	}
	return m
};
dhtmlXMenuObject.prototype.enableEffect = function(g, m, l) {
	this._menuEffect = (g == "opacity" || g == "slide" || g == "slide+" ? g : false);
	this._pOpStyleIE = (navigator.userAgent.search(/MSIE\s[678]\.0/gi) >= 0);
	for (var c in this.idPull) {
		if (c.search(/polygon/) === 0) {
			this._pOpacityApply(c, (this._pOpStyleIE ? 100 : 1));
			this.idPull[c].style.height = ""
		}
	}
	this._pOpMax = (typeof(m) == "undefined" ? 100 : m) / (this._pOpStyleIE ? 1 : 100);
	this._pOpStyleName = (this._pOpStyleIE ? "filter" : "opacity");
	this._pOpStyleValue = (this._pOpStyleIE ? "progid:DXImageTransform.Microsoft.Alpha(Opacity=#)" : "#");
	this._pSlSteps = (this._pOpStyleIE ? 10 : 20);
	this._pSlTMTimeMax = l || 50
};
dhtmlXMenuObject.prototype._showPolygonEffect = function(a) {
	this._pShowHide(a, true)
};
dhtmlXMenuObject.prototype._hidePolygonEffect = function(a) {
	this._pShowHide(a, false)
};
dhtmlXMenuObject.prototype._pOpacityApply = function(a, c) {
	this.idPull[a].style[this._pOpStyleName] = String(this._pOpStyleValue).replace("#", c || this.idPull[a]._op)
};
dhtmlXMenuObject.prototype._pShowHide = function(a, c) {
	if (!this.idPull) {
		return
	}
	if (this.idPull[a]._tmShow != null) {
		if ((this.idPull[a]._step_h > 0 && c == true) || (this.idPull[a]._step_h < 0 && c == false)) {
			return
		}
		window.clearTimeout(this.idPull[a]._tmShow);
		this.idPull[a]._tmShow = null;
		this.idPull[a]._max_h = null
	}
	if (c == false && (this.idPull[a].style.visibility == "hidden" || this.idPull[a].style.display == "none")) {
		return
	}
	if (c == true && this.idPull[a].style.display == "none") {
		this.idPull[a].style.visibility = "hidden";
		this.idPull[a].style.display = ""
	}
	if (this.idPull[a]._max_h == null) {
		this.idPull[a]._max_h = parseInt(this.idPull[a].offsetHeight);
		this.idPull[a]._h = (c == true ? 0 : this.idPull[a]._max_h);
		this.idPull[a]._step_h = Math.round(this.idPull[a]._max_h / this._pSlSteps) * (c == true ? 1 : -1);
		if (this.idPull[a]._step_h == 0) {
			return
		}
		this.idPull[a]._step_tm = Math.round(this._pSlTMTimeMax / this._pSlSteps);
		if (this._menuEffect == "slide+" || this._menuEffect == "opacity") {
			this.idPull[a].op_tm = this.idPull[a]._step_tm;
			this.idPull[a].op_step = (this._pOpMax / this._pSlSteps) * (c == true ? 1 : -1);
			if (this._pOpStyleIE) {
				this.idPull[a].op_step = Math.round(this.idPull[a].op_step)
			}
			this.idPull[a]._op = (c == true ? 0 : this._pOpMax);
			this._pOpacityApply(a)
		} else {
			this.idPull[a]._op = (this._pOpStyleIE ? 100 : 1);
			this._pOpacityApply(a)
		}
		if (this._menuEffect.search(/slide/) === 0) {
			this.idPull[a].style.height = "0px"
		}
		this.idPull[a].style.visibility = "visible"
	}
	this._pEffectSet(a, this.idPull[a]._h + this.idPull[a]._step_h)
};
dhtmlXMenuObject.prototype._pEffectSet = function(g, c) {
	if (!this.idPull) {
		return
	}
	if (this.idPull[g]._tmShow) {
		window.clearTimeout(this.idPull[g]._tmShow)
	}
	this.idPull[g]._h = Math.max(0, Math.min(c, this.idPull[g]._max_h));
	if (this._menuEffect.search(/slide/) === 0) {
		this.idPull[g].style.height = this.idPull[g]._h + "px"
	}
	c += this.idPull[g]._step_h;
	if (this._menuEffect == "slide+" || this._menuEffect == "opacity") {
		this.idPull[g]._op = Math.max(0, Math.min(this._pOpMax, this.idPull[g]._op + this.idPull[g].op_step));
		this._pOpacityApply(g)
	}
	if ((this.idPull[g]._step_h > 0 && c <= this.idPull[g]._max_h) || (this.idPull[g]._step_h < 0 && c >= 0)) {
		var a = this;
		this.idPull[g]._tmShow = window.setTimeout(function() {
			a._pEffectSet(g, c)
		}, this.idPull[g]._step_tm)
	} else {
		if (this._menuEffect.search(/slide/) === 0) {
			this.idPull[g].style.height = ""
		}
		if (this.idPull[g]._step_h < 0) {
			this.idPull[g].style.visibility = "hidden"
		}
		if (this._menuEffect == "slide+" || this._menuEffect == "opacity") {
			this.idPull[g]._op = (this.idPull[g]._step_h < 0 ? (this._pOpStyleIE ? 100 : 1) : this._pOpMax);
			this._pOpacityApply(g)
		}
		this.idPull[g]._tmShow = null;
		this.idPull[g]._h = null;
		this.idPull[g]._max_h = null;
		this.idPull[g]._step_tm = null
	}
};

function dhtmlXRibbon(l) {
	var g = this,
		c, a;
	this.conf = {
		type: "ribbon",
		icons_path: (l && l.icons_path) ? l.icons_path : "",
		arrows_mode: (l && l.arrows_mode) ? l.arrows_mode : null,
		skin: "dhx_skyblue"
	};
	this._eventHandlers = {};
	this._base = null;
	this._items = {};
	this._tabbar = null;
	this.childIds = [];
	if (typeof(l) == "string") {
		a = l
	} else {
		if (l && l.tagName) {
			a = l
		} else {
			if (l && l.parent) {
				if (l.parent.tagName || typeof(l.parent) == "string") {
					a = l.parent
				}
			}
		}
	}
	this._doOnHighlight0 = function(q) {
		q = q || event;
		var o = q.target || q.srcElement;
		var m = g._findItemByNode(o);
		var n = g._items[m._dhx_ribbonId];
		if (n.conf.disable) {
			return
		}
		if (g.items[n.type] && typeof(g.items[n.type].mouseover) == "function") {
			if (g.items[n.type].mouseover(n, g, q) != true) {
				return false
			}
		}
		if (!/dhxrb_highlight0/.test(m.className)) {
			m.className += " dhxrb_highlight0"
		}
	};
	this._doOffHighlight0 = function(q) {
		q = q || event;
		var o = q.target || q.srcElement;
		var m = g._findItemByNode(o);
		var n = g._items[m._dhx_ribbonId];
		if (n.conf.disable) {
			return
		}
		if (g.items[n.type] && typeof(g.items[n.type].mouseout) == "function") {
			if (g.items[n.type].mouseout(n, g, q) != true) {
				return false
			}
		}
		if (/dhxrb_highlight1/.test(m.className)) {
			m.className = m.className.replace(/\s?dhxrb_highlight1/, "")
		}
		if (/dhxrb_highlight0/.test(m.className)) {
			m.className = m.className.replace(/\s?dhxrb_highlight0/, "")
		}
	};
	this._doOnHighlight1 = function(q) {
		q = q || event;
		var o = q.target || q.srcElement;
		var m = g._findItemByNode(o);
		var n = g._items[m._dhx_ribbonId];
		if (n.conf.disable) {
			return
		}
		g.callEvent("_showPopup", [n.id]);
		if (g.items[n.type] && typeof(g.items[n.type].mousedown) == "function") {
			if (g.items[n.type].mousedown(n, g, q) != true) {
				return false
			}
		}
		if (!/dhxrb_highlight1/.test(m.className)) {
			m.className += " dhxrb_highlight1"
		}
	};
	this._doOffHighlight1 = function(q) {
		q = q || event;
		var o = q.target || q.srcElement;
		var m = g._findItemByNode(o);
		var n = g._items[m._dhx_ribbonId];
		if (n.conf.disable) {
			return
		}
		if (g.items[n.type] && typeof(g.items[n.type].mouseup) == "function") {
			if (g.items[n.type].mouseup(n, g, q) != true) {
				return false
			}
		}
		if (/dhxrb_highlight1/.test(m.className)) {
			m.className = m.className.replace(/\s?dhxrb_highlight1/, "")
		}
	};
	this._doOnClick = function(q) {
		q = q || event;
		var o = q.target || q.srcElement;
		var m = g._findItemByNode(o);
		var n = g._items[m._dhx_ribbonId];
		if (n.conf.disable) {
			return
		}
		if (g.items[n.type] && typeof(g.items[n.type].click) == "function") {
			g.items[n.type].click(n, g, q)
		}
	};
	this._doOnFocus = function(q) {
		q = q || event;
		var o = q.target || q.srcElement;
		var m = g._findItemByNode(o);
		var n = g._items[m._dhx_ribbonId];
		if (n.conf.disable) {
			return
		}
		g.callEvent("_showPopup", [n.id]);
		if (g.items[n.type] && typeof(g.items[n.type].focus) == "function") {
			g.items[n.type].focus(n, g, q)
		}
	};
	this._doOnBlur = function(q) {
		q = q || event;
		var o = q.target || q.srcElement;
		var m = g._findItemByNode(o);
		var n = g._items[m._dhx_ribbonId];
		if (n.conf.disable) {
			return
		}
		if (g.items[n.type] && typeof(g.items[n.type].blur) == "function") {
			g.items[n.type].blur(n, g, q)
		}
	};
	this._doOnChange = function(q) {
		q = q || event;
		var o = q.target || q.srcElement;
		var m = g._findItemByNode(o);
		var n = g._items[m._dhx_ribbonId];
		if (n.conf.disable) {
			return
		}
		if (g.items[n.type] && typeof(g.items[n.type].change) == "function") {
			g.items[n.type].change(n, g, q)
		}
	};
	this._doOnKeydown = function(q) {
		q = q || event;
		var o = q.target || q.srcElement;
		var m = g._findItemByNode(o);
		var n = g._items[m._dhx_ribbonId];
		if (n.conf.disable) {
			return
		}
		if (g.items[n.type] && typeof(g.items[n.type].keydown) == "function") {
			g.items[n.type].keydown(n, g, q)
		}
	};
	this._tabCustomApi = {
		enable: function(q, o) {
			var n = null,
				m = null;
			o = o || false;
			if (o != true) {
				n = g._items[this._idd];
				for (m in n.childIds) {
					m = parseInt(m);
					g.enable(n.childIds[m])
				}
			}
			return g._tabOriginalApi.enable.apply(this, [q])
		},
		disable: function(q, o) {
			var n = null,
				m = null;
			if (o != false) {
				n = g._items[this._idd];
				for (m in n.childIds) {
					m = parseInt(m);
					g.disable(n.childIds[m])
				}
			}
			return g._tabOriginalApi.disable.apply(this, [q])
		},
		close: function(o) {
			var n = g._items[this._idd],
				m;
			g._removeTab(n);
			g._tabOriginalApi.close.apply(this, [o]);
			for (m in g._tabOriginalApi) {
				this[m] = null
			}
		}
	};
	this._attachEventTabbar = function() {
		this._tabbar.attachEvent("onSelect", function() {
			return g.callEvent("onSelect", arguments)
		});
		this._tabbar.attachEvent("onTabClick", function() {
			return g.callEvent("onTabClick", arguments)
		});
		this._tabbar.attachEvent("onTabClose", function() {
			return g.callEvent("onTabClose", arguments)
		})
	};
	if (typeof(a) == "string") {
		this._base = document.getElementById(a)
	} else {
		if (a && a.tagName) {
			this._base = a
		} else {
			this._base = document.createElement("div");
			this._base._dhx_remove = true;
			if (document.body.firstChild) {
				document.body.insertBefore(this._base, document.body.firstChild)
			} else {
				document.body.appendChild(this._base)
			}
		}
	}
	c = dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || dhx4.skinDetect("dhtmlxribbon") || "dhx_skyblue";
	if (typeof(l) == "object" && l.skin) {
		c = l.skin
	}
	this.setSkin(c);
	dhx4._eventable(this);
	dhx4._enableDataLoading(this, "_renderData", "_xmlToJson", "ribbon", {
		struct: true
	});
	this.attachEvent("_onHeightChanged", function() {
		this.conf.inited = true
	});
	this._base.className += " dhxrb_without_tabbar";
	this._base.innerHTML = "<div class='dhxrb_background_area'></div>";
	if (l != null) {
		if (l.json) {
			this.loadStruct(l.json, l.onload)
		} else {
			if (l.xml) {
				this.loadStruct(l.xml, l.onload)
			} else {
				this._renderData(l)
			}
		}
	}
	this.unload = function() {
		var n = null,
			m = [];
		for (n in this.childIds) {
			n = parseInt(n);
			m.push(this.childIds[n])
		}
		dhx4._enableDataLoading(this, null, null, null, "clear");
		dhx4._eventable(this, "clear");
		for (n in m) {
			n = parseInt(n);
			if (this._items[m[n]].type == "tab") {
				this.tabs(m[n]).close(false)
			} else {
				this.removeItem(m[n])
			}
		}
		if (this._tabbar) {
			this._tabbar.unload();
			this._tabbar = null
		}
		this._base.innerHTML = "";
		if (this._base._dhx_remove) {
			this._base.parentNode.removeChild(this._base)
		} else {
			this._base.className = this._base.className.replace(/\s?(dhtmlx|dhxrb)(\S*)/ig, "")
		}
		for (n in this) {
			this[n] = null
		}
		g = null
	}
}
dhtmlXRibbon.prototype.setSizes = function() {
	if (this._tabbar != null && typeof(this.setSizes) == "function") {
		this._tabbar.setSizes()
	}
};
dhtmlXRibbon.prototype._renderData = function(c) {
	var a = this._base.firstChild;
	if (c != null) {
		this.conf.icons_path = c.icons_path || this.conf.icons_path;
		if (c.tabs instanceof Array) {
			this._base.className = this._base.className.replace(/\s?dhxrb_without_tabbar/i, "");
			a.className = "dhxrb_with_tabbar";
			this._tabbar = new dhtmlXTabBar(a);
			this._attachEventTabbar();
			this._tabbar.setSkin(this.conf.skin);
			if (this.conf.arrows_mode != null) {
				this._tabbar.setArrowsMode(this.conf.arrows_mode)
			}
			this.childIds = this._appendTabs(c.tabs)
		} else {
			if (c.items instanceof Array) {
				if (!/\s?dhxrb_without_tabbar/i.test(this._base.className)) {
					this._base.className += " dhxrb_without_tabbar"
				}
				if (/\s?dhxrb_background_area/i.test(a.className)) {
					a.className = "dhxrb_background_area"
				}
				a.innerHTML = "<div class='dhxrb_g_area'></div>";
				this.childIds = this._appendBlocks(c.items, a.firstChild)
			}
		}
		this.callEvent("_onHeightChanged", [])
	}
};
dhtmlXRibbon.prototype._xmlToJson = function(c) {
	var a = c.lastChild || null,
		l = {},
		g = [];
	if (a && a.tagName == "ribbon") {
		g = this._convertXmlNodeListIntoObject(a.childNodes)
	}
	if (g[0] && g[0].type && g[0].type.toLowerCase() == "block") {
		l.items = g
	} else {
		l.tabs = g
	}
	return l
};
dhtmlXRibbon.prototype._convertXmlNodeListIntoObject = function(c) {
	var g, a, n = [],
		m;
	a = c.length;
	for (g = 0; g < a; g++) {
		m = this._covertXmlNodeToObject(c[g]);
		if (m) {
			n.push(m)
		}
	}
	return n
};
dhtmlXRibbon.prototype._covertXmlNodeToObject = function(m) {
	if (!m || !m.tagName || !(m.tagName.toLowerCase() == "item" || m.tagName.toLowerCase() == "tab")) {
		return null
	}
	var g, a, c = m.attributes,
		n = {};
	a = c.length;
	for (g = 0; g < a; g++) {
		switch (c[g].name) {
			case "isbig":
				n.isbig = dhx4.s2b(c[g].value);
				break;
			case "state":
				n.state = dhx4.s2b(c[g].value);
				break;
			default:
				n[c[g].name] = c[g].value
		}
	}
	if (m.childNodes.length) {
		if (m.getAttribute("type") == "buttonCombo" || m.getAttribute("type") == "buttonSelect") {
			n.data = m
		} else {
			if (m.tagName.toLowerCase() == "tab") {
				n.items = this._convertXmlNodeListIntoObject(m.childNodes)
			} else {
				n.list = this._convertXmlNodeListIntoObject(m.childNodes)
			}
		}
	}
	return n
};
dhtmlXRibbon.prototype._appendTabs = function(n) {
	var c, a, g, m = [];
	a = n.length;
	for (c = 0; c < a; c++) {
		g = this._addTab(n[c]);
		if (n[c].items instanceof Array) {
			g.childIds = this._appendBlocks(n[c].items, g.base, g)
		}
		m.push(g.id)
	}
	return m
};
dhtmlXRibbon.prototype._addTab = function(g) {
	var a, l, c = {
		conf: {
			active: false,
			text: "",
			width: null,
			position: null,
			disable: false
		},
		base: document.createElement("div"),
		type: "tab",
		childIds: []
	};
	for (a in g) {
		if (a == "items") {
			continue
		}
		c.conf[a] = g[a]
	}
	if (!g.id) {
		c.id = dhx4.newId()
	} else {
		c.id = g.id
	}
	while (this._items[c.id]) {
		c.id = dhx4.newId()
	}
	this._tabbar.addTab(c.id, c.conf.text, c.conf.width, c.conf.position, c.conf.active);
	c.base.className = "dhxrb_g_area";
	c.base._dhx_ribbonId = c.id;
	this.tabs(c.id).attachObject(c.base);
	this._changeApiForTab(this.tabs(c.id));
	this._items[c.id] = c;
	return c
};
dhtmlXRibbon.prototype._changeApiForTab = function(c) {
	var a;
	for (a in this._tabOriginalApi) {
		this._tabOriginalApi[a] = this._tabOriginalApi[a] || c[a];
		c[a] = this._tabCustomApi[a]
	}
};
dhtmlXRibbon.prototype._tabOriginalApi = {
	enable: null,
	disable: null,
	close: null
};
dhtmlXRibbon.prototype._appendBlocks = function(a, v, g) {
	var o, m, r, n, s, c, u = [];
	g = g || null;
	m = a.length;
	for (o = 0; o < m; o++) {
		if (typeof(a[o]) == "object" && a[o].type == "block") {
			r = this._addBlock(a[o], v);
			if (a[o].list && (a[o].list instanceof Array)) {
				n = a[o].list;
				s = n.length;
				for (c = 0; c < s; c++) {
					this._addItem(r.id, null, null, n[c])
				}
			}
			if (g != null) {
				r.parentId = g.id
			}
			if (r.conf.disable) {
				this.disable(r.id)
			}
			u.push(r.id)
		}
	}
	return u
};
dhtmlXRibbon.prototype._addBlock = function(n, m) {
	var g, a, o, c;
	o = {
		conf: {
			text: "",
			text_pos: "bottom",
			type: "block",
			mode: "cols",
			disable: false
		},
		type: "block",
		childIds: [],
		base: document.createElement("div"),
		contForItems: document.createElement("div"),
		contForText: document.createElement("div")
	};
	for (c in n) {
		if (c == "list" || c == "type" || c == "id") {
			continue
		}
		o.conf[c] = n[c]
	}
	if (!n.id) {
		o.id = dhx4.newId()
	} else {
		o.id = n.id
	}
	while (this._items[o.id]) {
		o.id = dhx4.newId()
	}
	o.base.className = "dhxrb_block_base";
	m.appendChild(o.base);
	o.contForItems.className = "dhxrb_block_items";
	o.contForText.className = "dhxrb_block_label";
	o.base.appendChild(o.contForItems);
	if (o.conf.text) {
		o.contForText.innerHTML = o.conf.text;
		if (o.conf.text_pos == "top") {
			o.base.insertBefore(o.contForText, o.contForItems)
		} else {
			o.base.appendChild(o.contForText)
		}
	}
	o.base._dhx_ribbonId = o.id;
	this._items[o.id] = o;
	return o
};
dhtmlXRibbon.prototype._addItem = function(g, c, r, o) {
	var m = this._items[g],
		a, n, u = null,
		q = this,
		l;
	if (o.type != "newLevel" && !this.items[o.type]) {
		return null
	}
	if (o.type == "newLevel") {
		this._addNewLevel(m)
	} else {
		if (m.type == "group") {
			a = document.createElement("div");
			a.className = "dhxrb_in_group";
			m.base.appendChild(a)
		} else {
			if (o.isbig) {
				a = document.createElement("div");
				a.className = "dhxrb_big_button";
				m.contForItems.appendChild(a)
			} else {
				n = this._getContainerForSmallItem(m);
				a = document.createElement("div");
				a.className = (m.conf.mode == "rows") ? "dhxrb_in_row" : "dhxrb_3rows_button";
				n.appendChild(a)
			}
		}
	}
	if (a) {
		this._attachEventForItem(a);
		l = {
			icons_path: o.icons_path || this.conf.icons_path,
			skin: this.conf.skin
		};
		for (var s in o) {
			l[s] = o[s]
		}
		if (!l.id) {
			l.id = dhx4.newId()
		}
		while (this._items[l.id]) {
			l.id = dhx4.newId()
		}
		u = (this.items[l.type] && this.items[l.type].render) ? this.items[l.type].render(a, l) : null
	}
	if (u != null) {
		this._items[u.id] = u;
		u.parentId = m.id;
		m.childIds.push(u.id);
		a._dhx_ribbonId = u.id;
		if (l.onclick && (typeof(l.onclick) == "function")) {
			this._eventHandlers[u.id] = this._eventHandlers[u.id] || {};
			this._eventHandlers[u.id]["onclick"] = l.onclick
		}
		u.callEvent = function() {
			q.callEvent.apply(q, arguments)
		};
		u._callHandler = function() {
			q._callHandler.apply(q, arguments)
		};
		if (this.items[l.type] && typeof(this.items[l.type].callAfterInit) == "function") {
			this.items[l.type].callAfterInit.apply(this, [u])
		}
	}
	return u
};
dhtmlXRibbon.prototype._callHandler = function(c, a) {
	if (this._eventHandlers[c] && this._eventHandlers[c].onclick) {
		this._eventHandlers[c].onclick.apply(this, a)
	}
};
dhtmlXRibbon.prototype.items = {};
dhtmlXRibbon.prototype.items.button = {
	render: function(c, a) {
		var g, l;
		l = {
			base: c,
			id: a.id,
			type: a.type,
			conf: {
				text: "",
				text_pos: (a.isbig) ? "bottom" : "right",
				img: null,
				imgdis: null,
				isbig: false,
				disable: false,
				skin: a.skin
			}
		};
		for (g in a) {
			if (g == "id" || g == "onclick" || g == "type") {
				continue
			}
			l.conf[g] = a[g]
		}
		c.innerHTML = "<img class='dhxrb_image" + ((l.conf.img) ? "'" : " dhxrb_invisible'") + " src='" + ((l.conf.img) ? l.conf.icons_path + l.conf.img : "") + "' /><div class='dhxrb_label_button'>" + l.conf.text + "</div>";
		if (typeof(this.afterRender) == "function") {
			this.afterRender(l)
		}
		if (l.conf.disable) {
			this.disable(l)
		}
		return l
	},
	getText: function(a) {
		return a.conf.text
	},
	setText: function(c, g) {
		var a = c.base.childNodes[1];
		c.conf.text = g;
		a.innerHTML = g
	},
	setImage: function(c, a) {
		c.conf.img = a;
		if (c.conf.disable == false) {
			c.base.childNodes[0].src = c.conf.icons_path + c.conf.img
		}
	},
	setImageDis: function(c, a) {
		c.conf.imgdis = a;
		if (c.conf.disable == true) {
			c.base.childNodes[0].src = c.conf.icons_path + c.conf.imgdis
		}
	},
	mousedown: function(a, g, c) {
		return true
	},
	click: function(a, g, c) {
		if (c.button != 0) {
			return false
		}
		g._callHandler(a.id, [a.id]);
		a.callEvent("onClick", [a.id]);
		return false
	},
	disable: function(c) {
		var g = c.base.childNodes[0],
			a = c.base.childNodes[1];
		if (c.conf.imgdis) {
			g.src = c.conf.icons_path + c.conf.imgdis;
			if (/\s?dhxrb_invisible/i.test(g.className)) {
				g.className = g.className.replace(/\s?dhxrb_invisible/i, "")
			}
		}
		if (!/\s?dhxrb_disable_text_style/i.test(a.className)) {
			a.className += " dhxrb_disable_text_style"
		}
		return true
	},
	enable: function(c) {
		var g = c.base.childNodes[0],
			a = c.base.childNodes[1];
		if (c.conf.img) {
			g.src = c.conf.icons_path + c.conf.img
		} else {
			if (!/\s?dhxrb_invisible/i.test(g.className)) {
				g.className += " dhxrb_invisible"
			}
		}
		if (/\s?dhxrb_disable_text_style/i.test(a.className)) {
			a.className = a.className.replace(/\s?dhxrb_disable_text_style/i, "")
		}
		return true
	}
};
dhtmlXRibbon.prototype.items.buttonTwoState = {
	click: function(a, g, c) {
		return false
	},
	afterRender: function(a) {
		if (a.conf.state) {
			this.setState(a, a.conf.state)
		}
	},
	mouseover: function(a) {
		if (!/dhxrb_highlight0/.test(a.base.className)) {
			a.base.className += " dhxrb_highlight0"
		}
		return false
	},
	mouseout: function(a) {
		if (/dhxrb_highlight0/.test(a.base.className)) {
			a.base.className = a.base.className.replace(/\s?dhxrb_highlight0/, "")
		}
		return false
	},
	mousedown: function(a, g, c) {
		g._callHandler(a.id, [a.id, !a.conf.state]);
		this.setState(a, !a.conf.state, true);
		return false
	},
	mouseup: function(a) {
		return false
	},
	setState: function(a, c, g) {
		g = g || false;
		c = dhx4.s2b(c);
		if (c) {
			if (!/dhxrb_highlight1/.test(a.base.className)) {
				a.base.className += " dhxrb_highlight1"
			}
		} else {
			if (/dhxrb_highlight1/.test(a.base.className)) {
				a.base.className = a.base.className.replace(/\s?dhxrb_highlight1/, "")
			}
		}
		a.conf.state = c;
		if (g) {
			a.callEvent("onStateChange", [a.id, a.conf.state])
		}
	},
	getState: function(a) {
		return (a.conf.state == true)
	}
};
dhtmlXRibbon.prototype.items.buttonSegment = {
	click: function(a, g, c) {
		return false
	},
	mousedown: function(a, g, c) {
		this.setState(a, g, true);
		return false
	},
	callAfterInit: function(a) {
		if (a.conf.state || dhtmlXRibbon.prototype.items.buttonSegment._getSelectedNeighbor(a, this) == null) {
			if (a.conf.state) {
				a.conf.state = false
			}
			dhtmlXRibbon.prototype.items.buttonSegment.setState(a, this, false)
		}
	},
	afterRender: function() {},
	setState: function(a, m, l) {
		l = l || false;
		var g = null,
			c = dhx4.s2b(a.conf.state);
		if (c == false) {
			g = this._getSelectedNeighbor(a, m);
			if (g != null) {
				this._unSelect(g)
			}
			if (!/dhxrb_highlight1/.test(a.base.className)) {
				a.base.className += " dhxrb_highlight1"
			}
			a.conf.state = true;
			if (l) {
				m._callHandler(a.id, [a.id, (g ? g.id : null)]);
				m.callEvent("onStateChange", [a.id, (g ? g.id : null)])
			}
		}
	},
	remove: function(g, o) {
		var m = dhx4.s2b(g.conf.state),
			n = null,
			a = 0,
			c = o._items[g.parentId],
			l;
		if (m) {
			while (c.childIds[a] && n == null) {
				l = o._items[c.childIds[a]];
				if (l.type == "buttonSegment" && l != g) {
					n = l
				}
				a++
			}
			if (n) {
				this.setState(n, o)
			}
		}
	},
	_unSelect: function(a) {
		var c = dhx4.s2b(a.conf.state);
		if (c) {
			if (/dhxrb_highlight1/.test(a.base.className)) {
				a.base.className = a.base.className.replace(/\s?dhxrb_highlight1/, "")
			}
			a.conf.state = false
		}
	},
	_getSelectedNeighbor: function(m, q) {
		var g = q._items[m.parentId],
			c, a, o, n = null;
		a = g.childIds.length;
		for (c = 0; c < a; c++) {
			o = q._items[g.childIds[c]];
			if (o.type == "buttonSegment" && o.conf.state) {
				n = o;
				break
			}
		}
		return n
	}
};
dhtmlXRibbon.prototype.items.buttonSelect = {
	itemCollection: [],
	_isAttachedEventInWindow: false,
	afterRender: function(c) {
		var a = c.base.childNodes[1];
		a.innerHTML += "<span class='dhxrb_arrow'>&nbsp;</span>";
		c.menu = null;
		this.itemCollection.push(c);
		this._attachEventToWindow();
		a = null
	},
	setText: function(a, g) {
		var c = a.base.childNodes[1].lastChild;
		a.conf.text = g;
		a.base.childNodes[1].innerHTML = g;
		a.base.childNodes[1].appendChild(c)
	},
	setOptionText: function(a, g, c) {
		if (a.menu != null) {
			a.menu.setItemText(g, c)
		} else {
			this._loopThroughItems(a.conf.items, g, c, false)
		}
	},
	getOptionText: function(a, c) {
		if (a.menu != null) {
			return a.menu.getItemText(c)
		}
		return this._loopThroughItems(a.conf.items, c, null, true)
	},
	_loopThroughItems: function(a, n, m, l) {
		for (var g = 0; g < a.length; g++) {
			if (a[g].id == n) {
				if (l != true) {
					a[g].text = m;
					return true
				} else {
					return a[g].text
				}
			}
			if (a[g].items != null) {
				var c = this._loopThroughItems(a[g].items, n, m, l);
				if (c != null) {
					return c
				}
			}
		}
		return null
	},
	_attachEventToWindow: function() {
		if (this._isAttachedEventInWindow == false) {
			if (typeof(window.addEventListener) == "function") {
				document.body.addEventListener("mousedown", this._hideAllMenus, false)
			} else {
				document.body.attachEvent("onmousedown", this._hideAllMenus)
			}
			this._isAttachedEventInWindow = true
		}
	},
	_detachEventFromWindow: function() {
		if (typeof(window.addEventListener) == "function") {
			document.body.removeEventListener("mousedown", this._hideAllMenus, false)
		} else {
			document.body.detachEvent("onmousedown", this._hideAllMenus)
		}
		this._isAttachedEventInWindow = false
	},
	_hideAllMenus: function(n) {
		n = n || event;
		var g = n.target || n.srcElement;
		var a = true;
		while (g != null && a == true) {
			if (g.className != null && /SubLevelArea_Polygon/i.test(g.className)) {
				a = false
			} else {
				g = g.parentNode
			}
		}
		if (a == false) {
			return
		}
		var c = dhtmlXRibbon.prototype.items.buttonSelect.itemCollection;
		for (var o in c) {
			var l = c[o];
			if (l.menu instanceof dhtmlXMenuObject) {
				if (l._skipHiding) {
					l._skipHiding = false
				} else {
					dhtmlXRibbon.prototype.items.buttonSelect.hideMenu(l)
				}
			}
		}
	},
	mousedown: function(a, g, c) {
		a._skipHiding = true;
		this.showMenu(a);
		return false
	},
	mouseup: function(a) {
		return false
	},
	click: function() {},
	setState: function() {},
	showMenu: function(c) {
		var a = dhx4.absLeft(c.base),
			g = dhx4.absTop(c.base) + c.base.offsetHeight;
		if (!(c.menu instanceof dhtmlXMenuObject)) {
			c.menu = new dhtmlXMenuObject({
				parent: c.base,
				icons_path: c.conf.icons_path,
				context: true,
				items: c.conf.items,
				skin: c.conf.skin
			});
			if (c.conf.data) {
				c.menu.loadStruct(c.conf.data);
				delete c.conf.data
			}
			c.menu.setAutoHideMode(false);
			c.menu.attachEvent("onHide", function(l) {
				if (l == null) {
					dhtmlXRibbon.prototype.items.buttonSelect._doOnHideMenu(c)
				}
			});
			c.menu.attachEvent("onShow", function(l) {
				if (l == null) {
					dhtmlXRibbon.prototype.items.buttonSelect._doOnShowMenu(c)
				}
			});
			c.menu.attachEvent("onClick", function(l) {
				c.callEvent("onClick", [l, c.id])
			});
			c.base.oncontextmenu = function() {
				return false
			};
			dhtmlXRibbon.prototype.items.buttonSelect.showMenu(c)
		} else {
			c.menu.showContextMenu(a, g)
		}
	},
	hideMenu: function(a) {
		if (a.menu instanceof dhtmlXMenuObject) {
			a.menu.hideContextMenu()
		}
	},
	remove: function(c) {
		var g, a;
		if (c.menu instanceof dhtmlXMenuObject) {
			c.menu.unload();
			c.menu = null
		}
		c.base.oncontextmenu = null;
		g = dhtmlXRibbon.prototype._indexOf(dhtmlXRibbon.prototype.items.buttonSelect.itemCollection, c);
		if (g != -1) {
			dhtmlXRibbon.prototype.items.buttonSelect.itemCollection.splice(g, 1)
		}
		if (dhtmlXRibbon.prototype.items.buttonSelect.itemCollection.length == 0) {
			this._detachEventFromWindow()
		}
	},
	setSkin: function(a, c) {
		if (a.menu instanceof dhtmlXMenuObject) {
			a.menu.setSkin(c)
		}
	},
	_doOnHideMenu: function(a) {
		if (a._skipHiding) {
			a._skipHiding = false
		} else {
			if (/dhxrb_highlight1/.test(a.base.className)) {
				a.base.className = a.base.className.replace(/\s?dhxrb_highlight1/, "")
			}
		}
	},
	_doOnShowMenu: function(a) {
		if (!/dhxrb_highlight1/.test(a.base.className)) {
			a.base.className += " dhxrb_highlight1"
		}
	}
};
dhtmlXRibbon.prototype.items.group = {
	render: function(c, a) {
		var g, l;
		l = {
			base: c,
			id: a.id,
			type: a.type,
			conf: {
				disable: false,
				skin: a.skin
			},
			childIds: []
		};
		c.className = "dhxrb_group";
		for (g in a) {
			if (g == "id" || g == "onclick" || g == "type") {
				continue
			}
			l.conf[g] = a[g]
		}
		return l
	},
	callAfterInit: function(n) {
		this._detachEventFromItem(n.base);
		var m, a, o = n.conf.list,
			q, g, c;
		a = (o) ? o.length : 0;
		for (m = 0; m < a; m++) {
			q = this._addItem(n.id, null, null, o[m]);
			if (q == null) {
				continue
			}
			g = q.base.childNodes[1];
			if (g && !g.innerHTML && !/\s?dhxrb_label_hide/i.test(g.className)) {
				g.className += " dhxrb_label_hide"
			}
		}
		dhtmlXRibbon.prototype.items.group.normalize(n);
		if (n.conf.disable) {
			this.disable(n.id)
		}
		o = undefined
	},
	normalize: function(q) {
		var a = q.base.children;
		var g = a.length,
			c = false,
			r = 0;
		var m, o;
		for (var n = 0; n < g; n++) {
			if (!/dhxrb_separator_group/i.test(a[n].className)) {
				if (/dhxrb_item_hide/i.test(a[n].className)) {
					r++;
					continue
				}
			}
			if ((Math.ceil((n - r) / 2) - Math.floor((n - r) / 2)) == 0) {
				if (/dhxrb_separator_group/i.test(a[n].className)) {
					a[n].parentNode.removeChild(a[n]);
					c = true;
					break
				}
			} else {
				if (!/dhxrb_separator_group/i.test(a[n].className)) {
					m = document.createElement("div");
					m.className = "dhxrb_separator_groupp";
					q.base.insertBefore(m, a[n]);
					c = true;
					break
				}
			}
		}
		if (c) {
			this.normalize(q)
		} else {
			o = q.base.lastChild;
			if (o && /dhxrb_separator_group/i.test(o.className)) {
				o.parentNode.removeChild(o)
			}
		}
	},
	hideChild: function(c, l) {
		var a = dhtmlXRibbon.prototype._indexOf(c.base.children, l.base);
		if (a == 0) {
			a++
		} else {
			if (a != -1) {
				a--
			} else {
				return
			}
		}
		var g = c.base.children[a];
		if (g && /dhxrb_separator_group/i.test(g.className)) {
			g.parentNode.removeChild(g)
		}
	},
	showChild: function(a) {
		this.normalize(a)
	}
};
dhtmlXRibbon.prototype.items.input = {
	render: function(c, a) {
		var g, l;
		l = {
			base: c,
			id: a.id,
			type: a.type,
			conf: {
				text: "",
				text_pos: (a.isbig) ? "bottom" : "right",
				img: null,
				imgdis: null,
				isbig: false,
				disable: false,
				skin: a.skin,
				value: ""
			}
		};
		for (g in a) {
			if (g == "id" || g == "onclick" || g == "type") {
				continue
			}
			l.conf[g] = a[g]
		}
		c.innerHTML = "<input type='text' class='dhxrb_input'><div class='dhxrb_label_button'>" + l.conf.text + "</div>";
		if (typeof(this.afterRender) == "function") {
			this.afterRender(l)
		}
		if (l.conf.disable) {
			this.disable(l)
		}
		if (l.conf.width) {
			this.setWidth(l, l.conf.width)
		}
		if (l.conf.value) {
			this.setValue(l, l.conf.value)
		}
		return l
	},
	callAfterInit: function(c) {
		var a = c.base.childNodes[0];
		this._detachEventFromItem(c.base);
		this._attachEventsToInput(a)
	},
	setText: dhtmlXRibbon.prototype.items.button.setText,
	getText: dhtmlXRibbon.prototype.items.button.getText,
	change: function(c) {
		var a = c.base.childNodes[0];
		c.conf.value = a.value
	},
	keydown: function(c, l, g) {
		if (g.keyCode == 13) {
			var a = c.base.childNodes[0];
			c.conf.value = a.value;
			l.callEvent("onEnter", [c.id, c.conf.value])
		}
	},
	remove: function(c, g) {
		var a = c.base.childNodes[0];
		g._detachEventsFromInput(a)
	},
	getValue: function(c) {
		var a = c.base.childNodes[0],
			g;
		g = a.value;
		a = undefined;
		return g
	},
	setValue: function(c, g) {
		var a = c.base.childNodes[0],
			g;
		a.value = g;
		c.conf.value = g
	},
	setWidth: function(c, g) {
		var a = c.base.childNodes[0];
		a.style.width = parseInt(g) + "px"
	},
	disable: function(g) {
		var c = g.base.childNodes[0],
			a = g.base.childNodes[1];
		c.disabled = true;
		if (!/\s?dhxrb_disable_text_style/i.test(a.className)) {
			a.className += " dhxrb_disable_text_style"
		}
		return true
	},
	enable: function(g) {
		var c = g.base.childNodes[0],
			a = g.base.childNodes[1];
		c.disabled = false;
		if (/\s?dhxrb_disable_text_style/i.test(a.className)) {
			a.className = a.className.replace(/\s?dhxrb_disable_text_style/i, "")
		}
		return true
	},
	getInput: function(a) {
		return a.base.childNodes[0]
	}
};
dhtmlXRibbon.prototype.getInput = function(c) {
	var a = this._items[c];
	if (a == null || a.type != "input") {
		return null
	}
	return this.items[a.type].getInput(a)
};
dhtmlXRibbon.prototype.items.checkbox = {
	render: function(c, a) {
		var g, l;
		l = {
			base: c,
			id: a.id,
			type: a.type,
			conf: {
				text: "",
				text_pos: (a.isbig) ? "bottom" : "right",
				disable: false,
				checked: false
			}
		};
		for (g in a) {
			if (g == "id" || g == "onclick" || g == "type") {
				continue
			}
			l.conf[g] = a[g]
		}
		c.innerHTML = "<div class='dhxrb_checkbox'></div><div class='dhxrb_label_checkbox'>" + l.conf.text + "</div>";
		if (typeof(this.afterRender) == "function") {
			this.afterRender(l)
		}
		if (l.conf.checked) {
			this.check(l)
		}
		return l
	},
	callAfterInit: function(a) {
		if (a.conf.disable) {
			this.disable(a.id)
		}
	},
	setText: dhtmlXRibbon.prototype.items.button.setText,
	getText: dhtmlXRibbon.prototype.items.button.getText,
	mousedown: function(a) {
		return false
	},
	mouseup: function(a) {
		return false
	},
	click: function(a, g, c) {
		if (c.button != 0) {
			return false
		}
		if (a.type == "checkbox") {
			if (a.conf.checked) {
				this.uncheck(a, true)
			} else {
				this.check(a, true)
			}
		}
	},
	check: function(a, c) {
		c = c || false;
		if (a.type != "checkbox") {
			return
		}
		a.conf.checked = true;
		if (!/\s?dhxrb_checked/i.test(a.base.className)) {
			a.base.className += " dhxrb_checked"
		}
		if (c) {
			a.callEvent("onCheck", [a.id, a.conf.checked])
		}
	},
	uncheck: function(a, c) {
		c = c || false;
		if (a.type != "checkbox") {
			return
		}
		a.conf.checked = false;
		if (/\s?dhxrb_checked/i.test(a.base.className)) {
			a.base.className = a.base.className.replace(/\s?dhxrb_checked/i, "")
		}
		if (c) {
			a.callEvent("onCheck", [a.id, a.conf.checked])
		}
	},
	isChecked: function(a) {
		if (a.type != "checkbox") {
			return false
		}
		return (a.conf.checked == true)
	},
	disable: function(a) {
		return true
	},
	enable: function(a) {
		return true
	}
};
dhtmlXRibbon.prototype.items.text = {
	render: function(a, l) {
		var g = {
			base: a,
			id: l.id,
			type: l.type,
			conf: {
				text: ""
			}
		};
		for (var c in l) {
			if (c == "id" || c == "type") {
				continue
			}
			g.conf[c] = l[c]
		}
		a.innerHTML = "<div class='dhxrb_item_text'>" + g.conf.text + "</div>";
		if (typeof(this.afterRender) == "function") {
			this.afterRender(g)
		}
		return g
	},
	callAfterInit: function(a) {
		this._detachEventFromItem(a.base)
	},
	getText: function(a) {
		return a.conf.text
	},
	setText: function(a, c) {
		a.conf.text = c;
		a.base.innerHTML = c
	}
};
dhtmlXRibbon.prototype.items.buttonCombo = {
	render: function(a, c) {
		var g, l, m = {};
		l = {
			base: a,
			id: c.id,
			type: c.type,
			conf: {
				text: "",
				text_pos: "right",
				width: 140,
				skin: c.skin,
				callEvent: true
			}
		};
		for (g in c) {
			if (g == "id" || g == "onclick" || g == "type") {
				continue
			}
			l.conf[g] = c[g]
		}
		for (g in l.conf) {
			if (g == "text" || g == "text_pos" || g == "disable" || g == "data") {
				continue
			}
			m[g] = l.conf[g]
		}
		l.base.className += " dhxrb_buttoncombo_cont";
		l.base.innerHTML = "<div class='dhxrb_buttoncombo'></div><div class='dhxrb_label_button'>" + l.conf.text + "</div>";
		m.parent = l.base.firstChild;
		l.combo = new dhtmlXCombo(m);
		l.combo.setSkin(m.skin);
		l.combo.attachEvent("onChange", function(n, o) {
			l._callHandler(l.id, [n, o]);
			if (l.conf.callEvent == true) {
				l.callEvent("onSelectOption", [l.id, n, o])
			}
			l.conf.callEvent = true
		});
		if (l.conf.data) {
			l.combo.load(l.conf.data);
			delete l.conf.data
		}
		if (typeof(this.afterRender) == "function") {
			this.afterRender(l)
		}
		if (l.conf.disable) {
			this.disable(l)
		}
		return l
	},
	callAfterInit: function(a) {
		this._detachEventFromItem(a.base)
	},
	disable: function(c) {
		var a = c.base.lastChild;
		if (c.combo instanceof dhtmlXCombo) {
			c.combo.disable()
		}
		if (!/\s?dhxrb_disable_text_style/i.test(a.className)) {
			a.className += " dhxrb_disable_text_style"
		}
		return true
	},
	enable: function(c) {
		var a = c.base.lastChild;
		if (c.combo instanceof dhtmlXCombo) {
			c.combo.enable()
		}
		if (/\s?dhxrb_disable_text_style/i.test(a.className)) {
			a.className = a.className.replace(/\s?dhxrb_disable_text_style/i, "")
		}
		return true
	},
	remove: function(a) {
		if (a.combo instanceof dhtmlXCombo) {
			a.combo.unload();
			a.combo = null
		}
	},
	getValue: function(a) {
		var c = null;
		if (a.combo instanceof dhtmlXCombo) {
			c = a.combo.getSelectedValue()
		}
		return c
	},
	setValue: function(a, c, g) {
		if (a.combo instanceof dhtmlXCombo) {
			a.conf.callEvent = g;
			a.combo.setComboValue(c)
		}
	},
	setSkin: function(a, c) {
		if (a.combo instanceof dhtmlXCombo) {
			a.combo.setSkin(c)
		}
	}
};
dhtmlXRibbon.prototype.items.slider = {
	render: function(a, m) {
		var g, l, c = {};
		l = {
			base: a,
			id: m.id,
			type: m.type,
			conf: {
				text: "",
				text_pos: "right",
				size: 150,
				vertical: false,
				min: 0,
				max: 99,
				value: 0,
				step: 1,
				margin: 10,
				disabled: false,
				enableTooltip: false
			}
		};
		for (g in m) {
			if (g == "id" || g == "onclick" || g == "type") {
				continue
			}
			l.conf[g] = m[g]
		}
		for (g in l.conf) {
			if (g == "text" || g == "text_pos" || g == "isbig") {
				continue
			}
			c[g] = l.conf[g]
		}
		l.base.innerHTML = "<center><div class='dhxrb_slider'></div></center><div class='dhxrb_label_button'>" + l.conf.text + "</div>";
		c.parent = l.base.firstChild.firstChild;
		l.slider = new dhtmlXSlider(c);
		if (typeof(this.afterRender) == "function") {
			this.afterRender(l)
		}
		if (l.conf.disable) {
			this.disable(l)
		}
		l.slider.attachEvent("onChange", function(n) {
			l._callHandler(l.id, [n]);
			l.callEvent("onValueChange", [l.id, n])
		});
		return l
	},
	callAfterInit: function(a) {
		this._detachEventFromItem(a.base)
	},
	setSkin: function(a, c) {
		if (a.slider instanceof dhtmlXSlider) {
			a.slider.setSkin(c)
		}
	},
	disable: function(c) {
		var a = c.base.childNodes[1];
		if (c.slider instanceof dhtmlXSlider) {
			c.slider.disable()
		}
		if (!/\s?dhxrb_disable_text_style/i.test(a.className)) {
			a.className += " dhxrb_disable_text_style"
		}
		return true
	},
	enable: function(c) {
		var a = c.base.childNodes[1];
		if (c.slider instanceof dhtmlXSlider) {
			c.slider.enable()
		}
		if (/\s?dhxrb_disable_text_style/i.test(a.className)) {
			a.className = a.className.replace(/\s?dhxrb_disable_text_style/i, "")
		}
		return true
	},
	remove: function(a) {
		if (a.slider instanceof dhtmlXSlider) {
			a.slider.unload();
			a.slider = null
		}
	},
	getValue: function(a) {
		var c = null;
		if (a.slider instanceof dhtmlXSlider) {
			c = a.slider.getValue()
		}
		return c
	},
	setValue: function(a, c) {
		if (a.slider instanceof dhtmlXSlider) {
			a.slider.setValue(c)
		}
	}
};
dhtmlXRibbon.prototype.items._extends = function(g, c) {
	var a;
	for (a in c) {
		g[a] = g[a] || c[a]
	}
	return g
};
dhtmlXRibbon.prototype._addNewLevel = function(g) {
	var c, a;
	if (g.conf.mode == "rows") {
		c = g.contForItems.lastChild;
		if (c && /dhxrb_block_rows/i.test(c.className) && (c.childNodes.length < 3)) {
			a = document.createElement("div");
			a.className = "dhxrb_block_row";
			c.appendChild(a)
		} else {
			c = document.createElement("div");
			c.className = "dhxrb_block_rows";
			g.contForItems.appendChild(c);
			a = document.createElement("div");
			a.className = "dhxrb_block_row";
			c.appendChild(a)
		}
	} else {
		var a = document.createElement("div");
		a.className = "dhxrb_3rows_block";
		g.contForItems.appendChild(a)
	}
};
dhtmlXRibbon.prototype._attachEventForItem = function(a) {
	if (typeof(window.addEventListener) == "function") {
		a.addEventListener("mouseover", this._doOnHighlight0, false);
		a.addEventListener("mouseout", this._doOffHighlight0, false);
		a.addEventListener("mousedown", this._doOnHighlight1, false);
		a.addEventListener("mouseup", this._doOffHighlight1, false);
		a.addEventListener("click", this._doOnClick, false)
	} else {
		a.attachEvent("onmouseover", this._doOnHighlight0);
		a.attachEvent("onmouseout", this._doOffHighlight0);
		a.attachEvent("onmousedown", this._doOnHighlight1);
		a.attachEvent("onmouseup", this._doOffHighlight1);
		a.attachEvent("onclick", this._doOnClick)
	}
};
dhtmlXRibbon.prototype._detachEventFromItem = function(a) {
	if (typeof(window.addEventListener) == "function") {
		a.removeEventListener("mouseover", this._doOnHighlight0, false);
		a.removeEventListener("mouseout", this._doOffHighlight0, false);
		a.removeEventListener("mousedown", this._doOnHighlight1, false);
		a.removeEventListener("mouseup", this._doOffHighlight1, false);
		a.removeEventListener("click", this._doOnClick, false)
	} else {
		a.detachEvent("onmouseover", this._doOnHighlight0);
		a.detachEvent("onmouseout", this._doOffHighlight0);
		a.detachEvent("onmousedown", this._doOnHighlight1);
		a.detachEvent("onmouseup", this._doOffHighlight1);
		a.detachEvent("onclick", this._doOnClick)
	}
};
dhtmlXRibbon.prototype._attachEventsToInput = function(a) {
	if (typeof(window.addEventListener) == "function") {
		a.addEventListener("focus", this._doOnFocus, false);
		a.addEventListener("blur", this._doOnBlur, false);
		a.addEventListener("change", this._doOnChange, false);
		a.addEventListener("keydown", this._doOnKeydown, false)
	} else {
		a.attachEvent("onfocus", this._doOnFocus);
		a.attachEvent("onblur", this._doOnBlur);
		a.attachEvent("onchange", this._doOnChange);
		a.attachEvent("onkeydown", this._doOnKeydown)
	}
};
dhtmlXRibbon.prototype._detachEventsFromInput = function(a) {
	if (typeof(window.addEventListener) == "function") {
		a.removeEventListener("focus", this._doOnFocus, false);
		a.removeEventListener("blur", this._doOnBlur, false);
		a.removeEventListener("change", this._doOnChange, false);
		a.removeEventListener("keydown", this._doOnKeydown, false)
	} else {
		a.detachEvent("onfocus", this._doOnFocus);
		a.detachEvent("onblur", this._doOnBlur);
		a.detachEvent("onchange", this._doOnChange);
		a.detachEvent("onkeydown", this._doOnKeydown)
	}
};
dhtmlXRibbon.prototype._getContainerForSmallItem = function(g) {
	var c = g.contForItems.lastChild,
		a = null;
	if (g.conf.mode == "rows") {
		if (c && /\s?dhxrb_block_rows/i.test(c.className)) {
			a = c.lastChild;
			if (!a) {
				a = document.createElement("div");
				a.className = "dhxrb_block_row";
				c.appendChild(a)
			}
		} else {
			c = document.createElement("div");
			c.className = "dhxrb_block_rows";
			g.contForItems.appendChild(c);
			a = document.createElement("div");
			a.className = "dhxrb_block_row";
			c.appendChild(a)
		}
	} else {
		if (c && /dhxrb_3rows_block/i.test(c.className) && (c.childNodes.length < 3)) {
			a = c
		} else {
			a = document.createElement("div");
			a.className = "dhxrb_3rows_block";
			g.contForItems.appendChild(a)
		}
	}
	return a
};
dhtmlXRibbon.prototype._findItemByNode = function(a) {
	while (a && !a._dhx_ribbonId) {
		a = a.parentNode
	}
	return a
};
dhtmlXRibbon.prototype._indexOf = function(a, m) {
	var g, c;
	c = a.length;
	for (g = 0; g < c; g++) {
		if (a[g] == m) {
			return g
		}
	}
	return -1
};
dhtmlXRibbon.prototype._removeItem = function(g) {
	var a, l = -1,
		c = this._items[g.parentId];
	if (g.type == "group") {
		this._removeGroup(g);
		return
	}
	delete this._items[g.id];
	a = g.base.parentNode;
	this._detachEventFromItem(g.base);
	a.removeChild(g.base);
	if (c.type == "block") {
		if (a != c.contForItems && a.childNodes.length == 0) {
			a.parentNode.removeChild(a)
		}
	} else {
		if (c.type == "group") {
			dhtmlXRibbon.prototype.items.group.normalize(c)
		}
	}
	l = this._indexOf(c.childIds, g.id);
	if (l != -1) {
		c.childIds.splice(l, 1)
	}
	if (this.items[g.type] && (typeof(this.items[g.type].remove) == "function")) {
		this.items[g.type].remove(g, this)
	}
};
dhtmlXRibbon.prototype._removeGroup = function(l) {
	var c = [],
		m, g = this._items[l.parentId],
		a = l.base.parentNode;
	for (m in l.childIds) {
		m = parseInt(m);
		c.push(this._items[l.childIds[m]])
	}
	for (m in c) {
		m = parseInt(m);
		this._removeItem(c[m])
	}
	delete this._items[l.id];
	if (l.base.parentNode) {
		a.removeChild(l.base)
	}
	if (a.childNodes.length == 0) {
		a.parentNode.removeChild(a)
	}
	m = this._indexOf(g.childIds, l.id);
	if (m != -1) {
		g.childIds.splice(m, 1)
	}
	if (this.items[l.type] && (typeof(this.items[l.type].remove) == "function")) {
		this.items[l.type].remove(l)
	}
};
dhtmlXRibbon.prototype._removeBlock = function(l) {
	var a = [],
		g, c;
	for (g in l.childIds) {
		g = parseInt(g);
		a.push(this._items[l.childIds[g]])
	}
	for (g in a) {
		g = parseInt(g);
		this._removeItem(a[g])
	}
	delete this._items[l.id];
	l.base.parentNode.removeChild(l.base);
	if (l.parentId) {
		c = this._items[l.parentId]
	} else {
		c = this
	}
	g = this._indexOf(c.childIds, l.id);
	if (g != -1) {
		c.childIds.splice(g, 1)
	}
};
dhtmlXRibbon.prototype._removeTab = function(c, a) {
	var l = [],
		g;
	for (g in c.childIds) {
		g = parseInt(g);
		l.push(this._items[c.childIds[g]])
	}
	for (g in l) {
		g = parseInt(g);
		this._removeBlock(l[g])
	}
	delete this._items[c.id];
	g = this._indexOf(this.childIds, c.id);
	if (g != -1) {
		this.childIds.splice(g, 1)
	}
};
dhtmlXRibbon.prototype._skinCollection = {
	dhx_skyblue: true,
	dhx_web: true,
	dhx_terrace: true
};
dhtmlXRibbon.prototype._setSkinForItems = function(g) {
	var a, c;
	for (a in this._items) {
		c = this._items[a];
		c.conf.skin = g;
		if (dhtmlXRibbon.prototype.items[c.type] && typeof(dhtmlXRibbon.prototype.items[c.type].setSkin) == "function") {
			dhtmlXRibbon.prototype.items[c.type].setSkin(c, g)
		}
	}
	c = undefined, a = undefined
};
dhtmlXRibbon.prototype._setBlockText = function(a, c) {
	a.conf.text = c;
	a.contForText.innerHTML = c;
	if (!c && (c != 0) && a.contForText.parentNode) {
		a.contForText.parentNode.removeChild(a.contForText)
	} else {
		if (!a.contForText.parentNode) {
			if (a.conf.text_pos == "top") {
				a.base.insertBefore(a.contForText, a.contForItems)
			} else {
				a.base.appendChild(a.contForText)
			}
		}
	}
};
dhtmlXRibbon.prototype.hide = function(g) {
	var c = this._items[g];
	if (this.items[c.type] && (typeof(this.items[c.type].hide) == "function")) {
		if (this.items[c.type].hide(c) != true) {
			return
		}
	}
	if (c.type == "tab") {
		return
	} else {
		if (!/\s?dhxrb_item_hide/i.test(c.base.className)) {
			c.base.className += " dhxrb_item_hide"
		}
	}
	var a = this._items[c.parentId];
	if (a && this.items[a.type] && (typeof(this.items[a.type].hideChild) == "function")) {
		this.items[a.type].hideChild(a, c)
	}
};
dhtmlXRibbon.prototype.show = function(g) {
	var c = this._items[g];
	if (this.items[c.type] && (typeof(this.items[c.type].show) == "function")) {
		if (this.items[c.type].show(c) != true) {
			return
		}
	}
	if (c.type == "tab") {
		return
	} else {
		if (/\s?dhxrb_item_hide/i.test(c.base.className)) {
			c.base.className = c.base.className.replace(/\s?dhxrb_item_hide/i, "")
		}
	}
	var a = this._items[c.parentId];
	if (a && this.items[a.type] && (typeof(this.items[a.type].showChild) == "function")) {
		this.items[a.type].showChild(a, c)
	}
};
dhtmlXRibbon.prototype.check = function(g, c) {
	c = dhx4.s2b(c);
	var a = this._items[g];
	if (a && !a.conf.checked && typeof(this.items[a.type].check) == "function") {
		this.items[a.type].check(a);
		if (c) {
			this.callEvent("onCheck", [a.id, a.conf.checked])
		}
	}
};
dhtmlXRibbon.prototype.uncheck = function(g, c) {
	c = dhx4.s2b(c);
	var a = this._items[g];
	if (a && a.conf.checked && typeof(this.items[a.type].uncheck) == "function") {
		this.items[a.type].uncheck(a);
		if (c) {
			this.callEvent("onCheck", [a.id, a.conf.checked])
		}
	}
};
dhtmlXRibbon.prototype.isChecked = function(c) {
	var a = this._items[c];
	if (a && typeof(this.items[a.type].isChecked) == "function") {
		return this.items[a.type].isChecked(a)
	}
};
dhtmlXRibbon.prototype.disable = function(l, c) {
	var g = this._items[l],
		a;
	if (this.items[g.type] && (typeof(this.items[g.type].disable) == "function")) {
		if (this.items[g.type].disable(g) != true) {
			return
		}
	}
	if (g.type == "tab") {
		return
	} else {
		if (g.type == "block" || g.type == "group") {
			for (a in g.childIds) {
				a = parseInt(a);
				this.disable(g.childIds[a])
			}
		}
	}
	if (!/\s?dhxrb_item_disable/i.test(g.base.className)) {
		g.base.className += " dhxrb_item_disable"
	}
	g.conf.disable = true
};
dhtmlXRibbon.prototype.enable = function(l, c) {
	var g = this._items[l],
		a;
	if (this.items[g.type] && (typeof(this.items[g.type].enable) == "function")) {
		if (this.items[g.type].enable(g) != true) {
			return
		}
	}
	if (g.type == "tab") {
		return
	} else {
		if (g.type == "block" || g.type == "group") {
			for (a in g.childIds) {
				a = parseInt(a);
				this.enable(g.childIds[a])
			}
		}
	}
	if (/\s?dhxrb_item_disable/i.test(g.base.className)) {
		g.base.className = g.base.className.replace(/\s?dhxrb_item_disable/i, "")
	}
	g.conf.disable = false
};
dhtmlXRibbon.prototype.isEnabled = function(c) {
	var a = this._items[c];
	if (this.items[a.type] && typeof(this.items[a.type].isEnabled) == "function") {
		return this.items[a.type].isEnabled(a)
	}
	if (a.type == "tab") {
		return
	} else {
		return a.conf.disable != true
	}
};
dhtmlXRibbon.prototype.isVisible = function(c) {
	var a = this._items[c];
	if (this.items[a.type] && (typeof(this.items[a.type].isVisible) == "function")) {
		return this.items[a.type].isVisible(a)
	}
	if (a.type == "tab") {
		return
	} else {
		return !/\s?dhxrb_item_hide/i.test(a.base.className)
	}
};
dhtmlXRibbon.prototype.setItemState = function(l, c, g) {
	c = dhx4.s2b(c);
	g = dhx4.s2b(g);
	var a = this._items[l];
	if (a && (typeof(this.items[a.type].setState) == "function")) {
		switch (a.type) {
			case "buttonSegment":
				this.items[a.type].setState(a, this, g);
				break;
			default:
				this.items[a.type].setState(a, c, g)
		}
	}
};
dhtmlXRibbon.prototype.getItemState = function(c) {
	var a = this._items[c];
	if (a && (typeof(this.items[a.type].getState) == "function")) {
		switch (a.type) {
			case "buttonTwoState":
			case "buttonSegment":
				return this.items[a.type].getState(a);
				break
		}
	}
	return null
};
dhtmlXRibbon.prototype.setIconPath = function(a) {
	this.conf.icons_path = a
};
dhtmlXRibbon.prototype.removeItem = function(c) {
	var a = this._items[c];
	switch (a.type) {
		case "tab":
			break;
		case "block":
			this._removeBlock(a);
			break;
		case "group":
			this._removeGroup(a);
			break;
		default:
			this._removeItem(a)
	}
};
dhtmlXRibbon.prototype.setSkin = function(m) {
	m = (typeof(m) == "string") ? m.toLowerCase() : "";
	if (this._skinCollection[m] != true) {
		return
	}
	var g, c = -1,
		a, l = "dhtmlxribbon";
	g = this._base.className.match(/\S\w+/ig);
	if (g instanceof Array) {
		for (a in this._skinCollection) {
			if (c == -1) {
				c = this._indexOf(g, l + "_" + a)
			} else {
				break
			}
		}
		c = (c == -1) ? g.length : c
	} else {
		g = [];
		c = 0
	}
	g[c] = l + "_" + m;
	this._base.className = g.join(" ");
	this.conf.skin = m;
	if (this._tabbar != null) {
		this._tabbar.setSkin(m)
	}
	this._setSkinForItems(m)
};
dhtmlXRibbon.prototype.tabs = function(a) {
	if (this._tabbar instanceof dhtmlXTabBar) {
		return this._tabbar.tabs(a)
	} else {
		return undefined
	}
};
dhtmlXRibbon.prototype.getItemType = function(c) {
	var a = this._items[c];
	if (a) {
		return a.type
	} else {
		return undefined
	}
};
dhtmlXRibbon.prototype.getValue = function(g) {
	var a = this._items[g],
		c = undefined;
	if (a && this.items[a.type] && typeof(this.items[a.type].getValue) == "function") {
		c = this.items[a.type].getValue(a)
	}
	return c
};
dhtmlXRibbon.prototype.setValue = function(l, c, g) {
	var a = this._items[l];
	g = (g === false ? false : true);
	if (a && this.items[a.type] && typeof(this.items[a.type].setValue) == "function") {
		this.items[a.type].setValue(a, c, g)
	}
};
dhtmlXRibbon.prototype.getItemText = function(c) {
	var a = this._items[c];
	if (!a) {
		return null
	} else {
		if (a.type == "tab") {
			return this.tabs(a.id).getText()
		} else {
			if (a.type == "block") {
				return this.items.button.getText(a)
			} else {
				if (this.items[a.type] && typeof(this.items[a.type].getText) == "function") {
					return this.items[a.type].getText(a)
				} else {
					return null
				}
			}
		}
	}
};
dhtmlXRibbon.prototype.setItemText = function(g, c) {
	var a = this._items[g];
	if (!a) {
		return
	} else {
		if (a.type == "tab") {
			this.tabs(a.id).setText(c)
		} else {
			if (a.type == "block") {
				this._setBlockText(a, c)
			} else {
				if (this.items[a.type] && typeof(this.items[a.type].setText) == "function") {
					this.items[a.type].setText(a, c)
				}
			}
		}
	}
};
dhtmlXRibbon.prototype.setItemOptionText = function(l, g, c) {
	var a = this._items[l];
	if (a.type == "buttonSelect") {
		this.items[a.type].setOptionText(a, g, c)
	}
};
dhtmlXRibbon.prototype.getItemOptionText = function(g, c) {
	var a = this._items[g];
	if (a.type == "buttonSelect") {
		return this.items[a.type].getOptionText(a, c)
	}
	return null
};
dhtmlXRibbon.prototype.setItemImage = function(g, a) {
	var c = this._items[g];
	if (c != null && this.items[c.type] != null && typeof(this.items[c.type].setImage) == "function") {
		this.items[c.type].setImage(c, a)
	}
};
dhtmlXRibbon.prototype.setItemImageDis = function(g, a) {
	var c = this._items[g];
	if (c != null && this.items[c.type] != null && typeof(this.items[c.type].setImageDis) == "function") {
		this.items[c.type].setImageDis(c, a)
	}
};
(function() {
	var a = dhtmlXRibbon.prototype.items;
	a.buttonTwoState = a._extends(a.buttonTwoState, a.button);
	a.buttonSelect = a._extends(a.buttonSelect, a.buttonTwoState);
	a.buttonSegment = a._extends(a.buttonSegment, a.buttonTwoState)
})();
if (typeof(window.dhtmlXCellObject) != "undefined") {
	dhtmlXCellObject.prototype._createNode_ribbon = function(m, c, l, a, g) {
		if (typeof(g) != "undefined") {
			m = g
		} else {
			m = document.createElement("DIV");
			m.className = "dhx_cell_ribbon_" + (this.conf.borders ? "def" : "no_borders");
			m.appendChild(document.createElement("DIV"))
		}
		this.cell.insertBefore(m, this.cell.childNodes[this.conf.idx.cont]);
		this.conf.ofs_nodes.t.ribbon = true;
		this._updateIdx();
		this._adjustCont(this._idd);
		return m
	};
	dhtmlXCellObject.prototype.attachRibbon = function(a) {
		if (!(this.dataNodes.ribbon == null && this.dataNodes.toolbar == null)) {
			return
		}
		this.callEvent("_onBeforeContentAttach", ["ribbon"]);
		if (typeof(a) == "undefined") {
			a = {}
		}
		if (typeof(a.skin) == "undefined") {
			a.skin = this.conf.skin
		}
		a.parent = this._attachObject("ribbon").firstChild;
		this.dataNodes.ribbon = new dhtmlXRibbon(a);
		var c = this;
		this.dataNodes.ribbon.attachEvent("_onHeightChanged", function() {
			c._adjustCont(c._idd)
		});
		this._adjustCont();
		a.parent = null;
		a = null;
		this.callEvent("_onContentAttach", []);
		return this.dataNodes.ribbon
	};
	dhtmlXCellObject.prototype.detachRibbon = function() {
		if (!this.dataNodes.ribbon) {
			return
		}
		this.dataNodes.ribbon.unload();
		this.dataNodes.ribbon = null;
		delete this.dataNodes.ribbon;
		this._detachObject("ribbon")
	};
	dhtmlXCellObject.prototype.showRibbon = function() {
		this._mtbShowHide("ribbon", "")
	};
	dhtmlXCellObject.prototype.hideRibbon = function() {
		this._mtbShowHide("ribbon", "none")
	};
	dhtmlXCellObject.prototype.getAttachedRibbon = function() {
		return this.dataNodes.ribbon
	}
}

function dhtmlXToolbarObject(c, g) {
	var a = this;
	this.conf = {
		skin: (g || window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhxtoolbar") || "dhx_skyblue"),
		align: "left",
		align_autostart: "left",
		icons_path: "",
		iconSize: 18,
		sel_ofs_x: 0,
		sel_ofs_y: 0,
		xml_autoload: null,
		items_autoload: null
	};
	if (typeof(c) == "object" && c != null && typeof(c.tagName) == "undefined") {
		if (c.icons_path != null || c.icon_path != null) {
			this.conf.icons_path = (c.icons_path || c.icon_path)
		}
		if (c.icons_size != null) {
			this.conf.icons_size_autoload = c.icons_size
		}
		if (c.json != null) {
			this.conf.json_autoload = c.json
		}
		if (c.xml != null) {
			this.conf.xml_autoload = c.xml
		}
		if (c.onload != null) {
			this.conf.onload_autoload = c.onload
		}
		if (c.onclick != null || c.onClick != null) {
			this.conf.auto_onclick = (c.onclick || c.onClick)
		}
		if (c.items != null) {
			this.conf.items_autoload = c.items
		}
		if (c.skin != null) {
			this.conf.skin = c.skin
		}
		if (c.align != null) {
			this.conf.align_autostart = c.align
		}
		c = c.parent
	}
	this.cont = (typeof(c) != "object") ? document.getElementById(c) : c;
	while (this.cont.childNodes.length > 0) {
		this.cont.removeChild(this.cont.childNodes[0])
	}
	c = null;
	this.cont.dir = "ltr";
	this.base = document.createElement("DIV");
	this.base.className = "dhxtoolbar_float_left";
	this.cont.appendChild(this.base);
	if (window.dhx4.isIPad) {
		this.cont.ontouchstart = function(l) {
			l = l || event;
			if ((String(l.target.tagName || "").toLowerCase() == "input")) {
				return true
			}
			if (l.preventDefault) {
				l.preventDefault()
			} else {
				l.returnValue = false
			}
			l.cancelBubble = true;
			return false
		}
	}
	this.setSkin(this.conf.skin);
	this.objPull = {};
	this.anyUsed = "none";
	this._genStr = function(l) {
		var m = "";
		var o = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
		for (var n = 0; n < l; n++) {
			m += o.charAt(Math.round(Math.random() * (o.length - 1)))
		}
		return m
	};
	this.rootTypes = new Array("button", "buttonSelect", "buttonTwoState", "separator", "label", "slider", "text", "buttonInput");
	this.idPrefix = this._genStr(12);
	window.dhx4._enableDataLoading(this, "_initObj", "_xmlToJson", "toolbar", {
		struct: true
	});
	window.dhx4._eventable(this);
	this._getObj = function(o, l) {
		var m = null;
		for (var n = 0; n < o.childNodes.length; n++) {
			if (o.childNodes[n].tagName != null) {
				if (String(o.childNodes[n].tagName).toLowerCase() == String(l).toLowerCase()) {
					m = o.childNodes[n]
				}
			}
		}
		return m
	};
	this._addImgObj = function(m) {
		var l = document.createElement("IMG");
		if (m.childNodes.length > 0) {
			m.insertBefore(l, m.childNodes[0])
		} else {
			m.appendChild(l)
		}
		return l
	};
	this._setItemImage = function(o, m, l) {
		if (l == true) {
			o.imgEn = m
		} else {
			o.imgDis = m
		}
		if ((!o.state && l == true) || (o.state && l == false)) {
			return
		}
		var n = this._getObj(o.obj, "img");
		if (n == null) {
			n = this._addImgObj(o.obj)
		}
		n.src = this.conf.icons_path + m
	};
	this._clearItemImage = function(n, l) {
		if (l == true) {
			n.imgEn = ""
		} else {
			n.imgDis = ""
		}
		if ((!n.state && l == true) || (n.state && l == false)) {
			return
		}
		var m = this._getObj(n.obj, "img");
		if (m != null) {
			m.parentNode.removeChild(m)
		}
	};
	this._setItemText = function(l, n) {
		var m = this._getObj(l.obj, "div");
		if (n == null || n.length == 0) {
			if (m != null) {
				m.parentNode.removeChild(m)
			}
			return
		}
		if (m == null) {
			m = document.createElement("DIV");
			m.className = "dhxtoolbar_text";
			l.obj.appendChild(m)
		}
		m.innerHTML = n
	};
	this._getItemText = function(l) {
		var m = this._getObj(l.obj, "div");
		if (m != null) {
			return m.innerHTML
		}
		return ""
	};
	this._enableItem = function(m) {
		if (m.state) {
			return
		}
		m.state = true;
		if (this.objPull[m.id]["type"] == "buttonTwoState" && this.objPull[m.id]["obj"]["pressed"] == true) {
			m.obj.className = "dhx_toolbar_btn dhxtoolbar_btn_pres";
			m.obj.renderAs = "dhx_toolbar_btn dhxtoolbar_btn_over"
		} else {
			m.obj.className = "dhx_toolbar_btn dhxtoolbar_btn_def";
			m.obj.renderAs = m.obj.className
		}
		if (m.arw) {
			m.arw.className = String(m.obj.className).replace("btn", "arw")
		}
		var l = this._getObj(m.obj, "img");
		if (m.imgEn != "") {
			if (l == null) {
				l = this._addImgObj(m.obj)
			}
			l.src = this.conf.icons_path + m.imgEn
		} else {
			if (l != null) {
				l.parentNode.removeChild(l)
			}
		}
	};
	this._disableItem = function(m) {
		if (!m.state) {
			return
		}
		m.state = false;
		m.obj.className = "dhx_toolbar_btn dhxtoolbar_btn_" + (this.objPull[m.id]["type"] == "buttonTwoState" && m.obj.pressed ? "pres_" : "") + "dis";
		m.obj.renderAs = "dhx_toolbar_btn dhxtoolbar_btn_def";
		if (m.arw) {
			m.arw.className = String(m.obj.className).replace("btn", "arw")
		}
		var l = this._getObj(m.obj, "img");
		if (m.imgDis != "") {
			if (l == null) {
				l = this._addImgObj(m.obj)
			}
			l.src = this.conf.icons_path + m.imgDis
		} else {
			if (l != null) {
				l.parentNode.removeChild(l)
			}
		}
		if (m.polygon != null) {
			if (m.polygon.style.display != "none") {
				window.dhx4.zim.clear(m.polygon._idd);
				m.polygon.style.display = "none";
				if (m.polygon._ie6cover) {
					m.polygon._ie6cover.style.display = "none"
				}
				if (this.conf.skin == "dhx_terrace") {
					this._improveTerraceButtonSelect(m.id, true)
				}
			}
		}
		this.anyUsed = "none"
	};
	this.clearAll = function() {
		for (var l in this.objPull) {
			this._removeItem(String(l).replace(this.idPrefix, ""))
		}
	};
	this._doOnClick = function(l) {
		if (a && a.forEachItem) {
			a.forEachItem(function(n) {
				if (a.objPull[a.idPrefix + n]["type"] == "buttonSelect") {
					var m = a.objPull[a.idPrefix + n];
					if (m.arw._skip === true) {
						m.arw._skip = false
					} else {
						if (m.polygon.style.display != "none") {
							m.obj.renderAs = "dhx_toolbar_btn dhxtoolbar_btn_def";
							m.obj.className = m.obj.renderAs;
							m.arw.className = String(m.obj.renderAs).replace("btn", "arw");
							a.anyUsed = "none";
							window.dhx4.zim.clear(m.polygon._idd);
							m.polygon.style.display = "none";
							if (m.polygon._ie6cover) {
								m.polygon._ie6cover.style.display = "none"
							}
							if (a.conf.skin == "dhx_terrace") {
								a._improveTerraceButtonSelect(m.id, true)
							}
						}
					}
				}
			})
		}
	};
	if (window.dhx4.isIPad) {
		document.addEventListener("touchstart", this._doOnClick, false)
	} else {
		if (typeof(window.addEventListener) != "undefined") {
			window.addEventListener("mousedown", this._doOnClick, false)
		} else {
			document.body.attachEvent("onmousedown", this._doOnClick)
		}
	}
	if (this.conf.icons_size_autoload != null) {
		this.setIconSize(this.conf.icons_size_autoload);
		this.conf.icons_size_autoload = null
	}
	if (this.conf.items_autoload != null) {
		this.loadStruct(this.conf.items_autoload, this.conf.onload_autoload);
		this.conf.items_autoload = null
	} else {
		if (this.conf.json_autoload != null) {
			this.loadStruct(this.conf.json_autoload, this.conf.onload_autoload);
			this.conf.json_autoload = null
		} else {
			if (this.conf.xml_autoload != null) {
				this.loadStruct(this.conf.xml_autoload, this.conf.onload_autoload);
				this.conf.xml_autoload = null
			}
		}
	}
	if (this.conf.align_autostart != this.conf.align) {
		this.setAlign(this.conf.align_autostart);
		this.conf.align_autostart = null
	}
	if (typeof(this.conf.auto_onclick) == "function") {
		this.attachEvent("onClick", this.conf.auto_onclick)
	} else {
		if (typeof(this.conf.auto_onclick) == "string" && typeof(window[this.conf.auto_onclick]) == "function") {
			this.attachEvent("onClick", window[this.conf.auto_onclick])
		}
	}
	return this
}
dhtmlXToolbarObject.prototype.addSpacer = function(g) {
	var c = this.idPrefix + g;
	if (this._spacer != null) {
		if (this._spacer.idd == g) {
			return
		}
		if (this._spacer == this.objPull[c].obj.parentNode) {
			var a = true;
			while (a) {
				var o = this._spacer.childNodes[0].idd;
				this.base.appendChild(this._spacer.childNodes[0]);
				if (o == g || this._spacer.childNodes.length == 0) {
					if (this.objPull[c].arw != null) {
						this.base.appendChild(this.objPull[c].arw)
					}
					a = false
				}
			}
			this._spacer.idd = g;
			this._fixSpacer();
			return
		}
		if (this.base == this.objPull[c].obj.parentNode) {
			var a = true;
			var n = (this.objPull[c].arw != null);
			while (a) {
				var l = this.base.childNodes.length - 1;
				if (n == true) {
					if (this.base.childNodes[l] == this.objPull[c].arw) {
						a = false
					}
				}
				if (this.base.childNodes[l].idd == g) {
					a = false
				}
				if (a) {
					if (this._spacer.childNodes.length > 0) {
						this._spacer.insertBefore(this.base.childNodes[l], this._spacer.childNodes[0])
					} else {
						this._spacer.appendChild(this.base.childNodes[l])
					}
				}
			}
			this._spacer.idd = g;
			this._fixSpacer();
			return
		}
	} else {
		var m = null;
		for (var l = 0; l < this.base.childNodes.length; l++) {
			if (this.base.childNodes[l] == this.objPull[this.idPrefix + g].obj) {
				m = l;
				if (this.objPull[this.idPrefix + g].arw != null) {
					m = l + 1
				}
			}
		}
		if (m != null) {
			this._spacer = document.createElement("DIV");
			this._spacer.className = (this.conf.align == "right" ? " dhxtoolbar_float_left" : " dhxtoolbar_float_right");
			this._spacer.dir = "ltr";
			this._spacer.idd = g;
			while (this.base.childNodes.length > m + 1) {
				this._spacer.appendChild(this.base.childNodes[m + 1])
			}
			this.cont.appendChild(this._spacer);
			this._fixSpacer()
		}
	}
	if (this.conf.skin == "dhx_terrace") {
		this._improveTerraceSkin()
	}
};
dhtmlXToolbarObject.prototype.removeSpacer = function() {
	if (!this._spacer) {
		return
	}
	while (this._spacer.childNodes.length > 0) {
		this.base.appendChild(this._spacer.childNodes[0])
	}
	this._spacer.parentNode.removeChild(this._spacer);
	this._spacer = null;
	if (this.conf.skin == "dhx_terrace") {
		this._improveTerraceSkin()
	}
};
dhtmlXToolbarObject.prototype._fixSpacer = function() {
	if (typeof(window.addEventListener) == "undefined" && this._spacer != null) {
		this._spacer.style.borderLeft = "1px solid #a4bed4";
		var a = this._spacer;
		window.setTimeout(function() {
			a.style.borderLeft = "0px solid #a4bed4";
			a = null
		}, 1)
	}
};
dhtmlXToolbarObject.prototype.getType = function(g) {
	var l = this.getParentId(g);
	if (l != null) {
		var c = null;
		var a = this.objPull[this.idPrefix + l]._listOptions[g];
		if (a != null) {
			if (a.sep != null) {
				c = "buttonSelectSeparator"
			} else {
				c = "buttonSelectButton"
			}
		}
		return c
	} else {
		if (this.objPull[this.idPrefix + g] == null) {
			return null
		}
		return this.objPull[this.idPrefix + g]["type"]
	}
};
dhtmlXToolbarObject.prototype.getTypeExt = function(c) {
	var a = this.getType(c);
	if (a == "buttonSelectButton" || a == "buttonSelectSeparator") {
		if (a == "buttonSelectButton") {
			a = "button"
		} else {
			a = "separator"
		}
		return a
	}
	return null
};
dhtmlXToolbarObject.prototype.inArray = function(g, c) {
	for (var a = 0; a < g.length; a++) {
		if (g[a] == c) {
			return true
		}
	}
	return false
};
dhtmlXToolbarObject.prototype.getParentId = function(l) {
	var m = null;
	for (var g in this.objPull) {
		if (this.objPull[g]._listOptions) {
			for (var c in this.objPull[g]._listOptions) {
				if (c == l) {
					m = String(g).replace(this.idPrefix, "")
				}
			}
		}
	}
	return m
};
dhtmlXToolbarObject.prototype._addItem = function(a, c) {
	if (typeof(a.text) == "string") {
		a.text = window.dhx4.trim(a.text);
		if (a.text.length == 0) {
			a.text = null
		}
	}
	this._addItemToStorage(a, c);
	if (this.conf.skin == "dhx_terrace") {
		this._improveTerraceSkin()
	}
};

//modify code by zzm 20161113
//增加下拉选择框的 图标数据 icontags
//icontags 是一个数组对象 ["<i class='fa fa-files-o'></i>","<i class='fa fa-caret-down'></i>"]
dhtmlXToolbarObject.prototype.addButton = function(m, l, c, a, g,icontags) {
	this._addItem({
		id: m,
		type: "button",
		text: c,
		img: a,
		imgdis: g,
		icontags:icontags
	}, l)
};
dhtmlXToolbarObject.prototype.addText = function(g, c, a) {
	this._addItem({
		id: g,
		type: "text",
		text: a
	}, c)
};

//modify code by zzm 20161113
//增加下拉选择框的 图标数据 icontags
//icontags 是一个数组对象 ["<i class='fa fa-files-o'></i>","<i class='fa fa-caret-down'></i>"]
dhtmlXToolbarObject.prototype.addButtonSelect = function(l, r, w, a, c, s, o, y, m, n,icontags) {
	var x = [];
	for (var g = 0; g < a.length; g++) {
		var v = {};
		if (a[g] instanceof Array) {
			v.id = a[g][0];
			v.type = (a[g][1] == "obj" ? "button" : "separator");
			v.text = (a[g][2] || null);
			v.img = (a[g][3] || null)
		} else {
			if (a[g] instanceof Object && a[g] != null && typeof(a[g].id) != "undefined" && typeof(a[g].type) != "undefined") {
				v.id = a[g].id;
				v.type = (a[g].type == "obj" ? "button" : "separator");
				v.text = a[g].text;
				v.img = a[g].img
			}
		}
		x.push(v)
	}
	this._addItem({
		id: l,
		type: "buttonSelect",
		text: w,
		img: c,
		imgdis: s,
		renderSelect: o,
		openAll: y,
		options: x,
		maxOpen: m,
		mode: n,
		icontags:icontags
	}, r)
};
dhtmlXToolbarObject.prototype.addButtonTwoState = function(m, l, c, a, g) {
	this._addItem({
		id: m,
		type: "buttonTwoState",
		img: a,
		imgdis: g,
		text: c
	}, l)
};
dhtmlXToolbarObject.prototype.addSeparator = function(c, a) {
	this._addItem({
		id: c,
		type: "separator"
	}, a)
};
dhtmlXToolbarObject.prototype.addSlider = function(c, o, m, l, r, g, n, a, q) {
	this._addItem({
		id: c,
		type: "slider",
		length: m,
		valueMin: l,
		valueMax: r,
		valueNow: g,
		textMin: n,
		textMax: a,
		toolTip: q
	}, o)
};
dhtmlXToolbarObject.prototype.addInput = function(l, g, c, a) {
	this._addItem({
		id: l,
		type: "buttonInput",
		value: c,
		width: a
	}, g)
};
dhtmlXToolbarObject.prototype.forEachItem = function(g) {
	for (var c in this.objPull) {
		if (this.inArray(this.rootTypes, this.objPull[c]["type"])) {
			g(this.objPull[c]["id"].replace(this.idPrefix, ""))
		}
	}
};
(function() {
	var n = "isVisible,enableItem,disableItem,isEnabled,setItemText,getItemText,setItemToolTip,getItemToolTip,getInput,setItemImage,setItemImageDis,clearItemImage,clearItemImageDis,setItemState,getItemState,setItemToolTipTemplate,getItemToolTipTemplate,setValue,getValue,setMinValue,getMinValue,setMaxValue,getMaxValue,setWidth,getWidth,setMaxOpen".split(",");
	var g = [false, "", "", false, "", "", "", "", "", "", "", "", "", false, "", "", "", null, "", [null, null], "", [null, null], "", null];
	var c = function(o, q) {
		return function(u, s, r) {
			u = this.idPrefix + u;
			if (this.objPull[u][o] != null) {
				return this.objPull[u][o].call(this.objPull[u], s, r)
			} else {
				return q
			}
		}
	};
	for (var m = 0; m < n.length; m++) {
		var a = n[m];
		var l = g[m];
		dhtmlXToolbarObject.prototype[a] = c(a, l)
	}
})();
dhtmlXToolbarObject.prototype.showItem = function(a) {
	a = this.idPrefix + a;
	if (this.objPull[a] != null && this.objPull[a].showItem != null) {
		this.objPull[a].showItem();
		if (this.conf.skin == "dhx_terrace") {
			this._improveTerraceSkin()
		}
	}
};
dhtmlXToolbarObject.prototype.hideItem = function(a) {
	a = this.idPrefix + a;
	if (this.objPull[a] != null && this.objPull[a].hideItem != null) {
		this.objPull[a].hideItem();
		if (this.conf.skin == "dhx_terrace") {
			this._improveTerraceSkin()
		}
	}
};
dhtmlXToolbarObject.prototype.getPosition = function(a) {
	return this._getPosition(a)
};
dhtmlXToolbarObject.prototype._getPosition = function(m, g) {
	if (this.objPull[this.idPrefix + m] == null) {
		return null
	}
	var l = null;
	var a = 0;
	for (var c = 0; c < this.base.childNodes.length; c++) {
		if (this.base.childNodes[c].idd != null) {
			if (this.base.childNodes[c].idd == m) {
				l = a
			}
			a++
		}
	}
	if (!l && this._spacer != null) {
		for (var c = 0; c < this._spacer.childNodes.length; c++) {
			if (this._spacer.childNodes[c].idd != null) {
				if (this._spacer.childNodes[c].idd == m) {
					l = a
				}
				a++
			}
		}
	}
	return l
};
dhtmlXToolbarObject.prototype.setPosition = function(a, c) {
	this._setPosition(a, c)
};
dhtmlXToolbarObject.prototype._setPosition = function(m, l) {
	if (this.objPull[this.idPrefix + m] == null) {
		return
	}
	if (isNaN(l)) {
		l = this.base.childNodes.length
	}
	if (l < 0) {
		l = 0
	}
	var a = null;
	if (this._spacer) {
		a = this._spacer.idd;
		this.removeSpacer()
	}
	var g = this.objPull[this.idPrefix + m];
	this.base.removeChild(g.obj);
	if (g.arw) {
		this.base.removeChild(g.arw)
	}
	var c = this._getIdByPosition(l, true);
	if (c[0] == null) {
		this.base.appendChild(g.obj);
		if (g.arw) {
			this.base.appendChild(g.arw)
		}
	} else {
		this.base.insertBefore(g.obj, this.base.childNodes[c[1]]);
		if (g.arw) {
			this.base.insertBefore(g.arw, this.base.childNodes[c[1] + 1])
		}
	}
	if (a != null) {
		this.addSpacer(a)
	}
};
dhtmlXToolbarObject.prototype._getIdByPosition = function(n, c) {
	var m = null;
	var a = 0;
	var g = 0;
	for (var l = 0; l < this.base.childNodes.length; l++) {
		if (this.base.childNodes[l]["idd"] != null && m == null) {
			if ((a++) == n) {
				m = this.base.childNodes[l]["idd"]
			}
		}
		if (m == null) {
			g++
		}
	}
	g = (m == null ? null : g);
	return (c == true ? new Array(m, g) : m)
};
dhtmlXToolbarObject.prototype.removeItem = function(a) {
	this._removeItem(a);
	if (this.conf.skin == "dhx_terrace") {
		this._improveTerraceSkin()
	}
};
dhtmlXToolbarObject.prototype._removeItem = function(m) {
	var g = this.getType(m);
	m = this.idPrefix + m;
	var l = this.objPull[m];
	if (g == "button") {
		l.obj._doOnMouseOver = null;
		l.obj._doOnMouseOut = null;
		l.obj._doOnMouseUp = null;
		l.obj._doOnMouseUpOnceAnywhere = null;
		l.obj.onclick = null;
		l.obj.onmouseover = null;
		l.obj.onmouseout = null;
		l.obj.onmouseup = null;
		l.obj.onmousedown = null;
		l.obj.onselectstart = null;
		l.obj.renderAs = null;
		l.obj.idd = null;
		l.obj.parentNode.removeChild(l.obj);
		l.obj = null;
		l.id = null;
		l.state = null;
		l.img = null;
		l.imgEn = null;
		l.imgDis = null;
		l.type = null;
		l.enableItem = null;
		l.disableItem = null;
		l.isEnabled = null;
		l.showItem = null;
		l.hideItem = null;
		l.isVisible = null;
		l.setItemText = null;
		l.getItemText = null;
		l.setItemImage = null;
		l.clearItemImage = null;
		l.setItemImageDis = null;
		l.clearItemImageDis = null;
		l.setItemToolTip = null;
		l.getItemToolTip = null
	}
	if (g == "buttonTwoState") {
		l.obj._doOnMouseOver = null;
		l.obj._doOnMouseOut = null;
		l.obj.onmouseover = null;
		l.obj.onmouseout = null;
		l.obj.onmousedown = null;
		l.obj.onselectstart = null;
		l.obj.renderAs = null;
		l.obj.idd = null;
		l.obj.parentNode.removeChild(l.obj);
		l.obj = null;
		l.id = null;
		l.state = null;
		l.img = null;
		l.imgEn = null;
		l.imgDis = null;
		l.type = null;
		l.enableItem = null;
		l.disableItem = null;
		l.isEnabled = null;
		l.showItem = null;
		l.hideItem = null;
		l.isVisible = null;
		l.setItemText = null;
		l.getItemText = null;
		l.setItemImage = null;
		l.clearItemImage = null;
		l.setItemImageDis = null;
		l.clearItemImageDis = null;
		l.setItemToolTip = null;
		l.getItemToolTip = null;
		l.setItemState = null;
		l.getItemState = null
	}
	if (g == "buttonSelect") {
		for (var c in l._listOptions) {
			this.removeListOption(m, c)
		}
		l._listOptions = null;
		if (l.polygon._ie6cover) {
			document.body.removeChild(l.polygon._ie6cover);
			l.polygon._ie6cover = null
		}
		l.p_tbl.removeChild(l.p_tbody);
		l.polygon.removeChild(l.p_tbl);
		l.polygon.onselectstart = null;
		document.body.removeChild(l.polygon);
		l.p_tbody = null;
		l.p_tbl = null;
		l.polygon = null;
		l.obj.onclick = null;
		l.obj.onmouseover = null;
		l.obj.onmouseout = null;
		l.obj.onmouseup = null;
		l.obj.onmousedown = null;
		l.obj.onselectstart = null;
		l.obj.idd = null;
		l.obj.iddPrefix = null;
		l.obj.parentNode.removeChild(l.obj);
		l.obj = null;
		l.arw.onclick = null;
		l.arw.onmouseover = null;
		l.arw.onmouseout = null;
		l.arw.onmouseup = null;
		l.arw.onmousedown = null;
		l.arw.onselectstart = null;
		l.arw.parentNode.removeChild(l.arw);
		l.arw = null;
		l.renderSelect = null;
		l.state = null;
		l.type = null;
		l.id = null;
		l.img = null;
		l.imgEn = null;
		l.imgDis = null;
		l.openAll = null;
		l._isListButton = null;
		l._separatorButtonSelectObject = null;
		l._buttonButtonSelectObject = null;
		l.setWidth = null;
		l.enableItem = null;
		l.disableItem = null;
		l.isEnabled = null;
		l.showItem = null;
		l.hideItem = null;
		l.isVisible = null;
		l.setItemText = null;
		l.getItemText = null;
		l.setItemImage = null;
		l.clearItemImage = null;
		l.setItemImageDis = null;
		l.clearItemImageDis = null;
		l.setItemToolTip = null;
		l.getItemToolTip = null;
		l.addListOption = null;
		l.removeListOption = null;
		l.showListOption = null;
		l.hideListOption = null;
		l.isListOptionVisible = null;
		l.enableListOption = null;
		l.disableListOption = null;
		l.isListOptionEnabled = null;
		l.setListOptionPosition = null;
		l.getListOptionPosition = null;
		l.setListOptionImage = null;
		l.getListOptionImage = null;
		l.clearListOptionImage = null;
		l.setListOptionText = null;
		l.getListOptionText = null;
		l.setListOptionToolTip = null;
		l.getListOptionToolTip = null;
		l.forEachListOption = null;
		l.getAllListOptions = null;
		l.setListOptionSelected = null;
		l.getListOptionSelected = null
	}
	if (g == "buttonInput") {
		l.obj.childNodes[0].onkeydown = null;
		l.obj.removeChild(l.obj.childNodes[0]);
		l.obj.w = null;
		l.obj.idd = null;
		l.obj.parentNode.removeChild(l.obj);
		l.obj = null;
		l.id = null;
		l.type = null;
		l.enableItem = null;
		l.disableItem = null;
		l.isEnabled = null;
		l.showItem = null;
		l.hideItem = null;
		l.isVisible = null;
		l.setItemToolTip = null;
		l.getItemToolTip = null;
		l.setWidth = null;
		l.getWidth = null;
		l.setValue = null;
		l.getValue = null;
		l.setItemText = null;
		l.getItemText = null
	}
	if (g == "slider") {
		if (window.dhx4.isIPad) {
			document.removeEventListener("touchmove", pen._doOnMouseMoveStart, false);
			document.removeEventListener("touchend", pen._doOnMouseMoveEnd, false)
		} else {
			if (typeof(window.addEventListener) == "function") {
				window.removeEventListener("mousemove", l.pen._doOnMouseMoveStart, false);
				window.removeEventListener("mouseup", l.pen._doOnMouseMoveEnd, false)
			} else {
				document.body.detachEvent("onmousemove", l.pen._doOnMouseMoveStart);
				document.body.detachEvent("onmouseup", l.pen._doOnMouseMoveEnd)
			}
		}
		l.pen.allowMove = null;
		l.pen.initXY = null;
		l.pen.maxX = null;
		l.pen.minX = null;
		l.pen.nowX = null;
		l.pen.newNowX = null;
		l.pen.valueMax = null;
		l.pen.valueMin = null;
		l.pen.valueNow = null;
		l.pen._definePos = null;
		l.pen._detectLimits = null;
		l.pen._doOnMouseMoveStart = null;
		l.pen._doOnMouseMoveEnd = null;
		l.pen.onmousedown = null;
		l.obj.removeChild(l.pen);
		l.pen = null;
		l.label.tip = null;
		document.body.removeChild(l.label);
		l.label = null;
		l.obj.onselectstart = null;
		l.obj.idd = null;
		while (l.obj.childNodes.length > 0) {
			l.obj.removeChild(l.obj.childNodes[0])
		}
		l.obj.parentNode.removeChild(l.obj);
		l.obj = null;
		l.id = null;
		l.type = null;
		l.state = null;
		l.enableItem = null;
		l.disableItem = null;
		l.isEnabled = null;
		l.setItemToolTipTemplate = null;
		l.getItemToolTipTemplate = null;
		l.setMaxValue = null;
		l.setMinValue = null;
		l.getMaxValue = null;
		l.getMinValue = null;
		l.setValue = null;
		l.getValue = null;
		l.showItem = null;
		l.hideItem = null;
		l.isVisible = null
	}
	if (g == "separator") {
		l.obj.onselectstart = null;
		l.obj.idd = null;
		l.obj.parentNode.removeChild(l.obj);
		l.obj = null;
		l.id = null;
		l.type = null;
		l.showItem = null;
		l.hideItem = null;
		l.isVisible = null
	}
	if (g == "text") {
		l.obj.onselectstart = null;
		l.obj.idd = null;
		l.obj.parentNode.removeChild(l.obj);
		l.obj = null;
		l.id = null;
		l.type = null;
		l.showItem = null;
		l.hideItem = null;
		l.isVisible = null;
		l.setWidth = null;
		l.setItemText = null;
		l.getItemText = null
	}
	g = null;
	l = null;
	this.objPull[this.idPrefix + m] = null;
	delete this.objPull[this.idPrefix + m]
};
(function() {
	var l = "addListOption,removeListOption,showListOption,hideListOption,isListOptionVisible,enableListOption,disableListOption,isListOptionEnabled,setListOptionPosition,getListOptionPosition,setListOptionText,getListOptionText,setListOptionToolTip,getListOptionToolTip,setListOptionImage,getListOptionImage,clearListOptionImage,forEachListOption,getAllListOptions,setListOptionSelected,getListOptionSelected".split(",");
	var c = function(m) {
		return function(u, o, n, s, r, q) {
			u = this.idPrefix + u;
			if (this.objPull[u] == null) {
				return
			}
			if (this.objPull[u]["type"] != "buttonSelect") {
				return
			}
			return this.objPull[u][m].call(this.objPull[u], o, n, s, r, q)
		}
	};
	for (var g = 0; g < l.length; g++) {
		var a = l[g];
		dhtmlXToolbarObject.prototype[a] = c(a)
	}
})();
dhtmlXToolbarObject.prototype._rtlParseBtn = function(c, a) {
	return c + a
};
dhtmlXToolbarObject.prototype._separatorObject = function(a, g, c) {
	this.id = a.idPrefix + g;
	this.obj = document.createElement("DIV");
	this.obj.className = "dhx_toolbar_sep";
	this.obj.style.display = (c.hidden != null ? "none" : "");
	this.obj.idd = String(g);
	this.obj.title = (c.title || "");
	this.obj.onselectstart = function(l) {
		l = l || event;
		if (l.preventDefault) {
			l.preventDefault()
		} else {
			l.returnValue = false
		}
	};
	if (window.dhx4.isIPad) {
		this.obj.ontouchstart = function(l) {
			l = l || event;
			if (l.preventDefault) {
				l.preventDefault()
			} else {
				l.returnValue = false
			}
			l.cancelBubble = true;
			return false
		}
	}
	a.base.appendChild(this.obj);
	this.showItem = function() {
		this.obj.style.display = ""
	};
	this.hideItem = function() {
		this.obj.style.display = "none"
	};
	this.isVisible = function() {
		return (this.obj.style.display == "")
	};
	return this
};
dhtmlXToolbarObject.prototype._textObject = function(a, g, c) {
	this.id = a.idPrefix + g;
	this.obj = document.createElement("DIV");
	this.obj.className = "dhx_toolbar_text";
	this.obj.style.display = (c.hidden != null ? "none" : "");
	this.obj.idd = String(g);
	this.obj.title = (c.title || "");
	this.obj.onselectstart = function(l) {
		l = l || event;
		if (l.preventDefault) {
			l.preventDefault()
		} else {
			l.returnValue = false
		}
	};
	if (window.dhx4.isIPad) {
		this.obj.ontouchstart = function(l) {
			l = l || event;
			if (l.preventDefault) {
				l.preventDefault()
			} else {
				l.returnValue = false
			}
			l.cancelBubble = true;
			return false
		}
	}
	this.obj.innerHTML = (c.text || "");
	a.base.appendChild(this.obj);
	this.showItem = function() {
		this.obj.style.display = ""
	};
	this.hideItem = function() {
		this.obj.style.display = "none"
	};
	this.isVisible = function() {
		return (this.obj.style.display == "")
	};
	this.setItemText = function(l) {
		this.obj.innerHTML = l
	};
	this.getItemText = function() {
		return this.obj.innerHTML
	};
	this.setWidth = function(l) {
		this.obj.style.width = l + "px"
	};
	this.setItemToolTip = function(l) {
		this.obj.title = l
	};
	this.getItemToolTip = function() {
		return this.obj.title
	};
	return this
};

//modify code by zzm 20161113
dhtmlXToolbarObject.prototype._buttonObject = function(a, l, c) {
	this.id = a.idPrefix + l;
	this.state = (c.enabled != null ? false : true);
	this.imgEn = (c.img || "");
	this.imgDis = (c.imgdis || "");
	this.img = (this.state ? (this.imgEn != "" ? this.imgEn : "") : (this.imgDis != "" ? this.imgDis : ""));
	this.obj = document.createElement("DIV");
	this.obj.className = "dhx_toolbar_btn dhxtoolbar_btn_" + (this.state ? "def" : "dis");
	this.obj.style.display = (c.hidden != null ? "none" : "");
	this.obj.allowClick = false;
	this.obj.extAction = (c.action || null);
	this.obj.renderAs = this.obj.className;
	this.obj.idd = String(l);
	this.obj.title = (c.title || "");
	this.obj.pressed = false;
	
	//modify code by zzm 20161113
	this.icontags = c.icontags;
	if(this.icontags && this.icontags instanceof Array){
	}else{
		this.icontags = null;
	}
	
	//modify code by zzm 20161113
	this.obj.innerHTML = (this.icontags!=null?this.icontags[0]:"")+a._rtlParseBtn((this.img != "" ? "<img src='" + a.conf.icons_path + this.img + "'>" : ""), (c.text != null ? "<div class='dhxtoolbar_text'>" + c.text + "</div>" : ""));
	
	var g = this;
	this.obj.onselectstart = function(m) {
		m = m || event;
		if (m.preventDefault) {
			m.preventDefault()
		} else {
			m.returnValue = false
		}
	};
	this.obj.onmouseover = function() {
		this._doOnMouseOver()
	};
	this.obj.onmouseout = function() {
		this._doOnMouseOut()
	};
	this.obj._doOnMouseOver = function() {
		this.allowClick = true;
		if (g.state == false) {
			return
		}
		if (a.anyUsed != "none") {
			return
		}
		this.className = "dhx_toolbar_btn dhxtoolbar_btn_over";
		this.renderAs = this.className
	};
	this.obj._doOnMouseOut = function() {
		this.allowClick = false;
		if (g.state == false) {
			return
		}
		if (a.anyUsed != "none") {
			return
		}
		this.className = "dhx_toolbar_btn dhxtoolbar_btn_def";
		this.renderAs = this.renderAs
	};
	this.obj.onclick = function(m) {
		if (g.state == false) {
			return
		}
		if (this.allowClick == false) {
			return
		}
		m = m || event;
		var n = this.idd.replace(a.idPrefix, "");
		if (this.extAction) {
			try {
				window[this.extAction](n)
			} catch (m) {}
		}
		if (a && a.callEvent) {
			a.callEvent("onClick", [n])
		}
	};
	this.obj[window.dhx4.isIPad ? "ontouchstart" : "onmousedown"] = function(m) {
		if (g.state == false) {
			m = m || event;
			if (m.preventDefault) {
				m.preventDefault()
			} else {
				m.returnValue = false
			}
			m.cancelBubble = true;
			return false
		}
		if (a.anyUsed != "none") {
			return
		}
		a.anyUsed = this.idd;
		this.className = "dhx_toolbar_btn dhxtoolbar_btn_pres";
		this.pressed = true;
		this.onmouseover = function() {
			this._doOnMouseOver()
		};
		this.onmouseout = function() {
			a.anyUsed = "none";
			this._doOnMouseOut()
		};
		return false
	};
	this.obj[window.dhx4.isIPad ? "ontouchend" : "onmouseup"] = function(n) {
		if (g.state == false) {
			return
		}
		if (a.anyUsed != "none") {
			if (a.anyUsed != this.idd) {
				return
			}
		}
		var m = a.anyUsed;
		this._doOnMouseUp();
		if (window.dhx4.isIPad && m != "none") {
			a.callEvent("onClick", [this.idd.replace(a.idPrefix, "")])
		}
	};
	if (window.dhx4.isIPad) {
		this.obj.ontouchmove = function(m) {
			this._doOnMouseUp()
		}
	}
	this.obj._doOnMouseUp = function() {
		a.anyUsed = "none";
		this.className = this.renderAs;
		this.pressed = false
	};
	this.obj._doOnMouseUpOnceAnywhere = function() {
		this._doOnMouseUp();
		this.onmouseover = function() {
			this._doOnMouseOver()
		};
		this.onmouseout = function() {
			this._doOnMouseOut()
		}
	};
	a.base.appendChild(this.obj);
	this.enableItem = function() {
		a._enableItem(this)
	};
	this.disableItem = function() {
		a._disableItem(this)
	};
	this.isEnabled = function() {
		return this.state
	};
	this.showItem = function() {
		this.obj.style.display = ""
	};
	this.hideItem = function() {
		this.obj.style.display = "none"
	};
	this.isVisible = function() {
		return (this.obj.style.display == "")
	};
	this.setItemText = function(m) {
		a._setItemText(this, m)
	};
	this.getItemText = function() {
		return a._getItemText(this)
	};
	this.setItemImage = function(m) {
		a._setItemImage(this, m, true)
	};
	this.clearItemImage = function() {
		a._clearItemImage(this, true)
	};
	this.setItemImageDis = function(m) {
		a._setItemImage(this, m, false)
	};
	this.clearItemImageDis = function() {
		a._clearItemImage(this, false)
	};
	this.setItemToolTip = function(m) {
		this.obj.title = m
	};
	this.getItemToolTip = function() {
		return this.obj.title
	};
	return this
};

//modify code by zzm 20161113
//增加接受图标按钮对象
//this.icontags=["<i class='fa fa-files-o'></i>","<i class='fa fa-caret-down'></i>"]
dhtmlXToolbarObject.prototype._buttonSelectObject = function(g, n, m) {
	this.id = g.idPrefix + n;
	this.state = (m.enabled != null ? (m.enabled == "true" ? true : false) : true);
	this.imgEn = (m.img || "");
	this.imgDis = (m.imgdis || "");
	this.img = (this.state ? (this.imgEn != "" ? this.imgEn : "") : (this.imgDis != "" ? this.imgDis : ""));
	this.mode = (m.mode || "button");
	if (this.mode == "select") {
		this.openAll = true;
		this.renderSelect = false;
		if (!m.text || m.text.length == 0) {
			m.text = "&nbsp;"
		}
	} else {
		this.openAll = (window.dhx4.s2b(m.openAll) == true);
		this.renderSelect = (m.renderSelect == null ? true : window.dhx4.s2b(m.renderSelect))
	}
	this.maxOpen = (!isNaN(m.maxOpen ? m.maxOpen : "") ? m.maxOpen : null);
	this._maxOpenTest = function() {
		if (!isNaN(this.maxOpen)) {
			if (!g._sbw) {
				var q = document.createElement("DIV");
				q.className = "dhxtoolbar_maxopen_test";
				document.body.appendChild(q);
				var o = document.createElement("DIV");
				o.className = "dhxtoolbar_maxopen_test2";
				q.appendChild(o);
				g._sbw = q.offsetWidth - o.offsetWidth;
				q.removeChild(o);
				o = null;
				document.body.removeChild(q);
				q = null
			}
		}
	};
	this._maxOpenTest();
	this.obj = document.createElement("DIV");
	this.obj.allowClick = false;
	this.obj.extAction = (m.action || null);
	this.obj.className = "dhx_toolbar_btn dhxtoolbar_btn_" + (this.state ? "def" : "dis");
	this.obj.style.display = (m.hidden != null ? "none" : "");
	this.obj.renderAs = this.obj.className;
	this.obj.onselectstart = function(o) {
		o = o || event;
		if (o.preventDefault) {
			o.preventDefault()
		} else {
			o.returnValue = false
		}
	};
	this.obj.idd = String(n);
	this.obj.title = (m.title || "");
	this.obj.pressed = false;
	this.callEvent = false;
	
	//modify code by zzm 20161113
	this.icontags = m.icontags;
	if(this.icontags && this.icontags instanceof Array){
	}else{
		this.icontags = null;
	}
	//modify code by zzm 20161113
	this.obj.innerHTML = (this.icontags!=null?this.icontags[0]:"")+g._rtlParseBtn((this.img != "" ? "<img src='" + g.conf.icons_path + this.img + "'>" : ""), (m.text != null ? "<div class='dhxtoolbar_text'>" + m.text + "</div>" : ""));
	
	g.base.appendChild(this.obj);
	this.arw = document.createElement("DIV");
	this.arw.className = "dhx_toolbar_arw dhxtoolbar_btn_" + (this.state ? "def" : "dis");
	this.arw.style.display = this.obj.style.display;
	
	//modify code by zzm 20161113
	this.arw.innerHTML = "<div class='arwimg'>"+(this.icontags!=null?this.icontags[1]:"&nbsp;")+"</div>";
	
	
	this.arw.title = this.obj.title;
	this.arw.onselectstart = function(o) {
		o = o || event;
		if (o.preventDefault) {
			o.preventDefault()
		} else {
			o.returnValue = false
		}
	};
	g.base.appendChild(this.arw);
	var a = this;
	this.obj.onmouseover = function(o) {
		o = o || event;
		if (g.anyUsed != "none") {
			return
		}
		if (!a.state) {
			return
		}
		a.obj.renderAs = "dhx_toolbar_btn dhxtoolbar_btn_over";
		a.obj.className = a.obj.renderAs;
		a.arw.className = String(a.obj.renderAs).replace("btn", "arw")
	};
	this.obj.onmouseout = function() {
		a.obj.allowClick = false;
		if (g.anyUsed != "none") {
			return
		}
		if (!a.state) {
			return
		}
		a.obj.renderAs = "dhx_toolbar_btn dhxtoolbar_btn_def";
		a.obj.className = a.obj.renderAs;
		a.arw.className = String(a.obj.renderAs).replace("btn", "arw");
		a.callEvent = false
	};
	this.arw.onmouseover = this.obj.onmouseover;
	this.arw.onmouseout = this.obj.onmouseout;
	if (this.openAll == true) {} else {
		this.obj.onclick = function(o) {
			o = o || event;
			if (!a.obj.allowClick) {
				return
			}
			if (!a.state) {
				return
			}
			if (g.anyUsed != "none") {
				return
			}
			var q = a.obj.idd.replace(g.idPrefix, "");
			if (a.obj.extAction) {
				try {
					window[a.obj.extAction](q)
				} catch (o) {}
			}
			g.callEvent("onClick", [q])
		};
		this.obj[window.dhx4.isIPad ? "ontouchstart" : "onmousedown"] = function(o) {
			o = o || event;
			if (g.anyUsed != "none") {
				return
			}
			if (!a.state) {
				return
			}
			a.obj.allowClick = true;
			a.obj.className = "dhx_toolbar_btn dhxtoolbar_btn_pres";
			a.arw.className = "dhx_toolbar_arw dhxtoolbar_btn_pres";
			a.callEvent = true
		};
		this.obj[window.dhx4.isIPad ? "ontouchend" : "onmouseup"] = function(o) {
			o = o || event;
			o.cancelBubble = true;
			if (g.anyUsed != "none") {
				return
			}
			if (!a.state) {
				return
			}
			a.obj.className = a.obj.renderAs;
			a.arw.className = String(a.obj.renderAs).replace("btn", "arw");
			if (window.dhx4.isIPad && a.callEvent) {
				var q = a.obj.idd.replace(g.idPrefix, "");
				g.callEvent("onClick", [q])
			}
		}
	}
	if (window.dhx4.isIPad) {
		this.obj.ontouchmove = this.obj.onmouseout
	}
	this.arw[window.dhx4.isIPad ? "ontouchstart" : "onmousedown"] = function(r) {
		r = r || event;
		var y = (this.className.indexOf("dhx_toolbar_arw") === 0 ? this : this.nextSibling);
		if (y._skip) {
			r = r || event;
			r.cancelBubble = true
		} else {
			y._skip = true
		}
		y = null;
		if (!a.state) {
			return
		}
		if (g.anyUsed == a.obj.idd) {
			a.obj.className = a.obj.renderAs;
			a.arw.className = String(a.obj.renderAs).replace("btn", "arw");
			g.anyUsed = "none";
			window.dhx4.zim.clear(a.polygon._idd);
			a.polygon.style.display = "none";
			if (a.polygon._ie6cover) {
				a.polygon._ie6cover.style.display = "none"
			}
			if (g.conf.skin == "dhx_terrace") {
				g._improveTerraceButtonSelect(a.id, true)
			}
		} else {
			if (g.anyUsed != "none") {
				if (g.objPull[g.idPrefix + g.anyUsed]["type"] == "buttonSelect") {
					var x = g.objPull[g.idPrefix + g.anyUsed];
					if (x.polygon.style.display != "none") {
						x.obj.renderAs = "dhx_toolbar_btn dhxtoolbar_btn_def";
						x.obj.className = x.obj.renderAs;
						x.arw.className = String(a.obj.renderAs).replace("btn", "arw");
						window.dhx4.zim.clear(x.polygon._idd);
						x.polygon.style.display = "none";
						if (x.polygon._ie6cover) {
							x.polygon._ie6cover.style.display = "none"
						}
						if (g.conf.skin == "dhx_terrace") {
							g._improveTerraceButtonSelect(x.id, true)
						}
					}
				}
			}
			a.obj.className = "dhx_toolbar_btn dhxtoolbar_btn_over";
			a.arw.className = "dhx_toolbar_arw dhxtoolbar_btn_pres";
			g.anyUsed = a.obj.idd;
			a.polygon.style.top = "0px";
			a.polygon.style.visibility = "hidden";
			a.polygon.style.zIndex = window.dhx4.zim.reserve(a.polygon._idd);
			a.polygon.style.display = "";
			if (g.conf.skin == "dhx_terrace") {
				g._improveTerraceButtonSelect(a.id, false)
			}
			a._fixMaxOpenHeight(a.maxOpen || null);
			g._autoDetectVisibleArea();
			var s = window.dhx4.absTop(a.obj) + a.obj.offsetHeight + g.conf.sel_ofs_y;
			var v = a.polygon.offsetHeight;
			if (s + v > g.tY2) {
				var u = (a.maxOpen != null ? Math.floor((g.tY2 - s) / 22) : 0);
				if (u >= 1) {
					a._fixMaxOpenHeight(u)
				} else {
					s = window.dhx4.absTop(a.obj) - v - g.conf.sel_ofs_y;
					if (s < 0) {
						s = 0
					}
				}
			}
			a.polygon.style.top = s + "px";
			if (g.rtl) {
				a.polygon.style.left = window.dhx4.absLeft(a.obj) + a.obj.offsetWidth - a.polygon.offsetWidth + g.conf.sel_ofs_x + "px"
			} else {
				var q = document.body.scrollLeft;
				var o = q + (window.innerWidth || document.body.clientWidth);
				var w = window.dhx4.absLeft(a.obj) + g.conf.sel_ofs_x;
				if (w + a.polygon.offsetWidth > o) {
					w = window.dhx4.absLeft(a.arw) + a.arw.offsetWidth - a.polygon.offsetWidth
				}
				a.polygon.style.left = Math.max(w, 5) + "px"
			}
			a.polygon.style.visibility = "visible";
			if (a.polygon._ie6cover) {
				a.polygon._ie6cover.style.left = a.polygon.style.left;
				a.polygon._ie6cover.style.top = a.polygon.style.top;
				a.polygon._ie6cover.style.width = a.polygon.offsetWidth + "px";
				a.polygon._ie6cover.style.height = a.polygon.offsetHeight + "px";
				a.polygon._ie6cover.style.display = ""
			}
		}
		return false
	};
	this.arw.onclick = function(o) {
		o = o || event;
		o.cancelBubble = true
	};
	this.arw[window.dhx4.isIPad ? "ontouchend" : "onmouseup"] = function(o) {
		o = o || event;
		o.cancelBubble = true
	};
	if (this.openAll === true) {
		this.obj.onclick = this.arw.onclick;
		this.obj.onmousedown = this.arw.onmousedown;
		this.obj.onmouseup = this.arw.onmouseup;
		if (window.dhx4.isIPad) {
			this.obj.ontouchstart = this.arw.ontouchstart;
			this.obj.ontouchend = this.arw.ontouchend
		}
	}
	this.obj.iddPrefix = g.idPrefix;
	this._listOptions = {};
	this._fixMaxOpenHeight = function(u) {
		var s = "auto";
		var r = false;
		if (u !== null) {
			var q = 0;
			for (var o in this._listOptions) {
				q++
			}
			if (q > u) {
				this._ph = 22 * u;
				s = this._ph + "px"
			} else {
				r = true
			}
		}
		this.polygon.style.width = "auto";
		this.polygon.style.height = "auto";
		if (!r && a.maxOpen != null) {
			this.polygon.style.width = this.p_tbl.offsetWidth + g._sbw + "px";
			this.polygon.style.height = s
		}
	};
	this._separatorButtonSelectObject = function(r, o, q) {
		this.obj = {};
		this.obj.tr = document.createElement("TR");
		this.obj.tr.className = "tr_sep";
		this.obj.tr.onselectstart = function(s) {
			s = s || event;
			if (s.preventDefault) {
				s.preventDefault()
			} else {
				s.returnValue = false
			}
			return false
		};
		this.obj.td = document.createElement("TD");
		this.obj.td.colSpan = "2";
		this.obj.td.className = "td_btn_sep";
		this.obj.td.onselectstart = function(s) {
			s = s || event;
			if (s.preventDefault) {
				s.preventDefault()
			} else {
				s.returnValue = false
			}
			return false
		};
		if (isNaN(q)) {
			q = a.p_tbody.childNodes.length + 1
		} else {
			if (q < 1) {
				q = 1
			}
		}
		if (q > a.p_tbody.childNodes.length) {
			a.p_tbody.appendChild(this.obj.tr)
		} else {
			a.p_tbody.insertBefore(this.obj.tr, a.p_tbody.childNodes[q - 1])
		}
		this.obj.tr.appendChild(this.obj.td);
		this.obj.sep = document.createElement("DIV");
		this.obj.sep.className = "btn_sep";
		this.obj.sep.onselectstart = function(s) {
			s = s || event;
			if (s.preventDefault) {
				s.preventDefault()
			} else {
				s.returnValue = false
			}
			return false
		};
		this.obj.td.appendChild(this.obj.sep);
		a._listOptions[r] = this.obj;
		return this
	};
	this._buttonButtonSelectObject = function(u, r, s) {
		var q = true;
		if (typeof(r.enabled) != "undefined") {
			q = window.dhx4.s2b(r.enabled)
		} else {
			if (typeof(r.disabled) != "undefined") {
				q = window.dhx4.s2b(r.disabled)
			}
		}
		this.obj = {};
		this.obj.tr = document.createElement("TR");
		this.obj.tr.en = q;
		this.obj.tr.extAction = (r.action || null);
		this.obj.tr._selected = (r.selected != null);
		this.obj.tr.className = "tr_btn" + (this.obj.tr.en ? (this.obj.tr._selected && a.renderSelect ? " tr_btn_selected" : "") : " tr_btn_disabled");
		this.obj.tr.onselectstart = function(v) {
			v = v || event;
			if (v.preventDefault) {
				v.preventDefault()
			} else {
				v.returnValue = false
			}
			return false
		};
		this.obj.tr.idd = String(u);
		if (isNaN(s)) {
			s = a.p_tbody.childNodes.length + 1
		} else {
			if (s < 1) {
				s = 1
			}
		}
		if (s > a.p_tbody.childNodes.length) {
			a.p_tbody.appendChild(this.obj.tr)
		} else {
			a.p_tbody.insertBefore(this.obj.tr, a.p_tbody.childNodes[s - 1])
		}
		this.obj.td_a = document.createElement("TD");
		this.obj.td_a.className = "td_btn_img";
		this.obj.td_a.onselectstart = function(v) {
			v = v || event;
			if (v.preventDefault) {
				v.preventDefault()
			} else {
				v.returnValue = false
			}
			return false
		};
		this.obj.td_b = document.createElement("TD");
		this.obj.td_b.className = "td_btn_txt";
		this.obj.td_b.onselectstart = function(v) {
			v = v || event;
			if (v.preventDefault) {
				v.preventDefault()
			} else {
				v.returnValue = false
			}
			return false
		};
		if (g.rtl) {
			this.obj.tr.appendChild(this.obj.td_b);
			this.obj.tr.appendChild(this.obj.td_a)
		} else {
			this.obj.tr.appendChild(this.obj.td_a);
			this.obj.tr.appendChild(this.obj.td_b)
		}
		if (r.img != null) {
			this.obj.td_a.innerHTML = "<img class='btn_sel_img' src='" + g.conf.icons_path + r.img + "' border='0'>";
			this.obj.tr._img = r.img
		} else {
			this.obj.td_a.innerHTML = "&nbsp;"
		}
		var o = (r.text != null ? r.text : (r.itemText || ""));
		this.obj.td_b.innerHTML = "<div class='btn_sel_text'>" + o + "</div>";
		this.obj.tr[window.dhx4.isIPad ? "ontouchstart" : "onmouseover"] = function() {
			if (!this.en || (this._selected && a.renderSelect)) {
				return
			}
			this.className = "tr_btn tr_btn_over"
		};
		this.obj.tr.onmouseout = function() {
			if (!this.en) {
				return
			}
			if (this._selected && a.renderSelect) {
				if (String(this.className).search("tr_btn_selected") == -1) {
					this.className = "tr_btn tr_btn_selected"
				}
			} else {
				this.className = "tr_btn"
			}
		};
		this.obj.tr[window.dhx4.isIPad ? "ontouchend" : "onclick"] = function(v) {
			v = v || event;
			v.cancelBubble = true;
			if (!this.en) {
				return
			}
			a.setListOptionSelected(this.idd.replace(g.idPrefix, ""));
			a.obj.renderAs = "dhx_toolbar_btn dhxtoolbar_btn_def";
			a.obj.className = a.obj.renderAs;
			a.arw.className = String(a.obj.renderAs).replace("btn", "arw");
			window.dhx4.zim.clear(a.polygon._idd);
			a.polygon.style.display = "none";
			if (a.polygon._ie6cover) {
				a.polygon._ie6cover.style.display = "none"
			}
			if (g.conf.skin == "dhx_terrace") {
				g._improveTerraceButtonSelect(a.id, true)
			}
			g.anyUsed = "none";
			var w = this.idd.replace(g.idPrefix, "");
			if (this.extAction) {
				try {
					window[this.extAction](w)
				} catch (v) {}
			}
			g.callEvent("onClick", [w])
		};
		a._listOptions[u] = this.obj;
		return this
	};
	this.polygon = document.createElement("DIV");
	this.polygon.dir = "ltr";
	this.polygon.style.display = "none";
	this.polygon.className = "dhx_toolbar_poly_" + g.conf.skin + " dhxtoolbar_icons_" + g.conf.iconSize;
	this.polygon.onselectstart = function(o) {
		o = o || event;
		if (o.preventDefault) {
			o.preventDefault()
		} else {
			o.returnValue = false
		}
	};
	this.polygon.onmousedown = function(o) {
		o = o || event;
		o.cancelBubble = true
	};
	this.polygon.style.overflowY = "auto";
	this.polygon._idd = window.dhx4.newId();
	if (window.dhx4.isIPad) {
		this.polygon.ontouchstart = function(o) {
			o = o || event;
			if (o.preventDefault) {
				o.preventDefault()
			} else {
				o.returnValue = false
			}
			o.cancelBubble = true;
			return false
		}
	}
	this.p_tbl = document.createElement("TABLE");
	this.p_tbl.className = "buttons_cont";
	this.p_tbl.cellSpacing = "0";
	this.p_tbl.cellPadding = "0";
	this.p_tbl.border = "0";
	this.polygon.appendChild(this.p_tbl);
	this.p_tbody = document.createElement("TBODY");
	this.p_tbl.appendChild(this.p_tbody);
	if (m.options != null) {
		for (var l = 0; l < m.options.length; l++) {
			var c = "_" + (m.options[l].type || "") + "ButtonSelectObject";
			if (m.options[l].id == null) {
				m.options[l].id = g._genStr(24)
			}
			if (typeof(this[c]) == "function") {
				new this[c](m.options[l].id, m.options[l])
			}
		}
	}
	document.body.appendChild(this.polygon);
	if (window.dhx4.isIE6) {
		this.polygon._ie6cover = document.createElement("IFRAME");
		this.polygon._ie6cover.frameBorder = 0;
		this.polygon._ie6cover.style.position = "absolute";
		this.polygon._ie6cover.style.border = "none";
		this.polygon._ie6cover.style.backgroundColor = "#000000";
		this.polygon._ie6cover.style.filter = "alpha(opacity=100)";
		this.polygon._ie6cover.style.display = "none";
		this.polygon._ie6cover.setAttribute("src", "javascript:false;");
		document.body.appendChild(this.polygon._ie6cover)
	}
	this.setWidth = function(o) {
		this.obj.style.width = o - this.arw.offsetWidth + "px";
		this.polygon.style.width = this.obj.offsetWidth + this.arw.offsetWidth - 2 + "px";
		this.p_tbl.style.width = this.polygon.style.width
	};
	this.enableItem = function() {
		g._enableItem(this)
	};
	this.disableItem = function() {
		g._disableItem(this)
	};
	this.isEnabled = function() {
		return this.state
	};
	this.showItem = function() {
		this.obj.style.display = "";
		this.arw.style.display = ""
	};
	this.hideItem = function() {
		this.obj.style.display = "none";
		this.arw.style.display = "none"
	};
	this.isVisible = function() {
		return (this.obj.style.display == "")
	};
	this.setItemText = function(o) {
		g._setItemText(this, o)
	};
	this.getItemText = function() {
		return g._getItemText(this)
	};
	this.setItemImage = function(o) {
		g._setItemImage(this, o, true)
	};
	this.clearItemImage = function() {
		g._clearItemImage(this, true)
	};
	this.setItemImageDis = function(o) {
		g._setItemImage(this, o, false)
	};
	this.clearItemImageDis = function() {
		g._clearItemImage(this, false)
	};
	this.setItemToolTip = function(o) {
		this.obj.title = o;
		this.arw.title = o
	};
	this.getItemToolTip = function() {
		return this.obj.title
	};
	this.addListOption = function(v, u, r, s, o) {
		if (!(r == "button" || r == "separator")) {
			return
		}
		var q = {
			id: v,
			type: r,
			text: s,
			img: o
		};
		new this["_" + r + "ButtonSelectObject"](v, q, u)
	};
	this.removeListOption = function(r) {
		if (!this._isListButton(r, true)) {
			return
		}
		var o = this._listOptions[r];
		if (o.td_a != null && o.td_b != null) {
			o.td_a.onselectstart = null;
			o.td_b.onselectstart = null;
			while (o.td_a.childNodes.length > 0) {
				o.td_a.removeChild(o.td_a.childNodes[0])
			}
			while (o.td_b.childNodes.length > 0) {
				o.td_b.removeChild(o.td_b.childNodes[0])
			}
			o.tr.onselectstart = null;
			o.tr.onmouseover = null;
			o.tr.onmouseout = null;
			o.tr.onclick = null;
			while (o.tr.childNodes.length > 0) {
				o.tr.removeChild(o.tr.childNodes[0])
			}
			o.tr.parentNode.removeChild(o.tr);
			o.td_a = null;
			o.td_b = null;
			o.tr = null
		} else {
			o.sep.onselectstart = null;
			o.td.onselectstart = null;
			o.tr.onselectstart = null;
			while (o.td.childNodes.length > 0) {
				o.td.removeChild(o.td.childNodes[0])
			}
			while (o.tr.childNodes.length > 0) {
				o.tr.removeChild(o.tr.childNodes[0])
			}
			o.tr.parentNode.removeChild(o.tr);
			o.sep = null;
			o.td = null;
			o.tr = null
		}
		o = null;
		this._listOptions[r] = null;
		try {
			delete this._listOptions[r]
		} catch (q) {}
	};
	this.showListOption = function(o) {
		if (!this._isListButton(o, true)) {
			return
		}
		this._listOptions[o].tr.style.display = ""
	};
	this.hideListOption = function(o) {
		if (!this._isListButton(o, true)) {
			return
		}
		this._listOptions[o].tr.style.display = "none"
	};
	this.isListOptionVisible = function(o) {
		if (!this._isListButton(o, true)) {
			return
		}
		return (this._listOptions[o].tr.style.display != "none")
	};
	this.enableListOption = function(o) {
		if (!this._isListButton(o)) {
			return
		}
		this._listOptions[o].tr.en = true;
		this._listOptions[o].tr.className = "tr_btn" + (this._listOptions[o].tr._selected && g.renderSelect ? " tr_btn_selected" : "")
	};
	this.disableListOption = function(o) {
		if (!this._isListButton(o)) {
			return
		}
		this._listOptions[o].tr.en = false;
		this._listOptions[o].tr.className = "tr_btn tr_btn_disabled"
	};
	this.isListOptionEnabled = function(o) {
		if (!this._isListButton(o)) {
			return
		}
		return this._listOptions[o].tr.en
	};
	this.setListOptionPosition = function(r, q) {
		if (!this._listOptions[r] || this.getListOptionPosition(r) == q || isNaN(q)) {
			return
		}
		if (q < 1) {
			q = 1
		}
		var o = this._listOptions[r].tr;
		this.p_tbody.removeChild(o);
		if (q > this.p_tbody.childNodes.length) {
			this.p_tbody.appendChild(o)
		} else {
			this.p_tbody.insertBefore(o, this.p_tbody.childNodes[q - 1])
		}
		o = null
	};
	this.getListOptionPosition = function(s) {
		var r = -1;
		if (!this._listOptions[s]) {
			return r
		}
		for (var o = 0; o < this.p_tbody.childNodes.length; o++) {
			if (this.p_tbody.childNodes[o] == this._listOptions[s].tr) {
				r = o + 1
			}
		}
		return r
	};
	this.setListOptionImage = function(s, o) {
		if (!this._isListButton(s)) {
			return
		}
		var r = this._listOptions[s].tr.childNodes[(g.rtl ? 1 : 0)];
		if (r.childNodes.length > 0) {
			r.childNodes[0].src = g.conf.icons_path + o
		} else {
			var q = document.createElement("IMG");
			q.className = "btn_sel_img";
			q.src = g.conf.icons_path + o;
			r.appendChild(q)
		}
		r = null
	};
	this.getListOptionImage = function(r) {
		if (!this._isListButton(r)) {
			return
		}
		var q = this._listOptions[r].tr.childNodes[(g.rtl ? 1 : 0)];
		var o = null;
		if (q.childNodes.length > 0) {
			o = q.childNodes[0].src
		}
		q = null;
		return o
	};
	this.clearListOptionImage = function(q) {
		if (!this._isListButton(q)) {
			return
		}
		var o = this._listOptions[q].tr.childNodes[(g.rtl ? 1 : 0)];
		while (o.childNodes.length > 0) {
			o.removeChild(o.childNodes[0])
		}
		o.innerHTML = "&nbsp;";
		o = null
	};
	this.setListOptionText = function(q, o) {
		if (!this._isListButton(q)) {
			return
		}
		this._listOptions[q].tr.childNodes[(g.rtl ? 0 : 1)].childNodes[0].innerHTML = o
	};
	this.getListOptionText = function(o) {
		if (!this._isListButton(o)) {
			return
		}
		return this._listOptions[o].tr.childNodes[(g.rtl ? 0 : 1)].childNodes[0].innerHTML
	};
	this.setListOptionToolTip = function(q, o) {
		if (!this._isListButton(q)) {
			return
		}
		this._listOptions[q].tr.title = o
	};
	this.getListOptionToolTip = function(o) {
		if (!this._isListButton(o)) {
			return
		}
		return this._listOptions[o].tr.title
	};
	this.forEachListOption = function(q) {
		for (var o in this._listOptions) {
			q(o)
		}
	};
	this.getAllListOptions = function() {
		var q = new Array();
		for (var o in this._listOptions) {
			q[q.length] = o
		}
		return q
	};
	this.setListOptionSelected = function(r) {
		for (var o in this._listOptions) {
			var q = this._listOptions[o];
			if (q.td_a != null && q.td_b != null && q.tr.en) {
				if (o == r) {
					q.tr._selected = true;
					q.tr.className = "tr_btn" + (this.renderSelect ? " tr_btn_selected" : "");
					if (this.mode == "select") {
						if (q.tr._img) {
							this.setItemImage(q.tr._img)
						} else {
							this.clearItemImage()
						}
						this.setItemText(this.getListOptionText(r))
					}
				} else {
					q.tr._selected = false;
					q.tr.className = "tr_btn"
				}
			}
			q = null
		}
	};
	this.getListOptionSelected = function() {
		var q = null;
		for (var o in this._listOptions) {
			if (this._listOptions[o].tr._selected == true) {
				q = o
			}
		}
		return q
	};
	this._isListButton = function(q, o) {
		if (this._listOptions[q] == null) {
			return false
		}
		if (!o && this._listOptions[q].tr.className == "tr_sep") {
			return false
		}
		return true
	};
	this.setMaxOpen = function(o) {
		this._ph = null;
		if (typeof(o) == "number") {
			this.maxOpen = o;
			this._maxOpenTest();
			return
		}
		this.maxOpen = null
	};
	if (m.width) {
		this.setWidth(m.width)
	}
	if (this.mode == "select" && typeof(m.selected) != "undefined") {
		this.setListOptionSelected(m.selected)
	}
	return this
};
dhtmlXToolbarObject.prototype._buttonInputObject = function(g, m, l) {
	this.id = g.idPrefix + m;
	this.obj = document.createElement("DIV");
	this.obj.className = "dhx_toolbar_btn dhxtoolbar_btn_def";
	this.obj.style.display = (l.hidden != null ? "none" : "");
	this.obj.idd = String(m);
	this.obj.w = (l.width != null ? l.width : 100);
	this.obj.title = (l.title != null ? l.title : "");
	this.obj.innerHTML = "<input class='dhxtoolbar_input' type='text' style='width:" + this.obj.w + "px;'" + (l.value != null ? " value='" + l.value + "'" : "") + ">";
	var c = g;
	var a = this;
	this.obj.childNodes[0].onkeydown = function(n) {
		n = n || event;
		if (n.keyCode == 13) {
			c.callEvent("onEnter", [a.obj.idd, this.value])
		}
	};
	g.base.appendChild(this.obj);
	this.enableItem = function() {
		this.obj.childNodes[0].disabled = false
	};
	this.disableItem = function() {
		this.obj.childNodes[0].disabled = true
	};
	this.isEnabled = function() {
		return (!this.obj.childNodes[0].disabled)
	};
	this.showItem = function() {
		this.obj.style.display = ""
	};
	this.hideItem = function() {
		this.obj.style.display = "none"
	};
	this.isVisible = function() {
		return (this.obj.style.display != "none")
	};
	this.setValue = function(n) {
		this.obj.childNodes[0].value = n
	};
	this.getValue = function() {
		return this.obj.childNodes[0].value
	};
	this.setWidth = function(n) {
		this.obj.w = n;
		this.obj.childNodes[0].style.width = this.obj.w + "px"
	};
	this.getWidth = function() {
		return this.obj.w
	};
	this.setItemToolTip = function(n) {
		this.obj.title = n
	};
	this.getItemToolTip = function() {
		return this.obj.title
	};
	this.getInput = function() {
		return this.obj.firstChild
	};
	if (typeof(l.enabled) != "undefined" && window.dhx4.s2b(l.enabled) == false) {
		this.disableItem()
	}
	return this
};
dhtmlXToolbarObject.prototype._buttonTwoStateObject = function(a, l, c) {
	this.id = a.idPrefix + l;
	this.state = (c.enabled != null ? false : true);
	this.imgEn = (c.img != null ? c.img : "");
	this.imgDis = (c.imgdis != null ? c.imgdis : "");
	this.img = (this.state ? (this.imgEn != "" ? this.imgEn : "") : (this.imgDis != "" ? this.imgDis : ""));
	this.obj = document.createElement("DIV");
	this.obj.pressed = (c.selected != null);
	this.obj.extAction = (c.action || null);
	this.obj.className = "dhx_toolbar_btn dhxtoolbar_btn_" + (this.obj.pressed ? "pres" + (this.state ? "" : "_dis") : (this.state ? "def" : "dis"));
	this.obj.style.display = (c.hidden != null ? "none" : "");
	this.obj.renderAs = this.obj.className;
	this.obj.idd = String(l);
	this.obj.title = (c.title || "");
	if (this.obj.pressed) {
		this.obj.renderAs = "dhx_toolbar_btn dhxtoolbar_btn_over"
	}
	this.obj.innerHTML = a._rtlParseBtn((this.img != "" ? "<img src='" + a.conf.icons_path + this.img + "'>" : ""), (c.text != null ? "<div class='dhxtoolbar_text'>" + c.text + "</div>" : ""));
	a.base.appendChild(this.obj);
	var g = this;
	this.obj.onselectstart = function(m) {
		m = m || event;
		if (m.preventDefault) {
			m.preventDefault()
		} else {
			m.returnValue = false
		}
	};
	this.obj.onmouseover = function() {
		this._doOnMouseOver()
	};
	this.obj.onmouseout = function() {
		this._doOnMouseOut()
	};
	this.obj._doOnMouseOver = function() {
		if (g.state == false) {
			return
		}
		if (a.anyUsed != "none") {
			return
		}
		if (this.pressed) {
			this.renderAs = "dhx_toolbar_btn dhxtoolbar_btn_over";
			return
		}
		this.className = "dhx_toolbar_btn dhxtoolbar_btn_over";
		this.renderAs = this.className
	};
	this.obj._doOnMouseOut = function() {
		if (g.state == false) {
			return
		}
		if (a.anyUsed != "none") {
			return
		}
		if (this.pressed) {
			this.renderAs = "dhx_toolbar_btn dhxtoolbar_btn_def";
			return
		}
		this.className = "dhx_toolbar_btn dhxtoolbar_btn_def";
		this.renderAs = this.className
	};
	this.obj[window.dhx4.isIPad ? "ontouchstart" : "onmousedown"] = function(m) {
		if (a.checkEvent("onBeforeStateChange")) {
			if (!a.callEvent("onBeforeStateChange", [this.idd.replace(a.idPrefix, ""), this.pressed])) {
				return
			}
		}
		if (g.state == false) {
			return
		}
		if (a.anyUsed != "none") {
			return
		}
		this.pressed = !this.pressed;
		this.className = (this.pressed ? "dhx_toolbar_btn dhxtoolbar_btn_pres" : this.renderAs);
		var n = this.idd.replace(a.idPrefix, "");
		if (this.extAction) {
			try {
				window[this.extAction](n, this.pressed)
			} catch (m) {}
		}
		a.callEvent("onStateChange", [n, this.pressed]);
		return false
	};
	this.setItemState = function(m, o) {
		if (this.obj.pressed != m) {
			if (m == true) {
				this.obj.pressed = true;
				this.obj.className = "dhx_toolbar_btn dhxtoolbar_btn_pres" + (this.state ? "" : "_dis");
				this.obj.renderAs = "dhx_toolbar_btn dhxtoolbar_btn_over"
			} else {
				this.obj.pressed = false;
				this.obj.className = "dhx_toolbar_btn dhxtoolbar_btn_" + (this.state ? "def" : "dis");
				this.obj.renderAs = this.obj.className
			}
			if (o == true) {
				var q = this.obj.idd.replace(a.idPrefix, "");
				if (this.obj.extAction) {
					try {
						window[this.obj.extAction](q, this.obj.pressed)
					} catch (n) {}
				}
				a.callEvent("onStateChange", [q, this.obj.pressed])
			}
		}
	};
	this.getItemState = function() {
		return this.obj.pressed
	};
	this.enableItem = function() {
		a._enableItem(this)
	};
	this.disableItem = function() {
		a._disableItem(this)
	};
	this.isEnabled = function() {
		return this.state
	};
	this.showItem = function() {
		this.obj.style.display = ""
	};
	this.hideItem = function() {
		this.obj.style.display = "none"
	};
	this.isVisible = function() {
		return (this.obj.style.display == "")
	};
	this.setItemText = function(m) {
		a._setItemText(this, m)
	};
	this.getItemText = function() {
		return a._getItemText(this)
	};
	this.setItemImage = function(m) {
		a._setItemImage(this, m, true)
	};
	this.clearItemImage = function() {
		a._clearItemImage(this, true)
	};
	this.setItemImageDis = function(m) {
		a._setItemImage(this, m, false)
	};
	this.clearItemImageDis = function() {
		a._clearItemImage(this, false)
	};
	this.setItemToolTip = function(m) {
		this.obj.title = m
	};
	this.getItemToolTip = function() {
		return this.obj.title
	};
	return this
};
dhtmlXToolbarObject.prototype._sliderObject = function(l, n, m) {
	this.id = l.idPrefix + n;
	this.state = (m.enabled != null ? (m.enabled == "true" ? true : false) : true);
	this.obj = document.createElement("DIV");
	this.obj.className = "dhx_toolbar_btn dhxtoolbar_btn_" + (this.state ? "def" : "dis");
	this.obj.style.display = (m.hidden != null ? "none" : "");
	this.obj.onselectstart = function(o) {
		o = o || event;
		if (o.preventDefault) {
			o.preventDefault()
		} else {
			o.returnValue = false
		}
	};
	this.obj.idd = String(n);
	this.obj.len = (m.length != null ? Number(m.length) : 50);
	this.obj.innerHTML = "<div class='dhxtoolbar_text'>" + (m.textMin || "") + "</div><div class='dhxtoolbar_sl_bg_l'></div><div class='dhxtoolbar_sl_bg_m' style='width:" + this.obj.len + "px;'></div><div class='dhxtoolbar_sl_bg_r'></div><div class='dhxtoolbar_text'>" + (m.textMax || "") + "</div>";
	l.base.appendChild(this.obj);
	var a = this;
	this.pen = document.createElement("DIV");
	this.pen.className = "dhxtoolbar_sl_pen";
	this.obj.appendChild(this.pen);
	var g = this.pen;
	this.label = document.createElement("DIV");
	this.label.dir = "ltr";
	this.label.className = "dhx_toolbar_slider_label_" + l.conf.skin + (l.rtl ? "_rtl" : "");
	this.label.style.display = "none";
	this.label.tip = (m.toolTip || "%v");
	this.label._zi = window.dhx4.newId();
	document.body.appendChild(this.label);
	var c = this.label;
	this.pen.valueMin = (m.valueMin != null ? Number(m.valueMin) : 0);
	this.pen.valueMax = (m.valueMax != null ? Number(m.valueMax) : 100);
	if (this.pen.valueMin > this.pen.valueMax) {
		this.pen.valueMin = this.pen.valueMax
	}
	this.pen.valueNow = (m.valueNow != null ? Number(m.valueNow) : this.pen.valueMax);
	if (this.pen.valueNow > this.pen.valueMax) {
		this.pen.valueNow = this.pen.valueMax
	}
	if (this.pen.valueNow < this.pen.valueMin) {
		this.pen.valueNow = this.pen.valueMin
	}
	this.pen._detectLimits = function() {
		this.minX = a.obj.childNodes[1].offsetLeft + 2;
		this.maxX = a.obj.childNodes[3].offsetLeft - this.offsetWidth + 1
	};
	this.pen._detectLimits();
	this.pen._definePos = function() {
		this.nowX = Math.round((this.valueNow - this.valueMin) * (this.maxX - this.minX) / (this.valueMax - this.valueMin) + this.minX);
		this.style.left = this.nowX + "px";
		this.newNowX = this.nowX
	};
	this.pen._definePos();
	this.pen.initXY = 0;
	this.pen.allowMove = false;
	this.pen[window.dhx4.isIPad ? "ontouchstart" : "onmousedown"] = function(o) {
		if (a.state == false) {
			return
		}
		o = o || event;
		this.initXY = (window.dhx4.isIPad ? o.touches[0].clientX : o.clientX);
		this.newValueNow = this.valueNow;
		this.allowMove = true;
		this.className = "dhxtoolbar_sl_pen dhxtoolbar_over";
		if (c.tip != "") {
			c.style.visibility = "hidden";
			c.style.display = "";
			c.innerHTML = c.tip.replace("%v", this.valueNow);
			c.style.left = Math.round(window.dhx4.absLeft(this) + this.offsetWidth / 2 - c.offsetWidth / 2) + "px";
			c.style.top = window.dhx4.absTop(this) - c.offsetHeight - 3 + "px";
			c.style.visibility = "";
			c.style.zIndex = window.dhx4.zim.reserve(c._zi)
		}
	};
	this.pen._doOnMouseMoveStart = function(q) {
		q = q || event;
		if (!g.allowMove) {
			return
		}
		var o = (window.dhx4.isIPad ? q.touches[0].clientX : q.clientX);
		var r = o - g.initXY;
		if (o < window.dhx4.absLeft(g) + Math.round(g.offsetWidth / 2) && g.nowX == g.minX) {
			return
		}
		if (o > window.dhx4.absLeft(g) + Math.round(g.offsetWidth / 2) && g.nowX == g.maxX) {
			return
		}
		g.newNowX = g.nowX + r;
		if (g.newNowX < g.minX) {
			g.newNowX = g.minX
		}
		if (g.newNowX > g.maxX) {
			g.newNowX = g.maxX
		}
		g.nowX = g.newNowX;
		g.style.left = g.nowX + "px";
		g.initXY = o;
		g.newValueNow = Math.round((g.valueMax - g.valueMin) * (g.newNowX - g.minX) / (g.maxX - g.minX) + g.valueMin);
		if (c.tip != "") {
			c.innerHTML = c.tip.replace(/%v/gi, g.newValueNow);
			c.style.left = Math.round(window.dhx4.absLeft(g) + g.offsetWidth / 2 - c.offsetWidth / 2) + "px";
			c.style.top = window.dhx4.absTop(g) - c.offsetHeight - 3 + "px"
		}
		q.cancelBubble = true;
		if (q.preventDefault) {
			q.preventDefault()
		} else {
			q.returnValue = false
		}
		return false
	};
	this.pen._doOnMouseMoveEnd = function() {
		if (!g.allowMove) {
			return
		}
		g.className = "dhxtoolbar_sl_pen";
		g.allowMove = false;
		g.nowX = g.newNowX;
		g.valueNow = g.newValueNow;
		if (c.tip != "") {
			c.style.display = "none";
			window.dhx4.zim.clear(c._zi)
		}
		l.callEvent("onValueChange", [a.obj.idd.replace(l.idPrefix, ""), g.valueNow])
	};
	if (window.dhx4.isIPad) {
		document.addEventListener("touchmove", g._doOnMouseMoveStart, false);
		document.addEventListener("touchend", g._doOnMouseMoveEnd, false)
	} else {
		if (typeof(window.addEventListener) != "undefined") {
			window.addEventListener("mousemove", g._doOnMouseMoveStart, false);
			window.addEventListener("mouseup", g._doOnMouseMoveEnd, false)
		} else {
			document.body.attachEvent("onmousemove", g._doOnMouseMoveStart);
			document.body.attachEvent("onmouseup", g._doOnMouseMoveEnd)
		}
	}
	this.enableItem = function() {
		if (this.state) {
			return
		}
		this.state = true;
		this.obj.className = "dhx_toolbar_btn dhxtoolbar_btn_def"
	};
	this.disableItem = function() {
		if (!this.state) {
			return
		}
		this.state = false;
		this.obj.className = "dhx_toolbar_btn dhxtoolbar_btn_dis"
	};
	this.isEnabled = function() {
		return this.state
	};
	this.showItem = function() {
		this.obj.style.display = ""
	};
	this.hideItem = function() {
		this.obj.style.display = "none"
	};
	this.isVisible = function() {
		return (this.obj.style.display == "")
	};
	this.setValue = function(o, q) {
		o = Number(o);
		if (o < this.pen.valueMin) {
			o = this.pen.valueMin
		}
		if (o > this.pen.valueMax) {
			o = this.pen.valueMax
		}
		this.pen.valueNow = o;
		this.pen._definePos();
		if (q == true) {
			l.callEvent("onValueChange", [this.obj.idd.replace(l.idPrefix, ""), this.pen.valueNow])
		}
	};
	this.getValue = function() {
		return this.pen.valueNow
	};
	this.setMinValue = function(q, o) {
		q = Number(q);
		if (q > this.pen.valueMax) {
			return
		}
		this.obj.childNodes[0].innerHTML = o;
		this.obj.childNodes[0].style.display = (o.length > 0 ? "" : "none");
		this.pen.valueMin = q;
		if (this.pen.valueNow < this.pen.valueMin) {
			this.pen.valueNow = this.pen.valueMin
		}
		this.pen._detectLimits();
		this.pen._definePos()
	};
	this.setMaxValue = function(q, o) {
		q = Number(q);
		if (q < this.pen.valueMin) {
			return
		}
		this.obj.childNodes[4].innerHTML = o;
		this.obj.childNodes[4].style.display = (o.length > 0 ? "" : "none");
		this.pen.valueMax = q;
		if (this.pen.valueNow > this.pen.valueMax) {
			this.pen.valueNow = this.pen.valueMax
		}
		this.pen._detectLimits();
		this.pen._definePos()
	};
	this.getMinValue = function() {
		var o = this.obj.childNodes[0].innerHTML;
		var q = this.pen.valueMin;
		return new Array(q, o)
	};
	this.getMaxValue = function() {
		var o = this.obj.childNodes[4].innerHTML;
		var q = this.pen.valueMax;
		return new Array(q, o)
	};
	this.setItemToolTipTemplate = function(o) {
		this.label.tip = o
	};
	this.getItemToolTipTemplate = function() {
		return this.label.tip
	};
	return this
};
dhtmlXToolbarObject.prototype.unload = function() {
	if (this.conf.isIPad) {
		document.removeEventListener("touchstart", this._doOnClick, false)
	} else {
		if (typeof(window.addEventListener) == "function") {
			window.removeEventListener("mousedown", this._doOnClick, false)
		} else {
			document.body.detachEvent("onmousedown", this._doOnClick)
		}
	}
	this._doOnClick = null;
	this.clearAll();
	this.objPull = null;
	if (this._xmlLoader) {
		this._xmlLoader.destructor();
		this._xmlLoader = null
	}
	while (this.base.childNodes.length > 0) {
		this.base.removeChild(this.base.childNodes[0])
	}
	this.cont.removeChild(this.base);
	this.base = null;
	while (this.cont.childNodes.length > 0) {
		this.cont.removeChild(this.cont.childNodes[0])
	}
	this.cont.className = "";
	this.cont = null;
	window.dhx4._enableDataLoading(this, null, null, null, "clear");
	window.dhx4._eventable(this, "clear");
	this.tX1 = null;
	this.tX2 = null;
	this.tY1 = null;
	this.tY2 = null;
	this.anyUsed = null;
	this.idPrefix = null;
	this.rootTypes = null;
	this._rtl = null;
	this._rtlParseBtn = null;
	this.setRTL = null;
	this._sbw = null;
	this._getObj = null;
	this._addImgObj = null;
	this._setItemImage = null;
	this._clearItemImage = null;
	this._setItemText = null;
	this._getItemText = null;
	this._enableItem = null;
	this._disableItem = null;
	this._xmlParser = null;
	this._addItemToStorage = null;
	this._genStr = null;
	this._addItem = null;
	this._getPosition = null;
	this._setPosition = null;
	this._getIdByPosition = null;
	this._separatorObject = null;
	this._textObject = null;
	this._buttonObject = null;
	this._buttonSelectObject = null;
	this._buttonInputObject = null;
	this._buttonTwoStateObject = null;
	this._sliderObject = null;
	this._autoDetectVisibleArea = null;
	this._removeItem = null;
	this.setAlign = null;
	this.setSkin = null;
	this.setIconsPath = null;
	this.setIconPath = null;
	this.loadXML = null;
	this.loadXMLString = null;
	this.clearAll = null;
	this.addSpacer = null;
	this.removeSpacer = null;
	this.getType = null;
	this.getTypeExt = null;
	this.inArray = null;
	this.getParentId = null;
	this.addButton = null;
	this.addText = null;
	this.addButtonSelect = null;
	this.addButtonTwoState = null;
	this.addSeparator = null;
	this.addSlider = null;
	this.addInput = null;
	this.forEachItem = null;
	this.showItem = null;
	this.hideItem = null;
	this.isVisible = null;
	this.enableItem = null;
	this.disableItem = null;
	this.isEnabled = null;
	this.setItemText = null;
	this.getItemText = null;
	this.setItemToolTip = null;
	this.getItemToolTip = null;
	this.setItemImage = null;
	this.setItemImageDis = null;
	this.clearItemImage = null;
	this.clearItemImageDis = null;
	this.setItemState = null;
	this.getItemState = null;
	this.setItemToolTipTemplate = null;
	this.getItemToolTipTemplate = null;
	this.setValue = null;
	this.getValue = null;
	this.setMinValue = null;
	this.getMinValue = null;
	this.setMaxValue = null;
	this.getMaxValue = null;
	this.setWidth = null;
	this.getWidth = null;
	this.getPosition = null;
	this.setPosition = null;
	this.removeItem = null;
	this.addListOption = null;
	this.removeListOption = null;
	this.showListOption = null;
	this.hideListOption = null;
	this.isListOptionVisible = null;
	this.enableListOption = null;
	this.disableListOption = null;
	this.isListOptionEnabled = null;
	this.setListOptionPosition = null;
	this.getListOptionPosition = null;
	this.setListOptionText = null;
	this.getListOptionText = null;
	this.setListOptionToolTip = null;
	this.getListOptionToolTip = null;
	this.setListOptionImage = null;
	this.getListOptionImage = null;
	this.clearListOptionImage = null;
	this.forEachListOption = null;
	this.getAllListOptions = null;
	this.setListOptionSelected = null;
	this.getListOptionSelected = null;
	this.unload = null;
	this.setUserData = null;
	this.getUserData = null;
	this.setMaxOpen = null;
	this.items = null;
	this.conf = null
};
dhtmlXToolbarObject.prototype._autoDetectVisibleArea = function() {
	var a = window.dhx4.screenDim();
	this.tX1 = a.left;
	this.tX2 = a.right;
	this.tY1 = a.top;
	this.tY2 = a.bottom
};
dhtmlXToolbarObject.prototype._initObj = function(c) {
	for (var a = 0; a < c.length; a++) {
		this._addItemToStorage(c[a])
	}
	if (this.conf.skin == "dhx_terrace") {
		this._improveTerraceSkin()
	}
};
dhtmlXToolbarObject.prototype._xmlToJson = function(v) {
	var o = [];
	var A = v.getElementsByTagName("toolbar");
	if (A != null && A[0] != null) {
		A = A[0];
		var E = ["id", "type", "hidden", "title", "text", "enabled", "img", "imgdis", "action", "openAll", "renderSelect", "mode", "maxOpen", "width", "value", "selected", "length", "textMin", "textMax", "toolTip", "valueMin", "valueMax", "valueNow"];
		var g = ["id", "type", "enabled", "disabled", "action", "selected", "img", "text"];
		for (var c = 0; c < A.childNodes.length; c++) {
			if (A.childNodes[c].tagName == "item") {
				var n = {};
				for (var C = 0; C < E.length; C++) {
					var l = A.childNodes[c].getAttribute(E[C]);
					if (l != null) {
						n[E[C]] = l
					}
				}
				for (var y = 0; y < A.childNodes[c].childNodes.length; y++) {
					if (A.childNodes[c].childNodes[y].tagName == "item" && n.type == "buttonSelect") {
						var D = {};
						for (var C = 0; C < g.length; C++) {
							var l = A.childNodes[c].childNodes[y].getAttribute(g[C]);
							if (l != null) {
								D[g[C]] = l
							}
						}
						var x = A.childNodes[c].childNodes[y].getElementsByTagName("itemText");
						if (x != null && x[0] != null) {
							D.itemText = x[0].firstChild.nodeValue
						}
						var s = A.childNodes[c].childNodes[y].getElementsByTagName("userdata");
						for (var C = 0; C < s.length; C++) {
							if (!D.userdata) {
								D.userdata = {}
							}
							var a = {};
							try {
								a.name = s[C].getAttribute("name")
							} catch (m) {
								a.name = null
							}
							try {
								a.value = s[C].firstChild.nodeValue
							} catch (m) {
								a.value = ""
							}
							if (a.name != null) {
								D.userdata[a.name] = a.value
							}
						}
						if (n.options == null) {
							n.options = []
						}
						n.options.push(D)
					}
					if (A.childNodes[c].childNodes[y].tagName == "userdata") {
						if (n.userdata == null) {
							n.userdata = {}
						}
						var D = {};
						try {
							D.name = A.childNodes[c].childNodes[y].getAttribute("name")
						} catch (m) {
							D.name = null
						}
						try {
							D.value = A.childNodes[c].childNodes[y].firstChild.nodeValue
						} catch (m) {
							D.value = ""
						}
						if (D.name != null) {
							n.userdata[D.name] = D.value
						}
					}
				}
				o.push(n)
			}
		}
	}
	return o
};
dhtmlXToolbarObject.prototype._addItemToStorage = function(n, r) {
	var o = (n.id || this._genStr(24));
	var l = (n.type || "");
	if (l == "spacer") {
		this.addSpacer(this._lastId)
	} else {
		this._lastId = o
	}
	if (l != "" && this["_" + l + "Object"] != null) {
		if (l == "buttonSelect") {
			if (n.options != null) {
				for (var m = 0; m < n.options.length; m++) {
					if (n.options[m].type == "obj") {
						n.options[m].type = "button"
					}
					if (n.options[m].type == "sep") {
						n.options[m].type = "separator"
					}
				}
			}
		}
		if (l == "slider") {
			var g = {
				tip_template: "toolTip",
				value_min: "valueMin",
				value_max: "valueMax",
				value_now: "valueNow",
				text_min: "textMin",
				text_max: "textMax"
			};
			for (var c in g) {
				if (n[g[c]] == null && n[c] != null) {
					n[g[c]] = n[c]
				}
			}
		}
		if (l == "buttonInput") {
			if (n.value == null && n.text != null) {
				n.value = n.text
			}
		}
		if (l == "buttonTwoState") {
			if (typeof(n.selected) == "undefined" && typeof(n.pressed) != "undefined" && window.dhx4.s2b(n.pressed)) {
				n.selected = true
			}
		}
		if (typeof(n.enabled) == "undefined" && typeof(n.disabled) != "undefined" && window.dhx4.s2b(n.disabled)) {
			n.enabled = false
		}
		if (n.imgDis == null && n.img_disabled != null) {
			n.imgdis = n.img_disabled
		}
		if ((typeof(n.openAll) == "undefined" || n.openAll == null) && this.conf.skin == "dhx_terrace") {
			n.openAll = true
		}
		this.objPull[this.idPrefix + o] = new this["_" + l + "Object"](this, o, n);
		this.objPull[this.idPrefix + o]["type"] = l;
		this.setPosition(o, r)
	}
	if (n.userdata != null) {
		for (var c in n.userdata) {
			this.setUserData(o, c, n.userdata[c])
		}
	}
	if (n.options != null) {
		for (var m = 0; m < n.options.length; m++) {
			if (n.options[m].userdata != null) {
				for (var c in n.options[m].userdata) {
					this.setListOptionUserData(n.id, n.options[m].id, c, n.options[m].userdata[c])
				}
			}
		}
	}
};
dhtmlXToolbarObject.prototype.setSkin = function(m, g) {
	if (g === true) {
		this.cont.className = this.cont.className.replace(/dhxtoolbar_icons_\d{1,}/, "dhxtoolbar_icons_" + this.conf.iconSize)
	} else {
		this.conf.skin = m;
		if (this.conf.skin == "dhx_skyblue") {
			this.conf.sel_ofs_y = 1
		}
		if (this.conf.skin == "dhx_web") {
			this.conf.sel_ofs_y = 1;
			this.conf.sel_ofs_x = 1
		}
		if (this.conf.skin == "dhx_terrace") {
			this.conf.sel_ofs_y = -1;
			this.conf.sel_ofs_x = 0
		}
		this.cont.className = "dhx_toolbar_" + this.conf.skin + " dhxtoolbar_icons_" + this.conf.iconSize
	}
	for (var c in this.objPull) {
		var l = this.objPull[c];
		if (l.type == "slider") {
			l.pen._detectLimits();
			l.pen._definePos();
			l.label.className = "dhx_toolbar_slider_label_" + this.conf.skin
		}
		if (l.type == "buttonSelect") {
			l.polygon.className = "dhx_toolbar_poly_" + this.conf.skin + " dhxtoolbar_icons_" + this.conf.iconSize
		}
	}
	if (m == "dhx_terrace") {
		this._improveTerraceSkin()
	}
};
dhtmlXToolbarObject.prototype.setAlign = function(a) {
	this.conf.align = (a == "right" ? "right" : "left");
	this.base.className = (a == "right" ? "dhxtoolbar_float_right" : "dhxtoolbar_float_left");
	if (this._spacer) {
		this._spacer.className = (a == "right" ? " dhxtoolbar_float_left" : " dhxtoolbar_float_right")
	}
};
dhtmlXToolbarObject.prototype.setIconSize = function(a) {
	this.conf.iconSize = ({
		18: true,
		24: true,
		32: true,
		48: true
	}[a] ? a : 18);
	this.setSkin(this.conf.skin, true);
	this.callEvent("_onIconSizeChange", [this.conf.iconSize])
};
dhtmlXToolbarObject.prototype.setIconsPath = function(a) {
	this.conf.icons_path = a
};
dhtmlXToolbarObject.prototype.setUserData = function(g, a, c) {
	g = this.idPrefix + g;
	if (this.objPull[g] != null) {
		if (this.objPull[g].userData == null) {
			this.objPull[g].userData = {}
		}
		this.objPull[g].userData[a] = c
	}
};
dhtmlXToolbarObject.prototype.getUserData = function(c, a) {
	c = this.idPrefix + c;
	if (this.objPull[c] != null && this.objPull[c].userData != null) {
		return this.objPull[c].userData[a] || null
	}
	return null
};
dhtmlXToolbarObject.prototype._isListOptionExists = function(a, g) {
	if (this.objPull[this.idPrefix + a] == null) {
		return false
	}
	var c = this.objPull[this.idPrefix + a];
	if (c.type != "buttonSelect") {
		return false
	}
	if (c._listOptions[g] == null) {
		return false
	}
	return true
};
dhtmlXToolbarObject.prototype.setListOptionUserData = function(a, m, c, l) {
	if (!this._isListOptionExists(a, m)) {
		return
	}
	var g = this.objPull[this.idPrefix + a]._listOptions[m];
	if (g.userData == null) {
		g.userData = {}
	}
	g.userData[c] = l
};
dhtmlXToolbarObject.prototype.getListOptionUserData = function(a, l, c) {
	if (!this._isListOptionExists(a, l)) {
		return null
	}
	var g = this.objPull[this.idPrefix + a]._listOptions[l];
	if (!g.userData) {
		return null
	}
	return (g.userData[c] ? g.userData[c] : null)
};
dhtmlXToolbarObject.prototype._improveTerraceSkin = function() {
	if (this.conf.terrace_radius == null) {
		this.conf.terrace_radius = "3px"
	}
	var g = [];
	var l = {
		separator: true,
		text: true
	};
	var n = [this.base];
	if (this._spacer != null) {
		n.push(this._spacer)
	}
	for (var r = 0; r < n.length; r++) {
		g[r] = [];
		for (var c = 0; c < n[r].childNodes.length; c++) {
			if (n[r].childNodes[c].idd != null && n[r].childNodes[c].style.display != "none") {
				var o = this.idPrefix + n[r].childNodes[c].idd;
				if (this.objPull[o] != null && this.objPull[o].obj == n[r].childNodes[c]) {
					g[r].push({
						a: o,
						type: this.objPull[o].type,
						node: this.objPull[o][this.objPull[o].type == "buttonSelect" ? "arw" : "obj"]
					})
				}
			}
		}
		n[r] = null
	}
	for (var r = 0; r < g.length; r++) {
		for (var c = 0; c < g[r].length; c++) {
			var s = g[r][c];
			var u = false;
			var m = false;
			if (!l[s.type]) {
				if (c == g[r].length - 1 || (g[r][c + 1] != null && l[g[r][c + 1].type])) {
					u = true
				}
				if (c == 0 || (c - 1 >= 0 && g[r][c - 1] != null && l[g[r][c - 1].type])) {
					m = true
				}
			}
			s.node.style.borderRightWidth = (u ? "1px" : "0px");
			s.node.style.borderTopRightRadius = s.node.style.borderBottomRightRadius = (u ? this.conf.terrace_radius : "0px");
			if (s.type == "buttonSelect") {
				s.node.previousSibling.style.borderTopLeftRadius = s.node.previousSibling.style.borderBottomLeftRadius = (m ? this.conf.terrace_radius : "0px");
				s.node.previousSibling._br = u;
				s.node.previousSibling._bl = m
			} else {
				s.node.style.borderTopLeftRadius = s.node.style.borderBottomLeftRadius = (m ? this.conf.terrace_radius : "0px")
			}
			s.node._br = u;
			s.node._bl = m
		}
	}
	for (var r = 0; r < g.length; r++) {
		for (var c = 0; c < g[r].length; c++) {
			for (var o in g[r][c]) {
				g[r][c][o] = null
			}
			g[r][c] = null
		}
		g[r] = null
	}
	g = n = null
};
dhtmlXToolbarObject.prototype._improveTerraceButtonSelect = function(g, c) {
	var a = this.objPull[g];
	if (c == true) {
		a.obj.style.borderBottomLeftRadius = (a.obj._bl ? this.conf.terrace_radius : "0px");
		a.arw.style.borderBottomRightRadius = (a.obj._br ? this.conf.terrace_radius : "0px")
	} else {
		a.obj.style.borderBottomLeftRadius = "0px";
		a.arw.style.borderBottomRightRadius = "0px"
	}
	a = null
};
if (typeof(window.dhtmlXCellObject) != "undefined") {
	dhtmlXCellObject.prototype._createNode_toolbar = function(m, c, l, a, g) {
		if (typeof(g) != "undefined") {
			m = g
		} else {
			m = document.createElement("DIV");
			m.className = "dhx_cell_toolbar_" + (this.conf.borders ? "def" : "no_borders");
			m.appendChild(document.createElement("DIV"));
			m.firstChild.className = "dhx_toolbar_base_18_dhx_skyblue"
		}
		this.cell.insertBefore(m, this.cell.childNodes[this.conf.idx.cont]);
		this.conf.ofs_nodes.t.toolbar = true;
		this._updateIdx();
		return m
	};
	dhtmlXCellObject.prototype.attachToolbar = function(a) {
		if (!(this.dataNodes.ribbon == null && this.dataNodes.toolbar == null)) {
			return
		}
		this.callEvent("_onBeforeContentAttach", ["toolbar"]);
		if (typeof(a) == "undefined") {
			a = {}
		} else {
			if (typeof(a) == "string") {
				a = {
					skin: a
				}
			}
		}
		if (typeof(a.skin) == "undefined") {
			a.skin = this.conf.skin
		}
		a.parent = this._attachObject("toolbar").firstChild;
		this.dataNodes.toolbar = new dhtmlXToolbarObject(a);
		this._adjustCont(this._idd);
		this.dataNodes.toolbar._masterCell = this;
		this.dataNodes.toolbar.attachEvent("_onIconSizeChange", function() {
			this._masterCell._adjustCont()
		});
		a.parent = null;
		a = null;
		this.callEvent("_onContentAttach", []);
		return this.dataNodes.toolbar
	};
	dhtmlXCellObject.prototype.detachToolbar = function() {
		if (!this.dataNodes.toolbar) {
			return
		}
		this.dataNodes.toolbar._masterCell = null;
		this.dataNodes.toolbar.unload();
		this.dataNodes.toolbar = null;
		delete this.dataNodes.toolbar;
		this._detachObject("toolbar")
	};
	dhtmlXCellObject.prototype.showToolbar = function() {
		this._mtbShowHide("toolbar", "")
	};
	dhtmlXCellObject.prototype.hideToolbar = function() {
		this._mtbShowHide("toolbar", "none")
	};
	dhtmlXCellObject.prototype.getAttachedToolbar = function() {
		return this.dataNodes.toolbar
	}
}

function dhtmlXEditor(g, l) {
	var c = this;
	this.conf = {
		content: "",
		contentHTML: "",
		resizeTM: null,
		resizeTMTime: 100,
		roMode: false,
		toolbar: false,
		iconsPath: "",
		evs: ["focus", "blur", "keydown", "keyup", "keypress", "mouseup", "mousedown", "click"]
	};
	this._doOnFocusChanged = null;
	this._doOnAccess = null;
	if (typeof(g) == "object" && g != null && g.tagName == null) {
		l = g.skin;
		if (g.content != null) {
			this.conf.content = g.content
		}
		if (g.contentHTML != null) {
			this.conf.contentHTML = g.contentHTML
		}
		if (g.iconsPath != null) {
			this.conf.iconsPath = g.iconsPath
		}
		if (g.toolbar != null) {
			this.conf.toolbar = window.dhx4.s2b(g.toolbar)
		}
		if (g.onFocusChanged != null) {
			this._doOnFocusChanged = g.onFocusChanged
		}
		if (g.onAccess != null) {
			this._doOnAccess = g.onAccess
		}
		g = g.parent
	}
	this.conf.skin = (l || window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhxeditor") || "dhx_skyblue");
	if (typeof(g) == "string") {
		g = document.getElementById(g)
	}
	this.base = g;
	this.base.className += " dhxeditor_" + this.conf.skin;
	while (this.base.childNodes.length > 0) {
		this.base.removeChild(this.base.childNodes[0])
	}
	var m = (window.dhx4.isIE ? this.base.currentStyle.position : window.getComputedStyle(this.base, null).getPropertyValue("position"));
	if (!(m == "relative" || m == "absolute")) {
		this.base.style.position = "relative"
	}
	this.cell = new dhtmlXEditorCell(window.dhx4.newId(), this);
	this.base.appendChild(this.cell.cell);
	this.cBlock = document.createElement("DIV");
	this.cBlock.className = "dhxcont_content_blocker";
	this.cBlock.style.display = "none";
	this.base.appendChild(this.cBlock);
	this.editor = document.createElement("IFRAME");
	this.editor.className = "dhxeditor_mainiframe";
	this.editor.frameBorder = 0;
	if (window.dhx4.isOpera) {
		this.editor.scrolling = "yes"
	}
	this.setSizes();
	var a = this.editor;
	if (typeof(window.addEventListener) != "undefined") {
		a.onload = function() {
			for (var n = 0; n < c.conf.evs.length; n++) {
				a.contentWindow.addEventListener(c.conf.evs[n], c._ev, false)
			}
		}
	} else {
		a.onreadystatechange = function(n) {
			if (typeof(a.readyState) != "undefined" && a.readyState == "complete") {
				try {
					for (var o = 0; o < c.conf.evs.length; o++) {
						a.contentWindow.document.body.attachEvent("on" + c.conf.evs[o], c._ev)
					}
				} catch (r) {}
			}
		}
	}
	this._ev = function(o) {
		o = o || event;
		var n = o.type;
		c.callEvent("onAccess", [n, o]);
		if (typeof(c._doOnAccess) == "function") {
			c._doOnAccess(n, o)
		} else {
			if (typeof(c._doOnAccess) == "string" && typeof(window[c._doOnAccess]) == "function") {
				window[c._doOnAccess](n, o)
			}
		}
	};
	this._focus = function() {
		if (window.dhx4.isIE) {
			this.editor.contentWindow.document.body.focus()
		} else {
			this.editor.contentWindow.focus()
		}
	};
	this.cell.attachObject(this.editor);
	this.edWin = this.editor.contentWindow;
	this.edDoc = this.edWin.document;
	this._prepareContent = function(q, s) {
		var o = "";
		if (q === true && this.getContent != null) {
			o = this.getContent()
		}
		var n = this.editor.contentWindow.document;
		n.open("text/html", "replace");
		if (window.dhx4.isOpera) {
			n.write("<html><head><style> html, body { overflow:auto;-webkit-overflow-scrolling: touch; padding:0px; height:100%; margin:0px; font-family:Tahoma; font-size:12px; background-color:#ffffff;} </style></head><body " + (s !== true ? "contenteditable='true'" : "") + " tabindex='0'></body></html>")
		} else {
			if (window.dhx4.isKHTML) {
				n.write("<html><head><style> html {overflow-x: auto;-webkit-overflow-scrolling: touch; overflow-y: auto;} body { overflow: auto; overflow-y: scroll;} html,body { padding:0px; height:100%; margin:0px; font-family:Tahoma; font-size:12px; background-color:#ffffff;} </style></head><body " + (s !== true ? "contenteditable='true'" : "") + " tabindex='0'></body></html>")
			} else {
				if (window.dhx4.isIE) {
					n.write("<html><head><style> html {overflow-y: auto;} body {overflow-y: scroll;-webkit-overflow-scrolling: touch;} html,body { overflow-x: auto; padding:0px; height:100%; margin:0px; font-family:Tahoma; font-size:12px; background-color: #ffffff; outline: none;} </style></head><body " + (s !== true ? "contenteditable='true'" : "") + " tabindex='0'></body></html>")
				} else {
					n.write("<html><head><style> html,body { overflow-x: auto; overflow-y:-webkit-overflow-scrolling: touch; scroll; padding:0px; height:100%; margin:0px; font-family:Tahoma; font-size:12px; background-color:#ffffff;} </style></head><body " + (s !== true ? "contenteditable='true'" : "") + " tabindex='0'></body></html>")
				}
			}
		}
		n.close();
		if (window.dhx4.isIE) {
			n.contentEditable = (s !== true)
		} else {
			n.designMode = (s !== true ? "On" : "Off")
		}
		if (window.dhx4.isFF) {
			try {
				n.execCommand("useCSS", false, true)
			} catch (r) {}
		}
		if (q === true && this.setContent != null) {
			this.setContent(o)
		}
	};
	this._prepareContent();
	this._doOnResize = function() {
		window.clearTimeout(c.conf.resizeTM);
		c.conf.resizeTM = window.setTimeout(function() {
			if (c.setSizes) {
				c.setSizes()
			}
		}, c.conf.resizeTMTime)
	};
	this._runCommand = function(q, s) {
		if (this.conf.roMode === true) {
			return
		}
		if (arguments.length < 2) {
			s = null
		}
		if (window.dhx4.isIE) {
			this.edWin.focus()
		}
		try {
			var o = this.editor.contentWindow.document;
			o.execCommand(q, false, s)
		} catch (r) {}
		if (window.dhx4.isIE) {
			this.edWin.focus();
			var n = this;
			window.setTimeout(function() {
				n.edWin.focus();
				n = null
			}, 1)
		}
	};
	this.applyBold = function() {
		this._runCommand("Bold")
	};
	this.applyItalic = function() {
		this._runCommand("Italic")
	};
	this.applyUnderscore = function() {
		this._runCommand("Underline")
	};
	this.clearFormatting = function() {
		this._runCommand("RemoveFormat");
		var n = this.getContent();
		n = n.replace(/<\/?h\d>/gi, "");
		this.setContent(n)
	};
	this._doOnClick = function(q) {
		var o = q || window.event;
		var n = o.target || o.srcElement;
		c._showInfo(n)
	};
	this._doOnMouseDown = function(q) {
		var o = q || window.event;
		var n = o.target || o.srcElement;
		c._showInfo(n)
	};
	this._doOnKeyUp = function(r) {
		var q = r || window.event;
		var n = q.keyCode;
		var o = q.target || q.srcElement;
		if ({
				37: 1,
				38: 1,
				39: 1,
				40: 1,
				13: 1
			}[n] == 1) {
			c._showInfo(o)
		}
	};
	this._getParentByTag = function(n, q) {
		q = q.toLowerCase();
		var o = n;
		do {
			if (q == "" || o.nodeName.toLowerCase() == q) {
				return o
			}
		} while (o = o.parentNode);
		return n
	};
	this._isStyleProperty = function(q, s, o, r) {
		s = s.toLowerCase();
		var u = q;
		do {
			if ((u.nodeName.toLowerCase() == s) && (u.style[o] == r)) {
				return true
			}
		} while (u = u.parentNode);
		return false
	};
	this._setStyleProperty = function(o, r) {
		this.style[r] = false;
		var q = this._getParentByTag(o, r);
		if (q && (q.tagName.toLowerCase() == r)) {
			this.style[r] = true
		}
		if (r == "del" && this._getParentByTag(o, "strike") && this._getParentByTag(o, "strike").tagName.toLowerCase() == "strike") {
			this.style.del = true
		}
	};
	this._showInfo = function(o) {
		var o = (this._getSelectionBounds().end) ? this._getSelectionBounds().end : o;
		if (!o || !this._setStyleProperty) {
			return
		}
		try {
			if (this.edWin.getComputedStyle) {
				var n = this.edWin.getComputedStyle(o, null);
				var q = ((n.getPropertyValue("font-weight") == 401) ? 700 : n.getPropertyValue("font-weight"));
				this.style = {
					fontStyle: n.getPropertyValue("font-style"),
					fontSize: n.getPropertyValue("font-size"),
					textDecoration: n.getPropertyValue("text-decoration"),
					fontWeight: q,
					fontFamily: n.getPropertyValue("font-family"),
					textAlign: n.getPropertyValue("text-align")
				};
				if (window.dhx4.isKHTML) {
					this.style.fontStyle = n.getPropertyValue("font-style");
					this.style.vAlign = n.getPropertyValue("vertical-align");
					this.style.del = this._isStyleProperty(o, "span", "textDecoration", "line-through");
					this.style.u = this._isStyleProperty(o, "span", "textDecoration", "underline")
				}
			} else {
				var n = o.currentStyle;
				this.style = {
					fontStyle: n.fontStyle,
					fontSize: n.fontSize,
					textDecoration: n.textDecoration,
					fontWeight: n.fontWeight,
					fontFamily: n.fontFamily,
					textAlign: n.textAlign
				}
			}
			this._setStyleProperty(o, "h1");
			this._setStyleProperty(o, "h2");
			this._setStyleProperty(o, "h3");
			this._setStyleProperty(o, "h4");
			if (!window.dhx4.isKHTML) {
				this._setStyleProperty(o, "del");
				this._setStyleProperty(o, "sub");
				this._setStyleProperty(o, "sup");
				this._setStyleProperty(o, "u")
			}
			this.callEvent("onFocusChanged", [this.style, n])
		} catch (r) {
			return null
		}
	};
	this._getSelectionBounds = function() {
		var s, q, v, o;
		if (this.edWin.getSelection) {
			var u = this.edWin.getSelection();
			s = u.getRangeAt(u.rangeCount - 1);
			v = s.startContainer;
			o = s.endContainer;
			q = s.commonAncestorContainer;
			if (v.nodeName == "#text") {
				q = q.parentNode
			}
			if (v.nodeName == "#text") {
				v = v.parentNode
			}
			if (v.nodeName.toLowerCase() == "body") {
				v = v.firstChild
			}
			if (o.nodeName == "#text") {
				o = o.parentNode
			}
			if (o.nodeName.toLowerCase() == "body") {
				o = o.lastChild
			}
			if (v == o) {
				q = v
			}
			return {
				root: q,
				start: v,
				end: o
			}
		} else {
			if (this.edWin.document.selection) {
				s = this.edDoc.selection.createRange();
				if (!s.duplicate) {
					return null
				}
				q = s.parentElement();
				var r = s.duplicate();
				var n = s.duplicate();
				r.collapse(true);
				n.moveToElementText(r.parentElement());
				n.setEndPoint("EndToStart", r);
				v = r.parentElement();
				r = s.duplicate();
				n = s.duplicate();
				n.collapse(false);
				r.moveToElementText(n.parentElement());
				r.setEndPoint("StartToEnd", n);
				o = n.parentElement();
				if (v.nodeName.toLowerCase() == "body") {
					v = v.firstChild
				}
				if (o.nodeName.toLowerCase() == "body") {
					o = o.lastChild
				}
				if (v == o) {
					q = v
				}
				return {
					root: q,
					start: v,
					end: o
				}
			}
		}
		return null
	};
	this.getContent = function() {
		if (!this.edDoc.body) {
			return ""
		} else {
			if (window.dhx4.isFF) {
				return this.editor.contentWindow.document.body.innerHTML.replace(/<\/{0,}br\/{0,}>\s{0,}$/gi, "")
			}
			if (window.dhx4.isIE && this.edDoc.body.innerText.length == 0) {
				return ""
			}
			return this.edDoc.body.innerHTML
		}
	};
	this.setContent = function(q) {
		q = q || "";
		if (this.edDoc.body) {
			var o = false;
			if (window.dhx4.isFF) {
				var n = navigator.userAgent.match(/Firefox\/(\d*)/);
				o = (n != null && n[1] < 28)
			}
			if (o) {
				if (typeof(this.conf.ffTest) == "undefined") {
					this.editor.contentWindow.document.body.innerHTML = "";
					this._runCommand("InsertHTML", "test");
					this.conf.ffTest = (this.editor.contentWindow.document.body.innerHTML.length > 0)
				}
				if (this.conf.ffTest) {
					this.editor.contentWindow.document.body.innerHTML = q
				} else {
					this.editor.contentWindow.document.body.innerHTML = "";
					if (q.length == 0) {
						q = " "
					}
					this._runCommand("InsertHTML", q)
				}
			} else {
				this.editor.contentWindow.document.body.innerHTML = q
			}
			this.callEvent("onContentSet", [])
		} else {
			if (!this.conf.firstLoadEv) {
				this.conf.firstLoadEv = true;
				this.conf.firstLoadData = q;
				this._onFirstLoad = function() {
					c.setContent(c.conf.firstLoadData);
					if (typeof(window.addEventListener) == "function") {
						c.edWin.removeEventListener("load", c._onFirstLoad, false)
					} else {
						c.edWin.detachEvent("onload", c._onFirstLoad)
					}
					c.conf.firstLoadData = null;
					c.conf.firstLoadEv = false;
					c._onFirstLoad = null
				};
				if (typeof(window.addEventListener) == "function") {
					this.edWin.addEventListener("load", this._onFirstLoad, false)
				} else {
					this.edWin.attachEvent("onload", this._onFirstLoad)
				}
			}
		}
	};
	this.setContentHTML = function(n) {
		window.dhx4.ajax.get(n, function(o) {
			if (o.xmlDoc.responseText != null) {
				c.setContent(o.xmlDoc.responseText)
			}
		})
	};
	window.dhx4._eventable(this);
	this.attachEvent("onFocusChanged", function(n) {
		if (typeof(this._doOnFocusChanged) == "function") {
			this._doOnFocusChanged(n)
		} else {
			if (typeof(this._doOnFocusChanged) == "string" && typeof(window[this._doOnFocusChanged]) == "function") {
				window[this._doOnFocusChanged](n)
			}
		}
	});
	if (typeof(window.addEventListener) == "function") {
		window.addEventListener("resize", this._doOnResize, false);
		this.edDoc.addEventListener("click", this._doOnClick, false);
		this.edDoc.addEventListener("keyup", this._doOnKeyUp, false);
		if (window.dhx4.isOpera) {
			this.edDoc.addEventListener("mousedown", this._doOnMouseDown, false)
		}
	} else {
		window.attachEvent("onresize", this._doOnResize);
		this.edDoc.attachEvent("onclick", this._doOnClick);
		this.edDoc.attachEvent("onkeyup", this._doOnKeyUp)
	}
	this.unload = function() {
		if (typeof(window.addEventListener) == "function") {
			window.removeEventListener("resize", this._doOnResize, false);
			this.edDoc.removeEventListener("click", this._doOnClick, false);
			this.edDoc.removeEventListener("keyup", this._doOnKeyUp, false);
			if (window.dhx4.isOpera) {
				this.edDoc.removeEventListener("mousedown", this._doOnMouseDown, false)
			}
			for (var n = 0; n < c.conf.evs.length; n++) {
				a.contentWindow.removeEventListener(c.conf.evs[n], c._ev, false)
			}
		} else {
			window.detachEvent("onresize", this._doOnResize, false);
			this.edDoc.detachEvent("onclick", this._doOnClick);
			this.edDoc.detachEvent("onkeyup", this._doOnKeyUp);
			for (var n = 0; n < c.conf.evs.length; n++) {
				a.contentWindow.document.body.detachEvent("on" + c.conf.evs[n], c._ev)
			}
		}
		this._doOnAccess = null;
		this._doOnFocusChanged = null;
		if (typeof(window.addEventListener) == "function") {
			this.editor.onload = null
		} else {
			this.editor.onreadystatechange = null
		}
		this.editor.parentNode.removeChild(this.editor);
		this.editor = null;
		this.edDoc = null;
		this.edWin = null;
		this.cell._unload();
		this.cell = null;
		this.tb = null;
		window.dhx4._eventable(this, "clear");
		this.cBlock.parentNode.removeChild(this.cBlock);
		this.cBlock = null;
		this.base.className = String(this.base.className).replace(new RegExp("\\s{0,}dhxeditor_" + this.conf.skin), "");
		while (this.base.childNodes.length > 0) {
			this.base.removeChild(this.base.childNodes[0])
		}
		this.base = null;
		this._doOnClick = null;
		this._doOnKeyUp = null;
		this._doOnMouseDown = null;
		this._ev = null;
		this._focus = null;
		this._prepareContent = null;
		this._doOnResize = null;
		this.setIconsPath = null;
		this.init = null;
		this.setSizes = null;
		this._runCommand = null;
		this.applyBold = null;
		this.applyItalic = null;
		this.applyUnderscore = null;
		this.clearFormatting = null;
		this._showInfo = null;
		this._getSelectionBounds = null;
		this.getContent = null;
		this.setContent = null;
		this.setContentHTML = null;
		this.setReadonly = null;
		this.isReadonly = null;
		this.unload = null;
		c = a = null
	};
	if (this.conf.toolbar == true && typeof(this.attachToolbar) == "function" && typeof(window.dhtmlXToolbarObject) == "function") {
		this.attachToolbar(this.conf.iconsPath)
	}
	this.setIconsPath = function(n) {
		this.conf.iconsPath = n
	};
	if (this.conf.content.length > 0) {
		this.setContent(this.conf.content);
		this.conf.content = ""
	} else {
		if (this.conf.contentHTML.length > 0) {
			this.setContentHTML(this.conf.contentHTML);
			this.conf.contentHTML = ""
		}
	}
	return this
}
dhtmlXEditor.prototype.setSizes = function() {
	this.cell._setSize(0, 0, this.base.clientWidth, this.base.clientHeight);
	if (this.editor != null) {
		this.editor.style.left = "5px";
		this.editor.style.width = this.base.clientWidth - 5 + "px"
	}
};
dhtmlXEditor.prototype.setReadonly = function(a) {
	this.conf.roMode = (a === true);
	this._prepareContent(true, this.conf.roMode);
	this.cBlock.style.display = (this.conf.roMode ? "" : "none")
};
dhtmlXEditor.prototype.isReadonly = function(a) {
	return (this.conf.roMode || false)
};
dhtmlXEditor.prototype.setSkin = function(a) {
	this.base.className = String(this.base.className).replace(new RegExp("dhxeditor_" + this.conf.skin), "dhxeditor_" + a);
	this.conf.skin = this.cell.conf.skin = a;
	if (this.tb) {
		this.cell.detachToolbar(a);
		this.tb = null;
		this.attachToolbar()
	}
	this.setSizes()
};
window.dhtmlXEditorCell = function(g, a) {
	dhtmlXCellObject.apply(this, [g, "_editor"]);
	var c = this;
	this.editor = a;
	this.conf.skin = this.editor.conf.skin;
	this.attachEvent("_onCellUnload", function() {
		this._stbUnload();
		this.editor = null;
		c = null
	});
	this._stbInit();
	return this
};
dhtmlXEditorCell.prototype = new dhtmlXCellObject();
dhtmlXEditorCell.prototype._stbInit = function() {
	var n = this;
	var m = document.createElement("DIV");
	m.className = "dhx_cell_stb";
	this.cell.insertBefore(m, this.cell.childNodes[this.conf.idx.cont]);
	m.onselectstart = function(a) {
		a = a || event;
		a.cancelBubble = true;
		if (a.preventDefault) {
			a.preventDefault()
		} else {
			a.returnValue = false
		}
		return false
	};
	var l = {
		bold: "applyBold",
		italic: "applyItalic",
		underline: "applyUnderscore",
		clearformat: "clearFormatting"
	};
	for (var g in l) {
		var c = document.createElement("A");
		c.href = "javascript:void(0);";
		c.tabIndex = -1;
		m.appendChild(c);
		c.onmousedown = c.onclick = function(a) {
			a = a || event;
			if (a.preventDefault) {
				a.preventDefault()
			} else {
				a.returnValue = false
			}
			return false
		};
		var o = document.createElement("DIV");
		o.className = "dhx_cell_stb_button btn_" + g;
		o._actv = g.charAt(0);
		o._cmd = l[g];
		c.appendChild(o);
		o.onclick = function(a) {
			a = a || event;
			if (a.preventDefault) {
				a.preventDefault()
			} else {
				a.returnValue = false
			}
			return false
		};
		o.onmousedown = function(a) {
			a = a || event;
			if (a.preventDefault) {
				a.preventDefault()
			} else {
				a.returnValue = false
			}
			n.editor[this._cmd]();
			n.editor.callEvent("onToolbarClick", [this._actv])
		};
		o = c = null
	}
	m = null;
	this._stbUnload = function() {
		var a = this.cell.childNodes[this.conf.idx.stb];
		a.onselectstart = null;
		while (a.childNodes.length > 0) {
			a.lastChild.onmousedown = a.lastChild.onclick = null;
			a.lastChild.firstChild.onmousedown = a.lastChild.firstChild.onclick = null;
			a.lastChild.firstChild._actv = a.lastChild.firstChild._cmd = null;
			a.lastChild.removeChild(a.lastChild.firstChild);
			a.removeChild(a.lastChild)
		}
		a.parentNode.removeChild(a);
		a = n = null;
		this.conf.idx_data.stb = this.conf.ofs_nodes.t._getStbHeight = null;
		delete this.conf.ofs_nodes.t._getStbHeight;
		delete this.conf.idx_data.stb;
		this._updateIdx()
	};
	this.conf.ofs_nodes.t._getStbHeight = "func";
	this.conf.idx_data.stb = "dhx_cell_stb";
	this._updateIdx()
};
dhtmlXEditorCell.prototype._stbHide = function() {
	this.cell.childNodes[this.conf.idx.stb].style.display = "none"
};
dhtmlXEditorCell.prototype._getStbHeight = function() {
	return this.cell.childNodes[this.conf.idx.stb].offsetHeight
};
dhtmlXCellObject.prototype.attachEditor = function(a) {
	this.callEvent("_onBeforeContentAttach", ["editor"]);
	var g = document.createElement("DIV");
	g.style.width = "100%";
	g.style.height = "100%";
	g.style.position = "relative";
	g.style.overflow = "hidden";
	this._attachObject(g);
	if (!(typeof(a) == "object" && a != null)) {
		a = {}
	}
	a.parent = g;
	this.dataType = "editor";
	this.dataObj = new dhtmlXEditor(a);
	g = null;
	a.parent = null;
	a = null;
	if (typeof(window.dhtmlXPortalCell) != "undefined" && this instanceof window.dhtmlXPortalCell) {
		if (this.portal.conf.editor_ev == null) {
			var l = this.portal.attachEvent("onBeforeDrag", function(m) {
				if (this.cdata[m].dataType == "editor") {
					this.cdata[m].conf.editor_cont = this.cdata[m].dataObj.getContent()
				}
				return true
			});
			var c = this.portal.attachEvent("onDrop", function(m) {
				if (this.cdata[m].dataType == "editor") {
					this.cdata[m].dataObj.setContent(this.cdata[m].conf.editor_cont);
					this.cdata[m].dataObj._prepareContent(true);
					this.cdata[m].conf.editor_cont = null
				}
			});
			this.portal.conf.editor_ev = [l, c]
		}
		this.conf.editor_ev = this.attachEvent("_onBeforeContentDetach", function() {
			this.detachEvent(this.conf.editor_ev);
			this.conf.editor_ev = null;
			if (this instanceof window.dhtmlXPortalCell) {
				var n = false;
				for (var m in this.portal.cdata) {
					if (this.portal.cdata[m] != this && this.portal.cdata[m].dataType == "editor") {
						n = true
					}
				}
				if (n == false) {
					for (var o = 0; o < this.portal.conf.editor_ev.length; o++) {
						this.portal.detachEvent(this.portal.conf.editor_ev[o])
					}
					this.portal.conf.editor_ev = null
				}
			}
		})
	}
	this.callEvent("_onContentAttach", []);
	return this.dataObj
};
dhtmlXEditor.prototype.attachToolbar = function(c) {
	if (this.tb != null) {
		return
	}
	if (c != null) {
		this.conf.iconsPath = c
	}
	this.cell._stbHide();
	this.tb = this.cell.attachToolbar({
		icons_path: this.conf.iconsPath + "/dhxeditor_" + String(this.conf.skin).replace(/^dhx_/, "") + "/",
		skin: this.conf.skin
	});
	this.setSizes();
	this._availFonts = new Array("Arial", "Arial Narrow", "Comic Sans MS", "Courier", "Georgia", "Impact", "Tahoma", "Times New Roman", "Verdana");
	this._initFont = this._availFonts[0];
	this._xmlFonts = "";
	for (var n = 0; n < this._availFonts.length; n++) {
		var l = String(this._availFonts[n]).replace(/\s/g, "_");
		this._xmlFonts += '<item type="button" id="applyFontFamily:' + l + '"><itemText><![CDATA[<img src="' + this.tb.imagePath + "font_" + String(l).toLowerCase() + '.gif" border="0" style="/*margin-top:1px;margin-bottom:1px;*/width:110px;height:16px;">]]></itemText></item>'
	}
	this._availSizes = {
		"1": "8pt",
		"2": "10pt",
		"3": "12pt",
		"4": "14pt",
		"5": "18pt",
		"6": "24pt",
		"7": "36pt"
	};
	this._xmlSizes = "";
	for (var g in this._availSizes) {
		this._xmlSizes += '<item type="button" id="applyFontSize:' + g + ":" + this._availSizes[g] + '" text="' + this._availSizes[g] + '"/>'
	}
	this.tbXML = '<toolbar><item id="applyH1" type="buttonTwoState" img="h1.gif" imgdis="h4_dis.gif" title="H1"/><item id="applyH2" type="buttonTwoState" img="h2.gif" imgdis="h4_dis.gif" title="H2"/><item id="applyH3" type="buttonTwoState" img="h3.gif" imgdis="h4_dis.gif" title="H3"/><item id="applyH4" type="buttonTwoState" img="h4.gif" imgdis="h4_dis.gif" title="H4"/><item id="separ01" type="separator"/><item id="applyBold" type="buttonTwoState" img="bold.gif" imgdis="bold_dis.gif" title="Bold Text"/><item id="applyItalic" type="buttonTwoState" img="italic.gif" imgdis="italic_dis.gif" title="Italic Text"/><item id="applyUnderscore" type="buttonTwoState" img="underline.gif" imgdis="underline_dis.gif" title="Underscore Text"/><item id="applyStrikethrough" type="buttonTwoState" img="strike.gif" imgdis="strike_dis.gif" title="Strikethrough Text"/><item id="separ02" type="separator"/><item id="alignLeft" type="buttonTwoState" img="align_left.gif" imgdis="align_left_dis.gif" title="Left Alignment"/><item id="alignCenter" type="buttonTwoState" img="align_center.gif" imgdis="align_center_dis.gif" title="Center Alignment"/><item id="alignRight" type="buttonTwoState" img="align_right.gif" imgdis="align_right_dis.gif" title="Right Alignment"/><item id="alignJustify" type="buttonTwoState" img="align_justify.gif" title="Justified Alignment"/><item id="separ03" type="separator"/><item id="applySub" type="buttonTwoState" img="script_sub.gif" imgdis="script_sub.gif" title="Subscript"/><item id="applySuper" type="buttonTwoState" img="script_super.gif" imgdis="script_super_dis.gif" title="Superscript"/><item id="separ04" type="separator"/><item id="createNumList" type="button" img="list_number.gif" imgdis="list_number_dis.gif" title="Number List"/><item id="createBulList" type="button" img="list_bullet.gif" imgdis="list_bullet_dis.gif" title="Bullet List"/><item id="separ05" type="separator"/><item id="increaseIndent" type="button" img="indent_inc.gif" imgdis="indent_inc_dis.gif" title="Increase Indent"/><item id="decreaseIndent" type="button" img="indent_dec.gif" imgdis="indent_dec_dis.gif" title="Decrease Indent"/><item id="separ06" type="separator"/><item id="clearFormatting" type="button" img="clear.gif" title="Clear Formatting"/></toolbar>';
	this.tb.loadStruct(this.tbXML);
	this._checkAlign = function(a) {
		this.tb.setItemState("alignCenter", false);
		this.tb.setItemState("alignRight", false);
		this.tb.setItemState("alignJustify", false);
		this.tb.setItemState("alignLeft", false);
		if (a) {
			this.tb.setItemState(a, true)
		}
	};
	this._checkH = function(a) {
		this.tb.setItemState("applyH1", false);
		this.tb.setItemState("applyH2", false);
		this.tb.setItemState("applyH3", false);
		this.tb.setItemState("applyH4", false);
		if (a) {
			this.tb.setItemState(a, true)
		}
	};
	this._doOnFocusChanged = function(q) {
		if (!q.h1 && !q.h2 && !q.h3 && !q.h4) {
			var a = (String(q.fontWeight).search(/bold/i) != -1) || (Number(q.fontWeight) >= 700);
			this.tb.setItemState("applyBold", a)
		} else {
			this.tb.setItemState("applyBold", false)
		}
		var o = "alignLeft";
		if (String(q.textAlign).search(/center/) != -1) {
			o = "alignCenter"
		}
		if (String(q.textAlign).search(/right/) != -1) {
			o = "alignRight"
		}
		if (String(q.textAlign).search(/justify/) != -1) {
			o = "alignJustify"
		}
		this.tb.setItemState(o, true);
		this._checkAlign(o);
		this.tb.setItemState("applyH1", q.h1);
		this.tb.setItemState("applyH2", q.h2);
		this.tb.setItemState("applyH3", q.h3);
		this.tb.setItemState("applyH4", q.h4);
		if (window._KHTMLrv) {
			q.sub = (q.vAlign == "sub");
			q.sup = (q.vAlign == "super")
		}
		this.tb.setItemState("applyItalic", (q.fontStyle == "italic"));
		this.tb.setItemState("applyStrikethrough", q.del);
		this.tb.setItemState("applySub", q.sub);
		this.tb.setItemState("applySuper", q.sup);
		this.tb.setItemState("applyUnderscore", q.u)
	};
	this._doOnToolbarClick = function(o) {
		var a = String(o).split(":");
		if (this[a[0]] != null) {
			if (typeof(this[a[0]]) == "function") {
				this[a[0]](a[1]);
				this.callEvent("onToolbarClick", [o])
			}
		}
	};
	this._doOnStateChange = function(o, a) {
		this[o]();
		switch (o) {
			case "alignLeft":
			case "alignCenter":
			case "alignRight":
			case "alignJustify":
				this._checkAlign(o);
				break;
			case "applyH1":
			case "applyH2":
			case "applyH3":
			case "applyH4":
				this._checkH(o);
				break
		}
		this.callEvent("onToolbarClick", [o])
	};
	this._doOnBeforeStateChange = function(o, a) {
		if ((o == "alignLeft" || o == "alignCenter" || o == "alignRight" || o == "alignJustify") && a == true) {
			return false
		}
		return true
	};
	var m = this;
	this.tb.attachEvent("onClick", function(a) {
		m._doOnToolbarClick(a)
	});
	this.tb.attachEvent("onStateChange", function(o, a) {
		m._doOnStateChange(o, a)
	});
	this.tb.attachEvent("onBeforeStateChange", function(o, a) {
		return m._doOnBeforeStateChange(o, a)
	});
	this.applyBold = function() {
		this._runCommand("Bold")
	};
	this.applyItalic = function() {
		this._runCommand("Italic")
	};
	this.applyUnderscore = function() {
		this._runCommand("Underline")
	};
	this.applyStrikethrough = function() {
		this._runCommand("StrikeThrough")
	};
	this.alignLeft = function() {
		this._runCommand("JustifyLeft")
	};
	this.alignRight = function() {
		this._runCommand("JustifyRight")
	};
	this.alignCenter = function() {
		this._runCommand("JustifyCenter")
	};
	this.alignJustify = function() {
		this._runCommand("JustifyFull")
	};
	this.applySub = function() {
		this._runCommand("Subscript")
	};
	this.applySuper = function() {
		this._runCommand("Superscript")
	};
	this.applyH1 = function() {
		this._runCommand("FormatBlock", "<H1>")
	};
	this.applyH2 = function() {
		this._runCommand("FormatBlock", "<H2>")
	};
	this.applyH3 = function() {
		this._runCommand("FormatBlock", "<H3>")
	};
	this.applyH4 = function() {
		this._runCommand("FormatBlock", "<H4>")
	};
	this.createNumList = function() {
		this._runCommand("InsertOrderedList")
	};
	this.createBulList = function() {
		this._runCommand("InsertUnorderedList")
	};
	this.increaseIndent = function() {
		this._runCommand("Indent")
	};
	this.decreaseIndent = function() {
		this._runCommand("Outdent")
	};
	this.clearFormatting = function() {
		this._runCommand("RemoveFormat");
		this.tb.setItemState("applyBold", false);
		this.tb.setItemState("applyItalic", false);
		this.tb.setItemState("applyStrikethrough", false);
		this.tb.setItemState("applySub", false);
		this.tb.setItemState("applySuper", false);
		this.tb.setItemState("applyUnderscore", false);
		var a = this.getContent();
		a = a.replace(/<\/?h\d>/gi, "");
		this.setContent(a)
	}
};
dhtmlx.Group = {
	_init: function() {
		dhtmlx.assert(this.data, "DataStore required for grouping");
		this.data.attachEvent("onStoreLoad", dhtmlx.bind(function() {
			if (this._settings.group) {
				this.group(this._settings.group, false)
			}
		}, this));
		this.attachEvent("onBeforeRender", dhtmlx.bind(function(a) {
			if (this._settings.sort) {
				a.block();
				a.sort(this._settings.sort);
				a.unblock()
			}
		}, this));
		this.data.attachEvent("onClearAll", dhtmlx.bind(function() {
			this.data._not_grouped_order = this.data._not_grouped_pull = null
		}, this));
		this.attachEvent("onBeforeSort", dhtmlx.bind(function() {
			this._settings.sort = null
		}, this))
	},
	_init_group_data_event: function(c, a) {
		c.attachEvent("onClearAll", dhtmlx.bind(function() {
			this.ungroup(false);
			this.block();
			this.clearAll();
			this.unblock()
		}, a))
	},
	sum: function(c, a) {
		c = dhtmlx.Template.setter(c);
		a = a || this.data;
		var g = 0;
		a.each(function(l) {
			g += c(l) * 1
		});
		return g
	},
	min: function(g, c) {
		g = dhtmlx.Template.setter(g);
		c = c || this.data;
		var a = Infinity;
		c.each(function(l) {
			if (g(l) * 1 < a) {
				a = g(l) * 1
			}
		});
		return a * 1
	},
	max: function(g, c) {
		g = dhtmlx.Template.setter(g);
		c = c || this.data;
		var a = -Infinity;
		c.each(function(l) {
			if (g(l) * 1 > a) {
				a = g(l) * 1
			}
		});
		return a
	},
	_split_data_by: function(n) {
		var q = function(u, s) {
			u = dhtmlx.Template.setter(u);
			return u(s[0])
		};
		var r = dhtmlx.Template.setter(n.by);
		if (!n.map[r]) {
			n.map[r] = [r, q]
		}
		var g = {};
		var o = [];
		this.data.each(function(s) {
			var u = r(s);
			if (!g[u]) {
				o.push({
					id: u
				});
				g[u] = dhtmlx.toArray()
			}
			g[u].push(s)
		});
		for (var a in n.map) {
			var m = (n.map[a][1] || q);
			if (typeof m != "function") {
				m = this[m]
			}
			for (var l = 0; l < o.length; l++) {
				o[l][a] = m.call(this, n.map[a][0], g[o[l].id])
			}
		}
		this.data._not_grouped_order = this.data.order;
		this.data._not_grouped_pull = this.data.pull;
		this.data.order = dhtmlx.toArray();
		this.data.pull = {};
		for (var l = 0; l < o.length; l++) {
			var c = this.data.id(o[l]);
			this.data.pull[c] = o[l];
			this.data.order.push(c)
		}
		this.callEvent("onStoreUpdated", [])
	},
	group: function(a, c) {
		this.ungroup(false);
		this._split_data_by(a);
		if (c !== false) {
			this.data.callEvent("onStoreUpdated", [])
		}
	},
	ungroup: function(a) {
		if (this.data._not_grouped_order) {
			this.data.order = this.data._not_grouped_order;
			this.data.pull = this.data._not_grouped_pull;
			this.data._not_grouped_pull = this.data._not_grouped_order = null
		}
		if (a !== false) {
			this.data.callEvent("onStoreUpdated", [])
		}
	},
	group_setter: function(a) {
		dhtmlx.assert(typeof a == "object", "Incorrect group value");
		dhtmlx.assert(a.by, "group.by is mandatory");
		dhtmlx.assert(a.map, "group.map is mandatory");
		return a
	},
	sort_setter: function(a) {
		if (typeof a != "object") {
			a = {
				by: a
			}
		}
		this._mergeSettings(a, {
			as: "string",
			dir: "asc"
		});
		return a
	}
};
dhtmlx.Date = {
	Locale: {
		month_full: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
		month_short: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
		day_full: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
		day_short: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]
	},
	date_part: function(a) {
		a.setHours(0);
		a.setMinutes(0);
		a.setSeconds(0);
		a.setMilliseconds(0);
		return a
	},
	time_part: function(a) {
		return (a.valueOf() / 1000 - a.getTimezoneOffset() * 60) % 86400
	},
	week_start: function(c) {
		var a = c.getDay();
		if (this.config.start_on_monday) {
			if (a === 0) {
				a = 6
			} else {
				a--
			}
		}
		return this.date_part(this.add(c, -1 * a, "day"))
	},
	month_start: function(a) {
		a.setDate(1);
		return this.date_part(a)
	},
	year_start: function(a) {
		a.setMonth(0);
		return this.month_start(a)
	},
	day_start: function(a) {
		return this.date_part(a)
	},
	add: function(c, g, l) {
		var a = new Date(c.valueOf());
		switch (l) {
			case "day":
				a.setDate(a.getDate() + g);
				break;
			case "week":
				a.setDate(a.getDate() + 7 * g);
				break;
			case "month":
				a.setMonth(a.getMonth() + g);
				break;
			case "year":
				a.setYear(a.getFullYear() + g);
				break;
			case "hour":
				a.setHours(a.getHours() + g);
				break;
			case "minute":
				a.setMinutes(a.getMinutes() + g);
				break;
			default:
				return dhtmlx.Date["add_" + l](c, g, l)
		}
		return a
	},
	to_fixed: function(a) {
		if (a < 10) {
			return "0" + a
		}
		return a
	},
	copy: function(a) {
		return new Date(a.valueOf())
	},
	date_to_str: function(c, a) {
		c = c.replace(/%[a-zA-Z]/g, function(g) {
			switch (g) {
				case "%d":
					return '"+dhtmlx.Date.to_fixed(date.getDate())+"';
				case "%m":
					return '"+dhtmlx.Date.to_fixed((date.getMonth()+1))+"';
				case "%j":
					return '"+date.getDate()+"';
				case "%n":
					return '"+(date.getMonth()+1)+"';
				case "%y":
					return '"+dhtmlx.Date.to_fixed(date.getFullYear()%100)+"';
				case "%Y":
					return '"+date.getFullYear()+"';
				case "%D":
					return '"+dhtmlx.Date.Locale.day_short[date.getDay()]+"';
				case "%l":
					return '"+dhtmlx.Date.Locale.day_full[date.getDay()]+"';
				case "%M":
					return '"+dhtmlx.Date.Locale.month_short[date.getMonth()]+"';
				case "%F":
					return '"+dhtmlx.Date.Locale.month_full[date.getMonth()]+"';
				case "%h":
					return '"+dhtmlx.Date.to_fixed((date.getHours()+11)%12+1)+"';
				case "%g":
					return '"+((date.getHours()+11)%12+1)+"';
				case "%G":
					return '"+date.getHours()+"';
				case "%H":
					return '"+dhtmlx.Date.to_fixed(date.getHours())+"';
				case "%i":
					return '"+dhtmlx.Date.to_fixed(date.getMinutes())+"';
				case "%a":
					return '"+(date.getHours()>11?"pm":"am")+"';
				case "%A":
					return '"+(date.getHours()>11?"PM":"AM")+"';
				case "%s":
					return '"+dhtmlx.Date.to_fixed(date.getSeconds())+"';
				case "%W":
					return '"+dhtmlx.Date.to_fixed(dhtmlx.Date.getISOWeek(date))+"';
				default:
					return g
			}
		});
		if (a) {
			c = c.replace(/date\.get/g, "date.getUTC")
		}
		return new Function("date", 'return "' + c + '";')
	},
	str_to_date: function(m, g) {
		var n = "var temp=date.split(/[^0-9a-zA-Z]+/g);";
		var a = m.match(/%[a-zA-Z]/g);
		for (var c = 0; c < a.length; c++) {
			switch (a[c]) {
				case "%j":
				case "%d":
					n += "set[2]=temp[" + c + "]||1;";
					break;
				case "%n":
				case "%m":
					n += "set[1]=(temp[" + c + "]||1)-1;";
					break;
				case "%y":
					n += "set[0]=temp[" + c + "]*1+(temp[" + c + "]>50?1900:2000);";
					break;
				case "%g":
				case "%G":
				case "%h":
				case "%H":
					n += "set[3]=temp[" + c + "]||0;";
					break;
				case "%i":
					n += "set[4]=temp[" + c + "]||0;";
					break;
				case "%Y":
					n += "set[0]=temp[" + c + "]||0;";
					break;
				case "%a":
				case "%A":
					n += "set[3]=set[3]%12+((temp[" + c + "]||'').toLowerCase()=='am'?0:12);";
					break;
				case "%s":
					n += "set[5]=temp[" + c + "]||0;";
					break
			}
		}
		var l = "set[0],set[1],set[2],set[3],set[4],set[5]";
		if (g) {
			l = " Date.UTC(" + l + ")"
		}
		return new Function("date", "var set=[0,0,1,0,0,0]; " + n + " return new Date(" + l + ");")
	},
	getISOWeek: function(g) {
		if (!g) {
			return false
		}
		var c = g.getDay();
		if (c === 0) {
			c = 7
		}
		var l = new Date(g.valueOf());
		l.setDate(g.getDate() + (4 - c));
		var a = l.getFullYear();
		var n = Math.floor((l.getTime() - new Date(a, 0, 1).getTime()) / 86400000);
		var m = 1 + Math.floor(n / 7);
		return m
	},
	getUTCISOWeek: function(a) {
		return this.getISOWeek(a)
	}
};
dhtmlx.math = {};
dhtmlx.math._toHex = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "A", "B", "C", "D", "E", "F"];
dhtmlx.math.toHex = function(c, a) {
	c = parseInt(c, 10);
	str = "";
	while (c > 0) {
		str = this._toHex[c % 16] + str;
		c = Math.floor(c / 16)
	}
	while (str.length < a) {
		str = "0" + str
	}
	return str
};
dhtmlx.math.hexToDec = function(a) {
	return parseInt(a, 16)
};
dhtmlx.math.toRgb = function(c) {
	var m, l, a, n;
	if (typeof(c) != "string") {
		m = c[0];
		l = c[1];
		a = c[2]
	} else {
		if (c.indexOf("rgb") != -1) {
			n = c.substr(c.indexOf("(") + 1, c.lastIndexOf(")") - c.indexOf("(") - 1).split(",");
			m = n[0];
			l = n[1];
			a = n[2]
		} else {
			if (c.substr(0, 1) == "#") {
				c = c.substr(1)
			}
			m = this.hexToDec(c.substr(0, 2));
			l = this.hexToDec(c.substr(2, 2));
			a = this.hexToDec(c.substr(4, 2))
		}
	}
	m = (parseInt(m, 10) || 0);
	l = (parseInt(l, 10) || 0);
	a = (parseInt(a, 10) || 0);
	if (m < 0 || m > 255) {
		m = 0
	}
	if (l < 0 || l > 255) {
		l = 0
	}
	if (a < 0 || a > 255) {
		a = 0
	}
	return [m, l, a]
};
dhtmlx.math.hsvToRgb = function(n, A, x) {
	var m, u, l, c, y, a, o, w;
	m = Math.floor((n / 60)) % 6;
	u = n / 60 - m;
	l = x * (1 - A);
	c = x * (1 - u * A);
	y = x * (1 - (1 - u) * A);
	a = 0;
	o = 0;
	w = 0;
	switch (m) {
		case 0:
			a = x;
			o = y;
			w = l;
			break;
		case 1:
			a = c;
			o = x;
			w = l;
			break;
		case 2:
			a = l;
			o = x;
			w = y;
			break;
		case 3:
			a = l;
			o = c;
			w = x;
			break;
		case 4:
			a = y;
			o = l;
			w = x;
			break;
		case 5:
			a = x;
			o = l;
			w = c;
			break
	}
	a = Math.floor(a * 255);
	o = Math.floor(o * 255);
	w = Math.floor(w * 255);
	return [a, o, w]
};
dhtmlx.math.rgbToHsv = function(c, o, q) {
	var m, l, u, a, w, y, n, x;
	m = c / 255;
	l = o / 255;
	u = q / 255;
	var a = Math.min(m, l, u);
	var w = Math.max(m, l, u);
	n = 0;
	y = w == 0 ? 0 : (1 - a / w);
	x = w;
	if (w == a) {
		n = 0
	} else {
		if (w == m && l >= u) {
			n = 60 * (l - u) / (w - a) + 0
		} else {
			if (w == m && l < u) {
				n = 60 * (l - u) / (w - a) + 360
			} else {
				if (w == l) {
					n = 60 * (u - m) / (w - a) + 120
				} else {
					if (w == u) {
						n = 60 * (m - l) / (w - a) + 240
					}
				}
			}
		}
	}
	return [n, y, x]
};
if (!dhtmlx.presets) {
	dhtmlx.presets = {}
}
dhtmlx.presets.chart = {
	simple: {
		item: {
			borderColor: "#ffffff",
			color: "#2b7100",
			shadow: false,
			borderWidth: 2
		},
		line: {
			color: "#8ecf03",
			width: 2
		}
	},
	plot: {
		color: "#1293f8",
		item: {
			borderColor: "#636363",
			borderWidth: 1,
			color: "#ffffff",
			type: "r",
			shadow: false
		},
		line: {
			color: "#1293f8",
			width: 2
		}
	},
	diamond: {
		color: "#b64040",
		item: {
			borderColor: "#b64040",
			color: "#b64040",
			type: "d",
			radius: 3,
			shadow: true
		},
		line: {
			color: "#ff9000",
			width: 2
		}
	},
	point: {
		color: "#fe5916",
		disableLines: true,
		fill: false,
		disableItems: false,
		item: {
			color: "#feb916",
			borderColor: "#fe5916",
			radius: 2,
			borderWidth: 1,
			type: "r"
		},
		alpha: 1
	},
	line: {
		line: {
			color: "#3399ff",
			width: 2
		},
		item: {
			color: "#ffffff",
			borderColor: "#3399ff",
			radius: 2,
			borderWidth: 2,
			type: "d"
		},
		fill: false,
		disableItems: false,
		disableLines: false,
		alpha: 1
	},
	area: {
		fill: "#3399ff",
		line: {
			color: "#3399ff",
			width: 1
		},
		disableItems: true,
		alpha: 0.2,
		disableLines: false
	},
	round: {
		item: {
			radius: 3,
			borderColor: "#3f83ff",
			borderWidth: 1,
			color: "#3f83ff",
			type: "r",
			shadow: false,
			alpha: 0.6
		}
	},
	square: {
		item: {
			radius: 3,
			borderColor: "#447900",
			borderWidth: 2,
			color: "#69ba00",
			type: "s",
			shadow: false,
			alpha: 1
		}
	},
	column: {
		color: "RAINBOW",
		gradient: false,
		width: 45,
		radius: 0,
		alpha: 1,
		border: true
	},
	stick: {
		width: 5,
		gradient: false,
		color: "#67b5c9",
		radius: 2,
		alpha: 1,
		border: false
	},
	alpha: {
		color: "#b9a8f9",
		width: 70,
		gradient: "falling",
		radius: 0,
		alpha: 0.5,
		border: true
	}
};
dhtmlx.ui.Map = function(a) {
	this.name = "Map";
	this._id = "map_" + dhtmlx.uid();
	this._key = a;
	this._map = []
};
dhtmlx.ui.Map.prototype = {
	addRect: function(g, c, a) {
		this._createMapArea(g, "RECT", c, a)
	},
	addPoly: function(g, c, a) {
		this._createMapArea(g, "POLY", c, a)
	},
	_createMapArea: function(m, c, l, g) {
		var a = "";
		if (arguments.length == 4) {
			a = "userdata='" + g + "'"
		}
		this._map.push("<area " + this._key + "='" + m + "' shape='" + c + "' coords='" + l.join() + "' " + a + "></area>")
	},
	addSector: function(a, s, r, o, m, g, l, n) {
		var q = [];
		q.push(o);
		q.push(Math.floor(m * l));
		for (var c = s; c < r; c += Math.PI / 18) {
			q.push(Math.floor(o + g * Math.cos(c)));
			q.push(Math.floor((m + g * Math.sin(c)) * l))
		}
		q.push(Math.floor(o + g * Math.cos(r)));
		q.push(Math.floor((m + g * Math.sin(r)) * l));
		q.push(o);
		q.push(Math.floor(m * l));
		return this.addPoly(a, q, n)
	},
	render: function(a) {
		var g = dhtmlx.html.create("DIV");
		g.style.cssText = "position:absolute; width:100%; height:100%; top:0px; left:0px;";
		a.appendChild(g);
		var c = dhtmlx._isIE ? "" : "src='data:image/gif;base64,R0lGODlhEgASAIAAAP///////yH5BAUUAAEALAAAAAASABIAAAIPjI+py+0Po5y02ouz3pwXADs='";
		g.innerHTML = "<map id='" + this._id + "' name='" + this._id + "'>" + this._map.join("\n") + "</map><img " + c + " class='dhx_map_img' usemap='#" + this._id + "' onmousedown='return false;'>";
		a._htmlmap = g;
		this._map = []
	}
};
dhtmlx.chart = {};
dhtmlx.chart.scatter = {
	pvt_render_scatter: function(s, n, r, q, o, a) {
		if (!this._settings.xValue) {
			return dhtmlx.log("warning", "Undefined propery: xValue")
		}
		var g = this._getLimits();
		var m = this._getLimits("h", "xValue");
		if (!o) {
			if (!this.canvases.x) {
				this.canvases.x = new dhtmlx.ui.Canvas(this._obj, "axis_x")
			}
			if (!this.canvases.y) {
				this.canvases.y = new dhtmlx.ui.Canvas(this._obj, "axis_y")
			}
			this._drawYAxis(this.canvases.y.getCanvas(), n, r, q, g.min, g.max);
			this._drawHXAxis(this.canvases.x.getCanvas(), n, r, q, m.min, m.max)
		}
		g = {
			min: this._settings.yAxis.start,
			max: this._settings.yAxis.end
		};
		m = {
			min: this._settings.xAxis.start,
			max: this._settings.xAxis.end
		};
		var c = this._getScatterParams(s, n, r, q, m, g);
		this._mapStart = r;
		for (var l = 0; l < n.length; l++) {
			this._drawScatterItem(s, a, r, q, c, m, g, n[l], o)
		}
	},
	_getScatterParams: function(a, l, g, c, o, n) {
		var m = {};
		m.totalHeight = c.y - g.y;
		m.totalWidth = c.x - g.x;
		this._calcScatterUnit(m, o.min, o.max, m.totalWidth, "X");
		this._calcScatterUnit(m, n.min, n.max, m.totalHeight, "Y");
		return m
	},
	_drawScatterItem: function(u, a, r, q, g, m, l, n, o) {
		var c = this._calculateScatterItemPosition(g, q, r, m, n, "X");
		var s = this._calculateScatterItemPosition(g, r, q, l, n, "Y");
		this._drawItem(u, c, s, n, this._settings.label.call(this, n), o, a)
	},
	_calculateScatterItemPosition: function(g, q, o, a, m, c) {
		var s = this._settings[c == "X" ? "xValue" : "value"].call(this, m);
		var l = g["valueFactor" + c];
		var u = (parseFloat(s || 0) - a.min) * l;
		var r = g["unit" + c];
		var n = o[c.toLowerCase()] - (c == "X" ? (-1) : 1) * Math.floor(r * u);
		if (u < 0) {
			n = o[c.toLowerCase()]
		}
		if (s > a.max) {
			n = q[c.toLowerCase()]
		}
		if (s < a.min) {
			n = o[c.toLowerCase()]
		}
		return n
	},
	_calcScatterUnit: function(n, g, a, c, l) {
		var m = this._getRelativeValue(g, a);
		l = (l || "");
		n["relValue" + l] = m[0];
		n["valueFactor" + l] = m[1];
		n["unit" + l] = (n["relValue" + l] ? c / n["relValue" + l] : 10)
	}
};
dhtmlx.chart.radar = {
	pvt_render_radar: function(c, l, a, n, g, m) {
		this._renderRadarChart(c, l, a, n, g, m)
	},
	_renderRadarChart: function(w, m, u, s, r, a) {
		if (!m.length) {
			return
		}
		var o = this._getPieParameters(u, s);
		var q = (this._settings.radius ? this._settings.radius : o.radius);
		var c = (this._settings.x ? this._settings.x : o.x);
		var v = (this._settings.y ? this._settings.y : o.y);
		var g = [];
		for (var l = 0; l < m.length; l++) {
			g.push(1)
		}
		var n = this._getRatios(g, m.length);
		this._mapStart = u;
		if (!r) {
			this._drawRadarAxises(n, c, v, q, m)
		}
		this._drawRadarData(w, n, c, v, q, m, r, a)
	},
	_drawRadarData: function(E, v, q, o, m, P, F, O) {
		var D, A, N, L, H, K, l, g, I, M, J, w, c, C, s, r, a, u, n;
		N = this._settings;
		H = N.yAxis.start;
		K = N.yAxis.end;
		n = this._getRelativeValue(H, K);
		w = n[0];
		u = (w ? m / w : m / 2);
		a = n[1];
		c = -Math.PI / 2;
		D = A = c;
		I = [];
		g = 0;
		for (L = 0; L < P.length; L++) {
			if (!r) {
				C = N.value(P[L]);
				s = (parseFloat(C || 0) - H) * a
			} else {
				s = r
			}
			M = Math.floor(u * s);
			C = N.value((L != (P.length - 1)) ? P[L + 1] : P[0]);
			r = (parseFloat(C || 0) - H) * a;
			J = Math.floor(u * r);
			D = A;
			A = ((L != (P.length - 1)) ? (c + v[L] - 0.0001) : c);
			l = (g || this._getPositionByAngle(D, q, o, M));
			g = this._getPositionByAngle(A, q, o, J);
			I.push(l)
		}
		if (N.fill) {
			this._fillRadarChart(E, I, P)
		}
		if (!N.disableLines) {
			this._strokeRadarChart(E, I, P)
		}
		if (!N.disableItems) {
			this._drawRadarItemMarkers(E, I, P, F, O)
		}
		I = null
	},
	_drawRadarItemMarkers: function(a, g, m, l, n) {
		for (var c = 0; c < g.length; c++) {
			this._drawItem(a, g[c].x, g[c].y, m[c], this._settings.label.call(this, m), l, n)
		}
	},
	_fillRadarChart: function(a, l, n) {
		var m, g;
		a.globalAlpha = this._settings.alpha.call(this, {});
		a.beginPath();
		for (var c = 0; c < l.length; c++) {
			a.fillStyle = this._settings.fill.call(this, n[c]);
			m = l[c];
			g = (l[c + 1] || l[0]);
			if (!c) {
				a.moveTo(m.x, m.y)
			}
			a.lineTo(g.x, g.y)
		}
		a.fill();
		a.globalAlpha = 1
	},
	_strokeRadarChart: function(a, l, n) {
		var m, g;
		for (var c = 0; c < l.length; c++) {
			m = l[c];
			g = (l[c + 1] || l[0]);
			this._drawLine(a, m.x, m.y, g.x, g.y, this._settings.line.color.call(this, n[c]), this._settings.line.width)
		}
	},
	_drawRadarAxises: function(D, A, w, o, Q) {
		var a = this._settings.yAxis;
		var l = this._settings.xAxis;
		var q = a.start;
		var n = a.end;
		var s = a.step;
		var E = {};
		var P = this._configYAxis;
		if (typeof P.step == "undefined" || typeof P.start == "undefined" || typeof P.end == "undefined") {
			var u = this._getLimits();
			E = this._calculateScale(u.min, u.max);
			q = E.start;
			n = E.end;
			s = E.step;
			a.end = n;
			a.start = q
		}
		var K = [];
		var N, M, F;
		var O = 0;
		var g = o * s / (n - q);
		var v, C;
		if (s < 1) {
			v = Math.min(this._log10(s), (q <= 0 ? 0 : this._log10(q)));
			C = Math.pow(10, -v)
		}
		var L = [];
		if (!this.canvases.scale) {
			this.canvases.scale = new dhtmlx.ui.Canvas(this._obj, "radar_scale")
		}
		var J = this.canvases.scale.getCanvas();
		for (N = n; N >= q; N -= s) {
			if (E.fixNum) {
				N = parseFloat((new Number(N)).toFixed(E.fixNum))
			}
			K.push(Math.floor(O * g) + 0.5);
			if (C) {
				N = Math.round(N * C) / C
			}
			var r = w - o + K[K.length - 1];
			this.canvases.scale.renderTextAt("middle", "left", A, r, a.template(N.toString()), "dhx_axis_item_y dhx_radar");
			if (D.length < 2) {
				this._drawScaleSector(J, "arc", A, w, o - K[K.length - 1], -Math.PI / 2, 3 * Math.PI / 2, N);
				return
			}
			var m = -Math.PI / 2;
			var I = m;
			var H;
			for (M = 0; M < D.length; M++) {
				if (N == n) {
					L.push(I)
				}
				H = m + D[M] - 0.0001;
				this._drawScaleSector(J, (P.lineShape || "line"), A, w, o - K[K.length - 1], I, H, N, M, Q[N]);
				I = H
			}
			O++
		}
		for (N = 0; N < L.length; N++) {
			F = this._getPositionByAngle(L[N], A, w, o);
			if (l.lines.call(this, Q[N], N)) {
				this._drawLine(J, A, w, F.x, F.y, (l ? l.lineColor.call(this, Q[N]) : "#cfcfcf"), 1)
			}
			this._drawRadarScaleLabel(J, A, w, o, L[N], (l ? l.template.call(this, Q[N]) : "&nbsp;"))
		}
	},
	_drawScaleSector: function(v, n, u, r, m, c, a, l, g) {
		var s, q;
		if (m < 0) {
			return false
		}
		s = this._getPositionByAngle(c, u, r, m);
		q = this._getPositionByAngle(a, u, r, m);
		var o = this._settings.yAxis;
		if (o.bg) {
			v.beginPath();
			v.moveTo(u, r);
			if (n == "arc") {
				v.arc(u, r, m, c, a, false)
			} else {
				v.lineTo(s.x, s.y);
				v.lineTo(q.x, q.y)
			}
			v.fillStyle = o.bg(l, g);
			v.moveTo(u, r);
			v.fill();
			v.closePath()
		}
		if (o.lines.call(this, l)) {
			v.lineWidth = 1;
			v.beginPath();
			if (n == "arc") {
				v.arc(u, r, m, c, a, false)
			} else {
				v.moveTo(s.x, s.y);
				v.lineTo(q.x, q.y)
			}
			v.strokeStyle = o.lineColor.call(this, l);
			v.stroke()
		}
	},
	_drawRadarScaleLabel: function(C, s, o, c, q, w) {
		var A = this.canvases.scale.renderText(0, 0, w, "dhx_axis_radar_title", 1);
		var g = A.scrollWidth;
		var v = A.offsetHeight;
		var u = 0.001;
		var n = this._getPositionByAngle(q, s, o, c + 5);
		var m = 0,
			l = 0;
		if (q < 0 || q > Math.PI) {
			l = -v
		}
		if (q > Math.PI / 2) {
			m = -g
		}
		if (Math.abs(q + Math.PI / 2) < u || Math.abs(q - Math.PI / 2) < u) {
			m = -g / 2
		} else {
			if (Math.abs(q) < u || Math.abs(q - Math.PI) < u) {
				l = -v / 2
			}
		}
		A.style.top = n.y + l + "px";
		A.style.left = n.x + m + "px";
		A.style.width = g + "px";
		A.style.whiteSpace = "nowrap"
	}
};
dhtmlx.chart.area = {
	pvt_render_area: function(q, H, m, l, r, D) {
		var u, C, v, s, n, A, o, F, E, y, x, c, w, a, g;
		A = this._calculateLineParams(q, H, m, l, r);
		C = this._settings;
		s = (C.eventRadius || Math.floor(A.cellWidth / 2));
		if (H.length) {
			o = [];
			y = (!C.offset ? m.x : m.x + A.cellWidth * 0.5);
			for (v = 0; v < H.length; v++) {
				n = H[v];
				E = this._getPointY(n, m, l, A);
				w = y + A.cellWidth * v;
				if (E) {
					a = (typeof E == "object" ? E.y0 : E);
					if (v && this._settings.fixOverflow) {
						F = this._getPointY(H[v - 1], m, l, A);
						if (F.out && F.out == E.out) {
							continue
						}
						x = A.cellWidth * (v - 1) - 0.5 + y;
						c = (typeof F == "object" ? F.y0 : F);
						if (F.out) {
							g = (F.out == "min" ? l.y : m.y);
							o.push([this._calcOverflowX(x, w, c, a, g), g])
						}
						if (E.out) {
							g = (E.out == "min" ? l.y : m.y);
							o.push([this._calcOverflowX(x, w, c, a, g), g]);
							if (v == (H.length - 1) && g == m.y) {
								o.push([w, m.y])
							}
						}
					}
					if (!E.out) {
						o.push([w, a]);
						D.addRect(n.id, [w - s - m.x, a - s - m.y, w + s - m.x, a + s - m.y], r)
					}
					if (!C.yAxis) {
						u = (!C.offset && (v == H.length - 1) ? "left" : "center");
						this.canvases[r].renderTextAt(false, u, w, a - C.labelOffset, C.label(n))
					}
				}
			}
			if (o.length) {
				o.push([w, l.y]);
				o.push([o[0][0], l.y])
			}
			q.globalAlpha = this._settings.alpha.call(this, H[0]);
			q.fillStyle = this._settings.color.call(this, H[0]);
			q.beginPath();
			this._path(q, o);
			q.fill();
			if (C.border) {
				q.lineWidth = C.borderWidth || 1;
				if (C.borderColor) {
					q.strokeStyle = C.borderColor.call(this, H[0])
				} else {
					this._setBorderStyles(q, q.fillStyle)
				}
				q.beginPath();
				this._path(q, o);
				q.stroke()
			}
			q.lineWidth = 1;
			q.globalAlpha = 1
		}
	}
};
dhtmlx.chart.stackedArea = {
	pvt_render_stackedArea: function(r, I, c, a, s, F) {
		var K, J, w, E, C, A, m, v, n, D, q, l, g, o;
		D = this._calculateLineParams(r, I, c, a, s);
		E = this._settings;
		v = (E.eventRadius || Math.floor(D.cellWidth / 2));
		if (I.length) {
			q = [];
			o = [];
			l = (!E.offset ? c.x : c.x + D.cellWidth * 0.5);
			var H = function(x, L) {
				return s ? (I[x].$startY ? L - a.y + I[x].$startY : 0) : L
			};
			var u = function(y, N, M) {
				var L = (M.y - N.y) / (M.x - N.x);
				return L * y + N.y - L * N.x
			};
			for (C = 0; C < I.length; C++) {
				n = I[C];
				if (!C) {
					g = H(C, a.y);
					q.push([l, g])
				} else {
					l += D.cellWidth
				}
				g = H(C, this._getPointY(n, c, a, D));
				o.push((isNaN(g) && !C) ? (I[C].$startY || a.y) : g);
				if (g) {
					q.push([l, g]);
					F.addRect(n.id, [l - v - c.x, g - v - c.y, l + v - c.x, g + v - c.y], s);
					if (!E.yAxis) {
						w = (!E.offset && m ? "left" : "center");
						this.canvases[s].renderTextAt(false, w, l, g - E.labelOffset, E.label(n))
					}
				}
			}
			q.push([l, H(C - 1, a.y)]);
			if (s) {
				for (C = I.length - 2; C > 0; C--) {
					l -= D.cellWidth;
					g = I[C].$startY;
					if (g) {
						q.push([l, g])
					}
				}
			}
			q.push([q[0][0], q[0][1]]);
			r.globalAlpha = this._settings.alpha.call(this, I[0]);
			r.fillStyle = this._settings.color.call(this, I[0]);
			r.beginPath();
			this._path(r, q);
			r.fill();
			for (C = 0; C < I.length; C++) {
				g = o[C];
				if (!g) {
					if (C == I.length - 1) {
						g = I[C].$startY
					}
					for (A = C + 1; A < I.length; A++) {
						if (o[A]) {
							K = {
								x: c.x,
								y: o[0]
							};
							J = {
								x: (c.x + D.cellWidth * A),
								y: o[A]
							};
							g = u(c.x + D.cellWidth * C, K, J);
							break
						}
					}
				}
				I[C].$startY = g
			}
		}
	}
};
dhtmlx.chart.spline = {
	pvt_render_spline: function(r, J, l, g, s, I) {
		var H, v, q, u, F, o, n, C, A, w, m, c, a;
		F = this._calculateLineParams(r, J, l, g, s);
		H = this._settings;
		this._mapStart = l;
		q = [];
		if (J.length) {
			C = (H.offset ? l.x + F.cellWidth * 0.5 : l.x);
			for (v = 0; v < J.length; v++) {
				m = this._getPointY(J[v], l, g, F);
				if (m) {
					n = ((!v) ? C : F.cellWidth * v - 0.5 + C);
					q.push({
						x: n,
						y: m,
						index: v
					})
				}
			}
			o = this._getSplineParameters(q);
			for (v = 0; v < q.length; v++) {
				A = q[v].x;
				c = q[v].y;
				if (v < q.length - 1) {
					w = q[v + 1].x;
					a = q[v + 1].y;
					for (u = A; u < w; u++) {
						var E = this._getSplineYPoint(u, A, v, o.a, o.b, o.c, o.d);
						if (E < l.y) {
							E = l.y
						}
						if (E > g.y) {
							E = g.y
						}
						var D = this._getSplineYPoint(u + 1, A, v, o.a, o.b, o.c, o.d);
						if (D < l.y) {
							D = l.y
						}
						if (D > g.y) {
							D = g.y
						}
						this._drawLine(r, u, E, u + 1, D, H.line.color(J[v]), H.line.width)
					}
					this._drawLine(r, w - 1, this._getSplineYPoint(u, A, v, o.a, o.b, o.c, o.d), w, a, H.line.color(J[v]), H.line.width)
				}
				this._drawItem(r, A, c, J[q[v].index], H.label(J[q[v].index]), s, I)
			}
		}
	},
	_getSplineParameters: function(A) {
		var o, D, C, E, y, x, w, r, q = [],
			l = [],
			g = A.length;
		for (o = 0; o < g - 1; o++) {
			q[o] = A[o + 1].x - A[o].x;
			l[o] = (A[o + 1].y - A[o].y) / q[o]
		}
		D = [];
		C = [];
		D[0] = 0;
		D[1] = 2 * (q[0] + q[1]);
		C[0] = 0;
		C[1] = 6 * (l[1] - l[0]);
		for (o = 2; o < g - 1; o++) {
			D[o] = 2 * (q[o - 1] + q[o]) - q[o - 1] * q[o - 1] / D[o - 1];
			C[o] = 6 * (l[o] - l[o - 1]) - q[o - 1] * C[o - 1] / D[o - 1]
		}
		E = [];
		E[g - 1] = E[0] = 0;
		for (o = g - 2; o >= 1; o--) {
			E[o] = (C[o] - q[o] * E[o + 1]) / D[o]
		}
		y = [];
		x = [];
		w = [];
		r = [];
		for (o = 0; o < g - 1; o++) {
			y[o] = A[o].y;
			x[o] = -q[o] * E[o + 1] / 6 - q[o] * E[o] / 3 + (A[o + 1].y - A[o].y) / q[o];
			w[o] = E[o] / 2;
			r[o] = (E[o + 1] - E[o]) / (6 * q[o])
		}
		return {
			a: y,
			b: x,
			c: w,
			d: r
		}
	},
	_getSplineYPoint: function(l, n, o, m, g, r, q) {
		return m[o] + (l - n) * (g[o] + (l - n) * (r[o] + (l - n) * q[o]))
	}
};
dhtmlx.chart.barH = {
	pvt_render_barH: function(C, O, n, m, D, N) {
		var s, v, F, E, a, I, q, L, w, M, c, y, o, J, x, l, A, u, K, g, r;
		F = (m.y - n.y) / O.length;
		q = this._getLimits("h");
		L = q.max;
		w = q.min;
		l = m.x - n.x;
		r = !!this._settings.yAxis;
		if (!D) {
			this._drawHScales(C, O, n, m, w, L, F)
		}
		if (r) {
			L = parseFloat(this._settings.xAxis.end);
			w = parseFloat(this._settings.xAxis.start)
		}
		J = this._getRelativeValue(w, L);
		y = J[0];
		c = J[1];
		u = (y ? l / y : 10);
		if (!r) {
			x = 10;
			u = (y ? (l - x) / y : 10)
		}
		v = parseInt(this._settings.width, 10);
		if ((v * this._series.length + 4) > F) {
			v = F / this._series.length - 4
		}
		s = Math.floor((F - v * this._series.length) / 2);
		o = (typeof this._settings.radius != "undefined" ? parseInt(this._settings.radius, 10) : Math.round(v / 5));
		M = false;
		a = this._settings.gradient;
		if (a && typeof(a) != "function") {
			M = a;
			a = false
		} else {
			if (a) {
				a = C.createLinearGradient(n.x, n.y, m.x, n.y);
				this._settings.gradient(a)
			}
		}
		if (!r) {
			this._drawLine(C, n.x - 0.5, n.y, n.x - 0.5, m.y, "#000000", 1)
		}
		for (I = 0; I < O.length; I++) {
			A = parseFloat(this._settings.value(O[I] || 0));
			if (A > L) {
				A = L
			}
			A -= w;
			A *= c;
			K = n.x;
			g = n.y + s + I * F + (v + 1) * D;
			if ((A < 0 && this._settings.origin == "auto") || (this._settings.xAxis && A === 0 && !(this._settings.origin != "auto" && this._settings.origin > w))) {
				this.canvases[D].renderTextAt("middle", "right", K + 10, g + v / 2 + s, this._settings.label(O[I]));
				continue
			}
			if (A < 0 && this._settings.origin != "auto" && this._settings.origin > w) {
				A = 0
			}
			if (!r) {
				A += x / u
			}
			E = a || this._settings.color.call(this, O[I]);
			if (this._settings.border) {
				this._drawBarHBorder(C, K, g, v, w, o, u, A, E)
			}
			C.globalAlpha = this._settings.alpha.call(this, O[I]);
			var H = this._drawBarH(C, m, K, g, v, w, o, u, A, E, a, M);
			if (M != false) {
				this._drawBarHGradient(C, K, g, v, w, o, u, A, E, M)
			}
			C.globalAlpha = 1;
			if (H[3] == g) {
				this.canvases[D].renderTextAt("middle", "left", H[0] - 5, H[3] + Math.floor(v / 2), this._settings.label(O[I]));
				N.addRect(O[I].id, [H[0] - n.x, H[3] - n.y, H[2] - n.x, H[3] + v - n.y], D)
			} else {
				this.canvases[D].renderTextAt("middle", false, H[2] + 5, H[1] + Math.floor(v / 2), this._settings.label(O[I]));
				N.addRect(O[I].id, [H[0] - n.x, g - n.y, H[2] - n.x, H[3] - n.y], D)
			}
		}
	},
	_setBarHPoints: function(y, l, w, A, o, x, v, n, m) {
		var c = 0;
		if (o > x * v) {
			var u = (o - x * v) / o;
			c = -Math.asin(u) + Math.PI / 2
		}
		y.moveTo(l, w + n);
		var g = l + x * v - o - (o ? 0 : n);
		if (o < x * v) {
			y.lineTo(g, w + n)
		}
		var s = w + o;
		if (o && o > 0) {
			y.arc(g, s, o - n, -Math.PI / 2 + c, 0, false)
		}
		var r = w + A - o - (o ? 0 : n);
		var a = g + o - (o ? n : 0);
		y.lineTo(a, r);
		if (o && o > 0) {
			y.arc(g, r, o - n, 0, Math.PI / 2 - c, false)
		}
		var q = w + A - n;
		y.lineTo(l, q);
		if (!m) {
			y.lineTo(l, w + n)
		}
		return [a, q]
	},
	_drawHScales: function(g, o, n, m, q, c, l) {
		var a = 0;
		if (this._settings.xAxis) {
			if (!this.canvases.x) {
				this.canvases.x = new dhtmlx.ui.Canvas(this._obj)
			}
			a = this._drawHXAxis(this.canvases.x.getCanvas(), o, n, m, q, c)
		}
		if (this._settings.yAxis) {
			if (!this.canvases.y) {
				this.canvases.y = new dhtmlx.ui.Canvas(this._obj)
			}
			this._drawHYAxis(this.canvases.y.getCanvas(), o, n, m, l, a)
		}
	},
	_drawHYAxis: function(v, m, r, o, g, a) {
		if (!this._settings.yAxis) {
			return
		}
		var n;
		var c = parseInt((a ? a : r.x), 10) - 0.5;
		var s = o.y + 0.5;
		var q = r.y;
		this._drawLine(v, c, s, c, q, this._settings.yAxis.color, 1);
		for (var l = 0; l < m.length; l++) {
			var u = ((this._settings.origin != "auto") && (this._settings.view == "barH") && (parseFloat(this._settings.value(m[l])) < this._settings.origin));
			n = q + g / 2 + l * g;
			this.canvases.y.renderTextAt("middle", (u ? false : "left"), (u ? c + 5 : c - 5), n, this._settings.yAxis.template(m[l]), "dhx_axis_item_y", (u ? 0 : c - 10));
			if (this._settings.yAxis.lines.call(this, m[l])) {
				this._drawLine(v, r.x, n, o.x, n, this._settings.yAxis.lineColor.call(this, m[l]), 1)
			}
		}
		this._drawLine(v, r.x + 0.5, q + 0.5, o.x, q + 0.5, this._settings.yAxis.lineColor.call(this, {}), 1);
		this._setYAxisTitle(r, o)
	},
	_drawHXAxis: function(D, v, A, y, g, r) {
		var o;
		var m = {};
		var q = this._settings.xAxis;
		if (!q) {
			return
		}
		var C = y.y + 0.5;
		var l = A.x - 0.5;
		var a = y.x - 0.5;
		var u = A.x;
		this._drawLine(D, l, C, a, C, q.color, 1);
		if (q.step) {
			o = parseFloat(q.step)
		}
		if (typeof this._configXAxis.step == "undefined" || typeof this._configXAxis.start == "undefined" || typeof this._configXAxis.end == "undefined") {
			m = this._calculateScale(g, r);
			g = m.start;
			r = m.end;
			o = m.step;
			this._settings.xAxis.end = r;
			this._settings.xAxis.start = g;
			this._settings.xAxis.step = o
		}
		if (o === 0) {
			return
		}
		var n = (a - l) * o / (r - g);
		var x = 0;
		for (var s = g; s <= r; s += o) {
			if (m.fixNum) {
				s = parseFloat((new Number(s)).toFixed(m.fixNum))
			}
			var w = Math.floor(l + x * n) + 0.5;
			if (!(s == g && this._settings.origin == "auto") && q.lines.call(this, s)) {
				this._drawLine(D, w, C, w, A.y, this._settings.xAxis.lineColor.call(this, s), 1)
			}
			if (s == this._settings.origin) {
				u = w + 1
			}
			this.canvases.x.renderTextAt(false, true, w, C + 2, q.template(s.toString()), "dhx_axis_item_x");
			x++
		}
		this.canvases.x.renderTextAt(true, false, l, y.y + this._settings.padding.bottom - 3, this._settings.xAxis.title, "dhx_axis_title_x", y.x - A.x);
		if (!q.lines.call(this, {})) {
			this._drawLine(D, l, A.y - 0.5, a, A.y - 0.5, this._settings.xAxis.color, 0.2)
		}
		return u
	},
	_correctBarHParams: function(q, m, g, n, o, r, l) {
		var a = this._settings.yAxis;
		var c = m;
		if (!!a && this._settings.origin != "auto" && (this._settings.origin > l)) {
			m += (this._settings.origin - l) * o;
			c = m;
			n = n - (this._settings.origin - l);
			if (n < 0) {
				n *= (-1);
				q.translate(m, g + r);
				q.rotate(Math.PI);
				m = 0.5;
				g = 0
			}
			m += 0.5
		}
		return {
			value: n,
			x0: m,
			y0: g,
			start: c
		}
	},
	_drawBarH: function(w, m, D, l, r, s, n, q, v, x, a, o) {
		w.save();
		var u = this._correctBarHParams(w, D, l, v, q, r, s);
		w.fillStyle = x;
		w.beginPath();
		var y = this._setBarHPoints(w, u.x0, u.y0, r, n, q, u.value, (this._settings.border ? 1 : 0));
		if (a && !o) {
			w.lineTo(m.x, u.y0 + (this._settings.border ? 1 : 0))
		}
		w.fill();
		w.restore();
		var g = u.y0;
		var c = (u.y0 != l ? l : y[1]);
		var C = (u.y0 != l ? (u.start - y[0]) : u.start);
		var A = (u.y0 != l ? u.start : y[0]);
		return [C, g, A, c]
	},
	_drawBarHBorder: function(r, c, o, s, m, l, q, n, g) {
		r.save();
		var a = this._correctBarHParams(r, c, o, n, q, s, m);
		r.beginPath();
		this._setBorderStyles(r, g);
		r.globalAlpha = 0.9;
		this._setBarHPoints(r, a.x0, a.y0, s, l, q, a.value, r.lineWidth / 2, 1);
		r.stroke();
		r.restore()
	},
	_drawBarHGradient: function(u, g, r, v, o, n, s, q, l, a) {
		u.save();
		var c = this._correctBarHParams(u, g, r, q, s, v, o);
		var m = this._setBarGradient(u, c.x0, c.y0 + v, c.x0 + s * c.value, c.y0, a, l, "x");
		u.fillStyle = m.gradient;
		u.beginPath();
		this._setBarHPoints(u, c.x0, c.y0 + m.offset, v - m.offset * 2, n, s, c.value, m.offset);
		u.fill();
		u.globalAlpha = 1;
		u.restore()
	}
};
dhtmlx.assert(dhtmlx.chart.barH);
dhtmlx.chart.stackedBarH = {
	pvt_render_stackedBarH: function(E, S, m, l, F, Q) {
		var P, x;
		var c;
		var y;
		var C = l.x - m.x;
		var q = !!this._settings.yAxis;
		var o = this._getStackedLimits(S);
		P = o.max;
		x = o.min;
		var I = Math.floor((l.y - m.y) / S.length);
		if (!F) {
			this._drawHScales(E, S, m, l, x, P, I)
		}
		if (q) {
			P = parseFloat(this._settings.xAxis.end);
			x = parseFloat(this._settings.xAxis.start)
		}
		var M = this._getRelativeValue(x, P);
		y = M[0];
		c = M[1];
		var v = (y ? C / y : 10);
		if (!q) {
			var A = 10;
			v = (y ? (C - A) / y : 10)
		}
		var w = parseInt(this._settings.width, 10);
		if ((w + 4) > I) {
			w = I - 4
		}
		var r = (I - w) / 2;
		var n = 0;
		var s = false;
		var a = this._settings.gradient;
		if (a) {
			s = true
		}
		if (!q) {
			this._drawLine(E, m.x - 0.5, m.y, m.x - 0.5, l.y, "#000000", 1)
		}
		var O = 0;
		var L = 0;
		for (K = 0; K < this._series.length; K++) {
			if (K == F) {
				L = O
			}
			if (this._series[K].view == "stackedBarH") {
				O++
			}
		}
		for (var K = 0; K < S.length; K++) {
			if (!L) {
				S[K].$startX = m.x
			}
			var D = parseFloat(this._settings.value(S[K] || 0));
			if (D > P) {
				D = P
			}
			D -= x;
			D *= c;
			var N = m.x;
			var g = m.y + r + K * I;
			if (!L) {
				S[K].$startX = N
			} else {
				N = S[K].$startX
			}
			if (D < 0 || (this._settings.yAxis && D === 0)) {
				this.canvases.y.renderTextAt("middle", true, N + 10, g + w / 2, this._settings.label(S[K]));
				continue
			}
			if (!q) {
				D += A / v
			}
			var H = this._settings.color.call(this, S[K]);
			E.globalAlpha = this._settings.alpha.call(this, S[K]);
			E.fillStyle = this._settings.color.call(this, S[K]);
			E.beginPath();
			var J = this._setBarHPoints(E, N, g, w, n, v, D, (this._settings.border ? 1 : 0));
			if (a && !s) {
				E.lineTo(m.x + C, g + (this._settings.border ? 1 : 0))
			}
			E.fill();
			if (s != false) {
				var u = this._setBarGradient(E, N, g + w, N, g, s, H, "x");
				E.fillStyle = u.gradient;
				E.beginPath();
				J = this._setBarHPoints(E, N, g, w, n, v, D, 0);
				E.fill()
			}
			if (this._settings.border) {
				this._drawBarHBorder(E, N, g, w, x, n, v, D, H)
			}
			E.globalAlpha = 1;
			this.canvases[F].renderTextAt("middle", true, S[K].$startX + (J[0] - S[K].$startX) / 2 - 1, g + (J[1] - g) / 2, this._settings.label(S[K]));
			Q.addRect(S[K].id, [S[K].$startX - m.x, g - m.y, J[0] - m.x, J[1] - m.y], F);
			S[K].$startX = J[0]
		}
	}
};
dhtmlx.chart.stackedBar = {
	pvt_render_stackedBar: function(A, N, l, g, C, M) {
		var K, v;
		var a;
		var w;
		var x = g.y - l.y;
		var n = !!this._settings.yAxis;
		var L = !!this._settings.xAxis;
		var m = this._getStackedLimits(N);
		K = m.max;
		v = m.min;
		var E = Math.floor((g.x - l.x) / N.length);
		if (!C) {
			this._drawScales(N, l, g, v, K, E)
		}
		if (n) {
			K = parseFloat(this._settings.yAxis.end);
			v = parseFloat(this._settings.yAxis.start)
		}
		var I = this._getRelativeValue(v, K);
		w = I[0];
		a = I[1];
		var s = (w ? x / w : 10);
		var u = parseInt(this._settings.width, 10);
		if (u + 4 > E) {
			u = E - 4
		}
		var o = Math.floor((E - u) / 2);
		var q = (this._settings.gradient ? this._settings.gradient : false);
		if (!L) {
			this._drawLine(A, l.x, g.y + 0.5, g.x, g.y + 0.5, "#000000", 1)
		}
		for (var H = 0; H < N.length; H++) {
			var y = parseFloat(this._settings.value(N[H] || 0));
			if (!y) {
				if (!C || !N[H].$startY) {
					N[H].$startY = g.y
				}
				continue
			}
			if (!C) {
				y -= v
			}
			y *= a;
			var J = l.x + o + H * E;
			var c = g.y;
			if (!C) {
				N[H].$startY = c
			} else {
				c = N[H].$startY
			}
			if (c < (l.y + 1)) {
				continue
			}
			if (y < 0 || (this._settings.yAxis && y === 0)) {
				this.canvases.y.renderTextAt(true, true, J + Math.floor(u / 2), c, this._settings.label(N[H]));
				continue
			}
			var D = this._settings.color.call(this, N[H]);
			A.globalAlpha = this._settings.alpha.call(this, N[H]);
			A.fillStyle = this._settings.color.call(this, N[H]);
			A.beginPath();
			var F = this._setStakedBarPoints(A, J - (this._settings.border ? 0.5 : 0), c, u + (this._settings.border ? 0.5 : 0), s, y, 0, l.y);
			A.fill();
			if (q) {
				A.save();
				var r = this._setBarGradient(A, J, c, J + u, F[1], q, D, "y");
				A.fillStyle = r.gradient;
				A.beginPath();
				F = this._setStakedBarPoints(A, J + r.offset, c, u - r.offset * 2, s, y, (this._settings.border ? 1 : 0), l.y);
				A.fill();
				A.restore()
			}
			if (this._settings.border) {
				A.save();
				this._setBorderStyles(A, D);
				A.beginPath();
				this._setStakedBarPoints(A, J - 0.5, c, u + 1, s, y, 0, l.y, 1);
				A.stroke();
				A.restore()
			}
			A.globalAlpha = 1;
			this.canvases[C].renderTextAt(false, true, J + Math.floor(u / 2), (F[1] + (c - F[1]) / 2) - 7, this._settings.label(N[H]));
			M.addRect(N[H].id, [J - l.x, F[1] - l.y, F[0] - l.x, (N[H].$startY || c) - l.y], C);
			N[H].$startY = (this._settings.border ? (F[1] + 1) : F[1])
		}
	},
	_setStakedBarPoints: function(v, c, r, w, s, q, l, g, m) {
		v.moveTo(c, r);
		var o = r - s * q + l;
		if (o < g) {
			o = g
		}
		v.lineTo(c, o);
		var a = c + w;
		var n = o;
		v.lineTo(a, n);
		var u = c + w;
		v.lineTo(u, r);
		if (!m) {
			v.lineTo(c, r)
		}
		return [u, n - 2 * l]
	}
};
dhtmlx.chart.line = {
	pvt_render_line: function(o, D, m, l, q, A) {
		var y, r, n, w, v, u, s, c, a, g, C, x;
		w = this._calculateLineParams(o, D, m, l, q);
		y = this._settings;
		if (D.length) {
			v = (y.offset ? m.x + w.cellWidth * 0.5 : m.x);
			n = [];
			for (r = 0; r < D.length; r++) {
				x = this._getPointY(D[r], m, l, w);
				if (x) {
					s = ((!r) ? v : w.cellWidth * r - 0.5 + v);
					a = (typeof x == "object" ? x.y0 : x);
					if (r && this._settings.fixOverflow) {
						C = this._getPointY(D[r - 1], m, l, w);
						if (C.out && C.out == x.out) {
							continue
						}
						u = w.cellWidth * (r - 1) - 0.5 + v;
						c = (typeof C == "object" ? C.y0 : C);
						if (C.out) {
							g = (C.out == "min" ? l.y : m.y);
							n.push({
								x: this._calcOverflowX(u, s, c, a, g),
								y: g
							})
						}
						if (x.out) {
							g = (x.out == "min" ? l.y : m.y);
							n.push({
								x: this._calcOverflowX(u, s, c, a, g),
								y: g
							})
						}
					}
					if (!x.out) {
						n.push({
							x: s,
							y: x,
							index: r
						})
					}
				}
			}
			this._mapStart = m;
			for (r = 1; r <= n.length; r++) {
				u = n[r - 1].x;
				c = n[r - 1].y;
				if (r < n.length) {
					s = n[r].x;
					a = n[r].y;
					this._drawLine(o, u, c, s, a, y.line.color.call(this, D[r - 1]), y.line.width);
					if (y.line && y.line.shadow) {
						o.globalAlpha = 0.3;
						this._drawLine(o, u + 2, c + y.line.width + 8, s + 2, a + y.line.width + 8, "#eeeeee", y.line.width + 3);
						o.globalAlpha = 1
					}
				}
				if (typeof n[r - 1].index != "undefined") {
					this._drawItem(o, u, c, D[n[r - 1].index], y.label(D[n[r - 1].index]), q, A, m)
				}
			}
		}
	},
	_calcOverflowX: function(c, a, l, g, m) {
		return c + (m - l) * (a - c) / (g - l)
	},
	_drawItem: function(w, g, v, r, u, s, c) {
		var l = this._settings.item;
		var q = parseInt(l.radius.call(this, r), 10) || 0;
		var o = this._mapStart;
		if (q) {
			w.save();
			if (l.shadow) {
				w.lineWidth = 1;
				w.strokeStyle = "#bdbdbd";
				w.fillStyle = "#bdbdbd";
				var a = [0.1, 0.2, 0.3];
				for (var n = (a.length - 1); n >= 0; n--) {
					w.globalAlpha = a[n];
					w.strokeStyle = "#d0d0d0";
					w.beginPath();
					this._strokeChartItem(w, g, v + 2 * q / 3, q + n + 1, l.type);
					w.stroke()
				}
				w.beginPath();
				w.globalAlpha = 0.3;
				w.fillStyle = "#bdbdbd";
				this._strokeChartItem(w, g, v + 2 * q / 3, q + 1, l.type);
				w.fill()
			}
			w.restore();
			w.lineWidth = l.borderWidth;
			w.fillStyle = l.color.call(this, r);
			w.strokeStyle = l.borderColor.call(this, r);
			w.globalAlpha = l.alpha.call(this, r);
			w.beginPath();
			this._strokeChartItem(w, g, v, q + 1, l.type);
			w.fill();
			w.stroke();
			w.globalAlpha = 1
		}
		if (u) {
			this.canvases[s].renderTextAt(false, true, g, v - q - this._settings.labelOffset, this._settings.label.call(this, r))
		}
		var m = (this._settings.eventRadius || q + 1);
		c.addRect(r.id, [g - m - o.x, v - m - o.y, g + m - o.x, v + m - o.y], s)
	},
	_strokeChartItem: function(a, c, m, l, g) {
		var n = [];
		c = parseInt(c, 10);
		m = parseInt(m, 10);
		if (g && (g == "square" || g == "s")) {
			l *= Math.sqrt(2) / 2;
			n = [
				[c - l - a.lineWidth / 2, m - l],
				[c + l, m - l],
				[c + l, m + l],
				[c - l, m + l],
				[c - l, m - l]
			]
		} else {
			if (g && (g == "diamond" || g == "d")) {
				var o = (a.lineWidth > 1 ? a.lineWidth * Math.sqrt(2) / 4 : 0);
				n = [
					[c, m - l],
					[c + l, m],
					[c, m + l],
					[c - l, m],
					[c + o, m - l - o]
				]
			} else {
				if (g && (g == "triangle" || g == "t")) {
					n = [
						[c, m - l],
						[c + Math.sqrt(3) * l / 2, m + l / 2],
						[c - Math.sqrt(3) * l / 2, m + l / 2],
						[c, m - l]
					]
				} else {
					n = [
						[c, m, l, 0, Math.PI * 2, true]
					]
				}
			}
		}
		this._path(a, n)
	},
	_getPointY: function(g, q, n, a) {
		var o = a.minValue;
		var l = a.maxValue;
		var s = a.unit;
		var c = a.valueFactor;
		var r = this._settings.value(g);
		var u = (parseFloat(r || 0) - o) * c;
		if (!this._settings.yAxis) {
			u += a.startValue / s
		}
		var m = n.y - s * u;
		if (this._settings.fixOverflow && (this._settings.view == "line" || this._settings.view == "area")) {
			if (r > l) {
				m = {
					y: q.y,
					y0: m,
					out: "max"
				}
			} else {
				if (u < 0 || r < o) {
					m = {
						y: n.y,
						y0: m,
						out: "min"
					}
				}
			}
		} else {
			if (r > l) {
				m = q.y
			}
			if (u < 0 || r < o) {
				m = n.y
			}
		}
		return m
	},
	_calculateLineParams: function(r, l, o, n, m) {
		var c = {};
		var s;
		c.totalHeight = n.y - o.y;
		c.cellWidth = (n.x - o.x) / ((!this._settings.offset) ? (l.length - 1) : l.length);
		var g = !!this._settings.yAxis;
		var a = (this._settings.view.indexOf("stacked") != -1 ? this._getStackedLimits(l) : this._getLimits());
		c.maxValue = a.max;
		c.minValue = a.min;
		if (!m) {
			this._drawScales(l, o, n, c.minValue, c.maxValue, c.cellWidth)
		}
		if (g) {
			c.maxValue = parseFloat(this._settings.yAxis.end);
			c.minValue = parseFloat(this._settings.yAxis.start)
		}
		var q = this._getRelativeValue(c.minValue, c.maxValue);
		s = q[0];
		c.valueFactor = q[1];
		c.unit = (s ? c.totalHeight / s : 10);
		c.startValue = 0;
		if (!g) {
			c.startValue = 10;
			if (c.unit != c.totalHeight) {
				c.unit = (s ? (c.totalHeight - c.startValue) / s : 10)
			}
		}
		return c
	}
};
dhtmlx.chart.bar = {
	pvt_render_bar: function(C, S, m, l, D, Q) {
		var v, F, J, o, O, w, x, c, K, y, u, N, q, P = l.y - m.y;
		q = !!this._settings.yAxis;
		N = !!this._settings.xAxis;
		o = this._getLimits();
		O = o.max;
		w = o.min;
		F = (l.x - m.x) / S.length;
		if (!D && !(this._settings.origin != "auto" && !q)) {
			this._drawScales(S, m, l, w, O, F)
		}
		if (q) {
			O = parseFloat(this._settings.yAxis.end);
			w = parseFloat(this._settings.yAxis.start)
		}
		K = this._getRelativeValue(w, O);
		x = K[0];
		c = K[1];
		u = (x ? P / x : x);
		if (!q && !(this._settings.origin != "auto" && N)) {
			y = 10;
			u = (x ? (P - y) / x : y)
		}
		if (!D && (this._settings.origin != "auto" && !q) && this._settings.origin > w) {
			this._drawXAxis(C, S, m, l, F, l.y - u * (this._settings.origin - w))
		}
		v = parseInt(this._settings.width, 10);
		var M = 0;
		var I = 0;
		for (J = 0; J < this._series.length; J++) {
			if (J == D) {
				I = M
			}
			if (this._series[J].view == "bar") {
				M++
			}
		}
		if (this._series && (v * M + 4) > F) {
			v = parseInt(F / M - 4, 10)
		}
		var r = (F - v * M) / 2;
		var n = (typeof this._settings.radius != "undefined" ? parseInt(this._settings.radius, 10) : Math.round(v / 5));
		var s = false;
		var a = this._settings.gradient;
		if (a && typeof(a) != "function") {
			s = a;
			a = false
		} else {
			if (a) {
				a = C.createLinearGradient(0, l.y, 0, m.y);
				this._settings.gradient(a)
			}
		}
		if (!N) {
			this._drawLine(C, m.x, l.y + 0.5, l.x, l.y + 0.5, "#000000", 1)
		}
		for (J = 0; J < S.length; J++) {
			var A = parseFloat(this._settings.value(S[J]) || 0);
			if (isNaN(A)) {
				continue
			}
			if (A > O) {
				A = O
			}
			A -= w;
			A *= c;
			var L = m.x + r + parseInt(J * F, 10) + (v + 1) * I;
			var g = l.y;
			if (A < 0 || (this._settings.yAxis && A === 0 && !(this._settings.origin != "auto" && this._settings.origin > w))) {
				this.canvases[D].renderTextAt(true, true, L + Math.floor(v / 2), g, this._settings.label(S[J]));
				continue
			}
			if (!q && !(this._settings.origin != "auto" && N)) {
				A += y / u
			}
			var E = a || this._settings.color.call(this, S[J]);
			C.globalAlpha = this._settings.alpha.call(this, S[J]);
			var H = this._drawBar(C, m, L, g, v, w, n, u, A, E, a, s);
			if (s) {
				this._drawBarGradient(C, L, g, v, w, n, u, A, E, s)
			}
			if (this._settings.border) {
				this._drawBarBorder(C, L, g, v, w, n, u, A, E)
			}
			C.globalAlpha = 1;
			if (H[0] != L) {
				this.canvases[D].renderTextAt(false, true, L + Math.floor(v / 2), H[1], this._settings.label(S[J]))
			} else {
				this.canvases[D].renderTextAt(true, true, L + Math.floor(v / 2), H[3], this._settings.label(S[J]))
			}
			Q.addRect(S[J].id, [L - m.x, H[3] - m.y, H[2] - m.x, H[1] - m.y], D)
		}
	},
	_correctBarParams: function(q, m, g, n, o, r, l) {
		var a = this._settings.xAxis;
		var c = g;
		if (!!a && this._settings.origin != "auto" && (this._settings.origin > l)) {
			g -= (this._settings.origin - l) * o;
			c = g;
			n = n - (this._settings.origin - l);
			if (n < 0) {
				n *= (-1);
				q.translate(m + r, g);
				q.rotate(Math.PI);
				m = 0;
				g = 0
			}
			g -= 0.5
		}
		return {
			value: n,
			x0: m,
			y0: g,
			start: c
		}
	},
	_drawBar: function(w, m, D, l, r, s, n, q, v, x, a, o) {
		w.save();
		w.fillStyle = x;
		var u = this._correctBarParams(w, D, l, v, q, r, s);
		var y = this._setBarPoints(w, u.x0, u.y0, r, n, q, u.value, (this._settings.border ? 1 : 0));
		if (a && !o) {
			w.lineTo(u.x0 + (this._settings.border ? 1 : 0), m.y)
		}
		w.fill();
		w.restore();
		var C = u.x0;
		var A = (u.x0 != D ? D + y[0] : y[0]);
		var g = (u.x0 != D ? (u.start - y[1] - u.y0) : u.y0);
		var c = (u.x0 != D ? u.start - u.y0 : y[1]);
		return [C, g, A, c]
	},
	_drawBarBorder: function(r, c, o, s, m, l, q, n, g) {
		var a;
		r.save();
		a = this._correctBarParams(r, c, o, n, q, s, m);
		this._setBorderStyles(r, g);
		this._setBarPoints(r, a.x0, a.y0, s, l, q, a.value, r.lineWidth / 2, 1);
		r.stroke();
		r.restore()
	},
	_drawBarGradient: function(v, l, s, w, q, o, u, r, m, c) {
		v.save();
		var g = this._correctBarParams(v, l, s, r, u, w, q);
		var n = this._setBarGradient(v, g.x0, g.y0, g.x0 + w, g.y0 - u * g.value + 2, c, m, "y");
		var a = this._settings.border ? 1 : 0;
		v.fillStyle = n.gradient;
		this._setBarPoints(v, g.x0 + n.offset, g.y0, w - n.offset * 2, o, u, g.value, n.offset + a);
		v.fill();
		v.restore()
	},
	_setBarPoints: function(y, l, v, A, q, w, u, m, o) {
		y.beginPath();
		var c = 0;
		if (q > w * u) {
			var n = (q - w * u) / q;
			if (n <= 1 && n >= -1) {
				c = -Math.acos(n) + Math.PI / 2
			}
		}
		y.moveTo(l + m, v);
		var s = v - Math.floor(w * u) + q + (q ? 0 : m);
		if (q < w * u) {
			y.lineTo(l + m, s)
		}
		var g = l + q;
		if (q && q > 0) {
			y.arc(g, s, q - m, -Math.PI + c, -Math.PI / 2, false)
		}
		var a = l + A - q - m;
		var r = s - q + (q ? m : 0);
		y.lineTo(a, r);
		if (q && q > 0) {
			y.arc(a, s, q - m, -Math.PI / 2, 0 - c, false)
		}
		var x = l + A - m;
		y.lineTo(x, v);
		if (!o) {
			y.lineTo(l + m, v)
		}
		return [x, r]
	}
};
dhtmlx.chart.pie = {
	pvt_render_pie: function(c, l, a, n, g, m) {
		this._renderPie(c, l, a, n, 1, m, g)
	},
	_renderPie: function(u, H, m, l, E, F, v) {
		if (!H.length) {
			return
		}
		var w = this._getPieParameters(m, l);
		var o = (this._settings.radius ? this._settings.radius : w.radius);
		if (o < 0) {
			return
		}
		var a = this._getValues(H);
		var n = this._getTotalValue(a);
		var q = this._getRatios(a, n);
		var D = (this._settings.x ? this._settings.x : w.x);
		var g = (this._settings.y ? this._settings.y : w.y);
		if (E == 1 && this._settings.shadow) {
			this._addShadow(u, D, g, o)
		}
		g = g / E;
		var s = -Math.PI / 2;
		var y = [];
		u.scale(1, E);
		if (this._settings.gradient) {
			var C = (E != 1 ? D + o / 3 : D);
			var c = (E != 1 ? g + o / 3 : g);
			this._showRadialGradient(u, D, g, o, C, c)
		}
		for (var A = 0; A < H.length; A++) {
			if (!a[A]) {
				continue
			}
			u.strokeStyle = this._settings.lineColor.call(this, H[A]);
			u.beginPath();
			u.moveTo(D, g);
			y.push(s);
			alpha1 = -Math.PI / 2 + q[A] - 0.0001;
			u.arc(D, g, o, s, alpha1, false);
			u.lineTo(D, g);
			var x = this._settings.color.call(this, H[A]);
			u.fillStyle = x;
			u.fill();
			if (this._settings.pieInnerText) {
				this._drawSectorLabel(D, g, 5 * o / 6, s, alpha1, E, this._settings.pieInnerText(H[A], n), true)
			}
			if (this._settings.label) {
				this._drawSectorLabel(D, g, o + this._settings.labelOffset, s, alpha1, E, this._settings.label(H[A]))
			}
			if (E != 1) {
				this._createLowerSector(u, D, g, s, alpha1, o, true);
				u.fillStyle = "#000000";
				u.globalAlpha = 0.2;
				this._createLowerSector(u, D, g, s, alpha1, o, false);
				u.globalAlpha = 1;
				u.fillStyle = x
			}
			F.addSector(H[A].id, s, alpha1, D - m.x, g - m.y / E, o, E, v);
			s = alpha1
		}
		u.globalAlpha = 0.8;
		var r;
		for (A = 0; A < y.length; A++) {
			r = this._getPositionByAngle(y[A], D, g, o);
			this._drawLine(u, D, g, r.x, r.y, this._settings.lineColor.call(this, H[A]), 2)
		}
		if (E == 1) {
			u.lineWidth = 2;
			u.strokeStyle = "#ffffff";
			u.beginPath();
			u.arc(D, g, o + 1, 0, 2 * Math.PI, false);
			u.stroke()
		}
		u.globalAlpha = 1;
		u.scale(1, 1 / E)
	},
	_getValues: function(g) {
		var a = [];
		for (var c = 0; c < g.length; c++) {
			a.push(parseFloat(this._settings.value(g[c]) || 0))
		}
		return a
	},
	_getTotalValue: function(a) {
		var g = 0;
		for (var c = 0; c < a.length; c++) {
			g += a[c]
		}
		return g
	},
	_getRatios: function(c, a) {
		var n;
		var m = [];
		var l = 0;
		a = a || this._getTotalValue(c);
		for (var g = 0; g < c.length; g++) {
			n = c[g];
			m[g] = Math.PI * 2 * (a ? ((n + l) / a) : (1 / c.length));
			l += n
		}
		return m
	},
	_getPieParameters: function(o, m) {
		var l = m.x - o.x;
		var c = m.y - o.y;
		var g = o.x + l / 2;
		var n = o.y + c / 2;
		var a = Math.min(l / 2, c / 2);
		return {
			x: g,
			y: n,
			radius: a
		}
	},
	_createLowerSector: function(l, m, o, g, a, n, c) {
		l.lineWidth = 1;
		if (!((g <= 0 && a >= 0) || (g >= 0 && a <= Math.PI) || (Math.abs(g - Math.PI) > 0.003 && g <= Math.PI && a >= Math.PI))) {
			return
		}
		if (g <= 0 && a >= 0) {
			g = 0;
			c = false;
			this._drawSectorLine(l, m, o, n, g, a)
		}
		if (g <= Math.PI && a >= Math.PI) {
			a = Math.PI;
			c = false;
			this._drawSectorLine(l, m, o, n, g, a)
		}
		var q = (this._settings.height || Math.floor(n / 4)) / this._settings.cant;
		l.beginPath();
		l.arc(m, o, n, g, a, false);
		l.lineTo(m + n * Math.cos(a), o + n * Math.sin(a) + q);
		l.arc(m, o + q, n, a, g, true);
		l.lineTo(m + n * Math.cos(g), o + n * Math.sin(g));
		l.fill();
		if (c) {
			l.stroke()
		}
	},
	_drawSectorLine: function(g, l, n, m, c, a) {
		g.beginPath();
		g.arc(l, n, m, c, a, false);
		g.stroke()
	},
	_addShadow: function(c, a, n, l) {
		c.globalAlpha = 0.5;
		var m = ["#c4c4c4", "#c6c6c6", "#cacaca", "#dcdcdc", "#dddddd", "#e0e0e0", "#eeeeee", "#f5f5f5", "#f8f8f8"];
		for (var g = m.length - 1; g > -1; g--) {
			c.beginPath();
			c.fillStyle = m[g];
			c.arc(a + 1, n + 1, l + g, 0, Math.PI * 2, true);
			c.fill()
		}
		c.globalAlpha = 1
	},
	_getGrayGradient: function(a) {
		a.addColorStop(0, "#ffffff");
		a.addColorStop(0.7, "#7a7a7a");
		a.addColorStop(1, "#000000");
		return a
	},
	_showRadialGradient: function(g, c, o, a, l, m) {
		g.beginPath();
		var n;
		if (typeof this._settings.gradient != "function") {
			n = g.createRadialGradient(l, m, a / 4, c, o, a);
			n = this._getGrayGradient(n)
		} else {
			n = this._settings.gradient(n)
		}
		g.fillStyle = n;
		g.arc(c, o, a, 0, Math.PI * 2, true);
		g.fill();
		g.globalAlpha = 0.7
	},
	_drawSectorLabel: function(F, c, l, C, A, H, w, a) {
		var v = this.canvases[0].renderText(0, 0, w, 0, 1);
		if (!v) {
			return
		}
		var I = v.scrollWidth;
		v.style.width = I + "px";
		if (I > F) {
			I = F
		}
		var D = (A - C < 0.2 ? 4 : 8);
		if (a) {
			D = I / 1.8
		}
		var g = C + (A - C) / 2;
		l = l - (D - 8) / 2;
		var q = -D;
		var o = -8;
		var E = "right";
		if (g >= Math.PI / 2 && g < Math.PI || g <= 3 * Math.PI / 2 && g >= Math.PI) {
			q = -I - q + 1;
			E = "left"
		}
		var m = 0;
		if (!a && H < 1 && (g > 0 && g < Math.PI)) {
			m = (this._settings.height || Math.floor(l / 4)) / H
		}
		var r = (c + Math.floor((l + m) * Math.sin(g))) * H + o;
		var s = F + Math.floor((l + D / 2) * Math.cos(g)) + q;
		var n = (A < Math.PI / 2 + 0.01);
		var u = (C < Math.PI / 2);
		if (u && n) {
			s = Math.max(s, F + 3)
		} else {
			if (!u && !n) {
				s = Math.min(s, F - I)
			} else {
				if (!a && (g >= Math.PI / 2 && g < Math.PI || g <= 3 * Math.PI / 2 && g >= Math.PI)) {
					s += I / 3
				}
			}
		}
		v.style.top = r + "px";
		v.style.left = s + "px";
		v.style.width = I + "px";
		v.style.textAlign = E;
		v.style.whiteSpace = "nowrap"
	}
};
dhtmlx.chart.pie3D = {
	pvt_render_pie3D: function(c, l, a, n, g, m) {
		this._renderPie(c, l, a, n, this._settings.cant, m)
	}
};
dhtmlx.chart.donut = {
	pvt_render_donut: function(v, m, s, r, o, c) {
		if (!m.length) {
			return
		}
		this._renderPie(v, m, s, r, 1, c);
		var l = this._settings;
		var n = this._getPieParameters(s, r);
		var a = (l.radius ? l.radius : n.radius);
		var q = ((l.innerRadius && (l.innerRadius < a)) ? l.innerRadius : a / 3);
		var g = (l.x ? l.x : n.x);
		var u = (l.y ? l.y : n.y);
		v.fillStyle = "#ffffff";
		v.beginPath();
		v.arc(g, u, q, 0, Math.PI * 2, true);
		v.fill()
	}
};
dhtmlx.DataDriver.dhtmlxgrid = {
	_grid_getter: "_get_cell_value",
	toObject: function(a) {
		this._grid = a;
		return a
	},
	getRecords: function(a) {
		return a.rowsBuffer
	},
	getDetails: function(g) {
		var a = {};
		for (var c = 0; c < this._grid.getColumnsNum(); c++) {
			a["data" + c] = this._grid[this._grid_getter](g, c)
		}
		return a
	},
	getInfo: function(a) {
		return {
			_size: 0,
			_from: 0
		}
	}
};
dhtmlx.ui.Canvas = function(c, g, m) {
	this._canvas_labels = [];
	this._canvas_name = g;
	this._obj = c;
	var l = c.offsetWidth * (window.devicePixelRatio || 1);
	var a = c.offsetHeight * (window.devicePixelRatio || 1);
	var m = m || "";
	m += ";width:" + c.offsetWidth + "px;height:" + c.offsetHeight + "px;";
	this._prepareCanvas(g, m, l, a)
};
dhtmlx.ui.Canvas.prototype = {
	_prepareCanvas: function(c, l, g, a) {
		this._canvas = dhtmlx.html.create("canvas", {
			width: g,
			height: a,
			canvas_id: c,
			style: (l || "")
		});
		this._obj.appendChild(this._canvas);
		if (!this._canvas.getContext) {
			if (dhtmlx._isIE) {
				dhtmlx.require("thirdparty/excanvas/excanvas.js");
				G_vmlCanvasManager.init_(document);
				G_vmlCanvasManager.initElement(this._canvas)
			} else {
				dhtmlx.error("Canvas is not supported in the current browser")
			}
		}
		return this._canvas
	},
	getCanvas: function(c) {
		var a = (this._canvas || this._prepareCanvas()).getContext(c || "2d");
		if (!this._webixDevicePixelRatio) {
			this._webixDevicePixelRatio = true;
			a.scale(window.devicePixelRatio || 1, window.devicePixelRatio || 1)
		}
		return a
	},
	_resizeCanvas: function() {
		if (this._canvas) {
			var a = this._canvas.parentNode.offsetWidth;
			var c = this._canvas.parentNode.offsetHeight;
			this._canvas.setAttribute("width", a * (window.devicePixelRatio || 1));
			this._canvas.setAttribute("height", c * (window.devicePixelRatio || 1));
			this._canvas.style.width = a + "px";
			this._canvas.style.height = c + "px";
			this._webixDevicePixelRatio = false
		}
	},
	renderText: function(a, n, m, l, c) {
		if (!m) {
			return
		}
		var g = dhtmlx.html.create("DIV", {
			"class": "dhx_canvas_text" + (l ? (" " + l) : ""),
			style: "left:" + a + "px; top:" + n + "px;"
		}, m);
		this._obj.appendChild(g);
		this._canvas_labels.push(g);
		if (c) {
			g.style.width = c + "px"
		}
		return g
	},
	renderTextAt: function(m, r, a, q, l, o, g) {
		var n = this.renderText.call(this, a, q, l, o, g);
		if (n) {
			if (m) {
				if (m == "middle") {
					n.style.top = parseInt(q - n.offsetHeight / 2, 10) + "px"
				} else {
					n.style.top = q - n.offsetHeight + "px"
				}
			}
			if (r) {
				if (r == "left") {
					n.style.left = a - n.offsetWidth + "px"
				} else {
					n.style.left = parseInt(a - n.offsetWidth / 2, 10) + "px"
				}
			}
		}
		return n
	},
	clearCanvas: function(a) {
		var c = [],
			g;
		for (g = 0; g < this._canvas_labels.length; g++) {
			this._obj.removeChild(this._canvas_labels[g])
		}
		this._canvas_labels = [];
		if (!a && this._obj._htmlmap) {
			c = this._getMapAreas();
			while (c.length) {
				c[0].parentNode.removeChild(c[0]);
				c.splice(0, 1)
			}
			c = null;
			if (!this._obj._htmlmap.getElementsByTagName("AREA").length) {
				this._obj._htmlmap.parentNode.removeChild(this._obj._htmlmap);
				this._obj._htmlmap = null
			}
		}
		this.getCanvas().clearRect(0, 0, this._obj.offsetWidth * (window.devicePixelRatio || 1), this._obj.offsetWidth * (window.devicePixelRatio || 1))
	},
	toggleCanvas: function() {
		this._toggleCanvas(this._canvas.style.display == "none")
	},
	showCanvas: function() {
		this._toggleCanvas(true)
	},
	hideCanvas: function() {
		this._toggleCanvas(false)
	},
	_toggleCanvas: function(a) {
		var c, g;
		for (g = 0; g < this._canvas_labels.length; g++) {
			this._canvas_labels[g].style.display = (a ? "" : "none")
		}
		if (this._obj._htmlmap) {
			c = this._getMapAreas();
			for (g = 0; g < c.length; g++) {
				if (a) {
					c[g].removeAttribute("disabled")
				} else {
					c[g].setAttribute("disabled", "true")
				}
			}
		}
		this._canvas.style.display = (a ? "" : "none")
	},
	_getMapAreas: function() {
		var g = [],
			a, c;
		a = this._obj._htmlmap.getElementsByTagName("AREA");
		for (c = 0; c < a.length; c++) {
			if (a[c].getAttribute("userdata") == this._canvas_name) {
				g.push(a[c])
			}
		}
		return g
	}
};
dhtmlXChart = function(a) {
	this.name = "Chart";
	this.version = "3.0";
	if (dhtmlx.assert_enabled()) {
		this._assert()
	}
	dhtmlx.extend(this, dhtmlx.Settings);
	this._parseContainer(a, "dhx_chart");
	dhtmlx.extend(this, dhtmlx.AtomDataLoader);
	dhtmlx.extend(this, dhtmlx.DataLoader);
	this.data.provideApi(this, true);
	dhtmlx.extend(this, dhtmlx.EventSystem);
	dhtmlx.extend(this, dhtmlx.MouseEvents);
	dhtmlx.extend(this, dhtmlx.Destruction);
	dhtmlx.extend(this, dhtmlx.Group);
	dhtmlx.extend(this, dhtmlx.AutoTooltip);
	for (var c in dhtmlx.chart) {
		dhtmlx.extend(this, dhtmlx.chart[c])
	}
	if (a.preset) {
		this.definePreset(a)
	}
	this._parseSettings(a, this.defaults);
	this._series = [this._settings];
	this.data.attachEvent("onStoreUpdated", dhtmlx.bind(function() {
		this.render()
	}, this));
	this.attachEvent("onLocateData", this._switchSerie)
};
dhtmlXChart.prototype = {
	_id: "dhx_area_id",
	on_click: {
		dhx_chart_legend_item: function(n, o, m) {
			var l = m.getAttribute("series_id");
			if (this.callEvent("onLegendClick", [n, l, m])) {
				var g = this._settings;
				var c = g.legend.values;
				var a = (c && (typeof c[l].toggle != "undefined")) ? c[l].toggle : g.legend.toggle;
				if ((typeof l != "undefined") && this._series.length > 1) {
					if (a) {
						if (m.className.indexOf("hidden") != -1) {
							this.showSeries(l)
						} else {
							this.hideSeries(l)
						}
					}
				}
			}
		}
	},
	on_dblclick: {},
	on_mouse_move: {},
	bind: function() {
		dhx.BaseBind.legacyBind.apply(this, arguments)
	},
	sync: function() {
		dhx.BaseBind.legacySync.apply(this, arguments)
	},
	resize: function() {
		for (var a in this.canvases) {
			this.canvases[a]._resizeCanvas()
		}
		this.render()
	},
	view_setter: function(a) {
		if (!dhtmlx.chart[a]) {
			dhtmlx.error("Chart type extension is not loaded: " + a)
		}
		if (typeof this._settings.offset == "undefined") {
			this._settings.offset = !(a == "area" || a == "stackedArea")
		}
		if (a == "radar" && !this._settings.yAxis) {
			this.define("yAxis", {})
		}
		if (a == "scatter") {
			if (!this._settings.yAxis) {
				this.define("yAxis", {})
			}
			if (!this._settings.xAxis) {
				this.define("xAxis", {})
			}
		}
		return a
	},
	clearCanvas: function() {
		if (this.canvases && typeof this.canvases == "object") {
			for (var a in this.canvases) {
				this.canvases[a].clearCanvas()
			}
		}
	},
	render: function() {
		var g, c, l, m, a;
		if (!this.callEvent("onBeforeRender", [this.data])) {
			return
		}
		if (this.canvases && typeof this.canvases == "object") {
			for (c in this.canvases) {
				this.canvases[c].clearCanvas()
			}
		} else {
			this.canvases = {}
		}
		if (this._settings.legend) {
			if (!this.canvases.legend) {
				this.canvases.legend = new dhtmlx.ui.Canvas(this._obj, "legend")
			}
			this._drawLegend(this.data.getRange(), this._obj.offsetWidth)
		}
		g = this._getChartBounds(this._obj.offsetWidth, this._obj.offsetHeight);
		m = new dhtmlx.ui.Map(this._id);
		a = this._settings;
		l = this._getChartData();
		for (c = 0; c < this._series.length; c++) {
			this._settings = this._series[c];
			if (!this.canvases[c]) {
				this.canvases[c] = new dhtmlx.ui.Canvas(this._obj, c, "z-index:" + (2 + c))
			}
			this["pvt_render_" + this._settings.view](this.canvases[c].getCanvas(), l, g.start, g.end, c, m)
		}
		m.render(this._obj);
		this._obj.lastChild.style.zIndex = 1000;
		this._applyBounds(this._obj.lastChild, g);
		this.callEvent("onAfterRender", []);
		this._settings = a
	},
	_applyBounds: function(g, c) {
		var a = {};
		a.left = c.start.x;
		a.top = c.start.y;
		a.width = c.end.x - c.start.x;
		a.height = c.end.y - c.start.y;
		for (var l in a) {
			g.style[l] = a[l] + "px"
		}
	},
	_getChartData: function() {
		var l, o, g, m, n, s, a, q, r, c;
		m = this.data.getRange();
		l = (this._settings.view.toLowerCase().indexOf("barh") != -1 ? "yAxis" : "xAxis");
		o = this._settings[l];
		if (o && o.units && (typeof o.units == "object")) {
			g = o.units;
			q = [];
			if (typeof g.start != "undefined" && typeof g.end != "undefined" && typeof g.next != "undefined") {
				a = g.start;
				while (a <= g.end) {
					q.push(a);
					a = g.next.call(this, a)
				}
			} else {
				if (Object.prototype.toString.call(g) === "[object Array]") {
					q = g
				}
			}
			s = [];
			if (q.length) {
				r = o.value;
				c = {};
				for (n = 0; n < m.length; n++) {
					c[r(m[n])] = n
				}
				for (n = 0; n < q.length; n++) {
					if (typeof c[q[n]] != "undefined") {
						m[c[q[n]]].$unit = q[n];
						s.push(m[c[q[n]]])
					} else {
						s.push({
							$unit: q[n]
						})
					}
				}
			}
			return s
		}
		return m
	},
	value_setter: dhtmlx.Template.obj_setter,
	xValue_setter: dhtmlx.Template.obj_setter,
	yValue_setter: function(a) {
		this.define("value", a)
	},
	alpha_setter: dhtmlx.Template.obj_setter,
	label_setter: dhtmlx.Template.obj_setter,
	lineColor_setter: dhtmlx.Template.obj_setter,
	borderColor_setter: dhtmlx.Template.obj_setter,
	pieInnerText_setter: dhtmlx.Template.obj_setter,
	gradient_setter: function(a) {
		if ((typeof(a) != "function") && a && (a === true)) {
			a = "light"
		}
		return a
	},
	colormap: {
		RAINBOW: function(a) {
			var c = Math.floor(this.indexById(a.id) / this.dataCount() * 1536);
			if (c == 1536) {
				c -= 1
			}
			return this._rainbow[Math.floor(c / 256)](c % 256)
		}
	},
	color_setter: function(a) {
		return this.colormap[a] || dhtmlx.Template.obj_setter(a)
	},
	fill_setter: function(a) {
		return ((!a || a == 0) ? false : dhtmlx.Template.obj_setter(a))
	},
	definePreset: function(a) {
		this.define("preset", a.preset);
		delete a.preset
	},
	preset_setter: function(m) {
		var g, c, l;
		this.defaults = dhtmlx.extend({}, this.defaults);
		if (typeof dhtmlx.presets.chart[m] == "object") {
			l = dhtmlx.presets.chart[m];
			for (g in l) {
				if (typeof l[g] == "object") {
					if (!this.defaults[g] || typeof this.defaults[g] != "object") {
						this.defaults[g] = dhtmlx.extend({}, l[g])
					} else {
						this.defaults[g] = dhtmlx.extend({}, this.defaults[g]);
						for (c in l[g]) {
							this.defaults[g][c] = l[g][c]
						}
					}
				} else {
					this.defaults[g] = l[g]
				}
			}
			return m
		}
		return false
	},
	legend_setter: function(a) {
		if (!a) {
			if (this.legendObj) {
				this.legendObj.innerHTML = "";
				this.legendObj = null
			}
			return false
		}
		if (typeof(a) != "object") {
			a = {
				template: a
			}
		}
		this._mergeSettings(a, {
			width: 150,
			height: 18,
			layout: "y",
			align: "left",
			valign: "bottom",
			template: "",
			toggle: (this._settings.view.toLowerCase().indexOf("stacked") != -1 ? "" : "hide"),
			marker: {
				type: "square",
				width: 15,
				height: 15,
				radius: 3
			},
			margin: 4,
			padding: 3
		});
		a.template = dhtmlx.Template.setter(a.template);
		return a
	},
	defaults: {
		color: "RAINBOW",
		alpha: "1",
		label: false,
		value: "{obj.value}",
		padding: {},
		view: "pie",
		lineColor: "#ffffff",
		cant: 0.5,
		width: 30,
		labelWidth: 100,
		line: {
			width: 2,
			color: "#1293f8"
		},
		item: {
			radius: 3,
			borderColor: "#636363",
			borderWidth: 1,
			color: "#ffffff",
			alpha: 1,
			type: "r",
			shadow: false
		},
		shadow: true,
		gradient: false,
		border: true,
		labelOffset: 20,
		origin: "auto"
	},
	item_setter: function(a) {
		if (typeof(a) != "object") {
			a = {
				color: a,
				borderColor: a
			}
		}
		this._mergeSettings(a, dhtmlx.extend({}, this.defaults.item));
		var g = ["alpha", "borderColor", "color", "radius"];
		for (var c = 0; c < g.length; c++) {
			a[g[c]] = dhtmlx.Template.setter(a[g[c]])
		}
		return a
	},
	line_setter: function(a) {
		if (typeof(a) != "object") {
			a = {
				color: a
			}
		}
		dhtmlx.extend(this.defaults.line, a);
		a = dhtmlx.extend({}, this.defaults.line);
		a.color = dhtmlx.Template.setter(a.color);
		return a
	},
	padding_setter: function(a) {
		if (typeof(a) != "object") {
			a = {
				left: a,
				right: a,
				top: a,
				bottom: a
			}
		}
		this._mergeSettings(a, {
			left: 50,
			right: 20,
			top: 35,
			bottom: 40
		});
		return a
	},
	xAxis_setter: function(a) {
		if (!a) {
			return false
		}
		if (typeof(a) != "object") {
			a = {
				template: a
			}
		}
		if (!a.value) {
			a.value = a.template
		}
		this._mergeSettings(a, {
			title: "",
			color: "#000000",
			lineColor: "#cfcfcf",
			template: "{obj}",
			value: "{obj}",
			lines: true
		});
		var c = ["lineColor", "template", "lines", "value"];
		this._converToTemplate(c, a);
		this._configXAxis = dhtmlx.extend({}, a);
		return a
	},
	yAxis_setter: function(a) {
		this._mergeSettings(a, {
			title: "",
			color: "#000000",
			lineColor: "#cfcfcf",
			template: "{obj}",
			lines: true,
			bg: "#ffffff"
		});
		var c = ["lineColor", "template", "lines", "bg"];
		this._converToTemplate(c, a);
		this._configYAxis = dhtmlx.extend({}, a);
		return a
	},
	_converToTemplate: function(a, c) {
		for (var g = 0; g < a.length; g++) {
			c[a[g]] = dhtmlx.Template.setter(c[a[g]])
		}
	},
	_drawScales: function(m, l, g, o, a, c) {
		var n = 0;
		if (this._settings.yAxis) {
			if (!this.canvases.y) {
				this.canvases.y = new dhtmlx.ui.Canvas(this._obj, "axis_y")
			}
			n = this._drawYAxis(this.canvases.y.getCanvas(), m, l, g, o, a)
		}
		if (this._settings.xAxis) {
			if (!this.canvases.x) {
				this.canvases.x = new dhtmlx.ui.Canvas(this._obj, "axis_x")
			}
			this._drawXAxis(this.canvases.x.getCanvas(), m, l, g, c, n)
		}
		return n
	},
	_drawXAxis: function(w, n, u, s, l, r) {
		var g = u.x - 0.5;
		var v = parseInt((r ? r : s.y), 10) + 0.5;
		var c = s.x;
		var o;
		var a = true;
		for (var m = 0; m < n.length; m++) {
			if (this._settings.offset === true) {
				o = g + l / 2 + m * l
			} else {
				o = (m == n.length - 1) ? s.x : g + m * l;
				a = !!m
			}
			o = Math.ceil(o) - 0.5;
			var q = ((this._settings.origin != "auto") && (this._settings.view == "bar") && (parseFloat(this._settings.value(n[m])) < this._settings.origin));
			this._drawXAxisLabel(o, v, n[m], a, q);
			if ((this._settings.offset || m) && this._settings.xAxis.lines.call(this, n[m])) {
				this._drawXAxisLine(w, o, s.y, u.y, n[m])
			}
		}
		this.canvases.x.renderTextAt(true, false, g, s.y + this._settings.padding.bottom - 3, this._settings.xAxis.title, "dhx_axis_title_x", s.x - u.x);
		this._drawLine(w, g, v, c, v, this._settings.xAxis.color, 1);
		if (!this._settings.xAxis.lines.call(this, {}) || !this._settings.offset) {
			return
		}
		this._drawLine(w, c + 0.5, s.y, c + 0.5, u.y + 0.5, this._settings.xAxis.color, 0.2)
	},
	_drawYAxis: function(y, F, n, m, q, o) {
		var r;
		var w = {};
		if (!this._settings.yAxis) {
			return
		}
		var C = n.x - 0.5;
		var l = m.y;
		var g = n.y;
		var x = m.y;
		if (this._settings.yAxis.step) {
			r = parseFloat(this._settings.yAxis.step)
		}
		if (typeof this._configYAxis.step == "undefined" || typeof this._configYAxis.start == "undefined" || typeof this._configYAxis.end == "undefined") {
			w = this._calculateScale(q, o);
			q = w.start;
			o = w.end;
			r = w.step;
			this._settings.yAxis.end = o;
			this._settings.yAxis.start = q
		}
		this._setYAxisTitle(n, m);
		if (r === 0) {
			o = q;
			r = 1
		}
		var a = (o == q ? l - g : (l - g) * r / (o - q));
		var D = 0;
		for (var A = q; A <= o; A += r) {
			if (w.fixNum) {
				A = parseFloat((new Number(A)).toFixed(w.fixNum))
			}
			var E = Math.floor(l - D * a) + 0.5;
			if (!(A == q && this._settings.origin == "auto") && this._settings.yAxis.lines.call(this, A)) {
				this._drawLine(y, C, E, m.x, E, this._settings.yAxis.lineColor.call(this, A), 1)
			}
			if (A == this._settings.origin) {
				x = E
			}
			var s = A;
			if (r < 1) {
				var u = Math.min(this._log10(r), (q <= 0 ? 0 : this._log10(q)));
				var v = Math.pow(10, -u);
				s = Math.round(A * v) / v;
				A = s
			}
			this.canvases.y.renderText(0, E - 5, this._settings.yAxis.template(s.toString()), "dhx_axis_item_y", n.x - 5);
			D++
		}
		this._drawLine(y, C, l + 1, C, g, this._settings.yAxis.color, 1);
		return x
	},
	_setYAxisTitle: function(g, c) {
		var a = "dhx_axis_title_y" + (dhtmlx._isIE && dhtmlx._isIE != 9 ? " dhx_ie_filter" : "");
		var l = this.canvases.y.renderTextAt("middle", false, 0, parseInt((c.y - g.y) / 2 + g.y, 10), this._settings.yAxis.title, a);
		if (l) {
			l.style.left = (dhtmlx.env.transform ? (l.offsetHeight - l.offsetWidth) / 2 : 0) + "px"
		}
	},
	_calculateScale: function(s, c) {
		if (this._settings.origin != "auto" && this._settings.origin < s) {
			s = this._settings.origin
		}
		var m, l, o;
		m = ((c - s) / 8) || 1;
		var g = Math.floor(this._log10(m));
		var a = Math.pow(10, g);
		var n = m / a;
		n = (n > 5 ? 10 : 5);
		m = parseInt(n, 10) * a;
		if (m > Math.abs(s)) {
			l = (s < 0 ? -m : 0)
		} else {
			var u = Math.abs(s);
			var r = Math.floor(this._log10(u));
			var q = u / Math.pow(10, r);
			l = Math.ceil(q * 10) / 10 * Math.pow(10, r) - m;
			if (u > 1 && m > 0.1) {
				l = Math.ceil(l)
			}
			while (s < 0 ? l <= s : l >= s) {
				l -= m
			}
			if (s < 0) {
				l = -l - 2 * m
			}
		}
		o = l;
		while (o < c) {
			o += m;
			o = parseFloat((new Number(o)).toFixed(Math.abs(g)))
		}
		return {
			start: l,
			end: o,
			step: m,
			fixNum: Math.abs(g)
		}
	},
	_getLimits: function(c, o) {
		var q, n;
		var m = ((arguments.length && c == "h") ? this._configXAxis : this._configYAxis);
		o = o || "value";
		if (m && (typeof m.end != "undefined") && (typeof m.start != "undefined") && m.step) {
			q = parseFloat(m.end);
			n = parseFloat(m.start)
		} else {
			q = this.max(this._series[0][o]);
			n = (m && (typeof m.start != "undefined")) ? parseFloat(m.start) : this.min(this._series[0][o]);
			if (this._series.length > 1) {
				for (var l = 1; l < this._series.length; l++) {
					var a = this.max(this._series[l][o]);
					var g = this.min(this._series[l][o]);
					if (a > q) {
						q = a
					}
					if (g < n) {
						n = g
					}
				}
			}
		}
		return {
			max: q,
			min: n
		}
	},
	_log10: function(c) {
		var a = "log";
		return Math.floor((Math[a](c) / Math.LN10))
	},
	_drawXAxisLabel: function(c, n, m, a, l) {
		if (!this._settings.xAxis) {
			return
		}
		var g = this.canvases.x.renderTextAt(l, a, c, n - (l ? 2 : 0), this._settings.xAxis.template(m));
		if (g) {
			g.className += " dhx_axis_item_x"
		}
	},
	_drawXAxisLine: function(c, a, l, g, m) {
		if (!this._settings.xAxis || !this._settings.xAxis.lines) {
			return
		}
		this._drawLine(c, a, l, a, g, this._settings.xAxis.lineColor.call(this, m), 1)
	},
	_drawLine: function(a, l, o, g, m, c, n) {
		a.strokeStyle = c;
		a.lineWidth = n;
		a.beginPath();
		a.moveTo(l, o);
		a.lineTo(g, m);
		a.stroke();
		a.lineWidth = 1
	},
	_getRelativeValue: function(l, m) {
		var g, a;
		var c = 1;
		if (m != l) {
			g = m - l
		} else {
			g = l
		}
		return [g, c]
	},
	_rainbow: [function(a) {
		return "#FF" + dhtmlx.math.toHex(a / 2, 2) + "00"
	}, function(a) {
		return "#FF" + dhtmlx.math.toHex(a / 2 + 128, 2) + "00"
	}, function(a) {
		return "#" + dhtmlx.math.toHex(255 - a, 2) + "FF00"
	}, function(a) {
		return "#00FF" + dhtmlx.math.toHex(a, 2)
	}, function(a) {
		return "#00" + dhtmlx.math.toHex(255 - a, 2) + "FF"
	}, function(a) {
		return "#" + dhtmlx.math.toHex(a, 2) + "00FF"
	}],
	addSeries: function(c) {
		var a = this._settings;
		this._settings = dhtmlx.extend({}, a);
		this._parseSettings(c, {});
		this._series.push(this._settings);
		this._settings = a
	},
	_switchSerie: function(l, a) {
		var g;
		this._active_serie = a.getAttribute("userdata");
		if (!this._series[this._active_serie]) {
			return
		}
		for (var c = 0; c < this._series.length; c++) {
			g = this._series[c].tooltip;
			if (g) {
				g.disable()
			}
		}
		if (!a.getAttribute("disabled")) {
			g = this._series[this._active_serie].tooltip;
			if (g) {
				g.enable()
			}
		}
	},
	hideSeries: function(a) {
		this.canvases[a].hideCanvas();
		if (this._settings.legend.values && this._settings.legend.values[a]) {
			this._settings.legend.values[a].$hidden = true
		}
		this._drawLegend()
	},
	showSeries: function(a) {
		this.canvases[a].showCanvas();
		if (this._settings.legend.values && this._settings.legend.values[a]) {
			delete this._settings.legend.values[a].$hidden
		}
		this._drawLegend()
	},
	_setBorderStyles: function(a, c) {
		var l, g;
		g = dhtmlx.math.toRgb(c);
		l = dhtmlx.math.rgbToHsv(g[0], g[1], g[2]);
		l[2] /= 2;
		c = "rgb(" + dhtmlx.math.hsvToRgb(l[0], l[1], l[2]) + ")";
		a.strokeStyle = c;
		if (a.globalAlpha == 1) {
			a.globalAlpha = 0.9
		}
	},
	_drawLegend: function(l, c) {
		var m, s, C, u, n, v, a, q = 0,
			o = 0,
			A, r, g, w;
		l = l || [];
		c = c || this._obj.offsetWidth;
		A = this.canvases.legend.getCanvas();
		s = this._settings.legend;
		a = (this._settings.legend.layout != "x" ? "width:" + s.width + "px" : "");
		if (this.legendObj) {
			this.legendObj.innerHTML = "";
			this.legendObj.parentNode.removeChild(this.legendObj)
		}
		this.canvases.legend.clearCanvas(true);
		C = dhtmlx.html.create("DIV", {
			"class": "dhx_chart_legend",
			style: "left:" + q + "px; top:" + o + "px;" + a
		}, "");
		if (s.padding) {
			C.style.padding = s.padding + "px"
		}
		this.legendObj = C;
		this._obj.appendChild(C);
		n = [];
		if (!s.values) {
			for (m = 0; m < l.length; m++) {
				n.push(this._drawLegendText(C, s.template(l[m])))
			}
		} else {
			for (m = 0; m < s.values.length; m++) {
				n.push(this._drawLegendText(C, s.values[m].text, (typeof s.values[m].id != "undefined" ? typeof s.values[m].id : m), s.values[m].$hidden))
			}
		}
		v = C.offsetWidth;
		u = C.offsetHeight;
		if (v < this._obj.offsetWidth) {
			if (s.layout == "x" && s.align == "center") {
				q = (this._obj.offsetWidth - v) / 2
			}
			if (s.align == "right") {
				q = this._obj.offsetWidth - v
			}
			if (s.margin && s.align != "center") {
				q += (s.align == "left" ? 1 : -1) * s.margin
			}
		}
		if (u < this._obj.offsetHeight) {
			if (s.valign == "middle" && s.align != "center" && s.layout != "x") {
				o = (this._obj.offsetHeight - u) / 2
			} else {
				if (s.valign == "bottom") {
					o = this._obj.offsetHeight - u
				}
			}
			if (s.margin && s.valign != "middle") {
				o += (s.valign == "top" ? 1 : -1) * s.margin
			}
		}
		C.style.left = q + "px";
		C.style.top = o + "px";
		A.save();
		for (m = 0; m < n.length; m++) {
			w = n[m];
			if (s.values && s.values[m].$hidden) {
				g = true;
				r = (s.values[m].disableColor ? s.values[m].disableColor : "#d9d9d9")
			} else {
				g = false;
				r = (s.values ? s.values[m].color : this._settings.color.call(this, l[m]))
			}
			this._drawLegendMarker(A, w.offsetLeft + q, w.offsetTop + o, r, w.offsetHeight, g, m)
		}
		A.restore();
		n = null
	},
	_drawLegendText: function(a, m, c, l) {
		var g = "";
		if (this._settings.legend.layout == "x") {
			g = "float:left;"
		}
		var n = dhtmlx.html.create("DIV", {
			style: g + "padding-left:" + (10 + this._settings.legend.marker.width) + "px",
			"class": "dhx_chart_legend_item" + (l ? " hidden" : "")
		}, m);
		if (arguments.length > 2) {
			n.setAttribute("series_id", c)
		}
		a.appendChild(n);
		return n
	},
	_drawLegendMarker: function(D, v, u, m, C, n, q) {
		var c = [];
		var o = this._settings.legend.marker;
		var A = this._settings.legend.values;
		var s = (A && A[q].markerType ? A[q].markerType : o.type);
		if (m) {
			D.fillStyle = m;
			D.strokeStyle = this._getDarkenColor(m, 0.75)
		}
		D.beginPath();
		if (s == "round" || !o.radius) {
			D.lineWidth = o.height;
			D.lineCap = s;
			v += D.lineWidth / 2 + 5;
			u += C / 2;
			D.moveTo(v, u);
			var a = v + o.width - o.height + 1;
			D.lineTo(a, u)
		} else {
			if (s == "item") {
				if (this._settings.line && this._settings.view != "scatter" && !this._settings.disableLines) {
					D.beginPath();
					D.lineWidth = this._series[q].line.width;
					D.strokeStyle = n ? m : this._series[q].line.color.call(this, {});
					var g = v + 5;
					var w = u + C / 2;
					D.moveTo(g, w);
					var a = g + o.width;
					D.lineTo(a, w);
					D.stroke()
				}
				var l = this._series[q].item;
				var r = parseInt(l.radius.call(this, {}), 10) || 0;
				if (r) {
					D.beginPath();
					if (n) {
						D.lineWidth = l.borderWidth;
						D.strokeStyle = m;
						D.fillStyle = m
					} else {
						D.lineWidth = l.borderWidth;
						D.fillStyle = l.color.call(this, {});
						D.strokeStyle = l.borderColor.call(this, {});
						D.globalAlpha = l.alpha.call(this, {})
					}
					D.beginPath();
					v += o.width / 2 + 5;
					u += C / 2;
					this._strokeChartItem(D, v, u, r + 1, l.type);
					D.fill();
					D.stroke()
				}
				D.globalAlpha = 1
			} else {
				D.lineWidth = 1;
				v += 5;
				u += parseInt(C / 2 - o.height / 2, 10);
				c = [
					[v + o.radius, u + o.radius, o.radius, Math.PI, 3 * Math.PI / 2, false],
					[v + o.width - o.radius, u],
					[v + o.width - o.radius, u + o.radius, o.radius, -Math.PI / 2, 0, false],
					[v + o.width, u + o.height - o.radius],
					[v + o.width - o.radius, u + o.height - o.radius, o.radius, 0, Math.PI / 2, false],
					[v + o.radius, u + o.height],
					[v + o.radius, u + o.height - o.radius, o.radius, Math.PI / 2, Math.PI, false],
					[v, u + o.radius]
				];
				this._path(D, c)
			}
		}
		D.stroke();
		D.fill()
	},
	_getDarkenColor: function(a, l) {
		var g, c;
		c = dhtmlx.math.toRgb(a);
		g = dhtmlx.math.rgbToHsv(c[0], c[1], c[2]);
		g[2] = g[2] * l;
		return "rgb(" + dhtmlx.math.hsvToRgb(g[0], g[1], g[2]) + ")"
	},
	_getChartBounds: function(a, o) {
		var r, g, q, c;
		r = this._settings.padding.left;
		g = this._settings.padding.top;
		q = a - this._settings.padding.right;
		c = o - this._settings.padding.bottom;
		if (this._settings.legend) {
			var m = this._settings.legend;
			var n = this._settings.legend.width;
			var l = this._settings.legend.height;
			if (m.layout == "x") {
				if (m.valign == "center") {
					if (m.align == "right") {
						q -= n
					} else {
						if (m.align == "left") {
							r += n
						}
					}
				} else {
					if (m.valign == "bottom") {
						c -= l
					} else {
						g += l
					}
				}
			} else {
				if (m.align == "right") {
					q -= n
				} else {
					if (m.align == "left") {
						r += n
					}
				}
			}
		}
		return {
			start: {
				x: r,
				y: g
			},
			end: {
				x: q,
				y: c
			}
		}
	},
	_getStackedLimits: function(m) {
		var c, a, n, l, g;
		if (this._settings.yAxis && (typeof this._settings.yAxis.end != "undefined") && (typeof this._settings.yAxis.start != "undefined") && this._settings.yAxis.step) {
			n = parseFloat(this._settings.yAxis.end);
			l = parseFloat(this._settings.yAxis.start)
		} else {
			for (c = 0; c < m.length; c++) {
				m[c].$sum = 0;
				m[c].$min = Infinity;
				for (a = 0; a < this._series.length; a++) {
					g = parseFloat(this._series[a].value(m[c]) || 0);
					if (isNaN(g)) {
						continue
					}
					if (this._series[a].view.toLowerCase().indexOf("stacked") != -1) {
						m[c].$sum += g
					}
					if (g < m[c].$min) {
						m[c].$min = g
					}
				}
			}
			n = -Infinity;
			l = Infinity;
			for (c = 0; c < m.length; c++) {
				if (m[c].$sum > n) {
					n = m[c].$sum
				}
				if (m[c].$min < l) {
					l = m[c].$min
				}
			}
			if (l > 0) {
				l = 0
			}
		}
		return {
			max: n,
			min: l
		}
	},
	_setBarGradient: function(x, c, u, a, r, q, l, g) {
		var s, m, o, n, w, v;
		if (q == "light") {
			if (g == "x") {
				s = x.createLinearGradient(c, u, a, u)
			} else {
				s = x.createLinearGradient(c, u, c, r)
			}
			v = [
				[0, "#FFFFFF"],
				[0.9, l],
				[1, l]
			];
			m = 2
		} else {
			if (q == "falling" || q == "rising") {
				if (g == "x") {
					s = x.createLinearGradient(c, u, a, u)
				} else {
					s = x.createLinearGradient(c, u, c, r)
				}
				o = dhtmlx.math.toRgb(l);
				n = dhtmlx.math.rgbToHsv(o[0], o[1], o[2]);
				n[1] *= 1 / 2;
				w = "rgb(" + dhtmlx.math.hsvToRgb(n[0], n[1], n[2]) + ")";
				if (q == "falling") {
					v = [
						[0, w],
						[0.7, l],
						[1, l]
					]
				} else {
					if (q == "rising") {
						v = [
							[0, l],
							[0.3, l],
							[1, w]
						]
					}
				}
				m = 0
			} else {
				x.globalAlpha = 0.37;
				m = 0;
				if (g == "x") {
					s = x.createLinearGradient(c, r, c, u)
				} else {
					s = x.createLinearGradient(c, u, a, u)
				}
				v = [
					[0, "#9d9d9d"],
					[0.3, "#e8e8e8"],
					[0.45, "#ffffff"],
					[0.55, "#ffffff"],
					[0.7, "#e8e8e8"],
					[1, "#9d9d9d"]
				]
			}
		}
		this._gradient(s, v);
		return {
			gradient: s,
			offset: m
		}
	},
	_getPositionByAngle: function(g, c, m, l) {
		g *= (-1);
		c = c + Math.cos(g) * l;
		m = m - Math.sin(g) * l;
		return {
			x: c,
			y: m
		}
	},
	_gradient: function(g, c) {
		for (var a = 0; a < c.length; a++) {
			g.addColorStop(c[a][0], c[a][1])
		}
	},
	_path: function(a, g) {
		var c, l;
		for (c = 0; c < g.length; c++) {
			l = (c ? "lineTo" : "moveTo");
			if (g[c].length > 2) {
				l = "arc"
			}
			a[l].apply(a, g[c])
		}
	},
	_circle: function(c, a, l, g) {
		c.arc(a, l, g, Math.PI * 2, true)
	},
	_addMapRect: function(l, m, a, g, c) {
		l.addRect(m, [a[0].x - g.x, a[0].y - g.y, a[1].x - g.x, a[1].y - g.y], c)
	}
};
dhtmlx.compat("layout");
if (typeof(window.dhtmlXCellObject) != "undefined") {
	dhtmlXCellObject.prototype.attachChart = function(a) {
		this.callEvent("_onBeforeContentAttach", ["chart"]);
		var c = document.createElement("DIV");
		c.id = "dhxChartObj_" + window.dhx4.newId();
		c.style.width = "100%";
		c.style.height = "100%";
		document.body.appendChild(c);
		this._attachObject(c);
		a.container = c.id;
		this.dataType = "chart";
		this.dataObj = new dhtmlXChart(a);
		if (!this.dataObj.setSizes) {
			this.dataObj.setSizes = function() {
				if (this.resize) {
					this.resize()
				} else {
					this.render()
				}
			}
		}
		return this.dataObj
	}
}
dhtmlx.ui.pager = function(a) {
	this.name = "Pager";
	if (dhtmlx.assert_enabled()) {
		this._assert()
	}
	dhtmlx.extend(this, dhtmlx.Settings);
	this._parseContainer(a, "dhx_pager");
	dhtmlx.extend(this, dhtmlx.EventSystem);
	dhtmlx.extend(this, dhtmlx.SingleRender);
	dhtmlx.extend(this, dhtmlx.MouseEvents);
	this._parseSettings(a, {
		size: 10,
		page: -1,
		group: 5,
		count: 0,
		type: "default"
	});
	this.data = this._settings;
	this.refresh()
};
dhtmlx.ui.pager.prototype = {
	_id: "dhx_p_id",
	on_click: {
		dhx_pager_item: function(a, c) {
			this.select(c)
		}
	},
	select: function(a) {
		switch (a) {
			case "next":
				a = this._settings.page + 1;
				break;
			case "prev":
				a = this._settings.page - 1;
				break;
			case "first":
				a = 0;
				break;
			case "last":
				a = this._settings.limit - 1;
				break;
			default:
				break
		}
		if (a < 0) {
			a = 0
		}
		if (a >= this.data.limit) {
			a = this.data.limit - 1
		}
		if (this.callEvent("onBeforePageChange", [this._settings.page, a])) {
			this.data.page = a * 1;
			this.refresh();
			this.callEvent("onAfterPageChange", [a])
		}
	},
	types: {
		"default": {
			template: dhtmlx.Template.fromHTML("{common.pages()}"),
			pages: function(g) {
				var c = "";
				if (g.page == -1) {
					return ""
				}
				g.min = g.page - Math.round((g.group - 1) / 2);
				g.max = g.min + g.group - 1;
				if (g.min < 0) {
					g.max += g.min * (-1);
					g.min = 0
				}
				if (g.max >= g.limit) {
					g.min -= Math.min(g.min, g.max - g.limit + 1);
					g.max = g.limit - 1
				}
				for (var a = (g.min || 0); a <= g.max; a++) {
					c += this.button({
						id: a,
						index: (a + 1),
						selected: (a == g.page ? "_selected" : "")
					})
				}
				return c
			},
			page: function(a) {
				return a.page + 1
			},
			first: function() {
				return this.button({
					id: "first",
					index: " &lt;&lt; ",
					selected: ""
				})
			},
			last: function() {
				return this.button({
					id: "last",
					index: " &gt;&gt; ",
					selected: ""
				})
			},
			prev: function() {
				return this.button({
					id: "prev",
					index: "&lt;",
					selected: ""
				})
			},
			next: function() {
				return this.button({
					id: "next",
					index: "&gt;",
					selected: ""
				})
			},
			button: dhtmlx.Template.fromHTML("<div dhx_p_id='{obj.id}' class='dhx_pager_item{obj.selected}'>{obj.index}</div>")
		}
	},
	refresh: function() {
		var a = this._settings;
		a.limit = Math.ceil(a.count / a.size);
		if (a.limit && a.limit != a.old_limit) {
			a.page = Math.min(a.limit - 1, a.page)
		}
		var c = a.page;
		if (c != -1 && (c != a.old_page) || (a.limit != a.old_limit)) {
			this.render();
			this.callEvent("onRefresh", []);
			a.old_limit = a.limit;
			a.old_page = a.page
		}
	},
	template_item_start: dhtmlx.Template.fromHTML("<div>"),
	template_item_end: dhtmlx.Template.fromHTML("</div>")
};
dhtmlx.DataProcessor = {
	_dp_init: function(c) {
		var a = "_methods";
		c[a] = ["setItemStyle", "", "changeId", "remove"];
		this.attachEvent("onAfterAdd", function(g) {
			c.setUpdated(g, true, "inserted")
		});
		this.data.attachEvent("onStoreLoad", dhtmlx.bind(function(l, g) {
			if (l.getUserData) {
				l.getUserData(g, this._userdata)
			}
		}, this));
		this.attachEvent("onBeforeDelete", function(l) {
			if (c._silent_mode) {
				return true
			}
			var g = c.getState(l);
			if (g == "inserted") {
				c.setUpdated(l, false);
				return true
			}
			if (g == "deleted") {
				return false
			}
			if (g == "true_deleted") {
				return true
			}
			c.setUpdated(l, true, "deleted");
			return false
		});
		this.attachEvent("onAfterEditStop", function(g) {
			c.setUpdated(g, true, "updated")
		});
		this.attachEvent("onBindUpdate", function(g) {
			window.setTimeout(function() {
				c.setUpdated(g.id, true, "updated")
			}, 1)
		});
		a = "_getRowData";
		c[a] = function(o, g) {
			var m = this.obj.data.get(o);
			var n = {};
			for (var l in m) {
				if (l.indexOf("_") === 0) {
					continue
				}
				n[l] = m[l]
			}
			return n
		};
		a = "_clearUpdateFlag";
		c[a] = function() {};
		this._userdata = {};
		c.attachEvent("insertCallback", this._dp_callback);
		c.attachEvent("updateCallback", this._dp_callback);
		c.attachEvent("deleteCallback", function(g, l) {
			this.obj.setUserData(l, this.action_param, "true_deleted");
			this.obj.remove(l)
		});
		dhtmlx.compat("dataProcessor", c)
	},
	_dp_callback: function(a, c) {
		this.obj.data.set(c, dhtmlx.DataDriver.xml.getDetails(a.firstChild));
		this.obj.data.refresh(c)
	},
	setItemStyle: function(g, a) {
		var c = this._locateHTML(g);
		if (c) {
			c.style.cssText += ";" + a
		}
	},
	changeId: function(c, a) {
		this.data.changeId(c, a);
		this.refresh()
	},
	setUserData: function(g, a, c) {
		if (g) {
			this.data.get(g)[a] = c
		} else {
			this._userdata[a] = c
		}
	},
	getUserData: function(c, a) {
		return c ? this.data.get(c)[a] : this._userdata[a]
	}
};
(function() {
	var a = "_dp_init";
	dhtmlx.DataProcessor[a] = dhtmlx.DataProcessor._dp_init
})();
dhtmlx.compat.dnd = function() {
	if (window.dhtmlDragAndDropObject) {
		var q = "_dragged";
		var l = dhtmlDragAndDropObject.prototype.checkLanding;
		dhtmlDragAndDropObject.prototype.checkLanding = function(s, u, r) {
			l.apply(this, arguments);
			if (!r) {
				var v = dhtmlx.DragControl._drag_context = dhtmlx.DragControl._drag_context || {};
				if (!v.from) {
					v.from = this.dragStartObject
				}
				dhtmlx.DragControl._checkLand(s, u, true)
			}
		};
		var c = dhtmlDragAndDropObject.prototype.stopDrag;
		dhtmlDragAndDropObject.prototype.stopDrag = function(u, r, s) {
			if (!s) {
				if (dhtmlx.DragControl._last) {
					dhtmlx.DragControl._active = o.dragStartNode;
					dhtmlx.DragControl._stopDrag(u, true)
				}
			}
			c.apply(this, arguments)
		};
		var o = new dhtmlDragAndDropObject();
		var m = dhtmlx.DragControl._startDrag;
		dhtmlx.DragControl._startDrag = function() {
			m.apply(this, arguments);
			var v = dhtmlx.DragControl._drag_context;
			if (!v) {
				return
			}
			var u = [];
			var s = [];
			for (var r = 0; r < v.source.length; r++) {
				u[r] = {
					idd: v.source[r]
				};
				s.push(v.source[r])
			}
			o.dragStartNode = {
				parentNode: {},
				parentObject: {
					idd: u,
					id: (s.length == 1 ? s[0] : s),
					treeNod: {
						object: v.from
					}
				}
			};
			o.dragStartNode.parentObject.treeNod[q] = u;
			o.dragStartObject = v.from
		};
		var n = dhtmlx.DragControl._checkLand;
		dhtmlx.DragControl._checkLand = function(s, u, r) {
			n.apply(this, arguments);
			if (!this._last && !r) {
				s = o.checkLanding(s, u, true)
			}
		};
		var a = dhtmlx.DragControl._stopDrag;
		dhtmlx.DragControl._stopDrag = function(s, r) {
			a.apply(this, arguments);
			if (o.lastLanding && !r) {
				o.stopDrag(s, false, true)
			}
		};
		var g = dhtmlx.DragControl.getMaster;
		dhtmlx.DragControl.getMaster = function(s) {
			var u = null;
			if (s) {
				u = g.apply(this, arguments)
			}
			if (!u) {
				u = o.dragStartObject;
				var v = [];
				var w = u[q];
				for (var r = 0; r < w.length; r++) {
					v.push(w[r].idd || w[r].id)
				}
				dhtmlx.DragControl._drag_context.source = v
			}
			return u
		}
	}
};
dhtmlx.DataMove = {
	_init: function() {
		dhtmlx.assert(this.data, "DataMove :: Component doesn't have DataStore")
	},
	copy: function(c, m, a, l) {
		var g = this.get(c);
		if (!g) {
			dhtmlx.log("Warning", "Incorrect ID in DataMove::copy");
			return
		}
		if (a) {
			dhtmlx.assert(a.externalData, "DataMove :: External object doesn't support operation");
			g = a.externalData(g)
		}
		a = a || this;
		return a.add(a.externalData(g, l), m)
	},
	move: function(g, o, c, n) {
		if (g instanceof Array) {
			for (var l = 0; l < g.length; l++) {
				var a = (c || this).indexById(this.move(g[l], o, c, g[l]));
				if (g[l + 1]) {
					o = a + (this.indexById(g[l + 1]) < a ? 0 : 1)
				}
			}
			return
		}
		nid = g;
		if (o < 0) {
			dhtmlx.log("Info", "DataMove::move - moving outside of bounds is ignored");
			return
		}
		var m = this.get(g);
		if (!m) {
			dhtmlx.log("Warning", "Incorrect ID in DataMove::move");
			return
		}
		if (!c || c == this) {
			this.data.move(this.indexById(g), o)
		} else {
			dhtmlx.assert(c.externalData, "DataMove :: External object doesn't support operation");
			nid = c.add(c.externalData(m, n), o);
			this.remove(g)
		}
		return nid
	},
	moveUp: function(c, a) {
		return this.move(c, this.indexById(c) - (a || 1))
	},
	moveDown: function(c, a) {
		return this.moveUp(c, (a || 1) * -1)
	},
	moveTop: function(a) {
		return this.move(a, 0)
	},
	moveBottom: function(a) {
		return this.move(a, this.data.dataCount() - 1)
	},
	externalData: function(a, g) {
		var c = dhtmlx.extend({}, a);
		c.id = g || dhtmlx.uid();
		c.$selected = c.$template = null;
		return c
	}
};
dhtmlx.DragControl = {
	_drag_masters: dhtmlx.toArray(["dummy"]),
	addDrop: function(c, g, a) {
		c = dhtmlx.toNode(c);
		c.dhx_drop = this._getCtrl(g);
		if (a) {
			c.dhx_master = true
		}
	},
	_getCtrl: function(c) {
		c = c || dhtmlx.DragControl;
		var a = this._drag_masters.find(c);
		if (a < 0) {
			a = this._drag_masters.length;
			this._drag_masters.push(c)
		}
		return a
	},
	addDrag: function(a, c) {
		a = dhtmlx.toNode(a);
		a.dhx_drag = this._getCtrl(c);
		dhtmlx.event(a, "mousedown", this._preStart, a)
	},
	_preStart: function(a) {
		if (dhtmlx.DragControl._active) {
			dhtmlx.DragControl._preStartFalse();
			dhtmlx.DragControl.destroyDrag()
		}
		dhtmlx.DragControl._active = this;
		dhtmlx.DragControl._start_pos = {
			x: a.pageX,
			y: a.pageY
		};
		dhtmlx.DragControl._dhx_drag_mm = dhtmlx.event(document.body, "mousemove", dhtmlx.DragControl._startDrag);
		dhtmlx.DragControl._dhx_drag_mu = dhtmlx.event(document.body, "mouseup", dhtmlx.DragControl._preStartFalse);
		dhtmlx.DragControl._dhx_drag_sc = dhtmlx.event(this, "scroll", dhtmlx.DragControl._preStartFalse);
		a.cancelBubble = true;
		return false
	},
	_preStartFalse: function(a) {
		dhtmlx.DragControl._dhx_drag_mm = dhtmlx.eventRemove(dhtmlx.DragControl._dhx_drag_mm);
		dhtmlx.DragControl._dhx_drag_mu = dhtmlx.eventRemove(dhtmlx.DragControl._dhx_drag_mu);
		dhtmlx.DragControl._dhx_drag_sc = dhtmlx.eventRemove(dhtmlx.DragControl._dhx_drag_sc)
	},
	_startDrag: function(a) {
		var c = {
			x: a.pageX,
			y: a.pageY
		};
		if (Math.abs(c.x - dhtmlx.DragControl._start_pos.x) < 5 && Math.abs(c.y - dhtmlx.DragControl._start_pos.y) < 5) {
			return
		}
		dhtmlx.DragControl._preStartFalse();
		if (!dhtmlx.DragControl.createDrag(a)) {
			return
		}
		dhtmlx.DragControl.sendSignal("start");
		dhtmlx.DragControl._dhx_drag_mm = dhtmlx.event(document.body, "mousemove", dhtmlx.DragControl._moveDrag);
		dhtmlx.DragControl._dhx_drag_mu = dhtmlx.event(document.body, "mouseup", dhtmlx.DragControl._stopDrag);
		dhtmlx.DragControl._moveDrag(a)
	},
	_stopDrag: function(a) {
		dhtmlx.DragControl._dhx_drag_mm = dhtmlx.eventRemove(dhtmlx.DragControl._dhx_drag_mm);
		dhtmlx.DragControl._dhx_drag_mu = dhtmlx.eventRemove(dhtmlx.DragControl._dhx_drag_mu);
		if (dhtmlx.DragControl._last) {
			dhtmlx.DragControl.onDrop(dhtmlx.DragControl._active, dhtmlx.DragControl._last, this._landing, a);
			dhtmlx.DragControl.onDragOut(dhtmlx.DragControl._active, dhtmlx.DragControl._last, null, a)
		}
		dhtmlx.DragControl.destroyDrag();
		dhtmlx.DragControl.sendSignal("stop")
	},
	_moveDrag: function(a) {
		var c = dhtmlx.html.pos(a);
		dhtmlx.DragControl._html.style.top = c.y + dhtmlx.DragControl.top + "px";
		dhtmlx.DragControl._html.style.left = c.x + dhtmlx.DragControl.left + "px";
		if (dhtmlx.DragControl._skip) {
			dhtmlx.DragControl._skip = false
		} else {
			dhtmlx.DragControl._checkLand((a.srcElement || a.target), a)
		}
		a.cancelBubble = true;
		return false
	},
	_checkLand: function(a, c) {
		while (a && a.tagName != "BODY") {
			if (a.dhx_drop) {
				if (this._last && (this._last != a || a.dhx_master)) {
					this.onDragOut(this._active, this._last, a, c)
				}
				if (!this._last || this._last != a || a.dhx_master) {
					this._last = null;
					this._landing = this.onDragIn(dhtmlx.DragControl._active, a, c);
					if (this._landing) {
						this._last = a
					}
					return
				}
				return
			}
			a = a.parentNode
		}
		if (this._last) {
			this._last = this._landing = this.onDragOut(this._active, this._last, null, c)
		}
	},
	sendSignal: function(a) {
		dhtmlx.DragControl.active = (a == "start")
	},
	getMaster: function(a) {
		return this._drag_masters[a.dhx_drag || a.dhx_drop]
	},
	getContext: function(a) {
		return this._drag_context
	},
	createDrag: function(m) {
		var g = dhtmlx.DragControl._active;
		var l = this._drag_masters[g.dhx_drag];
		var c;
		if (l.onDragCreate) {
			c = l.onDragCreate(g, m);
			c.style.position = "absolute";
			c.style.zIndex = dhtmlx.zIndex.drag;
			c.onmousemove = dhtmlx.DragControl._skip_mark
		} else {
			var n = dhtmlx.DragControl.onDrag(g, m);
			if (!n) {
				return false
			}
			var c = document.createElement("DIV");
			c.innerHTML = n;
			c.className = "dhx_drag_zone";
			c.onmousemove = dhtmlx.DragControl._skip_mark;
			document.body.appendChild(c)
		}
		dhtmlx.DragControl._html = c;
		return true
	},
	_skip_mark: function() {
		dhtmlx.DragControl._skip = true
	},
	destroyDrag: function() {
		var c = dhtmlx.DragControl._active;
		var g = this._drag_masters[c.dhx_drag];
		if (g && g.onDragDestroy) {
			g.onDragDestroy(c, dhtmlx.DragControl._html)
		} else {
			dhtmlx.html.remove(dhtmlx.DragControl._html)
		}
		dhtmlx.DragControl._landing = dhtmlx.DragControl._active = dhtmlx.DragControl._last = dhtmlx.DragControl._html = null
	},
	top: 5,
	left: 5,
	onDragIn: function(g, c, l) {
		var a = this._drag_masters[c.dhx_drop];
		if (a.onDragIn && a != this) {
			return a.onDragIn(g, c, l)
		}
		c.className = c.className + " dhx_drop_zone";
		return c
	},
	onDragOut: function(g, c, o, l) {
		var a = this._drag_masters[c.dhx_drop];
		if (a.onDragOut && a != this) {
			return a.onDragOut(g, c, o, l)
		}
		c.className = c.className.replace("dhx_drop_zone", "");
		return null
	},
	onDrop: function(g, c, n, l) {
		var a = this._drag_masters[c.dhx_drop];
		dhtmlx.DragControl._drag_context.from = dhtmlx.DragControl.getMaster(g);
		if (a.onDrop && a != this) {
			return a.onDrop(g, c, n, l)
		}
		c.appendChild(g)
	},
	onDrag: function(c, g) {
		var a = this._drag_masters[c.dhx_drag];
		if (a.onDrag && a != this) {
			return a.onDrag(c, g)
		}
		dhtmlx.DragControl._drag_context = {
			source: c,
			from: c
		};
		return "<div style='" + c.style.cssText + "'>" + c.innerHTML + "</div>"
	}
};
dhtmlx.DragItem = {
	_init: function() {
		dhtmlx.assert(this.move, "DragItem :: Component doesn't have DataMove interface");
		dhtmlx.assert(this.locate, "DragItem :: Component doesn't have RenderStack interface");
		dhtmlx.assert(dhtmlx.DragControl, "DragItem :: DragControl is not included");
		if (!this._settings || this._settings.drag) {
			dhtmlx.DragItem._initHandlers(this)
		} else {
			if (this._settings) {
				this.drag_setter = function(a) {
					if (a) {
						this._initHandlers(this);
						delete this.drag_setter
					}
					return a
				}
			}
		}
		if (this.dragMarker) {
			this.attachEvent("onBeforeDragIn", this.dragMarker);
			this.attachEvent("onDragOut", this.dragMarker)
		}
	},
	_initHandlers: function(a) {
		dhtmlx.DragControl.addDrop(a._obj, a, true);
		dhtmlx.DragControl.addDrag(a._obj, a)
	},
	onDragIn: function(l, g, m) {
		var o = this.locate(m) || null;
		var c = dhtmlx.DragControl._drag_context;
		var n = dhtmlx.DragControl.getMaster(l);
		var a = (this._locateHTML(o) || this._obj);
		if (a == dhtmlx.DragControl._landing) {
			return a
		}
		c.target = o;
		c.to = n;
		if (!this.callEvent("onBeforeDragIn", [c, m])) {
			c.id = null;
			return null
		}
		dhtmlx.html.addCss(a, "dhx_drag_over");
		return a
	},
	onDragOut: function(l, g, q, m) {
		var o = this.locate(m) || null;
		if (q != this._dataobj) {
			o = null
		}
		var c = (this._locateHTML(o) || (q ? dhtmlx.DragControl.getMaster(q)._obj : window.undefined));
		if (c == dhtmlx.DragControl._landing) {
			return null
		}
		var a = dhtmlx.DragControl._drag_context;
		dhtmlx.html.removeCss(dhtmlx.DragControl._landing, "dhx_drag_over");
		a.target = a.to = null;
		this.callEvent("onDragOut", [a, m]);
		return null
	},
	onDrop: function(g, c, m, l) {
		var a = dhtmlx.DragControl._drag_context;
		a.to = this;
		a.index = a.target ? this.indexById(a.target) : this.dataCount();
		a.new_id = dhtmlx.uid();
		if (!this.callEvent("onBeforeDrop", [a, l])) {
			return
		}
		if (a.from == a.to) {
			this.move(a.source, a.index)
		} else {
			if (a.from) {
				a.from.move(a.source, a.index, a.to, a.new_id)
			} else {
				dhtmlx.error("Unsopported d-n-d combination")
			}
		}
		this.callEvent("onAfterDrop", [a, l])
	},
	onDrag: function(g, m) {
		var n = this.locate(m);
		var l = [n];
		if (n) {
			if (this.getSelected) {
				var c = this.getSelected();
				if (dhtmlx.PowerArray.find.call(c, n) != -1) {
					l = c
				}
			}
			var a = dhtmlx.DragControl._drag_context = {
				source: l,
				start: n
			};
			a.from = this;
			if (this.callEvent("onBeforeDrag", [a, m])) {
				return a.html || this._toHTML(this.get(n))
			}
		}
		return null
	}
};
dhtmlx.EditAbility = {
	_init: function(a) {
		this._edit_id = null;
		this._edit_bind = null;
		dhtmlx.assert(this.data, "EditAbility :: Component doesn't have DataStore");
		dhtmlx.assert(this._locateHTML, "EditAbility :: Component doesn't have RenderStack");
		this.attachEvent("onEditKeyPress", function(g, l, c) {
			if (g == 13 && !c) {
				this.stopEdit()
			} else {
				if (g == 27) {
					this.stopEdit(true)
				}
			}
		});
		this.attachEvent("onBeforeRender", function() {
			this.stopEdit()
		})
	},
	isEdit: function() {
		return this._edit_id
	},
	edit: function(c) {
		if (this.stopEdit(false, c)) {
			if (!this.callEvent("onBeforeEditStart", [c])) {
				return
			}
			var a = this.data.get(c);
			if (a.$template) {
				return
			}
			a.$template = "edit";
			this.data.refresh(c);
			this._edit_id = c;
			this._save_binding(c);
			this._edit_bind(true, a);
			this.callEvent("onAfterEditStart", [c])
		}
	},
	stopEdit: function(g, m) {
		if (!this._edit_id) {
			return true
		}
		if (this._edit_id == m) {
			return false
		}
		var a = {};
		if (!g) {
			this._edit_bind(false, a)
		} else {
			a = null
		}
		if (!this.callEvent("onBeforeEditStop", [this._edit_id, a])) {
			return false
		}
		var c = this.data.get(this._edit_id);
		c.$template = null;
		if (!g) {
			this._edit_bind(false, c)
		}
		var l = this._edit_id;
		this._edit_bind = this._edit_id = null;
		this.data.refresh(l);
		this.callEvent("onAfterEditStop", [l, a]);
		return true
	},
	_save_binding: function(q) {
		var a = this._locateHTML(q);
		var g = "";
		var n = "";
		var m = [];
		if (a) {
			var l = a.getElementsByTagName("*");
			var o = "";
			for (var c = 0; c < l.length; c++) {
				if (l[c].nodeType == 1 && (o = l[c].getAttribute("bind"))) {
					g += "els[" + m.length + "].value=" + o + ";";
					n += o + "=els[" + m.length + "].value;";
					m.push(l[c]);
					l[c].className += " dhx_allow_selection";
					l[c].onselectstart = this._block_native
				}
			}
			l = null
		}
		g = Function("obj", "els", g);
		n = Function("obj", "els", n);
		this._edit_bind = function(s, r) {
			if (s) {
				g(r, m);
				if (m.length && m[0].select) {
					m[0].select()
				}
			} else {
				n(r, m)
			}
		}
	},
	_block_native: function(a) {
		(a || event).cancelBubble = true;
		return true
	}
};
dhtmlx.SelectionModel = {
	_init: function() {
		this._selected = dhtmlx.toArray();
		dhtmlx.assert(this.data, "SelectionModel :: Component doesn't have DataStore");
		this.data.attachEvent("onStoreUpdated", dhtmlx.bind(this._data_updated, this));
		this.data.attachEvent("onStoreLoad", dhtmlx.bind(this._data_loaded, this));
		this.data.attachEvent("onAfterFilter", dhtmlx.bind(this._data_filtered, this));
		this.data.attachEvent("onIdChange", dhtmlx.bind(this._id_changed, this))
	},
	_id_changed: function(g, a) {
		for (var c = this._selected.length - 1; c >= 0; c--) {
			if (this._selected[c] == g) {
				this._selected[c] = a
			}
		}
	},
	_data_filtered: function() {
		for (var a = this._selected.length - 1; a >= 0; a--) {
			if (this.data.indexById(this._selected[a]) < 0) {
				var g = this._selected[a]
			}
			var c = this.item(g);
			if (c) {
				delete c.$selected
			}
			this._selected.splice(a, 1);
			this.callEvent("onSelectChange", [g])
		}
	},
	_data_updated: function(g, c, a) {
		if (a == "delete") {
			this._selected.remove(g)
		} else {
			if (!this.data.dataCount() && !this.data._filter_order) {
				this._selected = dhtmlx.toArray()
			}
		}
	},
	_data_loaded: function() {
		if (this._settings.select) {
			this.data.each(function(a) {
				if (a.$selected) {
					this.select(a.id)
				}
			}, this)
		}
	},
	_select_mark: function(g, c, a) {
		if (!a && !this.callEvent("onBeforeSelect", [g, c])) {
			return false
		}
		this.data.item(g).$selected = c;
		if (a) {
			a.push(g)
		} else {
			if (c) {
				this._selected.push(g)
			} else {
				this._selected.remove(g)
			}
			this._refresh_selection(g)
		}
		return true
	},
	select: function(l, g, a) {
		if (!l) {
			return this.selectAll()
		}
		if (l instanceof Array) {
			for (var c = 0; c < l.length; c++) {
				this.select(l[c], g, a)
			}
			return
		}
		if (!this.data.exists(l)) {
			dhtmlx.error("Incorrect id in select command: " + l);
			return
		}
		if (a && this._selected.length) {
			return this.selectAll(this._selected[this._selected.length - 1], l)
		}
		if (!g && (this._selected.length != 1 || this._selected[0] != l)) {
			this._silent_selection = true;
			this.unselectAll();
			this._silent_selection = false
		}
		if (this.isSelected(l)) {
			if (g) {
				this.unselect(l)
			}
			return
		}
		if (this._select_mark(l, true)) {
			this.callEvent("onAfterSelect", [l])
		}
	},
	unselect: function(a) {
		if (!a) {
			return this.unselectAll()
		}
		if (!this.isSelected(a)) {
			return
		}
		this._select_mark(a, false)
	},
	selectAll: function(l, g) {
		var a;
		var c = [];
		if (l || g) {
			a = this.data.getRange(l || null, g || null)
		} else {
			a = this.data.getRange()
		}
		a.each(function(m) {
			var n = this.data.item(m.id);
			if (!n.$selected) {
				this._selected.push(m.id);
				this._select_mark(m.id, true, c)
			}
			return m.id
		}, this);
		this._refresh_selection(c)
	},
	unselectAll: function() {
		var a = [];
		this._selected.each(function(c) {
			this._select_mark(c, false, a)
		}, this);
		this._selected = dhtmlx.toArray();
		this._refresh_selection(a)
	},
	isSelected: function(a) {
		return this._selected.find(a) != -1
	},
	getSelected: function(a) {
		switch (this._selected.length) {
			case 0:
				return a ? [] : "";
			case 1:
				return a ? [this._selected[0]] : this._selected[0];
			default:
				return ([].concat(this._selected))
		}
	},
	_is_mass_selection: function(a) {
		return a.length > 100 || a.length > this.data.dataCount / 2
	},
	_refresh_selection: function(c) {
		if (typeof c != "object") {
			c = [c]
		}
		if (!c.length) {
			return
		}
		if (this._is_mass_selection(c)) {
			this.data.refresh()
		} else {
			for (var a = 0; a < c.length; a++) {
				this.render(c[a], this.data.item(c[a]), "update")
			}
		}
		if (!this._silent_selection) {
			this.callEvent("onSelectChange", [c])
		}
	}
};
dhtmlx.RenderStack = {
	_init: function() {
		dhtmlx.assert(this.data, "RenderStack :: Component doesn't have DataStore");
		dhtmlx.assert(dhtmlx.Template, "dhtmlx.Template :: dhtmlx.Template is not accessible");
		this._html = document.createElement("DIV")
	},
	_toHTML: function(a) {
		dhtmlx.assert((!a.$template || this.type["template_" + a.$template]), "RenderStack :: Unknown template: " + a.$template);
		this.callEvent("onItemRender", [a]);
		return this.type._item_start(a, this.type) + (a.$template ? this.type["template_" + a.$template] : this.type.template)(a, this.type) + this.type._item_end
	},
	_toHTMLObject: function(a) {
		this._html.innerHTML = this._toHTML(a);
		return this._html.firstChild
	},
	_locateHTML: function(a) {
		if (this._htmlmap) {
			return this._htmlmap[a]
		}
		this._htmlmap = {};
		var g = this._dataobj.childNodes;
		for (var c = 0; c < g.length; c++) {
			var l = g[c].getAttribute(this._id);
			if (l) {
				this._htmlmap[l] = g[c]
			}
		}
		return this._locateHTML(a)
	},
	locate: function(a) {
		return dhtmlx.html.locate(a, this._id)
	},
	show: function(c) {
		var a = this._locateHTML(c);
		if (a) {
			this._dataobj.scrollTop = a.offsetTop - this._dataobj.offsetTop
		}
	},
	render: function(n, l, g, m) {
		if (n) {
			var a = this._locateHTML(n);
			switch (g) {
				case "update":
					if (!a) {
						return
					}
					var c = this._htmlmap[n] = this._toHTMLObject(l);
					dhtmlx.html.insertBefore(c, a);
					dhtmlx.html.remove(a);
					break;
				case "delete":
					if (!a) {
						return
					}
					dhtmlx.html.remove(a);
					delete this._htmlmap[n];
					break;
				case "add":
					var c = this._htmlmap[n] = this._toHTMLObject(l);
					dhtmlx.html.insertBefore(c, this._locateHTML(this.data.next(n)), this._dataobj);
					break;
				case "move":
					this.render(n, l, "delete");
					this.render(n, l, "add");
					break;
				default:
					dhtmlx.error("Unknown render command: " + g);
					break
			}
		} else {
			if (this.callEvent("onBeforeRender", [this.data])) {
				this._dataobj.innerHTML = this.data.getRange().map(this._toHTML, this).join("");
				this._htmlmap = null
			}
		}
		this.callEvent("onAfterRender", [])
	},
	pager_setter: function(c) {
		this.attachEvent("onBeforeRender", function() {
			var l = this._settings.pager._settings;
			if (l.page == -1) {
				return false
			}
			this.data.min = l.page * l.size;
			this.data.max = (l.page + 1) * l.size - 1;
			return true
		});
		var a = new dhtmlx.ui.pager(c);
		var g = dhtmlx.bind(function() {
			this.data.refresh()
		}, this);
		a.attachEvent("onRefresh", g);
		this.data.attachEvent("onStoreUpdated", function(m) {
			var l = this.dataCount();
			if (l != a._settings.count) {
				a._settings.count = l;
				if (a._settings.page == -1) {
					a._settings.page = 0
				}
				a.refresh()
			}
		});
		return a
	},
	height_setter: function(a) {
		if (a == "auto") {
			this.attachEvent("onAfterRender", this._correct_height);
			dhtmlx.event(window, "resize", dhtmlx.bind(this._correct_height, this))
		}
		return a
	},
	_correct_height: function() {
		this._dataobj.style.overflow = "hidden";
		this._dataobj.style.height = "1px";
		var a = this._dataobj.scrollHeight;
		this._dataobj.style.height = a + "px";
		if (dhtmlx._isFF) {
			var c = this._dataobj.scrollHeight;
			if (c != a) {
				this._dataobj.style.height = c + "px"
			}
		}
		this._obj.style.height = this._dataobj.style.height
	},
	_getDimension: function() {
		var a = this.type;
		var c = (a.border || 0) + (a.padding || 0) * 2 + (a.margin || 0) * 2;
		return {
			x: a.width + c,
			y: a.height + c
		}
	},
	x_count_setter: function(c) {
		var g = this._getDimension();
		var a = dhtmlx.$customScroll ? 0 : 18;
		this._dataobj.style.width = g.x * c + (this._settings.height != "auto" ? a : 0) + "px";
		return c
	},
	y_count_setter: function(a) {
		var c = this._getDimension();
		this._dataobj.style.height = c.y * a + "px";
		return a
	}
};
dhtmlx.VirtualRenderStack = {
	_init: function() {
		dhtmlx.assert(this.render, "VirtualRenderStack :: Object must use RenderStack first");
		this._htmlmap = {};
		this._dataobj.style.overflowY = "scroll";
		dhtmlx.event(this._dataobj, "scroll", dhtmlx.bind(this._render_visible_rows, this));
		dhtmlx.event(window, "resize", dhtmlx.bind(function() {
			this.render()
		}, this));
		this.data._unrendered_area = [];
		this.data.getIndexRange = this._getIndexRange
	},
	_locateHTML: function(a) {
		return this._htmlmap[a]
	},
	show: function(g) {
		range = this._getVisibleRange();
		var c = this.data.indexById(g);
		var a = Math.floor(c / range._dx) * range._y;
		this._dataobj.scrollTop = a
	},
	_getIndexRange: function(m, l) {
		if (l !== 0) {
			l = Math.min((l || Infinity), this.dataCount() - 1)
		}
		var a = dhtmlx.toArray();
		for (var c = (m || 0); c <= l; c++) {
			var g = this.item(this.order[c]);
			if (this.order.length > c) {
				if (!g) {
					this.order[c] = dhtmlx.uid();
					g = {
						id: this.order[c],
						$template: "loading"
					};
					this._unrendered_area.push(this.order[c])
				} else {
					if (g.$template == "loading") {
						this._unrendered_area.push(this.order[c])
					}
				}
				a.push(g)
			}
		}
		return a
	},
	render: function(n, l, g, m) {
		if (n) {
			var a = this._locateHTML(n);
			switch (g) {
				case "update":
					if (!a) {
						return
					}
					var c = this._htmlmap[n] = this._toHTMLObject(l);
					dhtmlx.html.insertBefore(c, a);
					dhtmlx.html.remove(a);
					break;
				default:
					this._render_delayed();
					break
			}
		} else {
			if (this.callEvent("onBeforeRender", [this.data])) {
				this._htmlmap = {};
				this._render_visible_rows(null, true);
				this._wait_for_render = false;
				this.callEvent("onAfterRender", [])
			}
		}
	},
	_render_delayed: function() {
		if (this._wait_for_render) {
			return
		}
		this._wait_for_render = true;
		window.setTimeout(dhtmlx.bind(function() {
			this.render()
		}, this), 1)
	},
	_create_placeholder: function(a) {
		var c = document.createElement("DIV");
		c.className = "dhxdataview_placeholder";
		c.style.cssText = "height:" + a + "px; width:100%; overflow:hidden;";
		return c
	},
	_render_visible_rows: function(A, E) {
		this.data._unrendered_area = [];
		var y = this._getVisibleRange();
		if (!this._dataobj.firstChild || E) {
			this._dataobj.innerHTML = "";
			this._dataobj.appendChild(this._create_placeholder(y._max));
			this._htmlrows = [this._dataobj.firstChild]
		}
		var l = Math.max(y._from, 0);
		var x = (this.data.max || this.data.max === 0) ? this.data.max : Infinity;
		while (l <= y._height) {
			while (this._htmlrows[l] && this._htmlrows[l]._filled && l <= y._height) {
				l++
			}
			if (l > y._height) {
				break
			}
			var o = l;
			while (!this._htmlrows[o]) {
				o--
			}
			var a = this._htmlrows[o];
			var g = l * y._dx + (this.data.min || 0);
			if (g > x) {
				break
			}
			var m = Math.min(g + y._dx - 1, x);
			var r = this._create_placeholder(y._y);
			var n = this.data.getIndexRange(g, m);
			if (!n.length) {
				break
			}
			r.innerHTML = n.map(this._toHTML, this).join("");
			for (var v = 0; v < n.length; v++) {
				this._htmlmap[this.data.idByIndex(g + v)] = r.childNodes[v]
			}
			var w = parseInt(a.style.height, 10);
			var D = (l - o) * y._y;
			var u = (w - D - y._y);
			dhtmlx.html.insertBefore(r, D ? a.nextSibling : a, this._dataobj);
			this._htmlrows[l] = r;
			r._filled = true;
			if (D <= 0 && u > 0) {
				a.style.height = u + "px";
				this._htmlrows[l + 1] = a
			} else {
				if (D < 0) {
					dhtmlx.html.remove(a)
				} else {
					a.style.height = D + "px"
				}
				if (u > 0) {
					var q = this._htmlrows[l + 1] = this._create_placeholder(u);
					dhtmlx.html.insertBefore(q, r.nextSibling, this._dataobj)
				}
			}
			l++
		}
		if (this.data._unrendered_area.length) {
			var s = this.indexById(this.data._unrendered_area[0]);
			var c = this.indexById(this.data._unrendered_area.pop()) + 1;
			if (c > s) {
				if (!this.callEvent("onDataRequest", [s, c - s])) {
					return false
				}
				dhtmlx.assert(this.data.feed, "Data feed is missed");
				this.data.feed.call(this, s, c - s)
			}
		}
		if (dhtmlx._isIE) {
			var C = this._getVisibleRange();
			if (C._from != y._from) {
				this._render_visible_rows()
			}
		}
	},
	_getVisibleRange: function() {
		var c = dhtmlx.$customScroll ? 0 : 18;
		var o = this._dataobj.scrollTop;
		var a = Math.max(this._dataobj.scrollWidth, this._dataobj.offsetWidth) - c;
		var q = this._dataobj.offsetHeight;
		var s = this.type;
		var l = this._getDimension();
		var u = Math.floor(a / l.x) || 1;
		var g = Math.floor(o / l.y);
		var r = Math.ceil((q + o) / l.y) - 1;
		var m = this.data.max ? (this.data.max - this.data.min) : this.data.dataCount();
		var n = Math.ceil(m / u) * l.y;
		return {
			_from: g,
			_height: r,
			_top: o,
			_max: n,
			_y: l.y,
			_dx: u
		}
	}
};
dhtmlXDataView = function(a) {
	this.name = "DataView";
	this.version = "3.0";
	if (dhtmlx.assert_enabled()) {
		this._assert()
	}
	dhtmlx.extend(this, dhtmlx.Settings);
	this._parseContainer(a, "dhx_dataview");
	dhtmlx.extend(this, dhtmlx.AtomDataLoader);
	dhtmlx.extend(this, dhtmlx.DataLoader);
	dhtmlx.extend(this, dhtmlx.EventSystem);
	dhtmlx.extend(this, dhtmlx.RenderStack);
	dhtmlx.extend(this, dhtmlx.SelectionModel);
	dhtmlx.extend(this, dhtmlx.MouseEvents);
	dhtmlx.extend(this, dhtmlx.KeyEvents);
	dhtmlx.extend(this, dhtmlx.EditAbility);
	dhtmlx.extend(this, dhtmlx.DataMove);
	dhtmlx.extend(this, dhtmlx.DragItem);
	dhtmlx.extend(this, dhtmlx.DataProcessor);
	dhtmlx.extend(this, dhtmlx.AutoTooltip);
	dhtmlx.extend(this, dhtmlx.Destruction);
	this.data.attachEvent("onStoreUpdated", dhtmlx.bind(function() {
		this.render.apply(this, arguments)
	}, this));
	this._parseSettings(a, {
		drag: false,
		edit: false,
		select: "multiselect",
		type: "default"
	});
	if (this._settings.height != "auto" && !this._settings.renderAll) {
		dhtmlx.extend(this, dhtmlx.VirtualRenderStack)
	}
	this.data.provideApi(this, true);
	if (dhtmlx.$customScroll) {
		dhtmlx.CustomScroll.enable(this)
	}
};
dhtmlXDataView.prototype = {
	bind: function() {
		dhx.BaseBind.legacyBind.apply(this, arguments)
	},
	sync: function() {
		dhx.BaseBind.legacySync.apply(this, arguments)
	},
	dragMarker: function(g, m) {
		var l = this._locateHTML(g.target);
		if (this.type.drag_marker) {
			if (this._drag_marker) {
				this._drag_marker.style.backgroundImage = "";
				this._drag_marker.style.backgroundRepeat = ""
			}
			if (l) {
				l.style.backgroundImage = "url(" + (dhtmlx.image_path || "") + this.type.drag_marker + ")";
				l.style.backgroundRepeat = "no-repeat";
				this._drag_marker = l
			}
		}
		if (l && this._settings.auto_scroll) {
			var a = l.offsetTop;
			var n = l.offsetHeight;
			var c = this._obj.scrollTop;
			var o = this._obj.offsetHeight;
			if (a - n >= 0 && a - n * 0.75 < c) {
				c = Math.max(a - n, 0)
			} else {
				if (a + n / 0.75 > c + o) {
					c = c + n
				}
			}
			this._obj.scrollTop = c
		}
		return true
	},
	_id: "dhx_f_id",
	on_click: {
		dhx_dataview_item: function(a, c) {
			if (this.stopEdit(false, c)) {
				if (this._settings.select) {
					if (this._settings.select == "multiselect") {
						this.select(c, a.ctrlKey, a.shiftKey)
					} else {
						this.select(c)
					}
				}
			}
		}
	},
	on_dblclick: {
		dhx_dataview_item: function(a, c) {
			if (this._settings.edit) {
				this.edit(c)
			}
		}
	},
	on_mouse_move: {},
	types: {
		"default": {
			css: "default",
			template: dhtmlx.Template.fromHTML("<div style='padding:10px; white-space:nowrap; overflow:hidden;'>{obj.text}</div>"),
			template_edit: dhtmlx.Template.fromHTML("<div style='padding:10px; white-space:nowrap; overflow:hidden;'><textarea style='width:100%; height:100%;' bind='obj.text'></textarea></div>"),
			template_loading: dhtmlx.Template.fromHTML("<div style='padding:10px; white-space:nowrap; overflow:hidden;'>Loading...</div>"),
			width: 210,
			height: 115,
			margin: 0,
			padding: 10,
			border: 1
		}
	},
	template_item_start: dhtmlx.Template.fromHTML("<div dhx_f_id='{-obj.id}' class='dhx_dataview_item dhx_dataview_{obj.css}_item{-obj.$selected?_selected:}' style='width:{obj.width}px; height:{obj.height}px; padding:{obj.padding}px; margin:{obj.margin}px; float:left; overflow:hidden;'>"),
	template_item_end: dhtmlx.Template.fromHTML("</div>")
};
dhtmlx.compat("layout");
if (typeof(window.dhtmlXCellObject) != "undefined") {
	dhtmlXCellObject.prototype.attachDataView = function(a) {
		this.callEvent("_onBeforeContentAttach", ["dataview"]);
		var c = document.createElement("DIV");
		c.style.width = "100%";
		c.style.height = "100%";
		c.style.position = "relative";
		c.style.overflow = "hidden";
		this._attachObject(c);
		if (typeof(a) == "undefined") {
			a = {}
		}
		c.id = "DataViewObject_" + new Date().getTime();
		a.container = c.id;
		a.skin = this.conf.skin;
		this.dataType = "dataview";
		this.dataObj = new dhtmlXDataView(a);
		this.dataObj.setSizes = function() {
			this.render()
		};
		c = null;
		this.callEvent("_onContentAttach", []);
		return this.dataObj
	}
}

function xmlPointer(a) {
	this.d = a
}
xmlPointer.prototype = {
	text: function() {
		if (!_isFF) {
			return this.d.xml
		}
		var a = new XMLSerializer();
		return a.serializeToString(this.d)
	},
	get: function(a) {
		return this.d.getAttribute(a)
	},
	exists: function() {
		return !!this.d
	},
	content: function() {
		return this.d.firstChild ? (this.d.firstChild.wholeText || this.d.firstChild.data) : ""
	},
	each: function(l, o, n, m) {
		var g = this.d.childNodes;
		var q = new xmlPointer();
		if (g.length) {
			for (m = m || 0; m < g.length; m++) {
				if (g[m].tagName == l) {
					q.d = g[m];
					if (o.apply(n, [q, m]) == -1) {
						return
					}
				}
			}
		}
	},
	get_all: function() {
		var g = {};
		var c = this.d.attributes;
		for (var l = 0; l < c.length; l++) {
			g[c[l].name] = c[l].value
		}
		return g
	},
	sub: function(l) {
		var g = this.d.childNodes;
		var n = new xmlPointer();
		if (g.length) {
			for (var m = 0; m < g.length; m++) {
				if (g[m].tagName == l) {
					n.d = g[m];
					return n
				}
			}
		}
	},
	up: function(a) {
		return new xmlPointer(this.d.parentNode)
	},
	set: function(a, c) {
		this.d.setAttribute(a, c)
	},
	clone: function(a) {
		return new xmlPointer(this.d)
	},
	sub_exists: function(g) {
		var c = this.d.childNodes;
		if (c.length) {
			for (var l = 0; l < c.length; l++) {
				if (c[l].tagName == g) {
					return true
				}
			}
		}
		return false
	},
	through: function(g, o, s, m, u) {
		var q = this.d.childNodes;
		if (q.length) {
			for (var l = 0; l < q.length; l++) {
				if (q[l].tagName == g && q[l].getAttribute(o) != null && q[l].getAttribute(o) != "" && (!s || q[l].getAttribute(o) == s)) {
					var n = new xmlPointer(q[l]);
					m.apply(u, [n, l])
				}
				var r = this.d;
				this.d = q[l];
				this.through(g, o, s, m, u);
				this.d = r
			}
		}
	}
};

function dhtmlXTreeObject(n, l, c, a) {
	if (dhtmlxEvent.initTouch) {
		dhtmlxEvent.initTouch()
	}
	if (_isIE) {
		try {
			document.execCommand("BackgroundImageCache", false, true)
		} catch (m) {}
	}
	if (typeof(n) != "object") {
		this.parentObject = document.getElementById(n)
	} else {
		this.parentObject = n
	}
	this.parentObject.style.overflow = "hidden";
	this._itim_dg = true;
	this.dlmtr = ",";
	this.dropLower = false;
	this.enableIEImageFix(true);
	this.xmlstate = 0;
	this.mytype = "tree";
	this.smcheck = true;
	this.width = l;
	this.height = c;
	this.rootId = a;
	this.childCalc = null;
	this.def_img_x = "18px";
	this.def_img_y = "18px";
	this.def_line_img_x = "18px";
	this.def_line_img_y = "24px";
	this._dragged = new Array();
	this._selected = new Array();
	this.style_pointer = "pointer";
	this._aimgs = true;
	this.htmlcA = " [";
	this.htmlcB = "]";
	this.lWin = window;
	this.cMenu = 0;
	this.mlitems = 0;
	this.iconURL = "";
	this.dadmode = 0;
	this.slowParse = false;
	this.autoScroll = true;
	this.hfMode = 0;
	this.nodeCut = new Array();
	this.XMLsource = 0;
	this.XMLloadingWarning = 0;
	this._idpull = {};
	this._pullSize = 0;
	this.treeLinesOn = true;
	this.tscheck = false;
	this.timgen = true;
	this.dpcpy = false;
	this._ld_id = null;
	this._oie_onXLE = [];
	this.imPath = window.dhx_globalImgPath || "";
	this.checkArray = new Array("iconUncheckAll.gif", "iconCheckAll.gif", "iconCheckGray.gif", "iconUncheckDis.gif", "iconCheckDis.gif", "iconCheckDis.gif");
	this.radioArray = new Array("radio_off.gif", "radio_on.gif", "radio_on.gif", "radio_off.gif", "radio_on.gif", "radio_on.gif");
	this.lineArray = new Array("line2.gif", "line3.gif", "line4.gif", "blank.gif", "blank.gif", "line1.gif");
	this.minusArray = new Array("minus2.gif", "minus3.gif", "minus4.gif", "minus.gif", "minus5.gif");
	this.plusArray = new Array("plus2.gif", "plus3.gif", "plus4.gif", "plus.gif", "plus5.gif");
	this.imageArray = new Array("leaf.gif", "folderOpen.gif", "folderClosed.gif");
	this.cutImg = new Array(0, 0, 0);
	this.cutImage = "but_cut.gif";
	dhx4._eventable(this);
	this.dragger = new dhtmlDragAndDropObject();
	this.htmlNode = new dhtmlXTreeItemObject(this.rootId, "", 0, this);
	this.htmlNode.htmlNode.childNodes[0].childNodes[0].style.display = "none";
	this.htmlNode.htmlNode.childNodes[0].childNodes[0].childNodes[0].className = "hiddenRow";
	this.allTree = this._createSelf();
	this.allTree.appendChild(this.htmlNode.htmlNode);
	if (dhtmlx.$customScroll) {
		dhtmlx.CustomScroll.enable(this)
	}
	if (_isFF) {
		this.allTree.childNodes[0].width = "100%";
		this.allTree.childNodes[0].style.overflow = "hidden"
	}
	var g = this;
	this.allTree.onselectstart = new Function("return false;");
	if (_isMacOS) {
		this.allTree.oncontextmenu = function(o) {
			return g._doContClick(o || window.event, true)
		}
	}
	this.allTree.onmousedown = function(o) {
		return g._doContClick(o || window.event)
	};
	this.XMLLoader = this._parseXMLTree;
	if (_isIE) {
		this.preventIECashing(true)
	}
	this.selectionBar = document.createElement("DIV");
	this.selectionBar.className = "selectionBar";
	this.selectionBar.innerHTML = "&nbsp;";
	this.selectionBar.style.display = "none";
	this.allTree.appendChild(this.selectionBar);
	if (window.addEventListener) {
		window.addEventListener("unload", function() {
			try {
				g.destructor()
			} catch (o) {}
		}, false)
	}
	if (window.attachEvent) {
		window.attachEvent("onunload", function() {
			try {
				g.destructor()
			} catch (o) {}
		})
	}
	this.setImagesPath = this.setImagePath;
	this.setIconsPath = this.setIconPath;
	if (dhtmlx.image_path) {
		this.setImagePath(dhtmlx.image_path)
	}
	this.setSkin(window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhxtree") || "dhx_skyblue");
	return this
}
dhtmlXTreeObject.prototype.setDataMode = function(a) {
	this._datamode = a
};
dhtmlXTreeObject.prototype._doContClick = function(o, a) {
	if (!a && o.button != 2) {
		if (this._acMenu) {
			if (this._acMenu.hideContextMenu) {
				this._acMenu.hideContextMenu()
			} else {
				this.cMenu._contextEnd()
			}
		}
		return true
	}
	var c = (_isIE ? o.srcElement : o.target);
	while ((c) && (c.tagName != "BODY")) {
		if (c.parentObject) {
			break
		}
		c = c.parentNode
	}
	if ((!c) || (!c.parentObject)) {
		return true
	}
	var m = c.parentObject;
	if (!this.callEvent("onRightClick", [m.id, o])) {
		(o.srcElement || o.target).oncontextmenu = function(s) {
			(s || event).cancelBubble = true;
			return false
		}
	}
	this._acMenu = (m.cMenu || this.cMenu);
	if (this._acMenu) {
		if (!(this.callEvent("onBeforeContextMenu", [m.id]))) {
			return true
		}
		if (!_isMacOS) {
			(o.srcElement || o.target).oncontextmenu = function(s) {
				(s || event).cancelBubble = true;
				return false
			}
		}
		if (this._acMenu.showContextMenu) {
			var l = window.document.documentElement;
			var g = window.document.body;
			var q = new Array((l.scrollLeft || g.scrollLeft), (l.scrollTop || g.scrollTop));
			if (_isIE) {
				var r = o.clientX + q[0];
				var n = o.clientY + q[1]
			} else {
				var r = o.pageX;
				var n = o.pageY
			}
			this._acMenu.showContextMenu(r - 1, n - 1);
			this.contextID = m.id;
			o.cancelBubble = true;
			this._acMenu._skip_hide = true
		} else {
			c.contextMenuId = m.id;
			c.contextMenu = this._acMenu;
			c.a = this._acMenu._contextStart;
			c.a(c, o);
			c.a = null
		}
		return false
	}
	return true
};
dhtmlXTreeObject.prototype.enableIEImageFix = function(a) {
	if (!a) {
		this._getImg = function(c) {
			return document.createElement((c == this.rootId) ? "div" : "img")
		};
		this._setSrc = function(g, c) {
			g.src = c
		};
		this._getSrc = function(c) {
			return c.src
		}
	} else {
		this._getImg = function() {
			var c = document.createElement("DIV");
			c.innerHTML = "&nbsp;";
			c.className = "dhx_bg_img_fix";
			return c
		};
		this._setSrc = function(g, c) {
			g.style.backgroundImage = "url(" + c + ")"
		};
		this._getSrc = function(c) {
			var g = c.style.backgroundImage;
			return g.substr(4, g.length - 5).replace(/(^")|("$)/g, "")
		}
	}
};
dhtmlXTreeObject.prototype.destructor = function() {
	for (var c in this._idpull) {
		var g = this._idpull[c];
		if (!g) {
			continue
		}
		g.parentObject = null;
		g.treeNod = null;
		g.childNodes = null;
		g.span = null;
		g.tr.nodem = null;
		g.tr = null;
		g.htmlNode.objBelong = null;
		g.htmlNode = null;
		this._idpull[c] = null
	}
	this.parentObject.innerHTML = "";
	this.allTree.onselectstart = null;
	this.allTree.oncontextmenu = null;
	this.allTree.onmousedown = null;
	for (var c in this) {
		this[c] = null
	}
};

function cObject() {
	return this
}
cObject.prototype = new Object;
cObject.prototype.clone = function() {
	function a() {}
	a.prototype = this;
	return new a()
};

function dhtmlXTreeItemObject(n, c, g, a, l, m) {
	this.htmlNode = "";
	this.acolor = "";
	this.scolor = "";
	this.tr = 0;
	this.childsCount = 0;
	this.tempDOMM = 0;
	this.tempDOMU = 0;
	this.dragSpan = 0;
	this.dragMove = 0;
	this.span = 0;
	this.closeble = 1;
	this.childNodes = new Array();
	this.userData = new cObject();
	this.checkstate = 0;
	this.treeNod = a;
	this.label = c;
	this.parentObject = g;
	this.actionHandler = l;
	this.images = new Array(a.imageArray[0], a.imageArray[1], a.imageArray[2]);
	this.id = a._globalIdStorageAdd(n, this);
	if (this.treeNod.checkBoxOff) {
		this.htmlNode = this.treeNod._createItem(1, this, m)
	} else {
		this.htmlNode = this.treeNod._createItem(0, this, m)
	}
	this.htmlNode.objBelong = this;
	return this
}
dhtmlXTreeObject.prototype._globalIdStorageAdd = function(c, a) {
	if (this._globalIdStorageFind(c, 1, 1)) {
		c = c + "_" + (new Date()).valueOf();
		return this._globalIdStorageAdd(c, a)
	}
	this._idpull[c] = a;
	this._pullSize++;
	return c
};
dhtmlXTreeObject.prototype._globalIdStorageSub = function(a) {
	if (this._idpull[a]) {
		this._unselectItem(this._idpull[a]);
		this._idpull[a] = null;
		this._pullSize--
	}
	if ((this._locker) && (this._locker[a])) {
		this._locker[a] = false
	}
};
dhtmlXTreeObject.prototype._globalIdStorageFind = function(n, a, g, l) {
	var m = this._idpull[n];
	if (m) {
		if ((m.unParsed) && (!g)) {
			this.reParse(m, 0)
		}
		if (this._srnd && !m.htmlNode) {
			this._buildSRND(m, g)
		}
		if ((l) && (this._edsbpsA)) {
			for (var c = 0; c < this._edsbpsA.length; c++) {
				if (this._edsbpsA[c][2] == n) {
					dhx4.callEvent("ongetItemError", ["Requested item still in parsing process.", n]);
					return null
				}
			}
		}
		return m
	}
	if ((this.slowParse) && (n != 0) && (!a)) {
		return this.preParse(n)
	} else {
		return null
	}
};
dhtmlXTreeObject.prototype._getSubItemsXML = function(a) {
	var c = [];
	a.each("item", function(g) {
		c.push(g.get("id"))
	}, this);
	return c.join(this.dlmtr)
};
dhtmlXTreeObject.prototype.enableSmartXMLParsing = function(a) {
	this.slowParse = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.findXML = function(c, a, g) {};
dhtmlXTreeObject.prototype._getAllCheckedXML = function(c, a, l) {
	var g = [];
	if (l == 2) {
		c.through("item", "checked", -1, function(m) {
			g.push(m.get("id"))
		}, this)
	}
	if (l == 1) {
		c.through("item", "id", null, function(m) {
			if (m.get("checked") && (m.get("checked") != -1)) {
				g.push(m.get("id"))
			}
		}, this)
	}
	if (l == 0) {
		c.through("item", "id", null, function(m) {
			if (!m.get("checked") || m.get("checked") == 0) {
				g.push(m.get("id"))
			}
		}, this)
	}
	if (g.length) {
		return a + (a ? this.dlmtr : "") + g.join(this.dlmtr)
	}
	if (a) {
		return a
	} else {
		return ""
	}
};
dhtmlXTreeObject.prototype._setSubCheckedXML = function(a, c) {
	var g = a ? "1" : "";
	c.through("item", "id", null, function(l) {
		if (!l.get("disabled") || l.get("disabled") == 0) {
			l.set("checked", g)
		}
	}, this)
};
dhtmlXTreeObject.prototype._getAllScraggyItemsXML = function(g, a) {
	var l = [];
	var c = function(m) {
		if (!m.sub_exists("item")) {
			l.push(m.get("id"))
		} else {
			m.each("item", c, this)
		}
	};
	c(g);
	return l.join(",")
};
dhtmlXTreeObject.prototype._getAllFatItemsXML = function(g, a) {
	var l = [];
	var c = function(m) {
		if (!m.sub_exists("item")) {
			return
		}
		l.push(m.get("id"));
		m.each("item", c, this)
	};
	c(g);
	return l.join(",")
};
dhtmlXTreeObject.prototype._getAllSubItemsXML = function(g, c, a) {
	var c = [];
	a.through("item", "id", null, function(l) {
		c.push(l.get("id"))
	}, this);
	return c.join(",")
};
dhtmlXTreeObject.prototype.reParse = function(g) {
	var o = this;
	if (!this.parsCount) {
		o.callEvent("onXLS", [o, g.id])
	}
	this.xmlstate = 1;
	var l = g.unParsed;
	g.unParsed = 0;
	this.XMLloadingWarning = 1;
	var a = this.parsingOn;
	var q = this.waitUpdateXML;
	var r = this.parsedArray;
	this.parsedArray = new Array();
	this.waitUpdateXML = false;
	this.parsingOn = g.id;
	this.parsedArray = new Array();
	this.setCheckList = "";
	this._parse(l, g.id, 2);
	var s = this.setCheckList.split(this.dlmtr);
	for (var m = 0; m < this.parsedArray.length; m++) {
		g.htmlNode.childNodes[0].appendChild(this.parsedArray[m])
	}
	if (l.get("order") && l.get("order") != "none") {
		this._reorderBranch(g, l.get("order"), true)
	}
	this.oldsmcheck = this.smcheck;
	this.smcheck = false;
	for (var c = 0; c < s.length; c++) {
		if (s[c]) {
			this.setCheck(s[c], 1)
		}
	}
	this.smcheck = this.oldsmcheck;
	this.parsingOn = a;
	this.waitUpdateXML = q;
	this.parsedArray = r;
	this.XMLloadingWarning = 0;
	this._redrawFrom(this, g);
	if (this._srnd && !g._sready) {
		this.prepareSR(g.id)
	}
	this.xmlstate = 0;
	return true
};
dhtmlXTreeObject.prototype.preParse = function(c) {
	if (!c || !this._p) {
		return null
	}
	var a = false;
	this._p.clone().through("item", "id", c, function(l) {
		this._globalIdStorageFind(l.up().get("id"));
		return a = true
	}, this);
	if (a) {
		var g = this._globalIdStorageFind(c, true, false);
		if (!g) {
			dhx4.callEvent("ongetItemError", ["The item " + c + " not operable. Seems you have non-unique|incorrect IDs in tree's XML.", c])
		}
	}
	return g
};
dhtmlXTreeObject.prototype._escape = function(a) {
	switch (this.utfesc) {
		case "none":
			return a;
			break;
		case "utf8":
			return encodeURIComponent(a);
			break;
		default:
			return escape(a);
			break
	}
};
dhtmlXTreeObject.prototype._drawNewTr = function(m, g) {
	var l = document.createElement("tr");
	var c = document.createElement("td");
	var a = document.createElement("td");
	c.appendChild(document.createTextNode(" "));
	a.colSpan = 3;
	a.appendChild(m);
	l.appendChild(c);
	l.appendChild(a);
	return l
};
dhtmlXTreeObject.prototype.loadXMLString = function(g, c) {
	var a = this;
	if (!this.parsCount) {
		this.callEvent("onXLS", [a, null])
	}
	this.xmlstate = 1;
	this.XMLLoader({
		responseXML: dhx4.ajax.parse(g)
	}, c)
};
dhtmlXTreeObject.prototype.loadXML = function(c, l) {
	if (this._datamode && this._datamode != "xml") {
		return this["load" + this._datamode.toUpperCase()](c, l)
	}
	var g = this;
	if (!this.parsCount) {
		this.callEvent("onXLS", [g, this._ld_id])
	}
	this._ld_id = null;
	this.xmlstate = 1;
	this.XMLLoader = this._parseXMLTree;
	var a = this;
	dhx4.ajax.get(c, function(m) {
		a.XMLLoader(m.xmlDoc, l);
		a = null
	})
};
dhtmlXTreeObject.prototype._attachChildNode = function(q, o, l, r, F, E, D, s, g, w, x) {
	if (w && w.parentObject) {
		q = w.parentObject
	}
	if (((q.XMLload == 0) && (this.XMLsource)) && (!this.XMLloadingWarning)) {
		q.XMLload = 1;
		this._loadDynXML(q.id)
	}
	var u = q.childsCount;
	var H = q.childNodes;
	if (x && x.tr.previousSibling) {
		if (x.tr.previousSibling.previousSibling) {
			w = x.tr.previousSibling.nodem
		} else {
			s = s.replace("TOP", "") + ",TOP"
		}
	}
	if (w) {
		var m, C;
		for (m = 0; m < u; m++) {
			if (H[m] == w) {
				for (C = u; C != m; C--) {
					H[1 + C] = H[C]
				}
				break
			}
		}
		m++;
		u = m
	}
	if (s) {
		var y = s.split(",");
		for (var A = 0; A < y.length; A++) {
			switch (y[A]) {
				case "TOP":
					if (q.childsCount > 0) {
						w = new Object;
						w.tr = q.childNodes[0].tr.previousSibling
					}
					q._has_top = true;
					for (m = u; m > 0; m--) {
						H[m] = H[m - 1]
					}
					u = 0;
					break
			}
		}
	}
	var v;
	if (!(v = this._idpull[o]) || v.span != -1) {
		v = H[u] = new dhtmlXTreeItemObject(o, l, q, this, r, 1);
		o = H[u].id;
		q.childsCount++
	}
	if (!v.htmlNode) {
		v.label = l;
		v.htmlNode = this._createItem((this.checkBoxOff ? 1 : 0), v);
		v.htmlNode.objBelong = v
	}
	if (F) {
		v.images[0] = F
	}
	if (E) {
		v.images[1] = E
	}
	if (D) {
		v.images[2] = D
	}
	var c = this._drawNewTr(v.htmlNode);
	if ((this.XMLloadingWarning) || (this._hAdI)) {
		v.htmlNode.parentNode.parentNode.style.display = "none"
	}
	if ((w) && w.tr && (w.tr.nextSibling)) {
		q.htmlNode.childNodes[0].insertBefore(c, w.tr.nextSibling)
	} else {
		if (this.parsingOn == q.id) {
			this.parsedArray[this.parsedArray.length] = c
		} else {
			q.htmlNode.childNodes[0].appendChild(c)
		}
	}
	if ((w) && (!w.span)) {
		w = null
	}
	if (this.XMLsource) {
		if ((g) && (g != 0)) {
			v.XMLload = 0
		} else {
			v.XMLload = 1
		}
	}
	v.tr = c;
	c.nodem = v;
	if (q.itemId == 0) {
		c.childNodes[0].className = "hiddenRow"
	}
	if ((q._r_logic) || (this._frbtr)) {
		this._setSrc(v.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0], this.imPath + this.radioArray[0])
	}
	if (s) {
		var y = s.split(",");
		for (var A = 0; A < y.length; A++) {
			switch (y[A]) {
				case "SELECT":
					this.selectItem(o, false);
					break;
				case "CALL":
					this.selectItem(o, true);
					break;
				case "CHILD":
					v.XMLload = 0;
					break;
				case "CHECKED":
					if (this.XMLloadingWarning) {
						this.setCheckList += this.dlmtr + o
					} else {
						this.setCheck(o, 1)
					}
					break;
				case "HCHECKED":
					this._setCheck(v, "unsure");
					break;
				case "OPEN":
					v.openMe = 1;
					break
			}
		}
	}
	if (!this.XMLloadingWarning) {
		if ((this._getOpenState(q) < 0) && (!this._hAdI)) {
			this.openItem(q.id)
		}
		if (w) {
			this._correctPlus(w);
			this._correctLine(w)
		}
		this._correctPlus(q);
		this._correctLine(q);
		this._correctPlus(v);
		if (q.childsCount >= 2) {
			this._correctPlus(H[q.childsCount - 2]);
			this._correctLine(H[q.childsCount - 2])
		}
		if (q.childsCount != 2) {
			this._correctPlus(H[0])
		}
		if (this.tscheck) {
			this._correctCheckStates(q)
		}
		if (this._onradh) {
			if (this.xmlstate == 1) {
				var a = this.onXLE;
				this.onXLE = function(n) {
					this._onradh(o);
					if (a) {
						a(n)
					}
				}
			} else {
				this._onradh(o)
			}
		}
	}
	return v
};
dhtmlXTreeObject.prototype.enableContextMenu = function(a) {
	if (a) {
		this.cMenu = a
	}
};
dhtmlXTreeObject.prototype.setItemContextMenu = function(n, m) {
	var a = n.toString().split(this.dlmtr);
	for (var g = 0; g < a.length; g++) {
		var c = this._globalIdStorageFind(a[g]);
		if (!c) {
			continue
		}
		c.cMenu = m
	}
};
dhtmlXTreeObject.prototype.insertNewItem = function(l, q, s, g, o, n, m, c, a) {
	var u = this._globalIdStorageFind(l);
	if (!u) {
		return (-1)
	}
	var r = this._attachChildNode(u, q, s, g, o, n, m, c, a);
	if (!this._idpull[this.rootId].XMLload) {
		this._idpull[this.rootId].XMLload = 1
	}
	if ((!this.XMLloadingWarning) && (this.childCalc)) {
		this._fixChildCountLabel(u)
	}
	return r
};
dhtmlXTreeObject.prototype.insertNewChild = function(l, q, r, g, o, n, m, c, a) {
	return this.insertNewItem(l, q, r, g, o, n, m, c, a)
};
dhtmlXTreeObject.prototype._parseXMLTree = function(a, g) {
	var c = new xmlPointer(dhx4.ajax.xmltop("tree", a));
	this._parse(c);
	this._p = c;
	if (g) {
		g.call(this, a)
	}
};
dhtmlXTreeObject.prototype._parseItem = function(n, s, m, q) {
	var g;
	if (this._srnd && (!this._idpull[g = n.get("id")] || !this._idpull[g].span)) {
		this._addItemSRND(s.id, g, n);
		return
	}
	var o = n.get_all();
	if ((typeof(this.waitUpdateXML) == "object") && (!this.waitUpdateXML[o.id])) {
		this._parse(n, o.id, 1);
		return
	}
	if ((o.text === null) || (typeof(o.text) == "undefined")) {
		o.text = n.sub("itemtext");
		if (o.text) {
			o.text = o.text.content()
		}
	}
	var v = [];
	if (o.select) {
		v.push("SELECT")
	}
	if (o.top) {
		v.push("TOP")
	}
	if (o.call) {
		this.nodeAskingCall = o.id
	}
	if (o.checked == -1) {
		v.push("HCHECKED")
	} else {
		if (o.checked) {
			v.push("CHECKED")
		}
	}
	if (o.open) {
		v.push("OPEN")
	}
	if (this.waitUpdateXML) {
		if (this._globalIdStorageFind(o.id)) {
			var r = this.updateItem(o.id, o.text, o.im0, o.im1, o.im2, o.checked, o.child)
		} else {
			if (this.npl == 0) {
				v.push("TOP")
			} else {
				m = s.childNodes[this.npl]
			}
			var r = this._attachChildNode(s, o.id, o.text, 0, o.im0, o.im1, o.im2, v.join(","), o.child, 0, m);
			o.id = r.id;
			m = null
		}
	} else {
		var r = this._attachChildNode(s, o.id, o.text, 0, o.im0, o.im1, o.im2, v.join(","), o.child, (q || 0), m)
	}
	if (o.tooltip) {
		r.span.parentNode.parentNode.title = o.tooltip
	}
	if (o.style) {
		if (r.span.style.cssText) {
			r.span.style.cssText += (";" + o.style)
		} else {
			r.span.setAttribute("style", r.span.getAttribute("style") + "; " + o.style)
		}
	}
	if (o.radio) {
		r._r_logic = true
	}
	if (o.nocheckbox) {
		var u = r.span.parentNode.previousSibling.previousSibling;
		u.style.display = "none";
		r.nocheckbox = true
	}
	if (o.disabled) {
		if (o.checked != null) {
			this._setCheck(r, o.checked)
		}
		this.disableCheckbox(r, 1)
	}
	r._acc = o.child || 0;
	if (this.parserExtension) {
		this.parserExtension._parseExtension.call(this, n, o, (s ? s.id : 0))
	}
	this.setItemColor(r, o.aCol, o.sCol);
	if (o.locked == "1") {
		this.lockItem(r.id, true, true)
	}
	if ((o.imwidth) || (o.imheight)) {
		this.setIconSize(o.imwidth, o.imheight, r)
	}
	if ((o.closeable == "0") || (o.closeable == "1")) {
		this.setItemCloseable(r, o.closeable)
	}
	var l = "";
	if (o.topoffset) {
		this.setItemTopOffset(r, o.topoffset)
	}
	if ((!this.slowParse) || (typeof(this.waitUpdateXML) == "object")) {
		if (n.sub_exists("item")) {
			l = this._parse(n, o.id, 1)
		}
	} else {
		if ((!r.childsCount) && n.sub_exists("item")) {
			r.unParsed = n.clone()
		}
		n.each("userdata", function(a) {
			this.setUserData(o.id, a.get("name"), a.content())
		}, this)
	}
	if (l != "") {
		this.nodeAskingCall = l
	}
	n.each("userdata", function(a) {
		this.setUserData(n.get("id"), a.get("name"), a.content())
	}, this)
};
dhtmlXTreeObject.prototype._parse = function(g, o, a, c) {
	if (this._srnd && !this.parentObject.offsetHeight) {
		var x = this;
		return window.setTimeout(function() {
			x._parse(g, o, a, c)
		}, 100)
	}
	if (!g.exists()) {
		return
	}
	this.skipLock = true;
	if (!o) {
		o = g.get("id");
		var v = g.get("dhx_security");
		if (v) {
			dhtmlx.security_key = v
		}
		if (g.get("radio")) {
			this.htmlNode._r_logic = true
		}
		this.parsingOn = o;
		this.parsedArray = new Array();
		this.setCheckList = "";
		this.nodeAskingCall = ""
	}
	var w = this._globalIdStorageFind(o);
	if (!w) {
		return dhx4.callEvent("onDataStructureError", ["XML refers to not existing parent"])
	}
	this.parsCount = this.parsCount ? (this.parsCount + 1) : 1;
	this.XMLloadingWarning = 1;
	if ((w.childsCount) && (!c) && (!this._edsbps) && (!w._has_top)) {
		var q = 0
	} else {
		var q = 0
	}
	this.npl = 0;
	g.each("item", function(y, n) {
		w.XMLload = 1;
		this._parseItem(y, w, 0, q);
		if ((this._edsbps) && (this.npl == this._edsbpsC)) {
			this._distributedStart(g, n + 1, o, a, w.childsCount);
			return -1
		}
		this.npl++
	}, this, c);
	if (!a) {
		g.each("userdata", function(n) {
			this.setUserData(g.get("id"), n.get("name"), n.content())
		}, this);
		w.XMLload = 1;
		if (this.waitUpdateXML) {
			this.waitUpdateXML = false;
			for (var m = w.childsCount - 1; m >= 0; m--) {
				if (w.childNodes[m]._dmark) {
					this.deleteItem(w.childNodes[m].id)
				}
			}
		}
		var s = this._globalIdStorageFind(this.parsingOn);
		for (var m = 0; m < this.parsedArray.length; m++) {
			w.htmlNode.childNodes[0].appendChild(this.parsedArray[m])
		}
		this.parsedArray = [];
		this.lastLoadedXMLId = o;
		this.XMLloadingWarning = 0;
		var u = this.setCheckList.split(this.dlmtr);
		for (var l = 0; l < u.length; l++) {
			if (u[l]) {
				this.setCheck(u[l], 1)
			}
		}
		if ((this.XMLsource) && (this.tscheck) && (this.smcheck) && (w.id != this.rootId)) {
			if (w.checkstate === 0) {
				this._setSubChecked(0, w)
			} else {
				if (w.checkstate === 1) {
					this._setSubChecked(1, w)
				}
			}
		}
		this._redrawFrom(this, null, c);
		if (g.get("order") && g.get("order") != "none") {
			this._reorderBranch(w, g.get("order"), true)
		}
		if (this.nodeAskingCall != "") {
			this.callEvent("onClick", [this.nodeAskingCall, this.getSelectedItemId()])
		}
		if (this._branchUpdate) {
			this._branchUpdateNext(g)
		}
	}
	if (this.parsCount == 1) {
		this.parsingOn = null;
		if (this._srnd && w.id != this.rootId) {
			this.prepareSR(w.id);
			if (this.XMLsource) {
				this.openItem(w.id)
			}
		}
		g.through("item", "open", null, function(n) {
			this.openItem(n.get("id"))
		}, this);
		if ((!this._edsbps) || (!this._edsbpsA.length)) {
			var r = this;
			window.setTimeout(function() {
				r.callEvent("onXLE", [r, o])
			}, 1);
			this.xmlstate = 0
		}
		this.skipLock = false
	}
	this.parsCount--;
	var r = this;
	if (this._edsbps) {
		window.setTimeout(function() {
			r._distributedStep(o)
		}, this._edsbpsD)
	}
	if (!a && this.onXLE) {
		this.onXLE(this, o)
	}
	return this.nodeAskingCall
};
dhtmlXTreeObject.prototype._branchUpdateNext = function(a) {
	a.each("item", function(l) {
		var g = l.get("id");
		if (this._idpull[g] && (!this._idpull[g].XMLload)) {
			return
		}
		this._branchUpdate++;
		this.smartRefreshItem(l.get("id"), l)
	}, this);
	this._branchUpdate--
};
dhtmlXTreeObject.prototype.checkUserData = function(c, g) {
	if ((c.nodeType == 1) && (c.tagName == "userdata")) {
		var a = c.getAttribute("name");
		if ((a) && (c.childNodes[0])) {
			this.setUserData(g, a, c.childNodes[0].data)
		}
	}
};
dhtmlXTreeObject.prototype._redrawFrom = function(q, c, o, g) {
	if (!c) {
		var m = q._globalIdStorageFind(q.lastLoadedXMLId);
		q.lastLoadedXMLId = -1;
		if (!m) {
			return 0
		}
	} else {
		m = c
	}
	var n = 0;
	for (var l = (o ? o - 1 : 0); l < m.childsCount; l++) {
		if ((!this._branchUpdate) || (this._getOpenState(m) == 1)) {
			if ((!c) || (g == 1)) {
				m.childNodes[l].htmlNode.parentNode.parentNode.style.display = ""
			}
		}
		if (m.childNodes[l].openMe == 1) {
			this._openItem(m.childNodes[l]);
			m.childNodes[l].openMe = 0
		}
		q._redrawFrom(q, m.childNodes[l]);
		if (this.childCalc != null) {
			if ((m.childNodes[l].unParsed) || ((!m.childNodes[l].XMLload) && (this.XMLsource))) {
				if (m.childNodes[l]._acc) {
					m.childNodes[l].span.innerHTML = m.childNodes[l].label + this.htmlcA + m.childNodes[l]._acc + this.htmlcB
				} else {
					m.childNodes[l].span.innerHTML = m.childNodes[l].label
				}
			}
			if ((m.childNodes[l].childNodes.length) && (this.childCalc)) {
				if (this.childCalc == 1) {
					m.childNodes[l].span.innerHTML = m.childNodes[l].label + this.htmlcA + m.childNodes[l].childsCount + this.htmlcB
				}
				if (this.childCalc == 2) {
					var a = m.childNodes[l].childsCount - (m.childNodes[l].pureChilds || 0);
					if (a) {
						m.childNodes[l].span.innerHTML = m.childNodes[l].label + this.htmlcA + a + this.htmlcB
					}
					if (m.pureChilds) {
						m.pureChilds++
					} else {
						m.pureChilds = 1
					}
				}
				if (this.childCalc == 3) {
					m.childNodes[l].span.innerHTML = m.childNodes[l].label + this.htmlcA + m.childNodes[l]._acc + this.htmlcB
				}
				if (this.childCalc == 4) {
					var a = m.childNodes[l]._acc;
					if (a) {
						m.childNodes[l].span.innerHTML = m.childNodes[l].label + this.htmlcA + a + this.htmlcB
					}
				}
			} else {
				if (this.childCalc == 4) {
					n++
				}
			}
			n += m.childNodes[l]._acc;
			if (this.childCalc == 3) {
				n++
			}
		}
	}
	if ((!m.unParsed) && ((m.XMLload) || (!this.XMLsource))) {
		m._acc = n
	}
	q._correctLine(m);
	q._correctPlus(m);
	if ((this.childCalc) && (!c)) {
		q._fixChildCountLabel(m)
	}
};
dhtmlXTreeObject.prototype._createSelf = function() {
	var a = document.createElement("div");
	a.className = "containerTableStyle";
	a.style.width = this.width;
	a.style.height = this.height;
	this.parentObject.appendChild(a);
	return a
};
dhtmlXTreeObject.prototype._xcloseAll = function(c) {
	if (c.unParsed) {
		return
	}
	if (this.rootId != c.id) {
		if (!c.htmlNode) {
			return
		}
		var l = c.htmlNode.childNodes[0].childNodes;
		var a = l.length;
		for (var g = 1; g < a; g++) {
			l[g].style.display = "none"
		}
		this._correctPlus(c)
	}
	for (var g = 0; g < c.childsCount; g++) {
		if (c.childNodes[g].childsCount) {
			this._xcloseAll(c.childNodes[g])
		}
	}
};
dhtmlXTreeObject.prototype._xopenAll = function(a) {
	this._HideShow(a, 2);
	for (var c = 0; c < a.childsCount; c++) {
		this._xopenAll(a.childNodes[c])
	}
};
dhtmlXTreeObject.prototype._correctPlus = function(c) {
	if (!c.htmlNode) {
		return
	}
	var g = c.htmlNode.childNodes[0].childNodes[0].childNodes[0].lastChild;
	var m = c.htmlNode.childNodes[0].childNodes[0].childNodes[2].childNodes[0];
	var a = this.lineArray;
	if ((this.XMLsource) && (!c.XMLload)) {
		var a = this.plusArray;
		this._setSrc(m, this.iconURL + c.images[2]);
		if (this._txtimg) {
			return (g.innerHTML = "[+]")
		}
	} else {
		if ((c.childsCount) || (c.unParsed)) {
			if ((c.htmlNode.childNodes[0].childNodes[1]) && (c.htmlNode.childNodes[0].childNodes[1].style.display != "none")) {
				if (!c.wsign) {
					var a = this.minusArray
				}
				this._setSrc(m, this.iconURL + c.images[1]);
				if (this._txtimg) {
					return (g.innerHTML = "[-]")
				}
			} else {
				if (!c.wsign) {
					var a = this.plusArray
				}
				this._setSrc(m, this.iconURL + c.images[2]);
				if (this._txtimg) {
					return (g.innerHTML = "[+]")
				}
			}
		} else {
			this._setSrc(m, this.iconURL + c.images[0])
		}
	}
	var l = 2;
	if (!c.treeNod.treeLinesOn) {
		this._setSrc(g, this.imPath + a[3])
	} else {
		if (c.parentObject) {
			l = this._getCountStatus(c.id, c.parentObject)
		}
		this._setSrc(g, this.imPath + a[l])
	}
};
dhtmlXTreeObject.prototype._correctLine = function(c) {
	if (!c.htmlNode) {
		return
	}
	var a = c.parentObject;
	if (a) {
		if ((this._getLineStatus(c.id, a) == 0) || (!this.treeLinesOn)) {
			for (var g = 1; g <= c.childsCount; g++) {
				if (!c.htmlNode.childNodes[0].childNodes[g]) {
					break
				}
				c.htmlNode.childNodes[0].childNodes[g].childNodes[0].style.backgroundImage = "";
				c.htmlNode.childNodes[0].childNodes[g].childNodes[0].style.backgroundRepeat = ""
			}
		} else {
			for (var g = 1; g <= c.childsCount; g++) {
				if (!c.htmlNode.childNodes[0].childNodes[g]) {
					break
				}
				c.htmlNode.childNodes[0].childNodes[g].childNodes[0].style.backgroundImage = "url(" + this.imPath + this.lineArray[5] + ")";
				c.htmlNode.childNodes[0].childNodes[g].childNodes[0].style.backgroundRepeat = "repeat-y"
			}
		}
	}
};
dhtmlXTreeObject.prototype._getCountStatus = function(c, a) {
	if (a.childsCount <= 1) {
		if (a.id == this.rootId) {
			return 4
		} else {
			return 0
		}
	}
	if (a.childNodes[0].id == c) {
		if (a.id == this.rootId) {
			return 2
		} else {
			return 1
		}
	}
	if (a.childNodes[a.childsCount - 1].id == c) {
		return 0
	}
	return 1
};
dhtmlXTreeObject.prototype._getLineStatus = function(c, a) {
	if (a.childNodes[a.childsCount - 1].id == c) {
		return 0
	}
	return 1
};
dhtmlXTreeObject.prototype._HideShow = function(c, m) {
	if ((this.XMLsource) && (!c.XMLload)) {
		if (m == 1) {
			return
		}
		c.XMLload = 1;
		this._loadDynXML(c.id);
		return
	}
	if (c.unParsed) {
		this.reParse(c)
	}
	var l = c.htmlNode.childNodes[0].childNodes;
	var a = l.length;
	if (a > 1) {
		if (((l[1].style.display != "none") || (m == 1)) && (m != 2)) {
			this.allTree.childNodes[0].border = "1";
			this.allTree.childNodes[0].border = "0";
			nodestyle = "none"
		} else {
			nodestyle = ""
		}
		for (var g = 1; g < a; g++) {
			l[g].style.display = nodestyle
		}
	}
	this._correctPlus(c)
};
dhtmlXTreeObject.prototype._getOpenState = function(a) {
	if (!a.htmlNode) {
		return 0
	}
	var c = a.htmlNode.childNodes[0].childNodes;
	if (c.length <= 1) {
		return 0
	}
	if (c[1].style.display != "none") {
		return 1
	} else {
		return -1
	}
};
dhtmlXTreeObject.prototype.onRowClick2 = function() {
	var a = this.parentObject.treeNod;
	if (!a.callEvent("onDblClick", [this.parentObject.id, a])) {
		return false
	}
	if ((this.parentObject.closeble) && (this.parentObject.closeble != "0")) {
		a._HideShow(this.parentObject)
	} else {
		a._HideShow(this.parentObject, 2)
	}
	if (a.checkEvent("onOpenEnd")) {
		if (!a.xmlstate) {
			a.callEvent("onOpenEnd", [this.parentObject.id, a._getOpenState(this.parentObject)])
		} else {
			a._oie_onXLE.push(a.onXLE);
			a.onXLE = a._epnFHe
		}
	}
	return false
};
dhtmlXTreeObject.prototype.onRowClick = function() {
	var a = this.parentObject.treeNod;
	if (!a.callEvent("onOpenStart", [this.parentObject.id, a._getOpenState(this.parentObject)])) {
		return 0
	}
	if ((this.parentObject.closeble) && (this.parentObject.closeble != "0")) {
		a._HideShow(this.parentObject)
	} else {
		a._HideShow(this.parentObject, 2)
	}
	if (a.checkEvent("onOpenEnd")) {
		if (!a.xmlstate) {
			a.callEvent("onOpenEnd", [this.parentObject.id, a._getOpenState(this.parentObject)])
		} else {
			a._oie_onXLE.push(a.onXLE);
			a.onXLE = a._epnFHe
		}
	}
};
dhtmlXTreeObject.prototype._epnFHe = function(c, g, a) {
	if (g != this.rootId) {
		this.callEvent("onOpenEnd", [g, c.getOpenState(g)])
	}
	c.onXLE = c._oie_onXLE.pop();
	if (!a && !c._oie_onXLE.length) {
		if (c.onXLE) {
			c.onXLE(c, g)
		}
	}
};
dhtmlXTreeObject.prototype.onRowClickDown = function(c) {
	c = c || window.event;
	var a = this.parentObject.treeNod;
	a._selectItem(this.parentObject, c)
};
dhtmlXTreeObject.prototype.getSelectedItemId = function() {
	var c = new Array();
	for (var a = 0; a < this._selected.length; a++) {
		c[a] = this._selected[a].id
	}
	return (c.join(this.dlmtr))
};
dhtmlXTreeObject.prototype._selectItem = function(n, o) {
	if (this.checkEvent("onSelect")) {
		this._onSSCFold = this.getSelectedItemId()
	}
	if ((!this._amsel) || (!o) || ((!o.ctrlKey) && (!o.metaKey) && (!o.shiftKey))) {
		this._unselectItems()
	}
	if ((n.i_sel) && (this._amsel) && (o) && (o.ctrlKey || o.metaKey)) {
		this._unselectItem(n)
	} else {
		if ((!n.i_sel) && ((!this._amselS) || (this._selected.length == 0) || (this._selected[0].parentObject == n.parentObject))) {
			if ((this._amsel) && (o) && (o.shiftKey) && (this._selected.length != 0) && (this._selected[this._selected.length - 1].parentObject == n.parentObject)) {
				var l = this._getIndex(this._selected[this._selected.length - 1]);
				var g = this._getIndex(n);
				if (g < l) {
					var r = l;
					l = g;
					g = r
				}
				for (var m = l; m <= g; m++) {
					if (!n.parentObject.childNodes[m].i_sel) {
						this._markItem(n.parentObject.childNodes[m])
					}
				}
			} else {
				this._markItem(n)
			}
		}
	}
	if (this.checkEvent("onSelect")) {
		var q = this.getSelectedItemId();
		if (q != this._onSSCFold) {
			this.callEvent("onSelect", [q])
		}
	}
};
dhtmlXTreeObject.prototype._markItem = function(a) {
	if (a.scolor) {
		a.span.style.color = a.scolor
	}
	a.span.className = "selectedTreeRow";
	a.i_sel = true;
	this._selected[this._selected.length] = a
};
dhtmlXTreeObject.prototype.getIndexById = function(c) {
	var a = this._globalIdStorageFind(c);
	if (!a) {
		return null
	}
	return this._getIndex(a)
};
dhtmlXTreeObject.prototype._getIndex = function(a) {
	var g = a.parentObject;
	for (var c = 0; c < g.childsCount; c++) {
		if (g.childNodes[c] == a) {
			return c
		}
	}
};
dhtmlXTreeObject.prototype._unselectItem = function(c) {
	if ((c) && (c.i_sel)) {
		c.span.className = "standartTreeRow";
		if (c.acolor) {
			c.span.style.color = c.acolor
		}
		c.i_sel = false;
		for (var a = 0; a < this._selected.length; a++) {
			if (!this._selected[a].i_sel) {
				this._selected.splice(a, 1);
				break
			}
		}
	}
};
dhtmlXTreeObject.prototype._unselectItems = function() {
	for (var a = 0; a < this._selected.length; a++) {
		var c = this._selected[a];
		c.span.className = "standartTreeRow";
		if (c.acolor) {
			c.span.style.color = c.acolor
		}
		c.i_sel = false
	}
	this._selected = new Array()
};
dhtmlXTreeObject.prototype.onRowSelect = function(l, g, n) {
	l = l || window.event;
	var c = this.parentObject;
	if (g) {
		c = g.parentObject
	}
	var a = c.treeNod;
	var m = a.getSelectedItemId();
	if ((!l) || (!l.skipUnSel)) {
		a._selectItem(c, l)
	}
	if (!n) {
		if (c.actionHandler) {
			c.actionHandler(c.id, m)
		} else {
			a.callEvent("onClick", [c.id, m])
		}
	}
};
dhtmlXTreeObject.prototype._correctCheckStates = function(m) {
	if (!this.tscheck) {
		return
	}
	if (!m) {
		return
	}
	if (m.id == this.rootId) {
		return
	}
	var g = m.childNodes;
	var c = 0;
	var a = 0;
	if (m.childsCount == 0) {
		return
	}
	for (var l = 0; l < m.childsCount; l++) {
		if (g[l].dscheck) {
			continue
		}
		if (g[l].checkstate == 0) {
			c = 1
		} else {
			if (g[l].checkstate == 1) {
				a = 1
			} else {
				c = 1;
				a = 1;
				break
			}
		}
	}
	if ((c) && (a)) {
		this._setCheck(m, "unsure")
	} else {
		if (c) {
			this._setCheck(m, false)
		} else {
			this._setCheck(m, true)
		}
	}
	this._correctCheckStates(m.parentObject)
};
dhtmlXTreeObject.prototype.onCheckBoxClick = function(a) {
	if (!this.treeNod.callEvent("onBeforeCheck", [this.parentObject.id, this.parentObject.checkstate])) {
		return
	}
	if (this.parentObject.dscheck) {
		return true
	}
	if (this.treeNod.tscheck) {
		if (this.parentObject.checkstate == 1) {
			this.treeNod._setSubChecked(false, this.parentObject)
		} else {
			this.treeNod._setSubChecked(true, this.parentObject)
		}
	} else {
		if (this.parentObject.checkstate == 1) {
			this.treeNod._setCheck(this.parentObject, false)
		} else {
			this.treeNod._setCheck(this.parentObject, true)
		}
	}
	this.treeNod._correctCheckStates(this.parentObject.parentObject);
	return this.treeNod.callEvent("onCheck", [this.parentObject.id, this.parentObject.checkstate])
};
dhtmlXTreeObject.prototype._createItem = function(v, u, q) {
	var w = document.createElement("table");
	w.cellSpacing = 0;
	w.cellPadding = 0;
	w.border = 0;
	if (this.hfMode) {
		w.style.tableLayout = "fixed"
	}
	w.style.margin = 0;
	w.style.padding = 0;
	var o = document.createElement("tbody");
	var s = document.createElement("tr");
	var l = document.createElement("td");
	l.className = "standartTreeImage";
	if (this._txtimg) {
		var m = document.createElement("div");
		l.appendChild(m);
		m.className = "dhx_tree_textSign"
	} else {
		var m = this._getImg(u.id);
		m.border = "0";
		if (m.tagName == "IMG") {
			m.align = "absmiddle"
		}
		l.appendChild(m);
		m.style.padding = 0;
		m.style.margin = 0;
		m.style.width = this.def_line_img_x
	}
	var g = document.createElement("td");
	var r = this._getImg(this.cBROf ? this.rootId : u.id);
	r.checked = 0;
	this._setSrc(r, this.imPath + this.checkArray[0]);
	r.style.width = "18px";
	r.style.height = "18px";
	if (!v) {
		g.style.display = "none"
	}
	g.appendChild(r);
	if ((!this.cBROf) && (r.tagName == "IMG")) {
		r.align = "absmiddle"
	}
	r.onclick = this.onCheckBoxClick;
	r.treeNod = this;
	r.parentObject = u;
	if (!window._KHTMLrv) {
		g.width = "20px"
	} else {
		g.width = "16px"
	}
	var c = document.createElement("td");
	c.className = "standartTreeImage";
	var n = this._getImg(this.timgen ? u.id : this.rootId);
	n.onmousedown = this._preventNsDrag;
	n.ondragstart = this._preventNsDrag;
	n.border = "0";
	if (this._aimgs) {
		n.parentObject = u;
		if (n.tagName == "IMG") {
			n.align = "absmiddle"
		}
		n.onclick = this.onRowSelect
	}
	if (!q) {
		this._setSrc(n, this.iconURL + this.imageArray[0])
	}
	c.appendChild(n);
	n.style.padding = 0;
	n.style.margin = 0;
	if (this.timgen) {
		c.style.width = n.style.width = this.def_img_x;
		n.style.height = this.def_img_y
	} else {
		n.style.width = "0px";
		n.style.height = "0px";
		if (_isOpera || window._KHTMLrv) {
			c.style.display = "none"
		}
	}
	var a = document.createElement("td");
	a.className = "standartTreeRow";
	u.span = document.createElement("span");
	u.span.className = "standartTreeRow";
	if (this.mlitems) {
		u.span.style.width = this.mlitems;
		u.span.style.display = "block"
	} else {
		a.noWrap = true
	}
	if (dhx4.isIE8) {
		a.style.width = "99999px"
	} else {
		if (!window._KHTMLrv) {
			a.style.width = "100%"
		}
	}
	u.span.innerHTML = u.label;
	a.appendChild(u.span);
	a.parentObject = u;
	l.parentObject = u;
	a.onclick = this.onRowSelect;
	l.onclick = this.onRowClick;
	a.ondblclick = this.onRowClick2;
	if (this.ettip) {
		s.title = u.label
	}
	if (this.dragAndDropOff) {
		if (this._aimgs) {
			this.dragger.addDraggableItem(c, this);
			c.parentObject = u
		}
		this.dragger.addDraggableItem(a, this)
	}
	u.span.style.paddingLeft = "5px";
	u.span.style.paddingRight = "5px";
	a.style.verticalAlign = "";
	a.style.fontSize = "10pt";
	a.style.cursor = this.style_pointer;
	s.appendChild(l);
	s.appendChild(g);
	s.appendChild(c);
	s.appendChild(a);
	o.appendChild(s);
	w.appendChild(o);
	if (this.ehlt || this.checkEvent("onMouseIn") || this.checkEvent("onMouseOut")) {
		s.onmousemove = this._itemMouseIn;
		s[(_isIE) ? "onmouseleave" : "onmouseout"] = this._itemMouseOut
	}
	return w
};
dhtmlXTreeObject.prototype.setImagePath = function(a) {
	this.imPath = a;
	this.iconURL = a
};
dhtmlXTreeObject.prototype.setIconPath = function(a) {
	this.iconURL = a
};
dhtmlXTreeObject.prototype._getLeafCount = function(l) {
	var g = 0;
	for (var c = 0; c < l.childsCount; c++) {
		if (l.childNodes[c].childsCount == 0) {
			g++
		}
	}
	return g
};
dhtmlXTreeObject.prototype._getChildCounterValue = function(c) {
	var a = this._globalIdStorageFind(c);
	if (!a) {
		return 0
	}
	if ((a.unParsed) || ((!a.XMLload) && (this.XMLsource))) {
		return a._acc
	}
	switch (this.childCalc) {
		case 1:
			return a.childsCount;
			break;
		case 2:
			return this._getLeafCount(a);
			break;
		case 3:
			return a._acc;
			break;
		case 4:
			return a._acc;
			break
	}
};
dhtmlXTreeObject.prototype._fixChildCountLabel = function(n, l) {
	if (this.childCalc == null) {
		return
	}
	if ((n.unParsed) || ((!n.XMLload) && (this.XMLsource))) {
		if (n._acc) {
			n.span.innerHTML = n.label + this.htmlcA + n._acc + this.htmlcB
		} else {
			n.span.innerHTML = n.label
		}
		return
	}
	switch (this.childCalc) {
		case 1:
			if (n.childsCount != 0) {
				n.span.innerHTML = n.label + this.htmlcA + n.childsCount + this.htmlcB
			} else {
				n.span.innerHTML = n.label
			}
			break;
		case 2:
			var m = this._getLeafCount(n);
			if (m != 0) {
				n.span.innerHTML = n.label + this.htmlcA + m + this.htmlcB
			} else {
				n.span.innerHTML = n.label
			}
			break;
		case 3:
			if (n.childsCount != 0) {
				var g = 0;
				for (var c = 0; c < n.childsCount; c++) {
					if (!n.childNodes[c]._acc) {
						n.childNodes[c]._acc = 0
					}
					g += n.childNodes[c]._acc * 1
				}
				g += n.childsCount * 1;
				n.span.innerHTML = n.label + this.htmlcA + g + this.htmlcB;
				n._acc = g
			} else {
				n.span.innerHTML = n.label;
				n._acc = 0
			}
			if ((n.parentObject) && (n.parentObject != this.htmlNode)) {
				this._fixChildCountLabel(n.parentObject)
			}
			break;
		case 4:
			if (n.childsCount != 0) {
				var g = 0;
				for (var c = 0; c < n.childsCount; c++) {
					if (!n.childNodes[c]._acc) {
						n.childNodes[c]._acc = 1
					}
					g += n.childNodes[c]._acc * 1
				}
				n.span.innerHTML = n.label + this.htmlcA + g + this.htmlcB;
				n._acc = g
			} else {
				n.span.innerHTML = n.label;
				n._acc = 1
			}
			if ((n.parentObject) && (n.parentObject != this.htmlNode)) {
				this._fixChildCountLabel(n.parentObject)
			}
			break
	}
};
dhtmlXTreeObject.prototype.setChildCalcMode = function(a) {
	switch (a) {
		case "child":
			this.childCalc = 1;
			break;
		case "leafs":
			this.childCalc = 2;
			break;
		case "childrec":
			this.childCalc = 3;
			break;
		case "leafsrec":
			this.childCalc = 4;
			break;
		case "disabled":
			this.childCalc = null;
			break;
		default:
			this.childCalc = 4
	}
};
dhtmlXTreeObject.prototype.setChildCalcHTML = function(c, a) {
	this.htmlcA = c;
	this.htmlcB = a
};
dhtmlXTreeObject.prototype.setOnRightClickHandler = function(a) {
	this.attachEvent("onRightClick", a)
};
dhtmlXTreeObject.prototype.setOnClickHandler = function(a) {
	this.attachEvent("onClick", a)
};
dhtmlXTreeObject.prototype.setOnSelectStateChange = function(a) {
	this.attachEvent("onSelect", a)
};
dhtmlXTreeObject.prototype.setXMLAutoLoading = function(a) {
	this.XMLsource = a
};
dhtmlXTreeObject.prototype.setOnCheckHandler = function(a) {
	this.attachEvent("onCheck", a)
};
dhtmlXTreeObject.prototype.setOnOpenHandler = function(a) {
	this.attachEvent("onOpenStart", a)
};
dhtmlXTreeObject.prototype.setOnOpenStartHandler = function(a) {
	this.attachEvent("onOpenStart", a)
};
dhtmlXTreeObject.prototype.setOnOpenEndHandler = function(a) {
	this.attachEvent("onOpenEnd", a)
};
dhtmlXTreeObject.prototype.setOnDblClickHandler = function(a) {
	this.attachEvent("onDblClick", a)
};
dhtmlXTreeObject.prototype.openAllItems = function(c) {
	var a = this._globalIdStorageFind(c);
	if (!a) {
		return 0
	}
	this._xopenAll(a)
};
dhtmlXTreeObject.prototype.getOpenState = function(c) {
	var a = this._globalIdStorageFind(c);
	if (!a) {
		return ""
	}
	return this._getOpenState(a)
};
dhtmlXTreeObject.prototype.closeAllItems = function(c) {
	if (c === window.undefined) {
		c = this.rootId
	}
	var a = this._globalIdStorageFind(c);
	if (!a) {
		return 0
	}
	this._xcloseAll(a);
	this.allTree.childNodes[0].border = "1";
	this.allTree.childNodes[0].border = "0"
};
dhtmlXTreeObject.prototype.setUserData = function(l, c, g) {
	var a = this._globalIdStorageFind(l, 0, true);
	if (!a) {
		return
	}
	if (c == "hint") {
		a.htmlNode.childNodes[0].childNodes[0].title = g
	}
	if (typeof(a.userData["t_" + c]) == "undefined") {
		if (!a._userdatalist) {
			a._userdatalist = c
		} else {
			a._userdatalist += "," + c
		}
	}
	a.userData["t_" + c] = g
};
dhtmlXTreeObject.prototype.getUserData = function(g, c) {
	var a = this._globalIdStorageFind(g, 0, true);
	if (!a) {
		return
	}
	return a.userData["t_" + c]
};
dhtmlXTreeObject.prototype.getItemColor = function(g) {
	var a = this._globalIdStorageFind(g);
	if (!a) {
		return 0
	}
	var c = new Object();
	if (a.acolor) {
		c.acolor = a.acolor
	}
	if (a.scolor) {
		c.scolor = a.scolor
	}
	return c
};
dhtmlXTreeObject.prototype.setItemColor = function(g, c, l) {
	if ((g) && (g.span)) {
		var a = g
	} else {
		var a = this._globalIdStorageFind(g)
	}
	if (!a) {
		return 0
	} else {
		if (a.i_sel) {
			if (l) {
				a.span.style.color = l
			}
		} else {
			if (c) {
				a.span.style.color = c
			}
		}
		if (l) {
			a.scolor = l
		}
		if (c) {
			a.acolor = c
		}
	}
};
dhtmlXTreeObject.prototype.getItemText = function(c) {
	var a = this._globalIdStorageFind(c);
	if (!a) {
		return 0
	}
	return (a.htmlNode.childNodes[0].childNodes[0].childNodes[3].childNodes[0].innerHTML)
};
dhtmlXTreeObject.prototype.getParentId = function(c) {
	var a = this._globalIdStorageFind(c);
	if ((!a) || (!a.parentObject)) {
		return ""
	}
	return a.parentObject.id
};
dhtmlXTreeObject.prototype.changeItemId = function(c, g) {
	if (c == g) {
		return
	}
	var a = this._globalIdStorageFind(c);
	if (!a) {
		return 0
	}
	a.id = g;
	a.span.contextMenuId = g;
	this._idpull[g] = this._idpull[c];
	delete this._idpull[c]
};
dhtmlXTreeObject.prototype.doCut = function() {
	if (this.nodeCut) {
		this.clearCut()
	}
	this.nodeCut = (new Array()).concat(this._selected);
	for (var a = 0; a < this.nodeCut.length; a++) {
		var c = this.nodeCut[a];
		c._cimgs = new Array();
		c._cimgs[0] = c.images[0];
		c._cimgs[1] = c.images[1];
		c._cimgs[2] = c.images[2];
		c.images[0] = c.images[1] = c.images[2] = this.cutImage;
		this._correctPlus(c)
	}
};
dhtmlXTreeObject.prototype.doPaste = function(g) {
	var a = this._globalIdStorageFind(g);
	if (!a) {
		return 0
	}
	for (var c = 0; c < this.nodeCut.length; c++) {
		if (this._checkPNodes(a, this.nodeCut[c])) {
			continue
		}
		this._moveNode(this.nodeCut[c], a)
	}
	this.clearCut()
};
dhtmlXTreeObject.prototype.clearCut = function() {
	for (var a = 0; a < this.nodeCut.length; a++) {
		var c = this.nodeCut[a];
		c.images[0] = c._cimgs[0];
		c.images[1] = c._cimgs[1];
		c.images[2] = c._cimgs[2];
		this._correctPlus(c)
	}
	this.nodeCut = new Array()
};
dhtmlXTreeObject.prototype._moveNode = function(a, c) {
	var n = this.dadmodec;
	if (n == 1) {
		var m = c;
		if (this.dadmodefix < 0) {
			while (true) {
				m = this._getPrevNode(m);
				if ((m == -1)) {
					m = this.htmlNode;
					break
				}
				if ((m.tr == 0) || (m.tr.style.display == "") || (!m.parentObject)) {
					break
				}
			}
			var l = m;
			var g = c
		} else {
			if ((m.tr) && (m.tr.nextSibling) && (m.tr.nextSibling.nodem) && (this._getOpenState(m) < 1)) {
				m = m.tr.nextSibling.nodem
			} else {
				m = this._getNextNode(m);
				if ((m == -1)) {
					m = this.htmlNode
				}
			}
			var g = m;
			var l = c
		}
		if (this._getNodeLevel(l, 0) > this._getNodeLevel(g, 0)) {
			if (!this.dropLower) {
				return this._moveNodeTo(a, l.parentObject)
			} else {
				if (g.id != this.rootId) {
					return this._moveNodeTo(a, g.parentObject, g)
				} else {
					return this._moveNodeTo(a, this.htmlNode, null)
				}
			}
		} else {
			return this._moveNodeTo(a, g.parentObject, g)
		}
	} else {
		return this._moveNodeTo(a, c)
	}
};
dhtmlXTreeObject.prototype._fixNodesCollection = function(q, n) {
	var c = 0;
	var l = 0;
	var o = q.childNodes;
	var a = q.childsCount - 1;
	if (n == o[a]) {
		return
	}
	for (var m = 0; m < a; m++) {
		if (o[m] == o[a]) {
			o[m] = o[m + 1];
			o[m + 1] = o[a]
		}
	}
	for (var m = 0; m < a + 1; m++) {
		if (c) {
			var g = o[m];
			o[m] = c;
			c = g
		} else {
			if (o[m] == n) {
				c = o[m];
				o[m] = o[a]
			}
		}
	}
};
dhtmlXTreeObject.prototype._recreateBranch = function(n, q, m, a) {
	var c;
	var r = "";
	if (m) {
		for (c = 0; c < q.childsCount; c++) {
			if (q.childNodes[c] == m) {
				break
			}
		}
		if (c != 0) {
			m = q.childNodes[c - 1]
		} else {
			r = "TOP";
			m = ""
		}
	}
	var g = this._onradh;
	this._onradh = null;
	var o = this._attachChildNode(q, n.id, n.label, 0, n.images[0], n.images[1], n.images[2], r, 0, m);
	o._userdatalist = n._userdatalist;
	o.userData = n.userData.clone();
	if (n._attrs) {
		o._attrs = {};
		for (var l in n._attrs) {
			o._attrs[l] = n._attrs[l]
		}
	}
	o.XMLload = n.XMLload;
	if (g) {
		this._onradh = g;
		this._onradh(o.id)
	}
	if (n.treeNod.dpcpy) {
		n.treeNod._globalIdStorageFind(n.id)
	} else {
		o.unParsed = n.unParsed
	}
	this._correctPlus(o);
	for (var c = 0; c < n.childsCount; c++) {
		this._recreateBranch(n.childNodes[c], o, 0, 1)
	}
	if ((!a) && (this.childCalc)) {
		this._redrawFrom(this, q)
	}
	return o
};
dhtmlXTreeObject.prototype._moveNodeTo = function(v, x, u) {
	if (v.treeNod._nonTrivialNode) {
		return v.treeNod._nonTrivialNode(this, x, u, v)
	}
	if (this._checkPNodes(x, v)) {
		return false
	}
	if (x.mytype) {
		var o = (v.treeNod.lWin != x.lWin)
	} else {
		var o = (v.treeNod.lWin != x.treeNod.lWin)
	}
	if (!this.callEvent("onDrag", [v.id, x.id, (u ? u.id : null), v.treeNod, x.treeNod])) {
		return false
	}
	if ((x.XMLload == 0) && (this.XMLsource)) {
		x.XMLload = 1;
		this._loadDynXML(x.id)
	}
	this.openItem(x.id);
	var g = v.treeNod;
	var r = v.parentObject.childsCount;
	var s = v.parentObject;
	if ((o) || (g.dpcpy)) {
		var l = v.id;
		v = this._recreateBranch(v, x, u);
		if (!g.dpcpy) {
			g.deleteItem(l)
		}
	} else {
		var m = x.childsCount;
		var w = x.childNodes;
		if (m == 0) {
			x._open = true
		}
		g._unselectItem(v);
		w[m] = v;
		v.treeNod = x.treeNod;
		x.childsCount++;
		var q = this._drawNewTr(w[m].htmlNode);
		if (!u) {
			x.htmlNode.childNodes[0].appendChild(q);
			if (this.dadmode == 1) {
				this._fixNodesCollection(x, u)
			}
		} else {
			x.htmlNode.childNodes[0].insertBefore(q, u.tr);
			this._fixNodesCollection(x, u);
			w = x.childNodes
		}
	}
	if ((!g.dpcpy) && (!o)) {
		var a = v.tr;
		if ((document.all) && (navigator.appVersion.search(/MSIE\ 5\.0/gi) != -1)) {
			window.setTimeout(function() {
				a.parentNode.removeChild(a)
			}, 250)
		} else {
			v.parentObject.htmlNode.childNodes[0].removeChild(v.tr)
		}
		if ((!u) || (x != v.parentObject)) {
			for (var n = 0; n < s.childsCount; n++) {
				if (s.childNodes[n].id == v.id) {
					s.childNodes[n] = 0;
					break
				}
			}
		} else {
			s.childNodes[s.childsCount - 1] = 0
		}
		g._compressChildList(s.childsCount, s.childNodes);
		s.childsCount--
	}
	if ((!o) && (!g.dpcpy)) {
		v.tr = q;
		q.nodem = v;
		v.parentObject = x;
		if (g != x.treeNod) {
			if (v.treeNod._registerBranch(v, g)) {
				return
			}
			this._clearStyles(v);
			this._redrawFrom(this, v.parentObject);
			if (this._onradh) {
				this._onradh(v.id)
			}
		}
		this._correctPlus(x);
		this._correctLine(x);
		this._correctLine(v);
		this._correctPlus(v);
		if (u) {
			this._correctPlus(u)
		} else {
			if (x.childsCount >= 2) {
				this._correctPlus(w[x.childsCount - 2]);
				this._correctLine(w[x.childsCount - 2])
			}
		}
		this._correctPlus(w[x.childsCount - 1]);
		if (this.tscheck) {
			this._correctCheckStates(x)
		}
		if (g.tscheck) {
			g._correctCheckStates(s)
		}
	}
	if (r > 1) {
		g._correctPlus(s.childNodes[r - 2]);
		g._correctLine(s.childNodes[r - 2])
	}
	g._correctPlus(s);
	g._correctLine(s);
	this._fixChildCountLabel(x);
	g._fixChildCountLabel(s);
	this.callEvent("onDrop", [v.id, x.id, (u ? u.id : null), g, x.treeNod]);
	return v.id
};
dhtmlXTreeObject.prototype._clearStyles = function(a) {
	if (!a.htmlNode) {
		return
	}
	var l = a.htmlNode.childNodes[0].childNodes[0].childNodes[1];
	var c = l.nextSibling.nextSibling;
	a.span.innerHTML = a.label;
	a.i_sel = false;
	if (a._aimgs) {
		this.dragger.removeDraggableItem(l.nextSibling)
	}
	if (this.checkBoxOff) {
		l.childNodes[0].style.display = "";
		l.childNodes[0].onclick = this.onCheckBoxClick;
		this._setSrc(l.childNodes[0], this.imPath + this.checkArray[a.checkstate])
	} else {
		l.style.display = "none"
	}
	l.childNodes[0].treeNod = this;
	this.dragger.removeDraggableItem(c);
	if (this.dragAndDropOff) {
		this.dragger.addDraggableItem(c, this)
	}
	if (this._aimgs) {
		this.dragger.addDraggableItem(l.nextSibling, this)
	}
	c.childNodes[0].className = "standartTreeRow";
	c.onclick = this.onRowSelect;
	c.ondblclick = this.onRowClick2;
	l.previousSibling.onclick = this.onRowClick;
	this._correctLine(a);
	this._correctPlus(a);
	for (var g = 0; g < a.childsCount; g++) {
		this._clearStyles(a.childNodes[g])
	}
};
dhtmlXTreeObject.prototype._registerBranch = function(c, a) {
	if (a) {
		a._globalIdStorageSub(c.id)
	}
	c.id = this._globalIdStorageAdd(c.id, c);
	c.treeNod = this;
	for (var g = 0; g < c.childsCount; g++) {
		this._registerBranch(c.childNodes[g], a)
	}
	return 0
};
dhtmlXTreeObject.prototype.enableThreeStateCheckboxes = function(a) {
	this.tscheck = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.setOnMouseInHandler = function(a) {
	this.ehlt = true;
	this.attachEvent("onMouseIn", a)
};
dhtmlXTreeObject.prototype.setOnMouseOutHandler = function(a) {
	this.ehlt = true;
	this.attachEvent("onMouseOut", a)
};
dhtmlXTreeObject.prototype.enableMercyDrag = function(a) {
	this.dpcpy = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.enableTreeImages = function(a) {
	this.timgen = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.enableFixedMode = function(a) {
	this.hfMode = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.enableCheckBoxes = function(c, a) {
	this.checkBoxOff = dhx4.s2b(c);
	this.cBROf = (!(this.checkBoxOff || dhx4.s2b(a)))
};
dhtmlXTreeObject.prototype.setStdImages = function(a, g, c) {
	this.imageArray[0] = a;
	this.imageArray[1] = g;
	this.imageArray[2] = c
};
dhtmlXTreeObject.prototype.enableTreeLines = function(a) {
	this.treeLinesOn = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.setImageArrays = function(l, a, n, m, g, c) {
	switch (l) {
		case "plus":
			this.plusArray[0] = a;
			this.plusArray[1] = n;
			this.plusArray[2] = m;
			this.plusArray[3] = g;
			this.plusArray[4] = c;
			break;
		case "minus":
			this.minusArray[0] = a;
			this.minusArray[1] = n;
			this.minusArray[2] = m;
			this.minusArray[3] = g;
			this.minusArray[4] = c;
			break
	}
};
dhtmlXTreeObject.prototype.openItem = function(c) {
	this.skipLock = true;
	var a = this._globalIdStorageFind(c);
	if (!a) {
		return 0
	} else {
		return this._openItem(a)
	}
	this.skipLock = false
};
dhtmlXTreeObject.prototype._openItem = function(a) {
	var c = this._getOpenState(a);
	if ((c < 0) || (((this.XMLsource) && (!a.XMLload)))) {
		if (!this.callEvent("onOpenStart", [a.id, c])) {
			return 0
		}
		this._HideShow(a, 2);
		if (this.checkEvent("onOpenEnd")) {
			if (this.onXLE == this._epnFHe) {
				this._epnFHe(this, a.id, true)
			}
			if (!this.xmlstate || !this.XMLsource) {
				this.callEvent("onOpenEnd", [a.id, this._getOpenState(a)])
			} else {
				this._oie_onXLE.push(this.onXLE);
				this.onXLE = this._epnFHe
			}
		}
	} else {
		if (this._srnd) {
			this._HideShow(a, 2)
		}
	}
	if (a.parentObject && !this._skip_open_parent) {
		this._openItem(a.parentObject)
	}
};
dhtmlXTreeObject.prototype.closeItem = function(c) {
	if (this.rootId == c) {
		return 0
	}
	this.skipLock = true;
	var a = this._globalIdStorageFind(c);
	if (!a) {
		return 0
	}
	if (a.closeble) {
		this._HideShow(a, 1)
	}
	this.skipLock = false
};
dhtmlXTreeObject.prototype.getLevel = function(c) {
	var a = this._globalIdStorageFind(c);
	if (!a) {
		return 0
	}
	return this._getNodeLevel(a, 0)
};
dhtmlXTreeObject.prototype.setItemCloseable = function(g, a) {
	a = dhx4.s2b(a);
	if ((g) && (g.span)) {
		var c = g
	} else {
		var c = this._globalIdStorageFind(g)
	}
	if (!c) {
		return 0
	}
	c.closeble = a
};
dhtmlXTreeObject.prototype._getNodeLevel = function(a, c) {
	if (a.parentObject) {
		return this._getNodeLevel(a.parentObject, c + 1)
	}
	return (c)
};
dhtmlXTreeObject.prototype.hasChildren = function(c) {
	var a = this._globalIdStorageFind(c);
	if (!a) {
		return 0
	} else {
		if ((this.XMLsource) && (!a.XMLload)) {
			return true
		} else {
			return a.childsCount
		}
	}
};
dhtmlXTreeObject.prototype._getLeafCount = function(l) {
	var g = 0;
	for (var c = 0; c < l.childsCount; c++) {
		if (l.childNodes[c].childsCount == 0) {
			g++
		}
	}
	return g
};
dhtmlXTreeObject.prototype.setItemText = function(l, g, c) {
	var a = this._globalIdStorageFind(l);
	if (!a) {
		return 0
	}
	a.label = g;
	a.span.innerHTML = g;
	if (this.childCalc) {
		this._fixChildCountLabel(a)
	}
	a.span.parentNode.parentNode.title = c || ""
};
dhtmlXTreeObject.prototype.getItemTooltip = function(c) {
	var a = this._globalIdStorageFind(c);
	if (!a) {
		return ""
	}
	return (a.span.parentNode.parentNode._dhx_title || a.span.parentNode.parentNode.title || "")
};
dhtmlXTreeObject.prototype.refreshItem = function(c) {
	if (!c) {
		c = this.rootId
	}
	var a = this._globalIdStorageFind(c);
	this.deleteChildItems(c);
	this._loadDynXML(c)
};
dhtmlXTreeObject.prototype.setItemImage2 = function(l, a, m, g) {
	var c = this._globalIdStorageFind(l);
	if (!c) {
		return 0
	}
	c.images[1] = m;
	c.images[2] = g;
	c.images[0] = a;
	this._correctPlus(c)
};
dhtmlXTreeObject.prototype.setItemImage = function(g, a, l) {
	var c = this._globalIdStorageFind(g);
	if (!c) {
		return 0
	}
	if (l) {
		c.images[1] = a;
		c.images[2] = l
	} else {
		c.images[0] = a
	}
	this._correctPlus(c)
};
dhtmlXTreeObject.prototype.getSubItems = function(g) {
	var a = this._globalIdStorageFind(g, 0, 1);
	if (!a) {
		return 0
	}
	if (a.unParsed) {
		return (this._getSubItemsXML(a.unParsed))
	}
	var c = "";
	for (i = 0; i < a.childsCount; i++) {
		if (!c) {
			c = "" + a.childNodes[i].id
		} else {
			c += this.dlmtr + a.childNodes[i].id
		}
	}
	return c
};
dhtmlXTreeObject.prototype._getAllScraggyItems = function(g) {
	var l = "";
	for (var c = 0; c < g.childsCount; c++) {
		if ((g.childNodes[c].unParsed) || (g.childNodes[c].childsCount > 0)) {
			if (g.childNodes[c].unParsed) {
				var a = this._getAllScraggyItemsXML(g.childNodes[c].unParsed, 1)
			} else {
				var a = this._getAllScraggyItems(g.childNodes[c])
			}
			if (a) {
				if (l) {
					l += this.dlmtr + a
				} else {
					l = a
				}
			}
		} else {
			if (!l) {
				l = "" + g.childNodes[c].id
			} else {
				l += this.dlmtr + g.childNodes[c].id
			}
		}
	}
	return l
};
dhtmlXTreeObject.prototype._getAllFatItems = function(g) {
	var l = "";
	for (var c = 0; c < g.childsCount; c++) {
		if ((g.childNodes[c].unParsed) || (g.childNodes[c].childsCount > 0)) {
			if (!l) {
				l = "" + g.childNodes[c].id
			} else {
				l += this.dlmtr + g.childNodes[c].id
			}
			if (g.childNodes[c].unParsed) {
				var a = this._getAllFatItemsXML(g.childNodes[c].unParsed, 1)
			} else {
				var a = this._getAllFatItems(g.childNodes[c])
			}
			if (a) {
				l += this.dlmtr + a
			}
		}
	}
	return l
};
dhtmlXTreeObject.prototype._getAllSubItems = function(n, m, l) {
	if (l) {
		c = l
	} else {
		var c = this._globalIdStorageFind(n)
	}
	if (!c) {
		return 0
	}
	m = "";
	for (var g = 0; g < c.childsCount; g++) {
		if (!m) {
			m = "" + c.childNodes[g].id
		} else {
			m += this.dlmtr + c.childNodes[g].id
		}
		var a = this._getAllSubItems(0, m, c.childNodes[g]);
		if (a) {
			m += this.dlmtr + a
		}
	}
	if (c.unParsed) {
		m = this._getAllSubItemsXML(n, m, c.unParsed)
	}
	return m
};
dhtmlXTreeObject.prototype.selectItem = function(l, g, c) {
	g = dhx4.s2b(g);
	var a = this._globalIdStorageFind(l);
	if ((!a) || (!a.parentObject)) {
		return 0
	}
	if (this.XMLloadingWarning) {
		a.parentObject.openMe = 1
	} else {
		this._openItem(a.parentObject)
	}
	var m = null;
	if (c) {
		m = new Object;
		m.ctrlKey = true;
		if (a.i_sel) {
			m.skipUnSel = true
		}
	}
	if (g) {
		this.onRowSelect(m, a.htmlNode.childNodes[0].childNodes[0].childNodes[3], false)
	} else {
		this.onRowSelect(m, a.htmlNode.childNodes[0].childNodes[0].childNodes[3], true)
	}
};
dhtmlXTreeObject.prototype.getSelectedItemText = function() {
	var c = new Array();
	for (var a = 0; a < this._selected.length; a++) {
		c[a] = this._selected[a].span.innerHTML
	}
	return (c.join(this.dlmtr))
};
dhtmlXTreeObject.prototype._compressChildList = function(a, g) {
	a--;
	for (var c = 0; c < a; c++) {
		if (g[c] == 0) {
			g[c] = g[c + 1];
			g[c + 1] = 0
		}
	}
};
dhtmlXTreeObject.prototype._deleteNode = function(o, m, r) {
	if ((!m) || (!m.parentObject)) {
		return 0
	}
	var a = 0;
	var c = 0;
	if (m.tr.nextSibling) {
		a = m.tr.nextSibling.nodem
	}
	if (m.tr.previousSibling) {
		c = m.tr.previousSibling.nodem
	}
	var n = m.parentObject;
	var g = n.childsCount;
	var q = n.childNodes;
	for (var l = 0; l < g; l++) {
		if (q[l].id == o) {
			if (!r) {
				n.htmlNode.childNodes[0].removeChild(q[l].tr)
			}
			q[l] = 0;
			break
		}
	}
	this._compressChildList(g, q);
	if (!r) {
		n.childsCount--
	}
	if (a) {
		this._correctPlus(a);
		this._correctLine(a)
	}
	if (c) {
		this._correctPlus(c);
		this._correctLine(c)
	}
	if (this.tscheck) {
		this._correctCheckStates(n)
	}
	if (!r) {
		this._globalIdStorageRecSub(m)
	}
};
dhtmlXTreeObject.prototype.setCheck = function(g, c) {
	var a = this._globalIdStorageFind(g, 0, 1);
	if (!a) {
		return
	}
	if (c === "unsure") {
		this._setCheck(a, c)
	} else {
		c = dhx4.s2b(c);
		if ((this.tscheck) && (this.smcheck)) {
			this._setSubChecked(c, a)
		} else {
			this._setCheck(a, c)
		}
	}
	if (this.smcheck) {
		this._correctCheckStates(a.parentObject)
	}
};
dhtmlXTreeObject.prototype._setCheck = function(a, g) {
	if (!a) {
		return
	}
	if (((a.parentObject._r_logic) || (this._frbtr)) && (g)) {
		if (this._frbtrs) {
			if (this._frbtrL) {
				this.setCheck(this._frbtrL.id, 0)
			}
			this._frbtrL = a
		} else {
			for (var c = 0; c < a.parentObject.childsCount; c++) {
				this._setCheck(a.parentObject.childNodes[c], 0)
			}
		}
	}
	var l = a.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];
	if (g == "unsure") {
		a.checkstate = 2
	} else {
		if (g) {
			a.checkstate = 1
		} else {
			a.checkstate = 0
		}
	}
	if (a.dscheck) {
		a.checkstate = a.dscheck
	}
	this._setSrc(l, this.imPath + ((a.parentObject._r_logic || this._frbtr) ? this.radioArray : this.checkArray)[a.checkstate])
};
dhtmlXTreeObject.prototype.setSubChecked = function(g, c) {
	var a = this._globalIdStorageFind(g);
	this._setSubChecked(c, a);
	this._correctCheckStates(a.parentObject)
};
dhtmlXTreeObject.prototype._setSubChecked = function(g, a) {
	g = dhx4.s2b(g);
	if (!a) {
		return
	}
	if (((a.parentObject._r_logic) || (this._frbtr)) && (g)) {
		for (var c = 0; c < a.parentObject.childsCount; c++) {
			this._setSubChecked(0, a.parentObject.childNodes[c])
		}
	}
	if (a.unParsed) {
		this._setSubCheckedXML(g, a.unParsed)
	}
	if (a._r_logic || this._frbtr) {
		this._setSubChecked(g, a.childNodes[0])
	} else {
		for (var c = 0; c < a.childsCount; c++) {
			this._setSubChecked(g, a.childNodes[c])
		}
	}
	var l = a.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];
	if (g) {
		a.checkstate = 1
	} else {
		a.checkstate = 0
	}
	if (a.dscheck) {
		a.checkstate = a.dscheck
	}
	this._setSrc(l, this.imPath + ((a.parentObject._r_logic || this._frbtr) ? this.radioArray : this.checkArray)[a.checkstate])
};
dhtmlXTreeObject.prototype.isItemChecked = function(c) {
	var a = this._globalIdStorageFind(c);
	if (!a) {
		return
	}
	return a.checkstate
};
dhtmlXTreeObject.prototype.deleteChildItems = function(l) {
	var a = this._globalIdStorageFind(l);
	if (!a) {
		return
	}
	var c = a.childsCount;
	for (var g = 0; g < c; g++) {
		this._deleteNode(a.childNodes[0].id, a.childNodes[0])
	}
};
dhtmlXTreeObject.prototype.deleteItem = function(g, a) {
	if ((!this._onrdlh) || (this._onrdlh(g))) {
		var c = this._deleteItem(g, a);
		if (c) {
			this._fixChildCountLabel(c)
		}
	}
	this.allTree.childNodes[0].border = "1";
	this.allTree.childNodes[0].border = "0"
};
dhtmlXTreeObject.prototype._deleteItem = function(n, c, m) {
	c = dhx4.s2b(c);
	var a = this._globalIdStorageFind(n);
	if (!a) {
		return
	}
	var g = this.getParentId(n);
	var l = a.parentObject;
	this._deleteNode(n, a, m);
	if (this._editCell && this._editCell.id == n) {
		this._editCell = null
	}
	this._correctPlus(l);
	this._correctLine(l);
	if ((c) && (g != this.rootId)) {
		this.selectItem(g, 1)
	}
	return l
};
dhtmlXTreeObject.prototype._globalIdStorageRecSub = function(a) {
	for (var c = 0; c < a.childsCount; c++) {
		this._globalIdStorageRecSub(a.childNodes[c]);
		this._globalIdStorageSub(a.childNodes[c].id)
	}
	this._globalIdStorageSub(a.id);
	var g = a;
	g.span = null;
	g.tr.nodem = null;
	g.tr = null;
	g.htmlNode = null
};
dhtmlXTreeObject.prototype.insertNewNext = function(q, u, s, g, n, m, l, c, a) {
	var o = this._globalIdStorageFind(q);
	if ((!o) || (!o.parentObject)) {
		return (0)
	}
	var r = this._attachChildNode(0, u, s, g, n, m, l, c, a, o);
	if ((!this.XMLloadingWarning) && (this.childCalc)) {
		this._fixChildCountLabel(o.parentObject)
	}
	return r
};
dhtmlXTreeObject.prototype.getItemIdByIndex = function(g, a) {
	var c = this._globalIdStorageFind(g);
	if ((!c) || (a >= c.childsCount)) {
		return null
	}
	return c.childNodes[a].id
};
dhtmlXTreeObject.prototype.getChildItemIdByIndex = function(g, a) {
	var c = this._globalIdStorageFind(g);
	if ((!c) || (a >= c.childsCount)) {
		return null
	}
	return c.childNodes[a].id
};
dhtmlXTreeObject.prototype.setDragHandler = function(a) {
	this.attachEvent("onDrag", a)
};
dhtmlXTreeObject.prototype._clearMove = function() {
	if (this._lastMark) {
		this._lastMark.className = this._lastMark.className.replace(/dragAndDropRow/g, "");
		this._lastMark = null
	}
	this.selectionBar.style.display = "none";
	this.allTree.className = this.allTree.className.replace(" selectionBox", "")
};
dhtmlXTreeObject.prototype.enableDragAndDrop = function(c, a) {
	if (c == "temporary_disabled") {
		this.dADTempOff = false;
		c = true
	} else {
		this.dADTempOff = true
	}
	this.dragAndDropOff = dhx4.s2b(c);
	if (this.dragAndDropOff) {
		this.dragger.addDragLanding(this.allTree, this)
	}
	if (arguments.length > 1) {
		this._ddronr = (!dhx4.s2b(a))
	}
};
dhtmlXTreeObject.prototype._setMove = function(m, g, o) {
	if (m.parentObject.span) {
		var l = dhx4.absTop(m);
		var c = dhx4.absTop(this.allTree) - this.allTree.scrollTop;
		this.dadmodec = this.dadmode;
		this.dadmodefix = 0;
		if (this.dadmode == 2) {
			var n = o - l + (document.body.scrollTop || document.documentElement.scrollTop) - 2 - m.offsetHeight / 2;
			if ((Math.abs(n) - m.offsetHeight / 6) > 0) {
				this.dadmodec = 1;
				if (n < 0) {
					this.dadmodefix = 0 - m.offsetHeight
				}
			} else {
				this.dadmodec = 0
			}
		}
		if (this.dadmodec == 0) {
			var a = m.parentObject.span;
			a.className += " dragAndDropRow";
			this._lastMark = a
		} else {
			this._clearMove();
			this.selectionBar.style.top = (l - c + ((parseInt(m.parentObject.span.parentNode.previousSibling.childNodes[0].style.height) || 18) - 1) + this.dadmodefix) + "px";
			this.selectionBar.style.left = "5px";
			if (this.allTree.offsetWidth > 20) {
				this.selectionBar.style.width = (this.allTree.offsetWidth - (_isFF ? 30 : 25)) + "px"
			}
			this.selectionBar.style.display = ""
		}
		this._autoScroll(null, l, c)
	}
};
dhtmlXTreeObject.prototype._autoScroll = function(g, c, a) {
	if (this.autoScroll) {
		if (g) {
			c = dhx4.absTop(g);
			a = dhx4.absTop(this.allTree) - this.allTree.scrollTop
		}
		if ((c - a - parseInt(this.allTree.scrollTop)) > (parseInt(this.allTree.offsetHeight) - 50)) {
			this.allTree.scrollTop = parseInt(this.allTree.scrollTop) + 20
		}
		if ((c - a) < (parseInt(this.allTree.scrollTop) + 30)) {
			this.allTree.scrollTop = parseInt(this.allTree.scrollTop) - 20
		}
	}
};
dhtmlXTreeObject.prototype._createDragNode = function(m, l) {
	if (!this.dADTempOff) {
		return null
	}
	var g = m.parentObject;
	if (!this.callEvent("onBeforeDrag", [g.id, l])) {
		return null
	}
	if (!g.i_sel) {
		this._selectItem(g, l)
	}
	this._checkMSelectionLogic();
	var c = document.createElement("div");
	var n = new Array();
	if (this._itim_dg) {
		for (var a = 0; a < this._selected.length; a++) {
			n[a] = "<table cellspacing='0' cellpadding='0'><tr><td><img width='18px' height='18px' src='" + this._getSrc(this._selected[a].span.parentNode.previousSibling.childNodes[0]) + "'></td><td>" + this._selected[a].span.innerHTML + "</td></tr></table>"
		}
	} else {
		n = this.getSelectedItemText().split(this.dlmtr)
	}
	c.innerHTML = n.join("");
	c.style.position = "absolute";
	c.className = "dragSpanDiv";
	this._dragged = (new Array()).concat(this._selected);
	return c
};
dhtmlXTreeObject.prototype._focusNode = function(a) {
	var c = dhx4.absTop(a.htmlNode) - dhx4.absTop(this.allTree);
	if ((c > (this.allTree.offsetHeight - 30)) || (c < 0)) {
		this.allTree.scrollTop = c + this.allTree.scrollTop
	}
};
dhtmlXTreeObject.prototype._preventNsDrag = function(a) {
	if ((a) && (a.preventDefault)) {
		a.preventDefault();
		return false
	}
	return false
};
dhtmlXTreeObject.prototype._drag = function(o, q, a) {
	if (this._autoOpenTimer) {
		clearTimeout(this._autoOpenTimer)
	}
	if (!a.parentObject) {
		a = this.htmlNode.htmlNode.childNodes[0].childNodes[0].childNodes[1].childNodes[0];
		this.dadmodec = 0
	}
	this._clearMove();
	var n = o.parentObject.treeNod;
	if ((n) && (n._clearMove)) {
		n._clearMove("")
	}
	if ((!this.dragMove) || (this.dragMove())) {
		if ((!n) || (!n._clearMove) || (!n._dragged)) {
			var l = new Array(o.parentObject)
		} else {
			var l = n._dragged
		}
		var c = a.parentObject;
		for (var m = 0; m < l.length; m++) {
			var g = this._moveNode(l[m], c);
			if ((this.dadmodec) && (g !== false)) {
				c = this._globalIdStorageFind(g, true, true)
			}
			if ((g) && (!this._sADnD)) {
				this.selectItem(g, 0, 1)
			}
		}
	}
	if (n) {
		n._dragged = new Array()
	}
};
dhtmlXTreeObject.prototype._dragIn = function(l, c, n, m) {
	if (!this.dADTempOff) {
		return 0
	}
	var o = c.parentObject;
	var a = l.parentObject;
	if ((!a) && (this._ddronr)) {
		return
	}
	if (!this.callEvent("onDragIn", [o.id, a ? a.id : null, o.treeNod, this])) {
		if (a) {
			this._autoScroll(l)
		}
		return 0
	}
	if (!a) {
		this.allTree.className += " selectionBox"
	} else {
		if (o.childNodes == null) {
			this._setMove(l, n, m);
			return l
		}
		var r = o.treeNod;
		for (var g = 0; g < r._dragged.length; g++) {
			if (this._checkPNodes(a, r._dragged[g])) {
				this._autoScroll(l);
				return 0
			}
		}
		this.selectionBar.parentNode.removeChild(this.selectionBar);
		a.span.parentNode.appendChild(this.selectionBar);
		this._setMove(l, n, m);
		if (this._getOpenState(a) <= 0) {
			var q = this;
			this._autoOpenId = a.id;
			this._autoOpenTimer = window.setTimeout(function() {
				q._autoOpenItem(null, q);
				q = null
			}, 1000)
		}
	}
	return l
};
dhtmlXTreeObject.prototype._autoOpenItem = function(c, a) {
	a.openItem(a._autoOpenId)
};
dhtmlXTreeObject.prototype._dragOut = function(a) {
	this._clearMove();
	if (this._autoOpenTimer) {
		clearTimeout(this._autoOpenTimer)
	}
};
dhtmlXTreeObject.prototype._getNextNode = function(a, c) {
	if ((!c) && (a.childsCount)) {
		return a.childNodes[0]
	}
	if (a == this.htmlNode) {
		return -1
	}
	if ((a.tr) && (a.tr.nextSibling) && (a.tr.nextSibling.nodem)) {
		return a.tr.nextSibling.nodem
	}
	return this._getNextNode(a.parentObject, true)
};
dhtmlXTreeObject.prototype._lastChild = function(a) {
	if (a.childsCount) {
		return this._lastChild(a.childNodes[a.childsCount - 1])
	} else {
		return a
	}
};
dhtmlXTreeObject.prototype._getPrevNode = function(a, c) {
	if ((a.tr) && (a.tr.previousSibling) && (a.tr.previousSibling.nodem)) {
		return this._lastChild(a.tr.previousSibling.nodem)
	}
	if (a.parentObject) {
		return a.parentObject
	} else {
		return -1
	}
};
dhtmlXTreeObject.prototype.findItem = function(a, g, c) {
	var l = this._findNodeByLabel(a, g, (c ? this.htmlNode : null));
	if (l) {
		this.selectItem(l.id, true);
		this._focusNode(l);
		return l.id
	} else {
		return null
	}
};
dhtmlXTreeObject.prototype.findItemIdByLabel = function(a, g, c) {
	var l = this._findNodeByLabel(a, g, (c ? this.htmlNode : null));
	if (l) {
		return l.id
	} else {
		return null
	}
};
dhtmlXTreeObject.prototype.findStrInXML = function(c, g, m) {
	if (!c.childNodes && c.item) {
		return this.findStrInJSON(c, g, m)
	}
	if (!c.childNodes) {
		return false
	}
	for (var a = 0; a < c.childNodes.length; a++) {
		if (c.childNodes[a].nodeType == 1) {
			var l = c.childNodes[a].getAttribute(g);
			if (!l && c.childNodes[a].tagName == "itemtext") {
				l = c.childNodes[a].firstChild.data
			}
			if ((l) && (l.toLowerCase().search(m) != -1)) {
				return true
			}
			if (this.findStrInXML(c.childNodes[a], g, m)) {
				return true
			}
		}
	}
	return false
};
dhtmlXTreeObject.prototype.findStrInJSON = function(c, g, m) {
	for (var a = 0; a < c.item.length; a++) {
		var l = c.item[a].text;
		if ((l) && (l.toLowerCase().search(m) != -1)) {
			return true
		}
		if (c.item[a].item && this.findStrInJSON(c.item[a], g, m)) {
			return true
		}
	}
	return false
};
dhtmlXTreeObject.prototype._findNodeByLabel = function(a, m, l) {
	var a = a.replace(new RegExp("^( )+"), "").replace(new RegExp("( )+$"), "");
	a = new RegExp(a.replace(/([\^\.\?\*\+\\\[\]\(\)]{1})/gi, "\\$1").replace(/ /gi, ".*"), "gi");
	if (!l) {
		l = this._selected[0];
		if (!l) {
			l = this.htmlNode
		}
	}
	var c = l;
	if (!m) {
		if ((l.unParsed) && (this.findStrInXML(l.unParsed.d, "text", a))) {
			this.reParse(l)
		}
		l = this._getNextNode(c);
		if (l == -1) {
			l = this.htmlNode.childNodes[0]
		}
	} else {
		var g = this._getPrevNode(c);
		if (g == -1) {
			g = this._lastChild(this.htmlNode)
		}
		if ((g.unParsed) && (this.findStrInXML(g.unParsed.d, "text", a))) {
			this.reParse(g);
			l = this._getPrevNode(c)
		} else {
			l = g
		}
		if (l == -1) {
			l = this._lastChild(this.htmlNode)
		}
	}
	while ((l) && (l != c)) {
		if ((l.label) && (l.label.search(a) != -1)) {
			return (l)
		}
		if (!m) {
			if (l == -1) {
				if (c == this.htmlNode) {
					break
				}
				l = this.htmlNode.childNodes[0]
			}
			if ((l.unParsed) && (this.findStrInXML(l.unParsed.d, "text", a))) {
				this.reParse(l)
			}
			l = this._getNextNode(l);
			if (l == -1) {
				l = this.htmlNode
			}
		} else {
			var g = this._getPrevNode(l);
			if (g == -1) {
				g = this._lastChild(this.htmlNode)
			}
			if ((g.unParsed) && (this.findStrInXML(g.unParsed.d, "text", a))) {
				this.reParse(g);
				l = this._getPrevNode(l)
			} else {
				l = g
			}
			if (l == -1) {
				l = this._lastChild(this.htmlNode)
			}
		}
	}
	return null
};
dhtmlXTreeObject.prototype.moveItem = function(q, c, r, a) {
	var m = this._globalIdStorageFind(q);
	if (!m) {
		return (0)
	}
	var n = null;
	switch (c) {
		case "right":
			alert("Not supported yet");
			break;
		case "item_child":
			var g = (a || this)._globalIdStorageFind(r);
			if (!g) {
				return (0)
			}
			n = (a || this)._moveNodeTo(m, g, 0);
			break;
		case "item_sibling":
			var g = (a || this)._globalIdStorageFind(r);
			if (!g) {
				return (0)
			}
			n = (a || this)._moveNodeTo(m, g.parentObject, g);
			break;
		case "item_sibling_next":
			var g = (a || this)._globalIdStorageFind(r);
			if (!g) {
				return (0)
			}
			if ((g.tr) && (g.tr.nextSibling) && (g.tr.nextSibling.nodem)) {
				n = (a || this)._moveNodeTo(m, g.parentObject, g.tr.nextSibling.nodem)
			} else {
				n = (a || this)._moveNodeTo(m, g.parentObject)
			}
			break;
		case "left":
			if (m.parentObject.parentObject) {
				n = this._moveNodeTo(m, m.parentObject.parentObject, m.parentObject)
			}
			break;
		case "up":
			var o = this._getPrevNode(m);
			if ((o == -1) || (!o.parentObject)) {
				return null
			}
			n = this._moveNodeTo(m, o.parentObject, o);
			break;
		case "up_strict":
			var o = this._getIndex(m);
			if (o != 0) {
				n = this._moveNodeTo(m, m.parentObject, m.parentObject.childNodes[o - 1])
			}
			break;
		case "down_strict":
			var o = this._getIndex(m);
			var l = m.parentObject.childsCount - 2;
			if (o == l) {
				n = this._moveNodeTo(m, m.parentObject)
			} else {
				if (o < l) {
					n = this._moveNodeTo(m, m.parentObject, m.parentObject.childNodes[o + 2])
				}
			}
			break;
		case "down":
			var o = this._getNextNode(this._lastChild(m));
			if ((o == -1) || (!o.parentObject)) {
				return
			}
			if (o.parentObject == m.parentObject) {
				var o = this._getNextNode(o)
			}
			if (o == -1) {
				n = this._moveNodeTo(m, m.parentObject)
			} else {
				if ((o == -1) || (!o.parentObject)) {
					return
				}
				n = this._moveNodeTo(m, o.parentObject, o)
			}
			break
	}
	if (_isIE && _isIE < 8) {
		this.allTree.childNodes[0].border = "1";
		this.allTree.childNodes[0].border = "0"
	}
	return n
};
dhtmlXTreeObject.prototype.setDragBehavior = function(c, a) {
	this._sADnD = (!dhx4.s2b(a));
	switch (c) {
		case "child":
			this.dadmode = 0;
			break;
		case "sibling":
			this.dadmode = 1;
			break;
		case "complex":
			this.dadmode = 2;
			break
	}
};
dhtmlXTreeObject.prototype._loadDynXML = function(g, c) {
	c = c || this.XMLsource;
	var a = (new Date()).valueOf();
	this._ld_id = g;
	if (this.xmlalb == "function") {
		if (c) {
			c(this._escape(g))
		}
	} else {
		if (this.xmlalb == "name") {
			this.loadXML(c + this._escape(g))
		} else {
			if (this.xmlalb == "xmlname") {
				this.loadXML(c + this._escape(g) + ".xml?uid=" + a)
			} else {
				this.loadXML(c + dhtmlx.url(c) + "uid=" + a + "&id=" + this._escape(g))
			}
		}
	}
};
dhtmlXTreeObject.prototype.enableMultiselection = function(c, a) {
	this._amsel = dhx4.s2b(c);
	this._amselS = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype._checkMSelectionLogic = function() {
	var g = new Array();
	for (var c = 0; c < this._selected.length; c++) {
		for (var a = 0; a < this._selected.length; a++) {
			if ((c != a) && (this._checkPNodes(this._selected[a], this._selected[c]))) {
				g[g.length] = this._selected[a]
			}
		}
	}
	for (var c = 0; c < g.length; c++) {
		this._unselectItem(g[c])
	}
};
dhtmlXTreeObject.prototype._checkPNodes = function(c, a) {
	if (this._dcheckf) {
		return false
	}
	if (a == c) {
		return 1
	}
	if (c.parentObject) {
		return this._checkPNodes(c.parentObject, a)
	} else {
		return 0
	}
};
dhtmlXTreeObject.prototype.disableDropCheck = function(a) {
	this._dcheckf = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.enableDistributedParsing = function(g, c, a) {
	this._edsbps = dhx4.s2b(g);
	this._edsbpsA = new Array();
	this._edsbpsC = c || 10;
	this._edsbpsD = a || 250
};
dhtmlXTreeObject.prototype.getDistributedParsingState = function() {
	return (!((!this._edsbpsA) || (!this._edsbpsA.length)))
};
dhtmlXTreeObject.prototype.getItemParsingState = function(g) {
	var c = this._globalIdStorageFind(g, true, true);
	if (!c) {
		return 0
	}
	if (this._edsbpsA) {
		for (var a = 0; a < this._edsbpsA.length; a++) {
			if (this._edsbpsA[a][2] == g) {
				return -1
			}
		}
	}
	return 1
};
dhtmlXTreeObject.prototype._distributedStart = function(c, m, l, g, a) {
	if (!this._edsbpsA) {
		this._edsbpsA = new Array()
	}
	this._edsbpsA[this._edsbpsA.length] = [c, m, l, g, a]
};
dhtmlXTreeObject.prototype._distributedStep = function(l) {
	var c = this;
	if ((!this._edsbpsA) || (!this._edsbpsA.length)) {
		c.XMLloadingWarning = 0;
		return
	}
	var m = this._edsbpsA[0];
	this.parsedArray = new Array();
	this._parse(m[0], m[2], m[3], m[1]);
	var a = this._globalIdStorageFind(m[2]);
	this._redrawFrom(this, a, m[4], this._getOpenState(a));
	var g = this.setCheckList.split(this.dlmtr);
	for (var o = 0; o < g.length; o++) {
		if (g[o]) {
			this.setCheck(g[o], 1)
		}
	}
	this._edsbpsA = (new Array()).concat(this._edsbpsA.slice(1));
	if ((!this._edsbpsA.length)) {
		window.setTimeout(function() {
			if (c.onXLE) {
				c.onXLE(c, l)
			}
			c.callEvent("onXLE", [c, l])
		}, 1);
		c.xmlstate = 0
	}
};
dhtmlXTreeObject.prototype.enableTextSigns = function(a) {
	this._txtimg = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.preventIECaching = function(a) {
	dhx4.ajax.cache = !a
};
dhtmlXTreeObject.prototype.preventIECashing = dhtmlXTreeObject.prototype.preventIECaching;
dhtmlXTreeObject.prototype.disableCheckbox = function(g, c) {
	if (typeof(g) != "object") {
		var a = this._globalIdStorageFind(g, 0, 1)
	} else {
		var a = g
	}
	if (!a) {
		return
	}
	a.dscheck = dhx4.s2b(c) ? (((a.checkstate || 0) % 3) + 3) : ((a.checkstate > 2) ? (a.checkstate - 3) : a.checkstate);
	this._setCheck(a);
	if (a.dscheck < 3) {
		a.dscheck = false
	}
};
dhtmlXTreeObject.prototype.smartRefreshBranch = function(c, a) {
	this._branchUpdate = 1;
	this.smartRefreshItem(c, a)
};
dhtmlXTreeObject.prototype.smartRefreshItem = function(l, g) {
	var a = this._globalIdStorageFind(l);
	for (var c = 0; c < a.childsCount; c++) {
		a.childNodes[c]._dmark = true
	}
	this.waitUpdateXML = true;
	if (g && g.exists) {
		this._parse(g, l)
	} else {
		this._loadDynXML(l, g)
	}
};
dhtmlXTreeObject.prototype.refreshItems = function(c, g) {
	var l = c.toString().split(this.dlmtr);
	this.waitUpdateXML = new Array();
	for (var a = 0; a < l.length; a++) {
		this.waitUpdateXML[l[a]] = true
	}
	this.loadXML((g || this.XMLsource) + dhtmlx.url(g || this.XMLsource) + "ids=" + this._escape(c))
};
dhtmlXTreeObject.prototype.updateItem = function(o, n, l, g, c, m, q) {
	var a = this._globalIdStorageFind(o);
	a.userData = new cObject();
	if (n) {
		a.label = n
	}
	a.images = new Array(l || this.imageArray[0], g || this.imageArray[1], c || this.imageArray[2]);
	this.setItemText(o, n);
	if (m) {
		this._setCheck(a, true)
	}
	if (q == "1" && !this.hasChildren(o)) {
		a.XMLload = 0
	}
	this._correctPlus(a);
	a._dmark = false;
	return a
};
dhtmlXTreeObject.prototype.setDropHandler = function(a) {
	this.attachEvent("onDrop", a)
};
dhtmlXTreeObject.prototype.setOnLoadingStart = function(a) {
	this.attachEvent("onXLS", a)
};
dhtmlXTreeObject.prototype.setOnLoadingEnd = function(a) {
	this.attachEvent("onXLE", a)
};
dhtmlXTreeObject.prototype.setXMLAutoLoadingBehaviour = function(a) {
	this.xmlalb = a
};
dhtmlXTreeObject.prototype.enableSmartCheckboxes = function(a) {
	this.smcheck = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.getXMLState = function() {
	return (this.xmlstate == 1)
};
dhtmlXTreeObject.prototype.setItemTopOffset = function(n, l) {
	var g;
	if (typeof(n) != "object") {
		g = this._globalIdStorageFind(n)
	} else {
		g = n
	}
	var m = g.span.parentNode.parentNode;
	g.span.style.paddingBottom = "1px";
	for (var c = 0; c < m.childNodes.length; c++) {
		if (c != 0) {
			if (_isIE) {
				m.childNodes[c].style.height = "18px";
				m.childNodes[c].style.paddingTop = parseInt(l) + "px"
			} else {
				m.childNodes[c].style.height = 18 + parseInt(l) + "px"
			}
		} else {
			var a = m.childNodes[c].firstChild;
			if (m.childNodes[c].firstChild.tagName != "DIV") {
				a = document.createElement("DIV");
				m.childNodes[c].insertBefore(a, m.childNodes[c].firstChild)
			}
			a.style.height = parseInt(l) + "px";
			if ((g.parentObject.id != this.rootId || g.parentObject.childNodes[0] != g) && this.treeLinesOn) {
				a.style.backgroundImage = "url(" + this.imPath + this.lineArray[5] + ")"
			}
			a.innerHTML = "&nbsp;";
			a.style.overflow = "hidden";
			if (parseInt(l) == 0) {
				m.childNodes[c].removeChild(a)
			}
		}
		if (!_isIE) {
			m.childNodes[c].style.verticalAlign = "bottom"
		}
		if (_isIE) {
			this.allTree.childNodes[0].border = "1";
			this.allTree.childNodes[0].border = "0"
		}
	}
};
dhtmlXTreeObject.prototype.setIconSize = function(l, c, m) {
	if (m) {
		if ((m) && (m.span)) {
			var a = m
		} else {
			var a = this._globalIdStorageFind(m)
		}
		if (!a) {
			return (0)
		}
		var g = a.span.parentNode.previousSibling.childNodes[0];
		if (l) {
			g.style.width = l + "px";
			if (window._KHTMLrv) {
				g.parentNode.style.width = l + "px"
			}
		}
		if (c) {
			g.style.height = c + "px";
			if (window._KHTMLrv) {
				g.parentNode.style.height = c + "px"
			}
		}
	} else {
		this.def_img_x = l;
		this.def_img_y = c
	}
};
dhtmlXTreeObject.prototype.getItemImage = function(m, l, c) {
	var g = this._globalIdStorageFind(m);
	if (!g) {
		return ""
	}
	var a = g.images[l || 0];
	if (c) {
		a = this.iconURL + a
	}
	return a
};
dhtmlXTreeObject.prototype.enableRadioButtons = function(l, g) {
	if (arguments.length == 1) {
		this._frbtr = dhx4.s2b(l);
		this.checkBoxOff = this.checkBoxOff || this._frbtr;
		return
	}
	var c = this._globalIdStorageFind(l);
	if (!c) {
		return ""
	}
	g = dhx4.s2b(g);
	if ((g) && (!c._r_logic)) {
		c._r_logic = true;
		for (var a = 0; a < c.childsCount; a++) {
			this._setCheck(c.childNodes[a], c.childNodes[a].checkstate)
		}
	}
	if ((!g) && (c._r_logic)) {
		c._r_logic = false;
		for (var a = 0; a < c.childsCount; a++) {
			this._setCheck(c.childNodes[a], c.childNodes[a].checkstate)
		}
	}
};
dhtmlXTreeObject.prototype.enableSingleRadioMode = function(a) {
	this._frbtrs = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.openOnItemAdded = function(a) {
	this._hAdI = !dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.openOnItemAdding = function(a) {
	this._hAdI = !dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.enableMultiLineItems = function(a) {
	if (a === true) {
		this.mlitems = "100%"
	} else {
		this.mlitems = a
	}
};
dhtmlXTreeObject.prototype.enableAutoTooltips = function(a) {
	this.ettip = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.clearSelection = function(a) {
	if (a) {
		this._unselectItem(this._globalIdStorageFind(a))
	} else {
		this._unselectItems()
	}
};
dhtmlXTreeObject.prototype.showItemSign = function(l, c) {
	var a = this._globalIdStorageFind(l);
	if (!a) {
		return 0
	}
	var g = a.span.parentNode.previousSibling.previousSibling.previousSibling;
	if (!dhx4.s2b(c)) {
		this._openItem(a);
		a.closeble = false;
		a.wsign = true
	} else {
		a.closeble = true;
		a.wsign = false
	}
	this._correctPlus(a)
};
dhtmlXTreeObject.prototype.showItemCheckbox = function(m, l) {
	if (!m) {
		for (var c in this._idpull) {
			this.showItemCheckbox(this._idpull[c], l)
		}
	}
	if (typeof(m) != "object") {
		m = this._globalIdStorageFind(m, 0, 0)
	}
	if (!m) {
		return 0
	}
	m.nocheckbox = !dhx4.s2b(l);
	var g = m.span.parentNode.previousSibling.previousSibling.childNodes[0];
	g.parentNode.style.display = (!m.nocheckbox) ? "" : "none"
};
dhtmlXTreeObject.prototype.setListDelimeter = function(a) {
	this.dlmtr = a
};
dhtmlXTreeObject.prototype.setEscapingMode = function(a) {
	this.utfesc = a
};
dhtmlXTreeObject.prototype.enableHighlighting = function(a) {
	this.ehlt = true;
	this.ehlta = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype._itemMouseOut = function() {
	var c = this.childNodes[3].parentObject;
	var a = c.treeNod;
	a.callEvent("onMouseOut", [c.id]);
	if (c.id == a._l_onMSI) {
		a._l_onMSI = null
	}
	if (!a.ehlta) {
		return
	}
	c.span.className = c.span.className.replace("_lor", "")
};
dhtmlXTreeObject.prototype._itemMouseIn = function() {
	var c = this.childNodes[3].parentObject;
	var a = c.treeNod;
	if (a._l_onMSI != c.id) {
		a.callEvent("onMouseIn", [c.id])
	}
	a._l_onMSI = c.id;
	if (!a.ehlta) {
		return
	}
	c.span.className = c.span.className.replace("_lor", "");
	c.span.className = c.span.className.replace(/((standart|selected)TreeRow)/, "$1_lor")
};
dhtmlXTreeObject.prototype.enableActiveImages = function(a) {
	this._aimgs = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.focusItem = function(c) {
	var a = this._globalIdStorageFind(c);
	if (!a) {
		return (0)
	}
	this._focusNode(a)
};
dhtmlXTreeObject.prototype.getAllSubItems = function(a) {
	return this._getAllSubItems(a)
};
dhtmlXTreeObject.prototype.getAllChildless = function() {
	return this._getAllScraggyItems(this.htmlNode)
};
dhtmlXTreeObject.prototype.getAllLeafs = dhtmlXTreeObject.prototype.getAllChildless;
dhtmlXTreeObject.prototype._getAllScraggyItems = function(g) {
	var l = "";
	for (var c = 0; c < g.childsCount; c++) {
		if ((g.childNodes[c].unParsed) || (g.childNodes[c].childsCount > 0)) {
			if (g.childNodes[c].unParsed) {
				var a = this._getAllScraggyItemsXML(g.childNodes[c].unParsed, 1)
			} else {
				var a = this._getAllScraggyItems(g.childNodes[c])
			}
			if (a) {
				if (l) {
					l += this.dlmtr + a
				} else {
					l = a
				}
			}
		} else {
			if (!l) {
				l = "" + g.childNodes[c].id
			} else {
				l += this.dlmtr + g.childNodes[c].id
			}
		}
	}
	return l
};
dhtmlXTreeObject.prototype._getAllFatItems = function(g) {
	var l = "";
	for (var c = 0; c < g.childsCount; c++) {
		if ((g.childNodes[c].unParsed) || (g.childNodes[c].childsCount > 0)) {
			if (!l) {
				l = "" + g.childNodes[c].id
			} else {
				l += this.dlmtr + g.childNodes[c].id
			}
			if (g.childNodes[c].unParsed) {
				var a = this._getAllFatItemsXML(g.childNodes[c].unParsed, 1)
			} else {
				var a = this._getAllFatItems(g.childNodes[c])
			}
			if (a) {
				l += this.dlmtr + a
			}
		}
	}
	return l
};
dhtmlXTreeObject.prototype.getAllItemsWithKids = function() {
	return this._getAllFatItems(this.htmlNode)
};
dhtmlXTreeObject.prototype.getAllFatItems = dhtmlXTreeObject.prototype.getAllItemsWithKids;
dhtmlXTreeObject.prototype.getAllChecked = function() {
	return this._getAllChecked("", "", 1)
};
dhtmlXTreeObject.prototype.getAllUnchecked = function(a) {
	if (a) {
		a = this._globalIdStorageFind(a)
	}
	return this._getAllChecked(a, "", 0)
};
dhtmlXTreeObject.prototype.getAllPartiallyChecked = function() {
	return this._getAllChecked("", "", 2)
};
dhtmlXTreeObject.prototype.getAllCheckedBranches = function() {
	var a = [this._getAllChecked("", "", 1)];
	var c = this._getAllChecked("", "", 2);
	if (c) {
		a.push(c)
	}
	return a.join(this.dlmtr)
};
dhtmlXTreeObject.prototype._getAllChecked = function(l, g, m) {
	if (!l) {
		l = this.htmlNode
	}
	if (l.checkstate == m) {
		if (!l.nocheckbox) {
			if (g) {
				g += this.dlmtr + l.id
			} else {
				g = "" + l.id
			}
		}
	}
	var a = l.childsCount;
	for (var c = 0; c < a; c++) {
		g = this._getAllChecked(l.childNodes[c], g, m)
	}
	if (l.unParsed) {
		g = this._getAllCheckedXML(l.unParsed, g, m)
	}
	if (g) {
		return g
	} else {
		return ""
	}
};
dhtmlXTreeObject.prototype.setItemStyle = function(l, g, c) {
	var c = c || false;
	var a = this._globalIdStorageFind(l);
	if (!a) {
		return 0
	}
	if (!a.span.style.cssText) {
		a.span.setAttribute("style", a.span.getAttribute("style") + "; " + g)
	} else {
		a.span.style.cssText = c ? g : a.span.style.cssText + ";" + g
	}
};
dhtmlXTreeObject.prototype.enableImageDrag = function(a) {
	this._itim_dg = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.setOnDragIn = function(a) {
	this.attachEvent("onDragIn", a)
};
dhtmlXTreeObject.prototype.enableDragAndDropScrolling = function(a) {
	this.autoScroll = dhx4.s2b(a)
};
dhtmlXTreeObject.prototype.setSkin = function(a) {
	var c = this.parentObject.className.replace(/dhxtree_[^ ]*/gi, "");
	this.parentObject.className = c + " dhxtree_" + a;
	if (a == "dhx_terrace" || a == "dhx_web") {
		this.enableTreeLines(false)
	}
};
(function() {
	dhtmlx.extend_api("dhtmlXTreeObject", {
		_init: function(a) {
			return [a.parent, (a.width || "100%"), (a.height || "100%"), (a.root_id || 0)]
		},
		auto_save_selection: "enableAutoSavingSelected",
		auto_tooltip: "enableAutoTooltips",
		checkbox: "enableCheckBoxes",
		checkbox_3_state: "enableThreeStateCheckboxes",
		checkbox_smart: "enableSmartCheckboxes",
		context_menu: "enableContextMenu",
		distributed_parsing: "enableDistributedParsing",
		drag: "enableDragAndDrop",
		drag_copy: "enableMercyDrag",
		drag_image: "enableImageDrag",
		drag_scroll: "enableDragAndDropScrolling",
		editor: "enableItemEditor",
		hover: "enableHighlighting",
		images: "enableTreeImages",
		image_fix: "enableIEImageFix",
		image_path: "setImagePath",
		lines: "enableTreeLines",
		loading_item: "enableLoadingItem",
		multiline: "enableMultiLineItems",
		multiselect: "enableMultiselection",
		navigation: "enableKeyboardNavigation",
		radio: "enableRadioButtons",
		radio_single: "enableSingleRadioMode",
		rtl: "enableRTL",
		search: "enableKeySearch",
		smart_parsing: "enableSmartXMLParsing",
		smart_rendering: "enableSmartRendering",
		text_icons: "enableTextSigns",
		xml: "loadXML",
		skin: "setSkin"
	}, {})
})();
dhtmlXTreeObject.prototype._dp_init = function(a) {
	a.attachEvent("insertCallback", function(l, n, c) {
		var g = dhx4.ajax.xpath(".//item", l);
		var m = g[0].getAttribute("text");
		this.obj.insertNewItem(c, n, m, 0, 0, 0, 0, "CHILD")
	});
	a.attachEvent("updateCallback", function(l, n, c) {
		var g = dhx4.ajax.xpath(".//item", l);
		var m = g[0].getAttribute("text");
		this.obj.setItemText(n, m);
		if (this.obj.getParentId(n) != c) {
			this.obj.moveItem(n, "item_child", c)
		}
		this.setUpdated(n, true, "updated")
	});
	a.attachEvent("deleteCallback", function(g, l, c) {
		this.obj.setUserData(l, this.action_param, "true_deleted");
		this.obj.deleteItem(l, false)
	});
	a._methods = ["setItemStyle", "", "changeItemId", "deleteItem"];
	this.attachEvent("onEdit", function(c, g) {
		if (c == 3) {
			a.setUpdated(g, true)
		}
		return true
	});
	this.attachEvent("onDrop", function(n, m, l, g, c) {
		if (g == c) {
			a.setUpdated(n, true)
		}
	});
	this._onrdlh = function(c) {
		var g = a.getState(c);
		if (g == "inserted") {
			a.set_invalid(c, false);
			a.setUpdated(c, false);
			return true
		}
		if (g == "true_deleted") {
			a.setUpdated(c, false);
			return true
		}
		a.setUpdated(c, true, "deleted");
		return false
	};
	this._onradh = function(c) {
		a.setUpdated(c, true, "inserted")
	};
	a._getRowData = function(m) {
		var l = {};
		var n = this.obj._globalIdStorageFind(m);
		var g = n.parentObject;
		var c = 0;
		for (c = 0; c < g.childsCount; c++) {
			if (g.childNodes[c] == n) {
				break
			}
		}
		l.tr_id = n.id;
		l.tr_pid = g.id;
		l.tr_order = c;
		l.tr_text = n.span.innerHTML;
		g = (n._userdatalist || "").split(",");
		for (c = 0; c < g.length; c++) {
			l[g[c]] = n.userData["t_" + g[c]]
		}
		return l
	}
};
if (typeof(window.dhtmlXCellObject) != "undefined") {
	dhtmlXCellObject.prototype.attachTree = function(a) {
		this.callEvent("_onBeforeContentAttach", ["tree"]);
		var c = document.createElement("DIV");
		c.style.width = "100%";
		c.style.height = "100%";
		c.style.position = "relative";
		c.style.overflow = "hidden";
		this._attachObject(c);
		this.dataType = "tree";
		this.dataObj = new dhtmlXTreeObject(c, "100%", "100%", (a || 0));
		this.dataObj.setSkin(this.conf.skin);
		this.dataObj.allTree.childNodes[0].style.marginTop = "2px";
		this.dataObj.allTree.childNodes[0].style.marginBottom = "2px";
		c = null;
		this.callEvent("_onContentAttach", []);
		return this.dataObj
	}
}
dhtmlXTreeObject.prototype.makeDraggable = function(c, a) {
	if (typeof(c) != "object") {
		c = document.getElementById(c)
	}
	dragger = new dhtmlDragAndDropObject();
	dropper = new dhx_dragSomethingInTree();
	dragger.addDraggableItem(c, dropper);
	c.dragLanding = null;
	c.ondragstart = dropper._preventNsDrag;
	c.onselectstart = new Function("return false;");
	c.parentObject = new Object;
	c.parentObject.img = c;
	c.parentObject.treeNod = dropper;
	dropper._customDrop = a
};
dhtmlXTreeObject.prototype.makeDragable = dhtmlXTreeObject.prototype.makeDraggable;
dhtmlXTreeObject.prototype.makeAllDraggable = function(c) {
	var g = document.getElementsByTagName("div");
	for (var a = 0; a < g.length; a++) {
		if (g[a].getAttribute("dragInDhtmlXTree")) {
			this.makeDragable(g[a], c)
		}
	}
};

function dhx_dragSomethingInTree() {
	this.lWin = window;
	this._createDragNode = function(c) {
		var a = document.createElement("div");
		a.style.position = "absolute";
		a.innerHTML = (c.innerHTML || c.value);
		a.className = "dragSpanDiv";
		return a
	};
	this._preventNsDrag = function(a) {
		(a || window.event).cancelBubble = true;
		if ((a) && (a.preventDefault)) {
			a.preventDefault();
			return false
		}
		return false
	};
	this._nonTrivialNode = function(c, g, a, l) {
		if (this._customDrop) {
			return this._customDrop(c, l.img.id, g.id, a ? a.id : null)
		}
		var m = (l.img.getAttribute("image") || "");
		var o = l.img.id || "new";
		var n = (l.img.getAttribute("text") || (_isIE ? l.img.innerText : l.img.textContent));
		c[a ? "insertNewNext" : "insertNewItem"](a ? a.id : g.id, o, n, "", m, m, m)
	}
}
dhtmlXTreeObject.prototype.enableItemEditor = function(a) {
	this._eItEd = dhx4.s2b(a);
	if (!this._eItEdFlag) {
		this._edn_click_IE = true;
		this._edn_dblclick = true;
		this._ie_aFunc = this.aFunc;
		this._ie_dblclickFuncHandler = this.dblclickFuncHandler;
		this.setOnDblClickHandler(function(g, c) {
			if (this._edn_dblclick) {
				this._editItem(g, c)
			}
			return true
		});
		this.setOnClickHandler(function(g, c) {
			this._stopEditItem(g, c);
			if ((this.ed_hist_clcik == g) && (this._edn_click_IE)) {
				this._editItem(g, c)
			}
			this.ed_hist_clcik = g;
			return true
		});
		this._eItEdFlag = true
	}
};
dhtmlXTreeObject.prototype.setOnEditHandler = function(a) {
	this.attachEvent("onEdit", a)
};
dhtmlXTreeObject.prototype.setEditStartAction = function(a, c) {
	this._edn_click_IE = dhx4.s2b(a);
	this._edn_dblclick = dhx4.s2b(c)
};
dhtmlXTreeObject.prototype._stopEdit = function(c, n) {
	if (this._editCell) {
		this.dADTempOff = this.dADTempOffEd;
		if (this._editCell.id != c) {
			var l = true;
			if (!n) {
				l = this.callEvent("onEdit", [2, this._editCell.id, this, this._editCell.span.childNodes[0].value])
			} else {
				l = false;
				this.callEvent("onEditCancel", [this._editCell.id, this._editCell._oldValue])
			}
			if (l === true) {
				l = this._editCell.span.childNodes[0].value
			} else {
				if (l === false) {
					l = this._editCell._oldValue
				}
			}
			var m = (l != this._editCell._oldValue);
			this._editCell.span.innerHTML = l;
			this._editCell.label = this._editCell.span.innerHTML;
			var g = this._editCell.i_sel ? "selectedTreeRow" : "standartTreeRow";
			this._editCell.span.className = g;
			this._editCell.span.parentNode.className = "standartTreeRow";
			this._editCell.span.style.paddingRight = this._editCell.span.style.paddingLeft = "5px";
			this._editCell.span.onclick = this._editCell.span.ondblclick = function() {};
			var o = this._editCell.id;
			if (this.childCalc) {
				this._fixChildCountLabel(this._editCell)
			}
			this._editCell = null;
			if (!n) {
				this.callEvent("onEdit", [3, o, this, m])
			}
			if (this._enblkbrd) {
				this.parentObject.lastChild.focus();
				this.parentObject.lastChild.focus()
			}
		}
	}
};
dhtmlXTreeObject.prototype._stopEditItem = function(c, a) {
	this._stopEdit(c)
};
dhtmlXTreeObject.prototype.stopEdit = function(a) {
	if (this._editCell) {
		this._stopEdit(this._editCell.id + "_non", a)
	}
};
dhtmlXTreeObject.prototype.editItem = function(a) {
	this._editItem(a, this)
};
dhtmlXTreeObject.prototype._editItem = function(m, a) {
	if (this._eItEd) {
		this._stopEdit();
		var g = this._globalIdStorageFind(m);
		if (!g) {
			return
		}
		var l = this.callEvent("onEdit", [0, m, this, g.span.innerHTML]);
		if (l === true) {
			l = (typeof g.span.innerText != "undefined" ? g.span.innerText : g.span.textContent)
		} else {
			if (l === false) {
				return
			}
		}
		this.dADTempOffEd = this.dADTempOff;
		this.dADTempOff = false;
		this._editCell = g;
		g._oldValue = l;
		g.span.innerHTML = "<input type='text' class='intreeeditRow' />";
		g.span.style.paddingRight = g.span.style.paddingLeft = "0px";
		g.span.onclick = g.span.ondblclick = function(n) {
			(n || event).cancelBubble = true
		};
		g.span.childNodes[0].value = l;
		g.span.childNodes[0].onselectstart = function(n) {
			(n || event).cancelBubble = true;
			return true
		};
		g.span.childNodes[0].onmousedown = function(n) {
			(n || event).cancelBubble = true;
			return true
		};
		g.span.childNodes[0].focus();
		g.span.childNodes[0].focus();
		g.span.onclick = function(n) {
			(n || event).cancelBubble = true;
			return false
		};
		g.span.className = "";
		g.span.parentNode.className = "";
		var c = this;
		g.span.childNodes[0].onkeydown = function(n) {
			if (!n) {
				n = window.event
			}
			if (n.keyCode == 13) {
				n.cancelBubble = true;
				c._stopEdit(window.undefined)
			} else {
				if (n.keyCode == 27) {
					c._stopEdit(window.undefined, true)
				}
			}(n || event).cancelBubble = true
		};
		this.callEvent("onEdit", [1, m, this])
	}
};

function jsonPointer(c, a) {
	this.d = c;
	this.dp = a
}
jsonPointer.prototype = {
	text: function() {
		var a = function(m) {
			var l = [];
			for (var g = 0; g < m.length; g++) {
				l.push("{" + c(m[g]) + "}")
			}
			return l.join(",")
		};
		var c = function(m) {
			var l = [];
			for (var g in m) {
				if (typeof(m[g]) == "object") {
					if (g.length) {
						l.push('"' + g + '":[' + a(m[g]) + "]")
					} else {
						l.push('"' + g + '":{' + c(m[g]) + "}")
					}
				} else {
					l.push('"' + g + '":"' + m[g] + '"')
				}
			}
			return l.join(",")
		};
		return "{" + c(this.d) + "}"
	},
	get: function(a) {
		return this.d[a]
	},
	exists: function() {
		return !!this.d
	},
	content: function() {
		return this.d.content
	},
	each: function(l, o, n) {
		var g = this.d[l];
		var q = new jsonPointer();
		if (g) {
			for (var m = 0; m < g.length; m++) {
				q.d = g[m];
				o.apply(n, [q, m])
			}
		}
	},
	get_all: function() {
		return this.d
	},
	sub: function(a) {
		return new jsonPointer(this.d[a], this.d)
	},
	sub_exists: function(a) {
		return !!this.d[a]
	},
	each_x: function(l, q, o, n, m) {
		var g = this.d[l];
		var r = new jsonPointer(0, this.d);
		if (g) {
			for (m = m || 0; m < g.length; m++) {
				if (g[m][q]) {
					r.d = g[m];
					if (o.apply(n, [r, m]) == -1) {
						return
					}
				}
			}
		}
	},
	up: function(a) {
		return new jsonPointer(this.dp, this.d)
	},
	set: function(a, c) {
		this.d[a] = c
	},
	clone: function(a) {
		return new jsonPointer(this.d, this.dp)
	},
	through: function(g, o, s, m, u) {
		var q = this.d[g];
		if (q.length) {
			for (var l = 0; l < q.length; l++) {
				if (q[l][o] != null && q[l][o] != "" && (!s || q[l][o] == s)) {
					var n = new jsonPointer(q[l], this.d);
					m.apply(u, [n, l])
				}
				var r = this.d;
				this.d = q[l];
				if (this.sub_exists(g)) {
					this.through(g, o, s, m, u)
				}
				this.d = r
			}
		}
	}
};
dhtmlXTreeObject.prototype.loadJSArrayFile = function(file, callback) {
	if (!this.parsCount) {
		this.callEvent("onXLS", [this, this._ld_id])
	}
	this._ld_id = null;
	this.xmlstate = 1;
	var that = this;
	this.XMLLoader = function(xml, callback) {
		eval("var z=" + xml.responseText);
		this.loadJSArray(z);
		if (callback) {
			callback.call(this, xml)
		}
	};
	dhx4.ajax.get(file, function(obj) {
		that.XMLLoader(obj.xmlDoc, callback)
	})
};
dhtmlXTreeObject.prototype.loadCSV = function(a, g) {
	if (!this.parsCount) {
		this.callEvent("onXLS", [this, this._ld_id])
	}
	this._ld_id = null;
	this.xmlstate = 1;
	var c = this;
	this.XMLLoader = function(l, m) {
		this.loadCSVString(l.responseText);
		if (m) {
			m.call(this, l)
		}
	};
	dhx4.ajax.get(a, function(l) {
		c.XMLLoader(l.xmlDoc, g)
	})
};
dhtmlXTreeObject.prototype.loadJSArray = function(a, l) {
	var n = [];
	for (var c = 0; c < a.length; c++) {
		if (!n[a[c][1]]) {
			n[a[c][1]] = []
		}
		n[a[c][1]].push({
			id: a[c][0],
			text: a[c][2]
		})
	}
	var m = {
		id: this.rootId
	};
	var g = function(r, q) {
		if (n[r.id]) {
			r.item = n[r.id];
			for (var o = 0; o < r.item.length; o++) {
				q(r.item[o], q)
			}
		}
	};
	g(m, g);
	this.loadJSONObject(m, l)
};
dhtmlXTreeObject.prototype.loadCSVString = function(a, n) {
	var q = [];
	var c = a.split("\n");
	for (var l = 0; l < c.length; l++) {
		var g = c[l].split(",");
		if (!q[g[1]]) {
			q[g[1]] = []
		}
		q[g[1]].push({
			id: g[0],
			text: g[2]
		})
	}
	var o = {
		id: this.rootId
	};
	var m = function(u, s) {
		if (q[u.id]) {
			u.item = q[u.id];
			for (var r = 0; r < u.item.length; r++) {
				s(u.item[r], s)
			}
		}
	};
	m(o, m);
	this.loadJSONObject(o, n)
};
dhtmlXTreeObject.prototype.loadJSONObject = function(a, c) {
	if (!this.parsCount) {
		this.callEvent("onXLS", [this, null])
	}
	this.xmlstate = 1;
	var g = new jsonPointer(a);
	this._parse(g);
	this._p = g;
	if (c) {
		c()
	}
};
dhtmlXTreeObject.prototype.loadJSON = function(file, callback) {
	if (!this.parsCount) {
		this.callEvent("onXLS", [this, this._ld_id])
	}
	this._ld_id = null;
	this.xmlstate = 1;
	var that = this;
	this.XMLLoader = function(xml, callback) {
		try {
			eval("var t=" + xml.responseText)
		} catch (e) {
			dhx4.callEvent("onLoadXMLerror", ["Incorrect JSON", (xml), this]);
			return
		}
		var p = new jsonPointer(t);
		this._parse(p);
		this._p = p;
		if (callback) {
			callback.call(this, xml)
		}
	};
	dhx4.ajax.get(file, function(obj) {
		that.XMLLoader(obj.xmlDoc, callback)
	})
};
dhtmlXTreeObject.prototype.serializeTreeToJSON = function() {
	var a = ['{"id":"' + this.rootId + '", "item":['];
	var g = [];
	for (var c = 0; c < this.htmlNode.childsCount; c++) {
		g.push(this._serializeItemJSON(this.htmlNode.childNodes[c]))
	}
	a.push(g.join(","));
	a.push("]}");
	return a.join("")
};
dhtmlXTreeObject.prototype._serializeItemJSON = function(o) {
	var a = [];
	if (o.unParsed) {
		return (o.unParsed.text())
	}
	if (this._selected.length) {
		var g = this._selected[0].id
	} else {
		g = ""
	}
	var n = o.span.innerHTML;
	n = n.replace(/\"/g, '\\"', n);
	if (!this._xfullXML) {
		a.push('{ "id":"' + o.id + '", ' + (this._getOpenState(o) == 1 ? ' "open":"1", ' : "") + (g == o.id ? ' "select":"1",' : "") + ' "text":"' + n + '"' + (((this.XMLsource) && (o.XMLload == 0)) ? ', "child":"1" ' : ""))
	} else {
		a.push('{ "id":"' + o.id + '", ' + (this._getOpenState(o) == 1 ? ' "open":"1", ' : "") + (g == o.id ? ' "select":"1",' : "") + ' "text":"' + n + '", "im0":"' + o.images[0] + '", "im1":"' + o.images[1] + '", "im2":"' + o.images[2] + '" ' + (o.acolor ? (', "aCol":"' + o.acolor + '" ') : "") + (o.scolor ? (', "sCol":"' + o.scolor + '" ') : "") + (o.checkstate == 1 ? ', "checked":"1" ' : (o.checkstate == 2 ? ', "checked":"-1"' : "")) + (o.closeable ? ', "closeable":"1" ' : "") + (((this.XMLsource) && (o.XMLload == 0)) ? ', "child":"1" ' : ""))
	}
	if ((this._xuserData) && (o._userdatalist)) {
		a.push(', "userdata":[');
		var m = o._userdatalist.split(",");
		var l = [];
		for (var c = 0; c < m.length; c++) {
			l.push('{ "name":"' + m[c] + '" , "content":"' + o.userData["t_" + m[c]] + '" }')
		}
		a.push(l.join(","));
		a.push("]")
	}
	if (o.childsCount) {
		a.push(', "item":[');
		var l = [];
		for (var c = 0; c < o.childsCount; c++) {
			l.push(this._serializeItemJSON(o.childNodes[c]))
		}
		a.push(l.join(","));
		a.push("]\n")
	}
	a.push("}\n");
	return a.join("")
};

function dhtmlXTreeFromHTML(obj) {
	if (typeof(obj) != "object") {
		obj = document.getElementById(obj)
	}
	var n = obj;
	var id = n.id;
	var cont = "";
	for (var j = 0; j < obj.childNodes.length; j++) {
		if (obj.childNodes[j].nodeType == "1") {
			if (obj.childNodes[j].tagName == "XMP") {
				var cHead = obj.childNodes[j];
				for (var m = 0; m < cHead.childNodes.length; m++) {
					cont += cHead.childNodes[m].data
				}
			} else {
				if (obj.childNodes[j].tagName.toLowerCase() == "ul") {
					cont = dhx_li2trees(obj.childNodes[j], new Array(), 0)
				}
			}
			break
		}
	}
	obj.innerHTML = "";
	var t = new dhtmlXTreeObject(obj, "100%", "100%", 0);
	var z_all = new Array();
	for (b in t) {
		z_all[b.toLowerCase()] = b
	}
	var atr = obj.attributes;
	for (var a = 0; a < atr.length; a++) {
		if ((atr[a].name.indexOf("set") == 0) || (atr[a].name.indexOf("enable") == 0)) {
			var an = atr[a].name;
			if (!t[an]) {
				an = z_all[atr[a].name]
			}
			t[an].apply(t, atr[a].value.split(","))
		}
	}
	if (typeof(cont) == "object") {
		t.XMLloadingWarning = 1;
		for (var i = 0; i < cont.length; i++) {
			var n = t.insertNewItem(cont[i][0], cont[i][3], cont[i][1]);
			if (cont[i][2]) {
				t._setCheck(n, cont[i][2])
			}
		}
		t.XMLloadingWarning = 0;
		t.lastLoadedXMLId = 0;
		t._redrawFrom(t)
	} else {
		t.loadXMLString("<tree id='0'>" + cont + "</tree>")
	}
	window[id] = t;
	var oninit = obj.getAttribute("oninit");
	if (oninit) {
		eval(oninit)
	}
	return t
}

function dhx_init_trees() {
	var c = document.getElementsByTagName("div");
	for (var a = 0; a < c.length; a++) {
		if (c[a].className == "dhtmlxTree") {
			dhtmlXTreeFromHTML(c[a])
		}
	}
}

function dhx_li2trees(u, n, g) {
	for (var o = 0; o < u.childNodes.length; o++) {
		var s = u.childNodes[o];
		if ((s.nodeType == 1) && (s.tagName.toLowerCase() == "li")) {
			var r = "";
			var q = null;
			var a = s.getAttribute("checked");
			for (var m = 0; m < s.childNodes.length; m++) {
				var l = s.childNodes[m];
				if (l.nodeType == 3) {
					r += l.data
				} else {
					if (l.tagName.toLowerCase() != "ul") {
						r += dhx_outer_html(l)
					} else {
						q = l
					}
				}
			}
			n[n.length] = [g, r, a, (s.id || (n.length + 1))];
			if (q) {
				n = dhx_li2trees(q, n, (s.id || n.length))
			}
		}
	}
	return n
}

function dhx_outer_html(c) {
	if (c.outerHTML) {
		return c.outerHTML
	}
	var a = document.createElement("DIV");
	a.appendChild(c.cloneNode(true));
	a = a.innerHTML;
	return a
}
if (window.addEventListener) {
	window.addEventListener("load", dhx_init_trees, false)
} else {
	if (window.attachEvent) {
		window.attachEvent("onload", dhx_init_trees)
	}
}
dhtmlXTreeObject.prototype.parserExtension = {
	_parseExtension: function(l, c, g) {
		this._idpull[c.id]._attrs = c
	}
};
dhtmlXTreeObject.prototype.getAttribute = function(g, a) {
	this._globalIdStorageFind(g);
	var c = this._idpull[g]._attrs;
	return c ? c[a] : window.undefined
};
dhtmlXTreeObject.prototype.setAttribute = function(l, a, g) {
	this._globalIdStorageFind(l);
	var c = (this._idpull[l]._attrs) || {};
	c[a] = g;
	this._idpull[l]._attrs = c
};
dhtmlXTreeObject.prototype.enableKeyboardNavigation = function(g) {
	this._enblkbrd = dhx4.s2b(g);
	if (this._enblkbrd) {
		if (_isFF) {
			var c = window.getComputedStyle(this.parentObject, null)["position"];
			if ((c != "absolute") && (c != "relative")) {
				this.parentObject.style.position = "relative"
			}
		}
		this._navKeys = [
			["up", 38],
			["down", 40],
			["open", 39],
			["close", 37],
			["call", 13],
			["edit", 113]
		];
		var a = this;
		var c = document.createElement("INPUT");
		c.className = "a_dhx_hidden_input";
		c.autocomplete = "off";
		if (window._KHTMLrv) {
			c.style.color = "white"
		}
		this.parentObject.appendChild(c);
		this.parentObject[_isOpera ? "onkeypress" : "onkeydown"] = function(l) {
			if (a.callEvent("onKeyPress", [(l || window.event).keyCode, (l || window.event)])) {
				return a._onKeyDown(l || window.event)
			}
		};
		this.parentObject.onclick = function(l) {
			if (_isFF || _isIE) {
				c.select()
			}
			if (window._KHTMLrv || _isOpera) {
				c.focus()
			}
		}
	} else {
		this.parentObject.onkeydown = null
	}
};
dhtmlXTreeObject.prototype._onKeyDown = function(g) {
	if (window.globalActiveDHTMLGridObject && globalActiveDHTMLGridObject.isActive) {
		return true
	}
	var a = this;
	for (var c = 0; c < this._navKeys.length; c++) {
		if (this._navKeys[c][1] == g.keyCode) {
			this["_onkey_" + this._navKeys[c][0]].apply(this, [this.getSelectedItemId()]);
			if (g.preventDefault) {
				g.preventDefault()
			}(g || event).cancelBubble = true;
			return false
		}
	}
	if (this._textSearch) {
		return this._searchItemByKey(g)
	}
	return true
};
dhtmlXTreeObject.prototype._onkey_up = function(g) {
	var a = this._globalIdStorageFind(g);
	if (!a) {
		return
	}
	var c = this._getPrevVisibleNode(a);
	if (c.id == this.rootId) {
		return
	}
	this.focusItem(c.id);
	this.selectItem(c.id, false)
};
dhtmlXTreeObject.prototype._onkey_down = function(g) {
	var a = this._globalIdStorageFind(g);
	if (!a) {
		return
	}
	var c = this._getNextVisibleNode(a);
	if (c.id == this.rootId) {
		return
	}
	this.focusItem(c.id);
	this.selectItem(c.id, false)
};
dhtmlXTreeObject.prototype._onkey_open = function(a) {
	this.openItem(a)
};
dhtmlXTreeObject.prototype._onkey_close = function(a) {
	this.closeItem(a)
};
dhtmlXTreeObject.prototype._onkey_call = function(a) {
	if (this.stopEdit) {
		this.stopEdit();
		this.parentObject.lastChild.focus();
		this.parentObject.lastChild.focus();
		this.selectItem(a, true)
	} else {
		this.selectItem(this.getSelectedItemId(), true)
	}
};
dhtmlXTreeObject.prototype._onkey_edit = function(a) {
	if (this.editItem) {
		this.editItem(a)
	}
};
dhtmlXTreeObject.prototype._getNextVisibleNode = function(a, c) {
	if ((!c) && (this._getOpenState(a) > 0)) {
		return a.childNodes[0]
	}
	if ((a.tr) && (a.tr.nextSibling) && (a.tr.nextSibling.nodem)) {
		return a.tr.nextSibling.nodem
	}
	if (a.parentObject) {
		return this._getNextVisibleNode(a.parentObject, 1)
	}
	return a
};
dhtmlXTreeObject.prototype._getPrevVisibleNode = function(a) {
	if ((a.tr) && (a.tr.previousSibling) && (a.tr.previousSibling.nodem)) {
		return this._lastVisibleChild(a.tr.previousSibling.nodem)
	}
	if (a.parentObject) {
		return a.parentObject
	} else {
		return a
	}
};
dhtmlXTreeObject.prototype._lastVisibleChild = function(a) {
	if (this._getOpenState(a) > 0) {
		return this._lastVisibleChild(a.childNodes[a.childsCount - 1])
	} else {
		return a
	}
};
dhtmlXTreeObject.prototype._searchItemByKey = function(c) {
	if (c.keyCode == 8) {
		this._textSearchString = "";
		return true
	}
	var a = String.fromCharCode(c.keyCode).toUpperCase();
	if (a.match(/[A-Z,a-z,0-9\ ]/)) {
		this._textSearchString += a;
		this._textSearchInProgress = true;
		if (!(this.getSelectedItemText() || "").match(RegExp("^" + this._textSearchString, "i"))) {
			this.findItem(this._textSearchString, 0)
		}
		this._textSearchInProgress = false;
		if (c.preventDefault) {
			c.preventDefault()
		}(c || event).cancelBubble = true;
		return false
	}
	return true
};
dhtmlXTreeObject.prototype.assignKeys = function(a) {
	this._navKeys = a
};
dhtmlXTreeObject.prototype.enableKeySearch = function(c) {
	this._textSearch = dhx4.s2b(c);
	if (!this._textSearch) {
		return
	}
	this._textSearchString = "";
	var a = this;
	this._markItem2 = this._markItem;
	this._markItem = function(g) {
		if (!a._textSearchInProgress) {
			a._textSearchString = ""
		}
		a._markItem2(g)
	}
};
dhtmlXTreeObject.prototype.enableLoadingItem = function(a) {
	this.attachEvent("onXLS", this._showFakeItem);
	this.attachEvent("onXLE", this._hideFakeItem);
	this._tfi_text = a || "Loading..."
};
dhtmlXTreeObject.prototype._showFakeItem = function(a, g) {
	if ((g === null) || (this._globalIdStorageFind("fake_load_xml_" + g))) {
		return
	}
	var c = this.XMLsource;
	this.XMLsource = null;
	this.insertNewItem(g, "fake_load_xml_" + g, this._tfi_text);
	this.XMLsource = c
};
dhtmlXTreeObject.prototype._hideFakeItem = function(a, c) {
	if (c === null) {
		return
	}
	this.deleteItem("fake_load_xml_" + c)
};
dhtmlXTreeObject.prototype.isLocked = function(a) {
	if (!this._locker) {
		this._init_lock()
	}
	return (this._locker[a] == true)
};
dhtmlXTreeObject.prototype._lockItem = function(a, m, c) {
	if (!this._locker) {
		this._init_lock()
	}
	if (m) {
		if (this._locker[a.id] == true) {
			return
		}
		this._locker[a.id] = true;
		a.bIm0 = a.images[0];
		a.bIm1 = a.images[1];
		a.bIm2 = a.images[2];
		a.images[0] = this.lico0;
		a.images[1] = this.lico1;
		a.images[2] = this.lico2;
		var l = a.span.parentNode;
		var g = l.previousSibling;
		this.dragger.removeDraggableItem(l);
		this.dragger.removeDraggableItem(g)
	} else {
		if (this._locker[a.id] != true) {
			return
		}
		this._locker[a.id] = false;
		a.images[0] = a.bIm0;
		a.images[1] = a.bIm1;
		a.images[2] = a.bIm2;
		var l = a.span.parentNode;
		var g = l.previousSibling;
		this.dragger.addDraggableItem(l, this);
		this.dragger.addDraggableItem(g, this)
	}
	if (!c) {
		this._correctPlus(a)
	}
};
dhtmlXTreeObject.prototype.lockItem = function(g, c) {
	if (!this._locker) {
		this._init_lock()
	}
	this._lockOn = false;
	var a = this._globalIdStorageFind(g);
	this._lockOn = true;
	this._lockItem(a, dhx4.s2b(c))
};
dhtmlXTreeObject.prototype.setLockedIcons = function(g, c, a) {
	if (!this._locker) {
		this._init_lock()
	}
	this.lico0 = g;
	this.lico1 = c;
	this.lico2 = a
};
dhtmlXTreeObject.prototype._init_lock = function() {
	this._locker = new Array();
	this._locker_count = "0";
	this._lockOn = true;
	this._globalIdStorageFindA = this._globalIdStorageFind;
	this._globalIdStorageFind = this._lockIdFind;
	if (this._serializeItem) {
		this._serializeItemA = this._serializeItem;
		this._serializeItem = this._serializeLockItem;
		this._serializeTreeA = this.serializeTree;
		this.serializeTree = this._serializeLockTree
	}
	this.setLockedIcons(this.imageArray[0], this.imageArray[1], this.imageArray[2])
};
dhtmlXTreeObject.prototype._lockIdFind = function(g, a, c) {
	if (!this.skipLock) {
		if ((!c) && (this._lockOn == true) && (this._locker[g] == true)) {
			return null
		}
	}
	return this._globalIdStorageFindA(g, a, c)
};
dhtmlXTreeObject.prototype._serializeLockItem = function(a) {
	if (this._locker[a.id] == true) {
		return ""
	}
	return this._serializeItemA(a)
};
dhtmlXTreeObject.prototype._serializeLockTree = function() {
	var a = this._serializeTreeA();
	return a.replace(/<item[^>]+locked\=\"1\"[^>]+\/>/g, "")
};
dhtmlXTreeObject.prototype._moveNodeToA = dhtmlXTreeObject.prototype._moveNodeTo;
dhtmlXTreeObject.prototype._moveNodeTo = function(a, g, c) {
	if ((g.treeNod.isLocked) && (g.treeNod.isLocked(g.id))) {
		return false
	}
	return this._moveNodeToA(a, g, c)
};
dhtmlXTreeObject.prototype.lockTree = function(a) {
	if (dhx4.s2b(a)) {
		this._initTreeLocker()
	} else {
		if (this._TreeLocker) {
			this._TreeLocker.parentNode.removeChild(this._TreeLocker);
			this._TreeLocker = null
		}
	}
};
dhtmlXTreeObject.prototype._initTreeLocker = function(a) {
	if (this._TreeLocker) {
		return
	}
	this.parentObject.style.overflow = "hidden";
	if (this.parentObject.style.position != "absolute") {
		this.parentObject.style.position = "relative"
	}
	var c = document.createElement("div");
	c.style.position = "absolute";
	c.style.left = "0px";
	c.style.top = "0px";
	c.className = "dhx_tree_opacity";
	c.style.width = this.allTree.offsetWidth + "px";
	c.style.backgroundColor = "#FFFFFF";
	c.style.height = this.allTree.offsetHeight + "px";
	this._TreeLocker = c;
	this.parentObject.appendChild(this._TreeLocker)
};
dhtmlXTreeObject.prototype.enableRTL = function(c) {
	var a = dhx4.s2b(c);
	if (((a) && (!this.rtlMode)) || ((!a) && (this.rtlMode))) {
		this.rtlMode = a;
		this._switchToRTL(this.rtlMode)
	}
};
dhtmlXTreeObject.prototype._switchToRTL = function(a) {
	if (a) {
		this.allTree.className = this._ltr_line = this.lineArray;
		this._ltr_min = this.minusArray;
		this._ltr_plus = this.plusArray;
		this.lineArray = new Array("line2_rtl.gif", "line3_rtl.gif", "line4_rtl.gif", "blank.gif", "blank.gif", "line1_rtl.gif");
		this.minusArray = new Array("minus2_rtl.gif", "minus3_rtl.gif", "minus4_rtl.gif", "minus.gif", "minus5_rtl.gif");
		this.plusArray = new Array("plus2_rtl.gif", "plus3_rtl.gif", "plus4_rtl.gif", "plus.gif", "plus5_rtl.gif");
		this.allTree.className = "containerTableStyleRTL"
	} else {
		this.allTree.className = "containerTableStyle";
		this.lineArray = this._ltr_line;
		this.minusArray = this._ltr_min;
		this.plusArray = this._ltr_plus
	}
	if (this.htmlNode.childsCount) {
		this._redrawFrom(this, this.htmlNode)
	}
};
dhtmlXTreeObject.prototype.sortTree = function(l, c, g) {
	var a = this._globalIdStorageFind(l);
	if (!a) {
		return false
	}
	this._reorderBranch(a, (c.toString().toLowerCase() == "asc"), dhx4.s2b(g))
};
dhtmlXTreeObject.prototype.setCustomSortFunction = function(a) {
	this._csfunca = a
};
dhtmlXTreeObject.prototype._reorderBranch = function(q, c, r) {
	var a = [];
	var o = q.childsCount;
	if (!o) {
		return
	}
	var n = q.childNodes[0].tr.parentNode;
	for (var l = 0; l < o; l++) {
		a[l] = q.childNodes[l];
		n.removeChild(a[l].tr)
	}
	var g = this;
	if (c == 1) {
		if (this._csfunca) {
			a.sort(function(s, m) {
				return g._csfunca(s.id, m.id)
			})
		} else {
			a.sort(function(s, m) {
				return ((s.span.innerHTML.toUpperCase() > m.span.innerHTML.toUpperCase()) ? 1 : ((s.span.innerHTML.toUpperCase() == m.span.innerHTML.toUpperCase()) ? 0 : -1))
			})
		}
	} else {
		if (this._csfunca) {
			a.sort(function(s, m) {
				return g._csfunca(m.id, s.id)
			})
		} else {
			a.sort(function(s, m) {
				return ((s.span.innerHTML.toUpperCase() < m.span.innerHTML.toUpperCase()) ? 1 : ((s.span.innerHTML.toUpperCase() == m.span.innerHTML.toUpperCase()) ? 0 : -1))
			})
		}
	}
	for (var l = 0; l < o; l++) {
		n.appendChild(a[l].tr);
		q.childNodes[l] = a[l];
		if ((r) && (a[l].unParsed)) {
			a[l].unParsed.set("order", c ? 1 : -1)
		} else {
			if ((r) && (a[l].childsCount)) {
				this._reorderBranch(a[l], c, r)
			}
		}
	}
	for (var l = 0; l < o; l++) {
		this._correctPlus(a[l]);
		this._correctLine(a[l])
	}
};
dhtmlXTreeObject.prototype._reorderXMLBranch = function(o) {
	var q = o.getAttribute("order");
	if (q == "none") {
		return
	}
	var c = (q == 1);
	var n = o.childNodes.length;
	if (!n) {
		return
	}
	var a = new Array();
	var g = 0;
	for (var l = 0; l < n; l++) {
		if (o.childNodes[l].nodeType == 1) {
			a[g] = o.childNodes[l];
			g++
		}
	}
	for (var l = n - 1; l != 0; l--) {
		o.removeChild(o.childNodes[l])
	}
	if (c) {
		a.sort(function(r, m) {
			return ((r.getAttribute("text") > m.getAttribute("text")) ? 1 : ((r.getAttribute("text") == m.getAttribute("text")) ? 0 : -1))
		})
	} else {
		a.sort(function(r, m) {
			return ((r.getAttribute("text") < m.getAttribute("text")) ? 1 : ((r.getAttribute("text") == m.getAttribute("text")) ? 0 : -1))
		})
	}
	for (var l = 0; l < g; l++) {
		a[l].setAttribute("order", q);
		o.appendChild(a[l])
	}
	o.setAttribute("order", "none")
};
dhtmlXTreeObject.prototype._serEnts = [
	["&", "&amp;"],
	["<", "&lt;"],
	[">", "&gt;"]
];
dhtmlXTreeObject.prototype.registerXMLEntity = function(a, c) {
	this._serEnts[this._serEnts.length] = [a, c, new RegExp(a, "g")]
};
dhtmlXTreeObject.prototype.setSerializationLevel = function(a, c, m, n, g) {
	this._xuserData = dhx4.s2b(a);
	this._xfullXML = dhx4.s2b(c);
	this._dtd = g;
	this._xescapeEntities = dhx4.s2b(m);
	if (dhx4.s2b(n)) {
		this._apreUC = "<![CDATA[";
		this._apstUC = "]]>"
	} else {}
	for (var l = 0; l < this._serEnts.length; l++) {
		this._serEnts[l][2] = new RegExp(this._serEnts[l][0], "g")
	}
};
dhtmlXTreeObject.prototype.serializeTree = function() {
	if (this.stopEdit) {
		this.stopEdit()
	}
	this._apreUC = this._apreUC || "";
	this._apstUC = this._apstUC || "";
	var a = '<?xml version="1.0"?>';
	if (this._dtd) {
		a += '<!DOCTYPE tree SYSTEM "' + this._dtd + '">'
	}
	a += '<tree id="' + this.rootId + '">';
	if ((this._xuserData) && (this._idpull[this.rootId]._userdatalist)) {
		var g = this._idpull[this.rootId]._userdatalist.split(",");
		for (var c = 0; c < g.length; c++) {
			a += '<userdata name="' + g[c] + '">' + this._apreUC + this._idpull[this.rootId].userData["t_" + g[c]] + this._apstUC + "</userdata>"
		}
	}
	for (var c = 0; c < this.htmlNode.childsCount; c++) {
		a += this._serializeItem(this.htmlNode.childNodes[c])
	}
	a += "</tree>";
	return a
};
dhtmlXTreeObject.prototype._serializeItem = function(o) {
	if (o.unParsed) {
		if (document.all) {
			return o.unParsed.d.xml
		} else {
			var a = new XMLSerializer();
			return a.serializeToString(o.unParsed.d)
		}
	}
	var c = "";
	if (this._selected.length) {
		var l = this._selected[0].id
	} else {
		l = '"'
	}
	var n = o.span.innerHTML;
	if (this._xescapeEntities) {
		for (var g = 0; g < this._serEnts.length; g++) {
			n = n.replace(this._serEnts[g][2], this._serEnts[g][1])
		}
	}
	if (!this._xfullXML) {
		c = '<item id="' + o.id + '" ' + (this._getOpenState(o) == 1 ? ' open="1" ' : "") + (l == o.id ? ' select="1"' : "") + ' text="' + n + '"' + (((this.XMLsource) && (o.XMLload == 0)) ? ' child="1" ' : "") + ">"
	} else {
		c = '<item id="' + o.id + '" ' + (this._getOpenState(o) == 1 ? ' open="1" ' : "") + (l == o.id ? ' select="1"' : "") + ' text="' + n + '" im0="' + o.images[0] + '" im1="' + o.images[1] + '" im2="' + o.images[2] + '" ' + (o.acolor ? ('aCol="' + o.acolor + '" ') : "") + (o.scolor ? ('sCol="' + o.scolor + '" ') : "") + (o.checkstate == 1 ? 'checked="1" ' : (o.checkstate == 2 ? 'checked="-1"' : "")) + (o.closeable ? 'closeable="1" ' : "") + (((this.XMLsource) && (o.XMLload == 0)) ? ' child="1" ' : "") + ">"
	}
	if ((this._xuserData) && (o._userdatalist)) {
		var m = o._userdatalist.split(",");
		for (var g = 0; g < m.length; g++) {
			c += '<userdata name="' + m[g] + '">' + this._apreUC + o.userData["t_" + m[g]] + this._apstUC + "</userdata>"
		}
	}
	for (var g = 0; g < o.childsCount; g++) {
		c += this._serializeItem(o.childNodes[g])
	}
	c += "</item>";
	return c
};
dhtmlXTreeObject.prototype.saveSelectedItem = function(c, a) {
	c = c || "";
	this.setCookie("treeStateSelected" + c, this.getSelectedItemId(), a)
};
dhtmlXTreeObject.prototype.restoreSelectedItem = function(a) {
	a = a || "";
	var c = this.getCookie("treeStateSelected" + a);
	this.selectItem(c, false)
};
dhtmlXTreeObject.prototype.enableAutoSavingSelected = function(a, c) {
	this.assMode = dhx4.s2b(a);
	if ((this.assMode) && (!this.oldOnSelect)) {
		this.oldOnSelect = this.onRowSelect;
		this.onRowSelect = function(l, g, m) {
			if (!g) {
				g = this
			}
			g.parentObject.treeNod.oldOnSelect(l, g, m);
			if (g.parentObject.treeNod.assMode) {
				g.parentObject.treeNod.saveSelectedItem(g.parentObject.treeNod.assCookieName)
			}
		}
	}
	this.assCookieName = c
};
dhtmlXTreeObject.prototype.saveState = function(g, c) {
	var m = this._escape(this.serializeTree());
	var a = 4000;
	if (m.length > a) {
		if (navigator.appName.indexOf("Microsoft") != -1) {
			return false
		}
		this.setCookie("treeStatex" + g, Math.ceil(m.length / a));
		for (var l = 0; l < Math.ceil(m.length / a); l++) {
			this.setCookie("treeStatex" + g + "x" + l, m.substr(l * a, a), c)
		}
	} else {
		this.setCookie("treeStatex" + g, m, c)
	}
	var m = this.getCookie("treeStatex" + g);
	if (!m) {
		this.setCookie("treeStatex" + g, "", c);
		return false
	}
	return true
};
dhtmlXTreeObject.prototype.loadState = function(a) {
	var l = this.getCookie("treeStatex" + a);
	if (!l) {
		return false
	}
	if (l.length) {
		if (l.toString().length < 4) {
			var g = "";
			for (var c = 0; c < l; c++) {
				g += this.getCookie("treeStatex" + a + "x" + c)
			}
			l = g
		}
		this.loadXMLString((this.utfesc == "utf8") ? decodeURI(l) : unescape(l))
	}
	return true
};
dhtmlXTreeObject.prototype.setCookie = function(c, g, a) {
	var l = c + "=" + g + (a ? ("; " + a) : "");
	document.cookie = l
};
dhtmlXTreeObject.prototype.getCookie = function(c) {
	var g = c + "=";
	if (document.cookie.length > 0) {
		var l = document.cookie.indexOf(g);
		if (l != -1) {
			l += g.length;
			var a = document.cookie.indexOf(";", l);
			if (a == -1) {
				a = document.cookie.length
			}
			return document.cookie.substring(l, a)
		}
	}
};
dhtmlXTreeObject.prototype.saveOpenStates = function(c, a) {
	var l = [];
	for (var g = 0; g < this.htmlNode.childsCount; g++) {
		l = l.concat(this._collectOpenStates(this.htmlNode.childNodes[g]))
	}
	l = l.join(this.dlmtr);
	this.setCookie("treeOpenStatex" + c, l, a)
};
dhtmlXTreeObject.prototype.loadOpenStates = function(c) {
	for (var g = 0; g < this.htmlNode.childsCount; g++) {
		this._xcloseAll(this.htmlNode.childNodes[g])
	}
	this.allTree.childNodes[0].border = "1";
	this.allTree.childNodes[0].border = "0";
	var m = getCookie("treeOpenStatex" + c);
	if (m) {
		var a = m.split(this.dlmtr);
		for (var g = 0; g < a.length; g++) {
			var l = this._globalIdStorageFind(a[g]);
			if (l) {
				if ((this.XMLsource) && (!l.XMLload) && (l.id != this.rootId)) {
					this._delayedLoad(l, "loadOpenStates('" + c + "')");
					return
				} else {
					this.openItem(a[g])
				}
			}
		}
	}
	this.callEvent("onAllOpenDynamic", [])
};
dhtmlXTreeObject.prototype._delayedLoad = function(c, a) {
	this.afterLoadMethod = a;
	this.onLoadReserve = this.onXLE;
	this.onXLE = this._delayedLoadStep2;
	this._loadDynXML(c.id)
};
dhtmlXTreeObject.prototype._delayedLoadStep2 = function(tree) {
	tree.onXLE = tree.onLoadReserve;
	window.setTimeout(function() {
		dhtmlx.temp = tree;
		eval("dhtmlx.temp." + tree.afterLoadMethod)
	}, 100);
	if (tree.onXLE) {
		tree.onXLE(tree)
	}
	tree.callEvent("onXLE", [tree])
};
dhtmlXTreeObject.prototype._collectOpenStates = function(c) {
	var g = [];
	if (this._getOpenState(c) == 1) {
		g.push(c.id);
		for (var a = 0; a < c.childsCount; a++) {
			g = g.concat(this._collectOpenStates(c.childNodes[a]))
		}
	}
	return g
};

function setCookie(a, c) {
	document.cookie = a + "=" + c
}

function getCookie(c) {
	var g = c + "=";
	if (document.cookie.length > 0) {
		var l = document.cookie.indexOf(g);
		if (l != -1) {
			l += g.length;
			var a = document.cookie.indexOf(";", l);
			if (a == -1) {
				a = document.cookie.length
			}
			return (document.cookie.substring(l, a))
		}
	}
}
dhtmlXTreeObject.prototype.openAllItemsDynamic = function(a) {
	this.ClosedElem = new Array();
	this.G_node = null;
	var c = this._globalIdStorageFind(a || this.rootId);
	if (c.id != this.rootId && this.getOpenState(c.id) != 0) {
		this.openItem(a)
	}
	this._openAllNodeChilds(c, 0);
	if (this.ClosedElem.length > 0) {
		this.onLoadReserve = this.onXLE;
		this.onXLE = this._loadAndOpen;
		this._loadAndOpen(this)
	}
};
dhtmlXTreeObject.prototype._openAllNodeChilds = function(c) {
	if ((c.XMLload == 0) || (c.unParsed)) {
		this.ClosedElem.push(c)
	}
	for (var a = 0; a < c.childsCount; a++) {
		if (this._getOpenState(c.childNodes[a]) < 0) {
			this._HideShow(c.childNodes[a], 2)
		}
		if (c.childNodes[a].childsCount > 0) {
			this._openAllNodeChilds(c.childNodes[a])
		}
		if ((c.childNodes[a].XMLload == 0) || (c.childNodes[a].unParsed)) {
			this.ClosedElem.push(c.childNodes[a])
		}
	}
};
dhtmlXTreeObject.prototype._loadAndOpen = function(a) {
	if (a.G_node) {
		a._openItem(a.G_node);
		a._openAllNodeChilds(a.G_node);
		a.G_node = null
	}
	if (a.ClosedElem.length > 0) {
		a.G_node = a.ClosedElem.shift()
	}
	if (a.G_node) {
		if (a.G_node.unParsed) {
			a.reParse(a.G_node)
		} else {
			window.setTimeout(function() {
				a._loadDynXML(a.G_node.id)
			}, 100)
		}
	} else {
		a.onXLE = a.onLoadReserve;
		if (a.onXLE) {
			a.onXLE(a)
		}
		a.callEvent("onAllOpenDynamic", [a])
	}
};
dhtmlXTreeObject.prototype.openItemsDynamic = function(c, a) {
	if (this.onXLE == this._stepOpen) {
		return
	}
	this._opnItmsDnmcFlg = dhx4.s2b(a);
	this.onLoadReserve = this.onXLE;
	this.onXLE = this._stepOpen;
	this.ClosedElem = c.split(",").reverse();
	this._stepOpen(this)
};
dhtmlXTreeObject.prototype._stepOpen = function(c) {
	if (!c.ClosedElem.length) {
		c.onXLE = c.onLoadReserve;
		if (c._opnItmsDnmcFlg) {
			c.selectItem(c.G_node, true)
		}
		if ((c.onXLE) && (arguments[1])) {
			c.onXLE.apply(c, arguments)
		}
		c.callEvent("onOpenDynamicEnd", []);
		return
	}
	c.G_node = c.ClosedElem.pop();
	c.skipLock = true;
	var a = c._globalIdStorageFind(c.G_node);
	if (a) {
		if (a.XMLload === 0) {
			c.openItem(c.G_node)
		} else {
			c.openItem(c.G_node);
			c._stepOpen(c)
		}
	}
	c.skipLock = false
};
var globalActiveDHTMLGridObject;
String.prototype._dhx_trim = function() {
	return this.replace(/&nbsp;/g, " ").replace(/(^[ \t]*)|([ \t]*$)/g, "")
};

function dhtmlxArray(a) {
	return dhtmlx.extend((a || new Array()), dhtmlxArray._master)
}
dhtmlxArray._master = {
	_dhx_find: function(c) {
		for (var a = 0; a < this.length; a++) {
			if (c == this[a]) {
				return a
			}
		}
		return -1
	},
	_dhx_insertAt: function(g, c) {
		this[this.length] = null;
		for (var a = this.length - 1; a >= g; a--) {
			this[a] = this[a - 1]
		}
		this[g] = c
	},
	_dhx_removeAt: function(a) {
		this.splice(a, 1)
	},
	_dhx_swapItems: function(a, g) {
		var c = this[a];
		this[a] = this[g];
		this[g] = c
	}
};

function dhtmlXGridObject(id) {
	if (dhtmlxEvent.initTouch) {
		dhtmlxEvent.initTouch()
	}
	if (_isIE) {
		try {
			document.execCommand("BackgroundImageCache", false, true)
		} catch (e) {}
	}
	if (id) {
		if (typeof(id) == "object") {
			this.entBox = id;
			if (!this.entBox.id) {
				this.entBox.id = "cgrid2_" + this.uid()
			}
		} else {
			this.entBox = document.getElementById(id)
		}
	} else {
		this.entBox = document.createElement("DIV");
		this.entBox.id = "cgrid2_" + this.uid()
	}
	this.entBox.innerHTML = "";
	dhx4._eventable(this);
	var self = this;
	this._wcorr = 0;
	this.fontWidth = 7;
	this.cell = null;
	this.row = null;
	this.iconURL = "";
	this.editor = null;
	this._f2kE = true;
	this._dclE = true;
	this.combos = new Array(0);
	this.defVal = new Array(0);
	this.rowsAr = {};
	this.rowsBuffer = dhtmlxArray();
	this.rowsCol = dhtmlxArray();
	this._data_cache = {};
	this._ecache = {};
	this._ud_enabled = true;
	this.xmlLoader = this.doLoadDetails;
	this._maskArr = [];
	this.selectedRows = dhtmlxArray();
	this.UserData = {};
	this._sizeFix = this._borderFix = 0;
	this.entBox.className += " gridbox";
	this.entBox.style.width = this.entBox.getAttribute("width") || (window.getComputedStyle ? (this.entBox.style.width || window.getComputedStyle(this.entBox, null)["width"]) : (this.entBox.currentStyle ? this.entBox.currentStyle.width : this.entBox.style.width || 0)) || "100%";
	this.entBox.style.height = this.entBox.getAttribute("height") || (window.getComputedStyle ? (this.entBox.style.height || window.getComputedStyle(this.entBox, null)["height"]) : (this.entBox.currentStyle ? this.entBox.currentStyle.height : this.entBox.style.height || 0)) || "100%";
	
	//alert("setting width="+this.entBox.style.width+",height="+this.entBox.style.height);
	this.entBox.style.cursor = "default";
	this.entBox.onselectstart = function() {
		
		//return false 原始值
		//modify code by zzm 20180117 dhtmlx 表格对象区域鼠标可选择
		return true;
	};
	var t_creator = function(name) {
		var t = document.createElement("TABLE");
		t.cellSpacing = t.cellPadding = 0;
		t.style.cssText = "width:100%;table-layout:fixed;";
		t.className = name.substr(2);
		return t
	};
	this.obj = t_creator("c_obj");
	this.hdr = t_creator("c_hdr");
	this.hdr.style.marginRight = "20px";
	this.hdr.style.paddingRight = "20px";
	this.objBox = document.createElement("DIV");
	this.objBox.style.width = "100%";
	this.objBox.style.overflow = "auto";
	this.objBox.appendChild(this.obj);
	this.objBox.className = "objbox";
	if (dhtmlx.$customScroll) {
		dhtmlx.CustomScroll.enable(this)
	}
	this.hdrBox = document.createElement("DIV");
	this.hdrBox.style.width = "100%";
	this.hdrBox.style.height = "25px";
	this.hdrBox.style.overflow = "hidden";
	this.hdrBox.className = "xhdr";
	this.preloadImagesAr = new Array(0);
	this.sortImg = document.createElement("DIV");
	this.sortImg.style.display = "none";
	this.hdrBox.appendChild(this.sortImg);
	this.hdrBox.appendChild(this.hdr);
	this.hdrBox.style.position = "relative";
	this.entBox.appendChild(this.hdrBox);
	this.entBox.appendChild(this.objBox);
	this.entBox.grid = this;
	this.objBox.grid = this;
	this.hdrBox.grid = this;
	this.obj.grid = this;
	this.hdr.grid = this;
	this.cellWidthPX = [];
	this.cellWidthPC = [];
	this.cellWidthType = this.entBox.cellwidthtype || "px";
	this.delim = this.entBox.delimiter || ",";
	this._csvDelim = ",";
	this.hdrLabels = [];
	this.columnIds = [];
	this.columnColor = [];
	this._hrrar = [];
	this.cellType = dhtmlxArray();
	this.cellAlign = [];
	this.initCellWidth = [];
	this.fldSort = [];
	this._srdh = (_isIE && (document.compatMode != "BackCompat") ? 22 : 20);
	this.imgURL = window.dhx_globalImgPath || "";
	this.isActive = false;
	this.isEditable = true;
	this.useImagesInHeader = false;
	this.pagingOn = false;
	this.rowsBufferOutSize = 0;
	dhtmlxEvent(window, "unload", function() {
		try {
			if (self.destructor) {
				self.destructor()
			}
		} catch (e) {}
	});
	this.setSkin = function(name) {
		this._srdh = window.dhx4.readFromCss("dhxgrid_rh_" + name) + 4;
		this.skin_name = name;
		if (this._imgURL) {
			this.setImagePath(this._imgURL)
		}
		var classname = this.entBox.className.split(" gridbox")[0];
		this.entBox.className = classname + " gridbox gridbox_" + name + (_isIE ? " isIE" : " isModern");
		this.skin_h_correction = 0;
		this.enableAlterCss("ev_" + name, "odd_" + name, this.isTreeGrid());
		this._fixAlterCss();
		switch (name) {
			case "dhx_terrace":
				this._srdh = 33;
				this.forceDivInHeader = true;
				break;
			case "dhx_skyblue":
			case "dhx_web":
				this.forceDivInHeader = true;
				break
		}
		if (_isIE && this.hdr) {
			var d = this.hdr.parentNode;
			d.removeChild(this.hdr);
			d.appendChild(this.hdr)
		}
		this.setSizes()
	};
	if (_isIE) {
		this.preventIECaching(true)
	}
	if (window.dhtmlDragAndDropObject) {
		this.dragger = new dhtmlDragAndDropObject()
	}
	this._doOnScroll = function(e, mode) {
		this.callEvent("onScroll", [this.objBox.scrollLeft, this.objBox.scrollTop]);
		this.doOnScroll(e, mode)
	};
	this.doOnScroll = function(e, mode) {
		this.hdrBox.scrollLeft = this.objBox.scrollLeft;
		if (this.ftr) {
			this.ftr.parentNode.scrollLeft = this.objBox.scrollLeft
		}
		if (mode) {
			return
		}
		if (this._srnd) {
			if (this._dLoadTimer) {
				window.clearTimeout(this._dLoadTimer)
			}
			this._dLoadTimer = window.setTimeout(function() {
				if (self._update_srnd_view) {
					self._update_srnd_view()
				}
			}, 100)
		}
	};
	this.attachToObject = function(obj) {
		obj.appendChild(this.globalBox ? this.globalBox : this.entBox);
		this.setSizes()
	};
	this.init = function(fl) {
		if ((this.isTreeGrid()) && (!this._h2)) {
			this._h2 = this._createHierarchy();
			if ((this._fake) && (!this._realfake)) {
				this._fake._h2 = this._h2
			}
			this._tgc = {
				imgURL: null
			}
		}
		if (!this._hstyles) {
			return
		}
		if (!this.skin_name) {
			this.setSkin(window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhxgrid") || "dhx_skyblue")
		}
		this.editStop();
		this.lastClicked = null;
		this.resized = null;
		this.fldSorted = this.r_fldSorted = null;
		this.cellWidthPX = [];
		this.cellWidthPC = [];
		if (this.hdr.rows.length > 0) {
			var temp = this.xmlFileUrl;
			this.clearAll(true);
			this.xmlFileUrl = temp
		}
		var hdrRow = this.hdr.insertRow(0);
		for (var i = 0; i < this.hdrLabels.length; i++) {
			hdrRow.appendChild(document.createElement("TH"));
			hdrRow.childNodes[i]._cellIndex = i;
			hdrRow.childNodes[i].style.height = "0px"
		}
		if (_isIE && _isIE < 8 && document.body.style.msTouchAction == this.undefined) {
			hdrRow.style.position = "absolute"
		} else {
			hdrRow.style.height = "auto"
		}
		var hdrRow = this.hdr.insertRow(_isKHTML ? 2 : 1);
		hdrRow._childIndexes = new Array();
		var col_ex = 0;
		for (var i = 0; i < this.hdrLabels.length; i++) {
			hdrRow._childIndexes[i] = i - col_ex;
			if ((this.hdrLabels[i] == this.splitSign) && (i != 0)) {
				if (_isKHTML) {
					hdrRow.insertCell(i - col_ex)
				}
				hdrRow.cells[i - col_ex - 1].colSpan = (hdrRow.cells[i - col_ex - 1].colSpan || 1) + 1;
				hdrRow.childNodes[i - col_ex - 1]._cellIndex++;
				col_ex++;
				hdrRow._childIndexes[i] = i - col_ex;
				continue
			}
			hdrRow.insertCell(i - col_ex);
			hdrRow.childNodes[i - col_ex]._cellIndex = i;
			hdrRow.childNodes[i - col_ex]._cellIndexS = i;
			this.setColumnLabel(i, this.hdrLabels[i])
		}
		if (col_ex == 0) {
			hdrRow._childIndexes = null
		}
		this._cCount = this.hdrLabels.length;
		if (_isIE) {
			window.setTimeout(function() {
				if (self.setSizes) {
					self.setSizes()
				}
			}, 1)
		}
		if (!this.obj.firstChild) {
			this.obj.appendChild(document.createElement("TBODY"))
		}
		var tar = this.obj.firstChild;
		if (!tar.firstChild) {
			tar.appendChild(document.createElement("TR"));
			tar = tar.firstChild;
			if (_isIE && _isIE < 8 && document.body.style.msTouchAction == this.undefined) {
				tar.style.position = "absolute"
			} else {
				tar.style.height = "auto"
			}
			for (var i = 0; i < this.hdrLabels.length; i++) {
				tar.appendChild(document.createElement("TH"));
				tar.childNodes[i].style.height = "0px"
			}
		}
		this._c_order = null;
		if (this.multiLine != true) {
			this.obj.className += " row20px"
		}
		this.sortImg.style.position = "absolute";
		this.sortImg.style.display = "none";
		this.sortImg.className = "dhxgrid_sort_desc";
		this.sortImg.defLeft = 0;
		if (this.noHeader) {
			this.hdrBox.style.display = "none"
		} else {
			this.noHeader = false
		}
		if (this._ivizcol) {
			this.setColHidden()
		}
		this.attachHeader();
		this.attachHeader(0, 0, "_aFoot");
		this.setSizes();
		if (fl) {
			this.parseXML()
		}
		this.obj.scrollTop = 0;
		if (this.dragAndDropOff) {
			this.dragger.addDragLanding(this.entBox, this)
		}
		if (this._initDrF) {
			this._initD()
		}
		dhx4.callEvent("onGridCreated", [this])
	};
	this.setColumnSizes = function(gridWidth) {
		var summ = 0;
		var fcols = [];
		var fix = 0;
		for (var i = 0; i < this._cCount; i++) {
			if ((this.initCellWidth[i] == "*") && !this._hrrar[i]) {
				this._awdth = false;
				fcols.push(i);
				continue
			}
			if (this.cellWidthType == "%") {
				if (typeof this.cellWidthPC[i] == "undefined") {
					this.cellWidthPC[i] = this.initCellWidth[i]
				}
				var cwidth = (gridWidth * this.cellWidthPC[i] / 100) || 0;
				if (fix > 0.5) {
					cwidth++;
					fix--
				}
				var rwidth = this.cellWidthPX[i] = Math.floor(cwidth);
				var fix = fix + cwidth - rwidth
			} else {
				if (typeof this.cellWidthPX[i] == "undefined") {
					this.cellWidthPX[i] = this.initCellWidth[i]
				}
			}
			if (!this._hrrar[i]) {
				summ += this.cellWidthPX[i] * 1
			}
		}
		if (fcols.length) {
			var ms = Math.floor((gridWidth - summ) / fcols.length);
			if (ms < 0) {
				ms = 1
			}
			for (var i = 0; i < fcols.length; i++) {
				var next = Math.max((this._drsclmW ? (this._drsclmW[fcols[i]] || 0) : 0), ms);
				this.cellWidthPX[fcols[i]] = next;
				summ += next
			}
			if (gridWidth > summ) {
				var last = fcols[fcols.length - 1];
				this.cellWidthPX[last] = this.cellWidthPX[last] + (gridWidth - summ);
				summ = gridWidth
			}
			this._setAutoResize()
		}
		this.obj.style.width = summ + "px";
		this.hdr.style.width = summ + "px";
		if (this.ftr) {
			this.ftr.style.width = summ + "px"
		}
		this.chngCellWidth();
		return summ
	};
	this.setSizes = function() {
		if ((!this.hdr.rows[0])) {
			return
		}
		var quirks = this.quirks = (_isIE && document.compatMode == "BackCompat");
		var outerBorder = (this.entBox.offsetWidth - this.entBox.clientWidth) / 2;
		if (!this.dontSetSizes) {
			if (this.globalBox) {
				var splitOuterBorder = (this.globalBox.offsetWidth - this.globalBox.clientWidth) / 2;
				if (this._delta_x && !this._realfake) {
					var ow = this.globalBox.clientWidth;
					this.globalBox.style.width = this._delta_x;
					this.entBox.style.width = Math.max(0, (this.globalBox.clientWidth + (quirks ? splitOuterBorder * 2 : 0)) - this._fake.entBox.clientWidth) + "px";
					
					//alert("setSizes,width="+this.entBox.style.width);
					if (ow != this.globalBox.clientWidth) {
						this._fake._correctSplit(this._fake.entBox.clientWidth)
					}
				}
				if (this._delta_y && !this._realfake) {
					this.globalBox.style.height = this._delta_y;
					this.entBox.style.overflow = this._fake.entBox.style.overflow = "hidden";
					this.entBox.style.height = this._fake.entBox.style.height = this.globalBox.clientHeight + (quirks ? splitOuterBorder * 2 : 0) + "px"
				}
			} else {
				if (this._delta_x) {
					if (this.entBox.parentNode && this.entBox.parentNode.tagName == "TD") {
						this.entBox.style.width = "1px";
						this.entBox.style.width = parseInt(this._delta_x) * this.entBox.parentNode.clientWidth / 100 - outerBorder * 2 + "px"
					} else {
						this.entBox.style.width = this._delta_x
					}
					//alert("setSizes,width="+this.entBox.style.width);
				}
				if (this._delta_y) {
					this.entBox.style.height = this._delta_y
				}
			}
		}
		window.clearTimeout(this._sizeTime);
		if (!this.entBox.offsetWidth && (!this.globalBox || !this.globalBox.offsetWidth)) {
			this._sizeTime = window.setTimeout(function() {
				if (self.setSizes) {
					self.setSizes()
				}
			}, 250);
			return
		}
		
		//modify code by zzm 20160724
		var border_x = ((!this._wthB) && ((this.entBox.cmp || this._delta_x) && (this.skin_name || "").indexOf("dhx") == 0 && !quirks) ? _dhtmlx_global_border_static_value : 0);
		var border_y = ((!this._wthB) && ((this.entBox.cmp || this._delta_y) && (this.skin_name || "").indexOf("dhx") == 0 && !quirks) ? _dhtmlx_global_border_static_value : 0);
		
		
		if (this._sizeFix) {
			border_x -= this._sizeFix;
			border_y -= this._sizeFix
		}
		var isVScroll = this.parentGrid ? false : (this.objBox.scrollHeight > this.objBox.offsetHeight);
		var scrfix = dhtmlx.$customScroll ? 0 : 18;
		var gridWidth = this.entBox.clientWidth - (this.skin_h_correction || 0) * (quirks ? 0 : 1) - border_x;
		
		//alert("setSizes,gridWidth="+gridWidth+",this.entBox.clientWidth="+this.entBox.clientWidth+",border_x="+border_x+",ddv="+((this.skin_h_correction || 0) * (quirks ? 0 : 1) - border_x)+",="+this.skin_h_correction);
		
		var gridWidthActive = this.entBox.clientWidth - (this.skin_h_correction || 0) - border_x;
		var gridHeight = this.entBox.clientHeight - border_y;
		var summ = this.setColumnSizes(gridWidthActive - (isVScroll ? scrfix : 0) - (this._correction_x || 0));
		var isHScroll = this.parentGrid ? false : ((this.objBox.scrollWidth > this.objBox.offsetWidth) || (this.objBox.style.overflowX == "scroll"));
		var headerHeight = this.hdr.clientHeight;
		var footerHeight = this.ftr ? this.ftr.clientHeight : 0;
		var newWidth = gridWidth;
		var newHeight = gridHeight - headerHeight - footerHeight;
		if (this._awdth && this._awdth[0] && this._awdth[1] == 99999) {
			isHScroll = 0
		}
		if (this._ahgr) {
			if (this._ahgrMA) {
				newHeight = this.entBox.parentNode.clientHeight - headerHeight - footerHeight
			} else {
				newHeight = this.obj.offsetHeight + (isHScroll ? scrfix : 0) + (this._correction_y || 0)
			}
			if (this._ahgrM) {
				if (this._ahgrF) {
					newHeight = Math.min(this._ahgrM, newHeight + headerHeight + footerHeight) - headerHeight - footerHeight
				} else {
					newHeight = Math.min(this._ahgrM, newHeight)
				}
			}
			if (isVScroll && newHeight >= this.obj.scrollHeight + (isHScroll ? scrfix : 0)) {
				isVScroll = false;
				this.setColumnSizes(gridWidthActive - (this._correction_x || 0))
			}
		}
		if ((this._awdth) && (this._awdth[0])) {
			if (this.cellWidthType == "%") {
				this.cellWidthType = "px"
			}
			if (this._fake) {
				summ += this._fake.entBox.clientWidth
			}
			var newWidth = Math.min(Math.max(summ + (isVScroll ? scrfix : 0), this._awdth[2]), this._awdth[1]) + (this._correction_x || 0);
			this.objBox.style.overflowX = (!isVScroll && this.objBox.scrollWidth <= newWidth) ? "hidden" : "auto";
			if (this._fake) {
				newWidth -= this._fake.entBox.clientWidth
			}
		}
		newHeight = Math.max(0, newHeight);
		this._ff_size_delta = (this._ff_size_delta == 0.1) ? 0.2 : 0.1;
		if (!_isFF) {
			this._ff_size_delta = 0
		}
		if (!this.dontSetSizes) {
			//alert("0-setSizes,width="+this.entBox.style.width+",newWidth="+newWidth+",gridWidth="+gridWidth+",this.entBox.clientWidth="+this.entBox.clientWidth+",border_x="+border_x);
			
			//modify code by zzm 20160724
			this.entBox.style.width = Math.max(0, newWidth + (quirks ? _dhtmlx_global_quirks_static_value : 0) * outerBorder + this._ff_size_delta) + "px";
			this.entBox.style.height = newHeight + (quirks ? _dhtmlx_global_quirks_static_value : 0) * outerBorder + headerHeight + footerHeight + "px"
			
			//alert("setSizes,width="+this.entBox.style.width+",newWidth="+newWidth+",gridWidth="+gridWidth+",this.entBox.clientWidth="+this.entBox.clientWidth+",border_x="+border_x);
		}
		
		this.objBox.style.height = newHeight + ((quirks && !isVScroll) ? _dhtmlx_global_quirks_static_value : 0) * outerBorder + "px";
		this.hdrBox.style.height = headerHeight + "px";
		if (newHeight != gridHeight) {
			this.doOnScroll(0, !this._srnd)
		}
		var ext = this["setSizes_" + this.skin_name];
		if (ext) {
			ext.call(this)
		}
		this.setSortImgPos();
		if (headerHeight != this.hdr.clientHeight && this._ahgr) {
			this.setSizes()
		}
		this.callEvent("onSetSizes", [])
	};
	this.chngCellWidth = function() {
		if ((_isOpera) && (this.ftr)) {
			this.ftr.width = this.objBox.scrollWidth + "px"
		}
		var l = this._cCount;
		for (var i = 0; i < l; i++) {
			this.hdr.rows[0].cells[i].style.width = this.cellWidthPX[i] + "px";
			this.obj.rows[0].childNodes[i].style.width = this.cellWidthPX[i] + "px";
			if (this.ftr) {
				this.ftr.rows[0].cells[i].style.width = this.cellWidthPX[i] + "px"
			}
		}
	};
	this.setDelimiter = function(delim) {
		this.delim = delim
	};
	this.setInitWidthsP = function(wp) {
		this.cellWidthType = "%";
		this.initCellWidth = wp.split(this.delim.replace(/px/gi, ""));
		if (!arguments[1]) {
			this._setAutoResize()
		}
	};
	this._setAutoResize = function() {
		if (this._realfake) {
			return
		}
		var el = window;
		var self = this;
		dhtmlxEvent(window, "resize", function() {
			window.clearTimeout(self._resize_timer);
			if (self._setAutoResize) {
				self._resize_timer = window.setTimeout(function() {
					if (self.setSizes) {
						self.setSizes()
					}
					if (self._fake) {
						self._fake._correctSplit()
					}
				}, 100)
			}
		})
	};
	this.setInitWidths = function(wp) {
		this.cellWidthType = "px";
		this.initCellWidth = wp.split(this.delim);
		if (_isFF) {
			for (var i = 0; i < this.initCellWidth.length; i++) {
				if (this.initCellWidth[i] != "*") {
					this.initCellWidth[i] = parseInt(this.initCellWidth[i])
				}
			}
		}
	};
	this.enableMultiline = function(state) {
		this.multiLine = dhx4.s2b(state)
	};
	this.enableMultiselect = function(state) {
		this.selMultiRows = dhx4.s2b(state)
	};
	this.setImagePath = function(path) {
		path = path.replace(/imgs\/dhxgrid_[a-z]*\/$/, "imgs/");
		this._imgURL = path;
		this.imgURL = path + "dhxgrid_" + (this.skin_name || "dhx_skyblue").replace("dhx_", "") + "/";
		this.iconTree = this.imgURL + "tree/"
	};
	this.setImagesPath = this.setImagePath;
	this.setIconPath = function(path) {
		this.iconURL = path
	};
	this.setIconsPath = this.setIconPath;
	this.changeCursorState = function(ev) {
		var el = ev.target || ev.srcElement;
		if (el.tagName != "TD") {
			el = this.getFirstParentOfType(el, "TD")
		}
		if (!el) {
			return
		}
		if ((el.tagName == "TD") && (this._drsclmn) && (!this._drsclmn[el._cellIndex])) {
			return el.style.cursor = "default"
		}
		var check = (ev.layerX || 0) + (((!_isIE) && (ev.target.tagName == "DIV")) ? el.offsetLeft : 0);
		if ((el.offsetWidth - (ev.offsetX || (parseInt(this.getPosition(el, this.hdrBox)) - check) * -1)) < (_isOpera ? 20 : 10)) {
			el.style.cursor = "E-resize"
		} else {
			el.style.cursor = "default"
		}
		if (_isOpera) {
			this.hdrBox.scrollLeft = this.objBox.scrollLeft
		}
	};
	this.startColResize = function(ev) {
		if (this.resized) {
			this.stopColResize()
		}
		this.resized = null;
		var el = ev.target || ev.srcElement;
		if (el.tagName != "TD") {
			el = this.getFirstParentOfType(el, "TD")
		}
		var x = ev.clientX;
		var tabW = this.hdr.offsetWidth;
		var startW = parseInt(el.offsetWidth);
		if (el.tagName == "TD" && el.style.cursor != "default") {
			if ((this._drsclmn) && (!this._drsclmn[el._cellIndex])) {
				return
			}
			self._old_d_mm = document.body.onmousemove;
			self._old_d_mu = document.body.onmouseup;
			document.body.onmousemove = function(e) {
				if (self) {
					self.doColResize(e || window.event, el, startW, x, tabW)
				}
			};
			document.body.onmouseup = function() {
				if (self) {
					self.stopColResize()
				}
			}
		}
	};
	this.stopColResize = function() {
		document.body.onmousemove = self._old_d_mm || "";
		document.body.onmouseup = self._old_d_mu || "";
		this.setSizes();
		this.doOnScroll(0, 1);
		this.callEvent("onResizeEnd", [this])
	};
	this.doColResize = function(ev, el, startW, x, tabW) {
		el.style.cursor = "E-resize";
		this.resized = el;
		var fcolW = startW + (ev.clientX - x);
		var wtabW = tabW + (ev.clientX - x);
		if (!(this.callEvent("onResize", [el._cellIndex, fcolW, this]))) {
			return
		}
		if (_isIE) {
			this.objBox.scrollLeft = this.hdrBox.scrollLeft
		}
		var result = false;
		if (el.colSpan > 1) {
			var a_sizes = new Array();
			for (var i = 0; i < el.colSpan; i++) {
				a_sizes[i] = Math.round(fcolW * this.hdr.rows[0].childNodes[el._cellIndexS + i].offsetWidth / el.offsetWidth)
			}
			for (var i = 0; i < el.colSpan; i++) {
				result = this._setColumnSizeR(el._cellIndexS + i * 1, a_sizes[i])
			}
		} else {
			result = this._setColumnSizeR(el._cellIndex, fcolW)
		}
		this.doOnScroll(0, 1);
		this.setSizes();
		if (this._fake && this._awdth) {
			this._fake._correctSplit()
		}
		return result
	};
	this._setColumnSizeR = function(ind, fcolW) {
		if (fcolW > ((this._drsclmW && !this._notresize) ? (this._drsclmW[ind] || 10) : 10)) {
			this.obj.rows[0].childNodes[ind].style.width = fcolW + "px";
			this.hdr.rows[0].childNodes[ind].style.width = fcolW + "px";
			if (this.ftr) {
				this.ftr.rows[0].childNodes[ind].style.width = fcolW + "px"
			}
			if (this.cellWidthType == "px") {
				this.cellWidthPX[ind] = fcolW
			} else {
				var gridWidth = parseInt(this.entBox.offsetWidth);
				if (this.objBox.scrollHeight > this.objBox.offsetHeight) {
					gridWidth -= 17
				}
				var pcWidth = Math.round(fcolW / gridWidth * 100);
				this.cellWidthPC[ind] = pcWidth
			}
			if (this.sortImg.style.display != "none") {
				this.setSortImgPos()
			}
		} else {
			return false
		}
	};
	this.setSortImgState = function(state, ind, order, row) {
		order = (order || "asc").toLowerCase();
		if (!dhx4.s2b(state)) {
			this.sortImg.style.display = "none";
			this.fldSorted = this.r_fldSorted = null;
			return
		}
		if (order == "asc") {
			this.sortImg.className = "dhxgrid_sort_asc"
		} else {
			this.sortImg.className = "dhxgrid_sort_desc"
		}
		this.sortImg.style.display = "";
		this.fldSorted = this.hdr.rows[0].childNodes[ind];
		var r = this.hdr.rows[row || 1];
		if (!r) {
			return
		}
		for (var i = 0; i < r.childNodes.length; i++) {
			if (r.childNodes[i]._cellIndexS == ind) {
				this.r_fldSorted = r.childNodes[i];
				return this.setSortImgPos()
			}
		}
		return this.setSortImgState(state, ind, order, (row || 1) + 1)
	};
	this.setSortImgPos = function(ind, mode, hRowInd, el) {
		if (this._hrrar && this._hrrar[this.r_fldSorted ? this.r_fldSorted._cellIndex : ind]) {
			return
		}
		if (!el) {
			if (!ind) {
				var el = this.r_fldSorted
			} else {
				var el = this.hdr.rows[hRowInd || 0].cells[ind]
			}
		}
		if (el != null) {
			var pos = this.getPosition(el, this.hdrBox);
			var wdth = el.offsetWidth;
			this.sortImg.style.left = Number(pos[0] + wdth - 13) + "px";
			this.sortImg.defLeft = parseInt(this.sortImg.style.left);
			this.sortImg.style.top = Number(pos[1] + 5) + "px";
			if ((!this.useImagesInHeader) && (!mode)) {
				this.sortImg.style.display = "inline"
			}
			this.sortImg.style.left = this.sortImg.defLeft + "px"
		}
	};
	this.setActive = function(fl) {
		if (arguments.length == 0) {
			var fl = true
		}
		if (fl == true) {
			if (globalActiveDHTMLGridObject && (globalActiveDHTMLGridObject != this)) {
				globalActiveDHTMLGridObject.editStop();
				globalActiveDHTMLGridObject.callEvent("onBlur", [globalActiveDHTMLGridObject])
			}
			globalActiveDHTMLGridObject = this;
			this.isActive = true
		} else {
			this.isActive = false;
			this.callEvent("onBlur", [this])
		}
	};
	this._doClick = function(ev) {
		var selMethod = 0;
		var el = this.getFirstParentOfType(_isIE ? ev.srcElement : ev.target, "TD");
		if (!el || !el.parentNode || !el.parentNode.idd) {
			return
		}
		var fl = true;
		if (this.markedCells) {
			var markMethod = 0;
			if (ev.shiftKey || ev.metaKey) {
				markMethod = 1
			}
			if (ev.ctrlKey) {
				markMethod = 2
			}
			this.doMark(el, markMethod);
			return true
		}
		if (this.selMultiRows != false) {
			if (ev.shiftKey && this.row != null && this.selectedRows.length) {
				selMethod = 1
			}
			if (ev.ctrlKey || ev.metaKey) {
				selMethod = 2
			}
		}
		return this.doClick(el, fl, selMethod, false)
	};
	this._doContClick = function(ev) {
		var el = this.getFirstParentOfType(_isIE ? ev.srcElement : ev.target, "TD");
		if ((!el) || (typeof(el.parentNode.idd) == "undefined")) {
			this.callEvent("onEmptyClick", [ev]);
			return true
		}
		if (ev.button == 2 || (_isMacOS && ev.ctrlKey)) {
			if (!this.callEvent("onRightClick", [el.parentNode.idd, el._cellIndex, ev])) {
				var z = function(e) {
					(e || event).cancelBubble = true;
					return false
				};
				(ev.srcElement || ev.target).oncontextmenu = z;
				return z(ev)
			}
			if (this._ctmndx) {
				if (!(this.callEvent("onBeforeContextMenu", [el.parentNode.idd, el._cellIndex, this]))) {
					return true
				}
				if (_isIE) {
					ev.srcElement.oncontextmenu = function() {
						event.cancelBubble = true;
						return false
					}
				}
				if (this._ctmndx.showContextMenu) {
					var dEl0 = window.document.documentElement;
					var dEl1 = window.document.body;
					var corrector = new Array((dEl0.scrollLeft || dEl1.scrollLeft), (dEl0.scrollTop || dEl1.scrollTop));
					if (_isIE) {
						var x = ev.clientX + corrector[0];
						var y = ev.clientY + corrector[1]
					} else {
						var x = ev.pageX;
						var y = ev.pageY
					}
					this._ctmndx.showContextMenu(x - 1, y - 1);
					this.contextID = this._ctmndx.contextMenuZoneId = el.parentNode.idd + "_" + el._cellIndex;
					this._ctmndx._skip_hide = true
				} else {
					el.contextMenuId = el.parentNode.idd + "_" + el._cellIndex;
					el.contextMenu = this._ctmndx;
					el.a = this._ctmndx._contextStart;
					el.a(el, ev);
					el.a = null
				}
				ev.cancelBubble = true;
				return false
			}
		} else {
			if (this._ctmndx) {
				if (this._ctmndx.hideContextMenu) {
					this._ctmndx.hideContextMenu()
				} else {
					this._ctmndx._contextEnd()
				}
			}
		}
		return true
	};
	this.doClick = function(el, fl, selMethod, show) {
		if (!this.selMultiRows) {
			selMethod = 0
		}
		var psid = this.row ? this.row.idd : 0;
		this.setActive(true);
		if (!selMethod) {
			selMethod = 0
		}
		if (this.cell != null) {
			this.cell.className = this.cell.className.replace(/cellselected/g, "")
		}
		if (el.tagName == "TD") {
			if (this.checkEvent("onSelectStateChanged")) {
				var initial = this.getSelectedId()
			}
			var prow = this.row;
			if (selMethod == 1) {
				var elRowIndex = this.rowsCol._dhx_find(el.parentNode);
				var lcRowIndex = this.rowsCol._dhx_find(this.lastClicked);
				if (elRowIndex > lcRowIndex) {
					var strt = lcRowIndex;
					var end = elRowIndex
				} else {
					var strt = elRowIndex;
					var end = lcRowIndex
				}
				for (var i = 0; i < this.rowsCol.length; i++) {
					if ((i >= strt && i <= end)) {
						if (this.rowsCol[i] && (!this.rowsCol[i]._sRow)) {
							if (this.rowsCol[i].className.indexOf("rowselected") == -1 && (this.callEvent("onBeforeSelect", [this.rowsCol[i].idd, psid, el._cellIndex]))) {
								this.rowsCol[i].className += " rowselected";
								this.selectedRows[this.selectedRows.length] = this.rowsCol[i]
							}
						} else {
							this.clearSelection();
							return this.doClick(el, fl, 0, show)
						}
					}
				}
			} else {
				if (selMethod == 2) {
					if (el.parentNode.className.indexOf("rowselected") != -1) {
						el.parentNode.className = el.parentNode.className.replace(/rowselected/g, "");
						this.selectedRows._dhx_removeAt(this.selectedRows._dhx_find(el.parentNode));
						var skipRowSelection = true;
						show = false
					}
				}
			}
			this.editStop();
			if (typeof(el.parentNode.idd) == "undefined") {
				return true
			}
			if ((!skipRowSelection) && (!el.parentNode._sRow)) {
				if (this.callEvent("onBeforeSelect", [el.parentNode.idd, psid, el._cellIndex])) {
					if (this.getSelectedRowId() != el.parentNode.idd) {
						if (selMethod == 0) {
							this.clearSelection()
						}
						this.cell = el;
						if ((prow == el.parentNode) && (this._chRRS)) {
							fl = false
						}
						this.row = el.parentNode;
						this.row.className += " rowselected";
						if (this.selectedRows._dhx_find(this.row) == -1) {
							this.selectedRows[this.selectedRows.length] = this.row
						}
					} else {
						this.cell = el;
						this.row = el.parentNode
					}
				} else {
					fl = false
				}
			}
			if (this.cell && this.cell.parentNode.className.indexOf("rowselected") != -1) {
				this.cell.className = this.cell.className.replace(/cellselected/g, "") + " cellselected"
			}
			if (selMethod != 1) {
				if (!this.row) {
					return
				}
			}
			this.lastClicked = el.parentNode;
			var rid = this.row.idd;
			var cid = this.cell;
			if (fl && typeof(rid) != "undefined" && cid && !skipRowSelection) {
				self.onRowSelectTime = setTimeout(function() {
					if (self.callEvent) {
						self.callEvent("onRowSelect", [rid, cid._cellIndex])
					}
				}, 100)
			} else {
				this.callEvent("onRowSelectRSOnly", [rid])
			}
			if (this.checkEvent("onSelectStateChanged")) {
				var afinal = this.getSelectedId();
				if (initial != afinal) {
					this.callEvent("onSelectStateChanged", [afinal, initial])
				}
			}
			if (skipRowSelection) {
				return false
			}
		}
		this.isActive = true;
		if (show !== false && this.cell && this.cell.parentNode.idd) {
			this.moveToVisible(this.cell)
		}
	};
	this.selectAll = function() {
		this.clearSelection();
		var coll = this.rowsBuffer;
		if (this.pagingOn) {
			coll = this.rowsCol
		}
		for (var i = 0; i < coll.length; i++) {
			this.render_row(i).className += " rowselected"
		}
		this.selectedRows = dhtmlxArray([].concat(coll));
		if (this.selectedRows.length) {
			this.row = this.selectedRows[0];
			this.cell = this.row.cells[0]
		}
		if ((this._fake) && (!this._realfake)) {
			this._fake.selectAll()
		}
	};
	this.selectCell = function(r, cInd, fl, preserve, edit, show) {
		if (!fl) {
			fl = false
		}
		if (typeof(r) != "object") {
			r = this.render_row(r)
		}
		if (!r || r == -1) {
			return null
		}
		if (r._childIndexes) {
			var c = r.childNodes[r._childIndexes[cInd]]
		} else {
			var c = r.childNodes[cInd]
		}
		if (!c) {
			c = r.childNodes[0]
		}
		if (!this.markedCells) {
			if (preserve) {
				this.doClick(c, fl, 3, show)
			} else {
				this.doClick(c, fl, 0, show)
			}
		} else {
			this.doMark(c, preserve ? 2 : 0)
		}
		if (edit) {
			this.editCell()
		}
	};
	this.moveToVisible = function(cell_obj, onlyVScroll) {
		if (this.pagingOn) {
			var newPage = Math.floor(this.getRowIndex(cell_obj.parentNode.idd) / this.rowsBufferOutSize) + 1;
			if (newPage != this.currentPage) {
				this.changePage(newPage)
			}
		}
		try {
			if (cell_obj.offsetHeight) {
				var distance = cell_obj.offsetLeft + cell_obj.offsetWidth + 20;
				var scrollLeft = 0;
				if (distance > (this.objBox.offsetWidth + this.objBox.scrollLeft)) {
					if (cell_obj.offsetLeft > this.objBox.scrollLeft) {
						scrollLeft = cell_obj.offsetLeft - (this.objBox.offsetWidth - cell_obj.offsetWidth) + 5
					}
				} else {
					if (cell_obj.offsetLeft < this.objBox.scrollLeft) {
						distance -= cell_obj.offsetWidth * 2 / 3;
						if (distance < this.objBox.scrollLeft) {
							scrollLeft = cell_obj.offsetLeft - 5
						}
					}
				}
				if ((scrollLeft) && (!onlyVScroll)) {
					this.objBox.scrollLeft = scrollLeft
				}
			}
			if (!cell_obj.offsetHeight) {
				var mask = this._realfake ? this._fake.rowsAr[cell_obj.parentNode.idd] : cell_obj.parentNode;
				distance = this.rowsBuffer._dhx_find(mask) * this._srdh
			} else {
				distance = cell_obj.offsetTop
			}
			var distancemax = distance + cell_obj.offsetHeight + 38;
			if (distancemax > (this.objBox.offsetHeight + this.objBox.scrollTop)) {
				var scrollTop = distance
			} else {
				if (distance < this.objBox.scrollTop) {
					var scrollTop = distance - 5
				}
			}
			if (scrollTop) {
				this.objBox.scrollTop = scrollTop
			}
		} catch (er) {}
	};
	this.editCell = function() {
		if (this.editor && this.cell == this.editor.cell) {
			return
		}
		this.editStop();
		if ((this.isEditable != true) || (!this.cell)) {
			return false
		}
		var c = this.cell;
		if (c.parentNode._locked) {
			return false
		}
		this.editor = this.cells4(c);
		if (this.editor != null) {
			if (this.editor.isDisabled()) {
				this.editor = null;
				return false
			}
			if (this.callEvent("onEditCell", [0, this.row.idd, this.cell._cellIndex]) != false && this.editor.edit) {
				this._Opera_stop = (new Date).valueOf();
				c.className += " editable";
				this.editor.edit();
				this.callEvent("onEditCell", [1, this.row.idd, this.cell._cellIndex])
			} else {
				this.editor = null
			}
		}
	};
	this.editStop = function(mode) {
		if (_isOpera) {
			if (this._Opera_stop) {
				if ((this._Opera_stop * 1 + 50) > (new Date).valueOf()) {
					return
				}
				this._Opera_stop = null
			}
		}
		if (this.editor && this.editor != null) {
			this.editor.cell.className = this.editor.cell.className.replace("editable", "");
			if (mode) {
				var t = this.editor.val;
				this.editor.detach();
				this.editor.setValue(t);
				this.editor = null;
				this.callEvent("onEditCancel", [this.row.idd, this.cell._cellIndex, t]);
				return
			}
			if (this.editor.detach()) {
				this.cell.wasChanged = true
			}
			var g = this.editor;
			if (g == null) {
				return
			}
			this.editor = null;
			var z = this.callEvent("onEditCell", [2, this.row.idd, this.cell._cellIndex, g.getValue(), g.val]);
			if ((typeof(z) == "string") || (typeof(z) == "number")) {
				g[g.setImage ? "setLabel" : "setValue"](z)
			} else {
				if (!z) {
					g[g.setImage ? "setLabel" : "setValue"](g.val)
				}
			}
			if (this._ahgr && this.multiLine) {
				this.setSizes()
			}
		}
	};
	this._nextRowCell = function(row, dir, pos) {
		row = this._nextRow((this._groups ? this.rowsCol : this.rowsBuffer)._dhx_find(row), dir);
		if (!row) {
			return null
		}
		return row.childNodes[row._childIndexes ? row._childIndexes[pos] : pos]
	};
	this._getNextCell = function(acell, dir, i) {
		acell = acell || this.cell;
		var arow = acell.parentNode;
		if (this._tabOrder) {
			i = this._tabOrder[acell._cellIndex];
			if (typeof i != "undefined") {
				if (i < 0) {
					acell = this._nextRowCell(arow, dir, Math.abs(i) - 1)
				} else {
					acell = arow.childNodes[i]
				}
			}
		} else {
			var i = acell._cellIndex + dir;
			if (i >= 0 && i < this._cCount) {
				if (arow._childIndexes) {
					i = arow._childIndexes[acell._cellIndex] + dir
				}
				acell = arow.childNodes[i]
			} else {
				acell = this._nextRowCell(arow, dir, (dir == 1 ? 0 : (this._cCount - 1)))
			}
		}
		if (!acell) {
			if ((dir == 1) && this.tabEnd) {
				this.tabEnd.focus();
				this.tabEnd.focus();
				this.setActive(false)
			}
			if ((dir == -1) && this.tabStart) {
				this.tabStart.focus();
				this.tabStart.focus();
				this.setActive(false)
			}
			return null
		}
		if (acell.style.display != "none" && (!this.smartTabOrder || !this.cells(acell.parentNode.idd, acell._cellIndex).isDisabled())) {
			return acell
		}
		return this._getNextCell(acell, dir)
	};
	this._nextRow = function(ind, dir) {
		var r = this.render_row(ind + dir);
		if (!r || r == -1) {
			return null
		}
		if (r && r.style.display == "none") {
			return this._nextRow(ind + dir, dir)
		}
		return r
	};
	this.scrollPage = function(dir) {
		if (!this.rowsBuffer.length) {
			return
		}
		var master = this._realfake ? this._fake : this;
		var new_ind = Math.floor((master._r_select || this.getRowIndex(this.row.idd) || 0) + (dir) * this.objBox.offsetHeight / (this._srdh || 20));
		if (new_ind < 0) {
			new_ind = 0
		}
		if (new_ind >= this.rowsBuffer.length) {
			new_ind = this.rowsBuffer.length - 1
		}
		if (this._srnd && !this.rowsBuffer[new_ind]) {
			this.objBox.scrollTop += Math.floor((dir) * this.objBox.offsetHeight / (this._srdh || 20)) * (this._srdh || 20);
			if (this._fake) {
				this._fake.objBox.scrollTop = this.objBox.scrollTop
			}
			master._r_select = new_ind
		} else {
			this.selectCell(new_ind, this.cell._cellIndex, true, false, false, (this.multiLine || this._srnd));
			if (!this.multiLine && !this._srnd && !this._realfake) {
				this.objBox.scrollTop = this.getRowById(this.getRowId(new_ind)).offsetTop;
				if (this._fake) {
					this._fake.objBox.scrollTop = this.objBox.scrollTop
				}
			}
			master._r_select = null
		}
	};
	this.doKey = function(ev) {
		if (!ev) {
			return true
		}
		if ((ev.target || ev.srcElement).value !== window.undefined) {
			var zx = (ev.target || ev.srcElement);
			if (zx.className != "dhxcombo_input" && ((!zx.parentNode) || (zx.parentNode.className.indexOf("editable") == -1))) {
				return true
			}
		}
		if ((globalActiveDHTMLGridObject) && (this != globalActiveDHTMLGridObject)) {
			return globalActiveDHTMLGridObject.doKey(ev)
		}
		if (this.isActive == false) {
			return true
		}
		if (this._htkebl) {
			return true
		}
		if (!this.callEvent("onKeyPress", [ev.keyCode, ev.ctrlKey, ev.shiftKey, ev])) {
			return false
		}
		var code = "k" + ev.keyCode + "_" + (ev.ctrlKey ? 1 : 0) + "_" + (ev.shiftKey ? 1 : 0);
		if (this.cell) {
			if (this._key_events[code]) {
				if (false === this._key_events[code].call(this)) {
					return true
				}
				if (ev.preventDefault) {
					ev.preventDefault()
				}
				ev.cancelBubble = true;
				return false
			}
			if (this._key_events.k_other) {
				this._key_events.k_other.call(this, ev)
			}
		}
		return true
	};
	this.selectRow = function(r, fl, preserve, show) {
		if (typeof(r) != "object") {
			r = this.render_row(r)
		}
		this.selectCell(r, 0, fl, preserve, false, show)
	};
	this.wasDblClicked = function(ev) {
		var el = this.getFirstParentOfType(_isIE ? ev.srcElement : ev.target, "TD");
		if (el) {
			var rowId = el.parentNode.idd;
			return this.callEvent("onRowDblClicked", [rowId, el._cellIndex, ev])
		}
	};
	this._onHeaderClick = function(e, el) {
		var that = this.grid;
		el = el || that.getFirstParentOfType(_isIE ? event.srcElement : e.target, "TD");
		if (this.grid.resized == null) {
			if (!(this.grid.callEvent("onHeaderClick", [el._cellIndexS, (e || window.event)]))) {
				return false
			}
			that.sortField(el._cellIndexS, false, el)
		}
		this.grid.resized = null
	};
	this.deleteSelectedRows = function() {
		var num = this.selectedRows.length;
		if (num == 0) {
			return
		}
		var tmpAr = this.selectedRows;
		this.selectedRows = dhtmlxArray();
		for (var i = num - 1; i >= 0; i--) {
			var node = tmpAr[i];
			if (!this.deleteRow(node.idd, node)) {
				this.selectedRows[this.selectedRows.length] = node
			} else {
				if (node == this.row) {
					var ind = i
				}
			}
		}
		if (ind) {
			try {
				if (ind + 1 > this.rowsCol.length) {
					ind--
				}
				this.selectCell(ind, 0, true)
			} catch (er) {
				this.row = null;
				this.cell = null
			}
		}
	};
	this.getSelectedRowId = function() {
		var selAr = new Array(0);
		var uni = {};
		for (var i = 0; i < this.selectedRows.length; i++) {
			var id = this.selectedRows[i].idd;
			if (uni[id]) {
				continue
			}
			selAr[selAr.length] = id;
			uni[id] = true
		}
		if (selAr.length == 0) {
			return null
		} else {
			return selAr.join(this.delim)
		}
	};
	this.getSelectedCellIndex = function() {
		if (this.cell != null) {
			return this.cell._cellIndex
		} else {
			return -1
		}
	};
	this.getColWidth = function(ind) {
		return parseInt(this.cellWidthPX[ind])
	};
	this.setColWidth = function(ind, value) {
		if (value == "*") {
			this.initCellWidth[ind] = "*"
		} else {
			if (this._hrrar[ind]) {
				return
			}
			if (this.cellWidthType == "px") {
				this.cellWidthPX[ind] = parseInt(value)
			} else {
				this.cellWidthPC[ind] = parseInt(value)
			}
		}
		this.setSizes()
	};
	this.getRowIndex = function(row_id) {
		for (var i = 0; i < this.rowsBuffer.length; i++) {
			if (this.rowsBuffer[i] && this.rowsBuffer[i].idd == row_id) {
				return i
			}
		}
		return -1
	};
	this.getRowId = function(ind) {
		return this.rowsBuffer[ind] ? this.rowsBuffer[ind].idd : this.undefined
	};
	this.setRowId = function(ind, row_id) {
		this.changeRowId(this.getRowId(ind), row_id)
	};
	this.changeRowId = function(oldRowId, newRowId) {
		if (oldRowId == newRowId) {
			return
		}
		var row = this.rowsAr[oldRowId];
		row.idd = newRowId;
		if (this.UserData[oldRowId]) {
			this.UserData[newRowId] = this.UserData[oldRowId];
			this.UserData[oldRowId] = null
		}
		if (this._h2 && this._h2.get[oldRowId]) {
			this._h2.get[newRowId] = this._h2.get[oldRowId];
			this._h2.get[newRowId].id = newRowId;
			delete this._h2.get[oldRowId]
		}
		this.rowsAr[oldRowId] = null;
		this.rowsAr[newRowId] = row;
		for (var i = 0; i < row.childNodes.length; i++) {
			if (row.childNodes[i]._code) {
				row.childNodes[i]._code = this._compileSCL(row.childNodes[i]._val, row.childNodes[i])
			}
		}
		if (this._mat_links && this._mat_links[oldRowId]) {
			var a = this._mat_links[oldRowId];
			delete this._mat_links[oldRowId];
			for (var c in a) {
				for (var i = 0; i < a[c].length; i++) {
					this._compileSCL(a[c][i].original, a[c][i])
				}
			}
		}
		this.callEvent("onRowIdChange", [oldRowId, newRowId])
	};
	this.setColumnIds = function(ids) {
		this.columnIds = ids.split(this.delim)
	};
	this.setColumnId = function(ind, id) {
		this.columnIds[ind] = id
	};
	this.getColIndexById = function(id) {
		for (var i = 0; i < this.columnIds.length; i++) {
			if (this.columnIds[i] == id) {
				return i
			}
		}
	};
	this.getColumnId = function(cin) {
		return this.columnIds[cin]
	};
	this.getColumnLabel = function(cin, ind, hdr) {
		var z = (hdr || this.hdr).rows[(ind || 0) + 1];
		for (var i = 0; i < z.cells.length; i++) {
			if (z.cells[i]._cellIndexS == cin) {
				return (_isIE ? z.cells[i].innerText : z.cells[i].textContent)
			}
		}
		return ""
	};
	this.getColLabel = this.getColumnLabel;
	this.getFooterLabel = function(cin, ind) {
		return this.getColumnLabel(cin, ind, this.ftr)
	};
	this.setRowTextBold = function(row_id) {
		var r = this.getRowById(row_id);
		if (r) {
			r.style.fontWeight = "bold"
		}
	};
	this.setRowTextStyle = function(row_id, styleString) {
		var r = this.getRowById(row_id);
		if (!r) {
			return
		}
		for (var i = 0; i < r.childNodes.length; i++) {
			var pfix = r.childNodes[i]._attrs.style || "";
			if ((this._hrrar) && (this._hrrar[i])) {
				pfix = "display:none;"
			}
			if (_isIE) {
				r.childNodes[i].style.cssText = pfix + "width:" + r.childNodes[i].style.width + ";" + styleString
			} else {
				r.childNodes[i].style.cssText = pfix + "width:" + r.childNodes[i].style.width + ";" + styleString
			}
		}
	};
	this.setRowColor = function(row_id, color) {
		var r = this.getRowById(row_id);
		for (var i = 0; i < r.childNodes.length; i++) {
			r.childNodes[i].bgColor = color
		}
	};
	this.setCellTextStyle = function(row_id, ind, styleString) {
		var r = this.getRowById(row_id);
		if (!r) {
			return
		}
		var cell = r.childNodes[r._childIndexes ? r._childIndexes[ind] : ind];
		if (!cell) {
			return
		}
		var pfix = "";
		if ((this._hrrar) && (this._hrrar[ind])) {
			pfix = "display:none;"
		}
		if (_isIE) {
			cell.style.cssText = pfix + "width:" + cell.style.width + ";" + styleString
		} else {
			cell.style.cssText = pfix + "width:" + cell.style.width + ";" + styleString
		}
	};
	this.setRowTextNormal = function(row_id) {
		var r = this.getRowById(row_id);
		if (r) {
			r.style.fontWeight = "normal"
		}
	};
	this.doesRowExist = function(row_id) {
		if (this.getRowById(row_id) != null) {
			return true
		} else {
			return false
		}
	};
	this.getColumnsNum = function() {
		return this._cCount
	};
	this.moveRowUp = function(row_id) {
		var r = this.getRowById(row_id);
		if (this.isTreeGrid()) {
			return this.moveRowUDTG(row_id, -1)
		}
		var rInd = this.rowsCol._dhx_find(r);
		if ((r.previousSibling) && (rInd != 0)) {
			r.parentNode.insertBefore(r, r.previousSibling);
			this.rowsCol._dhx_swapItems(rInd, rInd - 1);
			this.setSizes();
			var bInd = this.rowsBuffer._dhx_find(r);
			this.rowsBuffer._dhx_swapItems(bInd, bInd - 1);
			if (this._cssEven) {
				this._fixAlterCss(rInd - 1)
			}
		}
	};
	this.moveRowDown = function(row_id) {
		var r = this.getRowById(row_id);
		if (this.isTreeGrid()) {
			return this.moveRowUDTG(row_id, 1)
		}
		var rInd = this.rowsCol._dhx_find(r);
		if (r.nextSibling) {
			this.rowsCol._dhx_swapItems(rInd, rInd + 1);
			if (r.nextSibling.nextSibling) {
				r.parentNode.insertBefore(r, r.nextSibling.nextSibling)
			} else {
				r.parentNode.appendChild(r)
			}
			this.setSizes();
			var bInd = this.rowsBuffer._dhx_find(r);
			this.rowsBuffer._dhx_swapItems(bInd, bInd + 1);
			if (this._cssEven) {
				this._fixAlterCss(rInd)
			}
		}
	};
	this.getCombo = function(col_ind) {
		if (!this.combos[col_ind]) {
			this.combos[col_ind] = new dhtmlXGridComboObject()
		}
		return this.combos[col_ind]
	};
	this.setUserData = function(row_id, name, value) {
		if (!row_id) {
			row_id = "gridglobaluserdata"
		}
		if (!this.UserData[row_id]) {
			this.UserData[row_id] = new Hashtable()
		}
		this.UserData[row_id].put(name, value)
	};
	this.getUserData = function(row_id, name) {
		if (!row_id) {
			row_id = "gridglobaluserdata"
		}
		this.getRowById(row_id);
		var z = this.UserData[row_id];
		return (z ? z.get(name) : "")
	};
	this.setEditable = function(fl) {
		this.isEditable = dhx4.s2b(fl)
	};
	this.selectRowById = function(row_id, multiFL, show, call) {
		if (!call) {
			call = false
		}
		this.selectCell(this.getRowById(row_id), 0, call, multiFL, false, show)
	};
	this.clearSelection = function() {
		this.editStop();
		for (var i = 0; i < this.selectedRows.length; i++) {
			var r = this.rowsAr[this.selectedRows[i].idd];
			if (r) {
				r.className = r.className.replace(/rowselected/g, "")
			}
		}
		this.selectedRows = dhtmlxArray();
		this.row = null;
		if (this.cell != null) {
			this.cell.className = this.cell.className.replace(/cellselected/g, "");
			this.cell = null
		}
		this.callEvent("onSelectionCleared", [])
	};
	this.copyRowContent = function(from_row_id, to_row_id) {
		var frRow = this.getRowById(from_row_id);
		if (!this.isTreeGrid()) {
			for (var i = 0; i < frRow.cells.length; i++) {
				this.cells(to_row_id, i).setValue(this.cells(from_row_id, i).getValue())
			}
		} else {
			this._copyTreeGridRowContent(frRow, from_row_id, to_row_id)
		}
		if (!_isIE) {
			this.getRowById(from_row_id).cells[0].height = frRow.cells[0].offsetHeight
		}
	};
	this.setFooterLabel = function(c, label, ind) {
		return this.setColumnLabel(c, label, ind, this.ftr)
	};
	this.setColumnLabel = function(c, label, ind, hdr) {
		var z = (hdr || this.hdr).rows[ind || 1];
		var col = (z._childIndexes ? z._childIndexes[c] : c);
		if (!z.cells[col]) {
			return
		}
		if (!this.useImagesInHeader) {
			var hdrHTML = "<div class='hdrcell'>";
			if (label.indexOf("img:[") != -1) {
				var imUrl = label.replace(/.*\[([^>]+)\].*/, "$1");
				label = label.substr(label.indexOf("]") + 1, label.length);
				hdrHTML += "<img width='18px' height='18px' align='absmiddle' src='" + imUrl + "' hspace='2'>"
			}
			hdrHTML += label;
			hdrHTML += "</div>";
			z.cells[col].innerHTML = hdrHTML;
			if (this._hstyles[col]) {
				z.cells[col].style.cssText = this._hstyles[col]
			}
		} else {
			z.cells[col].style.textAlign = "left";
			z.cells[col].innerHTML = "<img src='" + label + "'>";
			var a = new Image();
			a.src = "" + label.replace(/(\.[a-z]+)/, ".des$1");
			this.preloadImagesAr[this.preloadImagesAr.length] = a;
			var b = new Image();
			b.src = "" + label.replace(/(\.[a-z]+)/, ".asc$1");
			this.preloadImagesAr[this.preloadImagesAr.length] = b
		}
		if ((label || "").indexOf("#") != -1) {
			var t = label.match(/(^|{)#([^}]+)(}|$)/);
			if (t) {
				var tn = "_in_header_" + t[2];
				if (this[tn]) {
					this[tn]((this.forceDivInHeader ? z.cells[col].firstChild : z.cells[col]), col, label.split(t[0]))
				}
			}
		}
	};
	this.setColLabel = function(a, b, ind, c) {
		return this.setColumnLabel(a, b, (ind || 0) + 1, c)
	};
	this.clearAll = function(header) {
		if (!this.obj.rows[0]) {
			return
		}
		if (this._h2) {
			this._h2 = this._createHierarchy();
			if (this._fake) {
				if (this._realfake) {
					this._h2 = this._fake._h2
				} else {
					this._fake._h2 = this._h2
				}
			}
		}
		this.limit = this._limitC = 0;
		this.editStop(true);
		if (this._dLoadTimer) {
			window.clearTimeout(this._dLoadTimer)
		}
		if (this._dload) {
			this.objBox.scrollTop = 0;
			this.limit = this._limitC || 0;
			this._initDrF = true
		}
		var len = this.rowsCol.length;
		len = this.obj.rows.length;
		for (var i = len - 1; i > 0; i--) {
			var t_r = this.obj.rows[i];
			t_r.parentNode.removeChild(t_r)
		}
		if (header) {
			this._master_row = null;
			this.obj.rows[0].parentNode.removeChild(this.obj.rows[0]);
			for (var i = this.hdr.rows.length - 1; i >= 0; i--) {
				var t_r = this.hdr.rows[i];
				t_r.parentNode.removeChild(t_r)
			}
			if (this.ftr) {
				this.ftr.parentNode.removeChild(this.ftr);
				this.ftr = null
			}
			this._aHead = this.ftr = this.cellWidth = this._aFoot = null;
			this.cellType = dhtmlxArray();
			this._hrrar = [];
			this.columnIds = [];
			this.combos = [];
			this._strangeParams = [];
			this.defVal = [];
			this._ivizcol = null
		}
		this.row = null;
		this.cell = null;
		this.rowsCol = dhtmlxArray();
		this.rowsAr = {};
		this._RaSeCol = [];
		this.rowsBuffer = dhtmlxArray();
		this.UserData = [];
		this.selectedRows = dhtmlxArray();
		if (this.pagingOn || this._srnd) {
			this.xmlFileUrl = ""
		}
		if (this.pagingOn) {
			this.changePage(1)
		}
		if (this._contextCallTimer) {
			window.clearTimeout(this._contextCallTimer)
		}
		if (this._sst) {
			this.enableStableSorting(true)
		}
		this._fillers = this.undefined;
		this.setSortImgState(false);
		this.setSizes();
		this.callEvent("onClearAll", [])
	};
	this.sortField = function(ind, repeatFl, r_el) {
		if (this.getRowsNum() == 0) {
			return false
		}
		var el = this.hdr.rows[0].cells[ind];
		if (!el) {
			return
		}
		if (el.tagName == "TH" && (this.fldSort.length - 1) >= el._cellIndex && this.fldSort[el._cellIndex] != "na") {
			var data = this.getSortingState();
			var sortType = (data[0] == ind && data[1] == "asc") ? "des" : "asc";
			if (!this.callEvent("onBeforeSorting", [ind, this.fldSort[ind], sortType])) {
				return
			}
			this.sortImg.className = "dhxgrid_sort_" + (sortType == "asc" ? "asc" : "desc");
			if (this.useImagesInHeader) {
				var cel = this.hdr.rows[1].cells[el._cellIndex].firstChild;
				if (this.fldSorted != null) {
					var celT = this.hdr.rows[1].cells[this.fldSorted._cellIndex].firstChild;
					celT.src = celT.src.replace(/(\.asc\.)|(\.des\.)/, ".")
				}
				cel.src = cel.src.replace(/(\.[a-z]+)$/, "." + sortType + "$1")
			}
			this.sortRows(el._cellIndex, this.fldSort[el._cellIndex], sortType);
			this.fldSorted = el;
			this.r_fldSorted = r_el;
			var c = this.hdr.rows[1];
			var c = r_el.parentNode;
			var real_el = c._childIndexes ? c._childIndexes[el._cellIndex] : el._cellIndex;
			this.setSortImgPos(false, false, false, r_el)
		}
	};
	this.setCustomSorting = function(func, col) {
		if (!this._customSorts) {
			this._customSorts = new Array()
		}
		this._customSorts[col] = (typeof(func) == "string") ? eval(func) : func;
		this.fldSort[col] = "cus"
	};
	this.enableHeaderImages = function(fl) {
		this.useImagesInHeader = fl
	};
	this.setHeader = function(hdrStr, splitSign, styles) {
		if (typeof(hdrStr) != "object") {
			var arLab = this._eSplit(hdrStr)
		} else {
			arLab = [].concat(hdrStr)
		}
		var arWdth = new Array(0);
		var arTyp = new dhtmlxArray(0);
		var arAlg = new Array(0);
		var arVAlg = new Array(0);
		var arSrt = new Array(0);
		for (var i = 0; i < arLab.length; i++) {
			arWdth[arWdth.length] = Math.round(100 / arLab.length);
			arTyp[arTyp.length] = "ed";
			arAlg[arAlg.length] = "left";
			arVAlg[arVAlg.length] = "middle";
			arSrt[arSrt.length] = "na"
		}
		this.splitSign = splitSign || "#cspan";
		this.hdrLabels = arLab;
		this.cellWidth = arWdth;
		if (!this.initCellWidth.length) {
			this.setInitWidthsP(arWdth.join(this.delim), true)
		}
		this.cellType = arTyp;
		this.cellAlign = arAlg;
		this.cellVAlign = arVAlg;
		this.fldSort = arSrt;
		this._hstyles = styles || []
	};
	this._eSplit = function(str) {
		if (![].push) {
			return str.split(this.delim)
		}
		var a = "r" + (new Date()).valueOf();
		var z = this.delim.replace(/([\|\+\*\^])/g, "\\$1");
		return (str || "").replace(RegExp(z, "g"), a).replace(RegExp("\\\\" + a, "g"), this.delim).split(a)
	};
	this.getColType = function(cInd) {
		return this.cellType[cInd]
	};
	this.getColTypeById = function(cID) {
		return this.cellType[this.getColIndexById(cID)]
	};
	this.setColTypes = function(typeStr) {
		this.cellType = dhtmlxArray(typeStr.split(this.delim));
		this._strangeParams = new Array();
		for (var i = 0; i < this.cellType.length; i++) {
			if ((this.cellType[i].indexOf("[") != -1)) {
				var z = this.cellType[i].split(/[\[\]]+/g);
				this.cellType[i] = z[0];
				this.defVal[i] = z[1];
				if (z[1].indexOf("=") == 0) {
					this.cellType[i] = "math";
					this._strangeParams[i] = z[0]
				}
			}
			if (!window["eXcell_" + this.cellType[i]]) {
				dhx4.callEvent("onConfigurationError", ["Incorrect cell type: " + this.cellType[i], this, this.cellType[i]])
			}
		}
	};
	this.setColSorting = function(sortStr) {
		this.fldSort = sortStr.split(this.delim);
		var check = {
			str: 1,
			"int": 1,
			date: 1
		};
		for (var i = 0; i < this.fldSort.length; i++) {
			if ((!check[this.fldSort[i]]) && (typeof(window[this.fldSort[i]]) == "function")) {
				if (!this._customSorts) {
					this._customSorts = new Array()
				}
				this._customSorts[i] = window[this.fldSort[i]];
				this.fldSort[i] = "cus"
			}
		}
	};
	this.setColAlign = function(alStr) {
		this.cellAlign = alStr.split(this.delim);
		for (var i = 0; i < this.cellAlign.length; i++) {
			this.cellAlign[i] = this.cellAlign[i]._dhx_trim()
		}
	};
	this.setColVAlign = function(valStr) {
		this.cellVAlign = valStr.split(this.delim)
	};
	this.setNoHeader = function(fl) {
		this.noHeader = dhx4.s2b(fl)
	};
	this.showRow = function(rowID) {
		this.getRowById(rowID);
		if (this._h2) {
			this.openItem(this._h2.get[rowID].parent.id)
		}
		var c = this.getRowById(rowID).childNodes[0];
		while (c && c.style.display == "none") {
			c = c.nextSibling
		}
		if (c) {
			this.moveToVisible(c, true)
		}
	};
	this.setStyle = function(ss_header, ss_grid, ss_selCell, ss_selRow) {
		this.ssModifier = [ss_header, ss_grid, ss_selCell, ss_selCell, ss_selRow];
		var prefs = ["#" + this.entBox.id + " table.hdr td", "#" + this.entBox.id + " table.obj td", "#" + this.entBox.id + " table.obj tr.rowselected td.cellselected", "#" + this.entBox.id + " table.obj td.cellselected", "#" + this.entBox.id + " table.obj tr.rowselected td"];
		var index = 0;
		while (!_isIE) {
			try {
				var temp = document.styleSheets[index].cssRules.length
			} catch (e) {
				index++;
				continue
			}
			break
		}
		for (var i = 0; i < prefs.length; i++) {
			if (this.ssModifier[i]) {
				if (_isIE) {
					document.styleSheets[0].addRule(prefs[i], this.ssModifier[i])
				} else {
					document.styleSheets[index].insertRule(prefs[i] + (" { " + this.ssModifier[i] + " }"), document.styleSheets[index].cssRules.length)
				}
			}
		}
	};
	this.setColumnColor = function(clr) {
		this.columnColor = clr.split(this.delim)
	};
	this.enableAlterCss = function(cssE, cssU, perLevel, levelUnique) {
		if (cssE || cssU) {
			this.attachEvent("onGridReconstructed", function() {
				this._fixAlterCss();
				if (this._fake) {
					this._fake._fixAlterCss()
				}
			})
		}
		this._cssSP = perLevel;
		this._cssSU = levelUnique;
		this._cssEven = cssE;
		this._cssUnEven = cssU
	};
	this._fixAlterCss = function(ind) {
		if (this._h2 && (this._cssSP || this._cssSU)) {
			return this._fixAlterCssTGR(ind)
		}
		if (!this._cssEven && !this._cssUnEven) {
			return
		}
		ind = ind || 0;
		var j = ind;
		for (var i = ind; i < this.rowsCol.length; i++) {
			if (!this.rowsCol[i]) {
				continue
			}
			if (this.rowsCol[i].style.display != "none") {
				if (this.rowsCol[i]._cntr) {
					j = 1;
					continue
				}
				if (this.rowsCol[i].className.indexOf("rowselected") != -1) {
					if (j % 2 == 1) {
						this.rowsCol[i].className = this._cssUnEven + " rowselected " + (this.rowsCol[i]._css || "")
					} else {
						this.rowsCol[i].className = this._cssEven + " rowselected " + (this.rowsCol[i]._css || "")
					}
				} else {
					if (j % 2 == 1) {
						this.rowsCol[i].className = this._cssUnEven + " " + (this.rowsCol[i]._css || "")
					} else {
						this.rowsCol[i].className = this._cssEven + " " + (this.rowsCol[i]._css || "")
					}
				}
				j++
			}
		}
	};
	this.clearChangedState = function() {
		for (var i = 0; i < this.rowsCol.length; i++) {
			var row = this.rowsCol[i];
			if (row && row.childNodes) {
				var cols = row.childNodes.length;
				for (var j = 0; j < cols; j++) {
					row.childNodes[j].wasChanged = false
				}
			}
		}
	};
	this.getChangedRows = function(and_added) {
		var res = new Array();
		this.forEachRow(function(id) {
			var row = this.rowsAr[id];
			if (row.tagName != "TR") {
				return
			}
			var cols = row.childNodes.length;
			if (and_added && row._added) {
				res[res.length] = row.idd
			} else {
				for (var j = 0; j < cols; j++) {
					if (row.childNodes[j].wasChanged) {
						res[res.length] = row.idd;
						break
					}
				}
			}
		});
		return res.join(this.delim)
	};
	this._sUDa = false;
	this._sAll = false;
	this.setSerializationLevel = function(userData, fullXML, config, changedAttr, onlyChanged, asCDATA) {
		this._sUDa = userData;
		this._sAll = fullXML;
		this._sConfig = config;
		this._chAttr = changedAttr;
		this._onlChAttr = onlyChanged;
		this._asCDATA = asCDATA
	};
	this.setSerializableColumns = function(list) {
		if (!list) {
			this._srClmn = null;
			return
		}
		this._srClmn = (list || "").split(",");
		for (var i = 0; i < this._srClmn.length; i++) {
			this._srClmn[i] = dhx4.s2b(this._srClmn[i])
		}
	};
	this._serialise = function(rCol, inner, closed) {
		this.editStop();
		var out = [];
		var close = "</" + this.xml.s_row + ">";
		if (this.isTreeGrid()) {
			this._h2.forEachChildF(0, function(el) {
				var temp = this._serializeRow(this.render_row_tree(-1, el.id));
				out.push(temp);
				if (temp) {
					return true
				} else {
					return false
				}
			}, this, function() {
				out.push(close)
			})
		} else {
			for (var i = 0; i < this.rowsBuffer.length; i++) {
				if (this.rowsBuffer[i]) {
					if (this._chAttr && this.rowsBuffer[i]._locator) {
						continue
					}
					var temp = this._serializeRow(this.render_row(i));
					out.push(temp);
					if (temp) {
						out.push(close)
					}
				}
			}
		}
		return [out.join("")]
	};
	this._serializeRow = function(r, i) {
		var out = [];
		var ra = this.xml.row_attrs;
		var ca = this.xml.cell_attrs;
		out.push("<" + this.xml.s_row);
		out.push(" id='" + r.idd + "'");
		if ((this._sAll) && this.selectedRows._dhx_find(r) != -1) {
			out.push(" selected='1'")
		}
		if (this._h2 && this._h2.get[r.idd].state == "minus") {
			out.push(" open='1'")
		}
		if (ra.length) {
			for (var i = 0; i < ra.length; i++) {
				out.push(" " + ra[i] + "='" + r._attrs[ra[i]] + "'")
			}
		}
		out.push(">");
		if (this._sUDa && this.UserData[r.idd]) {
			keysAr = this.UserData[r.idd].getKeys();
			for (var ii = 0; ii < keysAr.length; ii++) {
				out.push("<userdata name='" + keysAr[ii] + "'>" + (this._asCDATA ? "<![CDATA[" : "") + this.UserData[r.idd].get(keysAr[ii]) + (this._asCDATA ? "]]>" : "") + "</userdata>")
			}
		}
		var changeFl = false;
		for (var jj = 0; jj < this._cCount; jj++) {
			if ((!this._srClmn) || (this._srClmn[jj])) {
				var zx = this.cells3(r, jj);
				out.push("<cell");
				if (ca.length) {
					for (var i = 0; i < ca.length; i++) {
						out.push(" " + ca[i] + "='" + zx.cell._attrs[ca[i]] + "'")
					}
				}
				zxVal = zx[this._agetm]();
				if (this._asCDATA) {
					zxVal = "<![CDATA[" + zxVal + "]]>"
				}
				if ((this._ecspn) && (zx.cell.colSpan) && zx.cell.colSpan > 1) {
					out.push(' colspan="' + zx.cell.colSpan + '" ')
				}
				if (this._chAttr) {
					if (zx.wasChanged()) {
						out.push(' changed="1"');
						changeFl = true
					}
				} else {
					if ((this._onlChAttr) && (zx.wasChanged())) {
						changeFl = true
					}
				}
				if (this._sAll && this.cellType[jj] == "tree") {
					out.push((this._h2 ? (" image='" + this._h2.get[r.idd].image + "'") : "") + ">" + zxVal + "</cell>")
				} else {
					out.push(">" + zxVal + "</cell>")
				}
				if ((this._ecspn) && (zx.cell.colSpan)) {
					for (var u = 0; u < zx.cell.colSpan - 1; u++) {
						out.push("<cell/>");
						jj++
					}
				}
			}
		}
		if ((this._onlChAttr) && (!changeFl) && (!r._added)) {
			return ""
		}
		return out.join("")
	};
	this._serialiseConfig = function() {
		var out = "<head>";
		for (var i = 0; i < this.hdr.rows[0].cells.length; i++) {
			if (this._srClmn && !this._srClmn[i]) {
				continue
			}
			var sort = this.fldSort[i];
			if (sort == "cus") {
				sort = this._customSorts[i].toString();
				sort = sort.replace(/function[\ ]*/, "").replace(/\([^\f]*/, "")
			}
			out += "<column width='" + this.getColWidth(i) + "' align='" + this.cellAlign[i] + "' type='" + this.cellType[i] + "' sort='" + (sort || "na") + "' color='" + this.columnColor[i] + "'" + (this.columnIds[i] ? (" id='" + this.columnIds[i] + "'") : "") + ">";
			if (this._asCDATA) {
				out += "<![CDATA[" + this.getColumnLabel(i) + "]]>"
			} else {
				out += this.getColumnLabel(i)
			}
			var z = this.getCombo(i);
			if (z) {
				for (var j = 0; j < z.keys.length; j++) {
					out += "<option value='" + z.keys[j] + "'>" + z.values[j] + "</option>"
				}
			}
			out += "</column>"
		}
		return out += "</head>"
	};
	this.serialize = function() {
		var out = '<?xml version="1.0"?><rows>';
		if (this._mathSerialization) {
			this._agetm = "getMathValue"
		} else {
			this._agetm = "getValue"
		}
		if (this._sUDa && this.UserData.gridglobaluserdata) {
			var keysAr = this.UserData.gridglobaluserdata.getKeys();
			for (var i = 0; i < keysAr.length; i++) {
				out += "<userdata name='" + keysAr[i] + "'>" + this.UserData.gridglobaluserdata.get(keysAr[i]) + "</userdata>"
			}
		}
		if (this._sConfig) {
			out += this._serialiseConfig()
		}
		out += this._serialise();
		out += "</rows>";
		return out
	};
	this.getPosition = function(oNode, pNode) {
		if (!pNode) {
			var pos = dhx4.getOffset(oNode);
			return [pos.left, pos.top]
		}
		pNode = pNode || document.body;
		var oCurrentNode = oNode;
		var iLeft = 0;
		var iTop = 0;
		while ((oCurrentNode) && (oCurrentNode != pNode)) {
			iLeft += oCurrentNode.offsetLeft - oCurrentNode.scrollLeft;
			iTop += oCurrentNode.offsetTop - oCurrentNode.scrollTop;
			oCurrentNode = oCurrentNode.offsetParent
		}
		if (pNode == document.body) {
			if (_isIE) {
				iTop += document.body.offsetTop || document.documentElement.offsetTop;
				iLeft += document.body.offsetLeft || document.documentElement.offsetLeft
			} else {
				if (!_isFF) {
					iLeft += document.body.offsetLeft;
					iTop += document.body.offsetTop
				}
			}
		}
		return [iLeft, iTop]
	};
	this.getFirstParentOfType = function(obj, tag) {
		while (obj && obj.tagName != tag && obj.tagName != "BODY") {
			obj = obj.parentNode
		}
		return obj
	};
	this.objBox.onscroll = function() {
		this.grid._doOnScroll()
	};
	this.hdrBox.onscroll = function() {
		if (this._try_header_sync) {
			return
		}
		this._try_header_sync = true;
		if (Math.abs(this.grid.objBox.scrollLeft - this.scrollLeft) > 1) {
			this.grid.objBox.scrollLeft = this.scrollLeft
		}
		this._try_header_sync = false
	};
	if ((!_isOpera) || (_OperaRv > 8.5)) {
		this.hdr.onmousemove = function(e) {
			this.grid.changeCursorState(e || window.event)
		};
		this.hdr.onmousedown = function(e) {
			return this.grid.startColResize(e || window.event)
		}
	}
	this.obj.onmousemove = this._drawTooltip;
	this.objBox.onclick = function(e) {
		(e || event).cancelBubble = true
	};
	this.obj.onclick = function(e) {
		if (this.grid._doClick(e || window.event) !== false) {
			if (this.grid._sclE) {
				this.grid.editCell(e || window.event)
			} else {
				this.grid.editStop()
			}
		}(e || event).cancelBubble = true
	};
	if (_isMacOS) {
		this.entBox.oncontextmenu = function(e) {
			e.cancelBubble = true;
			if (e.preventDefault) {
				e.preventDefault()
			} else {
				e.returnValue = false
			}
			var that = this.grid;
			if (that._realfake) {
				that = that._fake
			}
			return that._doContClick(e || window.event)
		}
	} else {
		this.entBox.onmousedown = function(e) {
			return this.grid._doContClick(e || window.event)
		};
		this.entBox.oncontextmenu = function(e) {
			if (this.grid._ctmndx) {
				(e || event).cancelBubble = true
			}
			return !this.grid._ctmndx
		}
	}
	this.obj.ondblclick = function(e) {
		if (!this.grid.wasDblClicked(e || window.event)) {
			return false
		}
		if (this.grid._dclE) {
			var row = this.grid.getFirstParentOfType((_isIE ? event.srcElement : e.target), "TR");
			if (row == this.grid.row) {
				this.grid.editCell(e || window.event)
			}
		}(e || event).cancelBubble = true;
		if (_isOpera) {
			return false
		}
	};
	this.hdr.onclick = this._onHeaderClick;
	this.sortImg.onclick = function() {
		self._onHeaderClick.apply({
			grid: self
		}, [null, self.r_fldSorted])
	};
	this.hdr.ondblclick = this._onHeaderDblClick;
	if (!document.body._dhtmlxgrid_onkeydown) {
		dhtmlxEvent(document, "keydown", function(e) {
			if (globalActiveDHTMLGridObject) {
				return globalActiveDHTMLGridObject.doKey(e || window.event)
			}
		});
		document.body._dhtmlxgrid_onkeydown = true
	}
	dhtmlxEvent(document.body, "click", function() {
		if (self.editStop) {
			self.editStop()
		}
		if (self.isActive) {
			self.setActive(false)
		}
	});
	if (this.entBox.style.height.toString().indexOf("%") != -1) {
		this._delta_y = this.entBox.style.height
	}
	if (this.entBox.style.width.toString().indexOf("%") != -1) {
		this._delta_x = this.entBox.style.width
	}
	if (this._delta_x || this._delta_y) {
		this._setAutoResize()
	}
	this.setColHidden = this.setColumnsVisibility;
	this.enableCollSpan = this.enableColSpan;
	this.setMultiselect = this.enableMultiselect;
	this.setMultiLine = this.enableMultiline;
	this.deleteSelectedItem = this.deleteSelectedRows;
	this.getSelectedId = this.getSelectedRowId;
	this.getHeaderCol = this.getColumnLabel;
	this.isItemExists = this.doesRowExist;
	this.getColumnCount = this.getColumnsNum;
	this.setSelectedRow = this.selectRowById;
	this.setHeaderCol = this.setColumnLabel;
	this.preventIECashing = this.preventIECaching;
	this.enableAutoHeigth = this.enableAutoHeight;
	this.getUID = this.uid;
	if (dhtmlx.image_path) {
		this.setImagePath(dhtmlx.image_path)
	}
	if (dhtmlx.skin) {
		this.setSkin(dhtmlx.skin)
	}
	return this
}
dhtmlXGridObject.prototype = {
	getRowAttribute: function(c, a) {
		return this.getRowById(c)._attrs[a]
	},
	setRowAttribute: function(g, a, c) {
		this.getRowById(g)._attrs[a] = c
	},
	isTreeGrid: function() {
		//modify code by zzm 20160826
		return (this.cellType._dhx_find("tree") != -1)||(this.cellType._dhx_find("treero") != -1)
	},
	setRowHidden: function(n, g) {
		var c = dhx4.s2b(g);
		var m = this.getRowById(n);
		if (!m) {
			return
		}
		if (m.expand === "") {
			this.collapseKids(m)
		}
		if ((g) && (m.style.display != "none")) {
			m.style.display = "none";
			var l = this.selectedRows._dhx_find(m);
			if (l != -1) {
				m.className = m.className.replace("rowselected", "");
				for (var a = 0; a < m.childNodes.length; a++) {
					m.childNodes[a].className = m.childNodes[a].className.replace(/cellselected/g, "")
				}
				this.selectedRows._dhx_removeAt(l)
			}
			this.callEvent("onGridReconstructed", [])
		}
		if ((!g) && (m.style.display == "none")) {
			m.style.display = "";
			this.callEvent("onGridReconstructed", [])
		}
		this.callEvent("onRowHide", [n, g]);
		this.setSizes()
	},
	setColumnHidden: function(g, c) {
		if (!this.hdr.rows.length) {
			if (!this._ivizcol) {
				this._ivizcol = []
			}
			return this._ivizcol[g] = c
		}
		if ((this.fldSorted) && (this.fldSorted.cellIndex == g) && (c)) {
			this.sortImg.style.display = "none"
		}
		var a = dhx4.s2b(c);
		if (a) {
			if (!this._hrrar) {
				this._hrrar = new Array()
			} else {
				if (this._hrrar[g]) {
					return
				}
			}
			this._hrrar[g] = "display:none;";
			this._hideShowColumn(g, "none")
		} else {
			if ((!this._hrrar) || (!this._hrrar[g])) {
				return
			}
			this._hrrar[g] = "";
			this._hideShowColumn(g, "")
		}
		if ((this.fldSorted) && (this.fldSorted.cellIndex == g) && (!c)) {
			this.sortImg.style.display = "inline"
		}
		this.setSortImgPos();
		this.callEvent("onColumnHidden", [g, c])
	},
	isColumnHidden: function(a) {
		if ((this._hrrar) && (this._hrrar[a])) {
			return true
		}
		return false
	},
	setColumnsVisibility: function(c) {
		if (c) {
			this._ivizcol = c.split(this.delim)
		}
		if (this.hdr.rows.length && this._ivizcol) {
			for (var a = 0; a < this._ivizcol.length; a++) {
				this.setColumnHidden(a, this._ivizcol[a])
			}
		}
	},
	_fixHiddenRowsAll: function(q, g, a, c, n) {
		n = n || "_cellIndex";
		var o = q.rows.length;
		for (var m = 0; m < o; m++) {
			var r = q.rows[m].childNodes;
			if (r.length != this._cCount) {
				for (var l = 0; l < r.length; l++) {
					if (r[l][n] == g) {
						r[l].style[a] = c;
						break
					}
				}
			} else {
				r[g].style[a] = c
			}
		}
	},
	_hideShowColumn: function(m, l) {
		var a = m;
		if (this.hdr.rows[1] && (this.hdr.rows[1]._childIndexes) && (this.hdr.rows[1]._childIndexes[m] != m)) {
			a = this.hdr.rows[1]._childIndexes[m]
		}
		if (l == "none") {
			this.hdr.rows[0].cells[m]._oldWidth = this.hdr.rows[0].cells[m].style.width || (this.initCellWidth[m] + "px");
			this.hdr.rows[0].cells[m]._oldWidthP = this.cellWidthPC[m];
			this.obj.rows[0].cells[m].style.width = "0px";
			var c = {
				rows: [this.obj.rows[0]]
			};
			this.forEachRow(function(n) {
				if (this.rowsAr[n].tagName == "TR") {
					c.rows.push(this.rowsAr[n])
				}
			});
			this._fixHiddenRowsAll(c, m, "display", "none");
			if (this.isTreeGrid()) {
				this._fixHiddenRowsAllTG(m, "none")
			}
			if ((_isOpera && _OperaRv < 9) || _isKHTML || (_isFF)) {
				this._fixHiddenRowsAll(this.hdr, m, "display", "none", "_cellIndexS")
			}
			if (this.ftr) {
				this._fixHiddenRowsAll(this.ftr.childNodes[0], m, "display", "none")
			}
			this._fixHiddenRowsAll(this.hdr, m, "whiteSpace", "nowrap", "_cellIndexS");
			if (!this.cellWidthPX.length && !this.cellWidthPC.length) {
				this.cellWidthPX = [].concat(this.initCellWidth)
			}
			if (this.cellWidthPX[m]) {
				this.cellWidthPX[m] = 0
			}
			if (this.cellWidthPC[m]) {
				this.cellWidthPC[m] = 0
			}
		} else {
			if (this.hdr.rows[0].cells[m]._oldWidth) {
				var g = this.hdr.rows[0].cells[m];
				if (_isOpera || _isKHTML || (_isFF)) {
					this._fixHiddenRowsAll(this.hdr, m, "display", "", "_cellIndexS")
				}
				if (this.ftr) {
					this._fixHiddenRowsAll(this.ftr.childNodes[0], m, "display", "")
				}
				var c = {
					rows: [this.obj.rows[0]]
				};
				this.forEachRow(function(n) {
					if (this.rowsAr[n].tagName == "TR") {
						c.rows.push(this.rowsAr[n])
					}
				});
				this._fixHiddenRowsAll(c, m, "display", "");
				if (this.isTreeGrid()) {
					this._fixHiddenRowsAllTG(m, "")
				}
				this._fixHiddenRowsAll(this.hdr, m, "whiteSpace", "normal", "_cellIndexS");
				if (g._oldWidthP) {
					this.cellWidthPC[m] = g._oldWidthP
				}
				if (g._oldWidth) {
					this.cellWidthPX[m] = parseInt(g._oldWidth)
				}
			}
		}
		this.setSizes();
		if ((!_isIE) && (!_isFF)) {
			this.obj.border = 1;
			this.obj.border = 0
		}
	},
	enableColSpan: function(a) {
		this._ecspn = dhx4.s2b(a)
	},
	enableRowsHover: function(c, a) {
		this._unsetRowHover(false, true);
		this._hvrCss = a;
		if (dhx4.s2b(c)) {
			if (!this._elmnh) {
				this.obj._honmousemove = this.obj.onmousemove;
				this.obj.onmousemove = this._setRowHover;
				if (_isIE) {
					this.obj.onmouseleave = this._unsetRowHover
				} else {
					this.obj.onmouseout = this._unsetRowHover
				}
				this._elmnh = true
			}
		} else {
			if (this._elmnh) {
				this.obj.onmousemove = this.obj._honmousemove;
				if (_isIE) {
					this.obj.onmouseleave = null
				} else {
					this.obj.onmouseout = null
				}
				this._elmnh = false
			}
		}
	},
	enableEditEvents: function(c, g, a) {
		this._sclE = dhx4.s2b(c);
		this._dclE = dhx4.s2b(g);
		this._f2kE = dhx4.s2b(a)
	},
	enableLightMouseNavigation: function(a) {
		if (dhx4.s2b(a)) {
			if (!this._elmn) {
				this.entBox._onclick = this.entBox.onclick;
				this.entBox.onclick = function() {
					return true
				};
				this.obj._onclick = this.obj.onclick;
				this.obj.onclick = function(g) {
					var l = this.grid.getFirstParentOfType(g ? g.target : event.srcElement, "TD");
					if (!l) {
						return
					}
					this.grid.editStop();
					this.grid.doClick(l);
					this.grid.editCell();
					(g || event).cancelBubble = true
				};
				this.obj._onmousemove = this.obj.onmousemove;
				this.obj.onmousemove = this._autoMoveSelect;
				this._elmn = true
			}
		} else {
			if (this._elmn) {
				this.entBox.onclick = this.entBox._onclick;
				this.obj.onclick = this.obj._onclick;
				this.obj.onmousemove = this.obj._onmousemove;
				this._elmn = false
			}
		}
	},
	_unsetRowHover: function(g, l) {
		if (l) {
			that = this
		} else {
			that = this.grid
		}
		if ((that._lahRw) && (that._lahRw != l)) {
			for (var a = 0; a < that._lahRw.childNodes.length; a++) {
				that._lahRw.childNodes[a].className = that._lahRw.childNodes[a].className.replace(that._hvrCss, "")
			}
			that._lahRw = null
		}
	},
	_setRowHover: function(g) {
		var l = this.grid.getFirstParentOfType(g ? g.target : event.srcElement, "TD");
		if (l && l.parentNode != this.grid._lahRw) {
			this.grid._unsetRowHover(0, l);
			l = l.parentNode;
			if (!l.idd || l.idd == "__filler__") {
				return
			}
			for (var a = 0; a < l.childNodes.length; a++) {
				l.childNodes[a].className += " " + this.grid._hvrCss
			}
			this.grid._lahRw = l
		}
		this._honmousemove(g)
	},
	_autoMoveSelect: function(a) {
		if (!this.grid.editor) {
			var g = this.grid.getFirstParentOfType(a ? a.target : event.srcElement, "TD");
			if (g.parentNode.idd) {
				this.grid.doClick(g, true, 0)
			}
		}
		this._onmousemove(a)
	},
	enableDistributedParsing: function(g, a, c) {
		if (dhx4.s2b(g)) {
			this._ads_count = a || 10;
			this._ads_time = c || 250
		} else {
			this._ads_count = 0
		}
	},
	destructor: function() {
		this.editStop(true);
		if (this._sizeTime) {
			this._sizeTime = window.clearTimeout(this._sizeTime)
		}
		this.entBox.className = (this.entBox.className || "").replace(/gridbox.*/, "");
		if (this.formInputs) {
			for (var g = 0; g < this.formInputs.length; g++) {
				this.parentForm.removeChild(this.formInputs[g])
			}
		}
		var c;
		for (var g = 0; g < this.rowsCol.length; g++) {
			if (this.rowsCol[g]) {
				this.rowsCol[g].grid = null
			}
		}
		for (g in this.rowsAr) {
			if (this.rowsAr[g]) {
				this.rowsAr[g] = null
			}
		}
		this.rowsCol = new dhtmlxArray();
		this.rowsAr = {};
		this.entBox.innerHTML = "";
		var l = function() {};
		this.entBox.onclick = this.entBox.onmousedown = this.entBox.onbeforeactivate = this.entBox.onbeforedeactivate = this.entBox.onbeforedeactivate = this.entBox.onselectstart = l;
		this.setSizes = this._update_srnd_view = this.callEvent = l;
		this.entBox.grid = this.objBox.grid = this.hdrBox.grid = this.obj.grid = this.hdr.grid = null;
		if (this._fake) {
			this.globalBox.innerHTML = "";
			this._fake.setSizes = this._fake._update_srnd_view = this._fake.callEvent = l;
			this.globalBox.onclick = this.globalBox.onmousedown = this.globalBox.onbeforeactivate = this.globalBox.onbeforedeactivate = this.globalBox.onbeforedeactivate = this.globalBox.onselectstart = l
		}
		for (c in this) {
			if ((this[c]) && (this[c].m_obj)) {
				this[c].m_obj = null
			}
			this[c] = null
		}
		if (this == globalActiveDHTMLGridObject) {
			globalActiveDHTMLGridObject = null
		}
		return null
	},
	getSortingState: function() {
		var a = new Array();
		if (this.fldSorted) {
			a[0] = this.fldSorted._cellIndex;
			a[1] = (this.sortImg.className == "dhxgrid_sort_desc" ? "des" : "asc")
		}
		return a
	},
	enableAutoHeight: function(g, c, a) {
		this._ahgr = dhx4.s2b(g);
		this._ahgrF = dhx4.s2b(a);
		this._ahgrM = c || null;
		if (arguments.length == 1) {
			this.objBox.style.overflowY = g ? "hidden" : "auto"
		}
		if (c == "auto") {
			this._ahgrM = null;
			this._ahgrMA = true;
			this._setAutoResize()
		}
	},
	enableStableSorting: function(a) {
		this._sst = dhx4.s2b(a);
		this.rowsCol.stablesort = function(n) {
			var m = this.length - 1;
			for (var l = 0; l < this.length - 1; l++) {
				for (var g = 0; g < m; g++) {
					if (n(this[g], this[g + 1]) > 0) {
						var c = this[g];
						this[g] = this[g + 1];
						this[g + 1] = c
					}
				}
				m--
			}
		}
	},
	enableKeyboardSupport: function(a) {
		this._htkebl = !dhx4.s2b(a)
	},
	enableContextMenu: function(a) {
		this._ctmndx = a
	},
	setScrollbarWidthCorrection: function(a) {},
	enableTooltips: function(c) {
		this._enbTts = c.split(",");
		for (var a = 0; a < this._enbTts.length; a++) {
			this._enbTts[a] = dhx4.s2b(this._enbTts[a])
		}
	},
	enableResizing: function(c) {
		this._drsclmn = c.split(",");
		for (var a = 0; a < this._drsclmn.length; a++) {
			this._drsclmn[a] = dhx4.s2b(this._drsclmn[a])
		}
	},
	setColumnMinWidth: function(a, c) {
		if (arguments.length == 2) {
			if (!this._drsclmW) {
				this._drsclmW = new Array()
			}
			this._drsclmW[c] = a
		} else {
			this._drsclmW = a.split(",")
		}
	},
	enableCellIds: function(a) {
		this._enbCid = dhx4.s2b(a)
	},
	lockRow: function(a, g) {
		var c = this.getRowById(a);
		if (c) {
			c._locked = dhx4.s2b(g);
			if ((this.cell) && (this.cell.parentNode.idd == a)) {
				this.editStop()
			}
		}
	},
	_getRowArray: function(m) {
		var l = new Array();
		for (var g = 0; g < m.childNodes.length; g++) {
			var c = this.cells3(m, g);
			l[g] = c.getValue()
		}
		return l
	},
	setDateFormat: function(c, a) {
		this._dtmask = c;
		this._dtmask_inc = a
	},
	setNumberFormat: function(q, g, m, o) {
		var l = q.replace(/[^0\,\.]*/g, "");
		var a = l.indexOf(".");
		if (a > -1) {
			a = l.length - a - 1
		}
		var c = l.indexOf(",");
		if (c > -1) {
			c = l.length - a - 2 - c
		}
		if (typeof m != "string") {
			m = this.i18n.decimal_separator
		}
		if (typeof o != "string") {
			o = this.i18n.group_separator
		}
		var r = q.split(l)[0];
		var n = q.split(l)[1];
		this._maskArr[g] = [a, c, r, n, m, o]
	},
	_aplNFb: function(m, l) {
		var c = this._maskArr[l];
		if (!c) {
			return m
		}
		var g = parseFloat(m.toString().replace(/[^0-9]*/g, ""));
		if (m.toString().substr(0, 1) == "-") {
			g = g * -1
		}
		if (c[0] > 0) {
			g = g / Math.pow(10, c[0])
		}
		return g
	},
	_aplNF: function(n, m) {
		var g = this._maskArr[m];
		if (!g) {
			return n
		}
		var o = (parseFloat(n) < 0 ? "-" : "") + g[2];
		n = Math.abs(Math.round(parseFloat(n) * Math.pow(10, g[0] > 0 ? g[0] : 0))).toString();
		n = (n.length < g[0] ? Math.pow(10, g[0] + 1 - n.length).toString().substr(1, g[0] + 1) + n.toString() : n).split("").reverse();
		n[g[0]] = (n[g[0]] || "0") + g[4];
		if (g[1] > 0) {
			for (var l = (g[0] > 0 ? 0 : 1) + g[0] + g[1]; l < n.length; l += g[1]) {
				n[l] += g[5]
			}
		}
		return o + n.reverse().join("") + g[3]
	},
	_launchCommands: function(a) {
		for (var l = 0; l < a.length; l++) {
			var g = new Array();
			for (var c = 0; c < a[l].childNodes.length; c++) {
				if (a[l].childNodes[c].nodeType == 1) {
					g[g.length] = a[l].childNodes[c].firstChild.data
				}
			}
			this[a[l].getAttribute("command")].apply(this, g)
		}
	},
	_parseHead: function(m) {
		var l = dhx4.ajax.xpath("./head", m);
		if (l.length) {
			var n = dhx4.ajax.xpath("./column", l[0]);
			var o = dhx4.ajax.xpath("./settings", l[0]);
			var D = "setInitWidths";
			var x = false;
			if (o[0]) {
				for (var q = 0; q < o[0].childNodes.length; q++) {
					switch (o[0].childNodes[q].tagName) {
						case "colwidth":
							if (o[0].childNodes[q].firstChild && o[0].childNodes[q].firstChild.data == "%") {
								D = "setInitWidthsP"
							}
							break;
						case "splitat":
							x = (o[0].childNodes[q].firstChild ? o[0].childNodes[q].firstChild.data : false);
							break
					}
				}
			}
			this._launchCommands(dhx4.ajax.xpath("./beforeInit/call", l[0]));
			if (n.length > 0) {
				if (this.hdr.rows.length > 0) {
					this.clearAll(true)
				}
				var a = [
					[],
					[],
					[],
					[],
					[],
					[],
					[],
					[],
					[]
				];
				var w = ["", "width", "type", "align", "sort", "color", "format", "hidden", "id"];
				var v = ["", D, "setColTypes", "setColAlign", "setColSorting", "setColumnColor", "", "", "setColumnIds"];
				for (var C = 0; C < n.length; C++) {
					for (var A = 1; A < w.length; A++) {
						a[A].push(n[C].getAttribute(w[A]))
					}
					a[0].push((n[C].firstChild ? n[C].firstChild.data : "").replace(/^\s*((\s\S)*.+)\s*$/gi, "$1"))
				}
				this.setHeader(a[0]);
				for (var C = 0; C < v.length; C++) {
					if (v[C]) {
						this[v[C]](a[C].join(this.delim))
					}
				}
				for (var C = 0; C < n.length; C++) {
					if ((this.cellType[C].indexOf("co") == 0) || (this.cellType[C] == "clist")) {
						var r = dhx4.ajax.xpath("./option", n[C]);
						if (r.length) {
							var y = new Array();
							if (this.cellType[C] == "clist") {
								for (var A = 0; A < r.length; A++) {
									y[y.length] = r[A].firstChild ? r[A].firstChild.data : ""
								}
								this.registerCList(C, y)
							} else {
								var E = this.getCombo(C);
								for (var A = 0; A < r.length; A++) {
									E.put(r[A].getAttribute("value"), r[A].firstChild ? r[A].firstChild.data : "")
								}
							}
						}
					} else {
						if (a[6][C]) {
							if ((this.cellType[C].toLowerCase().indexOf("calendar") != -1) || (this.fldSort[C] == "date")) {
								this.setDateFormat(a[6][C])
							} else {
								this.setNumberFormat(a[6][C], C)
							}
						}
					}
				}
				this.init();
				var g = a[7].join(this.delim);
				if (this.setColHidden && g.replace(/,/g, "") != "") {
					this.setColHidden(g)
				}
				if ((x) && (this.splitAt)) {
					this.splitAt(x)
				}
			}
			this._launchCommands(dhx4.ajax.xpath("./afterInit/call", l[0]))
		}
		var c = dhx4.ajax.xpath("//rows/userdata", m);
		if (c.length > 0) {
			if (!this.UserData.gridglobaluserdata) {
				this.UserData.gridglobaluserdata = new Hashtable()
			}
			for (var A = 0; A < c.length; A++) {
				var F = "";
				for (var u = 0; u < c[A].childNodes.length; u++) {
					F += c[A].childNodes[u].nodeValue
				}
				this.UserData.gridglobaluserdata.put(c[A].getAttribute("name"), F)
			}
		}
	},
	getCheckedRows: function(a) {
		var c = new Array();
		this.forEachRowA(function(l) {
			var g = this.cells(l, a);
			if (g.changeState && g.getValue() != 0) {
				c.push(l)
			}
		}, true);
		return c.join(",")
	},
	checkAll: function() {
		var c = arguments.length ? arguments[0] : 1;
		for (var a = 0; a < this.getColumnsNum(); a++) {
			if (this.getColType(a) == "ch") {
				this.setCheckedRows(a, c)
			}
		}
	},
	uncheckAll: function() {
		this.checkAll(0)
	},
	setCheckedRows: function(c, a) {
		this.forEachRowA(function(g) {
			if (this.cells(g, c).isCheckbox()) {
				this.cells(g, c).setValue(a)
			}
		})
	},
	_drawTooltip: function(m) {
		var n = this.grid.getFirstParentOfType(m ? m.target : event.srcElement, "TD");
		if (!n || ((this.grid.editor) && (this.grid.editor.cell == n))) {
			return true
		}
		var l = n.parentNode;
		if (!l.idd || l.idd == "__filler__") {
			return
		}
		var g = (m ? m.target : event.srcElement);
		if (l.idd == window.unknown) {
			return true
		}
		if (!this.grid.callEvent("onMouseOver", [l.idd, n._cellIndex, (m || window.event)])) {
			return true
		}
		if ((this.grid._enbTts) && (!this.grid._enbTts[n._cellIndex])) {
			if (g.title) {
				g.title = ""
			}
			return true
		}
		if (n._cellIndex >= this.grid._cCount) {
			return
		}
		var a = this.grid.cells3(l, n._cellIndex);
		if (!a || !a.cell || !a.cell._attrs) {
			return
		}
		if (g._title) {
			a.cell.title = ""
		}
		if (!a.cell._attrs.title) {
			g._title = true
		}
		if (a) {
			g.title = a.cell._attrs.title || (a.getTitle ? a.getTitle() : (a.getValue() || "").toString().replace(/<[^>]*>/gi, ""))
		}
		return true
	},
	enableCellWidthCorrection: function(a) {
		if (_isFF) {
			this._wcorr = parseInt(a)
		}
	},
	getAllRowIds: function(g) {
		var a = [];
		for (var c = 0; c < this.rowsBuffer.length; c++) {
			if (this.rowsBuffer[c]) {
				a.push(this.rowsBuffer[c].idd)
			}
		}
		return a.join(g || this.delim)
	},
	getAllItemIds: function() {
		return this.getAllRowIds()
	},
	setColspan: function(g, y, l) {
		if (!this._ecspn) {
			return
		}
		var a = this.getRowById(g);
		if ((a._childIndexes) && (a.childNodes[a._childIndexes[y]])) {
			var s = a._childIndexes[y];
			var o = a.childNodes[s];
			var q = o.colSpan;
			o.colSpan = 1;
			if ((q) && (q != 1)) {
				for (var v = 1; v < q; v++) {
					var x = document.createElement("TD");
					if (o.nextSibling) {
						a.insertBefore(x, o.nextSibling)
					} else {
						a.appendChild(x)
					}
					a._childIndexes[y + v] = s + v;
					x._cellIndex = y + v;
					x.style.textAlign = this.cellAlign[v];
					x.style.verticalAlign = this.cellVAlign[v];
					o = x;
					this.cells3(a, y + v).setValue("")
				}
			}
			for (var w = y * 1 + 1 * q; w < a._childIndexes.length; w++) {
				a._childIndexes[w] += (q - 1) * 1
			}
		}
		if ((l) && (l > 1)) {
			if (a._childIndexes) {
				var s = a._childIndexes[y]
			} else {
				var s = y;
				a._childIndexes = new Array();
				for (var w = 0; w < a.childNodes.length; w++) {
					a._childIndexes[w] = w
				}
			}
			a.childNodes[s].colSpan = l;
			for (var w = 1; w < l; w++) {
				a._childIndexes[a.childNodes[s + 1]._cellIndex] = s;
				a.removeChild(a.childNodes[s + 1])
			}
			var u = a.childNodes[a._childIndexes[y]]._cellIndex;
			for (var w = u * 1 + 1 * l; w < a._childIndexes.length; w++) {
				a._childIndexes[w] -= (l - 1)
			}
		}
	},
	preventIECaching: function(a) {
		dhx4.ajax.cache = !a
	},
	enableColumnAutoSize: function(a) {
		this._eCAS = dhx4.s2b(a)
	},
	_onHeaderDblClick: function(g) {
		var c = this.grid;
		var a = c.getFirstParentOfType(_isIE ? event.srcElement : g.target, "TD");
		if (!c._eCAS) {
			return false
		}
		c.adjustColumnSize(a._cellIndexS)
	},
	adjustColumnSize: function(r, c) {
		if (this._hrrar && this._hrrar[r]) {
			return
		}
		this._notresize = true;
		var g = 0;
		this._setColumnSizeR(r, 20);
		for (var o = 1; o < this.hdr.rows.length; o++) {
			var u = this.hdr.rows[o];
			u = u.childNodes[(u._childIndexes) ? u._childIndexes[r] : r];
			if ((u) && ((!u.colSpan) || (u.colSpan < 2)) && u._cellIndex == r) {
				if ((u.childNodes[0]) && (u.childNodes[0].className == "hdrcell")) {
					u = u.childNodes[0]
				}
				g = Math.max(g, u.scrollWidth)
			}
		}
		var n = this.obj.rows.length;
		var s = 0;
		var w = this.cellType._dhx_find("tree");
		for (var q = 1; q < n; q++) {
			var v = this.obj.rows[q];
			if (!this.rowsAr[v.idd]) {
				continue
			}
			if (v._childIndexes && v._childIndexes[r] != r || !v.childNodes[r]) {
				continue
			}
			s = (v.childNodes[r].innerText || v.childNodes[r].textContent || "").length * this.fontWidth;
			if (this._h2 && r == w) {
				s += this._h2.get[v.idd].level * 22
			}
			if (s > g) {
				g = s
			}
		}
		g += 20 + (c || 0);
		this._setColumnSizeR(r, g);
		this._notresize = false;
		this.setSizes()
	},
	detachHeader: function(a, g) {
		g = g || this.hdr;
		var c = g.rows[a + 1];
		if (c) {
			c.parentNode.removeChild(c)
		}
		this.setSizes()
	},
	detachFooter: function(a) {
		this.detachHeader(a, this.ftr)
	},
	attachHeader: function(a, l, c) {
		if (typeof(a) == "string") {
			a = this._eSplit(a)
		}
		if (typeof(l) == "string") {
			l = l.split(this.delim)
		}
		c = c || "_aHead";
		if (this.hdr.rows.length) {
			if (a) {
				this._createHRow([a, l], this[(c == "_aHead") ? "hdr" : "ftr"])
			} else {
				if (this[c]) {
					for (var g = 0; g < this[c].length; g++) {
						this.attachHeader.apply(this, this[c][g])
					}
				}
			}
		} else {
			if (!this[c]) {
				this[c] = new Array()
			}
			this[c][this[c].length] = [a, l, c]
		}
	},
	_createHRow: function(g, s) {
		if (!s) {
			if (this.entBox.style.position != "absolute") {
				this.entBox.style.position = "relative"
			}
			var o = document.createElement("DIV");
			o.className = "c_ftr".substr(2);
			this.entBox.appendChild(o);
			var x = document.createElement("TABLE");
			x.cellPadding = x.cellSpacing = 0;
			if (!_isIE || _isIE == 8) {
				x.width = "100%";
				x.style.paddingRight = "20px"
			}
			x.style.marginRight = "20px";
			x.style.tableLayout = "fixed";
			o.appendChild(x);
			x.appendChild(document.createElement("TBODY"));
			this.ftr = s = x;
			var n = x.insertRow(0);
			var a = ((this.hdrLabels.length <= 1) ? g[0].length : this.hdrLabels.length);
			for (var l = 0; l < a; l++) {
				n.appendChild(document.createElement("TH"));
				n.childNodes[l]._cellIndex = l
			}
			if (_isIE && _isIE < 8) {
				n.style.position = "absolute"
			} else {
				n.style.height = "auto"
			}
		}
		var m = g[1];
		var o = document.createElement("TR");
		s.rows[0].parentNode.appendChild(o);
		for (var l = 0; l < g[0].length; l++) {
			if (g[0][l] == "#cspan") {
				var q = o.cells[o.cells.length - 1];
				q.colSpan = (q.colSpan || 1) + 1;
				continue
			}
			if ((g[0][l] == "#rspan") && (s.rows.length > 1)) {
				var A = s.rows.length - 2;
				var y = false;
				var q = null;
				while (!y) {
					var q = s.rows[A];
					for (var c = 0; c < q.cells.length; c++) {
						if (q.cells[c]._cellIndex == l) {
							y = c + 1;
							break
						}
					}
					A--
				}
				q = q.cells[y - 1];
				q.rowSpan = (q.rowSpan || 1) + 1;
				continue
			}
			var r = document.createElement("TD");
			r._cellIndex = r._cellIndexS = l;
			if (this._hrrar && this._hrrar[l] && !_isIE) {
				r.style.display = "none"
			}
			if (typeof g[0][l] == "object") {
				r.appendChild(g[0][l])
			} else {
				if (this.forceDivInHeader) {
					r.innerHTML = "<div class='hdrcell'>" + (g[0][l] || "&nbsp;") + "</div>"
				} else {
					r.innerHTML = (g[0][l] || "&nbsp;")
				}
				if ((g[0][l] || "").indexOf("#") != -1) {
					var x = g[0][l].match(/(^|{)#([^}]+)(}|$)/);
					if (x) {
						var u = "_in_header_" + x[2];
						if (this[u]) {
							this[u]((this.forceDivInHeader ? r.firstChild : r), l, g[0][l].split(x[0]))
						}
					}
				}
			}
			if (m) {
				r.style.cssText = m[l]
			}
			o.appendChild(r)
		}
		var v = s;
		if (_isKHTML) {
			if (s._kTimer) {
				window.clearTimeout(s._kTimer)
			}
			s._kTimer = window.setTimeout(function() {
				s.rows[1].style.display = "none";
				window.setTimeout(function() {
					s.rows[1].style.display = ""
				}, 1)
			}, 500)
		}
	},
	attachFooter: function(a, c) {
		this.attachHeader(a, c, "_aFoot")
	},
	setCellExcellType: function(g, a, c) {
		this.changeCellType(this.getRowById(g), a, c)
	},
	changeCellType: function(g, l, c) {
		c = c || this.cellType[l];
		var m = this.cells3(g, l);
		var a = m.getValue();
		m.cell._cellType = c;
		var m = this.cells3(g, l);
		m.setValue(a)
	},
	setRowExcellType: function(g, c) {
		var l = this.rowsAr[g];
		for (var a = 0; a < l.childNodes.length; a++) {
			this.changeCellType(l, a, c)
		}
	},
	setColumnExcellType: function(a, g) {
		for (var c = 0; c < this.rowsBuffer.length; c++) {
			if (this.rowsBuffer[c] && this.rowsBuffer[c].tagName == "TR") {
				this.changeCellType(this.rowsBuffer[c], a, g)
			}
		}
		if (this.cellType[a] == "math") {
			this._strangeParams[c] = g
		} else {
			this.cellType[a] = g
		}
	},
	forEachRow: function(g) {
		for (var c in this.rowsAr) {
			if (this.rowsAr[c] && this.rowsAr[c].idd) {
				g.apply(this, [this.rowsAr[c].idd])
			}
		}
	},
	forEachRowA: function(g) {
		for (var c = 0; c < this.rowsBuffer.length; c++) {
			if (this.rowsBuffer[c]) {
				g.call(this, this.render_row(c).idd)
			}
		}
	},
	forEachCell: function(g, c) {
		var l = this.getRowById(g);
		if (!l) {
			return
		}
		for (var a = 0; a < this._cCount; a++) {
			c(this.cells3(l, a), a)
		}
	},
	enableAutoWidth: function(g, a, c) {
		this._awdth = [dhx4.s2b(g), parseInt(a || 99999), parseInt(c || 0)];
		if (arguments.length == 1) {
			this.objBox.style.overflowX = g ? "hidden" : "auto"
		}
	},
	updateFromXML: function(a, l, c, g) {
		if (typeof l == "undefined") {
			l = true
		}
		this._refresh_mode = [true, l, c];
		this.load(a, g)
	},
	_refreshFromXML: function(l) {
		if (this._f_rowsBuffer) {
			this.filterBy(0, "")
		}
		reset = false;
		if (window.eXcell_tree) {
			eXcell_tree.prototype.setValueX = eXcell_tree.prototype.setValue;
			eXcell_tree.prototype.setValue = function(w) {
				var v = this.grid._h2.get[this.cell.parentNode.idd];
				if (v && this.cell.parentNode.valTag) {
					this.setLabel(w)
				} else {
					this.setValueX(w)
				}
			}
		}
		
		//modify code by zzm 20160826
		if (window.eXcell_treero) {
			eXcell_treero.prototype.setValueX = eXcell_treero.prototype.setValue;
			eXcell_treero.prototype.setValue = function(w) {
				var v = this.grid._h2.get[this.cell.parentNode.idd];
				if (v && this.cell.parentNode.valTag) {
					this.setLabel(w)
				} else {
					this.setValueX(w)
				}
			}
		}
		
		
		var u = this.cellType._dhx_find("tree");
		var n = dhx4.ajax.xmltop("rows", l);
		var m = n.getAttribute("parent") || 0;
		var q = {};
		if (this._refresh_mode[2]) {
			if (u != -1) {
				this._h2.forEachChild(m, function(v) {
					q[v.id] = true
				}, this)
			} else {
				this.forEachRow(function(v) {
					q[v] = true
				})
			}
		}
		var s = dhx4.ajax.xpath("//row", n);
		for (var g = 0; g < s.length; g++) {
			var r = s[g];
			var a = r.getAttribute("id");
			q[a] = false;
			var m = r.parentNode.getAttribute("id") || m;
			if (this.rowsAr[a] && this.rowsAr[a].tagName != "TR") {
				if (this._h2) {
					this._h2.get[a].buff.data = r
				} else {
					this.rowsBuffer[this.getRowIndex(a)].data = r
				}
				this.rowsAr[a] = r
			} else {
				if (this.rowsAr[a]) {
					this._process_xml_row(this.rowsAr[a], r, -1);
					this._postRowProcessing(this.rowsAr[a], true);
					if (this._fake && this._fake.rowsAr[a]) {
						this._fake._process_xml_row(this._fake.rowsAr[a], r, -1)
					}
				} else {
					if (this._refresh_mode[1]) {
						var o = {
							idd: a,
							data: r,
							_parser: this._process_xml_row,
							_locator: this._get_xml_data
						};
						var c = this.rowsBuffer.length;
						if (this._refresh_mode[1] == "top") {
							this.rowsBuffer.unshift(o);
							c = 0
						} else {
							this.rowsBuffer.push(o)
						}
						if (this._h2) {
							reset = true;
							(this._h2.add(a, (r.parentNode.getAttribute("id") || r.parentNode.getAttribute("parent")))).buff = this.rowsBuffer[this.rowsBuffer.length - 1]
						} else {
							if (this._srnd) {
								reset = true
							}
						}
						this.rowsAr[a] = r;
						r = this.render_row(c);
						this._insertRowAt(r, c ? -1 : 0)
					}
				}
			}
		}
		if (this._refresh_mode[2]) {
			for (a in q) {
				if (q[a] && this.rowsAr[a]) {
					this.deleteRow(a)
				}
			}
		}
		this._refresh_mode = null;
		if (window.eXcell_tree) {
			eXcell_tree.prototype.setValue = eXcell_tree.prototype.setValueX
		}
		
		//modify code by zzm 20160826
		if (window.eXcell_treero) {
			eXcell_treero.prototype.setValue = eXcell_treero.prototype.setValueX
		}
		
		
		if (reset) {
			if (this._h2) {
				this._renderSort()
			} else {
				this.render_dataset()
			}
		}
		if (this._f_rowsBuffer) {
			this._f_rowsBuffer = null;
			this.filterByAll()
		}
	},
	getCustomCombo: function(g, c) {
		var a = this.cells(g, c).cell;
		if (!a._combo) {
			a._combo = new dhtmlXGridComboObject()
		}
		return a._combo
	},
	setTabOrder: function(c) {
		var l = c.split(this.delim);
		this._tabOrder = [];
		var a = this._cCount || c.length;
		for (var g = 0; g < a; g++) {
			l[g] = {
				c: parseInt(l[g]),
				ind: g
			}
		}
		l.sort(function(n, m) {
			return (n.c > m.c ? 1 : -1)
		});
		for (var g = 0; g < a; g++) {
			if (!l[g + 1] || (typeof l[g].c == "undefined")) {
				this._tabOrder[l[g].ind] = (l[0].ind + 1) * -1
			} else {
				this._tabOrder[l[g].ind] = l[g + 1].ind
			}
		}
	},
	i18n: {
		loading: "Loading",
		decimal_separator: ".",
		group_separator: ","
	},
	_key_events: {
		k13_1_0: function() {
			var a = this.rowsCol._dhx_find(this.row);
			this.selectCell(this.rowsCol[a + 1], this.cell._cellIndex, true)
		},
		k13_0_1: function() {
			var a = this.rowsCol._dhx_find(this.row);
			this.selectCell(this.rowsCol[a - 1], this.cell._cellIndex, true)
		},
		k13_0_0: function() {
			this.editStop();
			this.callEvent("onEnter", [(this.row ? this.row.idd : null), (this.cell ? this.cell._cellIndex : null)]);
			this._still_active = true
		},
		k9_0_0: function() {
			this.editStop();
			if (!this.callEvent("onTab", [true])) {
				return true
			}
			var a = this._getNextCell(null, 1);
			if (a) {
				this.selectCell(a.parentNode, a._cellIndex, (this.row != a.parentNode), false, true);
				this._still_active = true
			}
		},
		k9_0_1: function() {
			this.editStop();
			if (!this.callEvent("onTab", [false])) {
				return false
			}
			var a = this._getNextCell(null, -1);
			if (a) {
				this.selectCell(a.parentNode, a._cellIndex, (this.row != a.parentNode), false, true);
				this._still_active = true
			}
		},
		k113_0_0: function() {
			if (this._f2kE) {
				this.editCell()
			}
		},
		k32_0_0: function() {
			var a = this.cells4(this.cell);
			if (!a.changeState || (a.changeState() === false)) {
				return false
			}
		},
		k27_0_0: function() {
			this.editStop(true)
		},
		k33_0_0: function() {
			if (this.pagingOn) {
				this.changePage(this.currentPage - 1)
			} else {
				this.scrollPage(-1)
			}
		},
		k34_0_0: function() {
			if (this.pagingOn) {
				this.changePage(this.currentPage + 1)
			} else {
				this.scrollPage(1)
			}
		},
		k37_0_0: function() {
			if (!this.editor && this.isTreeGrid()) {
				this.collapseKids(this.row)
			} else {
				return false
			}
		},
		k39_0_0: function() {
			if (!this.editor && this.isTreeGrid()) {
				this.expandKids(this.row)
			} else {
				return false
			}
		},
		k40_0_0: function() {
			var c = this._realfake ? this._fake : this;
			if (this.editor && this.editor.combo) {
				this.editor.shiftNext()
			} else {
				if (!this.row.idd) {
					return
				}
				var a = Math.max((c._r_select || 0), this.getRowIndex(this.row.idd));
				var g = this._nextRow(a, 1);
				if (g) {
					c._r_select = null;
					this.selectCell(g, this.cell._cellIndex, true);
					if (c.pagingOn) {
						c.showRow(g.idd)
					}
				} else {
					if (!this.callEvent("onLastRow", [])) {
						return false
					}
					this._key_events.k34_0_0.apply(this, []);
					if (this.pagingOn && this.rowsCol[a + 1]) {
						this.selectCell(a + 1, 0, true)
					}
				}
			}
			this._still_active = true
		},
		k38_0_0: function() {
			var c = this._realfake ? this._fake : this;
			if (this.editor && this.editor.combo) {
				this.editor.shiftPrev()
			} else {
				if (!this.row.idd) {
					return
				}
				var a = this.getRowIndex(this.row.idd) + 1;
				if (a != -1 && (!this.pagingOn || (a != 1))) {
					var g = this._nextRow(a - 1, -1);
					this.selectCell(g, this.cell._cellIndex, true);
					if (c.pagingOn && g) {
						c.showRow(g.idd)
					}
				} else {
					this._key_events.k33_0_0.apply(this, [])
				}
			}
			this._still_active = true
		}
	},
	_build_master_row: function() {
		var g = document.createElement("DIV");
		var c = ["<table><tr>"];
		for (var a = 0; a < this._cCount; a++) {
			c.push("<td></td>")
		}
		c.push("</tr></table>");
		g.innerHTML = c.join("");
		this._master_row = g.firstChild.rows[0]
	},
	_prepareRow: function(a) {
		if (!this._master_row) {
			this._build_master_row()
		}
		var g = this._master_row.cloneNode(true);
		for (var c = 0; c < g.childNodes.length; c++) {
			g.childNodes[c]._cellIndex = c;
			if (this._enbCid) {
				g.childNodes[c].id = "c_" + a + "_" + c
			}
			if (this.dragAndDropOff) {
				this.dragger.addDraggableItem(g.childNodes[c], this)
			}
		}
		g.idd = a;
		g.grid = this;
		return g
	},
	_process_jsarray_row: function(c, g) {
		c._attrs = {};
		for (var a = 0; a < c.childNodes.length; a++) {
			c.childNodes[a]._attrs = {}
		}
		this._fillRow(c, (this._c_order ? this._swapColumns(g) : g));
		return c
	},
	_get_jsarray_data: function(c, a) {
		return c[a]
	},
	_process_json_row: function(a, c) {
		c = this._c_order ? this._swapColumns(c.data) : c.data;
		return this._process_some_row(a, c)
	},
	_process_some_row: function(c, g) {
		c._attrs = {};
		for (var a = 0; a < c.childNodes.length; a++) {
			c.childNodes[a]._attrs = {}
		}
		this._fillRow(c, g);
		return c
	},
	_get_json_data: function(c, a) {
		return c.data[a]
	},
	_process_js_row: function(g, l) {
		var a = [];
		for (var c = 0; c < this.columnIds.length; c++) {
			a[c] = l[this.columnIds[c]];
			if (!a[c] && a[c] !== 0) {
				a[c] = ""
			}
		}
		this._process_some_row(g, a);
		g._attrs = l;
		return g
	},
	_get_js_data: function(c, a) {
		return c[this.columnIds[a]]
	},
	_process_csv_row: function(c, g) {
		c._attrs = {};
		for (var a = 0; a < c.childNodes.length; a++) {
			c.childNodes[a]._attrs = {}
		}
		this._fillRow(c, (this._c_order ? this._swapColumns(g.split(this.csv.cell)) : g.split(this.csv.cell)));
		return c
	},
	_get_csv_data: function(c, a) {
		return c.split(this.csv.cell)[a]
	},
	_process_store_row: function(m, l) {
		var a = [];
		for (var g = 0; g < this.columnIds.length; g++) {
			a[g] = l[this.columnIds[g]]
		}
		for (var c = 0; c < m.childNodes.length; c++) {
			m.childNodes[c]._attrs = {}
		}
		m._attrs = l;
		this._fillRow(m, a)
	},
	_process_xml_row: function(a, n) {
		var v = dhx4.ajax.xpath(this.xml.cell, n);
		var s = [];
		a._attrs = this._xml_attrs(n);
		if (this._ud_enabled) {
			var u = dhx4.ajax.xpath("./userdata", n);
			for (var m = u.length - 1; m >= 0; m--) {
				var q = "";
				for (var g = 0; g < u[m].childNodes.length; g++) {
					q += u[m].childNodes[g].nodeValue
				}
				this.setUserData(a.idd, u[m].getAttribute("name"), q)
			}
		}
		for (var g = 0; g < v.length; g++) {
			var l = v[this._c_order ? this._c_order[g] : g];
			if (!l) {
				continue
			}
			var c = a._childIndexes ? a._childIndexes[g] : g;
			var o = l.getAttribute("type");
			if (a.childNodes[c]) {
				if (o) {
					a.childNodes[c]._cellType = o
				}
				a.childNodes[c]._attrs = this._xml_attrs(l)
			}
			if (!l.getAttribute("xmlcontent")) {
				if (l.firstChild) {
					l = l.firstChild.data
				} else {
					l = ""
				}
			}
			s.push(l)
		}
		for (g < v.length; g < a.childNodes.length; g++) {
			a.childNodes[g]._attrs = {}
		}
		if (a.parentNode && a.parentNode.tagName == "row") {
			a._attrs.parent = a.parentNode.getAttribute("idd")
		}
		this._fillRow(a, s);
		return a
	},
	_get_xml_data: function(c, a) {
		c = c.firstChild;
		while (true) {
			if (!c) {
				return ""
			}
			if (c.tagName == "cell") {
				a--
			}
			if (a < 0) {
				break
			}
			c = c.nextSibling
		}
		return (c.firstChild ? c.firstChild.data : "")
	},
	_fillRow: function(l, n) {
		if (this.editor && this.editor.parentNode && this.editor.parentNode.idd == l.idd) {
			this.editStop()
		}
		for (var c = 0; c < l.childNodes.length; c++) {
			if ((c < n.length) || (this.defVal[c])) {
				var g = l.childNodes[c]._cellIndex;
				var m = n[g];
				var a = this.cells4(l.childNodes[c]);
				if ((this.defVal[g]) && ((m == "") || (typeof(m) == "undefined"))) {
					m = this.defVal[g]
				}
				if (a) {
					a.setValue(m)
				}
			} else {
				l.childNodes[c].innerHTML = "&nbsp;";
				l.childNodes[c]._clearCell = true
			}
		}
		return l
	},
	_postRowProcessing: function(n, q) {
		if (n._attrs["class"]) {
			n._css = n.className = n._attrs["class"]
		}
		if (n._attrs.locked) {
			n._locked = true
		}
		if (n._attrs.bgColor) {
			n.bgColor = n._attrs.bgColor
		}
		var o = 0;
		for (var g = 0; g < n.childNodes.length; g++) {
			var u = n.childNodes[g];
			var m = u._cellIndex;
			var l = u._attrs.style || n._attrs.style;
			if (l) {
				u.style.cssText += ";" + l
			}
			if (u._attrs["class"]) {
				u.className = u._attrs["class"]
			}
			l = u._attrs.align || this.cellAlign[m];
			if (l) {
				u.align = l
			}
			u.vAlign = u._attrs.valign || this.cellVAlign[m];
			var a = u._attrs.bgColor || this.columnColor[m];
			if (a) {
				u.bgColor = a
			}
			if (u._attrs.colspan && !q) {
				this.setColspan(n.idd, g + o, u._attrs.colspan);
				o += (u._attrs.colspan - 1)
			}
			if (this._hrrar && this._hrrar[m] && !q) {
				u.style.display = "none"
			}
		}
		this.callEvent("onRowCreated", [n.idd, n, null])
	},
	load: function(a, g, c) {
		this.callEvent("onXLS", [this]);
		if (arguments.length == 2 && typeof g != "function") {
			c = g;
			g = null
		}
		c = c || "xml";
		if (!this.xmlFileUrl) {
			this.xmlFileUrl = a
		}
		this._data_type = c;
		this.xmlLoader = this.doLoadDetails;
		var l = this;
		this.xmlLoader = function(m) {
			if (!l.callEvent) {
				return
			}
			l["_process_" + c](m.xmlDoc);
			if (!l._contextCallTimer) {
				l.callEvent("onXLE", [l, 0, 0, m.xmlDoc])
			}
			if (g) {
				g();
				g = null
			}
		};
		return dhx4.ajax.get(a, this.xmlLoader)
	},
	loadXMLString: function(c, a) {
		this.parse({
			responseXML: dhx4.ajax.parse(c)
		}, a, "xml")
	},
	loadXML: function(a, c) {
		this.load(a, c, "xml")
	},
	parse: function(g, c, a) {
		if (arguments.length == 2 && typeof c != "function") {
			a = c;
			c = null
		}
		a = a || "xml";
		this._data_type = a;
		if (a == "xml" && typeof g == "string") {
			g = {
				responseXML: dhx4.ajax.parse(g)
			}
		}
		this["_process_" + a](g);
		if (!this._contextCallTimer) {
			this.callEvent("onXLE", [this, 0, 0, g])
		}
		if (c) {
			c()
		}
	},
	xml: {
		top: "rows",
		row: "./row",
		cell: "./cell",
		s_row: "row",
		s_cell: "cell",
		row_attrs: [],
		cell_attrs: []
	},
	csv: {
		row: "\n",
		cell: ","
	},
	_xml_attrs: function(c) {
		var g = {};
		if (c.attributes.length) {
			for (var a = 0; a < c.attributes.length; a++) {
				g[c.attributes[a].name] = c.attributes[a].value
			}
		}
		return g
	},
	_process_xml: function(r) {
		if (this._refresh_mode) {
			return this._refreshFromXML(r)
		}
		this._parsing = true;
		var n = dhx4.ajax.xmltop(this.xml.top, r);
		if (n.tagName != this.xml.top) {
			return
		}
		var q = n.getAttribute("dhx_security");
		if (q) {
			dhtmlx.security_key = q
		}
		this._parseHead(n);
		var s = dhx4.ajax.xpath(this.xml.row, n);
		var m = parseInt(n.getAttribute("pos") || 0);
		var o = parseInt(n.getAttribute("total_count") || 0);
		if (!this.pagingOn) {
			var o = Math.min(o, 32000000 / this._srdh)
		}
		var l = false;
		if (o && o != this.rowsBuffer.length) {
			if (!this.rowsBuffer[o - 1]) {
				if (this.rowsBuffer.length) {
					l = true
				}
				this.rowsBuffer[o - 1] = null
			}
			if (o < this.rowsBuffer.length) {
				this.rowsBuffer.splice(o, this.rowsBuffer.length - o);
				l = true
			}
		}
		if (this.isTreeGrid()) {
			return this._process_tree_xml(n)
		}
		for (var c = 0; c < s.length; c++) {
			if (this.rowsBuffer[c + m]) {
				continue
			}
			var a = s[c].getAttribute("id") || (c + m + 1);
			this.rowsBuffer[c + m] = {
				idd: a,
				data: s[c],
				_parser: this._process_xml_row,
				_locator: this._get_xml_data
			};
			this.rowsAr[a] = s[c]
		}
		this.callEvent("onDataReady", []);
		if (l && this._srnd) {
			var g = this.objBox.scrollTop;
			this._reset_view();
			this.objBox.scrollTop = g
		} else {
			this.render_dataset()
		}
		this._parsing = false
	},
	_process_jsarray: function(data) {
		this._parsing = true;
		data = data.responseText || data;
		if (typeof data == "string") {
			eval("dhtmlx.temp=" + data + ";");
			data = dhtmlx.temp
		}
		for (var i = 0; i < data.length; i++) {
			var id = i + 1;
			this.rowsBuffer.push({
				idd: id,
				data: data[i],
				_parser: this._process_jsarray_row,
				_locator: this._get_jsarray_data
			});
			this.rowsAr[id] = data[i]
		}
		this.render_dataset();
		this._parsing = false
	},
	_process_csv: function(l) {
		this._parsing = true;
		l = l.responseText || l;
		l = l.replace(/\r/g, "");
		l = l.split(this.csv.row);
		if (this._csvHdr) {
			this.clearAll();
			var g = l.splice(0, 1)[0].split(this.csv.cell);
			if (!this._csvAID) {
				g.splice(0, 1)
			}
			this.setHeader(g.join(this.delim));
			this.init()
		}
		for (var c = 0; c < l.length; c++) {
			if (!l[c] && c == l.length - 1) {
				continue
			}
			if (this._csvAID) {
				var m = c + 1;
				this.rowsBuffer.push({
					idd: m,
					data: l[c],
					_parser: this._process_csv_row,
					_locator: this._get_csv_data
				})
			} else {
				var a = l[c].split(this.csv.cell);
				var m = a.splice(0, 1)[0];
				this.rowsBuffer.push({
					idd: m,
					data: a,
					_parser: this._process_jsarray_row,
					_locator: this._get_jsarray_data
				})
			}
			this.rowsAr[m] = l[c]
		}
		this.render_dataset();
		this._parsing = false
	},
	_process_js: function(a) {
		return this._process_json(a, "js")
	},
	_process_json: function(data, mode) {
		this._parsing = true;
		var data = data.responseText || data;
		if (typeof data == "string") {
			eval("dhtmlx.temp=" + data + ";");
			data = dhtmlx.temp
		}
		if (mode == "js") {
			if (data.data) {
				data = data.data
			}
			for (var i = 0; i < data.length; i++) {
				var row = data[i];
				var id = row.id || (i + 1);
				this.rowsBuffer.push({
					idd: id,
					data: row,
					_parser: this._process_js_row,
					_locator: this._get_js_data
				});
				this.rowsAr[id] = data[i]
			}
		} else {
			for (var i = 0; i < data.rows.length; i++) {
				var id = data.rows[i].id;
				this.rowsBuffer.push({
					idd: id,
					data: data.rows[i],
					_parser: this._process_json_row,
					_locator: this._get_json_data
				});
				this.rowsAr[id] = data.rows[i]
			}
		}
		if (data.dhx_security) {
			dhtmlx.security_key = data.dhx_security
		}
		this.callEvent("onDataReady", []);
		this.render_dataset();
		this._parsing = false
	},
	render_dataset: function(l, a) {
		if (this._srnd) {
			if (this._fillers) {
				return this._update_srnd_view()
			}
			a = Math.min((this._get_view_size() + (this._srnd_pr || 0)), this.rowsBuffer.length)
		}
		if (this.pagingOn) {
			l = Math.max((l || 0), (this.currentPage - 1) * this.rowsBufferOutSize);
			a = Math.min(this.currentPage * this.rowsBufferOutSize, this.rowsBuffer.length)
		} else {
			l = l || 0;
			a = a || this.rowsBuffer.length
		}
		for (var g = l; g < a; g++) {
			var n = this.render_row(g);
			if (n == -1) {
				if (this.xmlFileUrl) {
					if (this.callEvent("onDynXLS", [g, (this._dpref ? this._dpref : (a - g))])) {
						this.load(this.xmlFileUrl + dhtmlx.url(this.xmlFileUrl) + "posStart=" + g + "&count=" + (this._dpref ? this._dpref : (a - g)), this._data_type)
					}
				}
				a = g;
				break
			}
			if (!n.parentNode || !n.parentNode.tagName) {
				this._insertRowAt(n, g);
				if (n._attrs.selected || n._attrs.select) {
					this.selectRow(n, n._attrs.call ? true : false, true);
					n._attrs.selected = n._attrs.select = null
				}
			}
			if (this._ads_count && g - l == this._ads_count) {
				var m = this;
				this._context_parsing = this._context_parsing || this._parsing;
				return this._contextCallTimer = window.setTimeout(function() {
					m._contextCallTimer = null;
					m.render_dataset(g, a);
					if (!m._contextCallTimer) {
						if (m._context_parsing) {
							m.callEvent("onXLE", [])
						} else {
							m._fixAlterCss()
						}
						m.callEvent("onDistributedEnd", []);
						m._context_parsing = false
					}
				}, this._ads_time)
			}
		}
		if (this._ads_count && g == a) {
			this.callEvent("onDistributedEnd", [])
		}
		if (this._srnd && !this._fillers) {
			var c = this.rowsBuffer.length - a;
			this._fillers = [];
			if (this._fake && !this._realfake) {
				this._fake._fillers = []
			}
			while (c > 0) {
				var q = (_isIE || window._FFrv) ? Math.min(c, 50000) : c;
				var o = this._add_filler(a, q);
				if (o) {
					this._fillers.push(o)
				}
				c -= q;
				a += q
			}
		}
		this.setSizes()
	},
	render_row: function(c) {
		if (!this.rowsBuffer[c]) {
			return -1
		}
		if (this.rowsBuffer[c]._parser) {
			var a = this.rowsBuffer[c];
			if (this.rowsAr[a.idd] && this.rowsAr[a.idd].tagName == "TR") {
				return this.rowsBuffer[c] = this.rowsAr[a.idd]
			}
			var g = this._prepareRow(a.idd);
			this.rowsBuffer[c] = g;
			this.rowsAr[a.idd] = g;
			a._parser.call(this, g, a.data);
			this._postRowProcessing(g);
			return g
		}
		return this.rowsBuffer[c]
	},
	_get_cell_value: function(c, a, g) {
		if (c._locator) {
			if (this._c_order) {
				a = this._c_order[a]
			}
			return c._locator.call(this, c.data, a)
		}
		return this.cells3(c, a)[g ? g : "getValue"]()
	},
	sortRows: function(g, n, c) {
		this.editStop();
		c = (c || "asc").toLowerCase();
		n = (n || this.fldSort[g]);
		g = g || 0;
		if (this.isTreeGrid()) {
			this.sortTreeRows(g, n, c)
		} else {
			var a = {};
			var m = this.cellType[g];
			var o = "getValue";
			if (m == "link") {
				o = "getContent"
			}
			if (m == "dhxCalendar" || m == "dhxCalendarA") {
				o = "getDate"
			}
			for (var l = 0; l < this.rowsBuffer.length; l++) {
				a[this.rowsBuffer[l].idd] = this._get_cell_value(this.rowsBuffer[l], g, o)
			}
			this._sortRows(g, n, c, a)
		}
		this.callEvent("onAfterSorting", [g, n, c])
	},
	_sortCore: function(g, n, c, a, m) {
		var l = "sort";
		if (this._sst) {
			m.stablesort = this.rowsCol.stablesort;
			l = "stablesort"
		}
		if (n.length > 4) {
			n = window[n]
		}
		if (n == "cus") {
			var o = this._customSorts[g];
			m[l](function(r, q) {
				return o(a[r.idd], a[q.idd], c, r.idd, q.idd)
			})
		} else {
			if (typeof(n) == "function") {
				m[l](function(r, q) {
					return n(a[r.idd], a[q.idd], c, r.idd, q.idd)
				})
			} else {
				if (n == "str") {
					m[l](function(r, q) {
						if (c == "asc") {
							return a[r.idd] > a[q.idd] ? 1 : (a[r.idd] < a[q.idd] ? -1 : 0)
						} else {
							return a[r.idd] < a[q.idd] ? 1 : (a[r.idd] > a[q.idd] ? -1 : 0)
						}
					})
				} else {
					if (n == "int") {
						m[l](function(s, r) {
							var q = parseFloat(a[s.idd]);
							q = isNaN(q) ? -99999999999999 : q;
							var u = parseFloat(a[r.idd]);
							u = isNaN(u) ? -99999999999999 : u;
							if (c == "asc") {
								return q - u
							} else {
								return u - q
							}
						})
					} else {
						if (n == "date") {
							m[l](function(s, r) {
								var q = Date.parse(a[s.idd]) || (Date.parse("01/01/1900"));
								var u = Date.parse(a[r.idd]) || (Date.parse("01/01/1900"));
								if (c == "asc") {
									return q - u
								} else {
									return u - q
								}
							})
						}
					}
				}
			}
		}
	},
	_sortRows: function(g, l, c, a) {
		this._sortCore(g, l, c, a, this.rowsBuffer);
		this._reset_view();
		this.callEvent("onGridReconstructed", [])
	},
	_reset_view: function(g) {
		if (!this.obj.rows[0]) {
			return
		}
		if (this._lahRw) {
			this._unsetRowHover(0, true)
		}
		this.callEvent("onResetView", []);
		var a = this.obj.rows[0].parentNode;
		var l = a.removeChild(a.childNodes[0], true);
		if (_isKHTML) {
			for (var c = a.parentNode.childNodes.length - 1; c >= 0; c--) {
				if (a.parentNode.childNodes[c].tagName == "TR") {
					a.parentNode.removeChild(a.parentNode.childNodes[c], true)
				}
			}
		} else {
			if (_isIE) {
				for (var c = a.childNodes.length - 1; c >= 0; c--) {
					a.childNodes[c].removeNode(true)
				}
			} else {
				a.innerHTML = ""
			}
		}
		a.appendChild(l);
		this.rowsCol = dhtmlxArray();
		if (this._sst) {
			this.enableStableSorting(true)
		}
		this._fillers = this.undefined;
		if (!g) {
			if (_isIE && this._srnd) {
				this.render_dataset()
			} else {
				this.render_dataset()
			}
		}
	},
	deleteRow: function(c, l) {
		if (!l) {
			l = this.getRowById(c)
		}
		if (!l) {
			return
		}
		this.editStop();
		if (!this._realfake) {
			if (this.callEvent("onBeforeRowDeleted", [c]) == false) {
				return false
			}
		}
		var a = 0;
		if (this.cellType._dhx_find("tree") != -1 && !this._realfake) {
			a = this._h2.get[c].parent.id;
			this._removeTrGrRow(l)
		} else {
			if (l.parentNode) {
				l.parentNode.removeChild(l)
			}
			var n = this.rowsCol._dhx_find(l);
			if (n != -1) {
				this.rowsCol._dhx_removeAt(n)
			}
			for (var g = 0; g < this.rowsBuffer.length; g++) {
				if (this.rowsBuffer[g] && this.rowsBuffer[g].idd == c) {
					this.rowsBuffer._dhx_removeAt(g);
					n = g;
					break
				}
			}
		}
		this.rowsAr[c] = null;
		for (var g = 0; g < this.selectedRows.length; g++) {
			if (this.selectedRows[g].idd == c) {
				this.selectedRows._dhx_removeAt(g)
			}
		}
		if (this._srnd) {
			for (var g = 0; g < this._fillers.length; g++) {
				var m = this._fillers[g];
				if (!m) {
					continue
				}
				if (m[0] >= n) {
					this._update_fillers(g, 0, -1)
				} else {
					if (m[0] + m[1] > n) {
						this._update_fillers(g, -1, 0)
					}
				}
			}
			this._update_srnd_view()
		}
		if (this.pagingOn) {
			this.changePage()
		}
		if (!this._realfake) {
			this.callEvent("onAfterRowDeleted", [c, a])
		}
		this.callEvent("onGridReconstructed", []);
		if (this._ahgr) {
			this.setSizes()
		}
		return true
	},
	_addRow: function(n, o, c) {
		if (c == -1 || typeof c == "undefined") {
			c = this.rowsBuffer.length
		}
		if (typeof o == "string") {
			o = o.split(this.delim)
		}
		var q = this._prepareRow(n);
		q._attrs = {};
		for (var g = 0; g < q.childNodes.length; g++) {
			q.childNodes[g]._attrs = {}
		}
		this.rowsAr[q.idd] = q;
		if (this._h2) {
			this._h2.get[q.idd].buff = q
		}
		this._fillRow(q, o);
		this._postRowProcessing(q);
		if (this._skipInsert) {
			this._skipInsert = false;
			return this.rowsAr[q.idd] = q
		}
		if (this.pagingOn) {
			this.rowsBuffer._dhx_insertAt(c, q);
			this.rowsAr[q.idd] = q;
			return q
		}
		if (this._fillers) {
			this.rowsCol._dhx_insertAt(c, null);
			this.rowsBuffer._dhx_insertAt(c, q);
			if (this._fake) {
				this._fake.rowsCol._dhx_insertAt(c, null)
			}
			this.rowsAr[q.idd] = q;
			var r = false;
			for (var l = 0; l < this._fillers.length; l++) {
				var m = this._fillers[l];
				if (m && m[0] <= c && (m[0] + m[1]) >= c) {
					m[1] = m[1] + 1;
					var a = m[2].firstChild.style.height = parseInt(m[2].firstChild.style.height) + this._srdh + "px";
					r = true;
					if (this._fake) {
						this._fake._fillers[l][1]++;
						this._fake._fillers[l][2].firstChild.style.height = a
					}
				}
				if (m && m[0] > c) {
					m[0] = m[0] + 1;
					if (this._fake) {
						this._fake._fillers[l][0]++
					}
				}
			}
			if (!r) {
				this._fillers.push(this._add_filler(c, 1, (c == 0 ? {
					parentNode: this.obj.rows[0].parentNode,
					nextSibling: (this.rowsCol[1])
				} : this.rowsCol[c - 1])))
			}
			return q
		}
		this.rowsBuffer._dhx_insertAt(c, q);
		return this._insertRowAt(q, c)
	},
	addRow: function(a, l, g) {
		var c = this._addRow(a, l, g);
		if (!this.dragContext) {
			this.callEvent("onRowAdded", [a])
		}
		if (this.pagingOn) {
			this.changePage(this.currentPage)
		}
		if (this._srnd) {
			this._update_srnd_view()
		}
		c._added = true;
		if (this._ahgr) {
			this.setSizes()
		}
		this.callEvent("onGridReconstructed", []);
		return c
	},
	_insertRowAt: function(g, l, c) {
		this.rowsAr[g.idd] = g;
		if (this._skipInsert) {
			this._skipInsert = false;
			return g
		}
		if ((l < 0) || ((!l) && (parseInt(l) !== 0))) {
			l = this.rowsCol.length
		} else {
			if (l > this.rowsCol.length) {
				l = this.rowsCol.length
			}
		}
		if (this._cssEven) {
			var a = g.className.replace(this._cssUnEven, "");
			if ((this._cssSP ? this.getLevel(g.idd) : l) % 2 == 1) {
				g.className = a + " " + this._cssUnEven + (this._cssSU ? (" " + this._cssUnEven + "_" + this.getLevel(g.idd)) : "")
			} else {
				g.className = a + " " + this._cssEven + (this._cssSU ? (" " + this._cssEven + "_" + this.getLevel(g.idd)) : "")
			}
		}
		if (!c) {
			if ((l == (this.obj.rows.length - 1)) || (!this.rowsCol[l])) {
				if (_isKHTML) {
					this.obj.appendChild(g)
				} else {
					this.obj.firstChild.appendChild(g)
				}
			} else {
				this.rowsCol[l].parentNode.insertBefore(g, this.rowsCol[l])
			}
		}
		this.rowsCol._dhx_insertAt(l, g);
		this.callEvent("onRowInserted", [g, l]);
		return g
	},
	getRowById: function(g) {
		var c = this.rowsAr[g];
		if (c) {
			if (c.tagName != "TR") {
				for (var a = 0; a < this.rowsBuffer.length; a++) {
					if (this.rowsBuffer[a] && this.rowsBuffer[a].idd == g) {
						return this.render_row(a)
					}
				}
				if (this._h2) {
					return this.render_row(null, c.idd)
				}
			}
			return c
		}
		return null
	},
	cellById: function(c, a) {
		return this.cells(c, a)
	},
	cells: function(l, g) {
		if (arguments.length == 0) {
			return this.cells4(this.cell)
		} else {
			var m = this.getRowById(l)
		}
		var a = (m._childIndexes ? m.childNodes[m._childIndexes[g]] : m.childNodes[g]);
		if (!a && m._childIndexes) {
			a = m.firstChild || {}
		}
		return this.cells4(a)
	},
	cellByIndex: function(c, a) {
		return this.cells2(c, a)
	},
	cells2: function(l, g) {
		var m = this.render_row(l);
		var a = (m._childIndexes ? m.childNodes[m._childIndexes[g]] : m.childNodes[g]);
		if (!a && m._childIndexes) {
			a = m.firstChild || {}
		}
		return this.cells4(a)
	},
	cells3: function(g, c) {
		var a = (g._childIndexes ? g.childNodes[g._childIndexes[c]] : g.childNodes[c]);
		return this.cells4(a)
	},
	cells4: function(a) {
		var c = window["eXcell_" + (a._cellType || this.cellType[a._cellIndex])];
		if (c) {
			return new c(a)
		}
	},
	cells5: function(a, g) {
		var g = g || (a._cellType || this.cellType[a._cellIndex]);
		if (!this._ecache[g]) {
			if (!window["eXcell_" + g]) {
				var c = eXcell_ro
			} else {
				var c = window["eXcell_" + g]
			}
			this._ecache[g] = new c(a)
		}
		this._ecache[g].cell = a;
		return this._ecache[g]
	},
	dma: function(a) {
		if (!this._ecache) {
			this._ecache = {}
		}
		if (a && !this._dma) {
			this._dma = this.cells4;
			this.cells4 = this.cells5
		} else {
			if (!a && this._dma) {
				this.cells4 = this._dma;
				this._dma = null
			}
		}
	},
	getRowsNum: function() {
		return this.rowsBuffer.length
	},
	enableEditTabOnly: function(a) {
		if (arguments.length > 0) {
			this.smartTabOrder = dhx4.s2b(a)
		} else {
			this.smartTabOrder = true
		}
	},
	setExternalTabOrder: function(m, a) {
		var c = this;
		this.tabStart = (typeof(m) == "object") ? m : document.getElementById(m);
		var g = this.tabStart.onkeydown;
		this.tabStart.onkeydown = function(o) {
			if (g) {
				g.call(this, o)
			}
			var n = (o || window.event);
			if (n.keyCode == 9 && !n.shiftKey) {
				n.cancelBubble = true;
				c.selectCell(0, 0, 0, 0, 1);
				if (c.smartTabOrder && c.cells2(0, 0).isDisabled()) {
					c._key_events.k9_0_0.call(c)
				}
				this.blur();
				return false
			}
		};
		if (_isOpera) {
			this.tabStart.onkeypress = this.tabStart.onkeydown
		}
		this.tabEnd = (typeof(a) == "object") ? a : document.getElementById(a);
		var l = this.tabEnd.onkeydown;
		this.tabEnd.onkeydown = this.tabEnd.onkeypress = function(o) {
			if (l) {
				l.call(this, o)
			}
			var n = (o || window.event);
			if (n.keyCode == 9 && n.shiftKey) {
				n.cancelBubble = true;
				c.selectCell((c.getRowsNum() - 1), (c.getColumnCount() - 1), 0, 0, 1);
				if (c.smartTabOrder && c.cells2((c.getRowsNum() - 1), (c.getColumnCount() - 1)).isDisabled()) {
					c._key_events.k9_0_1.call(c)
				}
				this.blur();
				return false
			}
		};
		if (_isOpera) {
			this.tabEnd.onkeypress = this.tabEnd.onkeydown
		}
	},
	uid: function() {
		if (!this._ui_seed) {
			this._ui_seed = (new Date()).valueOf()
		}
		return this._ui_seed++
	},
	clearAndLoad: function() {
		var a = this._pgn_skin;
		this._pgn_skin = null;
		this.clearAll();
		this._pgn_skin = a;
		this.load.apply(this, arguments)
	},
	getStateOfView: function() {
		if (this.pagingOn) {
			var a = (this.currentPage - 1) * this.rowsBufferOutSize;
			return [this.currentPage, a, Math.min(a + this.rowsBufferOutSize, this.rowsBuffer.length), this.rowsBuffer.length]
		}
		return [Math.floor(this.objBox.scrollTop / this._srdh), Math.ceil(parseInt(this.objBox.offsetHeight) / this._srdh), this.rowsBuffer.length]
	}
};
(function() {
	function l(o, q) {
		this[o] = q
	}

	function n(o, q) {
		this[o].call(this, q)
	}

	function g(o, q) {
		this[o].call(this, q.join(this.delim))
	}

	function a(o, s) {
		for (var r = 0; r < s.length; r++) {
			if (typeof s[r] == "object") {
				var u = this.getCombo(r);
				for (var q in s[r]) {
					u.put(q, s[r][q])
				}
			}
		}
	}

	function m(o, x, s) {
		var A = 1;
		var w = [];

		function y(D, C, E) {
			if (!w[C]) {
				w[C] = []
			}
			if (typeof E == "object") {
				E.toString = function() {
					return this.text
				}
			}
			w[C][D] = E
		}
		for (var u = 0; u < x.length; u++) {
			if (typeof(x[u]) == "object" && x[u].length) {
				for (var r = 0; r < x[u].length; r++) {
					y(u, r, x[u][r])
				}
			} else {
				y(u, 0, x[u])
			}
		}
		for (var u = 0; u < w.length; u++) {
			for (var r = 0; r < w[0].length; r++) {
				var v = w[u][r];
				w[u][r] = (v || "").toString() || "&nbsp;";
				if (v && v.colspan) {
					for (var q = 1; q < v.colspan; q++) {
						y(r + q, u, "#cspan")
					}
				}
				if (v && v.rowspan) {
					for (var q = 1; q < v.rowspan; q++) {
						y(r, u + q, "#rspan")
					}
				}
			}
		}
		this.setHeader(w[0]);
		for (var u = 1; u < w.length; u++) {
			this.attachHeader(w[u])
		}
	}
	var c = [{
		name: "label",
		def: "&nbsp;",
		operation: "setHeader",
		type: m
	}, {
		name: "id",
		def: "",
		operation: "columnIds",
		type: l
	}, {
		name: "width",
		def: "*",
		operation: "setInitWidths",
		type: g
	}, {
		name: "align",
		def: "left",
		operation: "cellAlign",
		type: l
	}, {
		name: "valign",
		def: "middle",
		operation: "cellVAlign",
		type: l
	}, {
		name: "sort",
		def: "na",
		operation: "fldSort",
		type: l
	}, {
		name: "type",
		def: "ro",
		operation: "setColTypes",
		type: g
	}, {
		name: "options",
		def: "",
		operation: "",
		type: a
	}];
	dhtmlx.extend_api("dhtmlXGridObject", {
		_init: function(o) {
			return [o.parent]
		},
		image_path: "setImagePath",
		columns: "columns",
		rows: "rows",
		headers: "headers",
		skin: "setSkin",
		smart_rendering: "enableSmartRendering",
		css: "enableAlterCss",
		auto_height: "enableAutoHeight",
		save_hidden: "enableAutoHiddenColumnsSaving",
		save_cookie: "enableAutoSaving",
		save_size: "enableAutoSizeSaving",
		auto_width: "enableAutoWidth",
		block_selection: "enableBlockSelection",
		csv_id: "enableCSVAutoID",
		csv_header: "enableCSVHeader",
		cell_ids: "enableCellIds",
		colspan: "enableColSpan",
		column_move: "enableColumnMove",
		context_menu: "enableContextMenu",
		distributed: "enableDistributedParsing",
		drag: "enableDragAndDrop",
		drag_order: "enableDragOrder",
		tabulation: "enableEditTabOnly",
		header_images: "enableHeaderImages",
		header_menu: "enableHeaderMenu",
		keymap: "enableKeyboardSupport",
		mouse_navigation: "enableLightMouseNavigation",
		markers: "enableMarkedCells",
		math_editing: "enableMathEditing",
		math_serialization: "enableMathSerialization",
		drag_copy: "enableMercyDrag",
		multiline: "enableMultiline",
		multiselect: "enableMultiselect",
		save_column_order: "enableOrderSaving",
		hover: "enableRowsHover",
		rowspan: "enableRowspan",
		smart: "enableSmartRendering",
		save_sorting: "enableSortingSaving",
		stable_sorting: "enableStableSorting",
		undo: "enableUndoRedo",
		csv_cell: "setCSVDelimiter",
		date_format: "setDateFormat",
		drag_behavior: "setDragBehavior",
		editable: "setEditable",
		without_header: "setNoHeader",
		submit_changed: "submitOnlyChanged",
		submit_serialization: "submitSerialization",
		submit_selected: "submitOnlySelected",
		submit_id: "submitOnlyRowID",
		xml: "load"
	}, {
		columns: function(u) {
			for (var o = 0; o < c.length; o++) {
				var s = [];
				for (var q = 0; q < u.length; q++) {
					s[q] = u[q][c[o].name] || c[o].def
				}
				var r = c[o].type || n;
				r.call(this, c[o].operation, s, u)
			}
			this.init()
		},
		rows: function(o) {},
		headers: function(q) {
			for (var o = 0; o < q.length; o++) {
				this.attachHeader(q[o])
			}
		}
	})
})();
dhtmlXGridObject.prototype._dp_init = function(a) {
	a.attachEvent("insertCallback", function(c, l) {
		if (this.obj._h2) {
			this.obj.addRow(l, g, null, parent)
		} else {
			this.obj.addRow(l, [], 0)
		}
		var g = this.obj.getRowById(l);
		if (g) {
			this.obj._process_xml_row(g, c.firstChild);
			this.obj._postRowProcessing(g)
		}
	});
	a.attachEvent("updateCallback", function(c, l) {
		var g = this.obj.getRowById(l);
		if (g) {
			this.obj._process_xml_row(g, c.firstChild);
			this.obj._postRowProcessing(g)
		}
	});
	a.attachEvent("deleteCallback", function(c, g) {
		this.obj.setUserData(g, this.action_param, "true_deleted");
		this.obj.deleteRow(g)
	});
	a._methods = ["setRowTextStyle", "setCellTextStyle", "changeRowId", "deleteRow"];
	this.attachEvent("onEditCell", function(l, m, g) {
		if (a._columns && !a._columns[g]) {
			return true
		}
		var c = this.cells(m, g);
		if (l == 1) {
			if (c.isCheckbox()) {
				a.setUpdated(m, true)
			}
		} else {
			if (l == 2) {
				if (c.wasChanged()) {
					a.setUpdated(m, true)
				}
			}
		}
		return true
	});
	this.attachEvent("onRowPaste", function(c) {
		a.setUpdated(c, true)
	});
	this.attachEvent("onUndo", function(c) {
		a.setUpdated(c, true)
	});
	this.attachEvent("onRowIdChange", function(l, c) {
		var g = a.findRow(l);
		if (g < a.updatedRows.length) {
			a.updatedRows[g] = c
		}
	});
	this.attachEvent("onSelectStateChanged", function(c) {
		if (a.updateMode == "row") {
			a.sendData()
		}
		return true
	});
	this.attachEvent("onEnter", function(g, c) {
		if (a.updateMode == "row") {
			a.sendData()
		}
		return true
	});
	this.attachEvent("onBeforeRowDeleted", function(c) {
		if (!this.rowsAr[c]) {
			return true
		}
		if (this.dragContext && a.dnd) {
			window.setTimeout(function() {
				a.setUpdated(c, true)
			}, 1);
			return true
		}
		var g = a.getState(c);
		if (this._h2) {
			this._h2.forEachChild(c, function(l) {
				a.setUpdated(l.id, false);
				a.markRow(l.id, true, "deleted")
			}, this)
		}
		if (g == "inserted") {
			a.set_invalid(c, false);
			a.setUpdated(c, false);
			return true
		}
		if (g == "deleted") {
			return false
		}
		if (g == "true_deleted") {
			a.setUpdated(c, false);
			return true
		}
		a.setUpdated(c, true, "deleted");
		return false
	});
	this.attachEvent("onBindUpdate", function(c) {
		if (typeof c == "object") {
			c = c.id
		}
		a.setUpdated(c, true)
	});
	this.attachEvent("onRowAdded", function(c) {
		if (this.dragContext && a.dnd) {
			return true
		}
		a.setUpdated(c, true, "inserted");
		return true
	});
	a._getRowData = function(l, v) {
		var o = [];
		o.gr_id = l;
		if (this.obj.isTreeGrid()) {
			o.gr_pid = this.obj.getParentId(l)
		}
		var g = this.obj.getRowById(l);
		for (var q = 0; q < this.obj._cCount; q++) {
			if (this.obj._c_order) {
				var s = this.obj._c_order[q]
			} else {
				var s = q
			}
			var u = this.obj.cells(g.idd, q);
			if (this._changed && !u.wasChanged()) {
				continue
			}
			if (this._endnm) {
				o[this.obj.getColumnId(q)] = u.getValue()
			} else {
				o["c" + s] = u.getValue()
			}
		}
		var m = this.obj.UserData[l];
		if (m) {
			for (var n = 0; n < m.keys.length; n++) {
				if (m.keys[n] && m.keys[n].indexOf("__") != 0) {
					o[m.keys[n]] = m.values[n]
				}
			}
		}
		var m = this.obj.UserData.gridglobaluserdata;
		if (m) {
			for (var n = 0; n < m.keys.length; n++) {
				o[m.keys[n]] = m.values[n]
			}
		}
		return o
	};
	a._clearUpdateFlag = function(g) {
		var l = this.obj.getRowById(g);
		if (l) {
			for (var c = 0; c < this.obj._cCount; c++) {
				this.obj.cells(g, c).cell.wasChanged = false
			}
		}
	};
	a.checkBeforeUpdate = function(n) {
		var m = true;
		var c = [];
		for (var l = 0; l < this.obj._cCount; l++) {
			if (this.mandatoryFields[l]) {
				var g = this.mandatoryFields[l].call(this.obj, this.obj.cells(n, l).getValue(), n, l);
				if (typeof g == "string") {
					this.messages.push(g);
					m = false
				} else {
					m &= g;
					c[l] = !g
				}
			}
		}
		if (!m) {
			this.set_invalid(n, "invalid", c);
			this.setUpdated(n, false)
		}
		return m
	}
};
dhx4.attachEvent("onGridCreated", function(c) {
	c._con_f_used = [].concat(c._con_f_used);
	dhtmlXGridObject.prototype._con_f_used = [];
	var a = function(n) {
		n = n.replace(/(\?|\&)connector[^\f]*/g, "");
		return n + (n.indexOf("?") != -1 ? "&" : "?") + "connector=true" + (this.hdr.rows.length > 0 ? "&dhx_no_header=1" : "")
	};
	var m = function(n) {
		return a.call(this, n) + (this._connector_sorting || "") + (this._connector_filter || "")
	};
	var l = function(o, q, n) {
		this._connector_sorting = "&dhx_sort[" + q + "]=" + n;
		return m.call(this, o)
	};
	var g = function(o, n, r) {
		var s = [];
		for (var q = 0; q < n.length; q++) {
			s[q] = "dhx_filter[" + n[q] + "]=" + encodeURIComponent(r[q])
		}
		this._connector_filter = "&" + s.join("&");
		return m.call(this, o)
	};
	c.attachEvent("onCollectValues", function(n) {
		if (this._con_f_used[n]) {
			if (typeof(this._con_f_used[n]) == "object") {
				return this._con_f_used[n]
			} else {
				return false
			}
		}
		return true
	});
	c.attachEvent("onDynXLS", function() {
		this.xmlFileUrl = m.call(this, this.xmlFileUrl);
		return true
	});
	c.attachEvent("onBeforeSorting", function(r, q, o) {
		if (q == "connector") {
			var n = this;
			this.clearAndLoad(l.call(this, this.xmlFileUrl, r, o), function() {
				n.setSortImgState(true, r, o)
			});
			return false
		}
		return true
	});
	c.attachEvent("onFilterStart", function(o, n) {
		var r = this.getSortingState();
		if (this._con_f_used.length) {
			var q = this;
			this.clearAndLoad(g.call(this, this.xmlFileUrl, o, n));
			if (r.length) {
				q.setSortImgState(true, r[0], r[1])
			}
			return false
		}
		return true
	})
});
dhtmlXGridObject.prototype._con_f_used = [];
dhtmlXGridObject.prototype._in_header_connector_text_filter = function(c, a) {
	if (!this._con_f_used[a]) {
		this._con_f_used[a] = 1
	}
	return this._in_header_text_filter(c, a)
};
dhtmlXGridObject.prototype._in_header_connector_select_filter = function(c, a) {
	if (!this._con_f_used[a]) {
		this._con_f_used[a] = 2
	}
	return this._in_header_select_filter(c, a)
};
dhtmlXGridObject.prototype.load_connector = dhtmlXGridObject.prototype.load;
dhtmlXGridObject.prototype.load = function(c, m, l) {
	if (!this._colls_loaded && this.cellType) {
		var a = [];
		for (var g = 0; g < this.cellType.length; g++) {
			if (this.cellType[g].indexOf("co") == 0 || this.cellType[g].indexOf("clist") == 0 || this._con_f_used[g] == 2) {
				a.push(g)
			}
		}
		if (a.length) {
			arguments[0] += (arguments[0].indexOf("?") != -1 ? "&" : "?") + "connector=true&dhx_colls=" + a.join(",")
		}
	}
	return this.load_connector.apply(this, arguments)
};
dhtmlXGridObject.prototype._parseHead_connector = dhtmlXGridObject.prototype._parseHead;
dhtmlXGridObject.prototype._parseHead = function(c, x, s) {
	this._parseHead_connector.apply(this, arguments);
	if (!this._colls_loaded) {
		var u = dhx4.ajax.xpath("./coll_options", arguments[0]);
		for (var o = 0; o < u.length; o++) {
			var r = u[o].getAttribute("for");
			var w = [];
			var l = null;
			if (this.cellType[r] == "combo") {
				l = this.getColumnCombo(r)
			} else {
				if (this.cellType[r].indexOf("co") == 0) {
					l = this.getCombo(r)
				}
			}
			var n = dhx4.ajax.xpath("./item", u[o]);
			var a = [];
			for (var m = 0; m < n.length; m++) {
				var g = n[m].getAttribute("value");
				if (l) {
					var q = n[m].getAttribute("label") || g;
					if (l.addOption) {
						a.push([g, q])
					} else {
						l.put(g, q)
					}
					w[w.length] = q
				} else {
					w[w.length] = g
				}
			}
			if (a.length) {
				if (l) {
					l.addOption(a)
				}
			} else {
				if (w.length && !l) {
					if (this.registerCList) {
						this.registerCList(r * 1, w)
					}
				}
			}
			if (this._con_f_used[r * 1]) {
				this._con_f_used[r * 1] = w
			}
		}
		this._colls_loaded = true
	}
};

function dhtmlXGridCellObject(a) {
	this.destructor = function() {
		this.cell.obj = null;
		this.cell = null;
		this.grid = null;
		this.base = null;
		return null
	};
	this.cell = a;
	this.getValue = function() {
		if ((this.cell.firstChild) && (this.cell.firstChild.tagName == "TEXTAREA")) {
			return this.cell.firstChild.value
		} else {
			return this.cell.innerHTML._dhx_trim()
		}
	};
	this.getMathValue = function() {
		if (this.cell.original) {
			return this.cell.original
		} else {
			return this.getValue()
		}
	};
	this.getFont = function() {
		arOut = new Array(3);
		if (this.cell.style.fontFamily) {
			arOut[0] = this.cell.style.fontFamily
		}
		if (this.cell.style.fontWeight == "bold" || this.cell.parentNode.style.fontWeight == "bold") {
			arOut[1] = "bold"
		}
		if (this.cell.style.fontStyle == "italic" || this.cell.parentNode.style.fontWeight == "italic") {
			arOut[1] += "italic"
		}
		if (this.cell.style.fontSize) {
			arOut[2] = this.cell.style.fontSize
		} else {
			arOut[2] = ""
		}
		return arOut.join("-")
	};
	this.getTextColor = function() {
		if (this.cell.style.color) {
			return this.cell.style.color
		} else {
			return "#000000"
		}
	};
	this.getBgColor = function() {
		if (this.cell.bgColor) {
			return this.cell.bgColor
		} else {
			return "#FFFFFF"
		}
	};
	this.getHorAlign = function() {
		if (this.cell.style.textAlign) {
			return this.cell.style.textAlign
		} else {
			if (this.cell.style.textAlign) {
				return this.cell.style.textAlign
			} else {
				return "left"
			}
		}
	};
	this.getWidth = function() {
		return this.cell.scrollWidth
	};
	this.setFont = function(c) {
		fntAr = c.split("-");
		this.cell.style.fontFamily = fntAr[0];
		this.cell.style.fontSize = fntAr[fntAr.length - 1];
		if (fntAr.length == 3) {
			if (/bold/.test(fntAr[1])) {
				this.cell.style.fontWeight = "bold"
			}
			if (/italic/.test(fntAr[1])) {
				this.cell.style.fontStyle = "italic"
			}
			if (/underline/.test(fntAr[1])) {
				this.cell.style.textDecoration = "underline"
			}
		}
	};
	this.setTextColor = function(c) {
		this.cell.style.color = c
	};
	this.setBgColor = function(c) {
		if (c == "") {
			c = null
		}
		this.cell.style.background = c
	};
	this.setHorAlign = function(c) {
		if (c.length == 1) {
			if (c == "c") {
				this.cell.style.textAlign = "center"
			} else {
				if (c == "l") {
					this.cell.style.textAlign = "left"
				} else {
					this.cell.style.textAlign = "right"
				}
			}
		} else {
			this.cell.style.textAlign = c
		}
	};
	this.wasChanged = function() {
		if (this.cell.wasChanged) {
			return true
		} else {
			return false
		}
	};
	this.isCheckbox = function() {
		var c = this.cell.firstChild;
		if (c && c.tagName == "INPUT") {
			type = c.type;
			if (type == "radio" || type == "checkbox") {
				return true
			} else {
				return false
			}
		} else {
			return false
		}
	};
	this.isChecked = function() {
		if (this.isCheckbox()) {
			return this.cell.firstChild.checked
		}
	};
	this.isDisabled = function() {
		return this.cell._disabled
	};
	this.setChecked = function(c) {
		if (this.isCheckbox()) {
			if (c != "true" && c != 1) {
				c = false
			}
			this.cell.firstChild.checked = c
		}
	};
	this.setDisabled = function(c) {
		if (c != "true" && c != 1) {
			c = false
		}
		if (this.isCheckbox()) {
			this.cell.firstChild.disabled = c;
			if (this.disabledF) {
				this.disabledF(c)
			}
		}
		this.cell._disabled = c
	}
}
dhtmlXGridCellObject.prototype = {
	getAttribute: function(a) {
		return this.cell._attrs[a]
	},
	setAttribute: function(a, c) {
		this.cell._attrs[a] = c
	},
	getInput: function() {
		if (this.obj && (this.obj.tagName == "INPUT" || this.obj.tagName == "TEXTAREA")) {
			return this.obj
		}
		var a = (this.obj || this.cell).getElementsByTagName("TEXTAREA");
		if (!a.length) {
			a = (this.obj || this.cell).getElementsByTagName("INPUT")
		}
		return a[0]
	}
};
dhtmlXGridCellObject.prototype.setValue = function(a) {
	if ((typeof(a) != "number") && (!a || a.toString()._dhx_trim() == "")) {
		a = "&nbsp;";
		this.cell._clearCell = true
	} else {
		this.cell._clearCell = false
	}
	this.setCValue(a)
};
dhtmlXGridCellObject.prototype.getTitle = function() {
	return (_isIE ? this.cell.innerText : this.cell.textContent)
};
dhtmlXGridCellObject.prototype.setCValue = function(c, a) {
	this.cell.innerHTML = c;
	this.grid.callEvent("onCellChanged", [this.cell.parentNode.idd, this.cell._cellIndex, (arguments.length > 1 ? a : c)])
};
dhtmlXGridCellObject.prototype.setCTxtValue = function(a) {
	this.cell.innerHTML = "";
	this.cell.appendChild(document.createTextNode(a));
	this.grid.callEvent("onCellChanged", [this.cell.parentNode.idd, this.cell._cellIndex, a])
};
dhtmlXGridCellObject.prototype.setLabel = function(a) {
	this.cell.innerHTML = a
};
dhtmlXGridCellObject.prototype.getMath = function() {
	if (this._val) {
		return this.val
	} else {
		return this.getValue()
	}
};

function eXcell() {
	this.obj = null;
	this.val = null;
	this.changeState = function() {
		return false
	};
	this.edit = function() {
		this.val = this.getValue()
	};
	this.detach = function() {
		return false
	};
	this.getPosition = function(l) {
		var a = l;
		var g = 0;
		var c = 0;
		while (a.tagName != "BODY") {
			g += a.offsetLeft;
			c += a.offsetTop;
			a = a.offsetParent
		}
		return new Array(g, c)
	}
}
eXcell.prototype = new dhtmlXGridCellObject;

function eXcell_ed(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid
	}
	this.edit = function() {
		this.cell.atag = (!this.grid.multiLine) ? "INPUT" : "TEXTAREA";
		this.val = this.getValue();
		this.obj = document.createElement(this.cell.atag);
		this.obj.setAttribute("autocomplete", "off");
		this.obj.style.height = (this.cell.offsetHeight - (_isIE ? 4 : 4)) + "px";
		this.obj.className = "dhx_combo_edit";
		this.obj.wrap = "soft";
		this.obj.style.textAlign = this.cell.style.textAlign;
		this.obj.onclick = function(c) {
			(c || event).cancelBubble = true
		};
		this.obj.onmousedown = function(c) {
			(c || event).cancelBubble = true
		};
		this.obj.value = this.val;
		this.cell.innerHTML = "";
		this.cell.appendChild(this.obj);
		this.obj.onselectstart = function(c) {
			if (!c) {
				c = event
			}
			c.cancelBubble = true;
			return true
		};
		if (_isIE) {
			this.obj.focus();
			this.obj.blur()
		}
		this.obj.focus()
	};
	this.getValue = function() {
		if ((this.cell.firstChild) && ((this.cell.atag) && (this.cell.firstChild.tagName == this.cell.atag))) {
			return this.cell.firstChild.value
		}
		if (this.cell._clearCell) {
			return ""
		}
		return this.cell.innerHTML.toString()._dhx_trim()
	};
	this.detach = function() {
		this.setValue(this.obj.value);
		return this.val != this.getValue()
	}
}
eXcell_ed.prototype = new eXcell;

function eXcell_edtxt(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid
	}
	this.getValue = function() {
		if ((this.cell.firstChild) && ((this.cell.atag) && (this.cell.firstChild.tagName == this.cell.atag))) {
			return this.cell.firstChild.value
		}
		if (this.cell._clearCell) {
			return ""
		}
		return (_isIE ? this.cell.innerText : this.cell.textContent)
	};
	this.setValue = function(c) {
		if (!c || c.toString()._dhx_trim() == "") {
			c = " ";
			this.cell._clearCell = true
		} else {
			this.cell._clearCell = false
		}
		this.setCTxtValue(c)
	}
}
eXcell_edtxt.prototype = new eXcell_ed;

function eXcell_edn(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid
	}
	this.getValue = function() {
		if ((this.cell.firstChild) && (this.cell.firstChild.tagName == "TEXTAREA")) {
			return this.cell.firstChild.value
		}
		if (this.cell._clearCell) {
			return ""
		}
		return this.cell._orig_value || this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(), this.cell._cellIndex)
	};
	this.detach = function() {
		var c = this.obj.value;
		this.setValue(c);
		return this.val != this.getValue()
	}
}
eXcell_edn.prototype = new eXcell_ed;
eXcell_edn.prototype.setValue = function(a) {
	if (!a || a.toString()._dhx_trim() == "") {
		this.cell._clearCell = true;
		return this.setCValue("&nbsp;", 0)
	} else {
		this.cell._clearCell = false;
		this.cell._orig_value = a
	}
	this.setCValue(this.grid._aplNF(a, this.cell._cellIndex), a)
};

function eXcell_ch(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid
	}
	this.disabledF = function(c) {
		if ((c == true) || (c == 1)) {
			this.cell.innerHTML = this.cell.innerHTML.replace("item_chk0.", "item_chk0_dis.").replace("item_chk1.", "item_chk1_dis.")
		} else {
			this.cell.innerHTML = this.cell.innerHTML.replace("item_chk0_dis.", "item_chk0.").replace("item_chk1_dis.", "item_chk1.")
		}
	};
	this.changeState = function(c) {
		if (c === true && !this.grid.isActive) {
			if (window.globalActiveDHTMLGridObject != null && window.globalActiveDHTMLGridObject != this.grid && window.globalActiveDHTMLGridObject.isActive) {
				window.globalActiveDHTMLGridObject.setActive(false)
			}
			this.grid.setActive(true)
		}
		if ((!this.grid.isEditable) || (this.cell.parentNode._locked) || (this.isDisabled())) {
			return
		}
		if (this.grid.callEvent("onEditCell", [0, this.cell.parentNode.idd, this.cell._cellIndex])) {
			this.val = this.getValue();
			if (this.val == "1") {
				this.setValue("0")
			} else {
				this.setValue("1")
			}
			this.cell.wasChanged = true;
			this.grid.callEvent("onEditCell", [1, this.cell.parentNode.idd, this.cell._cellIndex]);
			this.grid.callEvent("onCheckbox", [this.cell.parentNode.idd, this.cell._cellIndex, (this.val != "1")]);
			this.grid.callEvent("onCheck", [this.cell.parentNode.idd, this.cell._cellIndex, (this.val != "1")])
		} else {
			this.editor = null
		}
	};
	this.getValue = function() {
		return this.cell.chstate ? this.cell.chstate.toString() : "0"
	};
	this.isCheckbox = function() {
		return true
	};
	this.isChecked = function() {
		if (this.getValue() == "1") {
			return true
		} else {
			return false
		}
	};
	this.setChecked = function(c) {
		this.setValue(c.toString())
	};
	this.detach = function() {
		return this.val != this.getValue()
	};
	this.edit = null
}
eXcell_ch.prototype = new eXcell;
eXcell_ch.prototype.setValue = function(c) {
	this.cell.style.verticalAlign = "middle";
	if (c) {
		c = c.toString()._dhx_trim();
		if ((c == "false") || (c == "0")) {
			c = ""
		}
	}
	if (c) {
		c = "1";
		this.cell.chstate = "1"
	} else {
		c = "0";
		this.cell.chstate = "0"
	}
	var a = this;
	this.setCValue("<img src='" + this.grid.imgURL + "item_chk" + c + ".gif' onclick='new eXcell_ch(this.parentNode).changeState(true); (arguments[0]||event).cancelBubble=true; '>", this.cell.chstate)
};

function eXcell_ra(a) {
	this.base = eXcell_ch;
	this.base(a);
	this.grid = a.parentNode.grid;
	this.disabledF = function(c) {
		if ((c == true) || (c == 1)) {
			this.cell.innerHTML = this.cell.innerHTML.replace("radio_chk0.", "radio_chk0_dis.").replace("radio_chk1.", "radio_chk1_dis.")
		} else {
			this.cell.innerHTML = this.cell.innerHTML.replace("radio_chk0_dis.", "radio_chk0.").replace("radio_chk1_dis.", "radio_chk1.")
		}
	};
	this.changeState = function(c) {
		if (c === false && this.getValue() == 1) {
			return
		}
		if ((!this.grid.isEditable) || (this.cell.parentNode._locked) || (this.isDisabled())) {
			return
		}
		if (this.grid.callEvent("onEditCell", [0, this.cell.parentNode.idd, this.cell._cellIndex]) != false) {
			this.val = this.getValue();
			if (this.val == "1") {
				this.setValue("0")
			} else {
				this.setValue("1")
			}
			this.cell.wasChanged = true;
			this.grid.callEvent("onEditCell", [1, this.cell.parentNode.idd, this.cell._cellIndex]);
			this.grid.callEvent("onCheckbox", [this.cell.parentNode.idd, this.cell._cellIndex, (this.val != "1")]);
			this.grid.callEvent("onCheck", [this.cell.parentNode.idd, this.cell._cellIndex, (this.val != "1")])
		} else {
			this.editor = null
		}
	};
	this.edit = null
}
eXcell_ra.prototype = new eXcell_ch;
eXcell_ra.prototype.setValue = function(c) {
	this.cell.style.verticalAlign = "middle";
	if (c) {
		c = c.toString()._dhx_trim();
		if ((c == "false") || (c == "0")) {
			c = ""
		}
	}
	if (c) {
		if (!this.grid._RaSeCol) {
			this.grid._RaSeCol = []
		}
		if (this.grid._RaSeCol[this.cell._cellIndex]) {
			var a = this.grid.cells4(this.grid._RaSeCol[this.cell._cellIndex]);
			a.setValue("0");
			if (this.grid.rowsAr[a.cell.parentNode.idd]) {
				this.grid.callEvent("onEditCell", [1, a.cell.parentNode.idd, a.cell._cellIndex])
			}
		}
		this.grid._RaSeCol[this.cell._cellIndex] = this.cell;
		c = "1";
		this.cell.chstate = "1"
	} else {
		c = "0";
		this.cell.chstate = "0"
	}
	this.setCValue("<img src='" + this.grid.imgURL + "radio_chk" + c + ".gif' onclick='new eXcell_ra(this.parentNode).changeState(false);'>", this.cell.chstate)
};

function eXcell_txt(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid
	}
	this.edit = function() {
		this.val = this.getValue();
		this.obj = document.createElement("TEXTAREA");
		this.obj.className = "dhx_textarea";
		this.obj.onclick = function(l) {
			(l || event).cancelBubble = true
		};
		var c = this.grid.getPosition(this.cell);
		this.obj.value = this.val;
		this.obj.style.display = "";
		this.obj.style.textAlign = this.cell.style.textAlign;
		document.body.appendChild(this.obj);
		if (_isOpera) {
			this.obj.onkeypress = function(l) {
				if (l.keyCode == 9) {
					return false
				}
			}
		}
		this.obj.onkeydown = function(m) {
			var l = (m || event);
			if (l.keyCode == 9) {
				globalActiveDHTMLGridObject.entBox.focus();
				globalActiveDHTMLGridObject.doKey({
					keyCode: l.keyCode,
					shiftKey: l.shiftKey,
					srcElement: "0"
				});
				return false
			}
		};
		this.obj.style.left = c[0] + "px";
		this.obj.style.top = c[1] + this.cell.offsetHeight + "px";
		if (this.cell.offsetWidth < 200) {
			var g = 200
		} else {
			var g = this.cell.offsetWidth
		}
		this.obj.style.width = g + 16 + "px";
		if (_isIE) {
			this.obj.select();
			this.obj.value = this.obj.value
		}
		this.obj.focus()
	};
	this.detach = function() {
		var c = "";
		c = this.obj.value;
		if (c == "") {
			this.cell._clearCell = true
		} else {
			this.cell._clearCell = false
		}
		this.setValue(c);
		document.body.removeChild(this.obj);
		this.obj = null;
		return this.val != this.getValue()
	};
	this.getValue = function() {
		if (this.obj) {
			return this.obj.value
		}
		if (this.cell._clearCell) {
			return ""
		}
		if (typeof this.cell._brval != "undefined") {
			return this.cell._brval
		}
		if ((!this.grid.multiLine)) {
			return this.cell._brval || this.cell.innerHTML
		} else {
			return this.cell._brval || this.cell.innerHTML.replace(/<br[^>]*>/gi, "\n")._dhx_trim()
		}
	}
}
eXcell_txt.prototype = new eXcell;

function eXcell_txttxt(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid
	}
	this.getValue = function() {
		if ((this.cell.firstChild) && (this.cell.firstChild.tagName == "TEXTAREA")) {
			return this.cell.firstChild.value
		}
		if (this.cell._clearCell) {
			return ""
		}
		if ((!this.grid.multiLine) && this.cell._brval) {
			return this.cell._brval
		}
		return (_isIE ? this.cell.innerText : this.cell.textContent)
	};
	this.setValue = function(c) {
		this.cell._brval = c;
		if (!c || c.toString()._dhx_trim() == "") {
			c = " ";
			this.cell._clearCell = true
		} else {
			this.cell._clearCell = false
		}
		this.setCTxtValue(c)
	}
}
eXcell_txttxt.prototype = new eXcell_txt;
eXcell_txt.prototype.setValue = function(a) {
	this.cell._brval = a;
	if (!a || a.toString()._dhx_trim() == "") {
		a = "&nbsp;";
		this.cell._clearCell = true
	} else {
		this.cell._clearCell = false
	}
	if ((!this.grid.multiLine) || this.cell._clearCell) {
		this.setCValue(a, this.cell._brval)
	} else {
		this.setCValue(a.replace(/\n/g, "<br/>"), a)
	}
};

function eXcell_co(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid;
		this.combo = (this.cell._combo || this.grid.getCombo(this.cell._cellIndex));
		this.editable = true
	}
	this.shiftNext = function() {
		var c = this.list.options[this.list.selectedIndex + 1];
		if (c) {
			c.selected = true
		}
		this.obj.value = this.list.options[this.list.selectedIndex].text;
		return true
	};
	this.shiftPrev = function() {
		if (this.list.selectedIndex != 0) {
			var c = this.list.options[this.list.selectedIndex - 1];
			if (c) {
				c.selected = true
			}
			this.obj.value = this.list.options[this.list.selectedIndex].text
		}
		return true
	};
	this.edit = function() {
		this.val = this.getValue();
		this.text = this.getText()._dhx_trim();
		var l = this.grid.getPosition(this.cell);
		this.obj = document.createElement("TEXTAREA");
		this.obj.className = "dhx_combo_edit";
		this.obj.style.height = (this.cell.offsetHeight - (_isIE ? 4 : 4)) + "px";
		this.obj.wrap = "soft";
		this.obj.style.textAlign = this.cell.style.textAlign;
		this.obj.onclick = function(r) {
			(r || event).cancelBubble = true
		};
		this.obj.onmousedown = function(r) {
			(r || event).cancelBubble = true
		};
		this.obj.value = this.text;
		this.obj.onselectstart = function(r) {
			if (!r) {
				r = event
			}
			r.cancelBubble = true;
			return true
		};
		var n = this;
		this.obj.onkeyup = function(u) {
			var s = (u || event).keyCode;
			if (s == 38 || s == 40 || s == 9) {
				return
			}
			var v = this.readonly ? String.fromCharCode(s) : this.value;
			var w = n.list.options;
			for (var r = 0; r < w.length; r++) {
				if (w[r].text.indexOf(v) == 0) {
					return w[r].selected = true
				}
			}
		};
		this.list = document.createElement("SELECT");
		this.list.className = "dhx_combo_select";
		this.list.style.width = this.cell.offsetWidth + "px";
		this.list.style.left = l[0] + "px";
		this.list.style.top = l[1] + this.cell.offsetHeight + "px";
		this.list.onclick = function(u) {
			var s = u || window.event;
			var r = s.target || s.srcElement;
			if (r.tagName == "OPTION") {
				r = r.parentNode
			}
			n.editable = false;
			n.grid.editStop();
			s.cancelBubble = true
		};
		var c = this.combo.getKeys();
		var m = false;
		var q = 0;
		for (var g = 0; g < c.length; g++) {
			var o = this.combo.get(c[g]);
			this.list.options[this.list.options.length] = new Option(o, c[g]);
			if (c[g] == this.val) {
				q = this.list.options.length - 1;
				m = true
			}
		}
		if (m == false) {
			this.list.options[this.list.options.length] = new Option(this.text, this.val === null ? "" : this.val);
			q = this.list.options.length - 1
		}
		document.body.appendChild(this.list);
		this.list.size = "6";
		this.cstate = 1;
		if (this.editable) {
			this.cell.innerHTML = ""
		} else {
			this.obj.style.width = "1px";
			this.obj.style.height = "1px"
		}
		this.cell.appendChild(this.obj);
		this.list.options[q].selected = true;
		if (this.editable) {
			this.obj.focus();
			this.obj.focus()
		}
		if (!this.editable) {
			this.obj.style.visibility = "hidden";
			this.list.focus();
			this.list.onkeydown = function(r) {
				r = r || window.event;
				n.grid.setActive(true);
				if (r.keyCode < 30) {
					return n.grid.doKey({
						target: n.cell,
						keyCode: r.keyCode,
						shiftKey: r.shiftKey,
						ctrlKey: r.ctrlKey
					})
				}
			}
		}
	};
	this.getValue = function() {
		return ((this.cell.combo_value == window.undefined) ? "" : this.cell.combo_value)
	};
	this.detach = function() {
		if (this.val != this.getValue()) {
			this.cell.wasChanged = true
		}
		if (this.list.parentNode != null) {
			if (this.editable) {
				var c = this.list.options[this.list.selectedIndex];
				if (c && c.text == this.obj.value) {
					this.setValue(this.list.value)
				} else {
					var g = (this.cell._combo || this.grid.getCombo(this.cell._cellIndex));
					var l = g.values._dhx_find(this.obj.value);
					if (l != -1) {
						this.setValue(g.keys[l])
					} else {
						this.setValue(this.cell.combo_value = this.obj.value)
					}
				}
			} else {
				this.setValue(this.list.value)
			}
		}
		if (this.list.parentNode) {
			this.list.parentNode.removeChild(this.list)
		}
		if (this.obj.parentNode) {
			this.obj.parentNode.removeChild(this.obj)
		}
		return this.val != this.getValue()
	}
}
eXcell_co.prototype = new eXcell;
eXcell_co.prototype.getText = function() {
	return this.cell.innerHTML
};
eXcell_co.prototype.setValue = function(l) {
	if (typeof(l) == "object") {
		var g = dhx4.ajax.xpath("./option", l);
		if (g.length) {
			this.cell._combo = new dhtmlXGridComboObject()
		}
		for (var c = 0; c < g.length; c++) {
			this.cell._combo.put(g[c].getAttribute("value"), g[c].firstChild ? g[c].firstChild.data : "")
		}
		l = l.firstChild.data
	}
	if ((l || "").toString()._dhx_trim() == "") {
		l = null
	}
	this.cell.combo_value = l;
	if (l !== null) {
		var a = (this.cell._combo || this.grid.getCombo(this.cell._cellIndex)).get(l);
		this.setCValue(a === null ? l : a, l)
	} else {
		this.setCValue("&nbsp;", l)
	}
};

function eXcell_coro(a) {
	this.base = eXcell_co;
	this.base(a);
	this.editable = false
}
eXcell_coro.prototype = new eXcell_co;

function eXcell_cotxt(a) {
	this.base = eXcell_co;
	this.base(a)
}
eXcell_cotxt.prototype = new eXcell_co;
eXcell_cotxt.prototype.getText = function() {
	return (_isIE ? this.cell.innerText : this.cell.textContent)
};
eXcell_cotxt.prototype.setValue = function(g) {
	if (typeof(g) == "object") {
		var c = dhx4.ajax.xpath("./option", g);
		if (c.length) {
			this.cell._combo = new dhtmlXGridComboObject()
		}
		for (var a = 0; a < c.length; a++) {
			this.cell._combo.put(c[a].getAttribute("value"), c[a].firstChild ? c[a].firstChild.data : "")
		}
		g = g.firstChild.data
	}
	if ((g || "").toString()._dhx_trim() == "") {
		g = null
	}
	if (g !== null) {
		this.setCTxtValue((this.cell._combo || this.grid.getCombo(this.cell._cellIndex)).get(g) || g, g)
	} else {
		this.setCTxtValue(" ", g)
	}
	this.cell.combo_value = g
};

function eXcell_corotxt(a) {
	this.base = eXcell_co;
	this.base(a);
	this.editable = false
}
eXcell_corotxt.prototype = new eXcell_cotxt;

function eXcell_cp(a) {
	try {
		this.cell = a;
		this.grid = this.cell.parentNode.grid
	} catch (c) {}
	this.edit = function() {
		this.val = this.getValue();
		this.obj = document.createElement("SPAN");
		this.obj.style.border = "1px solid black";
		this.obj.style.position = "absolute";
		var g = this.grid.getPosition(this.cell);
		this.colorPanel(4, this.obj);
		document.body.appendChild(this.obj);
		this.obj.style.left = g[0] + "px";
		this.obj.style.zIndex = 1000;
		this.obj.style.top = g[1] + this.cell.offsetHeight + "px"
	};
	this.toolDNum = function(g) {
		if (g.length == 1) {
			g = "0" + g
		}
		return g
	};
	this.colorPanel = function(u, x) {
		var q = document.createElement("TABLE");
		x.appendChild(q);
		q.cellSpacing = 0;
		q.editor_obj = this;
		q.style.cursor = "default";
		q.onclick = function(A) {
			var y = A || window.event;
			var n = y.target || y.srcElement;
			var r = n.parentNode.parentNode.parentNode.editor_obj;
			r.setValue(n._bg);
			r.grid.editStop()
		};
		var m = 256 / u;
		for (var o = 0; o <= (256 / m); o++) {
			var g = q.insertRow(o);
			for (var s = 0; s <= (256 / m); s++) {
				for (var l = 0; l <= (256 / m); l++) {
					R = new Number(m * o) - (o == 0 ? 0 : 1);
					G = new Number(m * s) - (s == 0 ? 0 : 1);
					B = new Number(m * l) - (l == 0 ? 0 : 1);
					var w = this.toolDNum(R.toString(16)) + "" + this.toolDNum(G.toString(16)) + "" + this.toolDNum(B.toString(16));
					var v = g.insertCell(s);
					v.width = "10px";
					v.innerHTML = "&nbsp;";
					v.title = w.toUpperCase();
					v.style.backgroundColor = "#" + w;
					v._bg = "#" + w;
					if (this.val != null && "#" + w.toUpperCase() == this.val.toUpperCase()) {
						v.style.border = "2px solid white"
					}
				}
			}
		}
	};
	this.getValue = function() {
		return this.cell.firstChild._bg || ""
	};
	this.getRed = function() {
		return Number(parseInt(this.getValue().substr(1, 2), 16))
	};
	this.getGreen = function() {
		return Number(parseInt(this.getValue().substr(3, 2), 16))
	};
	this.getBlue = function() {
		return Number(parseInt(this.getValue().substr(5, 2), 16))
	};
	this.detach = function() {
		if (this.obj.offsetParent != null) {
			document.body.removeChild(this.obj)
		}
		return this.val != this.getValue()
	}
}
eXcell_cp.prototype = new eXcell;
eXcell_cp.prototype.setValue = function(a) {
	this.setCValue("<div style='width:100%;height:" + ((this.grid.multiLine ? "100%" : 23)) + ";background-color:" + (a || "") + ";border:0px;'>&nbsp;</div>", a);
	this.cell.firstChild._bg = a
};

function eXcell_img(a) {
	try {
		this.cell = a;
		this.grid = this.cell.parentNode.grid
	} catch (c) {}
	this.getValue = function() {
		if (this.cell.firstChild.tagName == "IMG") {
			return this.cell.firstChild.src + (this.cell.titFl != null ? "^" + this.cell._brval : "")
		} else {
			if (this.cell.firstChild.tagName == "A") {
				var g = this.cell.firstChild.firstChild.src + (this.cell.titFl != null ? "^" + this.cell._brval : "");
				g += "^" + this.cell.lnk;
				if (this.cell.trg) {
					g += "^" + this.cell.trg
				}
				return g
			}
		}
	};
	this.isDisabled = function() {
		return true
	}
}
eXcell_img.prototype = new eXcell;
eXcell_img.prototype.getTitle = function() {
	return this.cell._brval
};
eXcell_img.prototype.setValue = function(g) {
	var c = g;
	if ((g || "").indexOf("^") != -1) {
		var a = g.split("^");
		g = a[0];
		c = this.cell._attrs.title || a[1];
		if (a.length > 2) {
			this.cell.lnk = a[2];
			if (a[3]) {
				this.cell.trg = a[3]
			}
		}
		this.cell.titFl = "1"
	}
	this.setCValue("<img src='" + this.grid.iconURL + (g || "")._dhx_trim() + "' border='0'>", g);
	if (this.cell.lnk) {
		this.cell.innerHTML = "<a href='" + this.cell.lnk + "' target='" + this.cell.trg + "'>" + this.cell.innerHTML + "</a>"
	}
	this.cell._brval = c
};

function eXcell_price(a) {
	this.base = eXcell_ed;
	this.base(a);
	this.getValue = function() {
		if (this.cell.childNodes.length > 1) {
			return this.cell.childNodes[1].innerHTML.toString()._dhx_trim()
		} else {
			return "0"
		}
	}
}
eXcell_price.prototype = new eXcell_ed;
eXcell_price.prototype.setValue = function(c) {
	if (isNaN(parseFloat(c))) {
		c = this.val || 0
	}
	var a = "green";
	if (c < 0) {
		a = "red"
	}
	this.setCValue("<span>￥</span><span style='padding-right:2px;color:" + a + ";'>" + c + "</span>", c)
};

function eXcell_dyn(a) {
	this.base = eXcell_ed;
	this.base(a);
	this.getValue = function() {
		return this.cell.firstChild.childNodes[1].innerHTML.toString()._dhx_trim()
	}
}
eXcell_dyn.prototype = new eXcell_ed;
eXcell_dyn.prototype.setValue = function(g) {
	if (!g || isNaN(Number(g))) {
		if (g !== "") {
			g = 0
		}
	}
	if (g > 0) {
		var c = "green";
		var a = "dyn_up.gif"
	} else {
		if (g == 0) {
			var c = "black";
			var a = "dyn_.gif"
		} else {
			var c = "red";
			var a = "dyn_down.gif"
		}
	}
	this.setCValue("<div style='position:relative;padding-right:2px; width:100%;overflow:hidden; white-space:nowrap;'><img src='" + this.grid.imgURL + "" + a + "' height='15' style='position:absolute;top:0px;left:0px;'><span style=' padding-left:20px; width:100%;color:" + c + ";'>" + g + "</span></div>", g)
};

function eXcell_ro(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid
	}
	this.edit = function() {};
	this.isDisabled = function() {
		return true
	};
	this.getValue = function() {
		return this.cell._clearCell ? "" : this.cell.innerHTML.toString()._dhx_trim()
	}
}
eXcell_ro.prototype = new eXcell;
window.eXcell_hidden = function(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid
	}
	this.edit = function() {};
	this.isDisabled = function() {
		return true
	};
	this.getValue = function() {
		return this.cell.val
	}
};
eXcell_hidden.prototype = new eXcell;
eXcell_hidden.prototype.setValue = function(a) {
	this.cell.val = a
};

function eXcell_ron(a) {
	this.cell = a;
	this.grid = this.cell.parentNode.grid;
	this.edit = function() {};
	this.isDisabled = function() {
		return true
	};
	this.getValue = function() {
		return this.cell._clearCell ? "" : this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(), this.cell._cellIndex).toString()
	}
}
eXcell_ron.prototype = new eXcell;
eXcell_ron.prototype.setValue = function(a) {
	if (a === 0) {} else {
		if (!a || a.toString()._dhx_trim() == "") {
			this.setCValue("&nbsp;");
			return this.cell._clearCell = true
		}
	}
	this.cell._clearCell = false;
	this.setCValue(a ? this.grid._aplNF(a, this.cell._cellIndex) : "0")
};

function eXcell_rotxt(a) {
	this.cell = a;
	this.grid = this.cell.parentNode.grid;
	this.edit = function() {};
	this.isDisabled = function() {
		return true
	};
	this.setValue = function(c) {
		if (!c) {
			c = " ";
			this.cell._clearCell = true
		} else {
			this.cell._clearCell = false
		}
		this.setCTxtValue(c)
	};
	this.getValue = function() {
		if (this.cell._clearCell) {
			return ""
		}
		return (_isIE ? this.cell.innerText : this.cell.textContent)
	}
}
eXcell_rotxt.prototype = new eXcell;

function dhtmlXGridComboObject() {
	this.keys = new dhtmlxArray();
	this.values = new dhtmlxArray();
	this.put = function(c, g) {
		for (var a = 0; a < this.keys.length; a++) {
			if (this.keys[a] == c) {
				this.values[a] = g;
				return true
			}
		}
		this.values[this.values.length] = g;
		this.keys[this.keys.length] = c
	};
	this.get = function(c) {
		for (var a = 0; a < this.keys.length; a++) {
			if (this.keys[a] == c) {
				return this.values[a]
			}
		}
		return null
	};
	this.clear = function() {
		this.keys = new dhtmlxArray();
		this.values = new dhtmlxArray()
	};
	this.remove = function(c) {
		for (var a = 0; a < this.keys.length; a++) {
			if (this.keys[a] == c) {
				this.keys._dhx_removeAt(a);
				this.values._dhx_removeAt(a);
				return true
			}
		}
	};
	this.size = function() {
		var a = 0;
		for (var c = 0; c < this.keys.length; c++) {
			if (this.keys[c] != null) {
				a++
			}
		}
		return a
	};
	this.getKeys = function() {
		var a = new Array(0);
		for (var c = 0; c < this.keys.length; c++) {
			if (this.keys[c] != null) {
				a[a.length] = this.keys[c]
			}
		}
		return a
	};
	this.save = function() {
		this._save = new Array();
		for (var a = 0; a < this.keys.length; a++) {
			this._save[a] = [this.keys[a], this.values[a]]
		}
	};
	this.restore = function() {
		if (this._save) {
			this.keys[a] = new Array();
			this.values[a] = new Array();
			for (var a = 0; a < this._save.length; a++) {
				this.keys[a] = this._save[a][0];
				this.values[a] = this._save[a][1]
			}
		}
	};
	return this
}

function Hashtable() {
	this.keys = new dhtmlxArray();
	this.values = new dhtmlxArray();
	return this
}
Hashtable.prototype = new dhtmlXGridComboObject;
if (typeof(window.dhtmlXCellObject) != "undefined") {
	dhtmlXCellObject.prototype.attachGrid = function() {
		this.callEvent("_onBeforeContentAttach", ["grid"]);
		var a = document.createElement("DIV");
		a.style.width = "100%";
		a.style.height = "100%";
		a.style.position = "relative";
		a.style.overflow = "hidden";
		this._attachObject(a);
		this.dataType = "grid";
		this.dataObj = new dhtmlXGridObject(a);
		this.dataObj.setSkin(this.conf.skin);
		if (this.conf.skin == "dhx_skyblue" && typeof(window.dhtmlXWindowsCell) != "undefined" && this instanceof window.dhtmlXWindowsCell) {
			this.dataObj.entBox.style.border = "1px solid #a4bed4";
			this.dataObj._sizeFix = 0
		} else {
			this.dataObj.entBox.style.border = "0px solid white";
			this.dataObj._sizeFix = 2
		}
		a = null;
		this.callEvent("_onContentAttach", []);
		return this.dataObj
	}
}
dhtmlXGridObject.prototype.enableDragAndDrop = function(a) {
	if (a == "temporary_disabled") {
		this.dADTempOff = false;
		a = true
	} else {
		this.dADTempOff = true
	}
	this.dragAndDropOff = dhx4.s2b(a);
	this._drag_validate = true;
	if (a) {
		this.objBox.ondragstart = function(c) {
			(c || event).cancelBubble = true;
			return false
		}
	}
};
dhtmlXGridObject.prototype.setDragBehavior = function(a) {
	this.dadmodec = this.dadmodefix = 0;
	switch (a) {
		case "child":
			this.dadmode = 0;
			this._sbmod = false;
			break;
		case "sibling":
			this.dadmode = 1;
			this._sbmod = false;
			break;
		case "sibling-next":
			this.dadmode = 1;
			this._sbmod = true;
			break;
		case "complex":
			this.dadmode = 2;
			this._sbmod = false;
			break;
		case "complex-next":
			this.dadmode = 2;
			this._sbmod = true;
			break
	}
};
dhtmlXGridObject.prototype.enableDragOrder = function(a) {
	this._dndorder = dhx4.s2b(a)
};
dhtmlXGridObject.prototype._checkParent = function(l, c) {
	var g = this._h2.get[l.idd].parent;
	if (!g.parent) {
		return
	}
	for (var a = 0; a < c.length; a++) {
		if (c[a] == g.id) {
			return true
		}
	}
	return this._checkParent(this.rowsAr[g.id], c)
};
dhtmlXGridObject.prototype._createDragNode = function(g, l) {
	this.editStop();
	if (window.dhtmlDragAndDrop.dragNode) {
		return null
	}
	if (!this.dADTempOff) {
		return null
	}
	g.parentObject = new Object();
	g.parentObject.treeNod = this;
	var q = this.callEvent("onBeforeDrag", [g.parentNode.idd, g._cellIndex, l]);
	if (!q) {
		return null
	}
	var m = new Array();
	m = this.getSelectedId();
	m = (((m) && (m != "")) ? m.split(this.delim) : []);
	var n = false;
	for (var c = 0; c < m.length; c++) {
		if (m[c] == g.parentNode.idd) {
			n = true
		}
	}
	if (!n) {
		this.selectRow(this.rowsAr[g.parentNode.idd], false, l.ctrlKey, false);
		if (!l.ctrlKey) {
			m = []
		}
		m[this.selMultiRows ? m.length : 0] = g.parentNode.idd
	}
	if (this.isTreeGrid()) {
		for (var c = m.length - 1; c >= 0; c--) {
			if (this._checkParent(this.rowsAr[m[c]], m)) {
				m.splice(c, 1)
			}
		}
	}
	var r = this;
	if (m.length && this._dndorder) {
		m.sort(function(u, s) {
			return (r.rowsAr[u].rowIndex > r.rowsAr[s].rowIndex ? 1 : -1)
		})
	}
	var a = this.getFirstParentOfType(_isIE ? l.srcElement : l.target, "TD");
	if (a) {
		this._dndExtra = a._cellIndex
	}
	this._dragged = new Array();
	for (var c = 0; c < m.length; c++) {
		if (this.rowsAr[m[c]]) {
			this._dragged[this._dragged.length] = this.rowsAr[m[c]];
			this.rowsAr[m[c]].treeNod = this
		}
	}
	g.parentObject.parentNode = g.parentNode;
	var o = document.createElement("div");
	o.innerHTML = (q !== true ? q : this.rowToDragElement(g.parentNode.idd));
	o.style.position = "absolute";
	o.className = "dragSpanDiv";
	return o
};
dhtmlXGridObject.prototype._createSdrgc = function() {
	this._sdrgc = document.createElement("DIV");
	this._sdrgc.innerHTML = "&nbsp;";
	this._sdrgc.className = "gridDragLine";
	this.objBox.appendChild(this._sdrgc)
};

function dragContext(w, v, u, s, r, q, n, o, m, g) {
	this.source = w || "grid";
	this.target = v || "grid";
	this.mode = u || "move";
	this.dropmode = s || "child";
	this.sid = r || 0;
	this.tid = q;
	this.sobj = n || null;
	this.tobj = o || null;
	this.sExtra = m || null;
	this.tExtra = g || null;
	return this
}
dragContext.prototype.valid = function() {
	if (this.sobj != this.tobj) {
		return true
	}
	if (this.sid == this.tid) {
		return false
	}
	if (this.target == "treeGrid") {
		var a = this.tid;
		while (a = this.tobj.getParentId(a)) {
			if (this.sid == a) {
				return false
			}
		}
	}
	return true
};
dragContext.prototype.close = function() {
	this.sobj = null;
	this.tobj = null
};
dragContext.prototype.copy = function() {
	return new dragContext(this.source, this.target, this.mode, this.dropmode, this.sid, this.tid, this.sobj, this.tobj, this.sExtra, this.tExtra)
};
dragContext.prototype.set = function(g, c) {
	this[g] = c;
	return this
};
dragContext.prototype.uid = function(g, c) {
	this.nid = this.sid;
	while (this.tobj.rowsAr[this.nid]) {
		this.nid = this.nid + ((new Date()).valueOf())
	}
	return this
};
dragContext.prototype.data = function() {
	if (this.sobj == this.tobj) {
		return this.sobj._getRowArray(this.sobj.rowsAr[this.sid])
	}
	if (this.source == "tree") {
		return this.tobj.treeToGridElement(this.sobj, this.sid, this.tid)
	} else {
		return this.tobj.gridToGrid(this.sid, this.sobj, this.tobj)
	}
};
dragContext.prototype.attrs = function() {
	if (this.source == "tree") {
		return {}
	} else {
		return this.sobj.rowsAr[this.sid]._attrs
	}
};
dragContext.prototype.childs = function() {
	if (this.source == "treeGrid") {
		return this.sobj._h2.get[this.sid]._xml_await ? this.sobj._h2.get[this.sid].has_kids : null
	}
	return null
};
dragContext.prototype.pid = function() {
	if (!this.tid) {
		return 0
	}
	if (!this.tobj._h2) {
		return 0
	}
	if (this.target == "treeGrid") {
		if (this.dropmode == "child") {
			return this.tid
		} else {
			var c = this.tobj.rowsAr[this.tid];
			var a = this.tobj._h2.get[c.idd].parent.id;
			if ((this.alfa) && (this.tobj._sbmod) && (c.nextSibling)) {
				var g = this.tobj._h2.get[c.nextSibling.idd].parent.id;
				if (g == this.tid) {
					return this.tid
				}
				if (g != a) {
					return g
				}
			}
			return a
		}
	}
};
dragContext.prototype.ind = function() {
	if (this.tid == window.unknown) {
		return this.tobj.rowsBuffer.length
	}
	if (this.target == "treeGrid") {
		if (this.dropmode == "child") {
			this.tobj.openItem(this.tid)
		} else {
			this.tobj.openItem(this.tobj.getParentId(this.tid))
		}
	}
	var a = this.tobj.rowsBuffer._dhx_find(this.tobj.rowsAr[this.tid]);
	if ((this.alfa) && (this.tobj._sbmod) && (this.dropmode == "sibling")) {
		var c = this.tobj.rowsAr[this.tid];
		if ((c.nextSibling) && (this._h2.get[c.nextSibling.idd].parent.id == this.tid)) {
			return a + 1
		}
	}
	return (a + 1 + ((this.target == "treeGrid" && a >= 0 && this.tobj._h2.get[this.tobj.rowsBuffer[a].idd].state == "minus") ? this.tobj._getOpenLenght(this.tobj.rowsBuffer[a].idd, 0) : 0))
};
dragContext.prototype.img = function() {
	if ((this.target != "grid") && (this.sobj._h2)) {
		return this.sobj.getItemImage(this.sid)
	} else {
		return null
	}
};
dragContext.prototype.slist = function() {
	var c = new Array();
	for (var a = 0; a < this.sid.length; a++) {
		c[c.length] = this.sid[a][(this.source == "tree") ? "id" : "idd"]
	}
	return c.join(",")
};
dhtmlXGridObject.prototype._drag = function(u, m, s, v) {
	if (this._realfake) {
		return this._fake._drag()
	}
	var r = (this.lastLanding);
	if (this._autoOpenTimer) {
		window.clearTimeout(this._autoOpenTimer)
	}
	var l = s.parentNode;
	var g = u.parentObject;
	if (!l.idd) {
		l.grid = this;
		this.dadmodefix = 0
	}
	var q = new dragContext(0, 0, 0, ((l.grid.dadmode == 1 || l.grid.dadmodec) ? "sibling" : "child"));
	if (g && g.childNodes) {
		q.set("source", "tree").set("sobj", g.treeNod).set("sid", q.sobj._dragged)
	} else {
		if (!g) {
			return true
		}
		if (g.treeNod.isTreeGrid && g.treeNod.isTreeGrid()) {
			q.set("source", "treeGrid")
		}
		q.set("sobj", g.treeNod).set("sid", q.sobj._dragged)
	}
	if (l.grid.isTreeGrid()) {
		q.set("target", "treeGrid")
	} else {
		q.set("dropmode", "sibling")
	}
	q.set("tobj", l.grid).set("tid", l.idd);
	if (((q.tobj.dadmode == 2) && (q.tobj.dadmodec == 1)) && (q.tobj.dadmodefix < 0)) {
		if (q.tobj.obj.rows[1].idd != q.tid) {
			q.tid = l.previousSibling.idd
		} else {
			q.tid = 0
		}
	}
	var a = this.getFirstParentOfType(v, "TD");
	if (a) {
		q.set("tExtra", a._cellIndex)
	}
	if (a) {
		q.set("sExtra", q.sobj._dndExtra)
	}
	if (q.sobj.dpcpy) {
		q.set("mode", "copy")
	}
	if (q.tobj._realfake) {
		q.tobj = q.tobj._fake
	}
	if (q.sobj._realfake) {
		q.sobj = q.sobj._fake
	}
	q.tobj._clearMove();
	if (g && g.treeNod && g.treeNod._nonTrivialRow) {
		g.treeNod._nonTrivialRow(this, q.tid, q.dropmode, g)
	} else {
		q.tobj.dragContext = q;
		if (!q.tobj.callEvent("onDrag", [q.slist(), q.tid, q.sobj, q.tobj, q.sExtra, q.tExtra])) {
			return q.tobj.dragContext = null
		}
		var w = new Array();
		if (typeof(q.sid) == "object") {
			var o = q.copy();
			for (var n = 0; n < q.sid.length; n++) {
				if (!o.set("alfa", (!n)).set("sid", q.sid[n][(q.source == "tree" ? "id" : "idd")]).valid()) {
					continue
				}
				o.tobj._dragRoutine(o);
				if (o.target == "treeGrid" && o.dropmode == "child") {
					o.tobj.openItem(o.tid)
				}
				w[w.length] = o.nid;
				o.set("dropmode", "sibling").set("tid", o.nid)
			}
			o.close()
		} else {
			q.tobj._dragRoutine(q)
		}
		if (q.tobj.laterLink) {
			q.tobj.laterLink()
		}
		q.tobj.callEvent("onDrop", [q.slist(), q.tid, w.join(","), q.sobj, q.tobj, q.sExtra, q.tExtra])
	}
	q.tobj.dragContext = null;
	q.close()
};
dhtmlXGridObject.prototype._dragRoutine = function(u) {
	if ((u.sobj == u.tobj) && (u.source == "grid") && (u.mode == "move") && !this._fake) {
		if (u.sobj._dndProblematic) {
			return
		}
		var r = u.sobj.rowsAr[u.sid];
		var s = u.sobj.rowsCol._dhx_find(r);
		u.sobj.rowsCol._dhx_removeAt(u.sobj.rowsCol._dhx_find(r));
		u.sobj.rowsBuffer._dhx_removeAt(u.sobj.rowsBuffer._dhx_find(r));
		u.sobj.rowsBuffer._dhx_insertAt(u.ind(), r);
		if (u.tobj._fake) {
			u.tobj._fake.rowsCol._dhx_removeAt(s);
			var v = u.tobj._fake.rowsAr[u.sid];
			v.parentNode.removeChild(v)
		}
		u.sobj._insertRowAt(r, u.ind());
		u.nid = u.sid;
		u.sobj.callEvent("onGridReconstructed", []);
		return
	}
	var q;
	if (this._h2 && typeof u.tid != "undefined" && u.dropmode == "sibling" && (this._sbmod || u.tid)) {
		if (u.alfa && this._sbmod && this._h2.get[u.tid].childs.length) {
			this.openItem(u.tid);
			q = u.uid().tobj.addRowBefore(u.nid, u.data(), this._h2.get[u.tid].childs[0].id, u.img(), u.childs())
		} else {
			q = u.uid().tobj.addRowAfter(u.nid, u.data(), u.tid, u.img(), u.childs())
		}
	} else {
		q = u.uid().tobj.addRow(u.nid, u.data(), u.ind(), u.pid(), u.img(), u.childs())
	}
	q._attrs = u.attrs();
	if (u.source == "tree") {
		this.callEvent("onRowAdded", [u.nid]);
		var a = u.sobj._globalIdStorageFind(u.sid);
		if (a.childsCount) {
			var o = u.copy().set("tid", u.nid).set("dropmode", u.target == "grid" ? "sibling" : "child");
			for (var m = 0; m < a.childsCount; m++) {
				u.tobj._dragRoutine(o.set("sid", a.childNodes[m].id));
				if (u.mode == "move") {
					m--
				}
			}
			o.close()
		}
	} else {
		u.tobj._copyUserData(u);
		this.callEvent("onRowAdded", [u.nid]);
		if ((u.source == "treeGrid")) {
			if (u.sobj == u.tobj) {
				q._xml = u.sobj.rowsAr[u.sid]._xml
			}
			var n = u.sobj._h2.get[u.sid];
			if ((n) && (n.childs.length)) {
				var o = u.copy().set("tid", u.nid);
				if (u.target == "grid") {
					o.set("dropmode", "sibling")
				} else {
					if (!o.tobj.kidsXmlFile) {
						o.tobj.openItem(u.tid)
					}
					o.set("dropmode", "child")
				}
				var g = n.childs.length;
				if (!o.tobj.kidsXmlFile) {
					for (var m = 0; m < g; m++) {
						u.sobj.render_row_tree(null, n.childs[m].id);
						u.tobj._dragRoutine(o.set("sid", n.childs[m].id));
						if (g != n.childs.length) {
							m--;
							g = n.childs.length
						}
					}
				}
				o.close()
			}
		}
	}
	if (u.mode == "move") {
		u.sobj[(u.source == "tree") ? "deleteItem" : "deleteRow"](u.sid);
		if ((u.sobj == u.tobj) && (!u.tobj.rowsAr[u.sid])) {
			u.tobj.changeRowId(u.nid, u.sid);
			u.nid = u.sid
		}
	}
};
dhtmlXGridObject.prototype.gridToGrid = function(l, a, g) {
	var m = new Array();
	for (var c = 0; c < a.hdr.rows[0].cells.length; c++) {
		m[c] = a.cells(l, c).getValue()
	}
	return m
};
dhtmlXGridObject.prototype.checkParentLine = function(a, c) {
	if ((!this._h2) || (!c) || (!a)) {
		return false
	}
	if (a.id == c) {
		return true
	} else {
		return this.checkParentLine(a.parent, c)
	}
};
dhtmlXGridObject.prototype._dragIn = function(n, l, c, o) {
	if (!this.dADTempOff) {
		return 0
	}
	var a = this.isTreeGrid();
	var m = l.parentNode.idd ? l.parentNode : l.parentObject;
	if (this._drag_validate) {
		if (n.parentNode == l.parentNode) {
			return 0
		}
		if ((a) && (this == m.grid) && ((this.checkParentLine(this._h2.get[n.parentNode.idd], l.parentNode.idd)))) {
			return 0
		}
	}
	if (!this.callEvent("onDragIn", [m.idd || m.id, n.parentNode.idd, m.grid || m.treeNod, (n.grid || n.parentNode.grid)])) {
		return this._setMove(n, c, o, true)
	}
	this._setMove(n, c, o);
	if ((a) && (n.parentNode.expand != "")) {
		var g = this;
		this._autoOpenTimer = window.setTimeout(function() {
			g._autoOpenItem(null, g);
			g = null
		}, 1000);
		this._autoOpenId = n.parentNode.idd
	} else {
		if (this._autoOpenTimer) {
			window.clearTimeout(this._autoOpenTimer)
		}
	}
	return n
};
dhtmlXGridObject.prototype._autoOpenItem = function(a, c) {
	c.openItem(c._autoOpenId)
};
dhtmlXGridObject.prototype._dragOut = function(c) {
	this._clearMove();
	var a = c.parentNode.parentObject ? c.parentObject.id : c.parentNode.idd;
	this.callEvent("onDragOut", [a]);
	if (this._autoOpenTimer) {
		window.clearTimeout(this._autoOpenTimer)
	}
};
dhtmlXGridObject.prototype._setMove = function(n, c, q, m) {
	if (!n.parentNode.idd) {
		return
	}
	var g = dhx4.absTop(n);
	var a = dhx4.absTop(this.objBox);
	if ((g - a) > (parseInt(this.objBox.offsetHeight) - 50)) {
		this.objBox.scrollTop = parseInt(this.objBox.scrollTop) + 20
	}
	if ((g - a + parseInt(this.objBox.scrollTop)) < (parseInt(this.objBox.scrollTop) + 30)) {
		this.objBox.scrollTop = parseInt(this.objBox.scrollTop) - 20
	}
	if (m) {
		return 0
	}
	if (this.dadmode == 2) {
		var o = q - g + (document.body.scrollTop || document.documentElement.scrollTop) - 2 - n.offsetHeight / 2;
		if ((Math.abs(o) - n.offsetHeight / 6) > 0) {
			this.dadmodec = 1;
			if (o < 0) {
				this.dadmodefix = -1
			} else {
				this.dadmodefix = 1
			}
		} else {
			this.dadmodec = 0
		}
	} else {
		this.dadmodec = this.dadmode
	}
	if (this.dadmodec) {
		if (!this._sdrgc) {
			this._createSdrgc()
		}
		this._sdrgc.style.display = "block";
		this._sdrgc.style.top = g - a + parseInt(this.objBox.scrollTop) + ((this.dadmodefix >= 0) ? n.offsetHeight : 0) + "px"
	} else {
		this._llSelD = n;
		if (n.parentNode.tagName == "TR") {
			for (var l = 0; l < n.parentNode.childNodes.length; l++) {
				var o = n.parentNode.childNodes[l];
				o._bgCol = o.style.backgroundColor;
				o.style.backgroundColor = "#FFCCCC"
			}
		}
	}
};
dhtmlXGridObject.prototype._clearMove = function() {
	if (this._sdrgc) {
		this._sdrgc.style.display = "none"
	}
	if ((this._llSelD) && (this._llSelD.parentNode.tagName == "TR")) {
		var c = this._llSelD.parentNode.childNodes;
		for (var a = 0; a < c.length; a++) {
			c[a].style.backgroundColor = c[a]._bgCol
		}
	}
	this._llSelD = null
};
dhtmlXGridObject.prototype.rowToDragElement = function(a) {
	var c = this.cells(a, 0).getValue();
	return c
};
dhtmlXGridObject.prototype._copyUserData = function(l) {
	if (!l.tobj.UserData[l.nid] || l.tobj != l.sobj) {
		l.tobj.UserData[l.nid] = new Hashtable()
	} else {
		return
	}
	var g = l.sobj.UserData[l.sid];
	var a = l.tobj.UserData[l.nid];
	if (g) {
		a.keys = a.keys.concat(g.keys);
		a.values = a.values.concat(g.values)
	}
};
dhtmlXGridObject.prototype.moveRow = function(g, l, a, c) {
	switch (l) {
		case "row_sibling":
			this.moveRowTo(g, a, "move", "sibling", this, c);
			break;
		case "up":
			this.moveRowUp(g);
			break;
		case "down":
			this.moveRowDown(g);
			break
	}
};
dhtmlXGridObject.prototype._nonTrivialNode = function(u, s, o, q, g) {
	if ((u.callEvent) && (!g)) {
		if (!u.callEvent("onDrag", [q.idd, s.id, (o ? o.id : null), this, u])) {
			return false
		}
	}
	var r = q.idd;
	var a = r;
	while (u._idpull[a]) {
		a += (new Date()).getMilliseconds().toString()
	}
	var m = (this.isTreeGrid() ? this.getItemImage(r) : "");
	if (o) {
		for (l = 0; l < s.childsCount; l++) {
			if (s.childNodes[l] == o) {
				break
			}
		}
		if (l != 0) {
			o = s.childNodes[l - 1]
		} else {
			st = "TOP";
			o = ""
		}
	}
	var c = u._attachChildNode(s, a, this.gridToTreeElement(u, a, r), "", m, m, m, "", "", o);
	if (this._h2) {
		var n = this._h2.get[r];
		if (n.childs.length) {
			for (var l = 0; l < n.childs.length; l++) {
				this._nonTrivialNode(u, c, 0, this.rowsAr[n.childs[l].id], 1);
				if (!this.dpcpy) {
					l--
				}
			}
		}
	}
	if (!this.dpcpy) {
		this.deleteRow(r)
	}
	if ((u.callEvent) && (!g)) {
		u.callEvent("onDrop", [a, s.id, (o ? o.id : null), this, u])
	}
};
dhtmlXGridObject.prototype.gridToTreeElement = function(c, g, a) {
	return this.cells(a, 0).getValue()
};
dhtmlXGridObject.prototype.treeToGridElement = function(l, m, a) {
	var c = new Array();
	var n = this.cellType._dhx_find("tree");
	if (n == -1) {
		n = 0
	}
	for (var g = 0; g < this.getColumnCount(); g++) {
		c[c.length] = (g != n) ? (l.getUserData(m, this.getColumnId(g)) || "") : l.getItemText(m)
	}
	return c
};
dhtmlXGridObject.prototype.moveRowTo = function(l, g, o, n, a, m) {
	var q = new dragContext((a || this).isTreeGrid() ? "treeGrid" : "grid", (m || this).isTreeGrid() ? "treeGrid" : "grid", o, n || "sibling", l, g, a || this, m || this);
	q.tobj._dragRoutine(q);
	q.close();
	return q.nid
};
dhtmlXGridObject.prototype.enableMercyDrag = function(a) {
	this.dpcpy = dhx4.s2b(a)
};
dhtmlXGridObject.prototype.toPDF = function(l, s, x, v, q, D) {
	var m = {
		row: this.getSelectedRowId(),
		col: this.getSelectedCellIndex()
	};
	if (m.row === null || m.col === -1) {
		m = false
	} else {
		if (m.row && m.row.indexOf(this.delim) !== -1) {
			var c = this.cells(m.row, m.col).cell;
			c.parentNode.className = c.parentNode.className.replace(" rowselected", "");
			c.className = c.className.replace(" cellselected", "");
			m.el = c
		} else {
			m = false
		}
	}
	s = s || "color";
	var y = s == "full_color";
	var a = this;
	a._asCDATA = true;
	if (typeof(D) === "undefined") {
		this.target = ' target="_blank"'
	} else {
		this.target = D
	}
	eXcell_ch.prototype.getContent = function() {
		return this.getValue()
	};
	eXcell_ra.prototype.getContent = function() {
		return this.getValue()
	};

	function C(H) {
		var N = [];
		for (var L = 1; L < a.hdr.rows.length; L++) {
			N[L] = [];
			for (var K = 0; K < a._cCount; K++) {
				var P = a.hdr.rows[L].childNodes[K];
				if (!N[L][K]) {
					N[L][K] = [0, 0]
				}
				if (P) {
					N[L][P._cellIndexS] = [P.colSpan, P.rowSpan]
				}
			}
		}
		var M = "<rows profile='" + H + "'";
		if (x) {
			M += " header='" + x + "'"
		}
		if (v) {
			M += " footer='" + v + "'"
		}
		M += "><head>" + a._serialiseExportConfig(N).replace(/^<head/, "<columns").replace(/head>$/, "columns>");
		for (var L = 2; L < a.hdr.rows.length; L++) {
			var E = 0;
			var T = a.hdr.rows[L];
			var O = "";
			for (var K = 0; K < a._cCount; K++) {
				if ((a._srClmn && !a._srClmn[K]) || (a._hrrar[K] && (!a._fake || K >= a._fake.hdrLabels.length))) {
					E++;
					continue
				}
				var S = N[L][K];
				var Q = ((S[0] && S[0] > 1) ? ' colspan="' + S[0] + '" ' : "");
				if (S[1] && S[1] > 1) {
					Q += ' rowspan="' + S[1] + '" ';
					E = -1
				}
				var F = "";
				var J = T;
				if (a._fake && K < a._fake._cCount) {
					J = a._fake.hdr.rows[L]
				}
				for (var I = 0; I < J.cells.length; I++) {
					if (J.cells[I]._cellIndexS == K) {
						if (J.cells[I].getElementsByTagName("SELECT").length) {
							F = ""
						} else {
							F = _isIE ? J.cells[I].innerText : J.cells[I].textContent
						}
						F = F.replace(/[ \n\r\t\xA0]+/, " ");
						break
					}
				}
				if (!F || F == " ") {
					E++
				}
				O += "<column" + Q + "><![CDATA[" + F + "]]></column>"
			}
			if (E != a._cCount) {
				M += "\n<columns>" + O + "</columns>"
			}
		}
		M += "</head>\n";
		M += r();
		return M
	}

	function g() {
		var E = [];
		if (q) {
			for (var F = 0; F < q.length; F++) {
				E.push(w(a.getRowIndex(q[F])))
			}
		} else {
			for (var F = 0; F < a.getRowsNum(); F++) {
				E.push(w(F))
			}
		}
		return E.join("\n")
	}

	function r() {
		var H = ["<foot>"];
		if (!a.ftr) {
			return ""
		}
		for (var I = 1; I < a.ftr.rows.length; I++) {
			H.push("<columns>");
			var L = a.ftr.rows[I];
			for (var F = 0; F < a._cCount; F++) {
				if (a._srClmn && !a._srClmn[F]) {
					continue
				}
				if (a._hrrar[F] && (!a._fake || F >= a._fake.hdrLabels.length)) {
					continue
				}
				for (var E = 0; E < L.cells.length; E++) {
					var K = "";
					var J = "";
					if (L.cells[E]._cellIndexS == F) {
						K = _isIE ? L.cells[E].innerText : L.cells[E].textContent;
						K = K.replace(/[ \n\r\t\xA0]+/, " ");
						if (L.cells[E].colSpan && L.cells[E].colSpan != 1) {
							J = " colspan='" + L.cells[E].colSpan + "' "
						}
						if (L.cells[E].rowSpan && L.cells[E].rowSpan != 1) {
							J = " rowspan='" + L.cells[E].rowSpan + "' "
						}
						break
					}
				}
				H.push("<column" + J + "><![CDATA[" + K + "]]></column>")
			}
			H.push("</columns>")
		}
		H.push("</foot>");
		return H.join("\n")
	}

	function o(F, E) {
		return (window.getComputedStyle ? (window.getComputedStyle(F, null)[E]) : (F.currentStyle ? F.currentStyle[E] : null)) || ""
	}

	function w(I) {
		if (!a.rowsBuffer[I]) {
			return ""
		}
		var E = a.render_row(I);
		if (E.style.display == "none") {
			return ""
		}
		var F = a.isTreeGrid() ? ' level="' + a.getLevel(E.idd) + '"' : "";
		var M = "<row" + F + ">";
		for (var K = 0; K < a._cCount; K++) {
			if (((!a._srClmn) || (a._srClmn[K])) && (!a._hrrar[K] || (a._fake && K < a._fake.hdrLabels.length))) {
				var Q = a.cells(E.idd, K);
				if (y) {
					var J = o(Q.cell, "color");
					var P = o(Q.cell, "backgroundColor");
					var O = o(Q.cell, "font-weight") || o(Q.cell, "fontWeight");
					var L = o(Q.cell, "font-style") || o(Q.cell, "fontStyle");
					var N = o(Q.cell, "text-align") || o(Q.cell, "textAlign");
					var H = o(Q.cell, "font-family") || o(Q.cell, "fontFamily");
					if (P == "transparent" || P == "rgba(0, 0, 0, 0)") {
						P = "rgb(255,255,255)"
					}
					M += "<cell bgColor='" + P + "' textColor='" + J + "' bold='" + O + "' italic='" + L + "' align='" + N + "' font='" + H + "'>"
				} else {
					M += "<cell>"
				}
				M += "<![CDATA[" + (Q.getContent ? Q.getContent() : Q.getTitle()) + "]]></cell>"
			}
		}
		return M + "</row>"
	}

	function u() {
		var E = "</rows>";
		return E
	}
	var A = document.createElement("div");
	A.style.display = "none";
	document.body.appendChild(A);
	var n = "form_" + a.uid();
	//modify code by zzm 20160727 submit textarea replace input
	//A.innerHTML = '<form id="' + n + '" method="post" action="' + l + '" accept-charset="utf-8"  enctype="application/x-www-form-urlencoded"' + this.target + '><input type="hidden" name="grid_xml" id="grid_xml"/> </form>';
	//document.getElementById(n).firstChild.value = encodeURIComponent(C(s).replace("\u2013", "-") + g() + u());
	
	A.innerHTML = '<form id="' + n + '" method="post" action="' + l + '" ' + this.target + '><textarea style="display:none" name="grid_xml" id="grid_xml"></textarea></form>';
	document.getElementById(n).firstChild.value = C(s).replace("\u2013", "-") + g() + u();
	
	document.getElementById(n).submit();
	A.parentNode.removeChild(A);
	a = null;
	if (m) {
		m.el.parentNode.className += " rowselected";
		m.el.className += " cellselected"
	}
	m = null
};
dhtmlXGridObject.prototype._serialiseExportConfig = function(n) {
	function m(s) {
		if (typeof(s) !== "string") {
			return s
		}
		s = s.replace(/&/g, "&amp;");
		s = s.replace(/"/g, "&quot;");
		s = s.replace(/'/g, "&apos;");
		s = s.replace(/</g, "&lt;");
		s = s.replace(/>/g, "&gt;");
		return s
	}
	var c = "<head>";
	for (var g = 0; g < this.hdr.rows[0].cells.length; g++) {
		if (this._srClmn && !this._srClmn[g]) {
			continue
		}
		if (this._hrrar[g] && (!this._fake || g >= this._fake.hdrLabels.length)) {
			continue
		}
		var l = this.fldSort[g];
		if (l == "cus") {
			l = this._customSorts[g].toString();
			l = l.replace(/function[\ ]*/, "").replace(/\([^\f]*/, "")
		}
		var r = n[1][g];
		var o = ((r[1] && r[1] > 1) ? ' rowspan="' + r[1] + '" ' : "") + ((r[0] && r[0] > 1) ? ' colspan="' + r[0] + '" ' : "");
		c += "<column " + o + " width='" + this.getColWidth(g) + "' align='" + this.cellAlign[g] + "' type='" + this.cellType[g] + "' hidden='" + ((this.isColumnHidden && this.isColumnHidden(g)) ? "true" : "false") + "' sort='" + (l || "na") + "' color='" + (this.columnColor[g] || "") + "'" + (this.columnIds[g] ? (" id='" + this.columnIds[g] + "'") : "") + ">";
		if (this._asCDATA) {
			c += "<![CDATA[" + this.getColumnLabel(g) + "]]>"
		} else {
			c += this.getColumnLabel(g)
		}
		var q = this.combos[g] ? this.getCombo(g) : null;
		if (q) {
			for (var a = 0; a < q.keys.length; a++) {
				c += "<option value='" + m(q.keys[a]) + "'><![CDATA[" + q.values[a] + "]]></option>"
			}
		}
		c += "</column>"
	}
	return c += "</head>"
};
if (window.eXcell_sub_row_grid) {
	window.eXcell_sub_row_grid.prototype.getContent = function() {
		return ""
	}
}
dhtmlXGridObject.prototype.toExcel = function(a, l, o, n, c) {
	if (!document.getElementById("ifr")) {
		var m = document.createElement("iframe");
		m.style.display = "none";
		m.setAttribute("name", "dhx_export_iframe");
		m.setAttribute("src", "");
		m.setAttribute("id", "dhx_export_iframe");
		document.body.appendChild(m)
	}
	var g = ' target="dhx_export_iframe"';
	this.toPDF(a, l, o, n, c, g)
};
dhtmlXGridObject.prototype.filterBy = function(g, l, c) {
	if (this.isTreeGrid()) {
		return this.filterTreeBy(g, l, c)
	}
	if (this._f_rowsBuffer) {
		if (!c) {
			this.rowsBuffer = dhtmlxArray([].concat(this._f_rowsBuffer));
			if (this._fake) {
				this._fake.rowsBuffer = this.rowsBuffer
			}
		}
	} else {
		this._f_rowsBuffer = [].concat(this.rowsBuffer)
	}
	if (!this.rowsBuffer.length) {
		return
	}
	var m = true;
	this.dma(true);
	if (typeof(g) == "object") {
		for (var a = 0; a < l.length; a++) {
			this._filterA(g[a], l[a])
		}
	} else {
		this._filterA(g, l)
	}
	this.dma(false);
	if (this.pagingOn && this.rowsBuffer.length / this.rowsBufferOutSize < (this.currentPage - 1)) {
		this.changePage(0)
	}
	this._reset_view();
	this.callEvent("onGridReconstructed", [])
};
dhtmlXGridObject.prototype._filterA = function(c, g) {
	if (g == "") {
		return
	}
	var l = true;
	if (typeof(g) == "function") {
		l = false
	} else {
		g = (g || "").toString().toLowerCase()
	}
	if (!this.rowsBuffer.length) {
		return
	}
	for (var a = this.rowsBuffer.length - 1; a >= 0; a--) {
		if (l ? (this._get_cell_value(this.rowsBuffer[a], c).toString().toLowerCase().indexOf(g) == -1) : (!g.call(this, this._get_cell_value(this.rowsBuffer[a], c), this.rowsBuffer[a].idd))) {
			this.rowsBuffer.splice(a, 1)
		}
	}
};
dhtmlXGridObject.prototype.getFilterElement = function(a) {
	if (!this.filters) {
		return
	}
	for (var c = 0; c < this.filters.length; c++) {
		if (this.filters[c][1] == a) {
			return (this.filters[c][0].combo || this.filters[c][0])
		}
	}
	return null
};
dhtmlXGridObject.prototype.collectValues = function(l) {
	var v = this.dhxevs.data.oncollectvalues;
	if (v) {
		var s = true;
		for (var u in v) {
			var w = v[u].call(this, l);
			if (w !== true) {
				s = w || s
			}
		}
		if (s !== true) {
			return s
		}
	}
	if (this.isTreeGrid()) {
		return this.collectTreeValues(l)
	}
	this.dma(true);
	this._build_m_order();
	l = this._m_order ? this._m_order[l] : l;
	var q = {};
	var n = [];
	var g = this._f_rowsBuffer || this.rowsBuffer;
	for (var m = 0; m < g.length; m++) {
		var a = this._get_cell_value(g[m], l);
		if (a && (!g[m]._childIndexes || g[m]._childIndexes[l] != g[m]._childIndexes[l - 1])) {
			q[a] = true
		}
	}
	this.dma(false);
	var r = (this.combos[l] || (this._col_combos ? this._col_combos[l] : false));
	for (var o in q) {
		if (q[o] === true) {
			if (r) {
				if (r.get && r.get(o)) {
					o = r.get(o)
				} else {
					if (r.getOption && r.getOption(o)) {
						o = r.getOption(o).text
					}
				}
			}
			n.push(o)
		}
	}
	return n.sort()
};
dhtmlXGridObject.prototype._build_m_order = function() {
	if (this._c_order) {
		this._m_order = [];
		for (var a = 0; a < this._c_order.length; a++) {
			this._m_order[this._c_order[a]] = a
		}
	}
};
dhtmlXGridObject.prototype.filterByAll = function() {
	var g = [];
	var c = [];
	this._build_m_order();
	for (var l = 0; l < this.filters.length; l++) {
		var n = this._m_order ? this._m_order[this.filters[l][1]] : this.filters[l][1];
		if (n >= this._cCount) {
			continue
		}
		c.push(n);
		var o = this.filters[l][0].old_value = this.filters[l][0].value;
		if (this.filters[l][0]._filter) {
			o = this.filters[l][0]._filter()
		}
		var m;
		if (typeof o != "function" && (m = (this.combos[n] || (this._col_combos ? this._col_combos[n] : false)))) {
			if (m.values) {
				n = m.values._dhx_find(o);
				o = (n == -1) ? o : m.keys[n]
			} else {
				if (m.getOptionByLabel) {
					o = (m.getOptionByLabel(o) ? m.getOptionByLabel(o).value : o)
				}
			}
		}
		g.push(o)
	}
	if (!this.callEvent("onFilterStart", [c, g])) {
		return
	}
	this.filterBy(c, g);
	if (this._cssEven) {
		this._fixAlterCss()
	}
	this.callEvent("onFilterEnd", [this.filters]);
	if (this._f_rowsBuffer && this.rowsBuffer.length == this._f_rowsBuffer.length) {
		this._f_rowsBuffer = null
	}
};
dhtmlXGridObject.prototype.makeFilter = function(m, g, c) {
	if (!this.filters) {
		this.filters = []
	}
	if (typeof(m) != "object") {
		m = document.getElementById(m)
	}
	if (!m) {
		return
	}
	var a = this;
	if (!m.style.width) {
		m.style.width = "90%"
	}
	if (m.tagName == "SELECT") {
		this.filters.push([m, g]);
		this._loadSelectOptins(m, g);
		m.onchange = function() {
			a.filterByAll()
		};
		if (_isIE) {
			m.style.marginTop = "1px"
		}
		this.attachEvent("onEditCell", function(o, n, q) {
			this._build_m_order();
			if (o == 2 && this.filters && (this._m_order ? (q == this._m_order[g]) : (q == g))) {
				this._loadSelectOptins(m, g)
			}
			return true
		})
	} else {
		if (m.tagName == "INPUT") {
			this.filters.push([m, g]);
			m.old_value = m.value = "";
			m.onkeydown = function() {
				if (this._timer) {
					window.clearTimeout(this._timer)
				}
				this._timer = window.setTimeout(function() {
					if (m.value != m.old_value) {
						a.filterByAll();
						m.old_value = m.value
					}
				}, 500)
			}
		} else {
			if (m.tagName == "DIV" && m.className == "combo") {
				this.filters.push([m, g]);
				m.style.padding = "0px";
				m.style.margin = "0px";
				if (!window.dhx_globalImgPath) {
					window.dhx_globalImgPath = this.imgURL
				}
				var l = new dhtmlXCombo(m, "_filter", "90%");
				l.filterSelfA = l.filterSelf;
				l.filterSelf = function() {
					if (this.getSelectedIndex() == 0) {
						this.setComboText("")
					}
					this.filterSelfA.apply(this, arguments);
					this.optionsArr[0].hide(false)
				};
				l.enableFilteringMode(true);
				m.combo = l;
				m.value = "";
				this._loadComboOptins(m, g);
				l.attachEvent("onChange", function() {
					m.value = l.getSelectedValue();
					if (m.value === null) {
						m.value = ""
					}
					a.filterByAll()
				})
			}
		}
	}
	if (m.parentNode) {
		m.parentNode.className += " filter"
	}
	this._filters_ready()
};
dhtmlXGridObject.prototype.findCell = function(n, o, l, m) {
	var m = m || (function(r, q) {
		return q.toString().toLowerCase().indexOf(r) != -1
	});
	if (m === true) {
		m = function(r, q) {
			return q.toString().toLowerCase() == r
		}
	}
	var g = new Array();
	n = n.toString().toLowerCase();
	if (typeof l != "number") {
		l = l ? 1 : 0
	}
	if (!this.rowsBuffer.length) {
		return g
	}
	for (var c = (o || 0); c < this._cCount; c++) {
		if (this._h2) {
			this._h2.forEachChild(0, function(q) {
				if (l && g.length == l) {
					return g
				}
				if (m(n, this._get_cell_value(q.buff, c))) {
					g.push([q.id, c])
				}
			}, this)
		} else {
			for (var a = 0; a < this.rowsBuffer.length; a++) {
				if (m(n, this._get_cell_value(this.rowsBuffer[a], c))) {
					g.push([this.rowsBuffer[a].idd, c]);
					if (l && g.length == l) {
						return g
					}
				}
			}
		}
		if (typeof(o) != "undefined") {
			return g
		}
	}
	return g
};
dhtmlXGridObject.prototype.makeSearch = function(l, g, a) {
	if (typeof(l) != "object") {
		l = document.getElementById(l)
	}
	if (!l) {
		return
	}
	var c = this;
	if (l.tagName == "INPUT") {
		l.onkeypress = function() {
			if (this._timer) {
				window.clearTimeout(this._timer)
			}
			this._timer = window.setTimeout(function() {
				if (l.value == "") {
					return
				}
				var m = c.findCell(l.value, g, true, a);
				if (m.length) {
					if (c._h2) {
						c.openItem(m[0][0])
					}
					c.selectCell(c.getRowIndex(m[0][0]), (g || 0))
				}
			}, 500)
		}
	}
	if (l.parentNode) {
		l.parentNode.className += " filter"
	}
};
dhtmlXGridObject.prototype._loadSelectOptins = function(n, q) {
	var a = this.collectValues(q);
	var g = n.value;
	n.innerHTML = "";
	n.options[0] = new Option("", "");
	var o = this._filter_tr ? this._filter_tr[q] : null;
	for (var m = 0; m < a.length; m++) {
		n.options[n.options.length] = new Option(o ? o(a[m]) : a[m], a[m])
	}
	n.value = g
};
dhtmlXGridObject.prototype.setSelectFilterLabel = function(c, a) {
	if (!this._filter_tr) {
		this._filter_tr = []
	}
	this._filter_tr[c] = a
};
dhtmlXGridObject.prototype._loadComboOptins = function(m, o) {
	if (!m.combo) {
		return
	}
	var a = this.collectValues(o);
	m.combo.clearAll();
	var n = [
		["", ""]
	];
	for (var g = 0; g < a.length; g++) {
		n.push([a[g], a[g]])
	}
	m.combo.addOption(n)
};
dhtmlXGridObject.prototype.refreshFilters = function() {
	if (!this.filters) {
		return
	}
	for (var a = 0; a < this.filters.length; a++) {
		switch (this.filters[a][0].tagName.toLowerCase()) {
			case "input":
				break;
			case "select":
				this._loadSelectOptins.apply(this, this.filters[a]);
				break;
			case "div":
				this._loadComboOptins.apply(this, this.filters[a]);
				break
		}
	}
};
dhtmlXGridObject.prototype._filters_ready = function(c, a) {
	this.attachEvent("onXLE", this.refreshFilters);
	this.attachEvent("onRowCreated", function(m, l) {
		if (this._f_rowsBuffer) {
			for (var g = 0; g < this._f_rowsBuffer.length; g++) {
				if (this._f_rowsBuffer[g].idd == m) {
					return this._f_rowsBuffer[g] = l
				}
			}
		}
	});
	this.attachEvent("onClearAll", function() {
		this._f_rowsBuffer = null;
		if (!this.hdr.rows.length) {
			this.filters = []
		}
	});
	this.attachEvent("onSetSizes", this._filters_resize_combo);
	this.attachEvent("onResize", this._filters_resize_combo);
	this._filters_ready = function() {}
};
dhtmlXGridObject.prototype._filters_resize_combo = function() {
	if (!this.filters) {
		return
	}
	for (var a = 0; a < this.filters.length; a++) {
		if (this.filters[a][0].combo != null) {
			this.filters[a][0].combo.setSize(Math.round(this.filters[a][0].offsetWidth * 90 / 100))
		}
	}
	return true
};
dhtmlXGridObject.prototype._in_header_text_filter = function(c, a) {
	c.innerHTML = "<input type='text'>";
	c.onclick = c.onmousedown = function(g) {
		(g || event).cancelBubble = true;
		return true
	};
	c.onselectstart = function() {
		return (event.cancelBubble = true)
	};
	this.makeFilter(c.firstChild, a)
};
dhtmlXGridObject.prototype._in_header_text_filter_inc = function(c, a) {
	c.innerHTML = "<input type='text'>";
	c.onclick = c.onmousedown = function(g) {
		(g || event).cancelBubble = true;
		return true
	};
	c.onselectstart = function() {
		return (event.cancelBubble = true)
	};
	this.makeFilter(c.firstChild, a);
	c.firstChild._filter = function() {
		if (c.firstChild.value == "") {
			return ""
		}
		return function(g) {
			return (g.toString().toLowerCase().indexOf(c.firstChild.value.toLowerCase()) == 0)
		}
	};
	this._filters_ready()
};
dhtmlXGridObject.prototype._in_header_select_filter = function(c, a) {
	c.innerHTML = "<select></select>";
	c.onclick = function(g) {
		(g || event).cancelBubble = true;
		return false
	};
	this.makeFilter(c.firstChild, a)
};
dhtmlXGridObject.prototype._in_header_select_filter_strict = function(g, c) {
	g.innerHTML = "<select style='width:90%; font-size:8pt; font-family:Tahoma;'></select>";
	g.onclick = function(l) {
		(l || event).cancelBubble = true;
		return false
	};
	this.makeFilter(g.firstChild, c);
	var a = this.combos;
	g.firstChild._filter = function() {
		var l = g.firstChild.value;
		if (!l) {
			return ""
		}
		if (a[c]) {
			l = a[c].keys[a[c].values._dhx_find(l)]
		}
		l = l.toLowerCase();
		return function(m) {
			return (m.toString().toLowerCase() == l)
		}
	};
	this._filters_ready()
};
dhtmlXGridObject.prototype._in_header_combo_filter = function(c, a) {
	c.innerHTML = "<div style='width:100%; padding-left:2px; overflow:hidden; ' class='combo'></div>";
	c.onselectstart = function() {
		return (event.cancelBubble = true)
	};
	c.onclick = c.onmousedown = function(g) {
		(g || event).cancelBubble = true;
		return true
	};
	this.makeFilter(c.firstChild, a)
};
dhtmlXGridObject.prototype._search_common = function(c, a) {
	c.innerHTML = "<input type='text' style='width:90%; '>";
	c.onclick = c.onmousedown = function(g) {
		(g || event).cancelBubble = true;
		return true
	};
	c.onselectstart = function() {
		return (event.cancelBubble = true)
	}
};
dhtmlXGridObject.prototype._in_header_text_search = function(g, c, a) {
	this._search_common(g, c);
	this.makeSearch(g.firstChild, c)
};
dhtmlXGridObject.prototype._in_header_text_search_strict = function(c, a) {
	this._search_common(c, a);
	this.makeSearch(c.firstChild, a, true)
};
dhtmlXGridObject.prototype._in_header_numeric_filter = function(c, a) {
	this._in_header_text_filter.call(this, c, a);
	c.firstChild._filter = function() {
		var g = this.value;
		var m;
		var o = "==";
		var l = parseFloat(g.replace("=", ""));
		var n = null;
		if (g) {
			if (g.indexOf("..") != -1) {
				g = g.split("..");
				l = parseFloat(g[0]);
				n = parseFloat(g[1]);
				return function(q) {
					if (q >= l && q <= n) {
						return true
					}
					return false
				}
			}
			m = g.match(/>=|<=|>|</);
			if (m) {
				o = m[0];
				l = parseFloat(g.replace(o, ""))
			}
			return Function("v", " if (v " + o + " " + l + " ) return true; return false;")
		}
		return ""
	}
};
dhtmlXGridObject.prototype._in_header_master_checkbox = function(l, g, m) {
	l.innerHTML = m[0] + "<input type='checkbox' />" + m[1];
	var a = this;
	l.getElementsByTagName("input")[0].onclick = function(n) {
		a._build_m_order();
		var c = a._m_order ? a._m_order[g] : g;
		var o = this.checked ? 1 : 0;
		a.forEachRowA(function(r) {
			var q = this.cells(r, c);
			if (q.isCheckbox()) {
				q.setValue(o);
				q.cell.wasChanged = true
			}
			this.callEvent("onEditCell", [1, r, c, o]);
			this.callEvent("onCheckbox", [r, c, o])
		});
		(n || event).cancelBubble = true
	}
};
dhtmlXGridObject.prototype._in_header_stat_total = function(g, a, m) {
	var l = function() {
		var q = 0;
		this._build_m_order();
		var o = this._m_order ? this._m_order[a] : a;
		for (var n = 0; n < this.rowsBuffer.length; n++) {
			var c = parseFloat(this._get_cell_value(this.rowsBuffer[n], o));
			q += isNaN(c) ? 0 : c
		}
		return this._maskArr[o] ? this._aplNF(q, o) : (Math.round(q * 100) / 100)
	};
	this._stat_in_header(g, l, a, m, m)
};
dhtmlXGridObject.prototype._in_header_stat_multi_total = function(m, l, r) {
	var q = r[1].split(":");
	r[1] = "";
	for (var g = 0; g < q.length; g++) {
		q[g] = parseInt(q[g])
	}
	var n = function() {
		var w = 0;
		for (var u = 0; u < this.rowsBuffer.length; u++) {
			var s = 1;
			for (var c = 0; c < q.length; c++) {
				s *= parseFloat(this._get_cell_value(this.rowsBuffer[u], q[c]))
			}
			w += isNaN(s) ? 0 : s
		}
		return this._maskArr[l] ? this._aplNF(w, l) : (Math.round(w * 100) / 100)
	};
	var a = [];
	for (var o = 0; o < q.length; o++) {
		a[q[o]] = true
	}
	this._stat_in_header(m, n, a, r, r)
};
dhtmlXGridObject.prototype._in_header_stat_max = function(g, a, m) {
	var l = function() {
		this._build_m_order();
		var n = this._m_order ? this._m_order[a] : a;
		var o = -999999999;
		if (this.getRowsNum() == 0) {
			return "&nbsp;"
		}
		for (var c = 0; c < this.rowsBuffer.length; c++) {
			o = Math.max(o, parseFloat(this._get_cell_value(this.rowsBuffer[c], n)))
		}
		return this._maskArr[a] ? this._aplNF(o, a) : o
	};
	this._stat_in_header(g, l, a, m)
};
dhtmlXGridObject.prototype._in_header_stat_min = function(g, a, m) {
	var l = function() {
		this._build_m_order();
		var n = this._m_order ? this._m_order[a] : a;
		var o = 999999999;
		if (this.getRowsNum() == 0) {
			return "&nbsp;"
		}
		for (var c = 0; c < this.rowsBuffer.length; c++) {
			o = Math.min(o, parseFloat(this._get_cell_value(this.rowsBuffer[c], n)))
		}
		return this._maskArr[a] ? this._aplNF(o, a) : o
	};
	this._stat_in_header(g, l, a, m)
};
dhtmlXGridObject.prototype._in_header_stat_average = function(g, a, m) {
	var l = function() {
		this._build_m_order();
		var o = this._m_order ? this._m_order[a] : a;
		var r = 0;
		var q = 0;
		if (this.getRowsNum() == 0) {
			return "&nbsp;"
		}
		for (var n = 0; n < this.rowsBuffer.length; n++) {
			var c = parseFloat(this._get_cell_value(this.rowsBuffer[n], o));
			if (!isNaN(c)) {
				r += c;
				q++
			}
		}
		return this._maskArr[a] ? this._aplNF(r / q, a) : (Math.round(r / q * 100) / 100)
	};
	this._stat_in_header(g, l, a, m)
};
dhtmlXGridObject.prototype._in_header_stat_count = function(g, a, m) {
	var l = function() {
		return this.getRowsNum()
	};
	this._stat_in_header(g, l, a, m)
};
dhtmlXGridObject.prototype._stat_in_header = function(g, l, a, o) {
	var m = this;
	var n = function() {
		this.dma(true);
		g.innerHTML = (o[0] ? o[0] : "") + l.call(this) + (o[1] ? o[1] : "");
		this.dma(false);
		this.callEvent("onStatReady", [])
	};
	if (!this._stat_events) {
		this._stat_events = [];
		this.attachEvent("onClearAll", function() {
			if (!this.hdr.rows[1]) {
				for (var q = 0; q < this._stat_events.length; q++) {
					for (var c = 0; c < 4; c++) {
						this.detachEvent(this._stat_events[q][c])
					}
				}
				this._stat_events = []
			}
		})
	}
	this._stat_events.push([this.attachEvent("onGridReconstructed", n), this.attachEvent("onXLE", n), this.attachEvent("onFilterEnd", n), this.attachEvent("onEditCell", function(c, r, q) {
		if (c == 2 && (q == a || (a && a[q]))) {
			n.call(this)
		}
		return true
	})]);
	g.innerHTML = ""
};
dhtmlXGridObject.prototype.loadCSVFile = function(c, a) {
	this.load(c, a, "csv")
};
dhtmlXGridObject.prototype.enableCSVAutoID = function(a) {
	this._csvAID = dhx4.s2b(a)
};
dhtmlXGridObject.prototype.enableCSVHeader = function(a) {
	this._csvHdr = dhx4.s2b(a)
};
dhtmlXGridObject.prototype.setCSVDelimiter = function(a) {
	this.csv.cell = a
};
dhtmlXGridObject.prototype._csvAID = true;
dhtmlXGridObject.prototype.loadCSVString = function(a) {
	this.parse(a, "csv")
};
dhtmlXGridObject.prototype.serializeToCSV = function(q) {
	this.editStop();
	if (this._mathSerialization) {
		this._agetm = "getMathValue"
	} else {
		if (this._strictText || q) {
			this._agetm = "getTitle"
		} else {
			this._agetm = "getValue"
		}
	}
	var n = [];
	if (this._csvHdr) {
		for (var m = 1; m < this.hdr.rows.length; m++) {
			var c = [];
			for (var o = 0; o < this._cCount; o++) {
				if ((!this._srClmn) || (this._srClmn[o])) {
					c.push(this.getColumnLabel(o, m - 1))
				}
			}
			n.push(this.csvParser.str(c, this.csv.cell, this.csv.row))
		}
	}
	var o = 0;
	var l = this.rowsBuffer.length;
	for (o; o < l; o++) {
		var g = this._serializeRowToCVS(null, o);
		if (g != "") {
			n.push(g)
		}
	}
	return this.csvParser.block(n, this.csv.row)
};
dhtmlXGridObject.prototype._serializeRowToCVS = function(a, s, g, o) {
	var q = new Array();
	if (!a) {
		a = this.render_row(s);
		if (this._fake && !this._fake.rowsAr[a.idd]) {
			this._fake.render_row(s)
		}
	}
	if (!this._csvAID) {
		q[q.length] = a.idd
	}
	g = g || 0;
	o = o || this._cCount;
	var w = false;
	var l = g;
	while (a.childNodes[g]._cellIndex > l && g) {
		g--
	}
	for (var v = g; l < o; v++) {
		if (!a.childNodes[v]) {
			break
		}
		var c = a.childNodes[v]._cellIndex;
		if (((!this._srClmn) || (this._srClmn[c])) && (!this._serialize_visible || !this._hrrar[c])) {
			var m = a.childNodes[v];
			var n = this.cells(a.idd, c);
			while (l != c) {
				l++;
				q.push("");
				if (l >= o) {
					break
				}
			}
			if (l >= o) {
				break
			}
			l++;
			if (n.cell) {
				zxVal = n[this._agetm]()
			} else {
				zxVal = ""
			}
			if ((this._chAttr) && (n.wasChanged())) {
				w = true
			}
			q[q.length] = ((zxVal === null) ? "" : zxVal);
			if (this._ecspn && m.colSpan && m.colSpan > 1) {
				m = m.colSpan - 1;
				for (var x = 0; x < m; x++) {
					q[q.length] = "";
					l++
				}
			}
		} else {
			l++
		}
	}
	if ((this._onlChAttr) && (!w)) {
		return ""
	}
	return this.csvParser.str(q, this.csv.cell, this.csv.row)
};
dhtmlXGridObject.prototype.toClipBoard = function(a) {
	if (window.clipboardData) {
		window.clipboardData.setData("Text", a)
	} else {
		(new Clipboard()).copy(a)
	}
};
dhtmlXGridObject.prototype.fromClipBoard = function() {
	if (window.clipboardData) {
		return window.clipboardData.getData("Text")
	} else {
		return (new Clipboard()).paste()
	}
};
dhtmlXGridObject.prototype.cellToClipboard = function(g, c) {
	if ((!g) || (!c && c !== 0)) {
		if (!this.selectedRows[0]) {
			return
		}
		g = this.selectedRows[0].idd;
		c = this.cell._cellIndex
	}
	var a = this.cells(g, c);
	this.toClipBoard(((a.getLabel ? a.getLabel() : a.getValue()) || "").toString())
};
dhtmlXGridObject.prototype.updateCellFromClipboard = function(g, c) {
	if ((!g) || (!c)) {
		if (!this.selectedRows[0]) {
			return
		}
		g = this.selectedRows[0].idd;
		c = this.cell._cellIndex
	}
	var a = this.cells(g, c);
	a[a.setImage ? "setLabel" : "setValue"](this.fromClipBoard())
};
dhtmlXGridObject.prototype.rowToClipboard = function(l) {
	var a = "";
	if (this._mathSerialization) {
		this._agetm = "getMathValue"
	} else {
		if (this._strictText) {
			this._agetm = "getTitle"
		} else {
			this._agetm = "getValue"
		}
	}
	this._serialize_visible = !this._fake;
	if (l) {
		a = this._serializeRowToCVS(this.getRowById(l))
	} else {
		var g = [];
		for (var c = 0; c < this.selectedRows.length; c++) {
			g[g.length] = this._serializeRowToCVS(this.selectedRows[c]);
			a = this.csvParser.block(g, this.csv.row)
		}
	}
	this._serialize_visible = false;
	this.toClipBoard(a)
};
dhtmlXGridObject.prototype.updateRowFromClipboard = function(m) {
	var a = this.fromClipBoard();
	if (!a) {
		return
	}
	if (m) {
		var l = this.getRowById(m)
	} else {
		var l = this.selectedRows[0]
	}
	if (!l) {
		return
	}
	var n = this.csvParser;
	a = n.unblock(a, this.csv.cell, this.csv.row)[0];
	if (!this._csvAID) {
		a.splice(0, 1)
	}
	for (var g = 0; g < a.length; g++) {
		var c = this.cells3(l, g);
		c[c.setImage ? "setLabel" : "setValue"](a[g])
	}
};
dhtmlXGridObject.prototype.csvParser = {
	block: function(a, c) {
		return a.join(c)
	},
	unblock: function(n, a, m) {
		var l = (n || "").split(m);
		for (var c = 0; c < l.length; c++) {
			l[c] = (l[c] || "").split(a)
		}
		var g = l.length - 1;
		if (l[g].length == 1 && l[g][0] == "") {
			l.splice(g, 1)
		}
		return l
	},
	str: function(c, a, g) {
		return c.join(a)
	}
};
dhtmlXGridObject.prototype.csvExtParser = {
	_quote: RegExp('"', "g"),
	_quote_esc: RegExp('\\\\"', "g"),
	block: function(a, c) {
		return a.join(c)
	},
	unblock: function(q, u, w) {
		var g = [
			[]
		];
		var c = 0;
		if (!q) {
			return g
		}
		var r = /^[ ]*"/;
		var o = /"[ ]*$/;
		var a = new RegExp(".*" + w + ".*$");
		var m = q.split(u);
		for (var l = 0; l < m.length; l++) {
			if (m[l].match(r)) {
				var v = m[l].replace(r, "");
				while (!m[l].match(o)) {
					l++;
					v += m[l]
				}
				g[c].push(v.replace(o, "").replace(this._quote_esc, '"'))
			} else {
				if (m[l].match(a)) {
					var n = m[l].indexOf(w);
					g[c].push(m[l].substr(0, n));
					c++;
					g[c] = [];
					m[l] = m[l].substr(n + 1);
					l--
				} else {
					if (m[l] || l != m.length - 1) {
						g[c].push(m[l])
					}
				}
			}
		}
		var s = g.length - 1;
		if (s > 0 && !g[s].length) {
			g.splice(s, 1)
		}
		return g
	},
	str: function(g, a, l) {
		for (var c = 0; c < g.length; c++) {
			g[c] = '"' + g[c].replace(this._quote, '\\"') + '"'
		}
		return g.join(a)
	}
};
dhtmlXGridObject.prototype.addRowFromClipboard = function() {
	var a = this.fromClipBoard();
	if (!a) {
		return
	}
	var g = this.csvParser.unblock(a, this.csv.cell, this.csv.row);
	for (var c = 0; c < g.length; c++) {
		if (g[c]) {
			a = g[c];
			if (!a.length) {
				continue
			}
			if (this._csvAID) {
				this.addRow(this.getRowsNum() + 2, a)
			} else {
				if (this.rowsAr[a[0]]) {
					a[0] = this.uid()
				}
				this.addRow(a[0], a.slice(1))
			}
		}
	}
};
dhtmlXGridObject.prototype.gridToClipboard = function() {
	this.toClipBoard(this.serializeToCSV())
};
dhtmlXGridObject.prototype.gridFromClipboard = function() {
	var a = this.fromClipBoard();
	if (!a) {
		return
	}
	this.loadCSVString(a)
};
dhtmlXGridObject.prototype.getXLS = function(o) {
	if (!this.xslform) {
		this.xslform = document.createElement("FORM");
		this.xslform.action = (o || "") + "xls.php";
		this.xslform.method = "post";
		this.xslform.target = (_isIE ? "_blank" : "");
		document.body.appendChild(this.xslform);
		var n = document.createElement("INPUT");
		n.type = "hidden";
		n.name = "csv";
		this.xslform.appendChild(n);
		var m = document.createElement("INPUT");
		m.type = "hidden";
		m.name = "csv_header";
		this.xslform.appendChild(m)
	}
	var q = this.serializeToCSV();
	this.xslform.childNodes[0].value = q;
	var g = [];
	var a = this._cCount;
	for (var c = 0; c < a; c++) {
		g.push(this.getHeaderCol(c))
	}
	g = g.join(",");
	this.xslform.childNodes[1].value = g;
	this.xslform.submit()
};
dhtmlXGridObject.prototype.printView = function(u, g) {
	var r = "<style>TD { font-family:Arial; text-align:center; padding-left:2px;padding-right:2px; } \n td.filter input, td.filter select { display:none; }	\n  </style>";
	var D = null;
	if (this._fake) {
		D = [].concat(this._hrrar);
		for (var C = 0; C < this._fake._cCount; C++) {
			this._hrrar[C] = null
		}
	}
	r += "<base  href='" + document.location.href + "'></base>";
	if (!this.parentGrid) {
		r += (u || "")
	}
	r += '<table width="100%" border="2px" cellpadding="0" cellspacing="0">';
	var s = Math.max(this.rowsBuffer.length, this.rowsCol.length);
	var q = this._cCount;
	var v = this._printWidth();
	r += '<tr class="header_row_1">';
	for (var C = 0; C < q; C++) {
		if (this._hrrar && this._hrrar[C]) {
			continue
		}
		var m = this.hdr.rows[1].cells[this.hdr.rows[1]._childIndexes ? this.hdr.rows[1]._childIndexes[parseInt(C)] : C];
		var a = (m.colSpan || 1);
		var I = (m.rowSpan || 1);
		for (var A = 1; A < a; A++) {
			v[C] += v[A]
		}
		r += '<td rowspan="' + I + '" width="' + v[C] + '%" style="background-color:lightgrey;" colspan="' + a + '">' + this.getHeaderCol(C) + "</td>";
		C += a - 1
	}
	r += "</tr>";
	for (var C = 2; C < this.hdr.rows.length; C++) {
		if (_isIE) {
			r += "<tr style='background-color:lightgrey' class='header_row_" + C + "'>";
			var l = this.hdr.rows[C].childNodes;
			for (var A = 0; A < l.length; A++) {
				if (!this._hrrar || !this._hrrar[l[A]._cellIndex]) {
					r += l[A].outerHTML
				}
			}
			r += "</tr>"
		} else {
			r += "<tr class='header_row_" + C + "' style='background-color:lightgrey'>" + (this._fake ? this._fake.hdr.rows[C].innerHTML : "") + this.hdr.rows[C].innerHTML + "</tr>"
		}
	}
	for (var C = 0; C < s; C++) {
		r += "<tr>";
		if (this.rowsCol[C] && this.rowsCol[C]._cntr) {
			r += this.rowsCol[C].innerHTML.replace(/<img[^>]*>/gi, "") + "</tr>";
			continue
		}
		if (this.rowsCol[C] && this.rowsCol[C].style.display == "none") {
			continue
		}
		var o;
		if (this.rowsCol[C]) {
			o = this.rowsCol[C].idd
		} else {
			if (this.rowsBuffer[C]) {
				o = this.rowsBuffer[C].idd
			} else {
				continue
			}
		}
		for (var A = 0; A < q; A++) {
			if (this._hrrar && this._hrrar[A]) {
				continue
			}
			if (this.rowsAr[o] && this.rowsAr[o].tagName == "TR") {
				var H = this.cells(o, A);
				if (H._setState) {
					var w = ""
				} else {
					if (H.getContent) {
						w = H.getContent()
					} else {
						if (H.getImage || H.combo) {
							var w = H.cell.innerHTML
						} else {
							var w = H.getValue()
						}
					}
				}
			} else {
				var w = this._get_cell_value(this.rowsBuffer[C], A)
			}
			var x = this.columnColor[A] ? "background-color:" + this.columnColor[A] + ";" : "";
			var y = this.cellAlign[A] ? "text-align:" + this.cellAlign[A] + ";" : "";
			var E = H.getAttribute("colspan");
			r += '<td style="' + x + y + '" ' + (E ? 'colSpan="' + E + '"' : "") + ">" + (w === "" ? "&nbsp;" : w) + "</td>";
			if (E) {
				A += E - 1
			}
		}
		r += "</tr>";
		if (this.rowsCol[C] && this.rowsCol[C]._expanded) {
			var n = this.cells4(this.rowsCol[C]._expanded.ctrl);
			if (n.getSubGrid) {
				r += '<tr><td colspan="' + q + '">' + n.getSubGrid().printView() + "</td></tr>"
			} else {
				r += '<tr><td colspan="' + q + '">' + this.rowsCol[C]._expanded.innerHTML + "</td></tr>"
			}
		}
	}
	if (this.ftr) {
		for (var C = 1; C < this.ftr.childNodes[0].rows.length; C++) {
			r += "<tr style='background-color:lightgrey'>" + ((this._fake) ? this._fake.ftr.childNodes[0].rows[C].innerHTML : "") + this.ftr.childNodes[0].rows[C].innerHTML + "</tr>"
		}
	}
	r += "</table>";
	if (this.parentGrid) {
		return r
	}
	r += (g || "");
	var F = window.open("", "_blank");
	F.document.write(r);
	F.document.write("<script>window.onerror=function(){return true;}<\/script>");
	F.document.close();
	if (this._fake) {
		this._hrrar = D
	}
};
dhtmlXGridObject.prototype._printWidth = function() {
	var m = [];
	var l = 0;
	for (var g = 0; g < this._cCount; g++) {
		var a = this.getColWidth(g);
		m.push(a);
		l += a
	}
	var o = [];
	var c = 0;
	for (var g = 0; g < m.length; g++) {
		var n = Math.floor((m[g] / l) * 100);
		c += n;
		o.push(n)
	}
	o[o.length - 1] += 100 - c;
	return o
};
if (!window.clipboardData) {
	window.clipboardData = {
		_make: function() {
			var c = Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);
			if (!c) {
				return null
			}
			var a = Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);
			if (!a) {
				return null
			}
			a.addDataFlavor("text/unicode");
			var g = Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);
			this._p = [c, a, g];
			return true
		},
		setData: function(a, l) {
			try {
				netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")
			} catch (g) {
				dhx4.callEvent("onClipboardError", ["Access to clipboard denied", a, l]);
				return ""
			}
			if (!this._make()) {
				return false
			}
			this._p[2].data = l;
			this._p[1].setTransferData("text/unicode", this._p[2], l.length * 2);
			var c = Components.interfaces.nsIClipboard;
			this._p[0].setData(this._p[1], null, c.kGlobalClipboard)
		},
		getData: function(a) {
			try {
				netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")
			} catch (g) {
				dhx4.callEvent("onClipboardError", ["Access to clipboard denied", a]);
				return ""
			}
			if (!this._make()) {
				return false
			}
			this._p[0].getData(this._p[1], this._p[0].kGlobalClipboard);
			var c = new Object();
			var l = new Object();
			try {
				this._p[1].getTransferData("text/unicode", l, c)
			} catch (g) {
				return ""
			}
			if (l) {
				l = l.value.QueryInterface(Components.interfaces.nsISupportsString)
			}
			if (l) {
				return l.data.substring(0, c.value / 2)
			}
			return ""
		}
	}
}
dhtmlXGridObject.prototype.enableBlockSelection = function(g) {
	if (typeof this._bs_mode == "undefined") {
		var a = this;
		this.obj.onmousedown = function(l) {
			if (a._bs_mode) {
				a._OnSelectionStart((l || event), this)
			}
			return true
		};
		this._CSVRowDelimiter = this.csv.row;
		this.attachEvent("onResize", function() {
			a._HideSelection();
			return true
		});
		this.attachEvent("onGridReconstructed", function() {
			a._HideSelection();
			return true
		});
		this.attachEvent("onFilterEnd", this._HideSelection)
	}
	if (g === false) {
		this._bs_mode = false;
		return this._HideSelection()
	} else {
		this._bs_mode = true
	}
	if (!window.dhx4.isIPad) {
		var c = this._clip_area = document.createElement("textarea");
		c.style.cssText = "position:absolute; width:1px; height:1px; overflow:hidden; color:transparent; background-color:transparent; bottom:1px; right:1px; border:none;";
		c.onkeydown = function(l) {
			l = l || event;
			if (l.keyCode == 86 && (l.ctrlKey || l.metaKey)) {
				a.pasteBlockFromClipboard()
			}
		};
		document.body.insertBefore(this._clip_area, document.body.firstChild);
		dhtmlxEvent(this.entBox, "click", function() {
			if (!a.editor) {
				a._clip_area.select()
			}
		})
	}
};
dhtmlXGridObject.prototype.forceLabelSelection = function(a) {
	this._strictText = dhx4.s2b(a)
};
dhtmlXGridObject.prototype._OnSelectionStart = function(g, l) {
	var c = this;
	if (g.button == 2) {
		return
	}
	var m = g.srcElement || g.target;
	if (this.editor) {
		if (m.tagName && (m.tagName == "INPUT" || m.tagName == "TEXTAREA")) {
			return
		}
		this.editStop()
	}
	c.setActive(true);
	var o = this.getPosition(this.obj);
	var a = g.clientX - o[0] + (document.body.scrollLeft || (document.documentElement ? document.documentElement.scrollLeft : 0));
	var n = g.clientY - o[1] + (document.body.scrollTop || (document.documentElement ? document.documentElement.scrollTop : 0));
	this._CreateSelection(a - 4, n - 4);
	if (m == this._selectionObj) {
		this._HideSelection();
		this._startSelectionCell = null
	} else {
		while (m && (!m.tagName || m.tagName.toLowerCase() != "td")) {
			m = m.parentNode
		}
		this._startSelectionCell = m
	}
	if (this._startSelectionCell) {
		if (!this.callEvent("onBeforeBlockSelected", [this._startSelectionCell.parentNode.idd, this._startSelectionCell._cellIndex])) {
			return this._startSelectionCell = null
		}
	}
	this.obj.onmousedown = null;
	this.obj[_isIE ? "onmouseleave" : "onmouseout"] = function(q) {
		if (c._blsTimer) {
			window.clearTimeout(c._blsTimer)
		}
	};
	this.obj.onmmold = this.obj.onmousemove;
	this._init_pos = [a, n];
	this._selectionObj.onmousemove = this.obj.onmousemove = function(q) {
		q = q || g;
		if (q.preventDefault) {
			q.preventDefault()
		} else {
			q.returnValue = false
		}
		c._OnSelectionMove(q)
	};
	this._oldDMP = document.body.onmouseup;
	document.body.onmouseup = function(q) {
		q = q || g;
		c._OnSelectionStop(q, this);
		return true
	};
	this.callEvent("onBeforeBlockSelection", []);
	document.body.onselectstart = function() {
		return false
	}
};
dhtmlXGridObject.prototype._getCellByPos = function(a, l) {
	a = a;
	if (this._fake) {
		a += this._fake.objBox.scrollWidth
	}
	l = l;
	var c = 0;
	for (var g = 0; g < this.obj.rows.length; g++) {
		l -= this.obj.rows[g].offsetHeight;
		if (l <= 0) {
			c = this.obj.rows[g];
			break
		}
	}
	if (!c || !c.idd) {
		return null
	}
	for (var g = 0; g < this._cCount; g++) {
		a -= this.getColWidth(g);
		if (a <= 0) {
			while (true) {
				if (c._childIndexes && c._childIndexes[g + 1] == c._childIndexes[g]) {
					c = c.previousSibling
				} else {
					return this.cells(c.idd, g).cell
				}
			}
		}
	}
	return null
};
dhtmlXGridObject.prototype._OnSelectionMove = function(l) {
	var y = this;
	this._ShowSelection();
	var u = this.getPosition(this.obj);
	var o = l.clientX - u[0] + (document.body.scrollLeft || (document.documentElement ? document.documentElement.scrollLeft : 0));
	var n = l.clientY - u[1] + (document.body.scrollTop || (document.documentElement ? document.documentElement.scrollTop : 0));
	if ((Math.abs(this._init_pos[0] - o) < 5) && (Math.abs(this._init_pos[1] - n) < 5)) {
		return this._HideSelection()
	}
	var w = this._endSelectionCell;
	if (this._startSelectionCell == null) {
		this._endSelectionCell = this._startSelectionCell = this.getFirstParentOfType(l.srcElement || l.target, "TD")
	} else {
		if (l.srcElement || l.target) {
			if ((l.srcElement || l.target).className == "dhtmlxGrid_selection") {
				this._endSelectionCell = (this._getCellByPos(o, n) || this._endSelectionCell)
			} else {
				var x = this.getFirstParentOfType(l.srcElement || l.target, "TD");
				if (x.parentNode.idd) {
					this._endSelectionCell = x
				}
			}
		}
	}
	if (this._endSelectionCell) {
		if (!this.callEvent("onBeforeBlockSelected", [this._endSelectionCell.parentNode.idd, this._endSelectionCell._cellIndex])) {
			this._endSelectionCell = w
		}
	}
	var m = this.objBox.scrollLeft + this.objBox.clientWidth;
	var c = this.objBox.scrollTop + this.objBox.clientHeight;
	var r = this.objBox.scrollLeft;
	var q = this.objBox.scrollTop;
	var g = false;
	if (this._blsTimer) {
		window.clearTimeout(this._blsTimer)
	}
	if (o + 20 >= m) {
		this.objBox.scrollLeft = this.objBox.scrollLeft + 20;
		g = true
	} else {
		if (o - 20 < r) {
			this.objBox.scrollLeft = this.objBox.scrollLeft - 20;
			g = true
		}
	}
	if (n + 20 >= c && !this._realfake) {
		this.objBox.scrollTop = this.objBox.scrollTop + 20;
		g = true
	} else {
		if (n - 20 < q && !this._realfake) {
			this.objBox.scrollTop = this.objBox.scrollTop - 20;
			g = true
		}
	}
	this._selectionArea = this._RedrawSelectionPos(this._startSelectionCell, this._endSelectionCell);
	if (g) {
		var v = l.clientX;
		var s = l.clientY;
		this._blsTimer = window.setTimeout(function() {
			y._OnSelectionMove({
				clientX: v,
				clientY: s
			})
		}, 100)
	}
};
dhtmlXGridObject.prototype._OnSelectionStop = function(c) {
	var a = this;
	if (this._blsTimer) {
		window.clearTimeout(this._blsTimer)
	}
	this.obj.onmousedown = function(l) {
		if (a._bs_mode) {
			a._OnSelectionStart((l || c), this)
		}
		return true
	};
	this.obj.onmousemove = this.obj.onmmold || null;
	this._selectionObj.onmousemove = null;
	document.body.onmouseup = this._oldDMP || null;
	if (parseInt(this._selectionObj.style.width) < 2 && parseInt(this._selectionObj.style.height) < 2) {
		this._HideSelection()
	} else {
		var g = this.getFirstParentOfType(c.srcElement || c.target, "TD");
		if ((!g) || (!g.parentNode.idd)) {
			g = this._endSelectionCell
		}
		while (g && (!g.tagName || g.tagName.toLowerCase() != "td")) {
			g = g.parentNode
		}
		if (!g) {
			return this._HideSelection()
		}
		this._stopSelectionCell = g;
		this._selectionArea = this._RedrawSelectionPos(this._startSelectionCell, this._stopSelectionCell);
		this.callEvent("onBlockSelected", [])
	}
	document.body.onselectstart = function() {}
};
dhtmlXGridObject.prototype._RedrawSelectionPos = function(v, o) {
	if (v.parentNode.grid != o.parentNode.grid) {
		return this._selectionArea
	}
	var s = {};
	s.LeftTopCol = v._cellIndex;
	s.LeftTopRow = this.getRowIndex(v.parentNode.idd);
	s.RightBottomCol = o._cellIndex;
	s.RightBottomRow = this.getRowIndex(o.parentNode.idd);
	var l = v.offsetWidth;
	var g = v.offsetHeight;
	v = this.getPosition(v, this.obj);
	var w = o.offsetWidth;
	var q = o.offsetHeight;
	o = this.getPosition(o, this.obj);
	if (v[0] < o[0]) {
		var m = v[0];
		var n = o[0] + w
	} else {
		var r = s.RightBottomCol;
		s.RightBottomCol = s.LeftTopCol;
		s.LeftTopCol = r;
		var m = o[0];
		var n = v[0] + l
	}
	if (v[1] < o[1]) {
		var u = v[1];
		var a = o[1] + q
	} else {
		var r = s.RightBottomRow;
		s.RightBottomRow = s.LeftTopRow;
		s.LeftTopRow = r;
		var u = o[1];
		var a = v[1] + g
	}
	var x = n - m;
	var c = a - u;
	this._selectionObj.style.left = m + "px";
	this._selectionObj.style.top = u + "px";
	this._selectionObj.style.width = x + "px";
	this._selectionObj.style.height = c + "px";
	return s
};
dhtmlXGridObject.prototype._CreateSelection = function(a, g) {
	if (this._selectionObj == null) {
		var c = document.createElement("div");
		c.style.position = "absolute";
		c.style.display = "none";
		c.className = "dhtmlxGrid_selection";
		this._selectionObj = c;
		this._selectionObj.onmousedown = function(l) {
			l = l || event;
			if (l.button == 2 || (_isMacOS && l.ctrlKey)) {
				return this.parentNode.grid.callEvent("onBlockRightClick", ["BLOCK", l])
			}
		};
		this._selectionObj.oncontextmenu = function(l) {
			(l || event).cancelBubble = true;
			return false
		};
		this.objBox.appendChild(this._selectionObj)
	}
	this._selectionObj.style.width = "0px";
	this._selectionObj.style.height = "0px";
	this._selectionObj.style.left = a + "px";
	this._selectionObj.style.top = g + "px";
	this._selectionObj.startX = a;
	this._selectionObj.startY = g
};
dhtmlXGridObject.prototype._ShowSelection = function() {
	if (this._selectionObj) {
		this._selectionObj.style.display = ""
	}
};
dhtmlXGridObject.prototype._HideSelection = function() {
	if (this._selectionObj) {
		this._selectionObj.style.display = "none"
	}
	this._selectionArea = null;
	if (this._clip_area) {
		this._clip_area.value = "";
		this._clip_area.blur()
	}
};
dhtmlXGridObject.prototype.copyBlockToClipboard = function() {
	if (!this._clip_area) {
		return
	}
	if (this._selectionArea != null) {
		var g = new Array();
		if (this._mathSerialization) {
			this._agetm = "getMathValue"
		} else {
			if (this._strictText) {
				this._agetm = "getTitle"
			} else {
				this._agetm = "getValue"
			}
		}
		this._serialize_visible = true;
		for (var a = this._selectionArea.LeftTopRow; a <= this._selectionArea.RightBottomRow; a++) {
			var c = this._serializeRowToCVS(this.rowsBuffer[a], null, this._selectionArea.LeftTopCol, this._selectionArea.RightBottomCol + 1);
			if (!this._csvAID) {
				g[g.length] = c.substr(c.indexOf(this.csv.cell) + 1)
			} else {
				g[g.length] = c
			}
		}
		g = g.join(this._CSVRowDelimiter);
		this._clip_area.value = g;
		this._clip_area.select();
		this._serialize_visible = false
	}
};
dhtmlXGridObject.prototype.pasteBlockFromClipboard = function() {
	if (!this._clip_area) {
		return
	}
	this._clip_area.select();
	var a = this;
	window.setTimeout(function() {
		a._pasteBlockFromClipboard();
		a = null
	}, 1)
};
dhtmlXGridObject.prototype._pasteBlockFromClipboard = function() {
	var q = this._clip_area.value;
	if (!q) {
		return
	}
	if (this._selectionArea != null) {
		var x = this._selectionArea.LeftTopRow;
		var a = this._selectionArea.LeftTopCol
	} else {
		if (this.cell != null && !this.editor) {
			var x = this.getRowIndex(this.cell.parentNode.idd);
			var a = this.cell._cellIndex
		} else {
			return false
		}
	}
	q = this.csvParser.unblock(q, this.csv.cell, this.csv.row);
	var r = x + q.length;
	var v = a + q[0].length;
	if (v > this._cCount) {
		v = this._cCount
	}
	var m = 0;
	for (var s = x; s < r; s++) {
		var y = this.render_row(s);
		if (y == -1) {
			continue
		}
		var g = 0;
		for (var o = a; o < v; o++) {
			if (this._hrrar[o] && !this._fake) {
				v = Math.max(v + 1, this._cCount);
				continue
			}
			var u = this.cells3(y, o);
			if (u.isDisabled()) {
				g++;
				continue
			}
			if (this._onEditUndoRedo) {
				this._onEditUndoRedo(2, y.idd, o, q[m][g], u.getValue())
			}
			if (u.combo) {
				var w = u.combo.values;
				for (var c = 0; c < w.length; c++) {
					if (q[m][g] == w[c]) {
						u.setValue(u.combo.keys[c]);
						w = null;
						break
					}
				}
				if (w != null && u.editable) {
					u.setValue(q[m][g++])
				} else {
					g++
				}
			} else {
				u[u.setImage ? "setLabel" : "setValue"](q[m][g++])
			}
			u.cell.wasChanged = true
		}
		this.callEvent("onRowPaste", [y.idd]);
		m++
	}
};
dhtmlXGridObject.prototype.getSelectedBlock = function() {
	if (this._selectionArea) {
		return this._selectionArea
	} else {
		if (this.getSelectedRowId() !== null) {
			return {
				LeftTopRow: this.getSelectedRowId(),
				LeftTopCol: this.getSelectedCellIndex(),
				RightBottomRow: this.getSelectedRowId(),
				RightBottomCol: this.getSelectedCellIndex()
			}
		} else {
			return null
		}
	}
};
dhtmlXGridObject.prototype.enableSmartRendering = function(g, c, a) {
	if (arguments.length > 2) {
		if (c && !this.rowsBuffer[c - 1]) {
			this.rowsBuffer[c - 1] = 0
		}
		c = a
	}
	this._srnd = dhx4.s2b(g);
	this._srdh = this._srdh || 20;
	this._dpref = c || 0
};
dhtmlXGridObject.prototype.enablePreRendering = function(a) {
	this._srnd_pr = parseInt(a || 50)
};
dhtmlXGridObject.prototype.forceFullLoading = function(a, m) {
	for (var g = 0; g < this.rowsBuffer.length; g++) {
		if (!this.rowsBuffer[g]) {
			var l = a || (this.rowsBuffer.length - g);
			if (this.callEvent("onDynXLS", [g, l])) {
				var c = this;
				this.load(this.xmlFileUrl + dhtmlx.url(this.xmlFileUrl) + "posStart=" + g + "&count=" + l, function() {
					window.setTimeout(function() {
						c.forceFullLoading(a, m)
					}, 100)
				}, this._data_type)
			}
			return
		}
	}
	if (m) {
		m.call(this)
	}
};
dhtmlXGridObject.prototype.setAwaitedRowHeight = function(a) {
	this._srdh = parseInt(a)
};
dhtmlXGridObject.prototype._get_view_size = function() {
	return Math.floor(parseInt(this.entBox.offsetHeight) / this._srdh) + 2
};
dhtmlXGridObject.prototype._add_filler = function(o, a, c, l) {
	if (!a) {
		return null
	}
	var n = "__filler__";
	var m = this._prepareRow(n);
	m.firstChild.style.width = "1px";
	m.firstChild.style.padding = m.firstChild.style.margin = "0px";
	for (var g = 1; g < m.childNodes.length; g++) {
		m.childNodes[g].style.display = "none"
	}
	m.firstChild.style.height = a * this._srdh + "px";
	c = c || this.rowsCol[o];
	if (c && c.nextSibling) {
		c.parentNode.insertBefore(m, c.nextSibling)
	} else {
		if (_isKHTML) {
			this.obj.appendChild(m)
		} else {
			this.obj.rows[0].parentNode.appendChild(m)
		}
	}
	this.callEvent("onAddFiller", [o, a, m, c, l]);
	return [o, a, m]
};
dhtmlXGridObject.prototype._update_srnd_view = function() {
	var n = Math.floor(this.objBox.scrollTop / this._srdh);
	var c = n + this._get_view_size();
	if (this.multiLine) {
		var o = this.objBox.scrollTop;
		n = 0;
		while (o > 0) {
			o -= this.rowsCol[n] ? this.rowsCol[n].offsetHeight : this._srdh;
			n++
		}
		c = n + this._get_view_size();
		if (n > 0) {
			n--
		}
	}
	c += (this._srnd_pr || 0);
	if (c > this.rowsBuffer.length) {
		c = this.rowsBuffer.length
	}
	for (var l = n; l < c; l++) {
		if (!this.rowsCol[l]) {
			var m = this._add_from_buffer(l);
			if (m == -1) {
				if (this.xmlFileUrl) {
					if (this._dpref && this.rowsBuffer[c - 1]) {
						var g = this._dpref ? this._dpref : (c - l);
						var a = Math.max(0, Math.min(l, c - this._dpref));
						this._current_load = [a, c - a]
					} else {
						this._current_load = [l, (this._dpref ? this._dpref : (c - l))]
					}
					if (this.callEvent("onDynXLS", this._current_load)) {
						this.load(this.xmlFileUrl + dhtmlx.url(this.xmlFileUrl) + "posStart=" + this._current_load[0] + "&count=" + this._current_load[1], this._data_type)
					}
				}
				return
			} else {
				if (this._tgle) {
					this._updateLine(this._h2.get[this.rowsBuffer[l].idd], this.rowsBuffer[l]);
					this._updateParentLine(this._h2.get[this.rowsBuffer[l].idd], this.rowsBuffer[l])
				}
				if (l && l == (this._realfake ? this._fake : this)["_r_select"]) {
					this.selectCell(l, this.cell ? this.cell._cellIndex : 0, true)
				}
			}
		}
	}
	if (this._fake && !this._realfake && this.multiLine) {
		this._fake.objBox.scrollTop = this.objBox.scrollTop
	}
};
dhtmlXGridObject.prototype._add_from_buffer = function(l) {
	var m = this.render_row(l);
	if (m == -1) {
		return -1
	}
	if (m._attrs.selected || m._attrs.select) {
		this.selectRow(m, false, true);
		m._attrs.selected = m._attrs.select = null
	}
	if (!this._cssSP) {
		if (this._cssEven && l % 2 == 0) {
			m.className = this._cssEven + ((m.className.indexOf("rowselected") != -1) ? " rowselected " : " ") + (m._css || "")
		} else {
			if (this._cssUnEven && l % 2 == 1) {
				m.className = this._cssUnEven + ((m.className.indexOf("rowselected") != -1) ? " rowselected " : " ") + (m._css || "")
			}
		}
	} else {
		if (this._h2) {
			var a = this._h2.get[m.idd];
			m.className += " " + ((a.level % 2) ? (this._cssUnEven + " " + this._cssUnEven) : (this._cssEven + " " + this._cssEven)) + "_" + a.level + (this.rowsAr[a.id]._css || "")
		}
	}
	for (var c = 0; c < this._fillers.length; c++) {
		var g = this._fillers[c];
		if (g && g[0] <= l && (g[0] + g[1]) > l) {
			var n = l - g[0];
			if (n == 0) {
				this._insert_before(l, m, g[2]);
				this._update_fillers(c, -1, 1)
			} else {
				if (n == g[1] - 1) {
					this._insert_after(l, m, g[2]);
					this._update_fillers(c, -1, 0)
				} else {
					this._fillers.push(this._add_filler(l + 1, g[1] - n - 1, g[2], 1));
					this._insert_after(l, m, g[2]);
					this._update_fillers(c, -g[1] + n, 0)
				}
			}
			return
		}
	}
};
dhtmlXGridObject.prototype._update_fillers = function(g, a, l) {
	var c = this._fillers[g];
	c[1] = c[1] + a;
	c[0] = c[0] + l;
	if (!c[1]) {
		this.callEvent("onRemoveFiller", [c[2]]);
		c[2].parentNode.removeChild(c[2]);
		this._fillers.splice(g, 1)
	} else {
		c[2].firstChild.style.height = parseFloat(c[2].firstChild.style.height) + a * this._srdh + "px";
		this.callEvent("onUpdateFiller", [c[2]])
	}
};
dhtmlXGridObject.prototype._insert_before = function(c, g, a) {
	a.parentNode.insertBefore(g, a);
	this.rowsCol[c] = g;
	this.callEvent("onRowInserted", [g, null, a, "before"])
};
dhtmlXGridObject.prototype._insert_after = function(c, g, a) {
	if (a.nextSibling) {
		a.parentNode.insertBefore(g, a.nextSibling)
	} else {
		a.parentNode.appendChild(g)
	}
	this.rowsCol[c] = g;
	this.callEvent("onRowInserted", [g, null, a, "after"])
};
if (typeof(window.dhtmlxValidation) != "undefined") {
	dhtmlxValidation.trackInput = function(g, l, c, a) {
		dhtmlxEvent(g, "keyup", function(m) {
			if (dhtmlxValidation._timer) {
				window.clearTimeout(dhtmlxValidation._timer);
				dhtmlxValidation._timer = null
			}
			dhtmlxValidation._timer = window.setTimeout(function() {
				if (!dhtmlxValidation.checkInput(g, l)) {
					if (!c || c(g, g.value, l)) {
						g.className += " dhtmlx_live_validation_error"
					}
				} else {
					g.className = g.className.replace(/[ ]*dhtmlx_live_validation_error/g, "");
					if (a) {
						a(g, g.value, l)
					}
				}
			}, 250)
		})
	};
	dhtmlxValidation.checkInput = function(a, c) {
		return dhtmlxValidation.checkValue(a.value, c)
	};
	dhtmlxValidation.checkValue = function(g, l) {
		if (typeof l == "string") {
			l = l.split(",")
		}
		var a = true;
		for (var c = 0; c < l.length; c++) {
			if (!this["is" + l[c]]) {
				alert("Incorrect validation rule: " + l[c])
			} else {
				a = a && this["is" + l[c]](g)
			}
		}
		return a
	}
}
dhtmlXGridObject.prototype.enableValidation = function(c, a) {
	c = dhx4.s2b(c);
	if (c) {
		this._validators = {
			data: []
		}
	} else {
		this._validators = false
	}
	if (arguments.length > 1) {
		this._validators._live = a
	}
	if (!this._validators._event) {
		this._validators._event = this.attachEvent("onEditCell", this.validationEvent)
	}
};
dhtmlXGridObject.prototype.setColValidators = function(a) {
	if (!this._validators) {
		this.enableValidation(true)
	}
	if (typeof a == "string") {
		a = a.split(this.delim)
	}
	this._validators.data = a
};
dhtmlXGridObject.prototype.validationEvent = function(n, c, l, g, q) {
	var r = this._validators;
	if (!r) {
		return true
	}
	var o = (r.data[l] || this.cells(c, l).getAttribute("validate")) || "";
	if (n == 1 && o) {
		var m = this.editor || (this._fake || {}).editor;
		if (!m) {
			return true
		}
		m.cell.className = m.cell.className.replace(/[ ]*dhtmlx_validation_error/g, "");
		if (r._live) {
			var a = this;
			dhtmlxValidation.trackInput(m.getInput(), o, function(s, u, v) {
				return a.callEvent("onLiveValidationError", [c, l, u, s, v])
			}, function(s, u, v) {
				return a.callEvent("onLiveValidationCorrect", [c, l, u, s, v])
			})
		}
	}
	if (n == 2) {
		this.validateCell(c, l, o, g)
	}
	return true
};
dhtmlXGridObject.prototype.validateCell = function(o, m, n, l) {
	n = n || (this._validators.data[m] || this.cells(o, m).getAttribute("validate"));
	l = l || this.cells(o, m).getValue();
	if (!n) {
		return
	}
	var c = this.cells(o, m).cell;
	var a = true;
	if (typeof n == "string") {
		n = n.split(this.delim)
	}
	for (var g = 0; g < n.length; g++) {
		if (!dhtmlxValidation.checkValue(l, n[g])) {
			if (this.callEvent("onValidationError", [o, m, l, n[g]])) {
				c.className += " dhtmlx_validation_error"
			}
			a = false
		}
	}
	if (a) {
		this.callEvent("onValidationCorrect", [o, m, l, n]);
		c.className = c.className.replace(/[ ]*dhtmlx_validation_error/g, "")
	}
	return a
};

function eXcell_stree(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid;
		if (!this.grid._sub_trees) {
			return
		}
		this._sub = this.grid._sub_trees[a._cellIndex];
		if (!this._sub) {
			return
		}
		this._sub = this._sub[0]
	}
	this.getValue = function() {
		return this.cell._val
	};
	this.setValue = function(c) {
		this.cell._val = c;
		c = this._sub.getItemText(this.cell._val);
		this.setCValue((c || "&nbsp;"), c)
	};
	this.edit = function() {
		this._sub.parentObject.style.display = "block";
		var g = this.grid.getPosition(this.cell);
		this._sub.parentObject.style.top = g[1] + "px";
		this._sub.parentObject.style.left = g[0] + "px";
		this._sub.parentObject.style.position = "absolute";
		var c = this.grid.editStop;
		this.grid.editStop = function() {};
		this.grid.editStop = c
	};
	this.detach = function() {
		this._sub.parentObject.style.display = "none";
		if (this.grid._sub_id != null) {
			var c = this.cell._val;
			this.setValue(this._sub.getSelectedItemId());
			this.grid._sub_id = null;
			return this.cell._val != c
		}
	}
}
eXcell_stree.prototype = new eXcell;
dhtmlXGridObject.prototype.setSubTree = function(a, c) {
	if (!this._sub_trees) {
		this._sub_trees = []
	}
	this._sub_trees[c] = [a];
	a.parentObject.style.display = "none";
	var g = this;
	a.parentObject.onclick = function(l) {
		(l || window.event).cancelBubble = true;
		return false
	};
	a.ev_onDblClick = null;
	a.attachEvent("onDblClick", function(l) {
		g._sub_id = l;
		g.editStop();
		return true
	});
	a._chRRS = true
};

function eXcell_link(a) {
	this.cell = a;
	this.grid = this.cell.parentNode.grid;
	this.isDisabled = function() {
		return true
	};
	this.edit = function() {};
	this.getValue = function() {
		if (this.cell.firstChild.getAttribute) {
			var c = this.cell.firstChild.getAttribute("target");
			return this.cell.firstChild.innerHTML + "^" + this.cell.firstChild.getAttribute("href") + (c ? ("^" + c) : "")
		} else {
			return ""
		}
	};
	this.setValue = function(g) {
		if ((typeof(g) != "number") && (!g || g.toString()._dhx_trim() == "")) {
			this.setCValue("&nbsp;", c);
			return (this.cell._clearCell = true)
		}
		var c = g.split("^");
		if (c.length == 1) {
			c[1] = ""
		} else {
			if (c.length > 1) {
				c[1] = "href='" + c[1] + "'";
				if (c.length == 3) {
					c[1] += " target='" + c[2] + "'"
				} else {
					c[1] += " target='_blank'"
				}
			}
		}
		this.setCValue("<a " + c[1] + " onclick='(_isIE?event:arguments[0]).cancelBubble = true;'>" + c[0] + "</a>", c)
	}
}
eXcell_link.prototype = new eXcell;
eXcell_link.prototype.getTitle = function() {
	var a = this.cell.firstChild;
	return ((a && a.tagName) ? a.getAttribute("href") : "")
};
eXcell_link.prototype.getContent = function() {
	var a = this.cell.firstChild;
	return ((a && a.tagName) ? a.innerHTML : "")
};

function eXcell_grid(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid;
		if (!this.grid._sub_grids) {
			return
		}
		this._sub = this.grid._sub_grids[a._cellIndex];
		if (!this._sub) {
			return
		}
		this._sindex = this._sub[1];
		this._sub = this._sub[0]
	}
	this.getValue = function() {
		return this.cell.val
	};
	this.setValue = function(c) {
		this.cell.val = c;
		if (this._sub.getRowById(c)) {
			c = this._sub.cells(c, this._sindex);
			if (c) {
				c = c.getValue()
			} else {
				c = ""
			}
		}
		this.setCValue((c || "&nbsp;"), c)
	};
	this.edit = function() {
		this.val = this.cell.val;
		this._sub.entBox.style.display = "block";
		var g = this.grid.getPosition(this.cell);
		this._sub.entBox.style.top = g[1] + "px";
		this._sub.entBox.style.left = g[0] + "px";
		this._sub.entBox.style.position = "absolute";
		this._sub.setSizes();
		var c = this.grid.editStop;
		this.grid.editStop = function() {};
		if (this._sub.getRowById(this.cell.val)) {
			this._sub.setSelectedRow(this.cell.val)
		}
		this._sub.setActive(true);
		this.grid.editStop = c
	};
	this.detach = function() {
		var c = this.cell.val;
		this._sub.entBox.style.display = "none";
		if (this._sub.getSelectedId() === null) {
			return false
		}
		this.setValue(this._sub.getSelectedId());
		this.grid.setActive(true);
		return this.cell.val != c
	}
}
eXcell_grid.prototype = new eXcell;
dhtmlXGridObject.prototype.setSubGrid = function(c, a, l) {
	if (!this._sub_grids) {
		this._sub_grids = []
	}
	this._sub_grids[a] = [c, l];
	c.entBox.style.display = "none";
	var g = this;
	c.entBox.onclick = function(m) {
		(m || window.event).cancelBubble = true;
		return false
	};
	c.attachEvent("onRowSelect", function(m) {
		g.editStop();
		return true
	});
	c._chRRS = false
};

function eXcell_dhxCalendar(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid;
		if (!this.grid._grid_calendarA) {
			var g = this.grid._grid_calendarA = new dhtmlxCalendarObject();
			this.grid.callEvent("onDhxCalendarCreated", [g]);
			var c = this.grid;
			g.attachEvent("onClick", function() {
				this._last_operation_calendar = true;
				window.setTimeout(function() {
					c.editStop()
				}, 1);
				return true
			});
			var l = function(m) {
				(m || event).cancelBubble = true
			};
			dhtmlxEvent(g.base, "click", l);
			g = null
		}
	}
}
eXcell_dhxCalendar.prototype = new eXcell;
eXcell_dhxCalendar.prototype.edit = function() {
	var c = this.grid.getPosition(this.cell);
	this.grid._grid_calendarA._show(false, false);
	this.grid._grid_calendarA.setPosition(c[0], c[1] + this.cell.offsetHeight);
	this.grid._grid_calendarA._last_operation_calendar = false;
	this.grid.callEvent("onCalendarShow", [this.grid._grid_calendarA, this.cell.parentNode.idd, this.cell._cellIndex]);
	this.cell._cediton = true;
	this.val = this.cell.val;
	this._val = this.cell.innerHTML;
	var a = this.grid._grid_calendarA.draw;
	this.grid._grid_calendarA.draw = function() {};
	this.grid._grid_calendarA.setDateFormat((this.grid._dtmask || "%d/%m/%Y"));
	this.grid._grid_calendarA.setDate(this.val || (new Date()));
	this.grid._grid_calendarA.draw = a
};
eXcell_dhxCalendar.prototype.getDate = function() {
	if (this.cell.val) {
		return this.cell.val
	}
	return null
};
eXcell_dhxCalendar.prototype.getValue = function() {
	if (this.cell._clearCell) {
		return ""
	}
	if (this.grid._dtmask_inc && this.cell.val) {
		return this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc, this.cell.val).toString()
	}
	return this.cell.innerHTML.toString()._dhx_trim()
};
eXcell_dhxCalendar.prototype.detach = function() {
	if (!this.grid._grid_calendarA) {
		return
	}
	this.grid._grid_calendarA.hide();
	if (this.cell._cediton) {
		this.cell._cediton = false
	} else {
		return
	}
	if (this.grid._grid_calendarA._last_operation_calendar) {
		var g = this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask || "%d/%m/%Y"));
		var c = this.grid._grid_calendarA.getDate();
		this.cell.val = new Date(c);
		this.setCValue(g, c);
		this.cell._clearCell = !g;
		var a = this.val;
		this.val = this._val;
		return (this.cell.val.valueOf() != a)
	}
	return false
};
eXcell_dhxCalendar.prototype.setValue = function(a) {
	if (a && typeof a == "object") {
		this.cell.val = a;
		this.cell._clearCell = false;
		this.setCValue(this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask || "%d/%m/%Y"), a).toString(), this.cell.val);
		return
	}
	if (!a || a.toString()._dhx_trim() == "") {
		a = "&nbsp";
		this.cell._clearCell = true;
		this.cell.val = ""
	} else {
		this.cell._clearCell = false;
		this.cell.val = new Date(this.grid._grid_calendarA.setFormatedDate((this.grid._dtmask_inc || this.grid._dtmask || "%d/%m/%Y"), a.toString(), null, true));
		if (this.grid._dtmask_inc) {
			a = this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask || "%d/%m/%Y"), this.cell.val)
		}
	}
	if ((this.cell.val == "NaN") || (this.cell.val == "Invalid Date")) {
		this.cell._clearCell = true;
		this.cell.val = new Date();
		this.setCValue("&nbsp;", 0)
	} else {
		this.setCValue((a || "").toString(), this.cell.val)
	}
};

function eXcell_dhxCalendarA(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid;
		if (!this.grid._grid_calendarA) {
			var g = this.grid._grid_calendarA = new dhtmlxCalendarObject();
			this.grid.callEvent("onDhxCalendarCreated", [g]);
			var c = this.grid;
			g.attachEvent("onClick", function() {
				this._last_operation_calendar = true;
				window.setTimeout(function() {
					c.editStop()
				}, 1);
				return true
			});
			var l = function(m) {
				(m || event).cancelBubble = true
			};
			dhtmlxEvent(g.base, "click", l)
		}
	}
}
eXcell_dhxCalendarA.prototype = new eXcell;
eXcell_dhxCalendarA.prototype.edit = function() {
	var c = this.grid.getPosition(this.cell);
	this.grid._grid_calendarA._show(false, false);
	this.grid._grid_calendarA.setPosition(c[0] * 1 + this.cell.offsetWidth, c[1] * 1);
	this.grid.callEvent("onCalendarShow", [this.grid._grid_calendarA, this.cell.parentNode.idd, this.cell._cellIndex]);
	this.grid._grid_calendarA._last_operation_calendar = false;
	this.cell._cediton = true;
	this.val = this.cell.val;
	this._val = this.cell.innerHTML;
	var a = this.grid._grid_calendarA.draw;
	this.grid._grid_calendarA.draw = function() {};
	this.grid._grid_calendarA.setDateFormat((this.grid._dtmask || "%d/%m/%Y"));
	this.grid._grid_calendarA.setDate(this.val);
	this.grid._grid_calendarA.draw = a;
	this.cell.atag = ((!this.grid.multiLine) && (_isKHTML || _isMacOS || _isFF)) ? "INPUT" : "TEXTAREA";
	this.obj = document.createElement(this.cell.atag);
	this.obj.style.height = (this.cell.offsetHeight - 4) + "px";
	this.obj.className = "dhx_combo_edit";
	this.obj.wrap = "soft";
	this.obj.style.textAlign = this.cell.align;
	this.obj.onclick = function(g) {
		(g || event).cancelBubble = true
	};
	this.obj.onmousedown = function(g) {
		(g || event).cancelBubble = true
	};
	this.obj.value = this.getValue();
	this.cell.innerHTML = "";
	this.cell.appendChild(this.obj);
	if (window.dhx4.isIE) {
		this.obj.style.overflow = "visible";
		if ((this.grid.multiLine) && (this.obj.offsetHeight >= 18) && (this.obj.offsetHeight < 40)) {
			this.obj.style.height = "36px";
			this.obj.style.overflow = "scroll"
		}
	}
	this.obj.onselectstart = function(g) {
		if (!g) {
			g = event
		}
		g.cancelBubble = true;
		return true
	};
	this.obj.focus();
	this.obj.focus()
};
eXcell_dhxCalendarA.prototype.getDate = function() {
	if (this.cell.val) {
		return this.cell.val
	}
	return null
};
eXcell_dhxCalendarA.prototype.getValue = function() {
	if (this.cell._clearCell) {
		return ""
	}
	if (this.grid._dtmask_inc && this.cell.val) {
		return this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask_inc, this.cell.val).toString()
	}
	return this.cell.innerHTML.toString()._dhx_trim()
};
eXcell_dhxCalendarA.prototype.detach = function() {
	if (!this.grid._grid_calendarA) {
		return
	}
	this.grid._grid_calendarA.hide();
	if (this.cell._cediton) {
		this.cell._cediton = false
	} else {
		return
	}
	if (this.grid._grid_calendarA._last_operation_calendar) {
		this.grid._grid_calendarA._last_operation_calendar = false;
		var g = this.grid._grid_calendarA.getFormatedDate(this.grid._dtmask || "%d/%m/%Y");
		var c = this.grid._grid_calendarA.getDate();
		this.cell.val = new Date(c);
		this.setCValue(g, c);
		this.cell._clearCell = !g;
		var a = this.val;
		this.val = this._val;
		return (this.cell.val.valueOf() != (a | "").valueOf())
	}
	this.setValue(this.obj.value);
	var a = this.val;
	this.val = this._val;
	return (this.cell.val.valueOf() != (a || "").valueOf())
};
eXcell_dhxCalendarA.prototype.setValue = function(a) {
	if (a && typeof a == "object") {
		this.cell.val = a;
		this.cell._clearCell = false;
		this.setCValue(this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask || "%d/%m/%Y"), a).toString(), this.cell.val);
		return
	}
	if (!a || a.toString()._dhx_trim() == "") {
		a = "&nbsp";
		this.cell._clearCell = true;
		this.cell.val = ""
	} else {
		this.cell._clearCell = false;
		this.cell.val = new Date(this.grid._grid_calendarA.setFormatedDate((this.grid._dtmask_inc || this.grid._dtmask || "%d/%m/%Y"), a.toString(), null, true));
		if (this.grid._dtmask_inc) {
			a = this.grid._grid_calendarA.getFormatedDate((this.grid._dtmask || "%d/%m/%Y"), this.cell.val)
		}
	}
	if ((this.cell.val == "NaN") || (this.cell.val == "Invalid Date")) {
		this.cell.val = new Date();
		this.cell._clearCell = true;
		this.setCValue("&nbsp;", 0)
	} else {
		this.setCValue((a || "").toString(), this.cell.val)
	}
};

function eXcell_cntr(a) {
	this.cell = a;
	this.grid = this.cell.parentNode.grid;
	if (!this.grid._ex_cntr_ready && !this._realfake) {
		this.grid._ex_cntr_ready = true;
		if (this.grid._h2) {
			this.grid.attachEvent("onOpenEn", function(g) {
				this.resetCounter(a._cellIndex)
			})
		}
		var c = function() {
			var g = this;
			window.setTimeout(function() {
				if (!g.resetCounter) {
					return
				}
				if (g._fake && !g._realfake && a._cellIndex < g._fake._cCount) {
					g._fake.resetCounter(a._cellIndex)
				} else {
					g.resetCounter(a._cellIndex)
				}
			}, 1);
			return true
		};
		this.grid.attachEvent("onBeforeSorting", c);
		this.grid.attachEvent("onFilterEnd", c)
	}
	this.edit = function() {};
	this.getValue = function() {
		return this.cell.innerHTML
	};
	this.setValue = function(l) {
		this.cell.style.paddingRight = "2px";
		var g = this.cell;
		window.setTimeout(function() {
			if (!g.parentNode) {
				return
			}
			var m = g.parentNode.rowIndex;
			if (g.parentNode.grid.currentPage || m < 0 || g.parentNode.grid._srnd) {
				m = g.parentNode.grid.rowsBuffer._dhx_find(g.parentNode) + 1
			}
			if (m <= 0) {
				return
			}
			g.innerHTML = m;
			if (g.parentNode.grid._fake && g._cellIndex < g.parentNode.grid._fake._cCount && g.parentNode.grid._fake.rowsAr[g.parentNode.idd]) {
				g.parentNode.grid._fake.cells(g.parentNode.idd, g._cellIndex).setCValue(m)
			}
			g = null
		}, 100)
	}
}
dhtmlXGridObject.prototype.resetCounter = function(c) {
	if (this._fake && !this._realfake && c < this._fake._cCount) {
		this._fake.resetCounter(c, this.currentPage)
	}
	var a = arguments[0] || 0;
	if (this.currentPage) {
		a = (this.currentPage - 1) * this.rowsBufferOutSize
	}
	for (a = 0; a < this.rowsBuffer.length; a++) {
		if (this.rowsBuffer[a] && this.rowsBuffer[a].tagName == "TR" && this.rowsAr[this.rowsBuffer[a].idd]) {
			this.rowsAr[this.rowsBuffer[a].idd].childNodes[c].innerHTML = a + 1
		}
	}
};
eXcell_cntr.prototype = new eXcell;

function eXcell_acheck(a) {
	try {
		this.cell = a;
		this.grid = this.cell.parentNode.grid;
		this.cell.obj = this
	} catch (c) {}
	this.changeState = function() {
		if ((!this.grid.isEditable) || (this.cell.parentNode._locked) || (this.isDisabled())) {
			return
		}
		if (this.grid.callEvent("onEditCell", [0, this.cell.parentNode.idd, this.cell._cellIndex]) != false) {
			this.val = this.getValue();
			if (this.val == "1") {
				this.setValue("<checkbox state='false'>")
			} else {
				this.setValue("<checkbox state='true'>")
			}
			this.cell.wasChanged = true;
			this.grid.callEvent("onEditCell", [1, this.cell.parentNode.idd, this.cell._cellIndex]);
			this.grid.callEvent("onCheck", [this.cell.parentNode.idd, this.cell._cellIndex, (this.val != "1")]);
			this.grid.callEvent("onCheckbox", [this.cell.parentNode.idd, this.cell._cellIndex, (this.val != "1")])
		} else {
			this.editor = null
		}
	};
	this.getValue = function() {
		try {
			return this.cell.chstate.toString()
		} catch (g) {
			return null
		}
	};
	this.isCheckbox = function() {
		return true
	};
	this.isChecked = function() {
		if (this.getValue() == "1") {
			return true
		} else {
			return false
		}
	};
	this.setChecked = function(g) {
		this.setValue(g.toString())
	};
	this.detach = function() {
		return this.val != this.getValue()
	};
	this.drawCurrentState = function() {
		if (this.cell.chstate == 1) {
			return "<div  onclick='(new eXcell_acheck(this.parentNode)).changeState(); (arguments[0]||event).cancelBubble=true;'  style='cursor:pointer; font-weight:bold; text-align:center; '><span style='height:8px; width:8px; background:green; display:inline-block;'></span>&nbsp;Yes</div>"
		} else {
			return "<div  onclick='(new eXcell_acheck(this.parentNode)).changeState(); (arguments[0]||event).cancelBubble=true;' style='cursor:pointer;  text-align:center; '><span style='height:8px; width:8px; background:red; display:inline-block;'></span>&nbsp;No</div>"
		}
	}
}
eXcell_acheck.prototype = new eXcell;
eXcell_acheck.prototype.setValue = function(c) {
	c = (c || "").toString();
	if (c.indexOf("1") != -1 || c.indexOf("true") != -1) {
		c = "1";
		this.cell.chstate = "1"
	} else {
		c = "0";
		this.cell.chstate = "0"
	}
	var a = this;
	this.setCValue(this.drawCurrentState(), this.cell.chstate)
};

function eXcell_context(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid;
		if (!this.grid._sub_context) {
			return
		}
		this._sub = this.grid._sub_context[a._cellIndex];
		if (!this._sub) {
			return
		}
		this._sindex = this._sub[1];
		this._sub = this._sub[0]
	}
	this.getValue = function() {
		return _isIE ? this.cell.innerText : this.cell.textContent
	};
	this.setValue = function(g) {
		this.cell._val = g;
		var c = this._sub.itemPull[this._sub.idPrefix + this.cell._val];
		g = c ? c.title : g;
		this.setCValue((g || "&nbsp;"), g)
	};
	this.edit = function() {
		var g = this.grid.getPosition(this.cell);
		this._sub.showContextMenu(g[0] + this.cell.offsetWidth, g[1]);
		var c = this.grid.editStop;
		this.grid.editStop = function() {};
		this.grid.editStop = c
	};
	this.detach = function() {
		if (this.grid._sub_id != null) {
			var c = this.cell._val;
			this.setValue(this.grid._sub_id);
			this.grid._sub_id = null;
			return this.cell._val != c
		}
		this._sub.hideContextMenu()
	}
}
eXcell_context.prototype = new eXcell;
dhtmlXGridObject.prototype.setSubContext = function(a, c, l) {
	var g = this;
	a.attachEvent("onClick", function(n, m) {
		g._sub_id = n;
		g.editStop();
		a.hideContextMenu();
		return true
	});
	if (!this._sub_context) {
		this._sub_context = []
	}
	this._sub_context[c] = [a, l];
	a.hideContextMenu()
};

function dhtmlXGridFromTable(obj, init) {
	if (typeof(obj) != "object") {
		obj = document.getElementById(obj)
	}
	var w = document.createElement("DIV");
	w.setAttribute("width", obj.getAttribute("gridWidth") || (obj.offsetWidth ? (obj.offsetWidth + "px") : 0) || (window.getComputedStyle ? window.getComputedStyle(obj, null)["width"] : (obj.currentStyle ? obj.currentStyle.width : 0)));
	w.setAttribute("height", obj.getAttribute("gridHeight") || (obj.offsetHeight ? (obj.offsetHeight + "px") : 0) || (window.getComputedStyle ? window.getComputedStyle(obj, null)["height"] : (obj.currentStyle ? obj.currentStyle.height : 0)));
	w.className = obj.className;
	obj.className = "";
	if (obj.id) {
		w.id = obj.id
	}
	var mr = obj;
	var drag = obj.getAttribute("dragAndDrop");
	mr.parentNode.insertBefore(w, mr);
	var f = mr.getAttribute("name") || ("name_" + (new Date()).valueOf());
	var windowf = new dhtmlXGridObject(w);
	window[f] = windowf;
	var acs = mr.getAttribute("onbeforeinit");
	var acs2 = mr.getAttribute("oninit");
	if (acs) {
		eval(acs)
	}
	windowf.setImagePath(windowf.imgURL || (mr.getAttribute("imgpath") || mr.getAttribute("image_path") || ""));
	var skin = mr.getAttribute("skin");
	if (skin) {
		windowf.setSkin(skin)
	}
	if (init) {
		init(windowf)
	}
	var hrow = mr.rows[0];
	var za = "";
	var zb = "";
	var zc = "";
	var zd = "";
	var ze = "";
	for (var i = 0; i < hrow.cells.length; i++) {
		za += (za ? "," : "") + hrow.cells[i].innerHTML;
		var width = hrow.cells[i].getAttribute("width") || hrow.cells[i].offsetWidth || (window.getComputedStyle ? window.getComputedStyle(hrow.cells[i], null)["width"] : (hrow.cells[i].currentStyle ? hrow.cells[i].currentStyle.width : 0));
		zb += (zb ? "," : "") + (width == "*" ? width : parseInt(width));
		zc += (zc ? "," : "") + (hrow.cells[i].getAttribute("align") || "left");
		zd += (zd ? "," : "") + (hrow.cells[i].getAttribute("type") || "ed");
		ze += (ze ? "," : "") + (hrow.cells[i].getAttribute("sort") || "str");
		var f_a = hrow.cells[i].getAttribute("format");
		if (f_a) {
			if (hrow.cells[i].getAttribute("type").toLowerCase().indexOf("calendar") != -1) {
				windowf._dtmask = f_a
			} else {
				windowf.setNumberFormat(f_a, i)
			}
		}
	}
	windowf.setHeader(za);
	windowf.setInitWidths(zb);
	windowf.setColAlign(zc);
	windowf.setColTypes(zd);
	windowf.setColSorting(ze);
	if (obj.getAttribute("gridHeight") == "auto") {
		windowf.enableAutoHeigth(true)
	}
	if (obj.getAttribute("multiline")) {
		windowf.enableMultiline(true)
	}
	var lmn = mr.getAttribute("lightnavigation");
	if (lmn) {
		windowf.enableLightMouseNavigation(lmn)
	}
	var evr = mr.getAttribute("evenrow");
	var uevr = mr.getAttribute("unevenrow");
	if (evr || uevr) {
		windowf.enableAlterCss(evr, uevr)
	}
	if (drag) {
		windowf.enableDragAndDrop(true)
	}
	windowf.init();
	if (obj.getAttribute("split")) {
		windowf.splitAt(obj.getAttribute("split"))
	}
	windowf._process_inner_html(mr, 1);
	if (acs2) {
		eval(acs2)
	}
	if (obj.parentNode && obj.parentNode.removeChild) {
		obj.parentNode.removeChild(obj)
	}
	return windowf
}
dhtmlXGridObject.prototype._process_html = function(c) {
	if (c.tagName && c.tagName == "TABLE") {
		return this._process_inner_html(c, 0)
	}
	var a = document.createElement("DIV");
	a.innerHTML = c.xmlDoc.responseText;
	var g = a.getElementsByTagName("TABLE")[0];
	this._process_inner_html(g, 0)
};
dhtmlXGridObject.prototype._process_inner_html = function(g, m) {
	var c = g.rows.length;
	for (var a = m; a < c; a++) {
		var l = g.rows[a].getAttribute("id") || a;
		this.rowsBuffer.push({
			idd: l,
			data: g.rows[a],
			_parser: this._process_html_row,
			_locator: this._get_html_data
		})
	}
	this.render_dataset();
	this.setSizes()
};
dhtmlXGridObject.prototype._process_html_row = function(q, m) {
	var o = m.getElementsByTagName("TD");
	var c = [];
	q._attrs = this._xml_attrs(m);
	for (var l = 0; l < o.length; l++) {
		var n = o[l];
		var a = n.getAttribute("type");
		if (q.childNodes[l]) {
			if (a) {
				q.childNodes[l]._cellType = a
			}
			q.childNodes[l]._attrs = this._xml_attrs(o[l])
		}
		if (n.firstChild) {
			c.push(n.innerHTML)
		} else {
			c.push("")
		}
		if (n.colSpan > 1) {
			q.childNodes[l]._attrs.colspan = n.colSpan;
			for (var g = 1; g < n.colSpan; g++) {
				c.push("")
			}
		}
	}
	for (l < o.length; l < q.childNodes.length; l++) {
		q.childNodes[l]._attrs = {}
	}
	this._fillRow(q, (this._c_order ? this._swapColumns(c) : c));
	return q
};
dhtmlXGridObject.prototype._get_html_data = function(c, a) {
	c = c.firstChild;
	while (true) {
		if (!c) {
			return ""
		}
		if (c.tagName == "TD") {
			a--
		}
		if (a < 0) {
			break
		}
		c = c.nextSibling
	}
	return (c.firstChild ? c.firstChild.data : "")
};
dhtmlxEvent(window, "load", function() {
	var g = document.getElementsByTagName("table");
	for (var c = 0; c < g.length; c++) {
		if (g[c].className == "dhtmlxGrid") {
			dhtmlXGridFromTable(g[c])
		}
	}
});
dhtmlXGridObject.prototype._process_xmlA = function(a) {
	this._parsing = true;
	var n = dhx4.ajax.xmltop(this.xml.top, a);
	this._parseHead(n);
	var m = dhx4.ajax.xpath(this.xml.row, n);
	var l = parseInt(n.getAttribute("pos") || 0);
	var g = parseInt(n.getAttribute("total_count") || 0);
	if (g && !this.rowsBuffer[g - 1]) {
		this.rowsBuffer[g - 1] = null
	}
	if (this.isTreeGrid()) {
		this._get_xml_data = this._get_xml_dataA;
		this._process_xml_row = this._process_xml_rowA;
		return this._process_tree_xml(a)
	}
	for (var c = 0; c < m.length; c++) {
		if (this.rowsBuffer[c + l]) {
			continue
		}
		var o = m[c].getAttribute("id") || this.uid();
		this.rowsBuffer[c + l] = {
			idd: o,
			data: m[c],
			_parser: this._process_xml_rowA,
			_locator: this._get_xml_dataA
		};
		this.rowsAr[o] = m[c]
	}
	this.render_dataset();
	this._parsing = false
};
dhtmlXGridObject.prototype._process_xmlB = function(a) {
	this._parsing = true;
	var n = dhx4.ajax.xmltop(this.xml.top, a);
	this._parseHead(n);
	var m = dhx4.ajax.xpath(this.xml.row, n);
	var l = parseInt(n.getAttribute("pos") || 0);
	var g = parseInt(n.getAttribute("total_count") || 0);
	if (g && !this.rowsBuffer[g - 1]) {
		this.rowsBuffer[g - 1] = null
	}
	if (this.isTreeGrid()) {
		this._get_xml_data = this._get_xml_dataB;
		this._process_xml_row = this._process_xml_rowB;
		return this._process_tree_xml(a)
	}
	for (var c = 0; c < m.length; c++) {
		if (this.rowsBuffer[c + l]) {
			continue
		}
		var o = m[c].getAttribute("id") || this.uid();
		this.rowsBuffer[c + l] = {
			idd: o,
			data: m[c],
			_parser: this._process_xml_rowB,
			_locator: this._get_xml_dataB
		};
		this.rowsAr[o] = m[c]
	}
	this.render_dataset();
	this._parsing = false
};
dhtmlXGridObject.prototype._process_xml_rowA = function(m, g) {
	var a = [];
	m._attrs = this._xml_attrs(g);
	for (var c = 0; c < this.columnIds.length; c++) {
		var n = this.columnIds[c];
		var l = m._attrs[n] || "";
		if (m.childNodes[c]) {
			m.childNodes[c]._attrs = {}
		}
		a.push(l)
	}
	this._fillRow(m, (this._c_order ? this._swapColumns(a) : a));
	return m
};
dhtmlXGridObject.prototype._get_xml_dataA = function(c, a) {
	return c.getAttribute(this.getColumnId(a))
};
dhtmlXGridObject.prototype._process_xml_rowB = function(a, m) {
	var q = [];
	a._attrs = this._xml_attrs(m);
	if (this._ud_enabled) {
		var s = dhx4.ajax.xpath("./userdata", m);
		for (var g = s.length - 1; g >= 0; g--) {
			this.setUserData(s[g].getAttribute("name"), s[g].firstChild ? s[g].firstChild.data : "")
		}
	}
	for (var o = 0; o < m.childNodes.length; o++) {
		var l = m.childNodes[o];
		if (!l.tagName) {
			continue
		}
		var c = this.getColIndexById(l.tagName);
		if (isNaN(c)) {
			continue
		}
		var n = l.getAttribute("type");
		if (n) {
			a.childNodes[c]._cellType = n
		}
		a.childNodes[c]._attrs = this._xml_attrs(l);
		if (l.getAttribute("xmlcontent")) {} else {
			if (l.firstChild) {
				l = l.firstChild.data
			} else {
				l = ""
			}
		}
		q[c] = l
	}
	for (var g = 0; g < a.childNodes.length; g++) {
		if (!a.childNodes[g]._attrs) {
			a.childNodes[g]._attrs = {}
		}
	}
	this._fillRow(a, q);
	return a
};
dhtmlXGridObject.prototype._get_xml_dataB = function(c, a) {
	var g = this.getColumnId(a);
	c = c.firstChild;
	while (true) {
		if (!c) {
			return ""
		}
		if (c.tagName == g) {
			return (c.firstChild ? c.firstChild.data : "")
		}
		c = c.nextSibling
	}
	return ""
};
dhtmlXGridObject.prototype.startFastOperations = function() {
	this._disF = ["setSizes", "callEvent", "_fixAlterCss", "cells4", "forEachRow", "_correctMonolite"];
	this._disA = [];
	for (var a = this._disF.length - 1; a >= 0; a--) {
		this._disA[a] = this[this._disF[a]];
		this[this._disF[a]] = function() {
			return true
		}
	}
	this._cellCache = [];
	this.cells4 = function(g) {
		var l = this._cellCache[g._cellIndex];
		if (!l) {
			l = this._cellCache[g._cellIndex] = this._disA[3].apply(this, [g]);
			l.destructor = function() {
				return true
			};
			l.setCValue = function(c) {
				l.cell.innerHTML = c
			}
		}
		l.cell = g;
		l.combo = g._combo || this.combos[g._cellIndex];
		return l
	}
};
dhtmlXGridObject.prototype.stopFastOperations = function() {
	if (!this._disF) {
		return
	}
	for (var a = this._disF.length - 1; a >= 0; a--) {
		this[this._disF[a]] = this._disA[a]
	}
	if (this._correctMonolite) {
		this._correctMonolite()
	}
	this.setSizes();
	this.callEvent("onGridReconstructed", [])
};
dhtmlXGridObject.prototype._in_header_number_filter = function(g, c) {
	this._in_header_text_filter.call(this, g, c);
	var a = this;
	g.firstChild._filter = function() {
		var l = a._get_filters(this.value, "num");
		return function(o) {
			var m = l.length > 0 ? false : true;
			for (var n = 0; n < l.length; n++) {
				m = m || l[n](o)
			}
			return m
		}
	}
};
dhtmlXGridObject.prototype._in_header_string_filter = function(g, c) {
	this._in_header_text_filter.call(this, g, c);
	var a = this;
	g.firstChild._filter = function() {
		var l = a._get_filters(this.value, "str");
		return function(o) {
			var m = l.length > 0 ? false : true;
			for (var n = 0; n < l.length; n++) {
				m = m || l[n](o)
			}
			return m
		}
	}
};
dhtmlXGridObject.prototype._get_filters = function(n, g) {
	var a = n.split(",");
	var l = [];
	for (var c = 0; c < a.length; c++) {
		if (a[c] == "") {
			continue
		}
		var m = this["_get_" + g + "_filter"](a[c]);
		l.push(m)
	}
	return l
};
dhtmlXGridObject.prototype._get_str_filter = function(c) {
	if (c == "null" || c == "empty") {
		return new Function("value", 'if (value == null || value == "") return true; return false;')
	}
	if (c == "!null" || c == "!empty") {
		return new Function("value", 'if (value == null || value == "") return false; return true;')
	}
	if (c.substr(0, 1) === "!") {
		var a = c.substr(1);
		return new Function("value", 'if (value !== "' + a + '") return true; return false;')
	}
	if (c.substr(0, 1) === "~") {
		var a = c.substr(1);
		return new Function("value", 'if (value.indexOf("' + a + '") !== -1) return true; return false;')
	}
	if (c.substr(0, 1) === "^" && c.substr(c.length - 1, 1) === "&") {
		c = "=" + c.substr(1, c.length - 2)
	}
	if (c.substr(0, 1) === "^") {
		var a = c.substr(1);
		return new Function("value", "if (value.substr(0, " + a.length + ') === "' + a + '") return true; return false;')
	}
	if (c.substr(c.length - 1, 1) === "&") {
		var a = c.substr(0, c.length - 1);
		return new Function("value", "if (value.substr(value.length - " + a.length + ') === "' + a + '") return true; return false;')
	}
	if (c.substr(0, 1) === "=") {
		var a = c.substr(1)
	} else {
		var a = c
	}
	return new Function("value", 'if (value === "' + a + '") return true; return false;')
};
dhtmlXGridObject.prototype._get_num_filter = function(m) {
	if (m == "null" || m == "empty") {
		return new Function("value", 'if (value == null || value == "") return true; return false;')
	}
	if (m == "!null" || m == "!empty") {
		return new Function("value", 'if (value == null || value == "") return false; return true;')
	}
	var a = m.split("..");
	if (a.length == 2) {
		var n = parseFloat(a[0]);
		var l = parseFloat(a[1]);
		return new Function("value", "if (value >= " + n + " && value <= " + l + ") return true; return false;")
	}
	var g = m.match(/<>|>=|<=|>|<|=/);
	if (g) {
		var o = g[0];
		var c = parseFloat(m.replace(o, ""))
	} else {
		var o = "==";
		c = parseFloat(m)
	}
	if (o == "<>") {
		o = "!="
	}
	if (o == "=") {
		o = "=="
	}
	return new Function("value", " if (value " + o + " " + c + " ) return true; return false;")
};
dhtmlXGridObject.prototype.attachHeaderA = dhtmlXGridObject.prototype.attachHeader;
dhtmlXGridObject.prototype.attachHeader = function() {
	this.attachHeaderA.apply(this, arguments);
	if (this._realfake) {
		return true
	}
	this.formAutoSubmit();
	if (typeof(this.FormSubmitOnlyChanged) == "undefined") {
		this.submitOnlyChanged(true)
	}
	if (typeof(this._submitAR) == "undefined") {
		this.submitAddedRows(true)
	}
	var a = this;
	this._added_rows = [];
	this._deleted_rows = [];
	this.attachEvent("onRowAdded", function(c) {
		a._added_rows.push(c);
		a.forEachCell(c, function(g) {
			g.cell.wasChanged = true
		});
		return true
	});
	this.attachEvent("onBeforeRowDeleted", function(c) {
		a._deleted_rows.push(c);
		return true
	});
	this.attachHeader = this.attachHeaderA
};
dhtmlXGridObject.prototype.formAutoSubmit = function() {
	this.parentForm = this.detectParentFormPresent();
	if (this.parentForm === false) {
		return false
	}
	if (this.formEventAttached) {
		return
	}
	this.formInputs = new Array();
	var a = this;
	dhtmlxEvent(this.parentForm, "submit", function() {
		if (a.entBox) {
			a.parentFormOnSubmit()
		}
	});
	this.formEventAttached = true
};
dhtmlXGridObject.prototype.parentFormOnSubmit = function() {
	this.formCreateInputCollection();
	if (!this.callEvent("onBeforeFormSubmit", [])) {
		return false
	}
};
dhtmlXGridObject.prototype.submitOnlyChanged = function(a) {
	this.FormSubmitOnlyChanged = dhx4.s2b(a)
};
dhtmlXGridObject.prototype.submitColumns = function(a) {
	if (typeof a == "string") {
		a = a.split(this.delim)
	}
	this._submit_cols = a
};
dhtmlXGridObject.prototype.setFieldName = function(a) {
	a = a.replace(/\{GRID_ID\}/g, "'+a1+'");
	a = a.replace(/\{ROW_ID\}/g, "'+a2+'");
	a = a.replace(/\{ROW_INDEX\}/g, "'+this.getRowIndex(a2)+'");
	a = a.replace(/\{COLUMN_INDEX\}/g, "'+a3+'");
	a = a.replace(/\{COLUMN_ID\}/g, "'+this.getColumnId(a3)+'");
	this._input_mask = Function("a1", "a2", "a3", "return '" + a + "';")
};
dhtmlXGridObject.prototype.submitSerialization = function(a) {
	this.FormSubmitSerialization = dhx4.s2b(a)
};
dhtmlXGridObject.prototype.submitAddedRows = function(a) {
	this._submitAR = dhx4.s2b(a)
};
dhtmlXGridObject.prototype.submitOnlySelected = function(a) {
	this.FormSubmitOnlySelected = dhx4.s2b(a)
};
dhtmlXGridObject.prototype.submitOnlyRowID = function(a) {
	this.FormSubmitOnlyRowID = dhx4.s2b(a)
};
dhtmlXGridObject.prototype.createFormInput = function(c, g) {
	var a = document.createElement("input");
	a.type = "hidden";
	if (this._input_mask && (typeof c != "string")) {
		a.name = this._input_mask.apply(this, c)
	} else {
		a.name = ((this.globalBox || this.entBox).id || "dhtmlXGrid") + "_" + c
	}
	a.value = g;
	this.parentForm.appendChild(a);
	this.formInputs.push(a)
};
dhtmlXGridObject.prototype.createFormInputRow = function(g) {
	var l = (this.globalBox || this.entBox).id;
	for (var c = 0; c < this._cCount; c++) {
		var a = this.cells3(g, c);
		if (((!this.FormSubmitOnlyChanged) || a.wasChanged()) && (!this._submit_cols || this._submit_cols[c])) {
			this.createFormInput(this._input_mask ? [l, g.idd, c] : (g.idd + "_" + c), a.getValue())
		}
	}
};
dhtmlXGridObject.prototype.formCreateInputCollection = function() {
	if (this.parentForm == false) {
		return false
	}
	for (var a = 0; a < this.formInputs.length; a++) {
		this.parentForm.removeChild(this.formInputs[a])
	}
	this.formInputs = new Array();
	if (this.FormSubmitSerialization) {
		this.createFormInput("serialized", this.serialize())
	} else {
		if (this.FormSubmitOnlySelected) {
			if (this.FormSubmitOnlyRowID) {
				this.createFormInput("selected", this.getSelectedId())
			} else {
				for (var a = 0; a < this.selectedRows.length; a++) {
					this.createFormInputRow(this.selectedRows[a])
				}
			}
		} else {
			if (this._submitAR) {
				if (this._added_rows.length) {
					this.createFormInput("rowsadded", this._added_rows.join(","))
				}
				if (this._deleted_rows.length) {
					this.createFormInput("rowsdeleted", this._deleted_rows.join(","))
				}
			}
			this.forEachRow(function(c) {
				if (this.getRowById(c) !== -1) {
					this.createFormInputRow(this.rowsAr[c])
				}
			})
		}
	}
};
dhtmlXGridObject.prototype.detectParentFormPresent = function() {
	var a = false;
	var c = this.entBox;
	while (c && c.tagName && c != document.body) {
		if (c.tagName.toLowerCase() == "form") {
			a = c;
			break
		} else {
			c = c.parentNode
		}
	}
	return a
};
dhtmlXGridObject.prototype.unGroup = function() {
	if (!this._groups) {
		return
	}
	this._dndProblematic = false;
	delete this._groups;
	delete this._gIndex;
	if (this._fake) {
		this._mirror_rowsCol()
	}
	this.forEachRow(function(a) {
		this.rowsAr[a].style.display = ""
	});
	this._reset_view();
	this.callEvent("onGridReconstructed", []);
	this.callEvent("onUnGroup", [])
};
dhtmlXGridObject.prototype._mirror_rowsCol = function() {
	this._fake._groups = this._groups;
	this._fake._gIndex = this._gIndex;
	this.rowsBuffer = dhtmlxArray();
	for (var a = 0; a < this.rowsCol.length; a++) {
		if (!this.rowsCol[a]._cntr) {
			this.rowsBuffer.push(this.rowsCol[a])
		}
	}
	this._fake.rowsBuffer = dhtmlxArray();
	for (var a = 0; a < this._fake.rowsCol.length; a++) {
		if (!this._fake.rowsCol[a]._cntr) {
			this._fake.rowsBuffer.push(this._fake.rowsCol[a])
		}
	}
};
dhtmlXGridObject.prototype.groupBy = function(o, l) {
	if (this._groups) {
		this.unGroup()
	}
	this._dndProblematic = true;
	this._groups = {};
	if (!l) {
		l = ["#title"];
		for (var m = 1; m < this._cCount; m++) {
			l.push("#cspan")
		}
	}
	this._gmask = document.createElement("TR");
	this._gmask.origin = l;
	var n, g = 0;
	for (var m = 0; m < l.length; m++) {
		if (l[m] == "#cspan") {
			n.colSpan = (parseInt(n.colSpan) || 1) + 1
		} else {
			n = document.createElement("TD");
			n._cellIndex = m;
			if (this._hrrar[m]) {
				n.style.display = "none"
			}
			n.className = "group_row";
			n.innerHTML = "&nbsp;";
			if (l[m] == "#title") {
				this._gmask._title = g
			} else {
				n.align = this.cellAlign[m] || "left"
			}
			this._gmask.appendChild(n);
			if (l[m].indexOf("#stat") == 0) {
				this._gmask._math = true;
				n._counter = [this["_g_" + l[m].replace("#", "")], m, g]
			}
			g++
		}
	}
	for (var c in this._groups) {
		this._groups[c] = this.undefined
	}
	this._gIndex = o;
	if (this._fake && !this._realfake) {
		this._fake._groups = [];
		this._fake._gIndex = this._gIndex
	}
	this._nextRow = function(s, a) {
		var q = this.rowsCol[s + a];
		if (q && (q.style.display == "none" || q._cntr)) {
			return this._nextRow(s + a, a)
		}
		return q
	};
	if (!this.__sortRowsBG) {
		this._key_events = dhtmlx.extend({}, this._key_events);
		this._key_events.k38_0_0 = function() {
			if (this.editor && this.editor.combo) {
				this.editor.shiftPrev()
			} else {
				var a = this.row.rowIndex;
				if (!a) {
					return
				}
				var q = this._nextRow(a - 1, -1);
				if (q) {
					this.selectCell(q, this.cell._cellIndex, true)
				}
			}
		};
		this._key_events.k13_1_0 = this._key_events.k13_0_1 = function() {};
		this._key_events.k40_0_0 = function() {
			if (this.editor && this.editor.combo) {
				this.editor.shiftNext()
			} else {
				var a = this.row.rowIndex;
				if (!a) {
					return
				}
				var q = this._nextRow(a - 1, 1);
				if (q) {
					this.selectCell(q, this.cell._cellIndex, true)
				}
			}
		};
		this.attachEvent("onFilterStart", function() {
			if (this._groups) {
				this._groups = this.undefined
			}
			return true
		});
		this.attachEvent("onFilterEnd", function() {
			if (typeof this._gIndex != "undefined") {
				this.groupBy(this._gIndex, this._gmask.origin)
			}
		});
		this.sortRows_bg = this.sortRows;
		this.sortRows = function(r, q, a) {
			if (typeof(this._groups) == "undefined") {
				return this.sortRows_bg.apply(this, arguments)
			}
			q = q || "str";
			a = a || "asc";
			if (this.callEvent("onBeforeSorting", [r, q, a])) {
				if (typeof(this._groups) == "undefined") {
					return true
				}
				if (r == this._gIndex) {
					this._sortByGroup(r, q, a)
				} else {
					this._sortInGroup(r, q, a)
				}
				this.setSortImgState(true, r, a);
				if (this._fake) {
					this._mirror_rowsCol();
					this._fake._groups = [];
					this._fake._reset_view()
				}
				this.setSortImgState(true, r, a);
				this.callEvent("onAfterSorting", [r, q, a])
			}
			return false
		};
		this.attachEvent("onClearAll", function() {
			this.unGroup()
		});
		this.attachEvent("onBeforeRowDeleted", function(r) {
			if (!this._groups) {
				return true
			}
			if (!this.rowsAr[r]) {
				return true
			}
			var q = this.cells(r, this._gIndex).getValue();
			if (q === "") {
				q = " "
			}
			var a = this._groups[q];
			this._dec_group(a);
			return true
		});
		this.attachEvent("onAfterRowDeleted", function(a) {
			this.updateGroups()
		});
		this.attachEvent("onCheckbox", function(r, a, q) {
			this.callEvent("onEditCell", [2, r, a, (q ? 1 : 0), (q ? 0 : 1)])
		});
		this.attachEvent("onXLE", this.updateGroups);
		this.attachEvent("onColumnHidden", this.hideGroupColumn);
		this.attachEvent("onEditCell", function(C, s, y, x, D) {
			if (!this._groups) {
				return true
			}
			if (C == 2 && x != D && y == this._gIndex) {
				if (D === "") {
					D = " "
				}
				this._dec_group(this._groups[D]);
				var a = this.rowsAr[s];
				var A = this.rowsCol._dhx_find(a);
				var v = this._inc_group(x);
				var w = this.rowsCol[v];
				if (a == w) {
					w = w.nextSibling
				}
				var q = a.parentNode;
				var u = a.rowIndex;
				q.removeChild(a);
				if (w) {
					q.insertBefore(a, w)
				} else {
					q.appendChild(a)
				}
				this.rowsCol._dhx_insertAt(v, a);
				if (v < A) {
					A++
				}
				this.rowsCol._dhx_removeAt(A, a);
				this._fixAlterCss()
			} else {
				if (C == 2 && x != D) {
					this.updateGroups();
					this._updateGroupView(this._groups[this.cells(s, this._gIndex).getValue() || " "])
				}
			}
			return true
		});
		this.__sortRowsBG = true
	}
	this._groupExisting();
	if (this._hrrar) {
		for (var m = 0; m < this._hrrar.length; m++) {
			if (this._hrrar[m]) {
				this.hideGroupColumn(m, true)
			}
		}
	}
	this.callEvent("onGroup", []);
	if (this._ahgr || this._awdth) {
		this.setSizes()
	}
};
dhtmlXGridObject.prototype._sortInGroup = function(g, q, l) {
	var r = this._groups_get();
	r.reverse();
	for (var n = 0; n < r.length; n++) {
		var o = r[n]._cntr._childs;
		var s = {};
		for (var m = 0; m < o.length; m++) {
			var u = this.cells3(o[m], g);
			s[o[m].idd] = u.getDate ? u.getDate() : u.getValue()
		}
		this._sortCore(g, q, l, s, o)
	}
	this._groups_put(r);
	this.setSizes();
	this.callEvent("onGridReconstructed", [])
};
dhtmlXGridObject.prototype._sortByGroup = function(m, o, g) {
	var c = this._groups_get();
	var l = [];
	for (var n = 0; n < c.length; n++) {
		c[n].idd = "_sort_" + n;
		l["_sort_" + n] = c[n]._cntr.text
	}
	this._sortCore(m, o, g, l, c);
	this._groups_put(c);
	this.callEvent("onGridReconstructed", []);
	this.setSizes()
};
dhtmlXGridObject.prototype._inc_group = function(m, g, a) {
	if (m === "") {
		m = " "
	}
	if (!this._groups[m]) {
		this._groups[m] = {
			text: m,
			row: this._addPseudoRow(),
			count: 0,
			state: g ? "plus" : "minus"
		}
	}
	var l = this._groups[m];
	l.row._cntr = l;
	var c = this.rowsCol._dhx_find(l.row) + l.count + 1;
	l.count++;
	if (!a) {
		this._updateGroupView(l);
		this.updateGroups()
	}
	return c
};
dhtmlXGridObject.prototype._dec_group = function(a) {
	if (!a) {
		return
	}
	a.count--;
	if (a.count == 0) {
		a.row.parentNode.removeChild(a.row);
		this.rowsCol._dhx_removeAt(this.rowsCol._dhx_find(a.row));
		delete this._groups[a.text]
	} else {
		this._updateGroupView(a)
	}
	if (this._fake && !this._realfake) {
		this._fake._dec_group(this._fake._groups[a.text])
	}
	this.updateGroups();
	return true
};
dhtmlXGridObject.prototype._insertRowAt_gA = dhtmlXGridObject.prototype._insertRowAt;
dhtmlXGridObject.prototype._insertRowAt = function(g, l, c) {
	if (typeof(this._groups) != "undefined") {
		if (this._realfake) {
			var m = this._fake._bfs_cells(g.idd, this._gIndex).getValue()
		} else {
			if (this._bfs_cells3) {
				var m = this._bfs_cells3(g, this._gIndex).getValue()
			} else {
				var m = this.cells3(g, this._gIndex).getValue()
			}
		}
		if (!m) {
			m = " "
		}
		l = this._inc_group(m, g.style.display == "none")
	}
	var a = this._insertRowAt_gA(g, l, c);
	if (typeof(this._groups) != "undefined") {
		this.expandGroup(m);
		this._updateGroupView(this._groups[m]);
		this.updateGroups()
	}
	return a
};
dhtmlXGridObject.prototype._updateGroupView = function(g) {
	if (this._fake && !this._realfake) {
		return g.row.firstChild.innerHTML = "&nbsp;"
	}
	var a = this._gmask || this._fake._gmask;
	var c = "<img style='margin-bottom:-4px' src='" + this.imgURL + g.state + ".gif'> ";
	if (this.customGroupFormat) {
		c += this.customGroupFormat(g.text, g.count)
	} else {
		c += g.text + " ( " + g.count + " ) "
	}
	g.row.childNodes[a._title].innerHTML = c
};
dhtmlXGridObject.prototype._addPseudoRow = function(m) {
	var a = this._gmask || this._fake._gmask;
	var l = a.cloneNode(true);
	for (var c = 0; c < l.childNodes.length; c++) {
		l.childNodes[c]._cellIndex = a.childNodes[c]._cellIndex;
		if (this._realfake) {
			l.childNodes[c].style.display = ""
		}
	}
	var g = this;
	l.onclick = function(n) {
		if (!g.callEvent("onGroupClick", [this._cntr.text])) {
			return
		}
		if (g._fake && g._realfake) {
			g._fake._switchGroupState(g._fake._groups[this._cntr.text].row)
		} else {
			g._switchGroupState(this)
		}(n || event).cancelBubble = "true"
	};
	l.ondblclick = function(n) {
		(n || event).cancelBubble = "true"
	};
	if (!m) {
		if (_isKHTML) {
			this.obj.appendChild(l)
		} else {
			this.obj.firstChild.appendChild(l)
		}
		this.rowsCol.push(l)
	}
	return l
};
dhtmlXGridObject.prototype._groups_get = function() {
	var c = [];
	this._temp_par = this.obj.parentNode;
	this._temp_par.removeChild(this.obj);
	var g = [];
	for (var l = this.rowsCol.length - 1; l >= 0; l--) {
		if (this.rowsCol[l]._cntr) {
			this.rowsCol[l]._cntr._childs = g;
			g = [];
			c.push(this.rowsCol[l])
		} else {
			g.push(this.rowsCol[l])
		}
		this.rowsCol[l].parentNode.removeChild(this.rowsCol[l])
	}
	return c
};
dhtmlXGridObject.prototype._groups_put = function(a) {
	var m = this.rowsCol.stablesort;
	this.rowsCol = new dhtmlxArray(0);
	this.rowsCol.stablesort = m;
	for (var l = 0; l < a.length; l++) {
		var g = a[l]._cntr;
		this.obj.firstChild.appendChild(g.row);
		this.rowsCol.push(g.row);
		g.row.idd = null;
		for (var c = 0; c < g._childs.length; c++) {
			this.obj.firstChild.appendChild(g._childs[c]);
			this.rowsCol.push(g._childs[c])
		}
		delete g._childs
	}
	this._temp_par.appendChild(this.obj)
};
dhtmlXGridObject.prototype._groupExisting = function(c) {
	if (!this.getRowsNum()) {
		return
	}
	var c = [];
	this._temp_par = this.obj.parentNode;
	this._temp_par.removeChild(this.obj);
	var g = [];
	var l = this.rowsCol.length;
	for (var m = 0; m < l; m++) {
		var o = this.cells4(this.rowsCol[m].childNodes[this._gIndex]).getValue();
		this.rowsCol[m].style.display = "";
		if (!o) {
			o = " "
		}
		if (!this._groups[o]) {
			this._groups[o] = {
				text: o,
				row: this._addPseudoRow(true),
				count: 0,
				state: "minus"
			};
			var n = this._groups[o];
			n.row._cntr = n;
			this._groups[o]._childs = [];
			c.push(n.row)
		}
		this._groups[o].count++;
		this._groups[o]._childs.push(this.rowsCol[m]);
		this.rowsCol[m].parentNode.removeChild(this.rowsCol[m])
	}
	for (var m = 0; m < c.length; m++) {
		this._updateGroupView(c[m]._cntr)
	}
	this._groups_put(c);
	if (this._fake && !this._realfake) {
		this._mirror_rowsCol();
		this._fake._groups = [];
		this._fake._reset_view()
	}
	this.callEvent("onGridReconstructed", []);
	this.updateGroups()
};
dhtmlXGridObject.prototype._switchGroupState = function(l) {
	var g = l._cntr;
	if (this._fake && !this._realfake) {
		g.state = this._fake._groups[l._cntr.text].row._cntr.state;
		this._fake._switchGroupState(this._fake._groups[l._cntr.text].row)
	}
	var c = this.rowsCol._dhx_find(g.row) + 1;
	g.state = g.state == "minus" ? "plus" : "minus";
	var a = g.state == "plus" ? "none" : "";
	while (this.rowsCol[c] && !this.rowsCol[c]._cntr) {
		this.rowsCol[c].style.display = a;
		c++
	}
	this._updateGroupView(g);
	this.callEvent("onGroupStateChanged", [g.text, (g.state == "minus")]);
	this.setSizes()
};
dhtmlXGridObject.prototype.expandGroup = function(a) {
	if (this._groups[a].state == "plus") {
		this._switchGroupState(this._groups[a].row)
	}
};
dhtmlXGridObject.prototype.collapseGroup = function(a) {
	if (this._groups[a].state == "minus") {
		this._switchGroupState(this._groups[a].row)
	}
};
dhtmlXGridObject.prototype.expandAllGroups = function() {
	for (var a in this._groups) {
		if (this._groups[a] && this._groups[a].state == "plus") {
			this._switchGroupState(this._groups[a].row)
		}
	}
};
dhtmlXGridObject.prototype.collapseAllGroups = function() {
	for (var a in this._groups) {
		if (this._groups[a] && this._groups[a].state == "minus") {
			this._switchGroupState(this._groups[a].row)
		}
	}
};
dhtmlXGridObject.prototype.hideGroupColumn = function(n, m) {
	if (this._fake) {
		return
	}
	var l = -1;
	var o = this._gmask.childNodes;
	for (var g = 0; g < o.length; g++) {
		if (o[g]._cellIndex == n) {
			l = g;
			break
		}
	}
	if (l == -1) {
		return
	}
	for (var c in this._groups) {
		this._groups[c].row.childNodes[l].style.display = m ? "none" : ""
	}
};
dhtmlXGridObject.prototype.groupStat = function(c, l, g) {
	g = this["_g_" + (g || "stat_total")];
	var m = 0;
	var a = 0;
	this.forEachRowInGroup(c, function(n) {
		m = g(m, this.cells(n, l).getValue() * 1, a);
		a++
	});
	return m
};
dhtmlXGridObject.prototype.forEachRowInGroup = function(a, l) {
	var m = this._groups[a].row.nextSibling;
	if (m) {
		while (m && !m._cntr) {
			l.call(this, m.idd);
			m = m.nextSibling
		}
	} else {
		var g = this._groups[a]._childs;
		if (g) {
			for (var c = 0; c < g.length; c++) {
				l.call(this, g[c].idd)
			}
		}
	}
};
dhtmlXGridObject.prototype.updateGroups = function() {
	if (!this._gmask || !this._gmask._math || this._parsing) {
		return
	}
	var c = this._gmask.childNodes;
	for (var a = 0; a < c.length; a++) {
		if (c[a]._counter) {
			this._b_processing.apply(this, c[a]._counter)
		}
	}
};
dhtmlXGridObject.prototype._b_processing = function(g, o, n) {
	var q = 0,
		l = 0;
	if (!this._ecache[this.cellType[o]]) {
		this.cells5({
			parentNode: {
				grid: this
			}
		}, this.cellType[o])
	}
	for (var m = this.rowsCol.length - 1; m >= 0; m--) {
		if (!this.rowsCol[m]._cntr) {
			q = g(q, this.cells3(this.rowsCol[m], o).getValue() * 1, l);
			l++
		} else {
			this.cells5(this.rowsCol[m].childNodes[n], this.cellType[o]).setValue(q);
			l = q = 0
		}
	}
};
dhtmlXGridObject.prototype._g_stat_total = function(l, g, a) {
	return l + g
};
dhtmlXGridObject.prototype._g_stat_min = function(l, g, a) {
	if (!a) {
		l = Infinity
	}
	return Math.min(l, g)
};
dhtmlXGridObject.prototype._g_stat_max = function(l, g, a) {
	if (!a) {
		l = -Infinity
	}
	return Math.max(l, g)
};
dhtmlXGridObject.prototype._g_stat_average = function(l, g, a) {
	return (l * a + g) / (a + 1)
};
dhtmlXGridObject.prototype._g_stat_count = function(l, g, a) {
	return l++
};
dhtmlXGridObject.prototype._in_header_collapse = function(m, l, q) {
	var a = m.tagName == "TD" ? m : m.parentNode;
	l = a._cellIndexS;
	if (!this._column_groups) {
		this._column_groups = []
	}
	var o = q[1].split(":");
	var o = q[1].split(":");
	o = [o.shift(), o.join(":")];
	var n = parseInt(o[0]);
	m.innerHTML = q[0] + "<img src='" + this.imgURL + "minus.gif' style='padding-right:10px;height:16px'/><span style='position:relative; top:-6px;'>" + (o[1] || "") + "<span>";
	m.style.paddingBottom = "0px";
	var g = this;
	this._column_groups[l] = m.getElementsByTagName("IMG")[0];
	this._column_groups[l].onclick = function(r) {
		(r || event).cancelBubble = true;
		this._cstate = !this._cstate;
		for (var c = l + 1; c < (l + n); c++) {
			g.setColumnHidden(c, this._cstate)
		}
		if (this._cstate) {
			if (a.colSpan && a.colSpan > 0) {
				a._exp_colspan = a.colSpan;
				var v = Math.max(1, a.colSpan - n);
				if (!_isFF) {
					for (var s = 0; s < a.colSpan - v; s++) {
						var u = document.createElement("TD");
						if (a.nextSibling) {
							a.parentNode.insertBefore(u, a.nextSibling)
						} else {
							a.parentNode.appendChild(u)
						}
					}
				}
				a.colSpan = v
			}
			g.callEvent("onColumnCollapse", [l, this._cstate])
		} else {
			if (a._exp_colspan) {
				a.colSpan = a._exp_colspan;
				if (!_isFF) {
					for (var s = 1; s < a._exp_colspan; s++) {
						a.parentNode.removeChild(a.nextSibling)
					}
				}
				g.callEvent("onColumnCollapse", [l, this._cstate])
			}
		}
		this.src = g.imgURL + (this._cstate ? "plus.gif" : "minus.gif");
		if (g.sortImg.style.display != "none") {
			g.setSortImgPos()
		}
	}
};
dhtmlXGridObject.prototype.collapseColumns = function(a) {
	if (!this._column_groups[a] || this._column_groups[a]._cstate) {
		return
	}
	this._column_groups[a].onclick({})
};
dhtmlXGridObject.prototype.expandColumns = function(a) {
	if (!this._column_groups[a] || !this._column_groups[a]._cstate) {
		return
	}
	this._column_groups[a].onclick({})
};
dhtmlXGridObject.prototype.enableHeaderMenu = function(a) {
	if (!window.dhtmlXMenuObject) {
		return dhtmlx.message("You need to include DHTMLX Menu")
	}
	if (!this._header_menu) {
		var g = this._header_menu = new dhtmlXMenuObject();
		g.renderAsContextMenu();
		var c = this;
		g.attachEvent("onBeforeContextMenu", function() {
			c._showHContext(a);
			return true
		});
		g.attachEvent("onClick", function(s) {
			var o = this.getCheckboxState(s);
			var q = c.hdr.rows[1];
			for (var m = 0; m < q.cells.length; m++) {
				var r = q.cells[m];
				if (r._cellIndexS == s) {
					var l = r.colSpan || 1;
					for (var n = 0; n < l; n++) {
						c.setColumnHidden(s * 1 + n, !o)
					}
				}
			}
		});
		this.attachEvent("onInit", function() {
			g.addContextZone(this.hdr)
		});
		if (this.hdr.rows.length) {
			this.callEvent("onInit", [])
		}
	}
};
dhtmlXGridObject.prototype.getHeaderMenu = function(a) {
	return this._header_menu
};
dhtmlXGridObject.prototype._hideHContext = function() {
	if (this._header_menu) {
		this._header_menu.hide()
	}
};
dhtmlXGridObject.prototype._showHContext = function(l) {
	if (typeof l == "string") {
		l = l.split(this.delim)
	}
	var m = 0;
	var a = 0;
	this._header_menu.clearAll();
	for (var g = 0; g < this.hdr.rows[1].cells.length; g++) {
		var q = this.hdr.rows[1].cells[g];
		if (!l || (l[m] && l[m] != "false")) {
			if (q.firstChild && q.firstChild.tagName == "DIV") {
				var o = q.firstChild.innerHTML
			} else {
				var o = q.innerHTML
			}
			o = o.replace(/<[^>]*>/gi, "");
			var n = !(this.isColumnHidden(m) || (this.getColWidth(m) == 0));
			this._header_menu.addCheckbox("child", this._header_menu.topId, a, m, o, n);
			a++
		}
		m += (q.colSpan || 1)
	}
};
dhtmlXGridObject.prototype._process_json_row = function(m, n) {
	m._attrs = n;
	for (var g = 0; g < m.childNodes.length; g++) {
		m.childNodes[g]._attrs = {}
	}
	if (n.userdata) {
		for (var c in n.userdata) {
			this.setUserData(m.idd, c, n.userdata[c])
		}
	}
	n = this._c_order ? this._swapColumns(n.data) : n.data;
	for (var l = 0; l < n.length; l++) {
		if (typeof n[l] == "object" && n[l] != null) {
			m.childNodes[l]._attrs = n[l];
			if (n[l].type) {
				m.childNodes[l]._cellType = n[l].type
			}
			n[l] = n[l].value
		}
	}
	this._fillRow(m, n);
	return m
};
dhtmlXGridObject.prototype._process_js_row = function(n, o) {
	n._attrs = o;
	for (var l = 0; l < n.childNodes.length; l++) {
		n.childNodes[l]._attrs = {}
	}
	if (o.userdata) {
		for (var g in o.userdata) {
			this.setUserData(n.idd, g, o.userdata[g])
		}
	}
	var c = [];
	for (var m = 0; m < this.columnIds.length; m++) {
		c[m] = o[this.columnIds[m]];
		if (typeof c[m] == "object" && c[m] != null) {
			n.childNodes[m]._attrs = c[m];
			if (c[m].type) {
				n.childNodes[m]._cellType = c[m].type
			}
			c[m] = c[m].value
		}
		if (!c[m] && c[m] !== 0) {
			c[m] = ""
		}
	}
	this._fillRow(n, c);
	return n
};
dhtmlXGridObject.prototype.updateFromJSON = function(a, l, c, g) {
	if (typeof l == "undefined") {
		l = true
	}
	this._refresh_mode = [true, l, c];
	this.load(a, g, "json")
}, dhtmlXGridObject.prototype._refreshFromJSON = function(g) {
	if (this._f_rowsBuffer) {
		this.filterBy(0, "")
	}
	reset = false;
	if (window.eXcell_tree) {
		eXcell_tree.prototype.setValueX = eXcell_tree.prototype.setValue;
		eXcell_tree.prototype.setValue = function(v) {
			var u = this.grid._h2.get[this.cell.parentNode.idd];
			if (u && this.cell.parentNode.valTag) {
				this.setLabel(v)
			} else {
				this.setValueX(v)
			}
		}
	}
	
	//modify code by zzm 20160826
	if (window.eXcell_treero) {
		eXcell_treero.prototype.setValueX = eXcell_treero.prototype.setValue;
		eXcell_treero.prototype.setValue = function(v) {
			var u = this.grid._h2.get[this.cell.parentNode.idd];
			if (u && this.cell.parentNode.valTag) {
				this.setLabel(v)
			} else {
				this.setValueX(v)
			}
		}
	}
	
	
	var s = this.cellType._dhx_find("tree");
	var m = g.parent || 0;
	var o = {};
	if (this._refresh_mode[2]) {
		if (s != -1) {
			this._h2.forEachChild(m, function(u) {
				o[u.id] = true
			}, this)
		} else {
			this.forEachRow(function(u) {
				o[u] = true
			})
		}
	}
	var r = g.rows;
	for (var l = 0; l < r.length; l++) {
		var q = r[l];
		var a = q.id;
		o[a] = false;
		if (this.rowsAr[a] && this.rowsAr[a].tagName != "TR") {
			if (this._h2) {
				this._h2.get[a].buff.data = q
			} else {
				this.rowsBuffer[this.getRowIndex(a)].data = q
			}
			this.rowsAr[a] = q
		} else {
			if (this.rowsAr[a]) {
				this._process_json_row(this.rowsAr[a], q, -1);
				this._postRowProcessing(this.rowsAr[a], true)
			} else {
				if (this._refresh_mode[1]) {
					var n = {
						idd: a,
						data: q,
						_parser: this._process_json_row,
						_locator: this._get_json_data
					};
					var c = this.rowsBuffer.length;
					if (this._refresh_mode[1] == "top") {
						this.rowsBuffer.unshift(n);
						c = 0
					} else {
						this.rowsBuffer.push(n)
					}
					if (this._h2) {
						reset = true;
						(this._h2.add(a, m)).buff = this.rowsBuffer[this.rowsBuffer.length - 1]
					}
					this.rowsAr[a] = q;
					q = this.render_row(c);
					this._insertRowAt(q, c ? -1 : 0)
				}
			}
		}
	}
	if (this._refresh_mode[2]) {
		for (a in o) {
			if (o[a] && this.rowsAr[a]) {
				this.deleteRow(a)
			}
		}
	}
	this._refresh_mode = null;
	if (window.eXcell_tree) {
		eXcell_tree.prototype.setValue = eXcell_tree.prototype.setValueX
	}
	
	//modify code by zzm 20160826
	if (window.eXcell_treero) {
		eXcell_treero.prototype.setValue = eXcell_treero.prototype.setValueX
	}
	
	if (reset) {
		this._renderSort()
	}
	if (this._f_rowsBuffer) {
		this._f_rowsBuffer = null;
		this.filterByAll()
	}
}, dhtmlXGridObject.prototype._process_js = function(a) {
	return this._process_json(a, "js")
}, dhtmlXGridObject.prototype._parseHeadJson = function(u) {
	if (!u.head || !u.head.length) {
		return
	}
	var a = u.head;
	var l = u.settings;
	var o = "setInitWidths";
	var r = false;
	if (l && l.colwidth == "%") {
		o = "setInitWidthsP"
	}
	if (l && l.splitat == "%") {
		r = l.splitat
	}
	if (this.hdr.rows.length > 0) {
		this.clearAll(true)
	}
	var q = [
		[],
		[],
		[],
		[],
		[],
		[],
		[]
	];
	var s = ["value", "width", "type", "align", "sort", "hidden", "id"];
	var w = ["", o, "setColTypes", "setColAlign", "setColSorting", "", "setColumnIds"];
	for (var n = 0; n < a.length; n++) {
		for (var m = 0; m < s.length; m++) {
			q[m].push(a[n][s[m]])
		}
	}
	this.setHeader(q[0]);
	for (var n = 0; n < w.length; n++) {
		if (w[n]) {
			this[w[n]](q[n].join(this.delim))
		}
	}
	for (var n = 0; n < a.length; n++) {
		var v = a[n].options;
		if (a[n].options) {
			if (this.cellType[n] == "clist") {
				this.registerCList(n, v)
			} else {
				var c = this.getCombo(n);
				for (var m = 0; m < v.length; m++) {
					c.put(v[m].id, v[m].value)
				}
			}
		}
	}
	this.init();
	var g = q[5].join(this.delim);
	if (this.setColHidden && g.replace(/,/g, "") != "") {
		this.setColHidden(g)
	}
	if ((r) && (this.splitAt)) {
		this.splitAt(r)
	}
};
dhtmlXGridObject.prototype._process_json = function(data, mode) {
	this._parsing = true;
	try {
		var data = data.responseText || data;
		if (typeof data == "string") {
			eval("dhtmlx.temp=" + data + ";");
			data = dhtmlx.temp
		}
	} catch (e) {
		dhx4.callEvent("onLoadXMLError", ["Incorrect JSON", (data.xmlDoc || data), this]);
		data = {
			rows: []
		}
	}
	if (this._refresh_mode) {
		return this._refreshFromJSON(data)
	}
	if (data.head) {
		this._parseHeadJson(data)
	}
	var cr = parseInt(data.pos || 0);
	var total = parseInt(data.total_count || 0);
	var reset = false;
	if (total) {
		if (!this.rowsBuffer[total - 1]) {
			if (this.rowsBuffer.length) {
				reset = true
			}
			this.rowsBuffer[total - 1] = null
		}
		if (total < this.rowsBuffer.length) {
			this.rowsBuffer.splice(total, this.rowsBuffer.length - total);
			reset = true
		}
	}
	var userdata = mode === "js" ? data.userdata : data;
	for (var key in userdata) {
		if (mode === "js" || key != "rows") {
			this.setUserData("", key, userdata[key])
		}
	}
	if (mode == "js" && data.collections) {
		for (var colkey in data.collections) {
			var index = this.getColIndexById(colkey);
			var colrecs = data.collections[colkey];
			if (index !== window.undefined) {
				if (this.cellType[index] == "clist") {
					colplaindata = [];
					for (var j = 0; j < colrecs.length; j++) {
						colplaindata.push(colrecs[j].label)
					}
					this.registerCList(index, colplaindata)
				} else {
					var combo = this.getCombo(index);
					for (var j = 0; j < colrecs.length; j++) {
						combo.put(colrecs[j].value, colrecs[j].label)
					}
				}
			}
		}
	}
	if (this.isTreeGrid()) {
		return this._process_tree_json(data, null, null, mode)
	}
	if (mode == "js") {
		if (data.data) {
			data = data.data
		}
		for (var i = 0; i < data.length; i++) {
			if (this.rowsBuffer[i + cr]) {
				continue
			}
			var row = data[i];
			var id = row.id || (i + 1);
			this.rowsBuffer[i + cr] = {
				idd: id,
				data: row,
				_parser: this._process_js_row,
				_locator: this._get_js_data
			};
			this.rowsAr[id] = data[i]
		}
	} else {
		for (var i = 0; i < data.rows.length; i++) {
			if (this.rowsBuffer[i + cr]) {
				continue
			}
			var id = data.rows[i].id;
			this.rowsBuffer[i + cr] = {
				idd: id,
				data: data.rows[i],
				_parser: this._process_json_row,
				_locator: this._get_json_data
			};
			this.rowsAr[id] = data.rows[i]
		}
	}
	this.callEvent("onDataReady", []);
	if (reset && this._srnd) {
		var h = this.objBox.scrollTop;
		this._reset_view();
		this.objBox.scrollTop = h
	} else {
		this.render_dataset()
	}
	this._parsing = false
};
dhtmlXGridObject.prototype._get_json_data = function(c, a) {
	if (typeof c.data[a] == "object") {
		return c.data[a].value
	} else {
		return c.data[a]
	}
};
dhtmlXGridObject.prototype._process_tree_json = function(l, m, c, o) {
	this._parsing = true;
	var a = false;
	if (!m) {
		this.render_row = this.render_row_tree;
		a = true;
		m = l;
		c = m.parent || 0;
		if (c == "0") {
			c = 0
		}
		if (!this._h2) {
			this._h2 = this._createHierarchy()
		}
		if (this._fake) {
			this._fake._h2 = this._h2
		}
	}
	if (o == "js") {
		if (m.data && !c) {
			l = m.data
		}
		if (m.rows) {
			m = m.rows
		}
		for (var g = 0; g < m.length; g++) {
			var q = m[g].id;
			var n = this._h2.add(q, c);
			n.buff = {
				idd: q,
				data: m[g],
				_parser: this._process_js_row,
				_locator: this._get_js_data
			};
			if (m[g].open) {
				n.state = "minus"
			}
			this.rowsAr[q] = n.buff;
			this._process_tree_json(m[g], m[g], q, o)
		}
	} else {
		if (m.rows) {
			for (var g = 0; g < m.rows.length; g++) {
				var q = m.rows[g].id;
				var n = this._h2.add(q, c);
				n.buff = {
					idd: q,
					data: m.rows[g],
					_parser: this._process_json_row,
					_locator: this._get_json_data
				};
				if (m.rows[g].open) {
					n.state = "minus"
				}
				this.rowsAr[q] = n.buff;
				this._process_tree_json(m.rows[g], m.rows[g], q, o)
			}
		}
	}
	if (a) {
		if (c != 0) {
			this._h2.change(c, "state", "minus")
		}
		this._updateTGRState(this._h2.get[c]);
		this._h2_to_buff();
		this.callEvent("onDataReady", []);
		if (c != 0 && (this._srnd || this.pagingOn)) {
			this._renderSort()
		} else {
			this.render_dataset()
		}
		if (this._slowParse === false) {
			this.forEachRow(function(r) {
				this.render_row_tree(0, r)
			})
		}
		this._parsing = false;
		if (c != 0 && !this._srnd) {
			this.callEvent("onOpenEnd", [c, 1])
		}
	}
};
dhtmlXGridObject.prototype.enableMarkedCells = function(a) {
	this.markedRowsArr = new dhtmlxArray(0);
	this.markedCellsArr = new Array(0);
	this.lastMarkedRow = null;
	this.lastMarkedColumn = null;
	this.markedCells = true;
	this.lastMarkMethod = 0;
	if (arguments.length > 0) {
		if (!dhx4.s2b(a)) {
			this.markedCells = false
		}
	}
};
dhtmlXGridObject.prototype.doMark = function(g, o) {
	var n = g.parentNode.idd;
	this.setActive(true);
	if (!n) {
		return
	}
	this.editStop();
	this.cell = g;
	this.row = g.parentNode;
	var r = g._cellIndex;
	if (!o) {
		o = 0
	}
	if (o == 0) {
		this.unmarkAll()
	} else {
		if (o == 1) {
			if (this.lastMarkedRow) {
				var c = Math.min(this.getRowIndex(n), this.getRowIndex(this.lastMarkedRow));
				var q = Math.max(this.getRowIndex(n), this.getRowIndex(this.lastMarkedRow));
				var a = Math.min(r, this.lastMarkedColumn);
				var s = Math.max(r, this.lastMarkedColumn);
				for (var m = c; m < q + 1; m++) {
					for (var l = a; l < s + 1; l++) {
						this.mark(this.getRowId(m), l, true)
					}
				}
			}
		} else {
			if (o == 2) {
				if (this.markedRowsArr._dhx_find(n) != -1) {
					for (var u = 0; u < this.markedCellsArr[n].length; u++) {
						if (this.markedCellsArr[n][u] == r) {
							this.mark(n, r, false);
							return true
						}
					}
				}
			}
		}
	}
	if (!this.markedCellsArr[n]) {
		this.markedCellsArr[n] = new dhtmlxArray(0)
	}
	if (o != 1) {
		this.mark(n, r)
	}
	this.moveToVisible(this.cells(n, r).cell);
	this.lastMarkedRow = n;
	this.lastMarkedColumn = r;
	this.lastMarkMethod = o
};
dhtmlXGridObject.prototype.mark = function(g, c, l) {
	if (arguments.length > 2) {
		if (!dhx4.s2b(l)) {
			this.cells(g, c).cell.className = this.cells(g, c).cell.className.replace(/cellselected/g, "");
			if (this.markedRowsArr._dhx_find(g) != -1) {
				var a = this.markedCellsArr[g]._dhx_find(c);
				if (a != -1) {
					this.markedCellsArr[g]._dhx_removeAt(a);
					if (this.markedCellsArr[g].length == 0) {
						this.markedRowsArr._dhx_removeAt(this.markedRowsArr._dhx_find(g))
					}
					this.callEvent("onCellUnMarked", [g, c])
				}
			}
			return true
		}
	}
	this.cells(g, c).cell.className += " cellselected";
	if (this.markedRowsArr._dhx_find(g) == -1) {
		this.markedRowsArr[this.markedRowsArr.length] = g
	}
	if (!this.markedCellsArr[g]) {
		this.markedCellsArr[g] = new dhtmlxArray(0)
	}
	if (this.markedCellsArr[g]._dhx_find(c) == -1) {
		this.markedCellsArr[g][this.markedCellsArr[g].length] = c;
		this.callEvent("onCellMarked", [g, c])
	}
};
dhtmlXGridObject.prototype.unmarkAll = function() {
	if (this.markedRowsArr) {
		for (var a = 0; a < this.markedRowsArr.length; a++) {
			var g = this.markedRowsArr[a];
			if (this.rowsAr[g]) {
				for (var c = 0; c < this.markedCellsArr[g].length; c++) {
					this.callEvent("onCellUnMarked", [g, this.markedCellsArr[g][c]]);
					this.cells(g, this.markedCellsArr[g][c]).cell.className = this.cells(g, this.markedCellsArr[g][c]).cell.className.replace(/cellselected/g, "")
				}
			}
		}
		this.markedRowsArr = new dhtmlxArray(0);
		this.markedCellsArr = new Array(0)
	}
	return true
};
dhtmlXGridObject.prototype.getMarked = function() {
	var g = new Array();
	if (this.markedRowsArr) {
		for (var a = 0; a < this.markedRowsArr.length; a++) {
			var l = this.markedRowsArr[a];
			for (var c = 0; c < this.markedCellsArr[l].length; c++) {
				g[g.length] = [l, this.markedCellsArr[l][c]]
			}
		}
	}
	return g
};

function eXcell_math(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid
	}
	this.edit = function() {
		this.grid.editor = new eXcell_ed(this.cell);
		this.grid.editor.fix_self = true;
		this.grid.editor.getValue = this.cell.original ? (function() {
			return this.cell.original
		}) : this.getValue;
		this.grid.editor.setValue = this.setValue;
		this.grid.editor.edit()
	};
	this.isDisabled = function() {
		return !this.grid._mathEdit
	};
	this.setValue = function(c) {
		c = this.grid._compileSCL(c, this.cell, this.fix_self);
		if (this.grid._strangeParams[this.cell._cellIndex]) {
			this.grid.cells5(this.cell, this.grid._strangeParams[this.cell._cellIndex]).setValue(c)
		} else {
			this.setCValue(c);
			this.cell._clearCell = false
		}
	};
	this.getValue = function() {
		if (this.grid._strangeParams[this.cell._cellIndex]) {
			return this.grid.cells5(this.cell, this.grid._strangeParams[this.cell._cellIndex]).getValue()
		}
		return this.cell.innerHTML
	}
}
eXcell_math.prototype = new eXcell;
dhx4.attachEvent("onGridCreated", function(a) {
	a._mat_links = {};
	a._aggregators = [];
	a.attachEvent("onClearAll", function() {
		this._mat_links = {};
		this._aggregators = []
	});
	a.attachEvent("onCellChanged", function(o, n) {
		if (this._mat_links[o]) {
			var c = this._mat_links[o][n];
			if (c) {
				for (var m = 0; m < c.length; m++) {
					if (c[m].parentNode) {
						this.cells5(c[m]).setValue(this._calcSCL(c[m]))
					}
				}
			}
		}
		if (!this._parsing && this._aggregators[n]) {
			var l = this._h2.get[o].parent.id;
			if (l != 0) {
				var g = this.cells(l, n);
				g.setValue(this._calcSCL(g.cell))
			}
		}
	});
	a.attachEvent("onAfterRowDeleted", function(m, g) {
		if (g != 0) {
			if (!this._parsing && this._aggregators.length) {
				for (var l = 0; l < this._aggregators.length; l++) {
					if (this._aggregators[l]) {
						var c = this.cells(g, l);
						c.setValue(this._calcSCL(c.cell))
					}
				}
			}
		}
		return true
	});
	a.attachEvent("onXLE", function() {
		for (var c = 0; c < this._aggregators.length; c++) {
			if (this._aggregators[c]) {
				this._h2.forEachChild(0, function(l) {
					if (l.childs.length != 0) {
						var g = this.cells(l.id, c);
						g.setValue(this._calcSCL(g.cell))
					}
				}, this)
			}
		}
	})
});
dhtmlXGridObject.prototype.enableMathSerialization = function(a) {
	this._mathSerialization = dhx4.s2b(a)
};
dhtmlXGridObject.prototype.setMathRound = function(a) {
	this._roundDl = a;
	this._roundD = Math.pow(10, a)
};
dhtmlXGridObject.prototype.enableMathEditing = function(a) {
	this._mathEdit = dhx4.s2b(a)
};
dhtmlXGridObject.prototype._calcSCL = function(cell) {
	if (!cell._code) {
		return this.cells5(cell).getValue()
	}
	try {
		dhtmlx.agrid = this;
		var z = eval(cell._code)
	} catch (e) {
		return ("#SCL")
	}
	if (this._roundD) {
		var pre = Math.abs(z) < 1 ? "0" : "";
		if (z < 0) {
			pre = "-" + pre
		}
		z = Math.round(Math.abs(z) * this._roundD).toString();
		if (z == 0) {
			return 0
		}
		if (this._roundDl > 0) {
			var n = z.length - this._roundDl;
			if (n < 0) {
				z = ("000000000" + z).substring(9 + n);
				n = 0
			}
			return (pre + z.substring(0, n) + "." + z.substring(n, z.length))
		}
		return pre + z
	}
	return z
};
dhtmlXGridObject.prototype._countTotal = function(n, c) {
	var a = 0;
	var m = this._h2.get[n];
	for (var g = 0; g < m.childs.length; g++) {
		if (!m.childs[g].buff) {
			return a
		}
		if (m.childs[g].buff._parser) {
			this._h2.forEachChild(n, function(o) {
				if (o.childs.length == 0) {
					var q = parseFloat(this._get_cell_value(o.buff, c), 10);
					if (q) {
						a += q
					}
				}
			}, this);
			return a
		}
		var l = parseFloat(this._get_cell_value(m.childs[g].buff, c), 10);
		if (l) {
			a += l
		}
	}
	return a
};
dhtmlXGridObject.prototype._compileSCL = function(g, c, a) {
	if (g === null || g === window.undefined) {
		return g
	}
	g = g.toString();
	if (g.indexOf("=") != 0 || !c.parentNode) {
		this._reLink([], c);
		if (a) {
			c._code = c.original = null
		}
		return g
	}
	c.original = g;
	var n = null;
	g = g.replace("=", "");
	if (g.indexOf("sum") != -1) {
		g = g.replace("sum", "(dhtmlx.agrid._countTotal('" + c.parentNode.idd + "'," + c._cellIndex + "))");
		if (!this._aggregators) {
			this._aggregators = []
		}
		this._aggregators[c._cellIndex] = "sum";
		c._code = g;
		return this._parsing ? "" : this._calcSCL(c)
	}
	if (g.indexOf("[[") != -1) {
		var m = /(\[\[([^\,]*)\,([^\]]*)]\])/g;
		dhtmlx.agrid = this;
		n = n || (new Array());
		g = g.replace(m, function(q, o, s, r) {
			if (s == "-") {
				s = c.parentNode.idd
			}
			if (s.indexOf("#") == 0) {
				s = dhtmlx.agrid.getRowId(s.replace("#", ""))
			}
			n[n.length] = [s, r];
			return '(parseFloat(dhtmlx.agrid.cells("' + s + '",' + r + ").getValue(),10))"
		})
	}
	if (g.indexOf(":") != -1) {
		var m = /:(\w+)/g;
		dhtmlx.agrid = this;
		var l = c.parentNode.idd;
		n = n || (new Array());
		g = g.replace(m, function(q, o, s, r) {
			n[n.length] = [l, dhtmlx.agrid.getColIndexById(o)];
			return '(parseFloat(dhtmlx.agrid.cells("' + l + '",dhtmlx.agrid.getColIndexById("' + o + '")).getValue(),10))'
		})
	} else {
		var m = /c([0-9]+)/g;
		dhtmlx.agrid = this;
		var l = c.parentNode.idd;
		n = n || (new Array());
		g = g.replace(m, function(q, o, s, r) {
			n[n.length] = [l, o];
			return '(parseFloat(dhtmlx.agrid.cells("' + l + '",' + o + ").getValue(),10))"
		})
	}
	this._reLink(n, c);
	c._code = g;
	return this._calcSCL(c)
};
dhtmlXGridObject.prototype._reLink = function(c, a) {
	if (!c.length) {
		return
	}
	for (var l = 0; l < c.length; l++) {
		if (!this._mat_links[c[l][0]]) {
			this._mat_links[c[l][0]] = {}
		}
		var g = this._mat_links[c[l][0]];
		if (!g[c[l][1]]) {
			g[c[l][1]] = []
		}
		g[c[l][1]].push(a)
	}
};
if (_isKHTML) {
	(function() {
		var a = String.prototype.replace;
		String.prototype.replace = function(s, g) {
			if (typeof g != "function") {
				return a.apply(this, arguments)
			}
			var m = "" + this;
			var q = g;
			if (!(s instanceof RegExp)) {
				var o = m.indexOf(s);
				return (o == -1 ? m : a.apply(m, [s, q(s, o, m)]))
			}
			var c = s;
			var u = [];
			var n = c.lastIndex;
			var r;
			while ((r = c.exec(m)) != null) {
				var o = r.index;
				var l = r.concat(o, m);
				u.push(m.slice(n, o), q.apply(null, l).toString());
				if (!c.global) {
					n += RegExp.lastMatch.length;
					break
				} else {
					n = c.lastIndex
				}
			}
			u.push(m.slice(n));
			return u.join("")
		}
	})()
}
dhtmlXGridObject.prototype.insertColumn = function(g, q, s, a, o, r, v, c, m) {
	g = parseInt(g);
	if (g > this._cCount) {
		g = this._cCount
	}
	if (!this._cMod) {
		this._cMod = this._cCount
	}
	this._processAllArrays(this._cCount, g - 1, [(q || "&nbsp;"), (a || 100), (s || "ed"), (r || "left"), (v || ""), (o || "na"), (m || ""), "", this._cMod, (a || 100)]);
	this._processAllRows("_addColInRow", g);
	if (typeof(q) == "object") {
		for (var n = 1; n < this.hdr.rows.length; n++) {
			if (q[n - 1] == "#rspan") {
				var x = n - 1;
				var w = false;
				var u = null;
				while (!w) {
					var u = this.hdr.rows[x];
					for (var l = 0; l < u.cells.length; l++) {
						if (u.cells[l]._cellIndex == g) {
							w = l;
							break
						}
					}
					x--
				}
				this.hdr.rows[x + 1].cells[l].rowSpan = (this.hdr.rows[x].cells[l].rowSpan || 1) + 1
			} else {
				this.setHeaderCol(g, (q[n - 1] || "&nbsp;"), n)
			}
		}
	} else {
		this.setHeaderCol(g, (q || "&nbsp;"))
	}
	this.hdr.rows[0].cells[g];
	this._cCount++;
	this._cMod++;
	this._master_row = null;
	this.setSizes()
};
dhtmlXGridObject.prototype.deleteColumn = function(a) {
	a = parseInt(a);
	if (this._cCount == 0) {
		return
	}
	if (!this._cMod) {
		this._cMod = this._cCount
	}
	if (a >= this._cCount) {
		return
	}
	this._processAllArrays(a, this._cCount - 1, [null, null, null, null, null, null, null, null, null, null, null]);
	this._processAllRows("_deleteColInRow", a);
	this._cCount--;
	this._master_row = null;
	this.setSizes()
};
dhtmlXGridObject.prototype._processAllRows = function(m, a, c) {
	this[m](this.obj.rows[0], a, c, 0);
	var l = this.hdr.rows.length;
	for (var g = 0; g < l; g++) {
		this[m](this.hdr.rows[g], a, c, g)
	}
	if (this.ftr) {
		var l = this.ftr.firstChild.rows.length;
		for (var g = 0; g < l; g++) {
			this[m](this.ftr.firstChild.rows[g], a, c, g)
		}
	}
	this.forEachRow(function(n) {
		if (this.rowsAr[n] && this.rowsAr[n].tagName == "TR") {
			this[m](this.rowsAr[n], a, c, -1)
		}
	})
};
dhtmlXGridObject.prototype._processAllArrays = function(s, a, r) {
	var n = ["hdrLabels", "initCellWidth", "cellType", "cellAlign", "cellVAlign", "fldSort", "columnColor", "_hrrar", "_c_order"];
	if (this.cellWidthPX.length) {
		n.push("cellWidthPX")
	}
	if (this.cellWidthPC.length) {
		n.push("cellWidthPC")
	}
	if (this._col_combos) {
		n.push("_col_combos")
	}
	if (this._mCols) {
		n[n.length] = "_mCols"
	}
	if (this.columnIds) {
		n[n.length] = "columnIds"
	}
	if (this._maskArr) {
		n.push("_maskArr")
	}
	if (this._drsclmW) {
		n.push("_drsclmW")
	}
	if (this._RaSeCol) {
		n.push("_RaSeCol")
	}
	if (this._hm_config) {
		n.push("_hm_config")
	}
	if (this._drsclmn) {
		n.push("_drsclmn")
	}
	if (this.clists) {
		n.push("clists")
	}
	if (this._validators && this._validators.data) {
		n.push(this._validators.data)
	}
	n.push("combos");
	if (this._customSorts) {
		n.push("_customSorts")
	}
	if (this._aggregators) {
		n.push("_aggregators")
	}
	var q = (s <= a);
	if (!this._c_order) {
		this._c_order = new Array();
		var g = this._cCount;
		for (var o = 0; o < g; o++) {
			this._c_order[o] = o
		}
	}
	for (var o = 0; o < n.length; o++) {
		var u = this[n[o]] || n[o];
		if (u) {
			if (q) {
				var c = u[s];
				for (var m = s; m < a; m++) {
					u[m] = u[m + 1]
				}
				u[a] = c
			} else {
				var c = u[s];
				for (var m = s; m > (a + 1); m--) {
					u[m] = u[m - 1]
				}
				u[a + 1] = c
			}
			if (r) {
				u[a + (q ? 0 : 1)] = r[o]
			}
		}
	}
};
dhtmlXGridObject.prototype.moveColumn = function(a, c) {
	c--;
	a = parseInt(a);
	c = parseInt(c);
	if (c < a) {
		var g = c + 1
	} else {
		var g = c
	}
	if (!this.callEvent("onBeforeCMove", [a, g])) {
		return false
	}
	if (a == g) {
		return
	}
	this.editStop();
	this._processAllRows("_moveColInRow", a, c);
	this._processAllArrays(a, c);
	if (this.fldSorted) {
		this.setSortImgPos(this.fldSorted._cellIndex)
	}
	this.callEvent("onAfterCMove", [a, g])
};
dhtmlXGridObject.prototype._swapColumns = function(c) {
	var g = new Array();
	for (var a = 0; a < this._cCount; a++) {
		var l = c[this._c_order[a]];
		if (typeof(l) == "undefined") {
			l = ""
		}
		g[a] = l
	}
	return g
};
dhtmlXGridObject.prototype._moveColInRow = function(n, a, g) {
	var o = n.childNodes[a];
	var m = n.childNodes[g + 1];
	if (!o) {
		return
	}
	if (m) {
		n.insertBefore(o, m)
	} else {
		n.appendChild(o)
	}
	for (var l = 0; l < n.childNodes.length; l++) {
		n.childNodes[l]._cellIndex = n.childNodes[l]._cellIndexS = l
	}
};
dhtmlXGridObject.prototype._addColInRow = function(q, n, a, l) {
	var m = n;
	if (q._childIndexes) {
		if (q._childIndexes[n - 1] == q._childIndexes[n] || !q.childNodes[q._childIndexes[n - 1]]) {
			for (var g = q._childIndexes.length; g >= n; g--) {
				q._childIndexes[g] = g ? (q._childIndexes[g - 1] + 1) : 0
			}
			q._childIndexes[n]--
		} else {
			for (var g = q._childIndexes.length; g >= n; g--) {
				q._childIndexes[g] = g ? (q._childIndexes[g - 1] + 1) : 0
			}
		}
		var m = q._childIndexes[n]
	}
	var r = q.childNodes[m];
	var o = document.createElement((l) ? "TD" : "TH");
	if (l) {
		o._attrs = {}
	} else {
		o.style.width = (parseInt(this.cellWidthPX[n]) || "100") + "px"
	}
	if (r) {
		q.insertBefore(o, r)
	} else {
		q.appendChild(o)
	}
	if (this.dragAndDropOff && q.idd) {
		this.dragger.addDraggableItem(q.childNodes[m], this)
	}
	for (var g = m + 1; g < q.childNodes.length; g++) {
		q.childNodes[g]._cellIndex = q.childNodes[g]._cellIndexS = q.childNodes[g]._cellIndex + 1
	}
	if (q.childNodes[m]) {
		q.childNodes[m]._cellIndex = q.childNodes[m]._cellIndexS = n
	}
	if (q.idd || typeof(q.idd) != "undefined") {
		this.cells3(q, n).setValue("");
		o.align = this.cellAlign[n];
		o.style.verticalAlign = this.cellVAlign[n];
		o.bgColor = this.columnColor[n]
	} else {
		if (o.tagName == "TD") {
			if (!q.idd && this.forceDivInHeader) {
				o.innerHTML = "<div class='hdrcell'>&nbsp;</div>"
			} else {
				o.innerHTML = "&nbsp;"
			}
		}
	}
};
dhtmlXGridObject.prototype._deleteColInRow = function(q, o) {
	var g = o;
	if (q._childIndexes) {
		o = q._childIndexes[o]
	}
	var r = q.childNodes[o];
	if (!r) {
		return
	}
	if (r.colSpan && r.colSpan > 1 && r.parentNode.idd) {
		var m = r.colSpan - 1;
		var a = this.cells4(r).getValue();
		this.setColspan(r.parentNode.idd, r._cellIndex, 1);
		if (m > 1) {
			var n = r._cellIndex * 1;
			this.setColspan(r.parentNode.idd, n + 1, m);
			this.cells(r.parentNode.idd, r._cellIndex * 1 + 1).setValue(a);
			q._childIndexes.splice(n, 1);
			for (var l = n; l < q._childIndexes.length; l++) {
				q._childIndexes[l] -= 1
			}
		}
	} else {
		if (q._childIndexes) {
			q._childIndexes.splice(g, 1);
			for (var l = g; l < q._childIndexes.length; l++) {
				q._childIndexes[l]--
			}
		}
	}
	if (r) {
		q.removeChild(r)
	}
	for (var l = o; l < q.childNodes.length; l++) {
		q.childNodes[l]._cellIndex = q.childNodes[l]._cellIndexS = q.childNodes[l]._cellIndex - 1
	}
};
dhtmlXGridObject.prototype.enableColumnMove = function(c, a) {
	this._mCol = dhx4.s2b(c);
	if (typeof(a) != "undefined") {
		this._mCols = a.split(",")
	}
	if (!this._mmevTrue) {
		dhtmlxEvent(this.hdr, "mousedown", this._startColumnMove);
		dhtmlxEvent(document.body, "mousemove", this._onColumnMove);
		dhtmlxEvent(document.body, "mouseup", this._stopColumnMove);
		this._mmevTrue = true
	}
};
dhtmlXGridObject.prototype._startColumnMove = function(l) {
	l = l || event;
	var g = l.target || l.srcElement;
	var a = g;
	while (a.tagName != "TABLE") {
		a = a.parentNode
	}
	var c = a.grid;
	if (!c) {
		return
	}
	c.setActive();
	if (!c._mCol || l.button == 2) {
		return
	}
	g = c.getFirstParentOfType(g, "TD");
	if (g.style.cursor != "default") {
		return true
	}
	if ((c) && (!c._colInMove)) {
		c.resized = null;
		if ((!c._mCols) || (c._mCols[g._cellIndex] == "true")) {
			c._colInMove = g._cellIndex + 1
		}
	}
	return true
};
dhtmlXGridObject.prototype._onColumnMove = function(m) {
	m = m || event;
	var a = window.globalActiveDHTMLGridObject;
	if ((a) && (a._colInMove)) {
		if (a._hideHContext) {
			a._hideHContext()
		}
		if (typeof(a._colInMove) != "object") {
			var n = document.createElement("DIV");
			n._aIndex = (a._colInMove - 1);
			n._bIndex = null;
			n.innerHTML = a.getHeaderCol(n._aIndex);
			n.className = "dhx_dragColDiv";
			n.style.position = "absolute";
			document.body.appendChild(n);
			a._colInMove = n
		}
		var l = [];
		l[0] = (document.body.scrollLeft || document.documentElement.scrollLeft);
		l[1] = (document.body.scrollTop || document.documentElement.scrollTop);
		a._colInMove.style.left = m.clientX + l[0] + 8 + "px";
		a._colInMove.style.top = m.clientY + l[1] + 8 + "px";
		var c = m.target || m.srcElement;
		while ((c) && (typeof(c._cellIndexS) == "undefined")) {
			c = c.parentNode
		}
		if (a._colInMove._oldHe) {
			a._colInMove._oldHe.className = a._colInMove._oldHe.className.replace(/columnTarget(L|R)/g, "");
			a._colInMove._oldHe = null;
			a._colInMove._bIndex = null
		}
		if (c) {
			if (a.hdr.rows[1]._childIndexes) {
				var g = a.hdr.rows[1].cells[a.hdr.rows[1]._childIndexes[c._cellIndexS]]
			} else {
				var g = a.hdr.rows[1].cells[c._cellIndexS]
			}
			var n = m.clientX - (dhx4.absLeft(g) - a.hdrBox.scrollLeft);
			if (n / g.offsetWidth > 0.5) {
				g.className += " columnTargetR";
				a._colInMove._bIndex = c._cellIndexS
			} else {
				g.className += " columnTargetL";
				a._colInMove._bIndex = c._cellIndexS - 1
			}
			if (g.offsetLeft < (a.objBox.scrollLeft + 20)) {
				a.objBox.scrollLeft = Math.max(0, g.offsetLeft - 20)
			}
			if ((g.offsetLeft + g.offsetWidth - a.objBox.scrollLeft) > (a.objBox.offsetWidth - 20)) {
				a.objBox.scrollLeft = Math.min(a.objBox.scrollLeft + g.offsetWidth + 20, a.objBox.scrollWidth - a.objBox.offsetWidth)
			}
			a._colInMove._oldHe = g
		}
		m.cancelBubble = true;
		return false
	}
	return true
};
dhtmlXGridObject.prototype._stopColumnMove = function(c) {
	c = c || event;
	var a = window.globalActiveDHTMLGridObject;
	if ((a) && (a._colInMove)) {
		if (typeof(a._colInMove) == "object") {
			a._colInMove.parentNode.removeChild(a._colInMove);
			if (a._colInMove._bIndex != null) {
				a.moveColumn(a._colInMove._aIndex, a._colInMove._bIndex + 1)
			}
			if (a._colInMove._oldHe) {
				a._colInMove._oldHe.className = a._colInMove._oldHe.className.replace(/columnTarget(L|R)/g, "")
			}
			a._colInMove._oldHe = null;
			a._colInMove.grid = null;
			a.resized = true
		}
		a._colInMove = 0
	}
	return true
};
dhtmlXGridObject.prototype.mouseOverHeader = function(c) {
	var a = this;
	dhtmlxEvent(this.hdr, "mousemove", function(l) {
		l = l || window.event;
		var g = l.target || l.srcElement;
		if (g.tagName != "TD") {
			g = a.getFirstParentOfType(g, "TD")
		}
		if (g && (typeof(g._cellIndex) != "undefined")) {
			c(g.parentNode.rowIndex, g._cellIndex)
		}
	})
};
dhtmlXGridObject.prototype.mouseOver = function(c) {
	var a = this;
	dhtmlxEvent(this.obj, "mousemove", function(l) {
		l = l || window.event;
		var g = l.target || l.srcElement;
		if (g.tagName != "TD") {
			g = a.getFirstParentOfType(g, "TD")
		}
		if (g && (typeof(g._cellIndex) != "undefined")) {
			c(g.parentNode.rowIndex, g._cellIndex)
		}
	})
};
dhtmlXGridObject.prototype.enablePaging = function(n, l, c, m, a, g) {
	this._pgn_parentObj = typeof(m) == "string" ? document.getElementById(m) : m;
	this._pgn_recInfoParentObj = typeof(g) == "string" ? document.getElementById(g) : g;
	this.pagingOn = n;
	this.showRecInfo = a;
	this.rowsBufferOutSize = parseInt(l);
	this.currentPage = 1;
	this.pagesInGroup = parseInt(c);
	this._init_pgn_events();
	this.setPagingSkin("default")
};
dhtmlXGridObject.prototype.setXMLAutoLoading = function(a, c) {
	this.xmlFileUrl = a;
	this._dpref = c
};
dhtmlXGridObject.prototype.changePageRelative = function(a) {
	this.changePage(this.currentPage + a)
};
dhtmlXGridObject.prototype.changePage = function(a) {
	if (arguments.length == 0) {
		a = this.currentPage || 0
	}
	a = parseInt(a);
	a = Math.max(1, Math.min(a, Math.ceil(this.rowsBuffer.length / this.rowsBufferOutSize)));
	if (!this.callEvent("onBeforePageChanged", [this.currentPage, a])) {
		return
	}
	this.currentPage = parseInt(a);
	this._reset_view();
	this._fixAlterCss();
	this.callEvent("onPageChanged", this.getStateOfView())
};
dhtmlXGridObject.prototype.setPagingSkin = function(a) {
	this._pgn_skin = this["_pgn_" + a];
	if (a == "toolbar") {
		this._pgn_skin_tlb = arguments[1]
	}
};
dhtmlXGridObject.prototype.setPagingTemplates = function(g, c) {
	this._pgn_templateA = this._pgn_template_compile(g);
	this._pgn_templateB = this._pgn_template_compile(c);
	this._page_skin_update()
};
dhtmlXGridObject.prototype._page_skin_update = function(a) {
	if (!this.pagesInGroup) {
		this.pagesInGroup = Math.ceil(Math.min(5, this.rowsBuffer.length / this.rowsBufferOutSize))
	}
	var c = Math.ceil(this.rowsBuffer.length / this.rowsBufferOutSize);
	if (c && c < this.currentPage) {
		return this.changePage(c)
	}
	if (this.pagingOn && this._pgn_skin) {
		this._pgn_skin.apply(this, this.getStateOfView())
	}
};
dhtmlXGridObject.prototype._init_pgn_events = function(a) {
	this.attachEvent("onXLE", this._page_skin_update);
	this.attachEvent("onClearAll", this._page_skin_update);
	this.attachEvent("onPageChanged", this._page_skin_update);
	this.attachEvent("onGridReconstructed", this._page_skin_update);
	this._init_pgn_events = function() {}
};
dhtmlXGridObject.prototype._pgn_default = function(g, l, a) {
	if (!this.pagingBlock) {
		this.pagingBlock = document.createElement("DIV");
		this.pagingBlock.className = "pagingBlock";
		this.recordInfoBlock = document.createElement("SPAN");
		this.recordInfoBlock.className = "recordsInfoBlock";
		if (!this._pgn_parentObj) {
			return
		}
		this._pgn_parentObj.appendChild(this.pagingBlock);
		if (this._pgn_recInfoParentObj && this.showRecInfo) {
			this._pgn_recInfoParentObj.appendChild(this.recordInfoBlock)
		}
		if (!this._pgn_templateA) {
			this._pgn_templateA = this._pgn_template_compile("[prevpages:&lt;:&nbsp;] [currentpages:,&nbsp;] [nextpages:&gt;:&nbsp;]");
			this._pgn_templateB = this._pgn_template_compile("Results <b>[from]-[to]</b> of <b>[total]</b>")
		}
	}
	var c = this.getStateOfView();
	this.pagingBlock.innerHTML = this._pgn_templateA.apply(this, c);
	this.recordInfoBlock.innerHTML = this._pgn_templateB.apply(this, c);
	this._pgn_template_active(this.pagingBlock);
	this._pgn_template_active(this.recordInfoBlock);
	this.callEvent("onPaging", [])
};
dhtmlXGridObject.prototype._pgn_block = function(c) {
	var m = Math.floor((this.currentPage - 1) / this.pagesInGroup) * this.pagesInGroup;
	var a = Math.min(Math.ceil(this.rowsBuffer.length / this.rowsBufferOutSize), m + this.pagesInGroup);
	var l = [];
	for (var g = m + 1; g <= a; g++) {
		if (g == this.currentPage) {
			l.push("<a class='dhx_not_active'><b>" + g + "</b></a>")
		} else {
			l.push("<a onclick='this.grid.changePage(" + g + "); return false;'>" + g + "</a>")
		}
	}
	return l.join(c)
};
dhtmlXGridObject.prototype._pgn_link = function(l, c, g) {
	if (l == "prevpages" || l == "prev") {
		if (this.currentPage == 1) {
			return g
		}
		return "<a onclick='this.grid.changePageRelative(-1*" + (l == "prev" ? "1" : "this.grid.pagesInGroup") + "); return false;'>" + c + "</a>"
	}
	if (l == "nextpages" || l == "next") {
		if (this.rowsBuffer.length / this.rowsBufferOutSize <= this.currentPage) {
			return g
		}
		if (this.rowsBuffer.length / (this.rowsBufferOutSize * (l == "next" ? "1" : this.pagesInGroup)) <= 1) {
			return g
		}
		return "<a onclick='this.grid.changePageRelative(" + (l == "next" ? "1" : "this.grid.pagesInGroup") + "); return false;'>" + c + "</a>"
	}
	if (l == "current") {
		var a = this.currentPage + (c ? parseInt(c) : 0);
		if (a < 1 || Math.ceil(this.rowsBuffer.length / this.rowsBufferOutSize) < a) {
			return g
		}
		return "<a " + (a == this.currentPage ? "class='dhx_active_page_link' " : "") + "onclick='this.grid.changePage(" + a + "); return false;'>" + a + "</a>"
	}
	return c
};
dhtmlXGridObject.prototype._pgn_template_active = function(g) {
	var a = g.getElementsByTagName("A");
	if (a) {
		for (var c = 0; c < a.length; c++) {
			a[c].grid = this
		}
	}
};
dhtmlXGridObject.prototype._pgn_template_compile = function(a) {
	a = a.replace(/\[([^\]]*)\]/g, function(g, c) {
		c = c.split(":");
		switch (c[0]) {
			case "from":
				return '"+(arguments[1]*1+(arguments[2]*1?1:0))+"';
			case "total":
				return '"+arguments[3]+"';
			case "to":
				return '"+arguments[2]+"';
			case "current":
			case "prev":
			case "next":
			case "prevpages":
			case "nextpages":
				return "\"+this._pgn_link('" + c[0] + "','" + c[1] + "','" + c[2] + "')+\"";
			case "currentpages":
				return "\"+this._pgn_block('" + c[1] + "')+\""
		}
	});
	return new Function('return "' + a + '";')
};

//modify code by zzm 20160726
/*dhtmlXGridObject.prototype.i18n.paging = {
	results: "Results",
	records: "Records from ",
	to: " to ",
	page: "Page ",
	perpage: "rows per page",
	first: "To first Page",
	previous: "Previous Page",
	found: "Found records",
	next: "Next Page",
	last: "To last Page",
	of: " of ",
	notfound: "No Records Found"
};*/
dhtmlXGridObject.prototype.i18n.paging = {
		results: "结果集",
		records: "从 ",
		to: " 到 ",
		page: "页 ",
		perpage: "行",
		first: "第一页",
		previous: "前一页",
		found: "找到数据",
		next: "后一页",
		last: "最后页",
		of: " of ",
		notfound: "未找到数据"
	};



dhtmlXGridObject.prototype.setPagingWTMode = function(a, c, g, l,m) {
	//modify code by zzm 20161113 增加分页工具条模式，参数 m
	//m 为一个数组，定义图标按钮信息
	//m = ["<i class='fa fa-step-backward'></i>",
	//						"<i class='fa fa-backward'></i>",
	//						"<i class='fa fa-forward'></i>",
	//						"<i class='fa fa-fast-forward'></i>",
	//						"<div class='dhxtoolbar_text'><i class='fa fa-files-o'></i></div>",
	//						"<i class='fa  fa-caret-down'></i>",
	//						"<div class='dhxtoolbar_text'><i class='fa fa-file-text-o'></i></div>",
	//						"<i class='fa  fa-caret-down'></i>"]
	this._WTDef = [a, c, g, l,m]
};
dhtmlXGridObject.prototype._pgn_bricks = function(q, a, g) {
	var m = (this.skin_name || "").split("_")[1];
	var c = "";
	if (m == "light" || m == "modern" || m == "skyblue") {
		c = "_" + m
	}
	this.pagerElAr = new Array();
	this.pagerElAr.pagerCont = document.createElement("DIV");
	this.pagerElAr.pagerBord = document.createElement("DIV");
	this.pagerElAr.pagerLine = document.createElement("DIV");
	this.pagerElAr.pagerBox = document.createElement("DIV");
	this.pagerElAr.pagerInfo = document.createElement("DIV");
	this.pagerElAr.pagerInfoBox = document.createElement("DIV");
	var o = (this.globalBox || this.objBox);
	this.pagerElAr.pagerCont.style.width = o.clientWidth + "px";
	this.pagerElAr.pagerCont.style.overflow = "hidden";
	this.pagerElAr.pagerCont.style.clear = "both";
	this.pagerElAr.pagerBord.className = "dhx_pbox" + c;
	this.pagerElAr.pagerLine.className = "dhx_pline" + c;
	this.pagerElAr.pagerBox.style.clear = "both";
	this.pagerElAr.pagerInfo.className = "dhx_pager_info" + c;
	this.pagerElAr.pagerCont.appendChild(this.pagerElAr.pagerBord);
	this.pagerElAr.pagerCont.appendChild(this.pagerElAr.pagerLine);
	this.pagerElAr.pagerCont.appendChild(this.pagerElAr.pagerInfo);
	this.pagerElAr.pagerLine.appendChild(this.pagerElAr.pagerBox);
	this.pagerElAr.pagerInfo.appendChild(this.pagerElAr.pagerInfoBox);
	this._pgn_parentObj.innerHTML = "";
	this._pgn_parentObj.appendChild(this.pagerElAr.pagerCont);
	if (this.rowsBuffer.length > 0) {
		var n = 20;
		var v = 22;
		if (q > this.pagesInGroup) {
			var s = document.createElement("DIV");
			var r = document.createElement("DIV");
			s.className = "dhx_page" + c;
			r.innerHTML = "&larr;";
			s.appendChild(r);
			this.pagerElAr.pagerBox.appendChild(s);
			var u = this;
			s.pgnum = (Math.ceil(q / this.pagesInGroup) - 1) * this.pagesInGroup;
			s.onclick = function() {
				u.changePage(this.pgnum)
			};
			n += v
		}
		for (var l = 1; l <= this.pagesInGroup; l++) {
			var s = document.createElement("DIV");
			var r = document.createElement("DIV");
			s.className = "dhx_page" + c;
			pageNumber = ((Math.ceil(q / this.pagesInGroup) - 1) * this.pagesInGroup) + l;
			if (pageNumber > Math.ceil(this.rowsBuffer.length / this.rowsBufferOutSize)) {
				break
			}
			r.innerHTML = pageNumber;
			s.appendChild(r);
			if (q == pageNumber) {
				s.className += " dhx_page_active" + c;
				r.className = "dhx_page_active" + c
			} else {
				var u = this;
				s.pgnum = pageNumber;
				s.onclick = function() {
					u.changePage(this.pgnum)
				}
			}
			n += (parseInt(v / 3) * pageNumber.toString().length) + 15;
			r.style.width = (parseInt(v / 3) * pageNumber.toString().length) + 8 + "px";
			this.pagerElAr.pagerBox.appendChild(s)
		}
		if (Math.ceil(q / this.pagesInGroup) * this.pagesInGroup < Math.ceil(this.rowsBuffer.length / this.rowsBufferOutSize)) {
			var s = document.createElement("DIV");
			var r = document.createElement("DIV");
			s.className = "dhx_page" + c;
			r.innerHTML = "&rarr;";
			s.appendChild(r);
			this.pagerElAr.pagerBox.appendChild(s);
			var u = this;
			s.pgnum = (Math.ceil(q / this.pagesInGroup) * this.pagesInGroup) + 1;
			s.onclick = function() {
				u.changePage(this.pgnum)
			};
			n += v
		}
		this.pagerElAr.pagerLine.style.width = n + "px"
	}
	if (this.rowsBuffer.length > 0 && this.showRecInfo) {
		this.pagerElAr.pagerInfoBox.innerHTML = this.i18n.paging.records + (a + 1) + this.i18n.paging.to + g + this.i18n.paging.of + this.rowsBuffer.length
	} else {
		if (this.rowsBuffer.length == 0) {
			this.pagerElAr.pagerLine.parentNode.removeChild(this.pagerElAr.pagerLine);
			this.pagerElAr.pagerInfoBox.innerHTML = this.i18n.paging.notfound
		}
	}
	this.pagerElAr.pagerBox.appendChild(document.createElement("SPAN")).innerHTML = "&nbsp;";
	this.pagerElAr.pagerBord.appendChild(document.createElement("SPAN")).innerHTML = "&nbsp;";
	this.pagerElAr.pagerCont.appendChild(document.createElement("SPAN")).innerHTML = "&nbsp;";
	this.callEvent("onPaging", [])
};
dhtmlXGridObject.prototype._pgn_toolbar = function(n, o, c) {
	if (!this.aToolBar) {
		this.aToolBar = this._pgn_createToolBar()
	}
	var m = Math.ceil(this.rowsBuffer.length / this.rowsBufferOutSize);
	
	if (this._WTDef[0]) {
		this.aToolBar.enableItem("right");
		this.aToolBar.enableItem("rightabs");
		this.aToolBar.enableItem("left");
		this.aToolBar.enableItem("leftabs");
		if (this.currentPage >= m) {
			this.aToolBar.disableItem("right");
			this.aToolBar.disableItem("rightabs")
		}
		if (this.currentPage == 1) {
			this.aToolBar.disableItem("left");
			this.aToolBar.disableItem("leftabs")
		}
	}
	if (this._WTDef[2]) {
		var l = this;
		this.aToolBar.forEachListOption("pages", function(q) {
			l.aToolBar.removeListOption("pages", q)
		});
		var a = {
			dhx_skyblue: 4,
			dhx_web: 0,
			dhx_terrace: 14
		}[this.aToolBar.conf.skin];
		for (var g = 0; g < m; g++) {
			this.aToolBar.addListOption("pages", "pages_" + (g + 1), NaN, "button", "<span style='padding: 0px " + a + "px 0px 0px;'>" + this.i18n.paging.page + (g + 1) + "</span>", "paging_page.gif")
		}
		this.aToolBar.setItemText("pages", this.i18n.paging.page + n)
	}
	if (this._WTDef[1]) {
		if (!this.getRowsNum()) {
			this.aToolBar.setItemText("results", this.i18n.paging.notfound)
		} else {
			this.aToolBar.setItemText("results", "<div style='width:100%; text-align:center'>" + this.i18n.paging.records + (o + 1) + this.i18n.paging.to + c + "</div>")
		}
	}
	if (this._WTDef[3]) {
		this.aToolBar.setItemText("perpagenum", this.rowsBufferOutSize.toString() + " " + this.i18n.paging.perpage)
	}
	this.callEvent("onPaging", [])
};

//modify code by zzm 20161113
dhtmlXGridObject.prototype._pgn_createToolBar = function() {
	this.aToolBar = new dhtmlXToolbarObject({
		parent: this._pgn_parentObj,
		skin: (this._pgn_skin_tlb || this.skin_name),
		icons_path: this.imgURL
	});
	if (!this._WTDef) {
		this.setPagingWTMode(true, true, true, true)
	}
	
	
	var l = this;
	this.aToolBar.attachEvent("onClick", function(m) {
		m = m.split("_");
		switch (m[0]) {
			case "leftabs":
				l.changePage(1);
				break;
			case "left":
				l.changePage(l.currentPage - 1);
				break;
			case "rightabs":
				l.changePage(99999);
				break;
			case "right":
				l.changePage(l.currentPage + 1);
				break;
			case "perpagenum":
				if (m[1] === this.undefined) {
					return
				}
				l.rowsBufferOutSize = parseInt(m[1]);
				l.changePage();
				l.aToolBar.setItemText("perpagenum", m[1] + " " + l.i18n.paging.perpage);
				break;
			case "pages":
				if (m[1] === this.undefined) {
					return
				}
				l.changePage(m[1]);
				l.aToolBar.setItemText("pages", l.i18n.paging.page + m[1]);
				break
		}
	});
	
	//modify code by zzm 20161113 增加分页工具条模式
	//pagingimgmodels 为一个数组，定义图标按钮信息
	//pagingimgmodels = ["<i class='fa fa-step-backward'></i>",
	//						"<i class='fa fa-backward'></i>",
	//						"<i class='fa fa-forward'></i>",
	//						"<i class='fa fa-fast-forward'></i>",
	//						"<div class='dhxtoolbar_text'><i class='fa fa-files-o'></i></div>",
	//						"<i class='fa  fa-caret-down'></i>",
	//						"<div class='dhxtoolbar_text'><i class='fa fa-file-text-o'></i></div>",
	//						"<i class='fa  fa-caret-down'></i>"]
	var pagingimgmodels = this._WTDef[4];
	if(pagingimgmodels&& pagingimgmodels instanceof Array){
	}else{
		pagingimgmodels = null;
	}
	
	if (this._WTDef[0]) {
		
		if(pagingimgmodels!=null){
			this.aToolBar.addButton("leftabs", NaN, null, null, null,[pagingimgmodels[0]]);
			this.aToolBar.addButton("left", NaN, null, null, null,[pagingimgmodels[1]])
		}else{
			this.aToolBar.addButton("leftabs", NaN, null, "ar_left_abs.gif", "ar_left_abs_dis.gif");
			this.aToolBar.addButton("left", NaN, null, "ar_left.gif", "ar_left_dis.gif")	
		}
		
	}
	if (this._WTDef[1]) {
		this.aToolBar.addText("results", NaN, this.i18n.paging.results);
		this.aToolBar.setWidth("results", "150");
		this.aToolBar.disableItem("results")
	}
	if (this._WTDef[0]) {
		
		if(pagingimgmodels!=null){
			this.aToolBar.addButton("right", NaN, null, null,null,[pagingimgmodels[2]]);
			this.aToolBar.addButton("rightabs", NaN,null, null,null, [pagingimgmodels[3]])
		}else{	
			this.aToolBar.addButton("right", NaN, null, "ar_right.gif", "ar_right_dis.gif");
			this.aToolBar.addButton("rightabs", NaN, null, "ar_right_abs.gif", "ar_right_abs_dis.gif")
		}
	}
	if (this._WTDef[2]) {
		if (this.aToolBar.conf.skin == "dhx_terrace") {
			this.aToolBar.addSeparator()
		}
		
		//modify code by zzm 20161113
		if(pagingimgmodels!=null){
			this.aToolBar.addButtonSelect("pages", NaN, "select page", [], null, null, false, true,null,null,[pagingimgmodels[4],pagingimgmodels[5]])
		}else{
			this.aToolBar.addButtonSelect("pages", NaN, "select page", [], "paging_pages.gif", null, false, true)
		}
		
	}
	var a;
	if (a = this._WTDef[3]) {
		if (this.aToolBar.conf.skin == "dhx_terrace") {
			this.aToolBar.addSeparator()
		}
		
		//modify code by zzm 20161113
		if(pagingimgmodels!=null){
			this.aToolBar.addButtonSelect("perpagenum", NaN, "select size", [], null, null, false, true,null,null,[pagingimgmodels[6],pagingimgmodels[7]]);
		}else{
			this.aToolBar.addButtonSelect("perpagenum", NaN, "select size", [], "paging_rows.gif", null, false, true);
		}
		
		if (typeof a != "object") {
			a = [5, 10, 15, 20, 25, 30]
		}
		var c = {
			dhx_skyblue: 4,
			dhx_web: 0,
			dhx_terrace: 18
		}[this.aToolBar.conf.skin];
		for (var g = 0; g < a.length; g++) {
			this.aToolBar.addListOption("perpagenum", "perpagenum_" + a[g], NaN, "button", "<span style='padding: 0px " + c + "px 0px 0px;'>" + a[g] + " " + this.i18n.paging.perpage + "</span>", "paging_page.gif")
		}
	}
	return this.aToolBar
};
dhtmlXGridObject.prototype.post = function(a, c, l, g) {
	this.callEvent("onXLS", [this]);
	if (arguments.length == 2 && typeof l != "function") {
		g = l;
		l = null
	}
	g = g || "xml";
	if (!this.xmlFileUrl) {
		this.xmlFileUrl = a
	}
	this._data_type = g;
	this.xmlLoader = this.doLoadDetails;
	var m = this;
	this.xmlLoader = function(n) {
		if (!m.callEvent) {
			return
		}
		m["_process_" + g](n.xmlDoc);
		if (!m._contextCallTimer) {
			m.callEvent("onXLE", [m, 0, 0, n.xmlDoc])
		}
		if (l) {
			l();
			l = null
		}
	};
	dhx4.ajax.post(a, (c || ""), this.xmlLoader)
};
dhtmlXGridObject.prototype.setRowspan = function(u, w, m) {
	var v = this[this._bfs_cells ? "_bfs_cells" : "cells"](u, w).cell;
	var a = this.rowsAr[u];
	if (v.rowSpan && v.rowSpan != 1) {
		var n = a.nextSibling;
		for (var q = 1; q < v.rowSpan; q++) {
			var o = n.childNodes[n._childIndexes[v._cellIndex + 1]];
			var g = document.createElement("TD");
			g.innerHTML = "&nbsp;";
			g._cellIndex = v._cellIndex;
			g._clearCell = true;
			if (o) {
				o.parentNode.insertBefore(g, o)
			} else {
				n.parentNode.appendChild(g)
			}
			this._shiftIndexes(n, v._cellIndex, -1);
			n = n.nextSibling
		}
	}
	v.rowSpan = m;
	if (!this._h2) {
		a = a.nextSibling || this.rowsCol[this.rowsCol._dhx_find(a) + 1]
	} else {
		a = this.rowsAr[this._h2.get[a.idd].parent.childs[this._h2.get[a.idd].index + 1].id]
	}
	var l = [];
	for (var q = 1; q < m; q++) {
		var s = null;
		if (this._fake && !this._realfake) {
			s = this._bfs_cells3(a, w).cell
		} else {
			s = this.cells3(a, w).cell
		}
		this._shiftIndexes(a, v._cellIndex, 1);
		if (s) {
			s.parentNode.removeChild(s)
		}
		l.push(a);
		if (!this._h2) {
			a = a.nextSibling || this.rowsCol[this.rowsCol._dhx_find(a) + 1]
		} else {
			var a = this._h2.get[a.idd].parent.childs[this._h2.get[a.idd].index + 1];
			if (a) {
				a = this.rowsAr[a.id]
			}
		}
	}
	this.rowsAr[u]._rowSpan = this.rowsAr[u]._rowSpan || {};
	this.rowsAr[u]._rowSpan[w] = l;
	if (this._fake && !this._realfake && w < this._fake._cCount) {
		this._fake.setRowspan(u, w, m)
	}
};
dhtmlXGridObject.prototype._shiftIndexes = function(a, l, c) {
	if (!a._childIndexes) {
		a._childIndexes = new Array();
		for (var g = 0; g < a.childNodes.length; g++) {
			a._childIndexes[g] = g
		}
	}
	for (var g = 0; g < a._childIndexes.length; g++) {
		if (g > l) {
			a._childIndexes[g] = a._childIndexes[g] - c
		}
	}
};
dhtmlXGridObject.prototype.enableRowspan = function() {
	this._erspan = true;
	this.enableRowspan = function() {};
	this.attachEvent("onAfterSorting", function() {
		if (this._dload) {
			return
		}
		for (var m = 1; m < this.obj.rows.length; m++) {
			if (this.obj.rows[m]._rowSpan) {
				var a = this.obj.rows[m];
				for (var n in a._rowSpan) {
					var r = a;
					var c = r._rowSpan[n];
					for (var g = 0; g < c.length; g++) {
						if (r.nextSibling) {
							r.parentNode.insertBefore(c[g], r.nextSibling)
						} else {
							r.parentNode.appendChild(c[g])
						}
						if (this._fake) {
							var l = this._fake.rowsAr[r.idd];
							var o = this._fake.rowsAr[c[g].idd];
							if (l.nextSibling) {
								l.parentNode.insertBefore(o, l.nextSibling)
							} else {
								l.parentNode.appendChild(o)
							}
							this._correctRowHeight(r.idd)
						}
						r = r.nextSibling
					}
				}
			}
		}
		var q = this.rowsCol.stablesort;
		this.rowsCol = new dhtmlxArray();
		this.rowsCol.stablesort = q;
		for (var m = 1; m < this.obj.rows.length; m++) {
			this.rowsCol.push(this.obj.rows[m])
		}
	});
	this.attachEvent("onXLE", function(l, g, s, n) {
		for (var o = 0; o < this.rowsBuffer.length; o++) {
			var r = this.render_row(o);
			var q = r.childNodes;
			for (var m = 0; m < q.length; m++) {
				if (q[m]._attrs.rowspan) {
					this.setRowspan(r.idd, q[m]._cellIndex, q[m]._attrs.rowspan)
				}
			}
		}
	})
};
dhx4.attachEvent("onGridCreated", function(a) {
	if (a._split_later) {
		a.splitAt(a._split_later)
	}
});
dhtmlXGridObject.prototype.splitAt = function(o) {
	if (!this.obj.rows[0]) {
		return this._split_later = o
	}
	o = parseInt(o);
	var y = document.createElement("DIV");
	this.entBox.appendChild(y);
	var A = document.createElement("DIV");
	this.entBox.appendChild(A);
	for (var w = this.entBox.childNodes.length - 3; w >= 0; w--) {
		A.insertBefore(this.entBox.childNodes[w], A.firstChild)
	}
	this.entBox.style.position = "relative";
	this.globalBox = this.entBox;
	this.entBox = A;
	A.grid = this;
	y.style.cssText += "border:0px solid red !important;";
	A.style.cssText += "border:0px solid red !important;";
	A.style.top = "0px";
	A.style.position = "absolute";
	y.style.position = "absolute";
	y.style.top = "0px";
	y.style.left = "0px";
	y.style.zIndex = 11;
	A.style.height = y.style.height = this.globalBox.clientHeight;
	this._fake = new dhtmlXGridObject(y);
	this.globalBox = this._fake.globalBox = this.globalBox;
	this._fake._fake = this;
	this._fake._realfake = true;
	this._treeC = this.cellType._dhx_find("tree");
	this._fake.delim = this.delim;
	this._fake.customGroupFormat = this.customGroupFormat;
	this._fake.setImagesPath(this._imgURL);
	this._fake.iconURL = this.iconURL;
	this._fake._customSorts = this._customSorts;
	this._fake.noHeader = this.noHeader;
	this._fake._enbTts = this._enbTts;
	this._fake._drsclmW = this._drsclmW;
	this._fake._htkebl = this._htkebl;
	this._fake.clists = this.clists;
	this._fake.fldSort = new Array();
	this._fake.selMultiRows = this.selMultiRows;
	this._fake.multiLine = this.multiLine;
	this._fake.smartTabOrder = this.smartTabOrder;
	if (this.multiLine || this._erspan) {
		this.attachEvent("onCellChanged", this._correctRowHeight);
		this.attachEvent("onRowAdded", this._correctRowHeight);
		var c = function() {
			this.forEachRow(function(E) {
				this._correctRowHeight(E)
			})
		};
		this.attachEvent("onPageChanged", c);
		this.attachEvent("onXLE", c);
		this.attachEvent("onResizeEnd", c);
		if (!this._ads_count) {
			this.attachEvent("onAfterSorting", c)
		}
		if (this._srnd) {
			this.attachEvent("onFilterEnd", c)
		}
		this.attachEvent("onDistributedEnd", c)
	}
	this.attachEvent("onGridReconstructed", function() {
		this._fake.objBox.scrollTop = this.objBox.scrollTop
	});
	this._fake.loadedKidsHash = this.loadedKidsHash;
	if (this._h2) {
		this._fake._h2 = this._h2
	}
	this._fake._dInc = this._dInc;
	var q = [
		[],
		[],
		[],
		[],
		[],
		[],
		[]
	];
	var u = ["hdrLabels", "initCellWidth", "cellType", "cellAlign", "cellVAlign", "fldSort", "columnColor"];
	var m = ["setHeader", "setInitWidths", "setColTypes", "setColAlign", "setColVAlign", "setColSorting", "setColumnColor"];
	this._fake.callEvent = function() {
		var E = true;
		this._fake._split_event = true;
		var F = (arguments[0] == "onScroll");
		if (arguments[0] == "onGridReconstructed" || F) {
			this._fake.callEvent.apply(this, arguments)
		}
		if (!F) {
			E = this._fake.callEvent.apply(this._fake, arguments)
		}
		this._fake._split_event = false;
		return E
	};
	if (this._elmn) {
		this._fake.enableLightMouseNavigation(true)
	}
	if (this.__cssEven || this._cssUnEven) {
		this._fake.attachEvent("onGridReconstructed", function() {
			this._fixAlterCss()
		})
	}
	this._fake._cssEven = this._cssEven;
	this._fake._cssUnEven = this._cssUnEven;
	this._fake._cssSP = this._cssSP;
	this._fake.isEditable = this.isEditable;
	this._fake._edtc = this._edtc;
	if (this._sst) {
		this._fake.enableStableSorting(true)
	}
	this._fake._sclE = this._sclE;
	this._fake._dclE = this._dclE;
	this._fake._f2kE = this._f2kE;
	this._fake._maskArr = this._maskArr;
	this._fake._dtmask = this._dtmask;
	this._fake.combos = this.combos;
	var r = 0;
	var a = this.globalBox.offsetWidth;
	for (var w = 0; w < o; w++) {
		for (var v = 0; v < u.length; v++) {
			if (this[u[v]]) {
				q[v][w] = this[u[v]][w]
			}
			if (typeof q[v][w] == "string") {
				q[v][w] = q[v][w].replace(new RegExp("\\" + this.delim, "g"), "\\" + this.delim)
			}
		}
		if (_isFF) {
			q[1][w] = q[1][w] * 1
		}
		if (this.cellWidthType == "%") {
			q[1][w] = Math.round(parseInt(this[u[1]][w]) * a / 100);
			r += q[1][w]
		} else {
			r += parseInt(this[u[1]][w])
		}
		this.setColumnHidden(w, true)
	}
	for (var v = 0; v < u.length; v++) {
		var s = q[v].join(this.delim);
		if (m[v] != "setHeader") {
			if (s != "") {
				this._fake[m[v]](s)
			}
		} else {
			this._fake[m[v]](s, null, this._hstyles)
		}
	}
	this._fake._strangeParams = this._strangeParams;
	this._fake._drsclmn = this._drsclmn;
	r = Math.min(this.globalBox.offsetWidth, r);
	A.style.left = r + "px";
	y.style.width = r + "px";
	A.style.width = Math.max(this.globalBox.offsetWidth - r, 0);
	if (this._ecspn) {
		this._fake._ecspn = true
	}
	this._fake.init();
	if (this.dragAndDropOff) {
		this.dragger.addDragLanding(this._fake.entBox, this)
	}
	this._fake.objBox.style.overflow = "hidden";
	if (!dhtmlx.$customScroll) {
		this._fake.objBox.style.overflowX = "scroll"
	} else {
		this._fake.objBox._custom_scroll_mode = ""
	}
	this._fake._srdh = this._srdh || 20;
	this._fake._srnd = this._srnd;
	var C = this;

	function D(H) {
		var F = H.wheelDelta / -40;
		if (H.wheelDelta === window.undefined) {
			F = H.detail
		}
		var E = C.objBox;
		E.scrollTop += F * 40;
		if (H.preventDefault) {
			H.preventDefault()
		}
	}
	dhtmlxEvent(this._fake.objBox, "mousewheel", D);
	dhtmlxEvent(this._fake.objBox, "DOMMouseScroll", D);

	function l(F, E) {
		E.style.whiteSpace = "";
		var J = E.nextSibling;
		var H = E.parentNode;
		F.parentNode.insertBefore(E, F);
		if (!J) {
			H.appendChild(F)
		} else {
			H.insertBefore(F, J)
		}
		var I = F.style.display;
		F.style.display = E.style.display;
		E.style.display = I
	}

	function x(M, U, N, F) {
		var H = (new Array(o)).join(this.delim);
		var O = [];
		if (M == 2) {
			for (var K = 0; K < o; K++) {
				var E = U[M - 1].cells[U[M - 1]._childIndexes ? U[M - 1]._childIndexes[K] : K];
				if (E.rowSpan && E.rowSpan > 1) {
					O[E._cellIndex] = E.rowSpan - 1;
					F[M - 1].cells[F[M - 1]._childIndexes ? F[M - 1]._childIndexes[K] : K].rowSpan = E.rowSpan;
					E.rowSpan = 1
				}
			}
		}
		for (M; M < U.length; M++) {
			this._fake.attachHeader(H, null, N);
			F = F || this._fake.ftr.childNodes[0].rows;
			var S = o;
			var I = 0;
			for (var L = 0; L < S; L++) {
				if (O[L]) {
					O[L] = O[L] - 1;
					if (_isIE || _isOpera) {
						var J = document.createElement("TD");
						if (_isFF) {
							J.style.display = "none"
						}
						U[M].insertBefore(J, U[M].cells[0])
					}
					I++;
					continue
				}
				var Q = F[M].cells[L - I];
				var P = U[M].cells[L - (_isIE ? 0 : I)];
				var T = P.rowSpan;
				L += (P.colSpan - 1) || 0;
				l(Q, P);
				if (T > 1) {
					O[L] = T - 1;
					P.rowSpan = T
				}
				if (F[M].cells[L].colSpan > 1) {
					U[M].cells[L].colSpan = F[M].cells[L].colSpan;
					S -= F[M].cells[L].colSpan - 1;
					for (var K = 1; K < F[M].cells[L].colSpan; K++) {
						F[M].removeChild(F[M].cells[L + 1])
					}
				}
			}
		}
	}
	if (this.hdr.rows.length > 2) {
		x.call(this, 2, this.hdr.rows, "_aHead", this._fake.hdr.rows)
	}
	if (this.ftr) {
		x.call(this, 1, this.ftr.childNodes[0].rows, "_aFoot");
		this._fake.ftr.parentNode.style.bottom = (_isFF ? 2 : 1) + "px"
	}
	if (this.saveSizeToCookie) {
		this.saveSizeToCookie = function(F, E) {
			if (this._realfake) {
				return this._fake.saveSizeToCookie.apply(this._fake, arguments)
			}
			if (!F) {
				F = this.entBox.id
			}
			var I = new Array();
			var J = "cellWidthPX";
			for (var H = 0; H < this[J].length; H++) {
				if (H < o) {
					I[H] = this._fake[J][H]
				} else {
					I[H] = this[J][H]
				}
			}
			I = I.join(",");
			this.setCookie(F, E, 0, I);
			var I = (this.initCellWidth || (new Array)).join(",");
			this.setCookie(F, E, 1, I);
			return true
		};
		this.loadSizeFromCookie = function(E) {
			if (!E) {
				E = this.entBox.id
			}
			var J = this._getCookie(E, 1);
			if (!J) {
				return
			}
			this.initCellWidth = J.split(",");
			var J = this._getCookie(E, 0);
			var K = "cellWidthPX";
			this.cellWidthType = "px";
			var H = 0;
			if ((J) && (J.length)) {
				J = J.split(",");
				for (var F = 0; F < J.length; F++) {
					if (F < o) {
						this._fake[K][F] = J[F];
						H += J[F] * 1
					} else {
						this[K][F] = J[F]
					}
				}
			}
			this._fake.entBox.style.width = H + "px";
			this._fake.objBox.style.width = H + "px";
			var I = this.globalBox.childNodes[1];
			I.style.left = H - (_isFF ? 0 : 0) + "px";
			if (this.ftr) {
				this.ftr.style.left = H - (_isFF ? 0 : 0) + "px"
			}
			I.style.width = this.globalBox.offsetWidth - H + "px";
			this.setSizes();
			return true
		};
		this._fake.onRSE = this.onRSE
	}
	this.setCellTextStyleA = this.setCellTextStyle;
	this.setCellTextStyle = function(F, H, E) {
		if (H < o) {
			this._fake.setCellTextStyle(F, H, E)
		}
		this.setCellTextStyleA(F, H, E)
	};
	this.setRowTextBoldA = this.setRowTextBold;
	this.setRowTextBold = function(E) {
		this.setRowTextBoldA(E);
		this._fake.setRowTextBold(E)
	};
	this.setRowColorA = this.setRowColor;
	this.setRowColor = function(F, E) {
		this.setRowColorA(F, E);
		this._fake.setRowColor(F, E)
	};
	this.setRowHiddenA = this.setRowHidden;
	this.setRowHidden = function(F, E) {
		this.setRowHiddenA(F, E);
		this._fake.setRowHidden(F, E)
	};
	this.setRowTextNormalA = this.setRowTextNormal;
	this.setRowTextNormal = function(E) {
		this.setRowTextNormalA(E);
		this._fake.setRowTextNormal(E)
	};
	this.getChangedRows = function(H) {
		var E = new Array();

		function F(J) {
			for (var I = 0; I < J.childNodes.length; I++) {
				if (J.childNodes[I].wasChanged) {
					return E[E.length] = J.idd
				}
			}
		}
		this.forEachRow(function(K) {
			var J = this.rowsAr[K];
			var I = this._fake.rowsAr[K];
			if (J.tagName != "TR" || !I || I.tagName != "TR") {
				return
			}
			if (H && J._added) {
				E[E.length] = J.idd
			} else {
				if (!F(J)) {
					F(I)
				}
			}
		});
		return E.join(this.delim)
	};
	this.setRowTextStyleA = this.setRowTextStyle;
	this.setRowTextStyle = function(F, E) {
		this.setRowTextStyleA(F, E);
		if (this._fake.rowsAr[F]) {
			this._fake.setRowTextStyle(F, E)
		}
	};
	this.lockRowA = this.lockRow;
	this.lockRow = function(F, E) {
		this.lockRowA(F, E);
		this._fake.lockRow(F, E)
	};
	this.getColWidth = function(E) {
		if (E < o) {
			return parseInt(this._fake.cellWidthPX[E])
		} else {
			return parseInt(this.cellWidthPX[E])
		}
	};
	this.getColumnLabel = function(E) {
		return this._fake.getColumnLabel.apply(((E < o) ? this._fake : this), arguments)
	};
	this.setColWidthA = this._fake.setColWidthA = this.setColWidth;
	this.setColWidth = function(E, F) {
		E = E * 1;
		if (E < o) {
			this._fake.setColWidthA(E, F)
		} else {
			this.setColWidthA(E, F)
		}
		if ((E + 1) <= o) {
			this._fake._correctSplit(Math.min(this._fake.objBox.offsetWidth, this._fake.obj.offsetWidth))
		}
	};
	this.adjustColumnSizeA = this.adjustColumnSize;
	this.setColumnLabelA = this.setColumnLabel;
	this.setColumnLabel = function(F, E, J, I) {
		var H = this;
		if (F < o) {
			H = this._fake
		}
		return this.setColumnLabelA.apply(H, [F, E, J, I])
	};
	this.adjustColumnSize = function(E, F) {
		if (E < o) {
			if (_isIE) {
				this._fake.obj.style.tableLayout = ""
			}
			this._fake.adjustColumnSize(E, F);
			if (_isIE) {
				this._fake.obj.style.tableLayout = "fixed"
			}
			this._fake._correctSplit()
		} else {
			return this.adjustColumnSizeA(E, F)
		}
	};
	var g = "cells";
	this._bfs_cells = this[g];
	this[g] = function() {
		if (arguments[1] < o) {
			return this._fake.cells.apply(this._fake, arguments)
		} else {
			return this._bfs_cells.apply(this, arguments)
		}
	};
	this._bfs_isColumnHidden = this.isColumnHidden;
	this.isColumnHidden = function() {
		if (parseInt(arguments[0]) < o) {
			return this._fake.isColumnHidden.apply(this._fake, arguments)
		} else {
			return this._bfs_isColumnHidden.apply(this, arguments)
		}
	};
	this._bfs_setColumnHidden = this.setColumnHidden;
	this.setColumnHidden = function() {
		if (parseInt(arguments[0]) < o) {
			this._fake.setColumnHidden.apply(this._fake, arguments);
			return this._fake._correctSplit()
		} else {
			return this._bfs_setColumnHidden.apply(this, arguments)
		}
	};
	var g = "cells2";
	this._bfs_cells2 = this[g];
	this[g] = function() {
		if (arguments[1] < o) {
			return this._fake.cells2.apply(this._fake, arguments)
		} else {
			return this._bfs_cells2.apply(this, arguments)
		}
	};
	var g = "cells3";
	this._bfs_cells3 = this[g];
	this[g] = function(F, E) {
		if (arguments[1] < o && this._fake.rowsAr[arguments[0].idd]) {
			if (this._fake.rowsAr[F.idd] && this._fake.rowsAr[F.idd].childNodes.length == 0) {
				return this._bfs_cells3.apply(this, arguments)
			}
			arguments[0] = arguments[0].idd;
			return this._fake.cells.apply(this._fake, arguments)
		} else {
			return this._bfs_cells3.apply(this, arguments)
		}
	};
	var g = "changeRowId";
	this._bfs_changeRowId = this[g];
	this[g] = function() {
		this._bfs_changeRowId.apply(this, arguments);
		if (this._fake.rowsAr[arguments[0]]) {
			this._fake.changeRowId.apply(this._fake, arguments)
		}
	};
	this._fake.getRowById = function(H) {
		var F = this.rowsAr[H];
		if (!F && this._fake.rowsAr[H]) {
			F = this._fake.getRowById(H)
		}
		if (F) {
			if (F.tagName != "TR") {
				for (var E = 0; E < this.rowsBuffer.length; E++) {
					if (this.rowsBuffer[E] && this.rowsBuffer[E].idd == H) {
						return this.render_row(E)
					}
				}
				if (this._h2) {
					return this.render_row(null, F.idd)
				}
			}
			return F
		}
		return null
	};
	if (this.collapseKids) {
		this._fake._bfs_collapseKids = this.collapseKids;
		this._fake.collapseKids = function() {
			return this._fake.collapseKids.apply(this._fake, [this._fake.rowsAr[arguments[0].idd]])
		};
		this["_bfs_collapseKids"] = this.collapseKids;
		this["collapseKids"] = function() {
			var E = this["_bfs_collapseKids"].apply(this, arguments);
			this._fake._h2syncModel();
			if (!this._cssSP) {
				this._fake._fixAlterCss()
			}
		};
		this._fake._bfs_expandKids = this.expandKids;
		this._fake.expandKids = function() {
			this._fake.expandKids.apply(this._fake, [this._fake.rowsAr[arguments[0].idd]]);
			if (!this._cssSP) {
				this._fake._fixAlterCss()
			}
		};
		this["_bfs_expandAll"] = this.expandAll;
		this["expandAll"] = function() {
			this._bfs_expandAll();
			this._fake._h2syncModel();
			if (!this._cssSP) {
				this._fake._fixAlterCss()
			}
		};
		this["_bfs_collapseAll"] = this.collapseAll;
		this["collapseAll"] = function() {
			this._bfs_collapseAll();
			this._fake._h2syncModel();
			if (!this._cssSP) {
				this._fake._fixAlterCss()
			}
		};
		this["_bfs_expandKids"] = this.expandKids;
		this["expandKids"] = function() {
			var E = this["_bfs_expandKids"].apply(this, arguments);
			this._fake._h2syncModel();
			if (!this._cssSP) {
				this._fake._fixAlterCss()
			}
		};
		this._fake._h2syncModel = function() {
			if (this._fake.pagingOn) {
				this._fake._renderSort()
			} else {
				this._renderSort()
			}
		};
		this._updateTGRState = function(E) {
			return this._fake._updateTGRState(E)
		}
	}
	if (this._elmnh) {
		this._setRowHoverA = this._fake._setRowHoverA = this._setRowHover;
		this._unsetRowHoverA = this._fake._unsetRowHoverA = this._unsetRowHover;
		this._setRowHover = this._fake._setRowHover = function() {
			var E = this.grid;
			E._setRowHoverA.apply(this, arguments);
			var F = (_isIE ? event.srcElement : arguments[0].target);
			F = E._fake.rowsAr[E.getFirstParentOfType(F, "TD").parentNode.idd];
			if (F) {
				E._fake._setRowHoverA.apply(E._fake.obj, [{
					target: F.childNodes[0]
				}, arguments[1]])
			}
		};
		this._unsetRowHover = this._fake._unsetRowHover = function() {
			if (arguments[1]) {
				var E = this
			} else {
				var E = this.grid
			}
			E._unsetRowHoverA.apply(this, arguments);
			E._fake._unsetRowHoverA.apply(E._fake.obj, arguments)
		};
		this._fake.enableRowsHover(true, this._hvrCss);
		this.enableRowsHover(false);
		this.enableRowsHover(true, this._fake._hvrCss)
	}
	this._updateTGRState = function(E) {
		if (!E.update || E.id == 0) {
			return
		}
		if (this.rowsAr[E.id].imgTag) {
			this.rowsAr[E.id].imgTag.src = this.iconTree + E.state + ".gif"
		}
		if (this._fake.rowsAr[E.id] && this._fake.rowsAr[E.id].imgTag) {
			this._fake.rowsAr[E.id].imgTag.src = this.iconTree + E.state + ".gif"
		}
		E.update = false
	};
	this.copy_row = function(J) {
		var E = J.cloneNode(true);
		E._skipInsert = J._skipInsert;
		var K = o;
		E._attrs = {};
		E._css = J._css;
		if (this._ecspn) {
			K = 0;
			for (var I = 0;
				(K < E.childNodes.length && I < o); I += (E.childNodes[K].colSpan || 1)) {
				K++
			}
		}
		while (E.childNodes.length > K) {
			E.removeChild(E.childNodes[E.childNodes.length - 1])
		}
		var H = K;
		for (var I = 0; I < H; I++) {
			if (this.dragAndDropOff) {
				this.dragger.addDraggableItem(E.childNodes[I], this)
			}
			E.childNodes[I].style.display = (this._fake._hrrar ? (this._fake._hrrar[I] ? "none" : "") : "");
			E.childNodes[I]._cellIndex = I;
			E.childNodes[I].combo_value = arguments[0].childNodes[I].combo_value;
			E.childNodes[I]._clearCell = arguments[0].childNodes[I]._clearCell;
			E.childNodes[I]._cellType = arguments[0].childNodes[I]._cellType;
			E.childNodes[I]._brval = arguments[0].childNodes[I]._brval;
			E.childNodes[I].val = arguments[0].childNodes[I].val;
			E.childNodes[I]._combo = arguments[0].childNodes[I]._combo;
			E.childNodes[I]._attrs = arguments[0].childNodes[I]._attrs;
			E.childNodes[I].chstate = arguments[0].childNodes[I].chstate;
			if (J._attrs.style) {
				E.childNodes[I].style.cssText += ";" + J._attrs.style
			}
			if (E.childNodes[I].colSpan > 1) {
				this._childIndexes = this._fake._childIndexes
			}
		}
		if (this._h2 && this._treeC < o) {
			var F = this._h2.get[arguments[0].idd];
			E.imgTag = E.childNodes[this._treeC].childNodes[0].childNodes[F.level];
			E.valTag = E.childNodes[this._treeC].childNodes[0].childNodes[F.level + 2]
		}
		E.idd = J.idd;
		E.grid = this._fake;
		return E
	};
	var g = "_insertRowAt";
	this._bfs_insertRowAt = this[g];
	this[g] = function() {
		var F = this["_bfs_insertRowAt"].apply(this, arguments);
		arguments[0] = this.copy_row(arguments[0]);
		var E = this._fake._insertRowAt.apply(this._fake, arguments);
		if (F._fhd) {
			E.parentNode.removeChild(E);
			this._fake.rowsCol._dhx_removeAt(this._fake.rowsCol._dhx_find(E));
			F._fhd = false
		}
		return F
	};
	this._bfs_setSizes = this.setSizes;
	this.setSizes = function() {
		if (this._notresize) {
			return
		}
		this._bfs_setSizes(this, arguments);
		this.sync_headers();
		if (this.sync_scroll() && this._ahgr) {
			this.setSizes()
		}
		var E = this.dontSetSizes ? (this.entBox.offsetHeight + "px") : this.entBox.style.height;
		this._fake.entBox.style.height = E;
		this._fake.objBox.style.height = this.objBox.style.height;
		this._fake.hdrBox.style.height = this.hdrBox.style.height;
		this._fake.objBox.scrollTop = this.objBox.scrollTop;
		this._fake.setColumnSizes(this._fake.entBox.clientWidth);
		this.globalBox.style.width = parseInt(this.entBox.style.width) + parseInt(this._fake.entBox.style.width);
		if (!this.dontSetSizes) {
			this.globalBox.style.height = E
		}
	};
	this.sync_scroll = this._fake.sync_scroll = function(F) {
		var E = this.objBox.style.overflowX;
		if (this.obj.offsetWidth <= this.objBox.offsetWidth) {
			if (!F) {
				return this._fake.sync_scroll(true)
			}
			this.objBox.style.overflowX = "hidden";
			this._fake.objBox.style.overflowX = "hidden"
		} else {
			if (!dhtmlx.$customScroll) {
				this.objBox.style.overflowX = "scroll";
				this._fake.objBox.style.overflowX = "scroll"
			}
		}
		return E != this.objBox.style.overflowX
	};
	this.sync_headers = this._fake.sync_headers = function() {
		if (this.noHeader || (this._fake.hdr.scrollHeight == this.hdr.offsetHeight)) {
			return
		}
		for (var F = 1; F < this.hdr.rows.length; F++) {
			var J = o;
			while (!this.hdr.rows[F].childNodes[J]) {
				J--
			}
			var E = Math.min(this.hdr.rows[F].childNodes[J].scrollHeight + 2, this.hdr.rows[F].scrollHeight);
			var I = this._fake.hdr.rows[F].scrollHeight;
			if (E != I) {
				this._fake.hdr.rows[F].style.height = this.hdr.rows[F].style.height = Math.max(E, I) + "px"
			}
			if (window._KHTMLrv) {
				var H = 0;
				while (this._fake._hrrar[H]) {
					H++
				}
				this._fake.hdr.rows[F].childNodes[H].style.height = this.hdr.rows[F].childNodes[J].style.height = Math.max(E, I) + "px"
			}
		}
		this._fake.sync_headers
	};
	this._fake._bfs_setSizes = this._fake.setSizes;
	this._fake.setSizes = function() {
		if (this._fake._notresize) {
			return
		}
		this._fake.setSizes()
	};
	var g = "_doOnScroll";
	this._bfs__doOnScroll = this[g];
	this[g] = function() {
		this._bfs__doOnScroll.apply(this, arguments);
		this._fake.objBox.scrollTop = this.objBox.scrollTop = this.objBox.scrollTop + 0.1;
		this._fake._doOnScroll.apply(this._fake, arguments)
	};
	var g = "selectAll";
	this._bfs__selectAll = this[g];
	this[g] = function() {
		this._bfs__selectAll.apply(this, arguments);
		this._bfs__selectAll.apply(this._fake, arguments)
	};
	var g = "doClick";
	this._bfs_doClick = this[g];
	this[g] = function() {
		this["_bfs_doClick"].apply(this, arguments);
		if (arguments[0].tagName == "TD") {
			var E = (arguments[0]._cellIndex >= o);
			if (!arguments[0].parentNode.idd) {
				return
			}
			if (!E) {
				arguments[0].className = arguments[0].className.replace(/cellselected/g, "")
			}
			if (!this._fake.rowsAr[arguments[0].parentNode.idd]) {
				this._fake.render_row(this.getRowIndex(arguments[0].parentNode.idd))
			}
			arguments[0] = this._fake.cells(arguments[0].parentNode.idd, (E ? 0 : arguments[0]._cellIndex)).cell;
			if (E) {
				this._fake.cell = null
			}
			this._fake._bfs_doClick.apply(this._fake, arguments);
			if (E) {
				this._fake.cell = this.cell
			} else {
				this.cell = this._fake.cell
			}
			if (this._fake.onRowSelectTime) {
				clearTimeout(this._fake.onRowSelectTime)
			}
			if (E) {
				arguments[0].className = arguments[0].className.replace(/cellselected/g, "");
				globalActiveDHTMLGridObject = this;
				this._fake.cell = this.cell
			} else {
				this.objBox.scrollTop = this._fake.objBox.scrollTop
			}
		}
	};
	this._fake._bfs_doClick = this._fake[g];
	this._fake[g] = function() {
		this["_bfs_doClick"].apply(this, arguments);
		if (arguments[0].tagName == "TD") {
			var E = (arguments[0]._cellIndex < o);
			if (!arguments[0].parentNode.idd) {
				return
			}
			arguments[0] = this._fake._bfs_cells(arguments[0].parentNode.idd, (E ? o : arguments[0]._cellIndex)).cell;
			this._fake.cell = null;
			this._fake._bfs_doClick.apply(this._fake, arguments);
			this._fake.cell = this.cell;
			if (this._fake.onRowSelectTime) {
				clearTimeout(this._fake.onRowSelectTime)
			}
			if (E) {
				arguments[0].className = arguments[0].className.replace(/cellselected/g, "");
				globalActiveDHTMLGridObject = this;
				this._fake.cell = this.cell;
				this._fake.objBox.scrollTop = this.objBox.scrollTop
			}
		}
	};
	this.clearSelectionA = this.clearSelection;
	this.clearSelection = function(E) {
		if (E) {
			this._fake.clearSelection()
		}
		this.clearSelectionA()
	};
	this.moveRowUpA = this.moveRowUp;
	this.moveRowUp = function(E) {
		if (!this._h2) {
			this._fake.moveRowUp(E)
		}
		this.moveRowUpA(E);
		if (this._h2) {
			this._fake._h2syncModel()
		}
	};
	this.moveRowDownA = this.moveRowDown;
	this.moveRowDown = function(E) {
		if (!this._h2) {
			this._fake.moveRowDown(E)
		}
		this.moveRowDownA(E);
		if (this._h2) {
			this._fake._h2syncModel()
		}
	};
	this._fake.getUserData = function() {
		return this._fake.getUserData.apply(this._fake, arguments)
	};
	this._fake.setUserData = function() {
		return this._fake.setUserData.apply(this._fake, arguments)
	};
	this.getSortingStateA = this.getSortingState;
	this.getSortingState = function() {
		var E = this.getSortingStateA();
		if (E.length != 0) {
			return E
		}
		return this._fake.getSortingState()
	};
	this.setSortImgStateA = this._fake.setSortImgStateA = this.setSortImgState;
	this.setSortImgState = function(F, E, I, H) {
		this.setSortImgStateA(F, E, I, H);
		if (E * 1 < o) {
			this._fake.setSortImgStateA(F, E, I, H);
			this.setSortImgStateA(false)
		} else {
			this._fake.setSortImgStateA(false)
		}
	};
	this._fake.doColResizeA = this._fake.doColResize;
	this._fake.doColResize = function(J, I, H, E, L) {
		var F = -1;
		var K = 0;
		if (arguments[1]._cellIndex == (o - 1)) {
			F = this._initalSplR + (J.clientX - E);
			if (!this._initalSplF) {
				this._initalSplF = arguments[3] + this.objBox.scrollWidth - this.objBox.offsetWidth
			}
			if (this.objBox.scrollWidth == this.objBox.offsetWidth && (this._fake.alter_split_resize || (J.clientX - E) > 0)) {
				arguments[3] = (this._initalSplF || arguments[3]);
				K = this.doColResizeA.apply(this, arguments)
			} else {
				K = this.doColResizeA.apply(this, arguments)
			}
		} else {
			if (this.obj.offsetWidth < this.entBox.offsetWidth) {
				F = this.obj.offsetWidth
			}
			K = this.doColResizeA.apply(this, arguments)
		}
		if (K !== false) {
			this._correctSplit(F);
			this.resized = this._fake.resized = 1
		}
		return K
	};
	this._fake.changeCursorState = function(H) {
		var F = H.target || H.srcElement;
		if (F.tagName != "TD") {
			F = this.getFirstParentOfType(F, "TD")
		}
		if ((F.tagName == "TD") && (this._drsclmn) && (!this._drsclmn[F._cellIndex])) {
			return
		}
		var E = (H.layerX || 0) + (((!_isIE) && (H.target.tagName == "DIV")) ? F.offsetLeft : 0);
		var I = parseInt(this.getPosition(F, this.hdrBox));
		if (((F.offsetWidth - (H.offsetX || (I - E) * -1)) < (_isOpera ? 20 : 10)) || ((this.entBox.offsetWidth - (H.offsetX ? (H.offsetX + F.offsetLeft) : E) + this.objBox.scrollLeft - 0) < (_isOpera ? 20 : 10))) {
			F.style.cursor = "E-resize"
		} else {
			F.style.cursor = "default"
		}
		if (_isOpera) {
			this.hdrBox.scrollLeft = this.objBox.scrollLeft
		}
	};
	this._fake.startColResizeA = this._fake.startColResize;
	this._fake.startColResize = function(F) {
		var H = this.startColResizeA(F);
		this._initalSplR = this.entBox.offsetWidth;
		this._initalSplF = null;
		if (this.entBox.onmousemove) {
			var E = this.entBox.parentNode;
			if (E._aggrid) {
				return H
			}
			E._aggrid = E.grid;
			E.grid = this;
			this.entBox.parentNode.onmousemove = this.entBox.onmousemove;
			this.entBox.onmousemove = null
		}
		return H
	};
	this._fake.stopColResizeA = this._fake.stopColResize;
	this._fake.stopColResize = function(F) {
		if (this.entBox.parentNode.onmousemove) {
			var E = this.entBox.parentNode;
			E.grid = E._aggrid;
			E._aggrid = null;
			this.entBox.onmousemove = this.entBox.parentNode.onmousemove;
			this.entBox.parentNode.onmousemove = null;
			if (this.obj.offsetWidth < this.entBox.offsetWidth) {
				this._correctSplit(this.obj.offsetWidth)
			}
		}
		return this.stopColResizeA(F)
	};
	this.doKeyA = this.doKey;
	this._fake.doKeyA = this._fake.doKey;

	function n(I, F, M, L) {
		var H = L.shiftKey ? -1 : 1;
		var E = L.shiftKey ? -1 : M._cCount;
		var K = false;
		for (var J = I + H; J != E; J += H) {
			if (M.smartTabOrder) {
				K = M.cells2(F, J).isDisabled() ? false : J
			} else {
				K = J
			}
			if (K !== false) {
				M.selectCell(F, K, false, false, true, true);
				L.cancelBubble = true;
				if (L.preventDefault) {
					L.preventDefault()
				}
				return true
			}
		}
	}
	this._fake.doKey = this.doKey = function(J) {
		if (!J) {
			return true
		}
		if (this._htkebl) {
			return true
		}
		if ((J.target || J.srcElement).value !== window.undefined) {
			var F = (J.target || J.srcElement);
			if ((!F.parentNode) || (F.parentNode.className.indexOf("editable") == -1)) {
				return true
			}
		}
		switch (J.keyCode) {
			case 9:
				var I = this._realfake ? this._fake : this;
				if (!I.callEvent("onTab", [true])) {
					return true
				}
				if (this.cell) {
					var H = this.cell._cellIndex;
					var E = I.getRowIndex(this.cell.parentNode.idd);
					while (!n(H, E, I, J)) {
						E += (J.shiftKey ? -1 : 1);
						if (E < 0 || E >= I.rowsBuffer.length) {
							return
						}
						H = J.shiftKey ? I._cCount : -1
					}
					return
				}
				break
		}
		return this.doKeyA(J)
	};
	this.editCellA = this.editCell;
	this.editCell = function() {
		if (this.cell && this.cell.parentNode.grid != this) {
			return this._fake.editCell()
		}
		return this.editCellA()
	};
	this.deleteRowA = this.deleteRow;
	this.deleteRow = function(E, F) {
		if (this.deleteRowA(E, F) === false) {
			return false
		}
		if (this._fake.rowsAr[E]) {
			this._fake.deleteRow(E)
		}
	};
	this.clearAllA = this.clearAll;
	this.clearAll = function() {
		this.clearAllA();
		this._fake.clearAll()
	};
	this.editStopA = this.editStop;
	this.editStop = function(E) {
		if (this._fake.editor) {
			this._fake.editStop(E)
		} else {
			this.editStopA(E)
		}
	};
	this.attachEvent("onAfterSorting", function(F, E, H) {
		if (F >= o) {
			this._fake.setSortImgState(false)
		}
	});
	this._fake.sortField = function(F, E, I) {
		this._fake.sortField.call(this._fake, F, E, this._fake.hdr.rows[0].cells[F]);
		if (this.fldSort[F] != "na" && this._fake.fldSorted) {
			var H = this._fake.getSortingState()[1];
			this._fake.setSortImgState(false);
			this.setSortImgState(true, arguments[0], H)
		}
	};
	this.sortTreeRowsA = this.sortTreeRows;
	this._fake.sortTreeRowsA = this._fake.sortTreeRows;
	this.sortTreeRows = this._fake.sortTreeRows = function(H, I, E, F) {
		if (this._realfake) {
			return this._fake.sortTreeRows(H, I, E, F)
		}
		this.sortTreeRowsA(H, I, E, F);
		this._fake._h2syncModel();
		this._fake.setSortImgStateA(false);
		this._fake.fldSorted = null
	};
	this._fake._fillers = [];
	this._fake.rowsBuffer = this.rowsBuffer;
	this.attachEvent("onClearAll", function() {
		this._fake.rowsBuffer = this.rowsBuffer
	});
	this._add_filler_s = this._add_filler;
	this._add_filler = function(F, E, J, H) {
		if (!this._fake._fillers) {
			this._fake._fillers = []
		}
		if (this._realfake || !H) {
			var I;
			if (J && J.idd) {
				I = this._fake.rowsAr[J.idd]
			} else {
				if (J && J.nextSibling) {
					I = {};
					I.nextSibling = this._fake.rowsAr[J.nextSibling.idd];
					I.parentNode = I.nextSibling.parentNode
				} else {
					if (this._fake._fillers.length) {
						I = this._fake._fillers[this._fake._fillers.length - 1][2]
					}
				}
			}
			this._fake._fillers.push(this._fake._add_filler(F, E, I))
		}
		return this._add_filler_s.apply(this, arguments)
	};
	this._add_from_buffer_s = this._add_from_buffer;
	this._add_from_buffer = function() {
		var E = this._add_from_buffer_s.apply(this, arguments);
		if (E != -1) {
			this._fake._add_from_buffer.apply(this._fake, arguments);
			if (this.multiLine) {
				this._correctRowHeight(this.rowsBuffer[arguments[0]].idd)
			}
		}
		return E
	};
	this._fake.render_row = function(E) {
		var F = this._fake.render_row(E);
		if (F == -1) {
			return -1
		}
		if (F) {
			return this.rowsAr[F.idd] = this.rowsAr[F.idd] || this._fake.copy_row(F)
		}
		return null
	};
	this._reset_view_s = this._reset_view;
	this._reset_view = function() {
		this._fake._reset_view(true);
		this._fake._fillers = [];
		this._reset_view_s()
	};
	this.moveColumn_s = this.moveColumn;
	this.moveColumn = function(F, E) {
		if (E >= o) {
			return this.moveColumn_s(F, E)
		}
	};
	this.attachEvent("onCellChanged", function(J, H, I) {
		if (this._split_event && H < o && this.rowsAr[J]) {
			var E = this._fake.rowsAr[J];
			if (!E) {
				return
			}
			if (E._childIndexes) {
				E = E.childNodes[E._childIndexes[H]]
			} else {
				E = E.childNodes[H]
			}
			var F = this.rowsAr[J].childNodes[H];
			if (F._treeCell && F.firstChild.lastChild) {
				F.firstChild.lastChild.innerHTML = I
			} else {
				F.innerHTML = E.innerHTML
			}
			F._clearCell = false;
			F.combo_value = E.combo_value;
			F.chstate = E.chstate
		}
	});
	this._fake.combos = this.combos;
	this.setSizes();
	if (this.rowsBuffer[0]) {
		this._reset_view()
	}
	this.attachEvent("onXLE", function() {
		this._fake._correctSplit()
	});
	this._fake._correctSplit()
};
dhtmlXGridObject.prototype._correctSplit = function(c) {
	c = c || (this.obj.scrollWidth - this.objBox.scrollLeft);
	c = Math.min(this.globalBox.offsetWidth, c);
	if (c > -1) {
		this.entBox.style.width = c + "px";
		this.objBox.style.width = c + "px";
		var l = (this.globalBox.offsetWidth - this.globalBox.clientWidth) / 2;
		this._fake.entBox.style.left = c + "px";
		this._fake.entBox.style.width = Math.max(0, this.globalBox.offsetWidth - c - (this.quirks ? 0 : 2) * l) + "px";
		if (this._fake.ftr) {
			this._fake.ftr.parentNode.style.width = this._fake.entBox.style.width
		}
		if (_isIE) {
			var g = _isIE && !window.xmlHttpRequest;
			var l = (this.globalBox.offsetWidth - this.globalBox.clientWidth);
			this._fake.hdrBox.style.width = this._fake.objBox.style.width = Math.max(0, this.globalBox.offsetWidth - (g ? l : 0) - c) + "px"
		}
	}
};
dhtmlXGridObject.prototype._correctRowHeight = function(q, n) {
	if (!this.rowsAr[q] || !this._fake.rowsAr[q]) {
		return
	}
	var m = this.rowsAr[q].offsetHeight;
	var g = this._fake.rowsAr[q].offsetHeight;
	var a = Math.max(m, g) - (this.rowsAr[q].delta_fix || 0);
	if (!a) {
		return
	}
	this.rowsAr[q].style.height = this._fake.rowsAr[q].style.height = Math.round(a + 1) + "px";
	this.rowsAr[q].delta_fix = 1;
	if (window._KHTMLrv) {
		var c = this._fake._cCount;
		var o;
		while (!o && c >= 0) {
			o = this.rowsAr[q].childNodes[c];
			c -= 1
		}
		var l = this._fake.rowsAr[q].firstChild;
		if (o && l) {
			o.style.height = l.style.height = a + "px";
			o.style.boxSizing = l.style.boxSizing = "border-box"
		}
	}
};
dhtmlXGridObject.prototype.enableAutoSizeSaving = function(c, a) {
	this.attachEvent("onResizeEnd", function() {
		this.saveSizeToCookie(c, a)
	})
};
dhtmlXGridObject.prototype.saveOpenStates = function(c, a) {
	if (!c) {
		c = this.entBox.id
	}
	var g = [];
	this._h2.forEachChild(0, function(m) {
		if (m.state == "minus") {
			g.push(m.id)
		}
	});
	var l = "gridOpen" + (c || "") + "=" + g.join("|") + (a ? ("; " + a) : "");
	document.cookie = l
};
dhtmlXGridObject.prototype.loadOpenStates = function(g, a) {
	var m = this.getCookie(g, "gridOpen");
	if (!m) {
		return
	}
	m = m.split("|");
	for (var l = 0; l < m.length; l++) {
		var c = this.getParentId(m[l]);
		if (!this.getOpenState(c)) {
			continue
		}
		this.openItem(m[l])
	}
};
dhtmlXGridObject.prototype.enableAutoHiddenColumnsSaving = function(c, a) {
	this.attachEvent("onColumnHidden", function() {
		this.saveHiddenColumnsToCookie(c, a)
	})
};
dhtmlXGridObject.prototype.enableSortingSaving = function(c, a) {
	this.attachEvent("onBeforeSorting", function() {
		var g = this;
		window.setTimeout(function() {
			g.saveSortingToCookie(c, a)
		}, 1);
		return true
	})
};
dhtmlXGridObject.prototype.enableOrderSaving = function(c, a) {
	this.attachEvent("onAfterCMove", function() {
		this.saveOrderToCookie(c, a);
		this.saveSizeToCookie(c, a)
	})
};
dhtmlXGridObject.prototype.enableAutoSaving = function(c, a) {
	this.enableOrderSaving(c, a);
	this.enableAutoSizeSaving(c, a);
	this.enableSortingSaving(c, a)
};
dhtmlXGridObject.prototype.saveSizeToCookie = function(c, a) {
	if (this.cellWidthType == "px") {
		var l = this.cellWidthPX.join(",")
	} else {
		var l = this.cellWidthPC.join(",")
	}
	var g = (this.initCellWidth || (new Array)).join(",");
	this.setCookie(c, a, 0, l);
	this.setCookie(c, a, 1, g)
};
dhtmlXGridObject.prototype.saveHiddenColumnsToCookie = function(c, a) {
	var l = [].concat(this._hrrar || []);
	if (this._fake && this._fake._hrrar) {
		for (var g = 0; g < this._fake._cCount; g++) {
			l[g] = this._fake._hrrar[g] ? "1" : ""
		}
	}
	this.setCookie(c, a, 4, l.join(",").replace(/display:none;/g, "1"))
};
dhtmlXGridObject.prototype.loadHiddenColumnsFromCookie = function(c) {
	var l = this._getCookie(c, 4);
	var a = (l || "").split(",");
	for (var g = 0; g < this._cCount; g++) {
		this.setColumnHidden(g, (a[g] ? true : false))
	}
};
dhtmlXGridObject.prototype.saveSortingToCookie = function(c, a) {
	this.setCookie(c, a, 2, (this.getSortingState() || []).join(","))
};
dhtmlXGridObject.prototype.loadSortingFromCookie = function(a) {
	var c = this._getCookie(a, 2);
	c = (c || "").split(",");
	if (c.length > 1 && c[0] < this._cCount) {
		this.sortRows(c[0], null, c[1]);
		this.setSortImgState(true, c[0], c[1])
	}
};
dhtmlXGridObject.prototype.saveOrderToCookie = function(g, a) {
	if (!this._c_order) {
		this._c_order = [];
		var c = this._cCount;
		for (var m = 0; m < c; m++) {
			this._c_order[m] = m
		}
	}
	this.setCookie(g, a, 3, ((this._c_order || []).slice(0, this._cCount)).join(","));
	this.saveSortingToCookie()
};
dhtmlXGridObject.prototype.loadOrderFromCookie = function(c) {
	var m = this._getCookie(c, 3);
	m = (m || "").split(",");
	if (m.length > 1 && m.length <= this._cCount) {
		for (var l = 0; l < m.length; l++) {
			if ((!this._c_order && m[l] != l) || (this._c_order && m[l] != this._c_order[l])) {
				var g = m[l];
				if (this._c_order) {
					for (var a = 0; a < this._c_order.length; a++) {
						if (this._c_order[a] == m[l]) {
							g = a;
							break
						}
					}
				}
				this.moveColumn(g * 1, l)
			}
		}
	}
};
dhtmlXGridObject.prototype.loadSizeFromCookie = function(a) {
	var g = this._getCookie(a, 1);
	if (g) {
		this.initCellWidth = g.split(",")
	}
	var g = this._getCookie(a, 0);
	if ((g) && (g.length)) {
		if (!this._fake && this._hrrar) {
			for (var c = 0; c < g.length; c++) {
				if (this._hrrar[c]) {
					g[c] = 0
				}
			}
		}
		if (this.cellWidthType == "px") {
			this.cellWidthPX = g.split(",")
		} else {
			this.cellWidthPC = g.split(",")
		}
	}
	this.setSizes();
	return true
};
dhtmlXGridObject.prototype.clearConfigCookie = function(a) {
	if (!a) {
		a = this.entBox.id
	}
	var c = "gridSettings" + a + "=||||";
	document.cookie = c
};
dhtmlXGridObject.prototype.clearSizeCookie = dhtmlXGridObject.prototype.clearConfigCookie;
dhtmlXGridObject.prototype.setCookie = function(c, a, n, l) {
	if (!c) {
		c = this.entBox.id
	}
	var g = this.getCookie(c);
	g = (g || "||||").split("|");
	g[n] = l;
	var m = "gridSettings" + c + "=" + g.join("|").replace(/,/g, "-") + (a ? ("; " + a) : "");
	document.cookie = m
};
dhtmlXGridObject.prototype.getCookie = function(c, l) {
	if (!c) {
		c = this.entBox.id
	}
	c = (l || "gridSettings") + c;
	var g = c + "=";
	if (document.cookie.length > 0) {
		var m = document.cookie.indexOf(g);
		if (m != -1) {
			m += g.length;
			var a = document.cookie.indexOf(";", m);
			if (a == -1) {
				a = document.cookie.length
			}
			return document.cookie.substring(m, a)
		}
	}
};
dhtmlXGridObject.prototype._getCookie = function(a, c) {
	return ((this.getCookie(a) || "||||").replace(/-/g, ",").split("|"))[c]
};
dhtmlXGridObject.prototype.enableUndoRedo = function() {
	var c = this;
	var g = function() {
		return c._onEditUndoRedo.apply(c, arguments)
	};
	this.attachEvent("onEditCell", g);
	var a = function(m, l, n) {
		return c._onEditUndoRedo.apply(c, [2, m, l, (n ? 1 : 0), (n ? 0 : 1)])
	};
	this.attachEvent("onCheckbox", a);
	this._IsUndoRedoEnabled = true;
	this._UndoRedoData = [];
	this._UndoRedoPos = -1
};
dhtmlXGridObject.prototype.disableUndoRedo = function() {
	this._IsUndoRedoEnabled = false;
	this._UndoRedoData = [];
	this._UndoRedoPos = -1
};
dhtmlXGridObject.prototype._onEditUndoRedo = function(g, c, n, l, a) {
	if (this._IsUndoRedoEnabled && g == 2 && a != l) {
		if (this._UndoRedoPos !== -1 && this._UndoRedoPos != (this._UndoRedoData.length - 1)) {
			this._UndoRedoData = this._UndoRedoData.slice(0, this._UndoRedoPos + 1)
		} else {
			if (this._UndoRedoPos === -1 && this._UndoRedoData.length > 0) {
				this._UndoRedoData = []
			}
		}
		var m = {
			old_value: a,
			new_value: l,
			row_id: c,
			cell_index: n
		};
		this._UndoRedoData.push(m);
		this._UndoRedoPos++
	}
	return true
};
dhtmlXGridObject.prototype.doUndo = function() {
	if (this._UndoRedoPos === -1) {
		return false
	}
	var a = this._UndoRedoData[this._UndoRedoPos--];
	var g = this.cells(a.row_id, a.cell_index);
	if (this.getColType(a.cell_index) == "tree") {
		g.setLabel(a.old_value)
	} else {
		g.setValue(a.old_value)
	}
	this.callEvent("onUndo", [a.row_id])
};
dhtmlXGridObject.prototype.doRedo = function() {
	if (this._UndoRedoPos == this._UndoRedoData.length - 1) {
		return false
	}
	var a = this._UndoRedoData[++this._UndoRedoPos];
	this.cells(a.row_id, a.cell_index).setValue(a.new_value);
	this.callEvent("onUndo", [a.row_id])
};
dhtmlXGridObject.prototype.getRedo = function() {
	if (this._UndoRedoPos == this._UndoRedoData.length - 1) {
		return []
	}
	return this._UndoRedoData.slice(this._UndoRedoPos + 1)
};
dhtmlXGridObject.prototype.getUndo = function() {
	if (this._UndoRedoPos == -1) {
		return []
	}
	return this._UndoRedoData.slice(0, this._UndoRedoPos + 1)
};
dhtmlXGridObject.prototype.enableAccessKeyMap = function() {
	this._select_ifpossible = function() {
		if (this.editor && this.editor.obj && this.editor.obj.select) {
			this.editor.obj.select()
		}
	};
	this._key_events = {
		k13_1_0: function() {
			this.editStop()
		},
		k13_0_1: function() {
			this._key_events.k9_0_1.call(this)
		},
		k13_0_0: function() {
			this._key_events.k9_0_0.call(this)
		},
		k9_0_0: function() {
			this.editStop();
			if (!this.callEvent("onTab", [true])) {
				return true
			}
			var a = this._getNextCell(null, 1);
			if (a) {
				if (this.pagingOn) {
					this.showRow(a.parentNode.idd)
				}
				this.selectCell(a.parentNode, a._cellIndex, (this.row != a.parentNode), false, true);
				this._still_active = true
			}
			this._select_ifpossible()
		},
		k9_0_1: function() {
			this.editStop();
			if (!this.callEvent("onTab", [false])) {
				return true
			}
			var a = this._getNextCell(null, -1);
			if (a) {
				this.selectCell(a.parentNode, a._cellIndex, (this.row != a.parentNode), false, true);
				this._still_active = true
			}
			this._select_ifpossible()
		},
		k113_0_0: function() {
			if (this._f2kE) {
				this.editCell()
			}
		},
		k32_0_0: function() {
			var a = this.cells4(this.cell);
			if (!a.changeState || (a.changeState() === false)) {
				return false
			}
		},
		k27_0_0: function() {
			this.editStop(true)
		},
		k33_0_0: function() {
			if (this.pagingOn) {
				this.changePage(this.currentPage - 1)
			} else {
				this.scrollPage(-1)
			}
		},
		k34_0_0: function() {
			if (this.pagingOn) {
				this.changePage(this.currentPage + 1)
			} else {
				this.scrollPage(1)
			}
		},
		k37_0_0: function() {
			if (this.editor) {
				return false
			}
			if (this.isTreeGrid()) {
				this.collapseKids(this.row)
			} else {
				this._key_events.k9_0_1.call(this)
			}
		},
		k39_0_0: function() {
			if (this.editor) {
				return false
			}
			if (!this.editor && this.isTreeGrid()) {
				this.expandKids(this.row)
			} else {
				this._key_events.k9_0_0.call(this)
			}
		},
		k37_1_0: function() {
			if (this.editor) {
				return false
			}
			this.selectCell(this.row, 0, false, false, true);
			this._select_ifpossible()
		},
		k39_1_0: function() {
			if (this.editor) {
				return false
			}
			this.selectCell(this.row, this._cCount - 1, false, false, true);
			this._select_ifpossible()
		},
		k38_1_0: function() {
			this.selectCell(this.rowsCol[0], this.cell._cellIndex, true, false, true);
			this._select_ifpossible()
		},
		k40_1_0: function() {
			this.selectCell(this.rowsCol[this.rowsCol.length - 1], this.cell._cellIndex, true, false, true);
			this._select_ifpossible()
		},
		k38_0_1: function() {
			var a = this.getRowIndex(this.row.idd);
			var c = this._nextRow(a, -1);
			if (!c || c._sRow || c._rLoad) {
				return false
			}
			this.selectCell(c, this.cell._cellIndex, true, false, true);
			this._select_ifpossible()
		},
		k40_0_1: function() {
			var a = this.getRowIndex(this.row.idd);
			var c = this._nextRow(a, 1);
			if (!c || c._sRow || c._rLoad) {
				return false
			}
			this.selectCell(c, this.cell._cellIndex, true, false, true);
			this._select_ifpossible()
		},
		k38_1_1: function() {
			var a = this.getRowIndex(this.row.idd);
			for (var c = a; c >= 0; c--) {
				this.selectCell(this.rowsCol[c], this.cell._cellIndex, true, false, true)
			}
		},
		k40_1_1: function() {
			var a = this.getRowIndex(this.row.idd);
			for (var c = a + 1; c < this.rowsCol.length; c++) {
				this.selectCell(this.rowsCol[c], this.cell._cellIndex, true, false, true)
			}
		},
		k40_0_0: function() {
			if (this.editor && this.editor.combo) {
				this.editor.shiftNext()
			} else {
				if (!this.row.idd) {
					return
				}
				var a = a = this.getRowIndex(this.row.idd) + 1;
				if (this.rowsBuffer[a]) {
					var c = this._nextRow(a - 1, 1);
					if (this.pagingOn && c) {
						this.showRow(c.idd)
					}
					this._Opera_stop = 0;
					this.selectCell(c, this.cell._cellIndex, true, false, true)
				} else {
					if (!this.callEvent("onLastRow", [])) {
						return false
					}
					this._key_events.k34_0_0.apply(this, [])
				}
			}
			this._still_active = true
		},
		k36_0_0: function() {
			return this._key_events.k37_1_0.call(this)
		},
		k35_0_0: function() {
			return this._key_events.k39_1_0.call(this)
		},
		k36_1_0: function() {
			if (this.editor || !this.rowsCol.length) {
				return false
			}
			this.selectCell(this.rowsCol[0], 0, true, false, true);
			this._select_ifpossible()
		},
		k35_1_0: function() {
			if (this.editor || !this.rowsCol.length) {
				return false
			}
			this.selectCell(this.rowsCol[this.rowsCol.length - 1], this._cCount - 1, true, false, true);
			this._select_ifpossible()
		},
		k33_0_0: function() {
			if (this.pagingOn) {
				this.changePage(this.currentPage - 1)
			} else {
				this.scrollPage(-1)
			}
		},
		k34_0_0: function() {
			if (this.pagingOn) {
				this.changePage(this.currentPage + 1)
			} else {
				this.scrollPage(1)
			}
		},
		k38_0_0: function() {
			if (this.editor && this.editor.combo) {
				this.editor.shiftPrev()
			} else {
				if (!this.row.idd) {
					return
				}
				var a = a = this.getRowIndex(this.row.idd) + 1;
				if (a != -1) {
					var c = this._nextRow(a - 1, -1);
					this._Opera_stop = 0;
					if (this.pagingOn && c) {
						this.showRow(c.idd)
					}
					this.selectCell(c, this.cell._cellIndex, true, false, true)
				} else {
					this._key_events.k33_0_0.apply(this, [])
				}
			}
			this._still_active = true
		}
	}
};
dhtmlXGridObject.prototype.enableExcelKeyMap = function() {
	dhtmlXGridObject.prototype._key_events = {
		k13_1_0: function() {
			this.editStop()
		},
		k13_0_1: function() {
			this.editStop();
			this._key_events.k38_0_0.call(this)
		},
		k13_0_0: function() {
			this.editStop();
			this.callEvent("onEnter", [(this.row ? this.row.idd : null), (this.cell ? this.cell._cellIndex : null)]);
			this._still_active = true;
			this._key_events.k40_0_0.call(this)
		},
		k9_0_0: function() {
			this.editStop();
			if (!this.callEvent("onTab", [true])) {
				return true
			}
			if (this.cell && (this.cell._cellIndex + 1) >= this._cCount) {
				return
			}
			var a = this._getNextCell(null, 1);
			if (a && this.row == a.parentNode) {
				this.selectCell(a.parentNode, a._cellIndex, true);
				this._still_active = true
			}
		},
		k9_0_1: function() {
			this.editStop();
			if (!this.callEvent("onTab", [false])) {
				return true
			}
			if (this.cell && (this.cell._cellIndex == 0)) {
				return
			}
			var a = this._getNextCell(null, -1);
			if (a && this.row == a.parentNode) {
				this.selectCell(a.parentNode, a._cellIndex, true);
				this._still_active = true
			}
		},
		k113_0_0: function() {
			if (this._f2kE) {
				this.editCell()
			}
		},
		k32_0_0: function() {
			var a = this.cells4(this.cell);
			if (!a.changeState || (a.changeState() === false)) {
				return false
			}
		},
		k27_0_0: function() {
			this.editStop(true);
			this._still_active = true
		},
		k33_0_0: function() {
			if (this.pagingOn) {
				this.changePage(this.currentPage - 1)
			} else {
				this.scrollPage(-1)
			}
		},
		k34_0_0: function() {
			if (this.pagingOn) {
				this.changePage(this.currentPage + 1)
			} else {
				this.scrollPage(1)
			}
		},
		k37_0_0: function() {
			if (this.editor) {
				return false
			}
			if (this.isTreeGrid()) {
				this.collapseKids(this.row)
			} else {
				this._key_events.k9_0_1.call(this)
			}
		},
		k39_0_0: function() {
			if (this.editor) {
				return false
			}
			if (!this.editor && this.isTreeGrid()) {
				this.expandKids(this.row)
			} else {
				this._key_events.k9_0_0.call(this)
			}
		},
		k37_1_0: function() {
			if (this.editor) {
				return false
			}
			this.selectCell(this.row, 0, true)
		},
		k39_1_0: function() {
			if (this.editor) {
				return false
			}
			this.selectCell(this.row, this._cCount - 1, true)
		},
		k38_1_0: function() {
			if (this.editor || !this.rowsCol.length) {
				return false
			}
			this.selectCell(this.rowsCol[0], this.cell._cellIndex, true)
		},
		k40_1_0: function() {
			if (this.editor || !this.rowsCol.length) {
				return false
			}
			this.selectCell(this.rowsCol[this.rowsCol.length - 1], this.cell._cellIndex, true)
		},
		k38_0_1: function() {
			if (this.editor || !this.rowsCol.length) {
				return false
			}
			var a = this.row.rowIndex;
			var c = this._nextRow(a - 1, -1);
			if (!c || c._sRow || c._rLoad) {
				return false
			}
			this.selectCell(c, this.cell._cellIndex, true, true)
		},
		k40_0_1: function() {
			if (this.editor || !this.rowsCol.length) {
				return false
			}
			var a = this.row.rowIndex;
			var c = this._nextRow(a - 1, 1);
			if (!c || c._sRow || c._rLoad) {
				return false
			}
			this.selectCell(c, this.cell._cellIndex, true, true)
		},
		k38_1_1: function() {
			if (this.editor || !this.rowsCol.length) {
				return false
			}
			var a = this.row.rowIndex;
			for (var c = a - 1; c >= 0; c--) {
				this.selectCell(this.rowsCol[c], this.cell._cellIndex, true, true)
			}
		},
		k40_1_1: function() {
			if (this.editor || !this.rowsCol.length) {
				return false
			}
			var a = this.row.rowIndex;
			for (var c = a; c < this.rowsCol.length; c++) {
				this.selectCell(this.rowsCol[c], this.cell._cellIndex, true, true)
			}
		},
		k40_0_0: function() {
			var c = this._realfake ? this._fake : this;
			if (this.editor && this.editor.combo) {
				this.editor.shiftNext()
			} else {
				if (this.editor) {
					return false
				}
				var a = Math.max((c._r_select || 0), this.getRowIndex(this.row.idd));
				var g = this._nextRow(a, 1);
				if (g) {
					c._r_select = null;
					this.selectCell(g, this.cell._cellIndex, true);
					if (c.pagingOn) {
						c.showRow(g.idd)
					}
				} else {
					if (!this.callEvent("onLastRow", [])) {
						return false
					}
					this._key_events.k34_0_0.apply(this, [])
				}
			}
		},
		k36_0_0: function() {
			return this._key_events.k37_1_0.call(this)
		},
		k35_0_0: function() {
			return this._key_events.k39_1_0.call(this)
		},
		k36_1_0: function() {
			if (this.editor || !this.rowsCol.length) {
				return false
			}
			this.selectCell(this.rowsCol[0], 0, true)
		},
		k35_1_0: function() {
			if (this.editor || !this.rowsCol.length) {
				return false
			}
			this.selectCell(this.rowsCol[this.rowsCol.length - 1], this._cCount - 1, true)
		},
		k33_0_0: function() {
			if (this.pagingOn) {
				this.changePage(this.currentPage - 1)
			} else {
				this.scrollPage(-1)
			}
		},
		k34_0_0: function() {
			if (this.pagingOn) {
				this.changePage(this.currentPage + 1)
			} else {
				this.scrollPage(1)
			}
		},
		k38_0_0: function() {
			var c = this._realfake ? this._fake : this;
			if (this.editor && this.editor.combo) {
				this.editor.shiftPrev()
			} else {
				if (this.editor) {
					return false
				}
				if (!this.row.idd) {
					return
				}
				var a = this.getRowIndex(this.row.idd) + 1;
				if (a != -1 && (!this.pagingOn || (a != 1))) {
					var g = this._nextRow(a - 1, -1);
					this.selectCell(g, this.cell._cellIndex, true);
					if (c.pagingOn && g) {
						c.showRow(g.idd)
					}
				} else {
					this._key_events.k33_0_0.apply(this, [])
				}
			}
		},
		k_other: function(g) {
			if (this.editor) {
				return false
			}
			if (!g.ctrlKey && g.keyCode >= 40 && (g.keyCode < 91 || (g.keyCode > 95 && g.keyCode < 111) || g.keyCode > 187)) {
				if (this.cell) {
					var l = this.cells4(this.cell);
					if (l.isDisabled()) {
						return false
					}
					var a = l.getValue();
					if (l.editable !== false) {
						l.setValue("")
					}
					this.editCell();
					if (this.editor) {
						this.editor.val = a;
						if (this.editor.obj && this.editor.obj.select) {
							this.editor.obj.select()
						}
					} else {
						l.setValue(a)
					}
				}
			}
		}
	}
};

function eXcell_time(a) {
	this.base = eXcell_ed;
	this.base(a);
	this.getValue = function() {
		return this.cell.innerHTML.toString()
	};
	this.setValue = function(n) {
		var m = new RegExp(" ", "i");
		n = n.replace(m, ":");
		if ((n == "")) {
			n = "00:00"
		} else {
			var m = new RegExp("[a-zA-Z]", "i");
			var l = n.match(m);
			if (l) {
				n = "00:00"
			} else {
				var m = new RegExp("[0-9]+[\\.\\/;\\-,_\\]\\[\\?\\: ][0-9]+", "i");
				var l = n.search(m);
				if (l != -1) {
					var m = new RegExp("[\\./\\;\\-\\,\\_\\]\\[ \\?]", "i");
					n = n.replace(m, ":")
				} else {
					var m = new RegExp("[^0-9]", "i");
					res1 = n.search(m);
					if (l = n.match(m)) {
						n = "00:00"
					} else {
						if (n.length == 1) {
							n = "00:0" + n
						} else {
							if (parseInt(n) < 60) {
								n = "00:" + n
							} else {
								if (n.length < 5) {
									var g = parseInt(n);
									var c = Math.floor(g / 60);
									g = g - 60 * c;
									var c = c.toString();
									var g = g.toString();
									while (c.length < 2) {
										c = "0" + c
									}
									while (g.length < 2) {
										g = "0" + g
									}
									n = c + ":" + g
								}
							}
						}
					}
				}
			}
		}
		this.cell.innerHTML = n
	}
}
eXcell_time.prototype = new eXcell_ed;

function eXcell_sub_row(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid
	}
	this.getValue = function() {
		return this.grid.getUserData(this.cell.parentNode.idd, "__sub_row")
	};
	this._setState = function(c, g) {
		(g || this.cell).innerHTML = "<img src='" + this.grid.imgURL + c + "' width='18' height='18' />";
		(g || this.cell).firstChild.onclick = this.grid._expandMonolite
	};
	this.open = function() {
		this.cell.firstChild.onclick(null, true)
	};
	this.close = function() {
		this.cell.firstChild.onclick(null, false, true)
	};
	this.isOpen = function() {
		return !!this.cell.parentNode._expanded
	};
	this.setValue = function(c) {
		if (c) {
			this.grid.setUserData(this.cell.parentNode.idd, "__sub_row", c)
		}
		this._setState(c ? "plus.gif" : "blank.gif")
	};
	this.setContent = function(c) {
		if (this.cell.parentNode._expanded) {
			this.cell.parentNode._expanded.innerHTML = c;
			this.resize()
		} else {
			this.cell._previous_content = null;
			this.setValue(c);
			this.cell._sub_row_type = null
		}
	};
	this.resize = function() {
		this.grid._detectHeight(this.cell.parentNode._expanded, this.cell, this.cell.parentNode._expanded.scrollHeight)
	}, this.isDisabled = function() {
		return true
	};
	this.getTitle = function() {
		return this.grid.getUserData(this.cell.parentNode.idd, "__sub_row") ? "click to expand|collapse" : ""
	}
}
eXcell_sub_row.prototype = new eXcell;

function eXcell_sub_row_ajax(a) {
	this.base = eXcell_sub_row;
	this.base(a);
	this.setValue = function(c) {
		if (c) {
			this.grid.setUserData(this.cell.parentNode.idd, "__sub_row", c)
		}
		this.cell._sub_row_type = "ajax";
		this.cell._previous_content = null;
		this._setState(c ? "plus.gif" : "blank.gif")
	}
}
eXcell_sub_row_ajax.prototype = new eXcell_sub_row;

function eXcell_sub_row_grid(a) {
	this.base = eXcell_sub_row;
	this.base(a);
	this.setValue = function(c) {
		if (c) {
			this.grid.setUserData(this.cell.parentNode.idd, "__sub_row", c)
		}
		this.cell._sub_row_type = "grid";
		this._setState(c ? "plus.gif" : "blank.gif")
	};
	this.getSubGrid = function() {
		if (!a._sub_grid) {
			return null
		}
		return a._sub_grid
	}
}
eXcell_sub_row_grid.prototype = new eXcell_sub_row;
dhtmlXGridObject.prototype._expandMonolite = function(a, v, o) {
	var g = this.parentNode;
	var w = g.parentNode;
	var r = w.grid;
	if (a || window.event) {
		if (!o && !w._expanded) {
			r.editStop()
		}(a || event).cancelBubble = true
	}
	var u = r.getUserData(w.idd, "__sub_row");
	if (!r._sub_row_editor) {
		r._sub_row_editor = new eXcell_sub_row(g)
	}
	if (!u) {
		return
	}
	if (w._expanded && !v) {
		r._sub_row_editor._setState("plus.gif", g);
		g._previous_content = w._expanded;
		r.objBox.removeChild(w._expanded);
		w._expanded = false;
		w.style.height = (w.oldHeight || 20) + "px";
		g.style.height = (w.oldHeight || 20) + "px";
		if (r._fake) {
			r._fake.rowsAr[w.idd].style.height = (w.oldHeight || 20) + "px";
			r._fake.rowsAr[w.idd].firstChild.style.height = (w.oldHeight || 20) + "px"
		}
		for (var m = 0; m < w.cells.length; m++) {
			w.cells[m].style.verticalAlign = "middle"
		}
		delete r._flow[w.idd];
		r._correctMonolite();
		w._expanded.ctrl = null
	} else {
		if (!w._expanded && !o) {
			r._sub_row_editor._setState("minus.gif", g);
			w.oldHeight = g.offsetHeight - 4;
			if (g._previous_content) {
				var s = g._previous_content;
				s.ctrl = g;
				r.objBox.appendChild(s);
				r._detectHeight(s, g, parseInt(s.style.height))
			} else {
				var s = document.createElement("DIV");
				s.ctrl = g;
				if (g._sub_row_type) {
					r._sub_row_render[g._sub_row_type](r, s, g, u)
				} else {
					s.innerHTML = u
				}
				s.style.cssText = "position:absolute; left:0px; top:0px; overflow:auto; font-family:Tahoma; font-size:8pt; margin-top:2px; margin-left:4px;";
				s.className = "dhx_sub_row";
				r.objBox.appendChild(s);
				r._detectHeight(s, g)
			}
			if (!r._flow) {
				r.attachEvent("onGridReconstructed", function() {
					if ((this.pagingOn && !this.parentGrid) || this._srnd) {
						this._collapsMonolite()
					} else {
						this._correctMonolite()
					}
				});
				r.attachEvent("onResizeEnd", function() {
					this._correctMonolite(true)
				});
				r.attachEvent("onAfterCMove", function() {
					this._correctMonolite(true)
				});
				r.attachEvent("onDrop", function() {
					this._correctMonolite(true)
				});
				r.attachEvent("onBeforePageChanged", function() {
					this._collapsMonolite();
					return true
				});
				r.attachEvent("onGroupStateChanged", function() {
					this._correctMonolite();
					return true
				});
				r.attachEvent("onFilterEnd", function() {
					this._collapsMonolite()
				});
				r.attachEvent("onUnGroup", function() {
					this._collapsMonolite()
				});
				r.attachEvent("onPageChanged", function() {
					this._collapsMonolite()
				});
				r.attachEvent("onXLE", function() {
					this._collapsMonolite()
				});
				r.attachEvent("onClearAll", function() {
					for (var c in this._flow) {
						if (this._flow[c] && this._flow[c].parentNode) {
							this._flow[c].parentNode.removeChild(this._flow[c])
						}
					}
					this._flow = []
				});
				r.attachEvent("onEditCell", function(x, n, y) {
					if ((x !== 2) && this._flow[n] && this.cellType[y] != "ch" && this.cellType[y] != "ra") {
						this._expandMonolite.apply(this._flow[n].ctrl.firstChild, [0, false, true])
					}
					return true
				});
				r.attachEvent("onCellChanged", function(y, n) {
					if (!this._flow[y]) {
						return
					}
					var x = this.cells(y, n).cell;
					x.style.verticalAlign = "top"
				});
				r._flow = []
			}
			r._flow[w.idd] = s;
			r._correctMonolite();
			var q = r._srdh > 30 ? 11 : 3;
			if (r.multiLine) {
				q = 0
			}
			for (var m = 0; m < w.cells.length; m++) {
				w.cells[m].style.verticalAlign = "top"
			}
			if (r._fake) {
				var l = r._fake.rowsAr[w.idd];
				for (var m = 0; m < l.cells.length; m++) {
					l.cells[m].style.verticalAlign = "top"
				}
			}
			w._expanded = s
		}
	}
	if (r._ahgr) {
		r.setSizes()
	}
	if (r.parentGrid) {
		r.callEvent("onGridReconstructed", [])
	}
	r.callEvent("onSubRowOpen", [w.idd, (!!w._expanded)])
};
dhtmlXGridObject.prototype._sub_row_render = {
	ajax: function(that, d, td, c) {
		d.innerHTML = "Loading...";
		dhx4.ajax.get(c, function(xml) {
			d.innerHTML = xml.xmlDoc.responseText;
			var z = xml.xmlDoc.responseText.match(/<script[^>]*>([^\f]+?)<\/script>/g);
			if (z) {
				for (var i = 0; i < z.length; i++) {
					eval(z[i].replace(/<([\/]{0,1})s[^>]*>/g, ""))
				}
			}
			that._detectHeight(d, td);
			that._correctMonolite();
			that.setUserData(td.parentNode.idd, "__sub_row", xml.xmlDoc.responseText);
			td._sub_row_type = null;
			if (that._ahgr) {
				that.setSizes()
			}
			that.callEvent("onSubAjaxLoad", [td.parentNode.idd, xml.xmlDoc.responseText])
		})
	},
	grid: function(a, g, m, l) {
		m._sub_grid = new dhtmlXGridObject(g);
		if (a.skin_name) {
			m._sub_grid.setSkin(a.skin_name)
		}
		m._sub_grid.parentGrid = a;
		m._sub_grid.imgURL = a.imgURL;
		m._sub_grid.iconURL = a.iconURL;
		m._sub_grid.enableAutoHeight(true);
		m._sub_grid._delta_x = m._sub_grid._delta_y = null;
		m._sub_grid.attachEvent("onGridReconstructed", function() {
			a._detectHeight(g, m, m._sub_grid.objBox.scrollHeight + m._sub_grid.hdr.offsetHeight + (this.ftr ? this.ftr.offsetHeight : 0));
			a._correctMonolite();
			this.setSizes();
			if (a.parentGrid) {
				a.callEvent("onGridReconstructed", [])
			}
		});
		if (!a.callEvent("onSubGridCreated", [m._sub_grid, m.parentNode.idd, m._cellIndex, l])) {
			m._sub_grid.objBox.style.overflow = "hidden";
			m._sub_row_type = null
		} else {
			m._sub_grid.loadXML(l, function() {
				a._detectHeight(g, m, m._sub_grid.objBox.scrollHeight + m._sub_grid.hdr.offsetHeight + (m._sub_grid.ftr ? m._sub_grid.ftr.offsetHeight : 0));
				m._sub_grid.objBox.style.overflow = "hidden";
				a._correctMonolite();
				m._sub_row_type = null;
				if (!a.callEvent("onSubGridLoaded", [m._sub_grid, m.parentNode.idd, m._cellIndex, l])) {
					return
				}
				if (a._ahgr) {
					a.setSizes()
				}
			})
		}
	}
};
dhtmlXGridObject.prototype._detectHeight = function(n, o, c) {
	var a = o.offsetLeft + o.offsetWidth;
	n.style.left = a + "px";
	n.style.width = Math.max(0, o.parentNode.offsetWidth - a - 4) + "px";
	var c = c || n.scrollHeight;
	n.style.overflow = "hidden";
	n.style.height = c + "px";
	var m = o.parentNode;
	o.parentNode.style.height = (m.oldHeight || 20) + c * 1 + "px";
	o.style.height = (m.oldHeight || 20) + c * 1 + "px";
	if (this._fake) {
		var g = this._fake.rowsAr[o.parentNode.idd];
		g.style.height = (m.oldHeight || 20) + c * 1 + "px";
		g.firstChild.style.height = (m.oldHeight || 20) + c * 1 + "px"
	}
};
dhtmlXGridObject.prototype._correctMonolite = function(m) {
	if (this._in_correction) {
		return
	}
	this._in_correction = true;
	for (var g in this._flow) {
		if (this._flow[g] && this._flow[g].tagName == "DIV") {
			if (this.rowsAr[g]) {
				if (this.rowsAr[g].style.display == "none") {
					this.cells4(this._flow[g].ctrl).close();
					continue
				}
				this._flow[g].style.top = this.rowsAr[g].offsetTop + (this.rowsAr[g].oldHeight || 20) + "px";
				if (m) {
					var c = this._flow[g].ctrl.offsetLeft + this._flow[g].ctrl.offsetWidth;
					this._flow[g].style.left = c + "px";
					this._flow[g].style.width = this.rowsAr[g].offsetWidth - c - 4 + "px"
				}
			} else {
				this._flow[g].ctrl = null;
				this.objBox.removeChild(this._flow[g]);
				delete this._flow[g]
			}
		}
	}
	this._in_correction = false
};
dhtmlXGridObject.prototype._collapsMonolite = function() {
	for (var c in this._flow) {
		if (this._flow[c] && this._flow[c].tagName == "DIV") {
			if (this.rowsAr[c]) {
				this.cells4(this._flow[c].ctrl).close()
			}
		}
	}
};

function eXcell_ra_str(a) {
	if (a) {
		this.base = eXcell_ra;
		this.base(a);
		this.grid = a.parentNode.grid
	}
}
eXcell_ra_str.prototype = new eXcell_ch;
eXcell_ra_str.prototype.setValue = function(g) {
	this.cell.style.verticalAlign = "middle";
	if (g) {
		g = g.toString()._dhx_trim();
		if ((g == "false") || (g == "0")) {
			g = ""
		}
	}
	if (g) {
		if (this.grid.rowsAr[this.cell.parentNode.idd]) {
			for (var c = 0; c < this.grid._cCount; c++) {
				if (c !== this.cell._cellIndex) {
					var a = this.grid.cells(this.cell.parentNode.idd, c);
					if ((a.cell._cellType || this.grid.cellType[a.cell._cellIndex]) != "ra_str") {
						continue
					}
					if (a.getValue()) {
						a.setValue("0")
					}
				}
			}
		}
		g = "1";
		this.cell.chstate = "1"
	} else {
		g = "0";
		this.cell.chstate = "0"
	}
	this.setCValue("<img src='" + this.grid.imgURL + "radio_chk" + g + ".gif' onclick='new eXcell_ra_str(this.parentNode).changeState()'>", this.cell.chstate)
};
dhx4.attachEvent("onGridCreated", function(c) {
	if (!window.dhx_globalImgPath) {
		window.dhx_globalImgPath = c.imgURL
	}
	c._col_combos = [];
	for (var a = 0; a < c._cCount; a++) {
		if (c.cellType[a].indexOf("combo") == 0) {
			c._col_combos[a] = eXcell_combo.prototype.initCombo.call({
				grid: c
			}, a)
		}
	}
	if (!c._loading_handler_set) {
		c._loading_handler_set = c.attachEvent("onXLE", function(l, g, n, m) {
			eXcell_combo.prototype.fillColumnCombos(this, m);
			this.detachEvent(this._loading_handler_set);
			this._loading_handler_set = null
		})
	}
});

function eXcell_combo(a) {
	if (!a) {
		return
	}
	this.cell = a;
	this.grid = a.parentNode.grid;
	this._combo_pre = "";
	this.edit = function() {
		if (!window.dhx_globalImgPath) {
			window.dhx_globalImgPath = this.grid.imgURL
		}
		this.val = this.getValue();
		var c = this.getText();
		if (this.cell._clearCell) {
			c = ""
		}
		this.cell.innerHTML = "";
		if (!this.cell._brval) {
			this.combo = (this.grid._realfake ? this.grid._fake : this.grid)._col_combos[this.cell._cellIndex]
		} else {
			this.combo = this.cell._brval
		}
		this.cell.appendChild(this.combo.DOMParent);
		this.combo.DOMParent.style.margin = "0";
		this.combo.DOMelem_input.focus();
		this.combo.setSize(this.cell.offsetWidth - 2);
		if (!this.combo._xml) {
			if (this.combo.getIndexByValue(this.cell.combo_value) != -1) {
				this.combo.selectOption(this.combo.getIndexByValue(this.cell.combo_value))
			} else {
				if (this.combo.getOptionByLabel(c)) {
					this.combo.selectOption(this.combo.getIndexByValue(this.combo.getOptionByLabel(c).value))
				} else {
					this.combo.setComboText(c)
				}
			}
		} else {
			this.combo.setComboText(c)
		}
		this.combo.openSelect()
	};
	this.selectComboOption = function(g, c) {
		c.selectOption(c.getIndexByValue(c.getOptionByLabel(g).value))
	};
	this.getValue = function(c) {
		return this.cell.combo_value || ""
	};
	this.getText = function(g) {
		var l = this.cell;
		if (this._combo_pre == "" && l.childNodes[1]) {
			l = l.childNodes[1]
		} else {
			l.childNodes[0].childNodes[1]
		}
		return (_isIE ? l.innerText : l.textContent)
	};
	this.setValue = function(m) {
		if (typeof(m) == "object") {
			this.cell._brval = this.initCombo();
			var g = this.cell._cellIndex;
			var l = this.cell.parentNode.idd;
			if (!m.firstChild) {
				this.cell.combo_value = "&nbsp;";
				this.cell._clearCell = true
			} else {
				this.cell.combo_value = m.firstChild.data
			}
			this.setComboOptions(this.cell._brval, m, this.grid, g, l)
		} else {
			this.cell.combo_value = m;
			var c = null;
			if ((c = this.cell._brval) && (typeof(this.cell._brval) == "object")) {
				m = (c.getOption(m) || {}).text || m
			} else {
				if (c = this.grid._col_combos[this.cell._cellIndex] || ((this.grid._fake) && (c = this.grid._fake._col_combos[this.cell._cellIndex]))) {
					m = (c.getOption(m) || {}).text || m
				}
			}
			if ((m || "").toString()._dhx_trim() == "") {
				m = null
			}
			if (m !== null) {
				this.setComboCValue(m)
			} else {
				this.setComboCValue("&nbsp;", "");
				this.cell._clearCell = true
			}
		}
	};
	this.detach = function() {
		var c = this.combo.getParent();
		if (c.parentNode == this.cell) {
			this.cell.removeChild(c)
		} else {
			return false
		}
		var g = this.cell.combo_value;
		if (!this.combo.getComboText() || this.combo.getComboText().toString()._dhx_trim() == "") {
			this.setComboCValue("&nbsp;");
			this.cell._clearCell = true
		} else {
			this.setComboCValue(this.combo.getComboText().replace(/\&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;"), this.combo.getActualValue());
			this.cell._clearCell = false
		}
		this.combo._confirmSelect();
		this.cell.combo_value = this.combo.getActualValue();
		this.combo.closeAll();
		this.grid._still_active = true;
		this.grid.setActive(1);
		return g != this.cell.combo_value
	}
}
eXcell_combo.prototype = new eXcell;
eXcell_combo_v = function(a) {
	var c = new eXcell_combo(a);
	c._combo_pre = "<img src='" + (window.dhx_globalImgPath ? window.dhx_globalImgPath : this.grid.imgURL) + "combo_select" + (dhtmlx.skin ? "_" + dhtmlx.skin : "") + ".gif' class='dhxgrid_combo_icon'/>";
	return c
};
eXcell_combo.prototype.initCombo = function(c) {
	var a = document.createElement("DIV");
	a.className = "dhxcombo_in_grid_parent";
	var l = this.grid.defVal[arguments.length ? c : this.cell._cellIndex];
	var m = new dhtmlXCombo(a, "combo", 0, l);
	this.grid.defVal[arguments.length ? c : this.cell._cellIndex] = "";
	var g = this.grid;
	m.DOMelem.onmousedown = m.DOMelem.onclick = function(n) {
		n = n || event;
		n.cancelBubble = true
	};
	m.DOMelem.onselectstart = function(n) {
		n = n || event;
		n.cancelBubble = true;
		return true
	};
	m.attachEvent("onKeyPressed", function(n) {
		if (n == 13 || n == 27) {
			g.editStop();
			if (g._fake) {
				g._fake.editStop()
			}
		}
	});
	return m
};
eXcell_combo.prototype.fillColumnCombos = function(g, a) {
	if (!a) {
		return
	}
	var l = dhx4.ajax.xmltop("rows", a, -1);
	if (l && l.tagName !== "DIV") {
		g.combo_columns = g.combo_columns || [];
		columns = dhx4.ajax.xpath("//column", l);
		for (var c = 0; c < columns.length; c++) {
			if ((columns[c].getAttribute("type") || "").indexOf("combo") == 0) {
				g.combo_columns[g.combo_columns.length] = c;
				this.setComboOptions(g._col_combos[c], columns[c], g, c)
			}
		}
	}
};
eXcell_combo.prototype.setComboCValue = function(g, c) {
	if (this._combo_pre != "") {
		var a = (this.cell.offsetHeight ? this.cell.offsetHeight + "px" : 0);
		g = "<div style='width:100%;position:relative;height:100%;overflow:hidden;'>" + this._combo_pre + "<span>" + g + "</span></div>"
	}
	if (arguments.length > 1) {
		this.setCValue(g, c)
	} else {
		this.setCValue(g)
	}
};
eXcell_combo.prototype.setComboOptions = function(n, o, g, s, v) {
	if (window.dhx4.s2b(o.getAttribute("xmlcontent"))) {
		if (!o.getAttribute("source")) {
			options = o.childNodes;
			var a = [];
			for (var q = 0; q < options.length; q++) {
				if (options[q].tagName == "option") {
					var l = options[q].firstChild ? options[q].firstChild.data : "";
					a[a.length] = [options[q].getAttribute("value"), l]
				}
			}
			n.addOption(a);
			if (arguments.length == 4) {
				g.forEachRowA(function(x) {
					var w = g.cells(x, s);
					if (!w.cell._brval && !w.cell._cellType && (w.cell._cellIndex == s)) {
						if (w.cell.combo_value == "") {
							w.setComboCValue("&nbsp;", "")
						} else {
							if (!n.getOption(w.cell.combo_value)) {
								w.setComboCValue(w.cell.combo_value)
							} else {
								w.setComboCValue(n.getOption(w.cell.combo_value).text)
							}
						}
					}
				})
			} else {
				var u = (this.cell) ? this : g.cells(v, s);
				if (o.getAttribute("text")) {
					if (o.getAttribute("text")._dhx_trim() == "") {
						u.setComboCValue("&nbsp;", "")
					} else {
						u.setComboCValue(o.getAttribute("text"))
					}
				} else {
					if ((!u.cell.combo_value) || (u.cell.combo_value._dhx_trim() == "")) {
						u.setComboCValue("&nbsp;", "")
					} else {
						if (!n.getOption(u.cell.combo_value)) {
							u.setComboCValue(u.cell.combo_value)
						} else {
							u.setComboCValue(n.getOption(u.cell.combo_value).text)
						}
					}
				}
			}
		}
	}
	if (o.getAttribute("source")) {
		if (o.getAttribute("auto") && window.dhx4.s2b(o.getAttribute("auto"))) {
			if (o.getAttribute("xmlcontent")) {
				var u = (this.cell) ? this : g.cells(v, s);
				if (o.getAttribute("text")) {
					u.setComboCValue(o.getAttribute("text"))
				}
			} else {
				g.forEachRowA(function(A) {
					var y = g.cells(A, s);
					if (!y.cell._brval && !y.cell._cellType) {
						var x = y.cell.combo_value.toString();
						if (x.indexOf("^") != -1) {
							var w = x.split("^");
							y.cell.combo_value = w[0];
							y.setComboCValue(w[1])
						}
					}
				})
			}
			n.enableFilteringMode(true, o.getAttribute("source"), window.dhx4.s2b(o.getAttribute("cache") || true), window.dhx4.s2b(o.getAttribute("sub") || false))
		} else {
			var r = this;
			var m = arguments.length;
			n.load(o.getAttribute("source"), function() {
				if (m == 4) {
					g.forEachRow(function(y) {
						var x = g.cells(y, s);
						if (!x.cell._brval && !x.cell._cellType) {
							if (n.getOption(x.cell.combo_value)) {
								x.setComboCValue(n.getOption(x.cell.combo_value).text)
							} else {
								if ((x.cell.combo_value || "").toString()._dhx_trim() == "") {
									x.setComboCValue("&nbsp;", "");
									x.cell._clearCell = true
								} else {
									x.setComboCValue(x.cell.combo_value)
								}
							}
						}
					})
				} else {
					var w = g.cells(v, s);
					if (n.getOption(w.cell.combo_value)) {
						w.setComboCValue(n.getOption(w.cell.combo_value).text)
					} else {
						w.setComboCValue(w.cell.combo_value)
					}
				}
			})
		}
	}
	if (!o.getAttribute("auto") || !window.dhx4.s2b(o.getAttribute("auto"))) {
		if (o.getAttribute("editable") && !window.dhx4.s2b(o.getAttribute("editable"))) {
			n.readonly(true)
		}
		if (o.getAttribute("filter") && window.dhx4.s2b(o.getAttribute("filter"))) {
			n.enableFilteringMode(true)
		}
	}
};
eXcell_combo.prototype.getCellCombo = function() {
	if (this.cell._brval) {
		return this.cell._brval
	}
	this.cell._brval = this.initCombo();
	return this.cell._brval
};
eXcell_combo.prototype.refreshCell = function() {
	this.setValue(this.getValue())
};
dhtmlXGridObject.prototype.getColumnCombo = function(a) {
	if (this._col_combos && this._col_combos[a]) {
		return this._col_combos[a]
	}
	if (!this._col_combos) {
		this._col_combos = []
	}
	this._col_combos[a] = eXcell_combo.prototype.initCombo.call({
		grid: this
	}, a);
	return this._col_combos[a]
};
dhtmlXGridObject.prototype.refreshComboColumn = function(a) {
	this.forEachRow(function(c) {
		if (this.cells(c, a).refreshCell) {
			this.cells(c, a).refreshCell()
		}
	})
};

function eXcell_clist(a) {
	try {
		this.cell = a;
		this.grid = this.cell.parentNode.grid
	} catch (c) {}
	this.edit = function() {
		this.val = this.getValue();
		var l = (this.cell._combo || this.grid.clists[this.cell._cellIndex]);
		if (!l) {
			return
		}
		this.obj = document.createElement("DIV");
		var g = this.val.split(",");
		var r = "";
		for (var o = 0; o < l.length; o++) {
			var q = false;
			for (var m = 0; m < g.length; m++) {
				if (l[o] == g[m]) {
					q = true
				}
			}
			if (q) {
				r += "<div><input type='checkbox' id='dhx_clist_" + o + "' checked='true' /><label for='dhx_clist_" + o + "'>" + l[o] + "</label></div>"
			} else {
				r += "<div><input type='checkbox' id='dhx_clist_" + o + "'/><label for='dhx_clist_" + o + "'>" + l[o] + "</label></div>"
			}
		}
		r += "<div><input type='button' value='" + (this.grid.applyButtonText || "Apply") + "' style='width:100px; font-size:8pt;' onclick='this.parentNode.parentNode.editor.grid.editStop();'/></div>";
		this.obj.editor = this;
		this.obj.innerHTML = r;
		document.body.appendChild(this.obj);
		this.obj.style.position = "absolute";
		this.obj.className = "dhx_clist";
		this.obj.onclick = function(s) {
			(s || event).cancelBubble = true;
			return true
		};
		var n = this.grid.getPosition(this.cell);
		this.obj.style.left = n[0] + "px";
		this.obj.style.top = n[1] + this.cell.offsetHeight + "px";
		this.obj.getValue = function() {
			var u = "";
			for (var s = 0; s < this.childNodes.length - 1; s++) {
				if (this.childNodes[s].childNodes[0].checked) {
					if (u) {
						u += ", "
					}
					u += this.childNodes[s].childNodes[1].innerHTML
				}
			}
			return u.replace(/&amp;/g, "&")
		}
	};
	this.getValue = function() {
		if (this.cell._clearCell) {
			return ""
		}
		return this.cell.innerHTML.toString()._dhx_trim().replace(/&amp;/g, "&").replace(/, /g, ",")
	};
	this.detach = function(g) {
		if (this.obj) {
			this.setValue(this.obj.getValue());
			this.obj.editor = null;
			this.obj.parentNode.removeChild(this.obj);
			this.obj = null
		}
		return this.val != this.getValue()
	}
}
eXcell_clist.prototype = new eXcell;
eXcell_clist.prototype.setValue = function(g) {
	if (typeof(g) == "object") {
		var c = dhx4.ajax.xpath("./option", g);
		if (c.length) {
			this.cell._combo = []
		}
		for (var a = 0; a < c.length; a++) {
			this.cell._combo.push(c[a].firstChild ? c[a].firstChild.data : "")
		}
		g = g.firstChild.data
	}
	if (g === "" || g === this.undefined) {
		this.setCTxtValue(" ", g);
		this.cell._clearCell = true
	} else {
		g = g.replace(/,[ ]*/g, ", ");
		this.setCTxtValue(g);
		this.cell._clearCell = false
	}
};
dhtmlXGridObject.prototype.registerCList = function(a, c) {
	if (!this.clists) {
		this.clists = new Array()
	}
	if (typeof(c) != "object") {
		c = c.split(",")
	}
	this.clists[a] = c
};

function eXcell_calck(a) {
	try {
		this.cell = a;
		this.grid = this.cell.parentNode.grid
	} catch (c) {}
	this.edit = function() {
		this.val = this.getValue();
		var g = this.grid.getPosition(this.cell);
		this.obj = new calcX(g[0], g[1] + this.cell.offsetHeight, this, this.val)
	};
	this.getValue = function() {
		return this.grid._aplNFb(this.cell.innerHTML.toString()._dhx_trim(), this.cell._cellIndex)
	};
	this.detach = function() {
		if (this.obj) {
			this.setValue(this.obj.inputZone.value);
			this.obj.removeSelf()
		}
		this.obj = null;
		return this.val != this.getValue()
	}
}
eXcell_calck.prototype = new eXcell;
eXcell_calck.prototype.setValue = function(a) {
	if (!a || a.toString()._dhx_trim() == "") {
		a = "0"
	}
	this.setCValue(this.grid._aplNF(a, this.cell._cellIndex), a)
};

function calcX(left, top, onReturnSub, val) {
	this.top = top || 0;
	this.left = left || 0;
	this.onReturnSub = onReturnSub || null;
	this.operandA = 0;
	this.operandB = 0;
	this.operatorA = "";
	this.state = 0;
	this.dotState = 0;
	this.calckGo = function() {
		return (eval(this.operandA + "*1" + this.operatorA + this.operandB + "*1"))
	};
	this.isNumeric = function(str) {
		return ((str.search(/[^1234567890]/gi) == -1) ? (true) : (false))
	};
	this.isOperation = function(str) {
		return ((str.search(/[^\+\*\-\/]/gi) == -1) ? (true) : (false))
	};
	this.onCalcKey = function(e) {
		that = this.calk;
		var z = this.innerHTML;
		var rZone = that.inputZone;
		if (((that.state == 0) || (that.state == 2)) && (that.isNumeric(z))) {
			if (rZone.value != "0") {
				rZone.value += z
			} else {
				rZone.value = z
			}
		}
		if ((((that.state == 0) || (that.state == 2)) && (z == ".")) && (that.dotState == 0)) {
			that.dotState = 1;
			rZone.value += z
		}
		if ((z == "C")) {
			rZone.value = 0;
			that.dotState = 0;
			that.state = 0
		}
		if ((that.state == 0) && (that.isOperation(z))) {
			that.operatorA = z;
			that.operandA = rZone.value;
			that.state = 1
		}
		if ((that.state == 2) && (that.isOperation(z))) {
			that.operandB = rZone.value;
			rZone.value = that.calckGo();
			that.operatorA = z;
			that.operandA = rZone.value;
			that.state = 1
		}
		if ((that.state == 2) && (z == "=")) {
			that.operandB = rZone.value;
			rZone.value = that.calckGo();
			that.operatorA = z;
			that.operandA = rZone.value;
			that.state = 3
		}
		if ((that.state == 1) && (that.isNumeric(z))) {
			rZone.value = z;
			that.state = 2;
			that.dotState = 0
		}
		if ((that.state == 3) && (that.isNumeric(z))) {
			rZone.value = z;
			that.state = 0
		}
		if ((that.state == 3) && (that.isOperation(z))) {
			that.operatorA = z;
			that.operandA = rZone.value;
			that.state = 1
		}
		if (z == "e") {
			rZone.value = Math.E;
			if (that.state == 1) {
				that.state = 2
			}
			that.dotState = 0
		}
		if (z == "p") {
			rZone.value = Math.PI;
			if (that.state == 1) {
				that.state = 2
			}
			that.dotState = 0
		}
		if (z == "Off") {
			that.topNod.parentNode.removeChild(that.topNod)
		}
		if (e || event) {
			(e || event).cancelBubble = true
		}
	};
	this.sendResult = function() {
		that = this.calk;
		if (that.state == 2) {
			var rZone = that.inputZone;
			that.operandB = rZone.value;
			rZone.value = that.calckGo();
			that.operatorA = z;
			that.operandA = rZone.value;
			that.state = 3
		}
		var z = that.inputZone.value;
		that.topNod.parentNode.removeChild(that.topNod);
		that.onReturnSub.grid.editStop(false)
	};
	this.removeSelf = function() {
		if (this.topNod.parentNode) {
			this.topNod.parentNode.removeChild(this.topNod)
		}
	};
	this.keyDown = function() {
		this.className = "calcPressed"
	};
	this.keyUp = function() {
		this.className = "calcButton"
	};
	this.init_table = function() {
		var table = this.topNod.childNodes[0];
		if ((!table) || (table.tagName != "TABLE")) {
			return
		}
		for (i = 1; i < table.childNodes[0].childNodes.length; i++) {
			for (j = 0; j < table.childNodes[0].childNodes[i].childNodes.length; j++) {
				table.childNodes[0].childNodes[i].childNodes[j].onclick = this.onCalcKey;
				table.childNodes[0].childNodes[i].childNodes[j].onmousedown = this.keyDown;
				table.childNodes[0].childNodes[i].childNodes[j].onmouseout = this.keyUp;
				table.childNodes[0].childNodes[i].childNodes[j].onmouseup = this.keyUp;
				table.childNodes[0].childNodes[i].childNodes[j].calk = this
			}
		}
		this.inputZone = this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0];
		if (this.onReturnSub) {
			this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[1].onclick = this.sendResult;
			this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[1].calk = this
		} else {
			this.topNod.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[1].innerHTML = ""
		}
	};
	this.drawSelf = function() {
		var div = document.createElement("div");
		div.className = "calcTable";
		div.style.position = "absolute";
		div.style.top = this.top + "px";
		div.style.left = this.left + "px";
		div.innerHTML = "<table cellspacing='0' id='calc_01' class='calcTable'><tr><td colspan='4'><table cellpadding='1' cellspacing='0' width='100%'><tr><td width='100%' style='overflow:hidden;'><input style='width:100%' class='calcInput' value='0' align='right' readonly='true' style='text-align:right'></td><td class='calkSubmit'>=</td></tr></table></td></tr><tr><td class='calcButton' width='25%'>Off</td><td class='calcButton' width='25%'>p</td><td class='calcButton' width='25%'>e</td><td class='calcButton' width='25%'>/</td></tr><tr><td class='calcButton'>7</td><td class='calcButton'>8</td><td class='calcButton'>9</td><td class='calcButton'>*</td></tr><tr><td class='calcButton'>4</td><td class='calcButton'>5</td><td class='calcButton'>6</td><td class='calcButton'>+</td></tr><tr><td class='calcButton'>1</td><td class='calcButton'>2</td><td class='calcButton'>3</td><td class='calcButton'>-</td></tr><tr><td class='calcButton'>0</td><td class='calcButton'>.</td><td class='calcButton'>C</td><td class='calcButton'>=</td></tr></table>";
		div.onclick = function(e) {
			(e || event).cancelBubble = true
		};
		document.body.appendChild(div);
		this.topNod = div
	};
	this.drawSelf();
	this.init_table();
	if (val) {
		var rZone = this.inputZone;
		rZone.value = val * 1;
		this.operandA = val * 1;
		this.state = 3
	}
	return this
}
dhtmlXGridObject.prototype._updateTGRState = function(a) {
	if (!a.update || a.id == 0) {
		return
	}
	if (this.rowsAr[a.id].imgTag) {
		this.rowsAr[a.id].imgTag.src = this.iconTree + a.state + ".gif"
	}
	a.update = false
};
dhtmlXGridObject.prototype.doExpand = function(c) {
	this.editStop();
	var g = c.parentNode.parentNode.parentNode;
	var a = this._h2.get[g.idd];
	if (!this.callEvent("onOpen", [g.idd, (a.state == "plus" ? -1 : 1)])) {
		return
	}
	if (a.state == "plus") {
		this.expandKids(g)
	} else {
		if ((a.state == "minus") && (!a._closeable)) {
			this.collapseKids(g)
		}
	}
};
dhtmlXGridObject.prototype._createHierarchy = function() {
	if (!this._emptyLineImg) {
		this._emptyLineImg = "blank"
	}
	return new dhtmlxHierarchy({
		_emptyLineImg: this._emptyLineImg
	})
};

function dhtmlxHierarchy(a) {
	var c = {
		id: 0,
		childs: [],
		level: -1,
		parent: null,
		index: 0,
		state: a._emptyLineImg
	};
	this.order = [c];
	this.get = {
		"0": c
	};
	this.swap = function(l, g) {
		var m = l.parent;
		var n = l.index;
		m.childs[n] = g;
		m.childs[g.index] = l;
		l.index = g.index;
		g.index = n
	};
	this.forEachChildF = function(q, g, n, l) {
		var o = this.get[q];
		for (var m = 0; m < o.childs.length; m++) {
			if (!g.apply((n || this), [o.childs[m]])) {
				continue
			}
			if (o.childs[m].childs.length) {
				this.forEachChildF(o.childs[m].id, g, n, l)
			}
			if (l) {
				l.call((n || this), o.childs[m])
			}
		}
	};
	this.forEachChild = function(o, g, m) {
		var n = this.get[o];
		for (var l = 0; l < n.childs.length; l++) {
			g.apply((m || this), [n.childs[l]]);
			if (n.childs[l].childs.length) {
				this.forEachChild(n.childs[l].id, g, m)
			}
		}
	};
	this.change = function(n, g, m) {
		var l = this.get[n];
		if (l[g] == m) {
			return
		}
		l[g] = m;
		l.update = true
	};
	this.add = function(l, g) {
		return this.addAfter(l, g)
	};
	this.addAfter = function(s, r, m, l) {
		var q = this.get[r || 0];
		if (m) {
			var o = this.get[m].index + (l ? 0 : 1)
		} else {
			var o = q.childs.length
		}
		var g = {
			id: s,
			childs: [],
			level: q.level + 1,
			parent: q,
			index: o,
			state: a._emptyLineImg
		};
		if (q.state == a._emptyLineImg) {
			this.change(r, "state", (r == 0 ? "minus" : "plus"))
		}
		if (m) {
			for (var n = o; n < q.childs.length; n++) {
				q.childs[n].index++
			}
			q.childs = q.childs.slice(0, o).concat([g]).concat(q.childs.slice(o, q.childs.length))
		} else {
			q.childs.push(g)
		}
		this.get[s] = g;
		return g
	};
	this.addBefore = function(m, l, g) {
		return this.addAfter(m, l, g, true)
	};
	this.remove = function(m) {
		var l = this.get[m || 0];
		for (var g = 0; g < l.childs.length; g++) {
			this.deleteAll(l.childs[g].id)
		}
		l.childs = [];
		l.parent.childs = l.parent.childs.slice(0, l.index).concat(l.parent.childs.slice(l.index + 1));
		for (var g = l.index; g < l.parent.childs.length; g++) {
			l.parent.childs[g].index--
		}
		delete this.get[m]
	};
	this.deleteAll = function(m) {
		var l = this.get[m || 0];
		for (var g = 0; g < l.childs.length; g++) {
			this.deleteAll(l.childs[g].id)
		}
		l.childs = [];
		delete this.get[m]
	};
	return this
}
dhtmlXGridObject.prototype._getOpenLenght = function(l, g) {
	var c = this._h2.get[l].childs;
	g += c.length;
	for (var a = 0; a < c.length; a++) {
		if (c[a].childs.length && c[a].state == "minus") {
			g += this._getOpenLenght(c[a].id, 0)
		}
	}
	return g
};
dhtmlXGridObject.prototype.collapseKids = function(g) {
	var l = this._h2.get[g.idd];
	if (l.state != "minus") {
		return
	}
	if (!this.callEvent("onOpenStart", [g.idd, 1])) {
		return
	}
	var m = g.rowIndex;
	if (m < 0) {
		m = this.rowsCol._dhx_find(g) + 1
	}
	this._h2.change(l.id, "state", "plus");
	this._updateTGRState(l);
	if (this._srnd || this.pagingOn) {
		this._h2_to_buff();
		this._renderSort()
	} else {
		var a = this._getOpenLenght(this.rowsCol[m - 1].idd, 0);
		for (var c = 0; c < a; c++) {
			this.rowsCol[m + c].parentNode.removeChild(this.rowsCol[m + c])
		}
		this.rowsCol.splice(m, a)
	}
	this.callEvent("onGridReconstructed", []);
	this.setSizes();
	this._h2_to_buff();
	this.callEvent("onOpenEnd", [g.idd, -1])
};
dhtmlXGridObject.prototype._massInsert = function(a, g, l, s) {
	var m = [];
	var q = (_isKHTML ? this.obj : this.obj.rows[0].parentNode);
	this._h2_to_buff();
	if (this._srnd || this.pagingOn) {
		return this._renderSort()
	}
	var o = this._getOpenLenght(a.id, 0);
	for (var n = 0; n < o; n++) {
		var c = this.render_row(l + n);
		if (g) {
			g.parentNode.insertBefore(c, g)
		} else {
			q.appendChild(c)
		}
		m.push(c)
	}
	this.rowsCol = dhtmlxArray(this.rowsCol.slice(0, l).concat(m).concat(this.rowsCol.slice(l)));
	return a.childs.length + m.length
};
dhtmlXGridObject.prototype.expandKids = function(c, m) {
	var g = this._h2.get[c.idd];
	if ((!g.childs.length) && (!g._xml_await)) {
		return
	}
	if (g.state != "plus") {
		return
	}
	if (!g._loading && !m) {
		if (!this.callEvent("onOpenStart", [g.id, -1])) {
			return
		}
	}
	var l = this.getRowIndex(g.id) + 1;
	if (g.childs.length) {
		g._loading = false;
		this._h2.change(g.id, "state", "minus");
		this._updateTGRState(g);
		var a = this._massInsert(g, this.rowsCol[l], l);
		this.callEvent("onGridReconstructed", [])
	} else {
		if (g._xml_await) {
			g._loading = true;
			if (this.callEvent("onDynXLS", [g.id])) {
				this.load(this.kidsXmlFile + "" + (this.kidsXmlFile.indexOf("?") != -1 ? "&" : "?") + "id=" + encodeURIComponent(g.id), this._data_type)
			}
		}
	}
	this.setSizes();
	if (!g._loading) {
		this.callEvent("onOpenEnd", [g.id, 1])
	}
	this._fixAlterCss()
};
dhtmlXGridObject.prototype.kidsXmlFile = "";
dhtmlXGridObject.prototype.sortTreeRows = function(l, m, a) {
	var n = "getValue";
	if (this.cells5({
			parentNode: {
				grid: this
			}
		}, this.getColType(l)).getDate) {
		n = "getDate";
		m = "str"
	}
	this.forEachRow(function(u) {
		var s = this._h2.get[u];
		if (!s) {
			return
		}
		var r = this._get_cell_value(s.buff, l, n);
		if (m == "int") {
			s._sort = parseFloat(r);
			s._sort = isNaN(s._sort) ? -99999999999999 : s._sort
		} else {
			s._sort = r
		}
	});
	var g = this;
	var q = 1;
	var o = -1;
	if (a == "des") {
		q = -1;
		o = 1
	}
	var c = null;
	if (typeof m == "function") {
		c = function(s, r) {
			return m(s._sort, r._sort, a, s.id, r.id)
		}
	} else {
		if (m == "cus") {
			c = function(s, r) {
				return g._customSorts[l](s._sort, r._sort, a, s.id, r.id)
			}
		}
		if (m == "str") {
			c = function(s, r) {
				return (s._sort < r._sort ? o : (s._sort == r._sort ? 0 : q))
			}
		}
		if (m == "int") {
			c = function(s, r) {
				return (s._sort < r._sort ? o : (s._sort == r._sort ? 0 : q))
			}
		}
		if (m == "date") {
			c = function(s, r) {
				return (Date.parse(new Date(s._sort || "01/01/1900")) - Date.parse(new Date(r._sort || "01/01/1900"))) * q
			}
		}
	}
	this._sortTreeRows(c, 0);
	this._renderSort(0, true);
	this.callEvent("onGridReconstructed", [])
};
dhtmlXGridObject.prototype._sortTreeRows = function(a, l) {
	var c = this._h2.get[l].childs;
	if (this.rowsCol.stablesort) {
		this.rowsCol.stablesort.call(c, a)
	} else {
		c.sort(a)
	}
	for (var g = 0; g < c.length; g++) {
		if (c[g].childs.length) {
			this._sortTreeRows(a, c[g].id)
		}
		c[g].index = g
	}
};
dhtmlXGridObject.prototype._renderSort = function(g, c) {
	this._h2_to_buff();
	var a = this.objBox.scrollTop;
	this._reset_view();
	this.objBox.scrollTop = a
};
dhtmlXGridObject.prototype._fixAlterCssTGR = function() {
	if (!this._realfake) {
		this._h2.forEachChild(0, function(a) {
			if (a.buff.tagName == "TR") {
				var c = (this._cssSP ? (a.level % 2) : (a.index % 2)) ? this._cssUnEven : this._cssEven;
				if(this.rowsAr[a.id]!=null){
					this.rowsAr[a.id].className = (c + (this._cssSU ? (" " + c + "_" + a.level) : "")) + " " + (this.rowsAr[a.id]._css || "") + ((this.rowsAr[a.id].className.indexOf("rowselected") != -1) ? " rowselected" : "")
				}
				
			}
		}, this)
	}
};
dhtmlXGridObject.prototype.moveRowUDTG = function(c, m) {
	var q = this._h2.get[c];
	var g = q.parent.childs[q.index + m];
	if ((!g) || (g.parent != q.parent)) {
		return
	}
	var a = [q.state, g.state];
	this.collapseKids(this.rowsAr[q.id]);
	this.collapseKids(this.rowsAr[g.id]);
	var l = this.rowsCol._dhx_find(this.rowsAr[c]);
	var o = this.rowsBuffer._dhx_find(this.rowsAr[c]);
	var r = this.obj.rows[0].parentNode.removeChild(this.rowsCol[l]);
	var n = this.rowsCol[l + ((m == 1) ? 2 : m)];
	if (n) {
		n.parentNode.insertBefore(r, n)
	} else {
		this.obj.rows[0].parentNode.appendChild(r)
	}
	this.rowsCol._dhx_swapItems(l, l + m);
	this.rowsBuffer._dhx_swapItems(o, o + m);
	this._h2.swap(g, q);
	if (a[0] == "minus") {
		this.expandKids(this.rowsAr[q.id])
	}
	if (a[1] == "minus") {
		this.expandKids(this.rowsAr[g.id])
	}
	this._fixAlterCss(Math.min(l, l + m))
};

function eXcell_tree(a) {
	if (a) {
		this.cell = a;
		this.grid = this.cell.parentNode.grid
	}
	this.isDisabled = function() {
		return this.cell._disabled || this.grid._edtc
	};
	this.edit = function() {
		if ((this.er) || (this.grid._edtc)) {
			return
		}
		this.er = this.cell.parentNode.valTag;
		this.val = this.getLabel();
		this.cell.atag = ((!this.grid.multiLine) && (_isKHTML || _isMacOS || _isFF)) ? "INPUT" : "TEXTAREA";
		this.er.innerHTML = "<" + this.cell.atag + " class='dhx_combo_edit' type='text' style='height:" + (this.cell.offsetHeight - 4) + "px;line-height:" + (this.cell.offsetHeight - 6) + "px; width:100%; border:0px; margin:0px; padding:0px; overflow:hidden;'></" + this.cell.atag + ">";
		this.er.childNodes[0].onmousedown = function(c) {
			(c || event).cancelBubble = true
		};
		this.er.childNodes[0].onselectstart = function(c) {
			if (!c) {
				c = event
			}
			c.cancelBubble = true;
			return true
		};
		this.er.className += " editable";
		this.er.firstChild.onclick = function(c) {
			(c || event).cancelBubble = true
		};
		this.er.firstChild.value = this.val;
		this.obj = this.er.firstChild;
		this.er.firstChild.style.width = Math.max(0, this.cell.offsetWidth - this.er.offsetLeft - 2) + "px";
		this.er.firstChild.focus();
		if (_isIE) {
			this.er.firstChild.focus()
		}
	};
	this.detach = function() {
		if (!this.er) {
			return
		}
		this.setLabel(this.er.firstChild.value);
		this.er.className = this.er.className.replace("editable", "");
		var c = (this.val != this.er.innerHTML);
		this.obj = this.er = null;
		return (c)
	};
	this.getValue = function() {
		return this.getLabel()
	};
	this.setImage = function(c) {
		this.cell.parentNode.imgTag.nextSibling.src = this.grid.iconURL + c;
		this.grid._h2.get[this.cell.parentNode.idd].image = c
	};
	this.getImage = function() {
		return this.grid._h2.get[this.cell.parentNode.idd].image
	};
	this.setLabel = function(c) {
		this.setValueA(c)
	};
	this.getLabel = function(c) {
		return this.cell.parentNode.valTag.innerHTML
	}
}
eXcell_tree.prototype = new eXcell;
eXcell_tree.prototype.setValueA = function(a) {
	this.cell.parentNode.valTag.innerHTML = a;
	this.grid.callEvent("onCellChanged", [this.cell.parentNode.idd, this.cell._cellIndex, a])
};
eXcell_tree.prototype.setValue = function(a) {
	if (this.cell.parentNode.imgTag) {
		return this.setLabel(a)
	}
	if ((this.grid._tgc.iconTree == null) || (this.grid._tgc.iconTree != this.grid.iconTree)) {
		var m = {};
		m.spacer = "<img src='" + this.grid.iconTree + "blank.gif'  align='top' class='space'>";
		m.imst = "<img class='treegrid_cell_itemimg_tree' style='margin-top:-2px;' src='" + this.grid.iconTree;
		//modify code by zzm 20160827
		m.imsti = "<img class='treegrid_cell_itemimg' style='padding-top:2px;'  src='" + (this.grid.iconURL || this.grid.iconTree);
		m.imact = "' class='treegrid_cell_itemimg_head' align='top' onclick='this." + (_isKHTML ? "" : "parentNode.") + "parentNode.parentNode.parentNode.parentNode.grid.doExpand(this);event.cancelBubble=true;'>";
		m.plus = m.imst + "plus.gif" + m.imact;
		m.minus = m.imst + "minus.gif" + m.imact;
		m.blank = m.imst + "blank.gif" + m.imact;
		m.start = "<div class='treegrid_cell' style='overflow:hidden; white-space : nowrap; line-height:23px; height:" + (_isIE ? 21 : 23) + "px;'>";
		m.itemim = "' align='top' " + (this.grid._img_height ? (' height="' + this.grid._img_height + '"') : "") + (this.grid._img_width ? (' width="' + this.grid._img_width + '"') : "") + " ><span id='nodeval'>";
		m.close = "</span></div>";
		this.grid._tgc = m
	}
	var n = this.grid._h2;
	var m = this.grid._tgc;
	var l = this.cell.parentNode.idd;
	var o = this.grid._h2.get[l];
	if (this.grid.kidsXmlFile || this.grid._slowParse) {
		o.has_kids = (o.has_kids || (this.cell.parentNode._attrs.xmlkids && (o.state != "minus")));
		o._xml_await = !!o.has_kids
	}
	o.image = o.image || (this.cell._attrs.image || "leaf.gif");
	o.label = a;
	var g = [m.start];
	for (var c = 0; c < o.level; c++) {
		g.push(m.spacer)
	}
	if (o.has_kids) {
		g.push(m.plus);
		o.state = "plus"
	} else {
		g.push(m.imst + o.state + ".gif" + m.imact)
	}
	g.push(m.imsti);
	g.push(o.image);
	g.push(m.itemim);
	g.push(o.label);
	g.push(m.close);
	this.cell.innerHTML = g.join("");
	this.cell._treeCell = true;
	this.cell.parentNode.imgTag = this.cell.childNodes[0].childNodes[o.level];
	this.cell.parentNode.valTag = this.cell.childNodes[0].childNodes[o.level + 2];
	if (_isKHTML) {
		this.cell.vAlign = "top"
	}
	if (o.parent.id != 0 && o.parent.state == "plus") {
		this.grid._updateTGRState(o.parent, false);
		this.cell.parentNode._skipInsert = true
	}
	this.grid.callEvent("onCellChanged", [l, this.cell._cellIndex, a])
};
dhtmlXGridObject.prototype._process_tree_xml = function(n, c) {
	this._parsing = true;
	var a = false;
	if (!c) {
		this.render_row = this.render_row_tree;
		a = true;
		c = n.getAttribute("parent") || 0;
		if (c == "0") {
			c = 0
		}
		if (!this._h2) {
			this._h2 = this._createHierarchy()
		}
		if (this._fake) {
			this._fake._h2 = this._h2
		}
	}
	var m = dhx4.ajax.xpath(this.xml.row, n);
	this._open = this._open || [];
	for (var g = 0; g < m.length; g++) {
		var q = m[g].getAttribute("id");
		if (!q) {
			q = this.uid();
			m[g].setAttribute("id", q)
		}
		var o = this._h2.add(q, c);
		o.buff = {
			idd: q,
			data: m[g],
			_parser: this._process_xml_row,
			_locator: this._get_xml_data
		};
		if (m[g].getAttribute("open")) {
			o.state = "minus";
			this._open.push(q)
		}
		this.rowsAr[q] = o.buff;
		this._process_tree_xml(m[g], q)
	}
	if (a) {
		if (!m.length) {
			this._h2.change(c, "state", this._emptyLineImg)
		} else {
			if (c != 0 && !this._srnd) {
				this._h2.change(c, "state", "minus")
			}
		}
		for (var g = 0; g < this._open.length; g++) {
			var l = this._h2.get[this._open[g]];
			if (!l.childs.length) {
				l.state = this._emptyLineImg
			}
		}
		this._updateTGRState(this._h2.get[c]);
		this._h2_to_buff();
		if (c != 0 && this._srnd) {
			this.openItem(c)
		} else {
			if (this.pagingOn) {
				this._renderSort()
			} else {
				this.render_dataset()
			}
		}
		if (this.kidsXmlFile) {
			for (var g = 0; g < this._open.length; g++) {
				var l = this._h2.get[this._open[g]];
				if (l._xml_await) {
					this.expandKids({
						idd: l.id
					})
				}
			}
		}
		this._open = [];
		if (this._slowParse === false) {
			this.forEachRow(function(r) {
				this.render_row_tree(0, r)
			})
		}
		this._parsing = false;
		if (c != 0 && !this._srnd) {
			this.callEvent("onOpenEnd", [c, 1])
		}
	}
};
dhtmlXGridObject.prototype._h2_to_buff = function(c) {
	if (!c) {
		c = this._h2.get[0];
		this.rowsBuffer = new dhtmlxArray();
		if (this._fake && !this._realfake) {
			this._fake.rowsBuffer = this.rowsBuffer
		}
	}
	for (var a = 0; a < c.childs.length; a++) {
		this.rowsBuffer.push(c.childs[a].buff);
		if (c.childs[a].state == "minus") {
			this._h2_to_buff(c.childs[a])
		}
	}
};
dhtmlXGridObject.prototype.render_row_tree = function(c, l) {
	if (l) {
		var a = this._h2.get[l];
		a = a ? a.buff : a
	} else {
		var a = this.rowsBuffer[c]
	}
	if (!a) {
		return -1
	}
	if (a._parser) {
		if (this.rowsAr[a.idd] && this.rowsAr[a.idd].tagName == "TR") {
			return this._h2.get[a.idd].buff = this.rowsBuffer[c] = this.rowsAr[a.idd]
		}
		var g = this._prepareRow(a.idd);
		this.rowsAr[a.idd] = g;
		if (!l) {
			this.rowsBuffer[c] = g
		}
		this._h2.get[a.idd].buff = g;
		a._parser.call(this, g, a.data);
		this._postRowProcessing(g);
		return g
	}
	return a
};
dhtmlXGridObject.prototype._removeTrGrRow = function(l, c) {
	if (c) {
		this._h2.forEachChild(c.id, function(n) {
			this._removeTrGrRow(null, n);
			delete this.rowsAr[n.id]
		}, this);
		return
	}
	var m = this.getRowIndex(l.idd);
	var c = this._h2.get[l.idd];
	if (m != -1 && m !== this.undefined) {
		var a = 1;
		if (c && c.state == "minus") {
			a += this._getOpenLenght(c.id, 0)
		}
		for (var g = 0; g < a; g++) {
			if (this.rowsCol[g + m]) {
				this.rowsCol[g + m].parentNode.removeChild(this.rowsCol[g + m])
			}
		}
		if (this._fake) {
			for (var g = 0; g < a; g++) {
				if (this._fake.rowsCol[g + m]) {
					this._fake.rowsCol[g + m].parentNode.removeChild(this._fake.rowsCol[g + m])
				}
			}
			if (a > 1) {
				this._fake.rowsCol.splice(m + 1, a - 1)
			}
		}
		this.rowsCol.splice(m, a);
		this.rowsBuffer.splice(m, a)
	}
	if (!c) {
		return
	}
	this._removeTrGrRow(null, c);
	delete this.rowsAr[c.id];
	if (c.parent.childs.length == 1) {
		this._h2.change(c.parent.id, "state", this._emptyLineImg);
		this._updateTGRState(c.parent)
	}
	this._h2.remove(c.id)
};
dhtmlXGridObject.prototype.openItem = function(c) {
	var g = this._h2.get[c || 0];
	var a = this.getRowById(c || 0);
	if (!a) {
		return
	}
	if (g.parent && g.parent.id != 0) {
		this.openItem(g.parent.id)
	}
	this.expandKids(a)
};
dhtmlXGridObject.prototype._addRowClassic = dhtmlXGridObject.prototype.addRow;
dhtmlXGridObject.prototype.addRow = function(c, o, m, l, a, q) {
	if (!this._h2) {
		return this._addRowClassic(c, o, m)
	}
	l = l || 0;
	var g = this.cellType._dhx_find("tree");
	if (typeof(o) == "string") {
		o = o.split(this.delim)
	}
	var n = this._h2.get[c];
	if (!n) {
		if (l == 0) {
			m = this.rowsBuffer.length
		} else {
			m = this.getRowIndex(l) + 1;
			if (this._h2.get[l].state == "minus") {
				m += this._getOpenLenght(l, 0)
			} else {
				this._skipInsert = true
			}
		}
	}
	n = n || this._h2.add(c, l);
	n.image = a;
	n.has_kids = q;
	return n.buff = this._addRowClassic(c, o, m)
};
dhtmlXGridObject.prototype.addRowBefore = function(g, n, l, c, q) {
	var o = this.rowsAr[l];
	if (!o) {
		return
	}
	if (!this._h2) {
		return this.addRow(g, n, this.getRowIndex(l))
	}
	var a = this._h2.get[l].parent.id;
	var m = this.getRowIndex(l);
	if (m == -1) {
		this._skipInsert = true
	}
	this._h2.addBefore(g, a, l);
	return this.addRow(g, n, m, this._h2.get[l].parent.id, c, q)
};
dhtmlXGridObject.prototype.addRowAfter = function(g, n, l, c, q) {
	var o = this.rowsAr[l];
	if (!o) {
		return
	}
	if (!this._h2) {
		return this.addRow(g, n, this.getRowIndex(l) + 1)
	}
	var a = this._h2.get[l].parent.id;
	var m = this.getRowIndex(l);
	if (m == -1) {
		this._skipInsert = true
	}
	if (this._h2.get[l].state == "minus") {
		m += this._getOpenLenght(l, 0) + 1
	} else {
		m++
	}
	this._h2.addAfter(g, a, l);
	return this.addRow(g, n, m, a, c, q)
};
dhtmlXGridObject.prototype.enableSmartXMLParsing = function(a) {
	this._slowParse = dhx4.s2b(a)
};
dhtmlXGridObject.prototype._copyTreeGridRowContent = function(a, c, g) {
	var l = this.cellType._dhx_find("tree");
	for (i = 0; i < a.cells.length; i++) {
		if (i != l) {
			this.cells(g, i).setValue(this.cells(c, i).getValue())
		} else {
			this.cells(g, i).setValueA(this.cells(c, i).getValue())
		}
	}
};
dhtmlXGridObject.prototype.closeItem = function(c) {
	var a = this.getRowById(c);
	if (!a) {
		return
	}
	this.collapseKids(a)
};
dhtmlXGridObject.prototype.deleteChildItems = function(a) {
	var c = this._h2.get[a];
	if (!c) {
		return
	}
	while (c.childs.length) {
		this.deleteRow(c.childs[0].id)
	}
};
dhtmlXGridObject.prototype.getAllSubItems = function(c) {
	var l = [];
	var g = this._h2.get[c || 0];
	if (g) {
		for (var a = 0; a < g.childs.length; a++) {
			l.push(g.childs[a].id);
			if (g.childs[a].childs.length) {
				l = l.concat(this.getAllSubItems(g.childs[a].id).split(this.delim))
			}
		}
	}
	return l.join(this.delim)
};
dhtmlXGridObject.prototype.getChildItemIdByIndex = function(c, a) {
	var g = this._h2.get[c || 0];
	if (!g) {
		return null
	}
	return (g.childs[a] ? g.childs[a].id : null)
};
dhtmlXGridObject.prototype.getItemText = function(a) {
	return this.cells(a, this.cellType._dhx_find("tree")).getLabel()
};
dhtmlXGridObject.prototype.getOpenState = function(a) {
	var c = this._h2.get[a || 0];
	if (!c) {
		return
	}
	if (c.state == "minus") {
		return true
	}
	return false
};
dhtmlXGridObject.prototype.getParentId = function(a) {
	var c = this._h2.get[a || 0];
	if ((!c) || (!c.parent)) {
		return null
	}
	return c.parent.id
};
dhtmlXGridObject.prototype.getSubItems = function(c) {
	var l = [];
	var g = this._h2.get[c || 0];
	if (g) {
		for (var a = 0; a < g.childs.length; a++) {
			l.push(g.childs[a].id)
		}
	}
	return l.join(this.delim)
};
dhtmlXGridObject.prototype.expandAll = function(a) {
	this._renderAllExpand(a || 0);
	this._h2_to_buff();
	this._reset_view();
	this.setSizes();
	this.callEvent("onGridReconstructed", []);
	if (this._redrawLines) {
		this._redrawLines()
	}
};
dhtmlXGridObject.prototype._renderAllExpand = function(g) {
	var a = this._h2.get[g].childs;
	for (var c = 0; c < a.length; c++) {
		if (a[c].childs.length) {
			this._h2.change(a[c].id, "state", "minus");
			this._updateTGRState(a[c]);
			this._renderAllExpand(a[c].id)
		}
	}
};
dhtmlXGridObject.prototype.collapseAll = function(a) {
	this._h2.forEachChild((a || 0), function(c) {
		if (c && c.state == "minus") {
			c.state = "plus";
			c.update = true;
			this._updateTGRState(c)
		}
	}, this);
	this._h2_to_buff();
	this._reset_view();
	this.setSizes();
	this.callEvent("onGridReconstructed", []);
	if (this._redrawLines) {
		this._redrawLines()
	}
};
dhtmlXGridObject.prototype.hasChildren = function(c) {
	var a = this._h2.get[c];
	if (a && a.childs.length) {
		return a.childs.length
	}
	if (a._xml_await) {
		return -1
	}
	return 0
};
dhtmlXGridObject.prototype.setItemCloseable = function(g, c) {
	var a = this._h2.get[g];
	if (!a) {
		return
	}
	a._closeable = (!dhx4.s2b(c))
};
dhtmlXGridObject.prototype.setItemText = function(a, c) {
	return this.cells(a, this.cellType._dhx_find("tree")).setLabel(c)
};
dhtmlXGridObject.prototype.setItemImage = function(c, a) {
	this._h2.get[c].image = a;
	this.rowsAr[c].imgTag.nextSibling.src = (this.iconURL || "") + a
};
dhtmlXGridObject.prototype.getItemImage = function(a) {
	this.getRowById(a);
	return this._h2.get[a].image
};
dhtmlXGridObject.prototype.setImageSize = function(c, a) {
	this._img_width = c;
	this._img_height = a
};
dhtmlXGridObject.prototype._getRowImage = function(a) {
	return this._h2.get[a.idd].image
};
dhtmlXGridObject.prototype.setOnOpenStartHandler = function(a) {
	this.attachEvent("onOpenStart", a)
};
dhtmlXGridObject.prototype.setOnOpenEndHandler = function(a) {
	this.attachEvent("onOpenEnd", a)
};
dhtmlXGridObject.prototype.enableTreeCellEdit = function(a) {
	this._edtc = !dhx4.s2b(a)
};
dhtmlXGridObject.prototype.getLevel = function(a) {
	var c = this._h2.get[a || 0];
	if (!c) {
		return -1
	}
	return c.level
};
dhtmlXGridObject.prototype._fixHiddenRowsAllTG = function(c, a) {
	for (i in this.rowsAr) {
		if ((this.rowsAr[i]) && (this.rowsAr[i].childNodes)) {
			this.rowsAr[i].childNodes[c].style.display = a
		}
	}
};
dhtmlXGridObject.prototype._updateLine = function(g, c) {
	c = c || this.rowsAr[g.id];
	if (!c) {
		return
	}
	var a = c.imgTag;
	if (!a) {
		return
	}
	if (g.state == "blank") {
		return a.src = this.iconTree + "blank.gif"
	}
	var l = 1;
	if (g.index == 0) {
		if (g.level == 0) {
			if ((g.parent.childs.length - 1) > g.index) {
				l = 3
			} else {
				l = 1
			}
		} else {
			if ((g.parent.childs.length - 1) > g.index) {
				l = 3
			} else {
				l = 2
			}
		}
	} else {
		if ((g.parent.childs.length - 1) > g.index) {
			l = 3
		} else {
			l = 2
		}
	}
	a.src = this.iconTree + g.state + l + ".gif"
};
dhtmlXGridObject.prototype._updateParentLine = function(l, g) {
	g = g || this.rowsAr[l.id];
	if (!g) {
		return
	}
	var a = g.imgTag;
	if (!a) {
		return
	}
	for (var c = l.level; c > 0; c--) {
		if (l.id == 0) {
			break
		}
		a = a.previousSibling;
		l = l.parent;
		if ((l.parent.childs.length - 1) > l.index) {
			a.src = this.iconTree + "line1.gif"
		} else {
			a.src = this.iconTree + "blank.gif"
		}
	}
};
dhtmlXGridObject.prototype._renderSortA = dhtmlXGridObject.prototype._renderSort;
dhtmlXGridObject.prototype._renderSort = function() {
	this._renderSortA.apply(this, arguments);
	this._redrawLines(0)
};
dhtmlXGridObject.prototype._redrawLines = function(a) {
	if (this._tgle) {
		this._h2.forEachChild((a || 0), function(c) {
			this._updateLine(c);
			this._updateParentLine(c)
		}, this)
	}
};
dhtmlXGridObject.prototype.enableTreeGridLines = function() {
	this._emptyLineImg = "line";
	this._updateTGRState = function(c, a) {
		if (a || !c.update || c.id == 0) {
			return
		}
		if (this._tgle) {
			this._updateLine(c, this.rowsAr[c.id])
		}
		c.update = false
	};
	this._tgle = true;
	this.attachEvent("onXLE", function(g, c, l) {
		this._redrawLines(l)
	});
	this.attachEvent("onOpenEnd", function(a) {
		this._redrawLines(a)
	});
	this.attachEvent("onRowAdded", function(c) {
		var a = this._h2.get[c];
		this._updateLine(a);
		this._updateParentLine(a);
		if (a.index < (a.parent.childs.length - 1)) {
			a = a.parent.childs[a.index + 1];
			this._updateLine(a);
			this._updateParentLine(a)
		} else {
			if (a.index != 0) {
				a = a.parent.childs[a.index - 1];
				this._updateLine(a);
				this._updateParentLine(a);
				if (a.childs.length) {
					this._h2.forEachChild(a.id, function(g) {
						this._updateParentLine(g)
					}, this)
				}
			}
		}
	});
	this.attachEvent("onOpen", function(l, c) {
		if (c) {
			var g = this._h2.get[l];
			for (var a = 0; a < g.childs.length; a++) {
				this._updateParentLine(g.childs[a])
			}
		}
		return true
	});
	this.attachEvent("onBeforeRowDeleted", function(l) {
		var c = this;
		var g = this._h2.get[l];
		var a = null;
		if (g.index != 0) {
			a = g.parent.childs[g.index - 1]
		}
		g = g.parent;
		window.setTimeout(function() {
			g = c._h2.get[g.id];
			if (!g) {
				return
			}
			c._updateLine(g);
			c._updateParentLine(g);
			if (a) {
				c._updateLine(a);
				if (a.state == "minus") {
					c._h2.forEachChild(a.id, function(m) {
						c._updateParentLine(m)
					}, c)
				}
			}
		}, 1);
		return true
	})
};
dhtmlXGridObject.prototype.setFiltrationLevel = function(g, a, c) {
	this._tr_strfltr = g;
	this._tr_fltr_c = a;
	this._tr_fltr_d = c;
	this.refreshFilters()
};
dhtmlXGridObject.prototype.filterTreeBy = function(l, m, g) {
	var a = this._h2;
	if (typeof this._tr_strfltr == "undefined") {
		this._tr_strfltr = -1
	}
	if (this._f_rowsBuffer) {
		if (!g) {
			this._h2 = this._f_rowsBuffer;
			if (this._fake) {
				this._fake._h2 = this._h2
			}
		}
	} else {
		this._f_rowsBuffer = this._h2
	}
	var n = true;
	this.dma(true);
	this._fbf = {};
	if (typeof(l) == "object") {
		for (var c = 0; c < m.length; c++) {
			this._filterTreeA(l[c], m[c])
		}
	} else {
		this._filterTreeA(l, m)
	}
	this._fbf = null;
	this.dma(false);
	this._fix_filtered_images(this._h2, a);
	this._renderSort();
	this.callEvent("onGridReconstructed", [])
};
dhtmlXGridObject.prototype._filterTreeA = function(g, r) {
	if (r == "") {
		return
	}
	var o = true;
	if (typeof(r) == "function") {
		o = false
	} else {
		r = (r || "").toString().toLowerCase()
	}
	var c = function(w, v, u) {
		var x = u.get[w.parent.id];
		if (!x) {
			x = c(w.parent, v, u)
		}
		var u = s.get[w.id];
		if (!u) {
			u = {
				id: w.id,
				childs: [],
				level: w.level,
				parent: x,
				index: x.childs.length,
				image: w.image,
				state: w.state,
				buff: w.buff,
				has_kids: w.has_kids,
				_xml_await: w._xml_await
			};
			x.childs.push(u);
			s.get[u.id] = u
		}
		return u
	};
	var q = this._fbf;
	var s = this._createHierarchy();
	var a;
	var m = this._tr_strfltr;
	var n = this;
	var l = function(v) {
		for (var u = 0; u < v.childs.length; u++) {
			n.temp(v.childs[u])
		}
	};
	switch (m.toString()) {
		case "-2":
			a = function(u) {
				if (q[u.id]) {
					return false
				}
				l(u);
				return true
			};
			break;
		case "-1":
			a = function(u) {
				return !u.childs.length
			};
			break;
		default:
			a = function(u) {
				return m == u.level
			};
			break
	}
	this.temp = function(u) {
		if (u.id != 0 && a(u)) {
			if (o ? (this._get_cell_value(u.buff, g).toString().toLowerCase().indexOf(r) == -1) : (!r(this._get_cell_value(u.buff, g), u.id))) {
				q[u.id] = true;
				if (this._tr_fltr_c) {
					c(u.parent, this._h2, s)
				}
				return false
			} else {
				c(u, this._h2, s);
				if (u.childs && m != -2) {
					this._h2.forEachChild(u.id, function(v) {
						c(v, this._h2, s)
					}, this)
				}
				return true
			}
		} else {
			if (this._tr_fltr_d && this._tr_strfltr > u.level && u.id != 0) {
				c(u, this._h2, s)
			}
			l(u)
		}
	};
	this.temp(this._h2.get[0]);
	this._h2 = s;
	if (this._fake) {
		this._fake._h2 = this._h2
	}
};
dhtmlXGridObject.prototype._fix_filtered_images = function(c, a) {
	c.forEachChild(0, function(g) {
		if (!g.childs.length && !g.has_kids) {
			if (g.state != dhtmlXGridObject._emptyLineImg) {
				g.state = dhtmlXGridObject._emptyLineImg;
				g.update = true;
				this._updateTGRState(g)
			}
		} else {
			if (g.buff.tagName == "TR") {
				var l = a.get[g.id];
				if (l && l.state != dhtmlXGridObject._emptyLineImg) {
					g.state = l.state
				}
				g.update = true;
				this._updateTGRState(g)
			}
		}
	}, this)
};
dhtmlXGridObject.prototype.collectTreeValues = function(g) {
	if (typeof this._tr_strfltr == "undefined") {
		this._tr_strfltr = -1
	}
	this.dma(true);
	this._build_m_order();
	g = this._m_order ? this._m_order[g] : g;
	var o = {};
	var m = [];
	var a = this._f_rowsBuffer || this._h2;
	a.forEachChild(0, function(c) {
		if (this._tr_strfltr == -2 || (this._tr_strfltr == -1 && !c.childs.length) || (this._tr_strfltr == c.level)) {
			var q = this._get_cell_value(c.buff, g);
			if (q) {
				o[q] = true
			}
		}
	}, this);
	this.dma(false);
	var l = this.combos[g];
	for (var n in o) {
		if (o[n] === true) {
			m.push(l ? (l.get(n) || n) : n)
		}
	}
	return m.sort()
};
dhtmlXGridObject.prototype._in_header_stat_tree_total = function(g, a, m) {
	var l = function() {
		var n = 0;
		this._build_m_order();
		var c = this._m_order ? this._m_order[a] : a;
		this._h2.forEachChild(0, function(q) {
			var o = parseFloat(this._get_cell_value((q.buff || this.rowsAr[q.id]), c));
			n += isNaN(o) ? 0 : o
		}, this);
		return this._maskArr[a] ? this._aplNF(n, a) : (Math.round(n * 100) / 100)
	};
	this._stat_in_header(g, l, a, m, m)
};
dhtmlXGridObject.prototype._in_header_stat_tree_total_leaf = function(g, a, m) {
	var l = function() {
		var n = 0;
		this._build_m_order();
		var c = this._m_order ? this._m_order[a] : a;
		this._h2.forEachChild(0, function(q) {
			if (q.childs.length) {
				return
			}
			var o = parseFloat(this._get_cell_value((q.buff || this.rowsAr[q.id]), c));
			n += isNaN(o) ? 0 : o
		}, this);
		return this._maskArr[a] ? this._aplNF(n, a) : (Math.round(n * 100) / 100)
	};
	this._stat_in_header(g, l, a, m, m)
};
dhtmlXGridObject.prototype._in_header_stat_tree_multi_total = function(g, a, n) {
	var m = n[1].split(":");
	n[1] = "";
	var l = function() {
		var c = 0;
		this._h2.forEachChild(0, function(q) {
			var o = parseFloat(this._get_cell_value((q.buff || this.rowsAr[q.id]), m[0])) * parseFloat(this._get_cell_value((q.buff || this.rowsAr[q.id]), m[1]));
			c += isNaN(o) ? 0 : o
		}, this);
		return this._maskArr[a] ? this._aplNF(c, a) : (Math.round(c * 100) / 100)
	};
	this._stat_in_header(g, l, a, n, n)
};
dhtmlXGridObject.prototype._in_header_stat_tree_multi_total_leaf = function(g, a, n) {
	var m = n[1].split(":");
	n[1] = "";
	var l = function() {
		var c = 0;
		this._h2.forEachChild(0, function(q) {
			if (q.childs.length) {
				return
			}
			var o = parseFloat(this._get_cell_value((q.buff || this.rowsAr[q.id]), m[0])) * parseFloat(this._get_cell_value((q.buff || this.rowsAr[q.id]), m[1]));
			c += isNaN(o) ? 0 : o
		}, this);
		return this._maskArr[a] ? this._aplNF(c, a) : (Math.round(c * 100) / 100)
	};
	this._stat_in_header(g, l, a, n, n)
};
dhtmlXGridObject.prototype._in_header_stat_tree_max = function(g, a, m) {
	var l = function() {
		var n = -999999999;
		this._build_m_order();
		var c = this._m_order ? this._m_order[a] : a;
		if (this.getRowsNum() == 0) {
			return ""
		}
		this._h2.forEachChild(0, function(o) {
			var q = parseFloat(this._get_cell_value((o.buff || this.rowsAr[o.id]), c));
			if (!isNaN(q)) {
				n = Math.max(n, q)
			}
		}, this);
		return this._maskArr[a] ? this._aplNF(n, a) : n
	};
	this._stat_in_header(g, l, a, m)
};
dhtmlXGridObject.prototype._in_header_stat_tree_min = function(g, a, m) {
	var l = function() {
		var n = 999999999;
		this._build_m_order();
		var c = this._m_order ? this._m_order[a] : a;
		if (this.getRowsNum() == 0) {
			return ""
		}
		this._h2.forEachChild(0, function(o) {
			var q = parseFloat(this._get_cell_value((o.buff || this.rowsAr[o.id]), c));
			if (!isNaN(q)) {
				n = Math.min(n, q)
			}
		}, this);
		return this._maskArr[a] ? this._aplNF(n, a) : n
	};
	this._stat_in_header(g, l, a, m)
};
dhtmlXGridObject.prototype._in_header_stat_tree_average = function(g, a, m) {
	var l = function() {
		var o = 0;
		var n = 0;
		this._build_m_order();
		var c = this._m_order ? this._m_order[a] : a;
		this._h2.forEachChild(0, function(r) {
			var q = parseFloat(this._get_cell_value((r.buff || this.rowsAr[r.id]), c));
			o += isNaN(q) ? 0 : q;
			n++
		}, this);
		return this._maskArr[a] ? this._aplNF(o, a) : (Math.round(o / n * 100) / 100)
	};
	this._stat_in_header(g, l, a, m)
};
dhtmlXGridObject.prototype._in_header_stat_tree_max_leaf = function(g, a, m) {
	var l = function() {
		var n = -999999999;
		this._build_m_order();
		var c = this._m_order ? this._m_order[a] : a;
		if (this.getRowsNum() == 0) {
			return ""
		}
		this._h2.forEachChild(0, function(o) {
			if (o.childs.length) {
				return
			}
			var q = parseFloat(this._get_cell_value((o.buff || this.rowsAr[o.id]), c));
			if (!isNaN(q)) {
				n = Math.max(n, q)
			}
		}, this);
		return this._maskArr[a] ? this._aplNF(n, a) : n
	};
	this._stat_in_header(g, l, a, m)
};
dhtmlXGridObject.prototype._in_header_stat_tree_min_leaf = function(g, a, m) {
	var l = function() {
		var n = 999999999;
		this._build_m_order();
		var c = this._m_order ? this._m_order[a] : a;
		if (this.getRowsNum() == 0) {
			return ""
		}
		this._h2.forEachChild(0, function(o) {
			if (o.childs.length) {
				return
			}
			var q = parseFloat(this._get_cell_value((o.buff || this.rowsAr[o.id]), c));
			if (!isNaN(q)) {
				n = Math.min(n, q)
			}
		}, this);
		return this._maskArr[a] ? this._aplNF(n, a) : n
	};
	this._stat_in_header(g, l, a, m)
};
dhtmlXGridObject.prototype._in_header_stat_tree_average_leaf = function(g, a, m) {
	var l = function() {
		var o = 0;
		var n = 0;
		this._build_m_order();
		var c = this._m_order ? this._m_order[a] : a;
		this._h2.forEachChild(0, function(r) {
			if (r.childs.length) {
				return
			}
			var q = parseFloat(this._get_cell_value((r.buff || this.rowsAr[r.id]), c));
			o += isNaN(q) ? 0 : q;
			n++
		}, this);
		return this._maskArr[a] ? this._aplNF(o, a) : (Math.round(o / n * 100) / 100)
	};
	this._stat_in_header(g, l, a, m)
};
dhtmlXGridObject.prototype._in_header_stat_tree_count = function(g, a, m) {
	var l = function() {
		var c = 0;
		this._h2.forEachChild(0, function(n) {
			c++
		}, this);
		return c
	};
	this._stat_in_header(g, l, a, m)
};
dhtmlXGridObject.prototype._in_header_stat_tree_count_leaf = function(g, a, m) {
	var l = function() {
		var c = 0;
		this._h2.forEachChild(0, function(n) {
			if (!n.childs.length) {
				c++
			}
		}, this);
		return c
	};
	this._stat_in_header(g, l, a, m)
};
dhtmlXGridObject.prototype._stat_in_header = function(g, l, a, o) {
	var m = this;
	var n = function() {
		this.dma(true);
		g.innerHTML = (o[0] ? o[0] : "") + l.call(this) + (o[1] ? o[1] : "");
		this.dma(false);
		this.callEvent("onStatReady", [])
	};
	if (!this._stat_events) {
		this._stat_events = [];
		this.attachEvent("onClearAll", function() {
			if (!this.hdr.rows[1]) {
				for (var q = 0; q < this._stat_events.length; q++) {
					for (var c = 0; c < 4; c++) {
						this.detachEvent(this._stat_events[q][c])
					}
				}
				this._stat_events = []
			}
		})
	}
	this._stat_events.push([this.attachEvent("onGridReconstructed", n), this.attachEvent("onXLE", n), this.attachEvent("onFilterEnd", n), this.attachEvent("onEditCell", function(c, r, q) {
		if (c == 2 && q == a) {
			n.call(this)
		}
		return true
	})]);
	g.innerHTML = ""
};
dhtmlXGridObject.prototype._build_m_order = function() {
	if (this._c_order) {
		this._m_order = [];
		for (var a = 0; a < this._c_order.length; a++) {
			this._m_order[this._c_order[a]] = a
		}
	}
};

function dhtmlXForm(m, l, n) {
	this.idef = {
		position: "label-left",
		labelWidth: "auto",
		labelHeight: "auto",
		inputWidth: "auto",
		inputHeight: "auto",
		labelAlign: "left",
		noteWidth: "auto",
		offsetTop: 0,
		offsetLeft: 0,
		blockOffset: 20
	};
	this.idef_const = {
		offsetNested: 20
	};
	this.apos_css = {
		"label-left": "dhxform_item_label_left",
		"label-right": "dhxform_item_label_right",
		"label-top": "dhxform_item_label_top",
		"label-bottom": "dhxform_item_label_bottom",
		absolute: "dhxform_item_absolute"
	};
	this.align_css = {
		left: "dhxform_label_align_left",
		center: "dhxform_label_align_center",
		right: "dhxform_label_align_right"
	};
	var g = this;
	this.setSkin = function(a) {
		this.skin = a;
		this.cont.className = "dhxform_obj_" + this.skin;
		this.cont.style.fontSize = (a == "dhx_terrace" ? "13px" : "12px");
		this._updateBlocks();
		this.forEachItem(function(q) {
			var o = g.getItemType(q);
			if (typeof(g.items[o]) != "undefined" && typeof(g.items[o].setSkin) == "function") {
				g.doWithItem(q, "setSkin", a)
			}
		})
	};
	this.skin = (n || window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhx_form") || "dhx_skyblue");
	this.separator = ",";
	this.live_validate = false;
	this._type = "checkbox";
	this._rGroup = "default";
	this._idIndex = {};
	this._indexId = [];
	this.cont = (typeof(m) == "object" ? m : document.getElementById(m));
	if (!m._isNestedForm) {
		this._parentForm = true;
		this.cont.style.fontSize = (this.skin == "dhx_terrace" ? "13px" : "12px");
		this.cont.className = "dhxform_obj_" + this.skin;
		this.setFontSize = function(a) {
			this.cont.style.fontSize = a;
			this._updateBlocks()
		};
		this.getForm = function() {
			return this
		};
		this.cont.onkeypress = function(o) {
			o = (o || event);
			if (o.keyCode == 13) {
				var a = (o.target || o.srcElement);
				if (typeof(a.tagName) != "undefined" && String(a.tagName).toLowerCase() == "textarea" && !o.ctrlKey) {
					return
				}
				g.callEvent("onEnter", [])
			}
		}
	}
	this.b_index = null;
	this.base = [];
	this._prepare = function(x, y) {
		if (this.b_index == null) {
			this.b_index = 0
		} else {
			this.b_index++
		}
		var r = null;
		var o = null;
		if (y != null) {
			if (y < 0) {
				y = 0
			}
			var u = 0;
			for (var a = 0; a < this.cont.childNodes.length; a++) {
				for (var v = 0; v < this.cont.childNodes[a].childNodes.length; v++) {
					if (o == null && this.cont.childNodes[a].childNodes[v]._isNestedForm != true) {
						if (u == y) {
							r = this.cont.childNodes[a].nextSibling;
							o = this.cont.childNodes[a].childNodes[v]
						}
						u++
					}
				}
			}
		}
		this.base[this.b_index] = document.createElement("DIV");
		this.base[this.b_index].className = "dhxform_base";
		if (typeof(x) != "undefined") {
			this.base[this.b_index].style.cssText += " margin-left:" + x + "px!important;"
		}
		if (r != null) {
			this.cont.insertBefore(this.base[this.b_index], r);
			r = null
		} else {
			this.cont.appendChild(this.base[this.b_index])
		}
		if (o != null) {
			while (o != null) {
				var s = o;
				o = o.nextSibling;
				this.base[this.b_index].appendChild(s);
				s = null
			}
		}
	};
	this.setSizes = function() {};
	this._mergeSettings = function(w) {
		var r = -1;
		var s = {
			type: "settings"
		};
		for (var o in this.idef) {
			s[o] = this.idef[o]
		}
		for (var v = 0; v < w.length; v++) {
			if (typeof(w[v]) != "undefined" && w[v].type == "settings") {
				for (var o in w[v]) {
					s[o] = w[v][o]
				}
				r = v
			}
		}
		w[r >= 0 ? r : w.length] = s;
		return w
	};
	this._genStr = function(a) {
		var o = "";
		var u = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
		for (var r = 0; r < a; r++) {
			o += u.charAt(Math.floor(Math.random() * u.length))
		}
		return o
	};
	this.idPrefix = "dhxForm_" + this._genStr(12) + "_";
	this._rId = (this._parentForm ? this._genStr(12) + "_" : m._rId);
	this.objPull = {};
	this.itemPull = {};
	this._ic = 0;
	this._addItem = function(H, u, A, x, E, I, D) {
		if (this.items[H]._index) {
			this.getForm()._indexId.push(u);
			this.getForm()._idIndex[u] = {
				ind: this.getForm()._indexId.length - 1
			}
		}
		if (!H) {
			H = this._type
		}
		if (H == "list" && E != null && this.itemPull[this.idPrefix + E] != null && typeof(this.itemPull[this.idPrefix + E]._addSubListNode) == "function") {
			var F = this.itemPull[this.idPrefix + E]._addSubListNode()
		} else {
			if (H == "newcolumn") {
				var F = {}
			} else {
				var v = this.base[this.b_index];
				var o = null;
				if (typeof(I) != "undefined" && !isNaN(I) && H != "list") {
					I = Math.max(parseInt(I), 0) + 1;
					for (var K = 0; K < this.cont.childNodes.length; K++) {
						for (var r = 0; r < this.cont.childNodes[K].childNodes.length; r++) {
							if (o == null && this.cont.childNodes[K].childNodes[r]._isNestedForm != true) {
								I--;
								if (I == 0) {
									o = this.cont.childNodes[K].childNodes[r];
									v = this.cont.childNodes[K]
								}
							}
						}
					}
				} else {
					if (H == "list") {
						for (var J in this.itemPull) {
							if (J == this.idPrefix + u) {
								o = this.itemPull[J].nextSibling;
								if (this.itemPull[J]._listBase != null && this.itemPull[J]._listBase.length > 0) {
									o = this.itemPull[J]._listBase[this.itemPull[J]._listBase.length - 1]
								}
							}
						}
					}
				}
				var F = document.createElement("DIV");
				if (D == true && o != null) {
					o = o.nextSibling
				}
				if (o != null) {
					v.insertBefore(F, o)
				} else {
					v.appendChild(F)
				}
			}
		}
		F._idd = u;
		F._rId = this._rId;
		if (typeof(F.style) != "undefined") {
			if (typeof(A.offsetLeft) == "undefined" && this.idef.offsetLeft > 0) {
				A.offsetLeft = this.idef.offsetLeft
			}
			if (typeof(A.offsetTop) == "undefined" && this.idef.offsetTop > 0) {
				A.offsetTop = this.idef.offsetTop
			}
			var y = "";
			if (typeof(A.offsetLeft) != "undefined") {
				y += " padding-left:" + A.offsetLeft + "px!important;"
			}
			if (typeof(A.offsetTop) != "undefined") {
				y += " padding-top:" + A.offsetTop + "px!important;"
			}
			F.style.cssText += y
		}
		if (H == "block") {
			if (isNaN(A.blockOffset)) {
				A.blockOffset = this.idef.blockOffset
			}
		}
		if (H == "list") {
			if (typeof(F._ofsNested) == "undefined") {
				F._ofsNested = this.idef_const.offsetNested
			}
			if (x != null) {
				F._sId = x
			}
			var C = this.items[H].render(F, this.skin);
			if (!this.itemPull[this.idPrefix + u]._listObj) {
				this.itemPull[this.idPrefix + u]._listObj = []
			}
			if (!this.itemPull[this.idPrefix + u]._list) {
				this.itemPull[this.idPrefix + u]._list = []
			}
			if (!this.itemPull[this.idPrefix + u]._listBase) {
				this.itemPull[this.idPrefix + u]._listBase = []
			}(this.itemPull[this.idPrefix + u]._listObj).push(C[0]);
			(this.itemPull[this.idPrefix + u]._list).push(C[1]);
			(this.itemPull[this.idPrefix + u]._listBase).push(F);
			C[1].checkEvent = function(a) {
				return g.checkEvent(a)
			};
			C[1].callEvent = function(a, q) {
				return g.callEvent(a, q)
			};
			C[1].getForm = function() {
				return g.getForm()
			};
			C[1]._initObj(this._mergeSettings(A));
			if (F._inBlcok) {
				F.className += " in_block"
			}
			return C[1]
		}
		if (H == "newcolumn") {
			this._prepare(A.offset, I);
			return
		}
		if (H == "label" && this._ic++ == 0) {
			A._isTopmost = true
		}
		A.position = this.apos_css[(!A.position || !this.apos_css[A.position] ? this.idef.position : A.position)];
		F.className = A.position + (typeof(A.className) == "string" ? " " + A.className : "");
		if (!A.labelWidth) {
			A.labelWidth = this.idef.labelWidth
		}
		if (!A.labelHeight) {
			A.labelHeight = this.idef.labelHeight
		}
		if (typeof(A.wrap) != "undefined") {
			A.wrap = window.dhx4.s2b(A.wrap)
		}
		A.labelAlign = (this.align_css[A.labelAlign] ? this.align_css[A.labelAlign] : this.align_css[this.idef.labelAlign]);
		A.inputWidth = (A.width ? A.width : (A.inputWidth ? A.inputWidth : this.idef.inputWidth));
		if (!A.inputHeight) {
			A.inputHeight = this.idef.inputHeight
		}
		if (typeof(A.note) != "undefined") {
			if (A.note.length != null && A.note[0] != null) {
				A.note = A.note[0]
			}
			if (typeof(A.note.width) == "undefined") {
				A.note.width = this.idef.noteWidth
			}
			if (A.note.width == "auto") {
				A.note.width = A.inputWidth
			}
		}
		F.checkEvent = function(a) {
			return g.checkEvent(a)
		};
		F.callEvent = function(a, q) {
			return g.callEvent(a, q)
		};
		F.getForm = function() {
			return g.getForm()
		};
		F._autoCheck = function(a) {
			g._autoCheck(a)
		};
		if (typeof(A.readonly) == "string") {
			A.readonly = window.dhx4.s2b(A.readonly)
		}
		if (typeof(A.autoStart) == "string") {
			A.autoStart = window.dhx4.s2b(A.autoStart)
		}
		if (typeof(A.autoRemove) == "string") {
			A.autoRemove = window.dhx4.s2b(A.autoRemove)
		}
		if (typeof(A.titleScreen) == "string") {
			A.titleScreen = window.dhx4.s2b(A.titleScreen)
		}
		if (typeof(A.info) == "string") {
			A.info = window.dhx4.s2b(A.info)
		}
		if (typeof(A.hidden) == "string") {
			A.hidden = window.dhx4.s2b(A.hidden)
		}
		if (typeof(A.checked) == "string") {
			A.checked = window.dhx4.s2b(A.checked)
		}
		if (typeof(A.userdata) != "undefined") {
			for (var J in A.userdata) {
				this.getForm().setUserData(u, J, A.userdata[J])
			}
		}
		if (A.validate) {
			if (typeof(A.validate != "undefined") && (typeof(A.validate) == "function" || typeof(window[A.validate]) == "function")) {
				F._validate = [A.validate]
			} else {
				F._validate = String(A.validate).split(this.separator)
			}
		}
		if (typeof(A.required) != "undefined") {
			if (typeof(A.required) == "string") {
				A.required = window.dhx4.s2b(A.required)
			}
			F._required = (A.required == true)
		}
		if (F._required) {
			if (!F._validate) {
				F._validate = []
			}
			var s = false;
			for (r = 0; r < F._validate.length; r++) {
				s = (s || (F._validate[r] == "NotEmpty"))
			}
			if (!s) {
				F._validate.push("NotEmpty")
			}
		}
		F._ll = (A.position == this.apos_css["label-left"] || A.position == this.apos_css["label-top"]);
		this.objPull[this.idPrefix + u] = this.items[H].render(F, A);
		this.itemPull[this.idPrefix + u] = F
	};
	this._initObj = function(u, r) {
		if (typeof(u.data) != "undefined") {
			var v = null;
			if (typeof(r) != "undefined") {
				v = r.match(/(\?|\&)id\=([a-z0-9_\-]*)/i);
				if (v != null && v[0] != null) {
					v = v[0].split("=")[1]
				}
			}
			if (this.callEvent("onBeforeDataLoad", [v, window.dhx4._copyObj(u.data)]) === true) {
				this.formId = v;
				this._last_load_data = u;
				this.setFormData(u.data);
				this.resetDataProcessor("updated")
			}
			return
		}
		this._prepare();
		for (var s = 0; s < u.length; s++) {
			if (typeof(u[s]) != "undefined" && u[s].type == "settings") {
				for (var o in u[s]) {
					this.idef[o] = u[s][o]
				}
			}
		}
		for (var s = 0; s < u.length; s++) {
			this._prepareItem(u[s])
		}
		this._autoCheck()
	};
	this._prepareItem = function(s, x, r) {
		var q = (s != null && s.type != null ? s.type : "");
		if (this.items[q]) {
			if (!s.name) {
				s.name = this._genStr(12)
			}
			var v = s.name;
			if (this.objPull[this.idPrefix + v] != null || q == "radio") {
				v = this._genStr(12)
			}
			var u = s;
			u.label = u.label || "";
			u.value = u.value;
			u.checked = window.dhx4.s2b(u.checked);
			u.disabled = window.dhx4.s2b(u.disabled);
			u.name = u.name || this._genStr(12);
			u.options = u.options || [];
			u.rows = u.rows || "none";
			u.uid = this._genStr(12);
			this._addItem(q, v, u, null, null, x, r);
			x = null;
			if (this._parentEnabled === false) {
				this._disableItem(v)
			}
			for (var o = 0; o < u.options.length; o++) {
				if (u.options[o].list != null) {
					if (!u.options[o].value) {
						u.options[o].value = this._genStr()
					}
					var a = this._addItem("list", v, u.options[o].list, u.options[o].value, null);
					a._subSelect = true;
					a._subSelectId = u.options[o].value
				}
			}
			if (s.list != null) {
				if (!s.listParent) {
					s.listParent = u.name
				}
				var a = this._addItem("list", v, s.list, null, s.listParent)
			}
		}
	};
	this._xmlSubItems = {
		item: "list",
		option: "options",
		note: "note",
		userdata: "_userdata"
	};
	this._xmlToObject = function(E, o) {
		if (typeof(o) == "undefined") {
			o = true
		}
		if (o) {
			var H = E.getElementsByTagName("items");
			H = (H != null && H[0] != null ? H[0] : null);
			var r = E.getElementsByTagName("data");
			r = (r != null && r[0] != null ? r[0] : null)
		} else {
			H = E
		}
		var C = (o ? [] : {});
		if (H != null) {
			for (var u = 0; u < H.childNodes.length; u++) {
				if (typeof(H.childNodes[u].tagName) != "undefined") {
					var v = H.childNodes[u].tagName;
					if (this._xmlSubItems[v] != null) {
						var x = this._xmlSubItems[v];
						if (typeof(C[x]) == "undefined") {
							C[x] = []
						}
						var D = H.childNodes[u];
						var A = {};
						for (var L = 0; L < D.attributes.length; L++) {
							var I = D.attributes[L].name;
							var F = D.attributes[L].value;
							A[I] = F
						}
						if (x == "note") {
							A.text = D.firstChild.nodeValue
						}
						if (x == "_userdata") {
							A.value = (D.firstChild != null && D.firstChild.nodeValue != null ? D.firstChild.nodeValue : "")
						}
						var y = this._xmlToObject(D, false);
						for (var J in y) {
							if (J == "_userdata") {
								if (!A.userdata) {
									A.userdata = {}
								}
								for (var L = 0; L < y[J].length; L++) {
									A.userdata[y[J][L].name] = y[J][L].value
								}
							} else {
								A[J] = y[J]
							}
						}
						D = null;
						if (o) {
							C.push(A)
						} else {
							C[x].push(A)
						}
					}
				}
			}
		}
		if (r != null) {
			C = {
				data: {}
			};
			for (var u = 0; u < r.childNodes.length; u++) {
				if (typeof(r.childNodes[u].tagName) != "undefined") {
					var s = r.childNodes[u].tagName;
					var K = (r.childNodes[u].firstChild != null ? r.childNodes[u].firstChild.nodeValue : "");
					C.data[s] = K
				}
			}
		}
		return C
	};
	this._autoCheck = function(x) {
		if (this._locked === true) {
			x = false
		} else {
			if (typeof(x) == "undefined") {
				x = true
			}
		}
		for (var s in this.itemPull) {
			var y = (x && (this.itemPull[s]._udis !== true));
			this[y ? "_enableItem" : "_disableItem"](this.itemPull[s]._idd);
			if (this.getForm()._idIndex[this.itemPull[s]._idd] != null) {
				this.getForm()._idIndex[this.itemPull[s]._idd].enabled = y
			}
			var r = (y && (typeof(this.itemPull[s]._checked) == "boolean" ? this.itemPull[s]._checked : true));
			if (this.itemPull[s]._list) {
				for (var C = 0; C < this.itemPull[s]._list.length; C++) {
					var A = true;
					if (this.itemPull[s]._list[C]._subSelect == true) {
						A = false;
						var u = this.getItemValue(this.itemPull[s]._idd);
						if (!(typeof(u) == "object" && typeof(u.length) == "number")) {
							u = [u]
						}
						for (var o = 0; o < u.length; o++) {
							A = (u[o] == this.itemPull[s]._list[C]._subSelectId) || A
						}
						this.itemPull[s]._listObj[C][A ? "show" : "hide"](this.itemPull[s]._listBase[C])
					}
					this.itemPull[s]._list[C]._autoCheck(r && A)
				}
			}
		}
	};
	this.doWithItem = function(s, o, A, y, x, w) {
		if (typeof(s) == "object") {
			var D = s[0];
			var C = s[1];
			var E = null;
			var v = null;
			for (var u in this.itemPull) {
				if ((this.itemPull[u]._value == C || C === null) && this.itemPull[u]._group == D) {
					return this.objPull[u][o](this.itemPull[u], A, y, x, w)
				}
				if (this.itemPull[u]._list != null && !v) {
					for (var r = 0; r < this.itemPull[u]._list.length; r++) {
						v = this.itemPull[u]._list[r].doWithItem(s, o, A, y, x)
					}
				}
			}
			if (v != null) {
				return v
			} else {
				if (o == "getType") {
					return this.doWithItem(s[0], "getType")
				}
			}
		} else {
			if (!this.itemPull[this.idPrefix + s]) {
				var v = null;
				for (var u in this.itemPull) {
					if (this.itemPull[u]._list && !v) {
						for (var r = 0; r < this.itemPull[u]._list.length; r++) {
							if (v == null) {
								v = this.itemPull[u]._list[r].doWithItem(s, o, A, y, x, w)
							}
						}
					}
				}
				return v
			} else {
				return this.objPull[this.idPrefix + s][o](this.itemPull[this.idPrefix + s], A, y, x, w)
			}
		}
	};
	this._removeItem = function(o, a) {
		if (a != null) {
			o = this.doWithItem([o, a], "destruct")
		} else {
			this.doWithItem(o, "destruct")
		}
		this._clearItemData(o)
	};
	this._clearItemData = function(s) {
		if (this.itemPull[this.idPrefix + s]) {
			s = this.idPrefix + s;
			try {
				this.objPull[s] = null;
				this.itemPull[s] = null;
				delete this.objPull[s];
				delete this.itemPull[s]
			} catch (r) {}
		} else {
			for (var a in this.itemPull) {
				if (this.itemPull[a]._list) {
					for (var o = 0; o < this.itemPull[a]._list.length; o++) {
						this.itemPull[a]._list[o]._clearItemData(s)
					}
				}
			}
		}
	};
	this.isItem = function(o, a) {
		if (a != null) {
			o = [o, a]
		}
		return this.doWithItem(o, "isExist")
	};
	this.getItemType = function(o, a) {
		o = [o, (a || null)];
		return this.doWithItem(o, "getType")
	};
	this.forEachItem = function(r) {
		for (var o in this.objPull) {
			if (this.objPull[o].t == "radio") {
				r(this.itemPull[o]._group, this.itemPull[o]._value)
			} else {
				r(String(o).replace(this.idPrefix, ""))
			}
			if (this.itemPull[o]._list) {
				for (var s = 0; s < this.itemPull[o]._list.length; s++) {
					this.itemPull[o]._list[s].forEachItem(r)
				}
			}
		}
	};
	this.setItemLabel = function(q, a, o) {
		if (o != null) {
			q = [q, a]
		} else {
			o = a
		}
		this.doWithItem(q, "setText", o)
	};
	this.getItemLabel = function(o, a) {
		if (a != null) {
			o = [o, a]
		}
		return this.doWithItem(o, "getText")
	};
	this._enableItem = function(a) {
		this.doWithItem(a, "enable")
	};
	this._disableItem = function(a) {
		this.doWithItem(a, "disable")
	};
	this._isItemEnabled = function(a) {
		return this.doWithItem(a, "isEnabled")
	};
	this.checkItem = function(o, a) {
		if (a != null) {
			o = [o, a]
		}
		this.doWithItem(o, "check");
		this._autoCheck()
	};
	this.uncheckItem = function(o, a) {
		if (a != null) {
			o = [o, a]
		}
		this.doWithItem(o, "unCheck");
		this._autoCheck()
	};
	this.isItemChecked = function(o, a) {
		if (a != null) {
			o = [o, a]
		}
		return this.doWithItem(o, "isChecked")
	};
	this.getCheckedValue = function(a) {
		return this.doWithItem([a, null], "getChecked")
	};
	this._getRGroup = function(w, v) {
		for (var o in this.itemPull) {
			if (this.itemPull[o]._group == w && (v == null || this.itemPull[o]._value == v)) {
				return this.itemPull[o]._idd
			}
			if (this.itemPull[o]._list != null) {
				for (var u = 0; u < this.itemPull[o]._list.length; u++) {
					var s = this.itemPull[o]._list[u]._getRGroup(w, v);
					if (s != null) {
						return s
					}
				}
			}
		}
		return null
	};
	this.setItemValue = function(o, a) {
		this.resetValidateCss(o, a);
		if (this.getItemType(o) == "radio") {
			if (this._getRGroup(o, a) != null) {
				this.checkItem(o, a)
			} else {
				this.uncheckItem(o, this.getCheckedValue(o))
			}
			return null
		}
		return this.doWithItem(o, "setValue", a)
	};
	this.getItemValue = function(o, a) {
		if (this.getItemType(o) == "radio") {
			return this.getCheckedValue(o)
		}
		return this.doWithItem(o, "getValue", a)
	};
	this.updateValues = function() {
		this._updateValues()
	};
	this.showItem = function(o, a) {
		if (a != null) {
			o = [o, a]
		}
		this.doWithItem(o, "show")
	};
	this.hideItem = function(o, a) {
		if (a != null) {
			o = [o, a]
		}
		this.doWithItem(o, "hide")
	};
	this.isItemHidden = function(o, a) {
		if (a != null) {
			o = [o, a]
		}
		return this.doWithItem(o, "isHidden")
	};
	this.getOptions = function(a) {
		return this.doWithItem(a, "getOptions")
	};
	this.setItemWidth = function(o, a) {
		this.doWithItem(o, "setWidth", a)
	};
	this.getItemWidth = function(a) {
		return this.doWithItem(a, "getWidth")
	};
	this.setItemHeight = function(o, a) {
		this.doWithItem(o, "setHeight", a)
	};
	this.setItemFocus = function(o, a) {
		if (a != null) {
			o = [o, a]
		}
		this.doWithItem(o, "setFocus")
	};
	this._updateValues = function() {
		for (var o in this.itemPull) {
			if (this.objPull[o] && typeof(this.objPull[o].updateValue) == "function") {
				this.objPull[o].updateValue(this.itemPull[o])
			}
			if (this.itemPull[o]._list) {
				for (var r = 0; r < this.itemPull[o]._list.length; r++) {
					this.itemPull[o]._list[r]._updateValues()
				}
			}
		}
	};
	this._getItemByName = function(v) {
		for (var o in this.itemPull) {
			if (this.itemPull[o]._idd == v) {
				return this.itemPull[o]
			}
			if (this.itemPull[o]._list != null) {
				for (var u = 0; u < this.itemPull[o]._list.length; u++) {
					var s = this.itemPull[o]._list[u]._getItemByName(v);
					if (s != null) {
						return s
					}
				}
			}
		}
		return null
	};
	this._resetValidateCss = function(a) {
		a.className = (a.className).replace(a._vcss, "");
		a._vcss = null
	};
	this.setValidateCss = function(a, r, q) {
		var o = this[this.getItemType(a) == "radio" ? "_getRGroup" : "_getItemByName"](a);
		if (!o) {
			return
		}
		if (o._vcss != null) {
			this._resetValidateCss(o)
		}
		o._vcss = (typeof(q) == "string" ? q : "validate_" + (r === true ? "ok" : "error"));
		o.className += " " + o._vcss
	};
	this.resetValidateCss = function(r) {
		for (var o in this.itemPull) {
			if (this.itemPull[o]._vcss != null) {
				this._resetValidateCss(this.itemPull[o])
			}
			if (this.itemPull[o]._list != null) {
				for (var s = 0; s < this.itemPull[o]._list.length; s++) {
					this.itemPull[o]._list[s].resetValidateCss()
				}
			}
		}
	};
	this.validate = function(o) {
		if (this.callEvent("onBeforeValidate", []) == false) {
			return
		}
		var a = true;
		this.forEachItem(function(r, s) {
			if (typeof(s) != "undefined") {
				r = [r, s]
			}
			var q = g.doWithItem(r, "_validate");
			if (typeof(q) != "boolean") {
				q = true
			}
			a = q && a
		});
		this.callEvent("onAfterValidate", [a]);
		return a
	};
	this.validateItem = function(a, o) {
		if (typeof(o) != "undefined") {
			a = [a, o]
		}
		return this.doWithItem(a, "_validate")
	};
	this.enableLiveValidation = function(a) {
		this.live_validate = (a == true)
	};
	this.setReadonly = function(o, a) {
		this.doWithItem(o, "setReadonly", a)
	};
	this.isReadonly = function(a) {
		return this.doWithItem(a, "isReadonly")
	};
	this.getFirstActive = function(o) {
		for (var s = 0; s < this._indexId.length; s++) {
			var a = true;
			if (o == true) {
				var r = this.getItemType(this._indexId[s]);
				if (!dhtmlXForm.prototype.items[r].setFocus) {
					a = false
				}
			}
			if (a && this._idIndex[this._indexId[s]].enabled) {
				return this._indexId[s]
			}
		}
		return null
	};
	this.setFocusOnFirstActive = function() {
		var a = this.getFirstActive(true);
		if (a != null) {
			this.setItemFocus(a)
		}
	};
	this.enableItem = function(o, a) {
		if (a != null) {
			o = [o, a]
		}
		this.doWithItem(o, "userEnable");
		this._autoCheck()
	};
	this.disableItem = function(o, a) {
		if (a != null) {
			o = [o, a]
		}
		this.doWithItem(o, "userDisable");
		this._autoCheck()
	};
	this.isItemEnabled = function(o, a) {
		if (a != null) {
			o = [o, a]
		}
		return this.doWithItem(o, "isUserEnabled")
	};
	this.clear = function() {
		var o = {};
		this.formId = (new Date()).valueOf();
		this.resetDataProcessor("inserted");
		for (var r in this.itemPull) {
			var s = this.itemPull[r]._idd;
			if (this.itemPull[r]._type == "ch") {
				this.uncheckItem(s)
			}
			if (this.itemPull[r]._type in {
					ta: 1,
					editor: 1,
					calendar: 1,
					pw: 1,
					hd: 1
				}) {
				this.setItemValue(s, "")
			}
			if (this.itemPull[r]._type == "combo") {
				this.itemPull[r]._apiChange = true;
				var x = this.getCombo(s);
				x.selectOption(0);
				x = null;
				this.itemPull[r]._apiChange = false
			}
			if (this.itemPull[r]._type == "se") {
				var v = this.getOptions(s);
				if (v.length > 0) {
					v[0].selected = true
				}
			}
			if (this.itemPull[r]._type == "ra") {
				var u = this.itemPull[r]._group;
				if (!o[u]) {
					this.checkItem(u, this.doWithItem(s, "_getFirstValue"));
					o[u] = true
				}
			}
			if (this.itemPull[r]._list) {
				for (var w = 0; w < this.itemPull[r]._list.length; w++) {
					this.itemPull[r]._list[w].clear()
				}
			}
			if (this["setFormData_" + this.itemPull[r]._type]) {
				this["setFormData_" + this.itemPull[r]._type](s, "")
			}
		}
		o = null;
		if (this._parentForm) {
			this._autoCheck()
		}
		this.resetValidateCss()
	};
	this.unload = function() {
		window.dhx4._enableDataLoading(this, null, null, null, "clear");
		window.dhx4._eventable(this, "clear");
		for (var o in this.objPull) {
			this._removeItem(String(o).replace(this.idPrefix, ""))
		}
		if (this._ccTm) {
			window.clearTimeout(this._ccTm)
		}
		this._formLS = null;
		for (var r = 0; r < this.base.length; r++) {
			while (this.base[r].childNodes.length > 0) {
				this.base[r].removeChild(this.base[r].childNodes[0])
			}
			if (this.base[r].parentNode) {
				this.base[r].parentNode.removeChild(this.base[r])
			}
			this.base[r] = null
		}
		this.base = null;
		this.cont.onkeypress = null;
		this.cont.className = "";
		this.cont = null;
		for (var o in this) {
			this[o] = null
		}
		g = null
	};
	for (var c in this.items) {
		this.items[c].t = c;
		if (typeof(this.items[c]._index) == "undefined") {
			this.items[c]._index = true
		}
		if (!this.items[c].show) {
			this.items[c].show = function(a) {
				a.style.display = "";
				if (a._listObj) {
					for (var o = 0; o < a._listObj.length; o++) {
						a._listObj[o].show(a._listBase[o])
					}
				}
			}
		}
		if (!this.items[c].hide) {
			this.items[c].hide = function(a) {
				a.style.display = "none";
				if (a._listObj) {
					for (var o = 0; o < a._listObj.length; o++) {
						a._listObj[o].hide(a._listBase[o])
					}
				}
			}
		}
		if (!this.items[c].isHidden) {
			this.items[c].isHidden = function(a) {
				return (a.style.display == "none")
			}
		}
		if (!this.items[c].userEnable) {
			this.items[c].userEnable = function(a) {
				a._udis = false
			}
		}
		if (!this.items[c].userDisable) {
			this.items[c].userDisable = function(a) {
				a._udis = true
			}
		}
		if (!this.items[c].isUserEnabled) {
			this.items[c].isUserEnabled = function(a) {
				return (a._udis !== true)
			}
		}
		if (!this.items[c].getType) {
			this.items[c].getType = function() {
				return this.t
			}
		}
		if (!this.items[c].isExist) {
			this.items[c].isExist = function() {
				return true
			}
		}
		if (!this.items[c]._validate) {
			this.items[c]._validate = function(s) {
				if (!s._validate || !s._enabled) {
					return true
				}
				if (s._type == "ch") {
					var x = (this.isChecked(s) ? this.getValue(s) : 0)
				} else {
					var x = this.getValue(s)
				}
				var o = true;
				for (var w = 0; w < s._validate.length; w++) {
					var a = "is" + s._validate[w];
					if ((x == null || x.length == 0) && a != "isNotEmpty" && s._type != "container") {} else {
						var u = dhtmlxValidation[a];
						if (s._type == "container" && typeof(u) == "function") {
							u = function() {
								return true
							}
						}
						if (typeof(u) != "function" && typeof(s._validate[w]) == "function") {
							u = s._validate[w]
						}
						if (typeof(u) != "function" && typeof(window[s._validate[w]]) == "function") {
							u = window[s._validate[w]]
						}
						o = ((typeof(u) == "function" ? u(x, s._idd) : new RegExp(s._validate[w]).test(x)) && o);
						u = null
					}
				}
				if (!(s.callEvent("onValidate" + (o ? "Success" : "Error"), [s._idd, x, o]) === false)) {
					s.getForm().setValidateCss(s._idd, o)
				}
				return o
			}
		}
	}
	this._locked = false;
	this._doLock = function(o) {
		var a = (o === true ? true : false);
		if (this._locked == a) {
			return
		} else {
			this._locked = a
		}
		this._autoCheck(!this._locked)
	};
	this.lock = function() {
		this._doLock(true)
	};
	this.unlock = function() {
		this._doLock(false)
	};
	this.isLocked = function() {
		return this._locked
	};
	this.setNumberFormat = function(r, o, a, q) {
		return this.doWithItem(r, "setNumberFormat", o, a, q)
	};
	window.dhx4._enableDataLoading(this, "_initObj", "_xmlToObject", "items", {
		struct: true,
		data: true
	});
	window.dhx4._eventable(this);
	this.attachEvent("_onButtonClick", function(a, o) {
		this.callEvent("onButtonClick", [a, o])
	});
	this._updateBlocks = function() {
		this.forEachItem(function(a) {
			if (g.getItemType(a) == "block" || g.getItemType(a) == "combo") {
				g.doWithItem(a, "_setCss", g.skin, g.cont.style.fontSize)
			}
		})
	};
	this._isObj = function(a) {
		return (a != null && typeof(a) == "object" && typeof(a.length) == "undefined")
	};
	this._copyObj = function(s) {
		if (this._isObj(s)) {
			var q = {};
			for (var o in s) {
				if (typeof(s[o]) == "object" && s[o] != null) {
					q[o] = this._copyObj(s[o])
				} else {
					q[o] = s[o]
				}
			}
		} else {
			var q = [];
			for (var o = 0; o < s.length; o++) {
				if (typeof(s[o]) == "object" && s[o] != null) {
					q[o] = this._copyObj(s[o])
				} else {
					q[o] = s[o]
				}
			}
		}
		return q
	};
	if (l != null && typeof(l) == "object") {
		this._initObj(this._copyObj(l))
	}
	if (this._parentForm) {
		this._updateBlocks()
	}
	this._ccActive = false;
	this._ccTm = null;
	return this
}
dhtmlXForm.prototype.getInput = function(a) {
	return this.doWithItem(a, "getInput")
};
dhtmlXForm.prototype.getSelect = function(a) {
	return this.doWithItem(a, "getSelect")
};
dhtmlXForm.prototype.items = {};
dhtmlXForm.prototype.items.checkbox = {
	render: function(a, c) {
		a._type = "ch";
		a._enabled = true;
		a._checked = false;
		a._value = (typeof(c.value) == "undefined" ? null : String(c.value));
		a._ro = (c.readonly == true);
		if (c._autoInputWidth !== false) {
			c.inputWidth = 14
		}
		this.doAddLabel(a, c);
		this.doAddInput(a, c, "INPUT", "TEXT", true, true, "dhxform_textarea");
		a.childNodes[a._ll ? 1 : 0].className += " dhxform_img_node";
		var g = document.createElement("DIV");
		g.className = "dhxform_img chbx0";
		a.appendChild(g);
		if (!isNaN(c.inputLeft)) {
			a.childNodes[a._ll ? 1 : 0].style.left = parseInt(c.inputLeft) + "px"
		}
		if (!isNaN(c.inputTop)) {
			a.childNodes[a._ll ? 1 : 0].style.top = parseInt(c.inputTop) + "px"
		}
		a.childNodes[a._ll ? 1 : 0].appendChild(g);
		a.childNodes[a._ll ? 1 : 0].firstChild.value = String(c.value);
		a._updateImgNode = function(m, n) {
			var l = m.childNodes[m._ll ? 1 : 0].lastChild;
			l.className = (n ? "dhxform_actv_c" : "dhxform_img") + " " + (m._checked ? "chbx1" : "chbx0");
			m = l = null
		};
		a._doOnFocus = function(l) {
			l.getForm().callEvent("onFocus", [l._idd])
		};
		a._doOnBlur = function(l) {
			l.getForm().callEvent("onBlur", [l._idd])
		};
		a._doOnKeyUpDown = function(m, l) {
			this.callEvent(m, [this.childNodes[this._ll ? 0 : 1].childNodes[0], l, this._idd])
		};
		if (c.checked == true) {
			this.check(a)
		}
		if (c.hidden == true) {
			this.hide(a)
		}
		if (c.disabled == true) {
			this.userDisable(a)
		}
		this.doAttachEvents(a);
		return this
	},
	destruct: function(a) {
		a._doOnFocus = a._doOnBlur = a._updateImgNode = null;
		this.doUnloadNestedLists(a);
		this.doDestruct(a)
	},
	doAddLabel: function(c, g) {
		var a = document.createElement("DIV");
		a.className = "dhxform_label " + g.labelAlign;
		if (g.wrap == true) {
			a.style.whiteSpace = "normal"
		}
		if (c._ll) {
			c.insertBefore(a, c.firstChild)
		} else {
			c.appendChild(a)
		}
		if (typeof(g.tooltip) != "undefined") {
			a.title = g.tooltip
		}
		a.innerHTML = "<div class='dhxform_label_nav_link' onfocus='if(this.parentNode.parentNode._updateImgNode)this.parentNode.parentNode._updateImgNode(this.parentNode.parentNode,true);this.parentNode.parentNode._doOnFocus(this.parentNode.parentNode);' onblur='if(this.parentNode.parentNode._updateImgNode)this.parentNode.parentNode._updateImgNode(this.parentNode.parentNode,false);this.parentNode.parentNode._doOnBlur(this.parentNode.parentNode);' onkeypress='var e=event||window.arguments[0];if(e.keyCode==32||e.charCode==32){e.cancelBubble=true;if(e.preventDefault)e.preventDefault();else e.returnValue=false;_dhxForm_doClick(this,\"mousedown\");return false;}' onkeyup='var e=event||window.arguments[0];this.parentNode.parentNode._doOnKeyUpDown(\"onKeyUp\",e);' onkeydown='var e=event||window.arguments[0];this.parentNode.parentNode._doOnKeyUpDown(\"onKeyDown\",e);' " + (window.dhx4.isIPad ? "ontouchstart='var e=event;e.preventDefault();_dhxForm_doClick(this,\"mousedown\");' " : "") + "role='link' tabindex='0'>" + g.label + (g.info ? "<span class='dhxform_info'>[?]</span>" : "") + (c._required ? "<span class='dhxform_item_required'>*</span>" : "") + "</div>";
		if (!isNaN(g.labelWidth)) {
			a.firstChild.style.width = parseInt(g.labelWidth) + "px"
		}
		if (!isNaN(g.labelHeight)) {
			a.firstChild.style.height = parseInt(g.labelHeight) + "px"
		}
		if (!isNaN(g.labelLeft)) {
			a.style.left = parseInt(g.labelLeft) + "px"
		}
		if (!isNaN(g.labelTop)) {
			a.style.top = parseInt(g.labelTop) + "px"
		}
	},
	doAddInput: function(D, F, g, n, o, A, s) {
		var y = document.createElement("DIV");
		y.className = "dhxform_control";
		if (D._ll) {
			D.appendChild(y)
		} else {
			D.insertBefore(y, D.firstChild)
		}
		var x = document.createElement(g);
		x.className = s;
		x.name = D._idd;
		x._idd = D._idd;
		x.id = F.uid;
		if (typeof(n) == "string") {
			x.type = n
		}
		if (g == "INPUT" || g == "TEXTAREA") {
			x.onkeyup = function(u) {
				u = u || event;
				D.callEvent("onKeyUp", [this, u, this._idd])
			};
			x.onkeydown = function(u) {
				u = u || event;
				D.callEvent("onKeyDown", [this, u, this._idd])
			}
		}
		y.appendChild(x);
		if (F.readonly) {
			this.setReadonly(D, true)
		}
		if (F.hidden == true) {
			this.hide(D)
		}
		if (F.disabled == true) {
			this.userDisable(D)
		}
		if (o) {
			if (!isNaN(F.inputLeft)) {
				y.style.left = parseInt(F.inputLeft) + "px"
			}
			if (!isNaN(F.inputTop)) {
				y.style.top = parseInt(F.inputTop) + "px"
			}
		}
		var v = "";
		var m = false;
		if (A) {
			if (!isNaN(F.inputWidth)) {
				v += "width:" + parseInt(F.inputWidth) + "px;";
				m = true
			}
			if (!isNaN(F.inputHeight)) {
				v += "height:" + parseInt(F.inputHeight) + "px;"
			}
		}
		if (typeof(F.style) == "string") {
			v += F.style
		}
		x.style.cssText = v;
		if (F.maxLength) {
			x.setAttribute("maxLength", F.maxLength)
		}
		if (F.connector) {
			x.setAttribute("connector", F.connector)
		}
		var C = (dhtmlXForm.prototype.items[this.t] != null ? dhtmlXForm.prototype.items[this.t]._dimFix == true : false);
		if (m && ({
				input: 1,
				password: 1,
				select: 1,
				multiselect: 1,
				calendar: 1,
				colorpicker: 1
			}[this.t] == 1 || C)) {
			if (dhtmlXForm.prototype.items[this.t]._dim == null) {
				var c = document.createElement("DIV");
				c.className = "dhxform_dim_test_" + D.getForm().skin;
				document.body.appendChild(c);
				var a = y.parentNode;
				var E = y.nextSibling;
				c.appendChild(y);
				var r = parseInt(x.style.width);
				var q = (dhx4.isFF || dhx4.isIE || dhx4.isChrome || dhx4.isOpera ? x.offsetWidth : x.clientWidth);
				dhtmlXForm.prototype.items[this.t]._dim = q - r;
				if (E != null) {
					a.insertBefore(y, E)
				} else {
					a.appendChild(y)
				}
				c.parentNode.removeChild(c);
				a = E = c = null
			}
			x.style.width = parseInt(x.style.width) - dhtmlXForm.prototype.items[this.t]._dim + "px"
		}
		if (typeof(F.note) == "object") {
			var l = document.createElement("DIV");
			l.className = "dhxform_note";
			l.style.width = (isNaN(F.note.width) ? x.offsetWidth : parseInt(F.note.width)) + "px";
			l._w = F.note.width;
			l.innerHTML = F.note.text;
			y.appendChild(l);
			l = null
		}
	},
	doUnloadNestedLists: function(a) {
		if (!a._list) {
			return
		}
		for (var c = 0; c < a._list.length; c++) {
			a._list[c].unload();
			a._list[c] = null;
			a._listObj[c] = null;
			a._listBase[c].parentNode.removeChild(a._listBase[c]);
			a._listBase[c] = null
		}
		a._list = null;
		a._listObj = null;
		a._listBase = null
	},
	doDestruct: function(a) {
		a.callEvent = null;
		a.checkEvent = null;
		a.getForm = null;
		a._autoCheck = null;
		a._checked = null;
		a._enabled = null;
		a._idd = null;
		a._type = null;
		a._value = null;
		a._group = null;
		a.onselectstart = null;
		a.childNodes[a._ll ? 1 : 0].onmousedown = null;
		a.childNodes[a._ll ? 1 : 0].ontouchstart = null;
		a.childNodes[a._ll ? 0 : 1].onmousedown = null;
		a.childNodes[a._ll ? 0 : 1].ontouchstart = null;
		a.childNodes[a._ll ? 0 : 1].childNodes[0].onfocus = null;
		a.childNodes[a._ll ? 0 : 1].childNodes[0].onblur = null;
		a.childNodes[a._ll ? 0 : 1].childNodes[0].onkeypress = null;
		a.childNodes[a._ll ? 0 : 1].childNodes[0].onkeyup = null;
		a.childNodes[a._ll ? 0 : 1].childNodes[0].onkeydown = null;
		a.childNodes[a._ll ? 0 : 1].childNodes[0].onmousedown = null;
		a.childNodes[a._ll ? 0 : 1].childNodes[0].ontouchstart = null;
		a.childNodes[a._ll ? 0 : 1].removeChild(a.childNodes[a._ll ? 0 : 1].childNodes[0]);
		while (a.childNodes.length > 0) {
			a.removeChild(a.childNodes[0])
		}
		a.parentNode.removeChild(a);
		a = null
	},
	doAttachEvents: function(c) {
		var a = this;
		c.childNodes[c._ll ? 1 : 0][window.dhx4.isIPad ? "ontouchstart" : "onmousedown"] = function(l) {
			l = l || event;
			if (l.preventDefault) {
				l.preventDefault()
			}
			var g = (l.target || l.srcElement);
			if (!this.parentNode._enabled || this.parentNode._ro || (typeof(g.className) != "undefined" && g.className == "dhxform_note")) {
				l.cancelBubble = true;
				if (l.preventDefault) {
					l.preventDefault()
				} else {
					l.returnValue = false
				}
				return false
			}
			a.doClick(this.parentNode)
		};
		c.childNodes[c._ll ? 0 : 1].childNodes[0][window.dhx4.isIPad ? "ontouchstart" : "onmousedown"] = function(l) {
			l = l || event;
			if (l.preventDefault) {
				l.preventDefault()
			}
			if (!this.parentNode.parentNode._enabled) {
				l.cancelBubble = true;
				if (l.preventDefault) {
					l.preventDefault()
				} else {
					l.returnValue = false
				}
				return false
			}
			var g = l.target || l.srcElement;
			if (typeof(g.className) != "undefined" && g.className == "dhxform_info") {
				this.parentNode.parentNode.callEvent("onInfo", [this.parentNode.parentNode._idd]);
				l.cancelBubble = true;
				if (l.preventDefault) {
					l.preventDefault()
				} else {
					l.returnValue = false
				}
				return false
			}
			a.doClick(this.parentNode.parentNode)
		}
	},
	doClick: function(a) {
		a.childNodes[a._ll ? 0 : 1].childNodes[0].focus();
		if (!a._enabled || a._ro) {
			return
		}
		if (a.checkEvent("onBeforeChange")) {
			if (a.callEvent("onBeforeChange", [a._idd, a._value, a._checked]) !== true) {
				return
			}
		}
		this.setChecked(a, !a._checked);
		a._autoCheck();
		a.callEvent("onChange", [a._idd, a._value, a._checked])
	},
	doCheckValue: function(a) {
		if (a._checked && a._enabled) {
			a.childNodes[a._ll ? 1 : 0].firstChild.name = String(a._idd);
			a.childNodes[a._ll ? 1 : 0].firstChild.value = this.getValue(a)
		} else {
			a.childNodes[a._ll ? 1 : 0].firstChild.name = "";
			a.childNodes[a._ll ? 1 : 0].firstChild.value = ""
		}
	},
	setChecked: function(a, c) {
		a._checked = (c === true ? true : false);
		a.childNodes[a._ll ? 1 : 0].lastChild.className = a.childNodes[a._ll ? 1 : 0].lastChild.className.replace(/chbx[0-1]{1}/gi, "") + (a._checked ? " chbx1" : " chbx0");
		this.doCheckValue(a)
	},
	check: function(a) {
		this.setChecked(a, true)
	},
	unCheck: function(a) {
		this.setChecked(a, false)
	},
	isChecked: function(a) {
		return a._checked
	},
	enable: function(a) {
		if (String(a.className).search("disabled") >= 0) {
			a.className = String(a.className).replace(/disabled/gi, "")
		}
		a._enabled = true;
		a.childNodes[a._ll ? 0 : 1].childNodes[0].tabIndex = 0;
		a.childNodes[a._ll ? 0 : 1].childNodes[0].removeAttribute("disabled");
		this.doCheckValue(a)
	},
	disable: function(a) {
		if (String(a.className).search("disabled") < 0) {
			a.className += " disabled"
		}
		a._enabled = false;
		if (a._updateImgNode != null) {
			a._updateImgNode(a, false)
		}
		a.childNodes[a._ll ? 0 : 1].childNodes[0].tabIndex = -1;
		a.childNodes[a._ll ? 0 : 1].childNodes[0].setAttribute("disabled", "true");
		this.doCheckValue(a)
	},
	isEnabled: function(a) {
		return a._enabled
	},
	setText: function(a, c) {
		a.childNodes[a._ll ? 0 : 1].childNodes[0].innerHTML = c + (a._required ? "<span class='dhxform_item_required'>*</span>" : "")
	},
	getText: function(a) {
		return a.childNodes[a._ll ? 0 : 1].childNodes[0].innerHTML.replace(/<span class=\"dhxform_item_required\">[^<]*<\/span>/g, "")
	},
	setValue: function(a, c) {
		this.setChecked(a, (c === true || parseInt(c) == 1 || c == "true" || a._value === c))
	},
	getValue: function(a, c) {
		if (c == "realvalue") {
			return a._value
		}
		return ((typeof(a._value) == "undefined" || a._value == null) ? (a._checked ? 1 : 0) : a._value)
	},
	setReadonly: function(a, c) {
		a._ro = (c === true)
	},
	isReadonly: function(a) {
		return a._ro
	},
	setFocus: function(a) {
		a.childNodes[a._ll ? 0 : 1].childNodes[0].focus()
	}
};
dhtmlXForm.prototype.items.radio = {
	input: {},
	r: {},
	firstValue: {},
	render: function(g, l, c) {
		g._type = "ra";
		g._enabled = true;
		g._checked = false;
		g._group = l.name;
		g._value = l.value;
		g._uid = c;
		g._ro = (l.readonly == true);
		g._rName = g._rId + g._group;
		this.r[g._idd] = g;
		l.inputWidth = 14;
		this.doAddLabel(g, l);
		this.doAddInput(g, l, "INPUT", "TEXT", true, true, "dhxform_textarea");
		g.childNodes[g._ll ? 1 : 0].className += " dhxform_img_node";
		var m = document.createElement("DIV");
		m.className = "dhxform_img rdbt0";
		g.appendChild(m);
		if (!isNaN(l.inputLeft)) {
			g.childNodes[g._ll ? 1 : 0].style.left = parseInt(l.inputLeft) + "px"
		}
		if (!isNaN(l.inputTop)) {
			g.childNodes[g._ll ? 1 : 0].style.top = parseInt(l.inputTop) + "px"
		}
		g.childNodes[g._ll ? 1 : 0].appendChild(m);
		g.childNodes[g._ll ? 1 : 0].firstChild.name = "";
		g.childNodes[g._ll ? 1 : 0].firstChild.value = "";
		g._updateImgNode = function(o, q) {
			var n = o.childNodes[o._ll ? 1 : 0].lastChild;
			n.className = (q ? "dhxform_actv_r" : "dhxform_img") + " " + (o._checked ? "rdbt1" : "rdbt0");
			o = n = null
		};
		g._doOnFocus = function(n) {
			n.getForm().callEvent("onFocus", [n._group, n._value])
		};
		g._doOnBlur = function(n) {
			n.getForm().callEvent("onBlur", [n._group, n._value])
		};
		g._doOnKeyUpDown = function(o, n) {
			this.callEvent(o, [this.childNodes[this._ll ? 0 : 1].childNodes[0], n, this._group, this._value])
		};
		if (this.input[g._rName] == null) {
			var a = document.createElement("INPUT");
			a.type = "HIDDEN";
			a.name = l.name;
			a.firstValue = g._value;
			g.appendChild(a);
			this.input[g._rName] = a
		}
		if (!this.firstValue[g._rName]) {
			this.firstValue[g._rName] = l.value
		}
		if (l.checked == true) {
			this.check(g)
		}
		if (l.hidden == true) {
			this.hide(g)
		}
		if (l.disabled == true) {
			this.userDisable(g)
		}
		this.doAttachEvents(g);
		return this
	},
	destruct: function(l, m) {
		if (l.lastChild == this.input[l._rName]) {
			var g = false;
			for (var c in this.r) {
				if (!g && this.r[c]._group == l._group && this.r[c]._idd != l._idd) {
					this.r[c].appendChild(this.input[l._rName]);
					g = true
				}
			}
			if (!g) {
				this.input[l._rName].parentNode.removeChild(this.input[l._rName]);
				this.input[l._rName] = null;
				this.firstValue[l._rName] = null
			}
		}
		var n = l._idd;
		l._doOnFocus = l._doOnBlur = l._updateImgNode = null;
		this.doUnloadNestedLists(l);
		this.doDestruct(l);
		return n
	},
	doClick: function(c) {
		c.childNodes[c._ll ? 0 : 1].childNodes[0].focus();
		if (!(c._enabled && !c._checked)) {
			return
		}
		if (c._ro) {
			return
		}
		var a = [c._group, c._value, true];
		if (c.checkEvent("onBeforeChange")) {
			if (c.callEvent("onBeforeChange", a) !== true) {
				return
			}
		}
		this.setChecked(c, true);
		c.getForm()._autoCheck();
		c.callEvent("onChange", a)
	},
	doCheckValue: function(g) {
		var l = null;
		for (var c in this.r) {
			if (this.r[c]._checked && this.r[c]._group == g._group && this.r[c]._rId == g._rId) {
				l = this.r[c]._value
			}
		}
		if (l != null && this.r[c]._enabled) {
			this.input[g._rName].name = String(g._group);
			this.input[g._rName].value = l
		} else {
			this.input[g._rName].name = "";
			this.input[g._rName].value = ""
		}
		this.input[g._rName]._value = l
	},
	setChecked: function(m, n) {
		n = (n === true);
		for (var c in this.r) {
			if (this.r[c]._group == m._group && this.r[c]._rId == m._rId) {
				var l = false;
				if (this.r[c]._idd == m._idd) {
					if (this.r[c]._checked != n) {
						this.r[c]._checked = n;
						l = true
					}
				} else {
					if (this.r[c]._checked) {
						this.r[c]._checked = false;
						l = true
					}
				}
				if (l) {
					var g = this.r[c].childNodes[this.r[c]._ll ? 1 : 0].childNodes[1];
					g.className = g.className.replace(/rdbt[0-1]{1}/gi, "") + (this.r[c]._checked ? " rdbt1" : " rdbt0");
					g = null
				}
			}
		}
		this.doCheckValue(m)
	},
	getChecked: function(a) {
		return this.input[a._rName]._value
	},
	_getFirstValue: function(a) {
		return this.firstValue[a._rName]
	},
	_getId: function(a) {
		return a._idd
	},
	setValue: function(a, c) {}
};
(function() {
	for (var c in {
			doAddLabel: 1,
			doAddInput: 1,
			doDestruct: 1,
			doUnloadNestedLists: 1,
			doAttachEvents: 1,
			check: 1,
			unCheck: 1,
			isChecked: 1,
			enable: 1,
			disable: 1,
			isEnabled: 1,
			setText: 1,
			getText: 1,
			getValue: 1,
			setReadonly: 1,
			isReadonly: 1,
			setFocus: 1
		}) {
		dhtmlXForm.prototype.items.radio[c] = dhtmlXForm.prototype.items.checkbox[c]
	}
})();
dhtmlXForm.prototype.items.select = {
	render: function(a, c) {
		a._type = "se";
		a._enabled = true;
		a._value = null;
		a._newValue = null;
		this.doAddLabel(a, c);
		this.doAddInput(a, c, "SELECT", null, true, true, "dhxform_select");
		this.doAttachEvents(a);
		this.doLoadOpts(a, c);
		if (c.connector != null) {
			this.doLoadOptsConnector(a, c.connector)
		}
		if (typeof(c.value) != "undefined" && c.value != null) {
			this.setValue(a, c.value)
		}
		return this
	},
	destruct: function(a) {
		this.doUnloadNestedLists(a);
		a.callEvent = null;
		a.checkEvent = null;
		a.getForm = null;
		a._autoCheck = null;
		a._enabled = null;
		a._idd = null;
		a._type = null;
		a._value = null;
		a._newValue = null;
		a.onselectstart = null;
		a.childNodes[a._ll ? 1 : 0].childNodes[0].onclick = null;
		a.childNodes[a._ll ? 1 : 0].childNodes[0].onkeydown = null;
		a.childNodes[a._ll ? 1 : 0].childNodes[0].onchange = null;
		a.childNodes[a._ll ? 1 : 0].childNodes[0].onfocus = null;
		a.childNodes[a._ll ? 1 : 0].childNodes[0].onblur = null;
		a.childNodes[a._ll ? 1 : 0].childNodes[0].onkeyup = null;
		a.childNodes[a._ll ? 1 : 0].removeChild(a.childNodes[a._ll ? 1 : 0].childNodes[0]);
		while (a.childNodes.length > 0) {
			a.removeChild(a.childNodes[0])
		}
		a.parentNode.removeChild(a);
		a = null
	},
	doAddLabel: function(c, g) {
		var a = document.createElement("DIV");
		a.className = "dhxform_label " + g.labelAlign;
		a.innerHTML = "<label for='" + g.uid + "'>" + g.label + (g.info ? "<span class='dhxform_info'>[?]</span>" : "") + (c._required ? "<span class='dhxform_item_required'>*</span>" : "") + "</label>";
		if (g.wrap == true) {
			a.style.whiteSpace = "normal"
		}
		if (typeof(g.tooltip) != "undefined") {
			a.title = g.tooltip
		}
		c.appendChild(a);
		if (typeof(g.label) == "undefined" || g.label == null || g.label.length == 0) {
			a.style.display = "none"
		}
		if (!isNaN(g.labelWidth)) {
			a.style.width = parseInt(g.labelWidth) + "px"
		}
		if (!isNaN(g.labelHeight)) {
			a.style.height = parseInt(g.labelHeight) + "px"
		}
		if (!isNaN(g.labelLeft)) {
			a.style.left = parseInt(g.labelLeft) + "px"
		}
		if (!isNaN(g.labelTop)) {
			a.style.top = parseInt(g.labelTop) + "px"
		}
		if (g.info) {
			a.onclick = function(m) {
				m = m || event;
				var l = m.target || m.srcElement;
				if (typeof(l.className) != "undefined" && l.className == "dhxform_info") {
					this.parentNode.callEvent("onInfo", [this.parentNode._idd]);
					m.cancelBubble = true;
					if (m.preventDefault) {
						m.preventDefault()
					} else {
						m.returnValue = false
					}
					return false
				}
			}
		}
	},
	doAttachEvents: function(g) {
		var a = g.childNodes[g._ll ? 1 : 0].childNodes[0];
		var c = this;
		a.onclick = function() {
			c.doOnChange(this)
		};
		a.onkeydown = function(l) {
			l = l || event;
			c.doOnChange(this);
			this.parentNode.parentNode.callEvent("onKeyDown", [this, l, this.parentNode.parentNode._idd])
		};
		a.onchange = function() {
			c.doOnChange(this)
		};
		a.onkeyup = function(l) {
			l = l || event;
			this.parentNode.parentNode.callEvent("onKeyUp", [this, l, this.parentNode.parentNode._idd])
		};
		a = null;
		this.doAttachChangeLS(g)
	},
	doAttachChangeLS: function(c) {
		var a = c.childNodes[c._ll ? 1 : 0].childNodes[0];
		a.onfocus = function() {
			var g = this.parentNode.parentNode;
			g.getForm()._ccActivate(g._idd, this, g.getForm().getItemValue(g._idd, true));
			g.getForm().callEvent("onFocus", [g._idd]);
			g = null
		};
		a.onblur = function() {
			var g = this.parentNode.parentNode;
			g.getForm()._ccDeactivate(g._idd);
			g.getForm().callEvent("onBlur", [g._idd]);
			g = null
		};
		a = null
	},
	doValidate: function(a) {
		if (a.getForm().live_validate) {
			this._validate(a)
		}
	},
	doLoadOpts: function(o, m, s) {
		var r = o.childNodes[o._ll ? 1 : 0].childNodes[0];
		var a = m.options;
		var l = false;
		for (var c = 0; c < a.length; c++) {
			var n = a[c].text || a[c].label;
			if (!n || typeof(n) == "undefined") {
				n = ""
			}
			var g = new Option(n, a[c].value);
			if (typeof(a[c].img_src) == "string") {
				g.setAttribute("img_src", a[c].img_src)
			}
			r.options.add(g);
			if (typeof(a[c].selected) != "undefined" && window.dhx4.s2b(a[c].selected) == true) {
				g.selected = true;
				o._value = a[c].value;
				l = true
			}
			if (typeof(a[c].checked) != "undefined" && window.dhx4.s2b(a[c].checked) == true) {
				g.setAttribute("checked", "1")
			}
			if (typeof(a[c].img) != "undefined") {
				g.setAttribute("img", a[c].img)
			}
			if (typeof(a[c].img_dis) != "undefined") {
				g.setAttribute("img_dis", a[c].img_dis)
			}
		}
		if (!l && r.selectedIndex >= 0) {
			o._value = r.options[r.selectedIndex].value
		}
		if (s === true) {
			o.callEvent("onOptionsLoaded", [o._idd])
		}
		this._checkNoteWidth(o)
	},
	doLoadOptsConnector: function(g, a) {
		var c = this;
		g._connector_working = true;
		window.dhx4.ajax.get(a, function(o) {
			o = o.xmlDoc.responseXML;
			if (o == null) {
				return
			}
			var l = o.getElementsByTagName("data");
			if (l == null || l[0] == null) {
				return
			}
			l = l[0];
			var n = [];
			for (var s = 0; s < l.childNodes.length; s++) {
				if (typeof(l.childNodes[s].tagName) != "undefined" && String(l.childNodes[s].tagName).toLowerCase() == "item") {
					var m = l.childNodes[s];
					n.push({
						label: m.getAttribute("label"),
						value: m.getAttribute("value"),
						selected: (m.getAttribute("selected") != null)
					});
					m = null
				}
			}
			c.doLoadOpts(g, {
				options: n
			}, true);
			g._connector_working = false;
			if (g._connector_value != null) {
				c.setValue(g, g._connector_value);
				g._connector_value = null
			}
			c = g = null
		})
	},
	doOnChange: function(g) {
		var a = g.parentNode.parentNode;
		a._newValue = (g.selectedIndex >= 0 ? g.options[g.selectedIndex].value : null);
		if (a._newValue != a._value) {
			if (a.checkEvent("onBeforeChange")) {
				if (a.callEvent("onBeforeChange", [a._idd, a._value, a._newValue]) !== true) {
					for (var c = 0; c < g.options.length; c++) {
						if (g.options[c].value == a._value) {
							g.options[c].selected = true
						}
					}
					return
				}
			}
			a._value = a._newValue;
			a.callEvent("onChange", [a._idd, a._value]);
			if (a._type == "se" && a.getForm().live_validate) {
				this._validate(a)
			}
		}
		a._autoCheck()
	},
	setText: function(a, c) {
		if (!c) {
			c = ""
		}
		a.childNodes[a._ll ? 0 : 1].childNodes[0].innerHTML = c + (a._required ? "<span class='dhxform_item_required'>*</span>" : "");
		a.childNodes[a._ll ? 0 : 1].style.display = (c.length == 0 || c == null ? "none" : "")
	},
	getText: function(a) {
		return a.childNodes[a._ll ? 0 : 1].childNodes[0].innerHTML.replace(/<span class=\"dhxform_item_required\">[^<]*<\/span>/g, "")
	},
	enable: function(a) {
		if (String(a.className).search("disabled") >= 0) {
			a.className = String(a.className).replace(/disabled/gi, "")
		}
		a._enabled = true;
		a.childNodes[a._ll ? 1 : 0].childNodes[0].removeAttribute("disabled")
	},
	disable: function(a) {
		if (String(a.className).search("disabled") < 0) {
			a.className += " disabled"
		}
		a._enabled = false;
		a.childNodes[a._ll ? 1 : 0].childNodes[0].setAttribute("disabled", true)
	},
	getOptions: function(a) {
		return a.childNodes[a._ll ? 1 : 0].childNodes[0].options
	},
	setValue: function(c, l) {
		if (c._connector_working) {
			c._connector_value = l;
			return
		}
		var a = this.getOptions(c);
		for (var g = 0; g < a.length; g++) {
			if (a[g].value == l) {
				a[g].selected = true;
				c._value = a[g].value
			}
		}
		if (c._list != null && c._list.length > 0) {
			c.getForm()._autoCheck()
		}
		c.getForm()._ccReload(c._idd, c._value)
	},
	getValue: function(g) {
		var a = -1;
		var c = this.getOptions(g);
		for (var l = 0; l < c.length; l++) {
			if (c[l].selected) {
				a = c[l].value
			}
		}
		return a
	},
	setWidth: function(c, a) {
		c.childNodes[c._ll ? 1 : 0].childNodes[0].style.width = a + "px"
	},
	getSelect: function(a) {
		return a.childNodes[a._ll ? 1 : 0].childNodes[0]
	},
	setFocus: function(a) {
		a.childNodes[a._ll ? 1 : 0].childNodes[0].focus()
	},
	_checkNoteWidth: function(c) {
		var a;
		if (c.childNodes[c._ll ? 1 : 0].childNodes[1] != null) {
			a = c.childNodes[c._ll ? 1 : 0].childNodes[1];
			if (a.className != null && a.className.search(/dhxform_note/gi) >= 0 && a._w == "auto") {
				a.style.width = c.childNodes[c._ll ? 1 : 0].childNodes[0].offsetWidth + "px"
			}
		}
		a = null
	}
};
(function() {
	for (var c in {
			doAddInput: 1,
			doUnloadNestedLists: 1,
			isEnabled: 1
		}) {
		dhtmlXForm.prototype.items.select[c] = dhtmlXForm.prototype.items.checkbox[c]
	}
})();
dhtmlXForm.prototype.items.multiselect = {
	doLoadOpts: function(l, n, o) {
		var c = l.childNodes[l._ll ? 1 : 0].childNodes[0];
		c.multiple = true;
		if (!isNaN(n.size)) {
			c.size = Number(n.size)
		}
		l._value = [];
		l._newValue = [];
		var g = n.options;
		for (var m = 0; m < g.length; m++) {
			var a = new Option(g[m].text || g[m].label, g[m].value);
			c.options.add(a);
			if (g[m].selected == true || g[m].selected == "true") {
				a.selected = true;
				l._value.push(g[m].value)
			}
		}
		if (o === true) {
			l.callEvent("onOptionsLoaded", [l._idd])
		}
		this._checkNoteWidth(l)
	},
	doAttachEvents: function(g) {
		var a = g.childNodes[g._ll ? 1 : 0].childNodes[0];
		var c = this;
		a.onfocus = function() {
			c.doOnChange(this);
			var l = this.parentNode.parentNode;
			l.getForm().callEvent("onFocus", [l._idd]);
			l = null
		};
		a.onblur = function() {
			c.doOnChange(this);
			var l = this.parentNode.parentNode;
			l.getForm().callEvent("onBlur", [l._idd]);
			l = null
		};
		a.onclick = function() {
			c.doOnChange(this);
			var l = this.parentNode.parentNode;
			l._autoCheck();
			l = null
		}
	},
	doOnChange: function(l) {
		var c = l.parentNode.parentNode;
		c._newValue = [];
		for (var g = 0; g < l.options.length; g++) {
			if (l.options[g].selected) {
				c._newValue.push(l.options[g].value)
			}
		}
		if ((c._value).sort().toString() != (c._newValue).sort().toString()) {
			if (c.checkEvent("onBeforeChange")) {
				if (c.callEvent("onBeforeChange", [c._idd, c._value, c._newValue]) !== true) {
					var a = {};
					for (var g = 0; g < c._value.length; g++) {
						a[c._value[g]] = true
					}
					for (var g = 0; g < l.options.length; g++) {
						l.options[g].selected = (a[l.options[g].value] == true)
					}
					a = null;
					return
				}
			}
			c._value = [];
			for (var g = 0; g < c._newValue.length; g++) {
				c._value.push(c._newValue[g])
			}
			c.callEvent("onChange", [c._idd, c._value])
		}
		c._autoCheck()
	},
	setValue: function(g, m) {
		var a = {};
		if (typeof(m) == "string") {
			m = m.split(",")
		}
		if (typeof(m) != "object") {
			m = [m]
		}
		for (var l = 0; l < m.length; l++) {
			a[m[l]] = true
		}
		var c = this.getOptions(g);
		for (var l = 0; l < c.length; l++) {
			c[l].selected = (a[c[l].value] == true)
		}
		g._autoCheck()
	},
	getValue: function(g) {
		var a = [];
		var c = this.getOptions(g);
		for (var l = 0; l < c.length; l++) {
			if (c[l].selected) {
				a.push(c[l].value)
			}
		}
		return a
	}
};
(function() {
	for (var c in dhtmlXForm.prototype.items.select) {
		if (!dhtmlXForm.prototype.items.multiselect[c]) {
			dhtmlXForm.prototype.items.multiselect[c] = dhtmlXForm.prototype.items.select[c]
		}
	}
})();
dhtmlXForm.prototype.items.input = {
	render: function(n, o) {
		var m = (!isNaN(o.rows));
		n._type = "ta";
		n._enabled = true;
		this.doAddLabel(n, o);
		this.doAddInput(n, o, (m ? "TEXTAREA" : "INPUT"), (m ? null : "TEXT"), true, true, "dhxform_textarea");
		this.doAttachEvents(n);
		if (m) {
			n.childNodes[n._ll ? 1 : 0].childNodes[0].rows = Number(o.rows) + (window.dhx4.isIE6 ? 1 : 0)
		}
		if (typeof(o.numberFormat) != "undefined") {
			var l, g = null,
				q = null;
			if (typeof(o.numberFormat) != "string") {
				l = o.numberFormat[0];
				g = o.numberFormat[1] || null;
				q = o.numberFormat[2] || null
			} else {
				l = o.numberFormat;
				if (typeof(o.groupSep) == "string") {
					g = o.groupSep
				}
				if (typeof(o.decSep) == "string") {
					q = o.decSep
				}
			}
			this.setNumberFormat(n, l, g, q, false)
		}
		this.setValue(n, o.value);
		return this
	},
	doAttachEvents: function(c) {
		var a = this;
		if (c._type == "ta" || c._type == "se" || c._type == "pw") {
			c.childNodes[c._ll ? 1 : 0].childNodes[0].onfocus = function() {
				var g = this.parentNode.parentNode;
				if (g._df != null) {
					this.value = g._value || ""
				}
				g.getForm()._ccActivate(g._idd, this, this.value);
				g.getForm().callEvent("onFocus", [g._idd]);
				g = null
			}
		}
		c.childNodes[c._ll ? 1 : 0].childNodes[0].onblur = function() {
			var g = this.parentNode.parentNode;
			g.getForm()._ccDeactivate(g._idd);
			a.updateValue(g, true);
			if (g.getForm().live_validate) {
				a._validate(g)
			}
			g.getForm().callEvent("onBlur", [g._idd]);
			g = null
		}
	},
	updateValue: function(m, a) {
		var n = m.childNodes[m._ll ? 1 : 0].childNodes[0].value;
		var l = m.getForm();
		var c = (l._ccActive == true && l._formLS != null && l._formLS[m._idd] != null);
		l = null;
		if (!c && m._df != null && n == window.dhx4.template._getFmtValue(m._value, m._df)) {
			return
		}
		if (!a && m._df != null && m._value == n && n == window.dhx4.template._getFmtValue(n, m._df)) {
			return
		}
		var g = this;
		if (m._value != n) {
			if (m.checkEvent("onBeforeChange")) {
				if (m.callEvent("onBeforeChange", [m._idd, m._value, n]) !== true) {
					if (m._df != null) {
						g.setValue(m, m._value)
					} else {
						m.childNodes[m._ll ? 1 : 0].childNodes[0].value = m._value
					}
					return
				}
			}
			if (m._df != null && a) {
				g.setValue(m, n)
			} else {
				m._value = n
			}
			m.callEvent("onChange", [m._idd, n]);
			return
		}
		if (m._df != null && a) {
			this.setValue(m, m._value)
		}
	},
	setValue: function(g, l) {
		g._value = (typeof(l) != "undefined" && l != null ? l : "");
		var c = (String(g._value) || "");
		var a = g.childNodes[g._ll ? 1 : 0].childNodes[0];
		if (g._df != null) {
			c = window.dhx4.template._getFmtValue(c, g._df)
		}
		if (a.value != c) {
			a.value = c;
			g.getForm()._ccReload(g._idd, c)
		}
		a = null
	},
	getValue: function(a) {
		var c = a.getForm();
		if (c._formLS && c._formLS[a._idd] != null) {
			this.updateValue(a)
		}
		c = null;
		return (typeof(a._value) != "undefined" && a._value != null ? a._value : "")
	},
	setReadonly: function(a, c) {
		a._ro = (c === true);
		if (a._ro) {
			a.childNodes[a._ll ? 1 : 0].childNodes[0].setAttribute("readOnly", "true")
		} else {
			a.childNodes[a._ll ? 1 : 0].childNodes[0].removeAttribute("readOnly")
		}
	},
	isReadonly: function(a) {
		if (!a._ro) {
			a._ro = false
		}
		return a._ro
	},
	getInput: function(a) {
		return a.childNodes[a._ll ? 1 : 0].childNodes[0]
	},
	setNumberFormat: function(l, m, g, n, c) {
		if (typeof(c) != "boolean") {
			c = true
		}
		if (m == "") {
			l._df = null;
			if (c) {
				this.setValue(l, l._value)
			}
			return true
		}
		if (typeof(m) != "string") {
			return
		}
		var a = window.dhx4.template._parseFmt(m, g, n);
		if (a == false) {
			return false
		} else {
			l._df = a
		}
		if (c) {
			this.setValue(l, l._value)
		}
		return true
	}
};
(function() {
	for (var c in {
			doAddLabel: 1,
			doAddInput: 1,
			destruct: 1,
			doUnloadNestedLists: 1,
			setText: 1,
			getText: 1,
			enable: 1,
			disable: 1,
			isEnabled: 1,
			setWidth: 1,
			setFocus: 1
		}) {
		dhtmlXForm.prototype.items.input[c] = dhtmlXForm.prototype.items.select[c]
	}
})();
dhtmlXForm.prototype.items.password = {
	render: function(a, c) {
		a._type = "pw";
		a._enabled = true;
		this.doAddLabel(a, c);
		this.doAddInput(a, c, "INPUT", "PASSWORD", true, true, "dhxform_textarea");
		this.doAttachEvents(a);
		this.setValue(a, c.value);
		return this
	}
};
(function() {
	for (var c in {
			doAddLabel: 1,
			doAddInput: 1,
			doAttachEvents: 1,
			destruct: 1,
			doUnloadNestedLists: 1,
			setText: 1,
			getText: 1,
			setValue: 1,
			getValue: 1,
			updateValue: 1,
			enable: 1,
			disable: 1,
			isEnabled: 1,
			setWidth: 1,
			setReadonly: 1,
			isReadonly: 1,
			setFocus: 1,
			getInput: 1
		}) {
		dhtmlXForm.prototype.items.password[c] = dhtmlXForm.prototype.items.input[c]
	}
})();
dhtmlXForm.prototype.items.file = {
	render: function(g, l) {
		g._type = "fl";
		g._enabled = true;
		this.doAddLabel(g, l);
		this.doAddInput(g, l, "INPUT", "FILE", true, false, "dhxform_textarea");
		var a = g.childNodes[g._ll ? 1 : 0].childNodes[0];
		var c = this;
		a.onfocus = function() {
			var m = this.parentNode.parentNode;
			m.getForm().callEvent("onFocus", [m._idd]);
			m = null
		};
		a.onblur = function() {
			var m = this.parentNode.parentNode;
			if (m.getForm().live_validate) {
				c._validate(m)
			}
			m.getForm().callEvent("onBlur", [m._idd]);
			m = null
		};
		a = null;
		g.childNodes[g._ll ? 1 : 0].childNodes[0].onchange = function() {
			g.callEvent("onChange", [g._idd, this.value])
		};
		return this
	},
	setValue: function() {},
	getValue: function(a) {
		return a.childNodes[a._ll ? 1 : 0].childNodes[0].value
	}
};
(function() {
	for (var c in {
			doAddLabel: 1,
			doAddInput: 1,
			destruct: 1,
			doUnloadNestedLists: 1,
			setText: 1,
			getText: 1,
			getInput: 1,
			enable: 1,
			disable: 1,
			isEnabled: 1,
			setWidth: 1
		}) {
		dhtmlXForm.prototype.items.file[c] = dhtmlXForm.prototype.items.input[c]
	}
})();
dhtmlXForm.prototype.items.label = {
	_index: false,
	render: function(c, g) {
		c._type = "lb";
		c._enabled = true;
		c._checked = true;
		var a = document.createElement("DIV");
		a.className = "dhxform_txt_label2" + (g._isTopmost ? " topmost" : "");
		a.innerHTML = g.label;
		c.appendChild(a);
		if (g.hidden == true) {
			this.hide(c)
		}
		if (g.disabled == true) {
			this.userDisable(c)
		}
		if (!isNaN(g.labelWidth)) {
			a.style.width = parseInt(g.labelWidth) + "px"
		}
		if (!isNaN(g.labelHeight)) {
			a.style.height = parseInt(g.labelHeight) + "px"
		}
		if (!isNaN(g.labelLeft)) {
			a.style.left = parseInt(g.labelLeft) + "px"
		}
		if (!isNaN(g.labelTop)) {
			a.style.top = parseInt(g.labelTop) + "px"
		}
		return this
	},
	destruct: function(a) {
		this.doUnloadNestedLists(a);
		a._autoCheck = null;
		a._enabled = null;
		a._type = null;
		a.callEvent = null;
		a.checkEvent = null;
		a.getForm = null;
		a.onselectstart = null;
		a.parentNode.removeChild(a);
		a = null
	},
	enable: function(a) {
		if (String(a.className).search("disabled") >= 0) {
			a.className = String(a.className).replace(/disabled/gi, "")
		}
		a._enabled = true
	},
	disable: function(a) {
		if (String(a.className).search("disabled") < 0) {
			a.className += " disabled"
		}
		a._enabled = false
	},
	setText: function(a, c) {
		a.firstChild.innerHTML = c
	},
	getText: function(a) {
		return a.firstChild.innerHTML
	}
};
(function() {
	for (var c in {
			doUnloadNestedLists: 1,
			isEnabled: 1
		}) {
		dhtmlXForm.prototype.items.label[c] = dhtmlXForm.prototype.items.checkbox[c]
	}
})();
dhtmlXForm.prototype.items.button = {
	render: function(g, l) {
		g._type = "bt";
		g._enabled = true;
		g._name = l.name;
		g.className = String(g.className).replace("item_label_top", "item_label_left").replace("item_label_right", "item_label_left");
		if (!isNaN(l.width)) {
			var a = Math.max(l.width, 10)
		}
		var c = (typeof(a) != "undefined");
		g._doOnKeyUpDown = function(n, m) {
			this.callEvent(n, [this.childNodes[0].childNodes[0], m, this._idd])
		};
		g.innerHTML = '<div class="dhxform_btn" role="link" tabindex="0" dir="ltr"><div class="dhxform_btn_txt" ' + (c ? ' style="width:' + a + 'px;"' : "") + ">" + l.value + '</div><div class="dhxform_btn_filler" disabled="true"></div></div>';
		if (!isNaN(l.inputLeft)) {
			g.childNodes[0].style.left = parseInt(l.inputLeft) + "px"
		}
		if (!isNaN(l.inputTop)) {
			g.childNodes[0].style.top = parseInt(l.inputTop) + "px"
		}
		if (l.hidden == true) {
			this.hide(g)
		}
		if (l.disabled == true) {
			this.userDisable(g)
		}
		if (typeof(l.tooltip) != "undefined") {
			g.firstChild.title = l.tooltip
		}
		g.onselectstart = function(m) {
			m = m || event;
			m.cancelBubble = true;
			if (m.preventDefault) {
				m.preventDefault()
			} else {
				m.returnValue = false
			}
			return false
		};
		g.firstChild.onselectstart = function(m) {
			m = m || event;
			m.cancelBubble = true;
			if (m.preventDefault) {
				m.preventDefault()
			} else {
				m.returnValue = false
			}
			return false
		};
		g.firstChild.onkeypress = function(m) {
			m = m || event;
			if ((m.keyCode == 32 || m.charCode == 32 || m.keyCode == 13 || m.charCode == 13) && !this.parentNode._busy) {
				this.parentNode._busy = true;
				m.cancelBubble = true;
				if (m.preventDefault) {
					m.preventDefault()
				} else {
					m.returnValue = false
				}
				_dhxForm_doClick(this.childNodes[0], ["mousedown", "mouseup"]);
				return false
			}
		};
		g.firstChild.onfocus = function() {
			this.parentNode._doOnFocus(this.parentNode)
		};
		g.firstChild.onblur = function() {
			_dhxForm_doClick(this.childNodes[0], "mouseout");
			this.parentNode._doOnBlur(this.parentNode)
		};
		g.firstChild.onkeyup = function(m) {
			this.parentNode._doOnKeyUpDown("onKeyUp", m || event)
		};
		g.firstChild.onkeydown = function(m) {
			this.parentNode._doOnKeyUpDown("onKeyDown", m || event)
		};
		g.firstChild.onmouseover = function() {
			var m = this.parentNode;
			if (!m._enabled) {
				return
			}
			this._isOver = true;
			this.className = "dhxform_btn dhxform_btn_over";
			m = null
		};
		g.firstChild.onmouseout = function() {
			var m = this.parentNode;
			if (!m._enabled) {
				return
			}
			this.className = "dhxform_btn";
			this._allowClick = false;
			this._pressed = false;
			this._isOver = false;
			m = null
		};
		g.firstChild.ontouchstart = g.firstChild.onmousedown = function(n) {
			n = n || event;
			if (n.type == "touchstart" && n.preventDefault) {
				n.preventDefault()
			}
			if (n.button >= 2) {
				return
			}
			if (this._pressed) {
				return
			}
			var m = this.parentNode;
			if (!m._enabled) {
				return
			}
			this.className = "dhxform_btn dhxform_btn_pressed";
			this._allowClick = true;
			this._pressed = true;
			m = null
		};
		g.firstChild.ontouchend = g.firstChild.onmouseup = function(n) {
			n = n || event;
			if (n.button >= 2) {
				return
			}
			if (!this._pressed) {
				return
			}
			var m = this.parentNode;
			if (!m._enabled) {
				return
			}
			m._busy = false;
			this.className = "dhxform_btn" + (this._isOver ? " dhxform_btn_over" : "");
			if (this._pressed && this._allowClick) {
				m.callEvent("_onButtonClick", [m._name, m._cmd])
			}
			this._allowClick = false;
			this._pressed = false;
			m = null
		};
		g._doOnFocus = function(m) {
			m.getForm().callEvent("onFocus", [m._idd])
		};
		g._doOnBlur = function(m) {
			m.getForm().callEvent("onBlur", [m._idd])
		};
		return this
	},
	destruct: function(a) {
		this.doUnloadNestedLists(a);
		a.callEvent = null;
		a.checkEvent = null;
		a.getForm = null;
		a._autoCheck = null;
		a._type = null;
		a._enabled = null;
		a._cmd = null;
		a._name = null;
		a._doOnFocus = null;
		a._doOnBlur = null;
		a._doOnKeyUpDown = null;
		a.onselectstart = null;
		a.firstChild.onselectstart = null;
		a.firstChild.onkeypress = null;
		a.firstChild.ontouchstart = null;
		a.firstChild.ontouchend = null;
		a.firstChild.onfocus = null;
		a.firstChild.onblur = null;
		a.firstChild.onkeyup = null;
		a.firstChild.onkeydown = null;
		a.firstChild.onmouseover = null;
		a.firstChild.onmouseout = null;
		a.firstChild.onmousedown = null;
		a.firstChild.onmouseup = null;
		while (a.childNodes.length > 0) {
			a.removeChild(a.childNodes[0])
		}
		a.parentNode.removeChild(a);
		a = null
	},
	enable: function(a) {
		if (String(a.className).search("disabled") >= 0) {
			a.className = String(a.className).replace(/disabled/gi, "")
		}
		a._enabled = true;
		a.childNodes[0].removeAttribute("disabled");
		a.childNodes[0].setAttribute("role", "link");
		a.childNodes[0].setAttribute("tabIndex", "0")
	},
	disable: function(a) {
		if (String(a.className).search("disabled") < 0) {
			a.className += " disabled"
		}
		a._enabled = false;
		a.childNodes[0].setAttribute("disabled", "true");
		a.childNodes[0].removeAttribute("role");
		a.childNodes[0].removeAttribute("tabIndex")
	},
	setText: function(a, c) {
		a.childNodes[0].childNodes[0].innerHTML = c
	},
	getText: function(a) {
		return a.childNodes[0].childNodes[0].innerHTML
	},
	setFocus: function(a) {
		a.childNodes[0].focus()
	}
};
(function() {
	for (var c in {
			doUnloadNestedLists: 1,
			isEnabled: 1
		}) {
		dhtmlXForm.prototype.items.button[c] = dhtmlXForm.prototype.items.checkbox[c]
	}
})();
dhtmlXForm.prototype.items.hidden = {
	_index: false,
	render: function(c, g) {
		c.style.display = "none";
		c._name = g.name;
		c._type = "hd";
		c._enabled = true;
		var a = document.createElement("INPUT");
		a.type = "HIDDEN";
		a.name = g.name;
		a.value = (g.value || "");
		c.appendChild(a);
		return this
	},
	destruct: function(a) {
		this.doUnloadNestedLists(a);
		while (a.childNodes.length > 0) {
			a.removeChild(a.childNodes[0])
		}
		a._autoCheck = null;
		a._name = null;
		a._type = null;
		a._enabled = null;
		a.onselectstart = null;
		a.callEvent = null;
		a.checkEvent = null;
		a.getForm = null;
		a.parentNode.removeChild(a);
		a = null
	},
	enable: function(a) {
		a._enabled = true;
		a.childNodes[0].setAttribute("name", a._name)
	},
	disable: function(a) {
		a._enabled = false;
		a.childNodes[0].removeAttribute("name")
	},
	show: function() {},
	hide: function() {},
	isHidden: function() {
		return true
	},
	setValue: function(a, c) {
		a.childNodes[0].value = c
	},
	getValue: function(a) {
		return a.childNodes[0].value
	},
	getInput: function(a) {
		return a.childNodes[0]
	}
};
(function() {
	for (var c in {
			doUnloadNestedLists: 1,
			isEnabled: 1
		}) {
		dhtmlXForm.prototype.items.hidden[c] = dhtmlXForm.prototype.items.checkbox[c]
	}
})();
dhtmlXForm.prototype.items.list = {
	_index: false,
	render: function(a, c) {
		a._type = "list";
		a._enabled = true;
		a._isNestedForm = true;
		a.style.paddingLeft = a._ofsNested + "px";
		a.className = "dhxform_base_nested" + (a._custom_css || "");
		return [this, new dhtmlXForm(a, null, c)]
	},
	destruct: function(a) {}
};
dhtmlXForm.prototype.items.fieldset = {
	_index: false,
	render: function(c, l) {
		c._type = "fs";
		if (typeof(parseInt(l.inputWidth)) == "number") {}
		c._width = l.width;
		c._enabled = true;
		c._checked = true;
		c.className = "fs_" + l.position + (typeof(l.className) == "string" ? " " + l.className : "");
		var g = document.createElement("FIELDSET");
		g.className = "dhxform_fs";
		var m = String(l.labelAlign).replace("align_", "");
		g.innerHTML = "<legend class='fs_legend' align='" + m + "' style='text-align:" + m + "'>" + l.label + "</legend>";
		c.appendChild(g);
		if (!isNaN(l.inputLeft)) {
			g.style.left = parseInt(l.inputLeft) + "px"
		}
		if (!isNaN(l.inputTop)) {
			g.style.top = parseInt(l.inputTop) + "px"
		}
		if (l.inputWidth != "auto") {
			if (!isNaN(l.inputWidth)) {
				g.style.width = parseInt(l.inputWidth) + "px";
				var a = parseInt(g.style.width);
				if (g.offsetWidth > a) {
					g.style.width = a + (a - g.offsetWidth) + "px"
				}
			}
		}
		c._addSubListNode = function() {
			var n = document.createElement("DIV");
			n._custom_css = " dhxform_fs_nested";
			this.childNodes[0].appendChild(n);
			return n
		};
		if (l.hidden == true) {
			this.hide(c)
		}
		if (l.disabled == true) {
			this.userDisable(c)
		}
		return this
	},
	destruct: function(a) {
		this.doUnloadNestedLists(a);
		a._checked = null;
		a._enabled = null;
		a._idd = null;
		a._type = null;
		a._width = null;
		a.onselectstart = null;
		a._addSubListNode = null;
		a._autoCheck = null;
		a.callEvent = null;
		a.checkEvent = null;
		a.getForm = null;
		while (a.childNodes.length > 0) {
			a.removeChild(a.childNodes[0])
		}
		a.parentNode.removeChild(a);
		a = null
	},
	setText: function(a, c) {
		a.childNodes[0].childNodes[0].innerHTML = c
	},
	getText: function(a) {
		return a.childNodes[0].childNodes[0].innerHTML
	},
	enable: function(a) {
		a._enabled = true;
		if (String(a.className).search("disabled") >= 0) {
			a.className = String(a.className).replace(/disabled/gi, "")
		}
	},
	disable: function(a) {
		a._enabled = false;
		if (String(a.className).search("disabled") < 0) {
			a.className += " disabled"
		}
	},
	setWidth: function(c, a) {
		c.childNodes[0].style.width = a + "px";
		c._width = a
	},
	getWidth: function(a) {
		return a._width
	}
};
(function() {
	for (var c in {
			doUnloadNestedLists: 1,
			isEnabled: 1
		}) {
		dhtmlXForm.prototype.items.fieldset[c] = dhtmlXForm.prototype.items.checkbox[c]
	}
})();
dhtmlXForm.prototype.items.block = {
	_index: false,
	render: function(c, g) {
		c._type = "bl";
		c._width = g.width;
		c._enabled = true;
		c._checked = true;
		c.className = "block_" + g.position + (typeof(g.className) == "string" ? " " + g.className : "");
		var a = document.createElement("DIV");
		a.className = "dhxform_obj_" + c.getForm().skin + " dhxform_block";
		a.style.fontSize = c.getForm().cont.style.fontSize;
		if (g.style) {
			a.style.cssText = g.style
		}
		if (typeof(g.id) != "undefined") {
			a.id = g.id
		}
		c.appendChild(a);
		if (!isNaN(g.inputLeft)) {
			a.style.left = parseInt(g.inputLeft) + "px"
		}
		if (!isNaN(g.inputTop)) {
			a.style.top = parseInt(g.inputTop) + "px"
		}
		if (g.inputWidth != "auto") {
			if (!isNaN(g.inputWidth)) {
				a.style.width = parseInt(g.inputWidth) + "px"
			}
		}
		if (!isNaN(g.blockOffset)) {
			c._ofsNested = g.blockOffset
		}
		c._addSubListNode = function() {
			var l = document.createElement("DIV");
			l._inBlcok = true;
			if (typeof(this._ofsNested) != "undefined") {
				l._ofsNested = this._ofsNested
			}
			this.childNodes[0].appendChild(l);
			return l
		};
		if (g.hidden == true) {
			this.hide(c)
		}
		if (g.disabled == true) {
			this.userDisable(c)
		}
		return this
	},
	_setCss: function(a, g, c) {
		a.firstChild.className = "dhxform_obj_" + g + " dhxform_block";
		a.firstChild.style.fontSize = c
	}
};
(function() {
	for (var c in {
			enable: 1,
			disable: 1,
			isEnabled: 1,
			setWidth: 1,
			getWidth: 1,
			doUnloadNestedLists: 1,
			destruct: 1
		}) {
		dhtmlXForm.prototype.items.block[c] = dhtmlXForm.prototype.items.fieldset[c]
	}
})();
dhtmlXForm.prototype.items.newcolumn = {
	_index: false
};
dhtmlXForm.prototype.items.template = {
	render: function(c, g) {
		var a = (!isNaN(g.rows));
		c._type = "tp";
		c._enabled = true;
		if (g.format != null) {
			if (typeof(g.format) == "function") {
				c.format = g.format
			} else {
				if (typeof(g.format) == "string" && typeof(window[g.format]) == "function") {
					c.format = window[g.format]
				}
			}
		}
		if (c.format == null) {
			c.format = function(l, m) {
				return m
			}
		}
		this.doAddLabel(c, g);
		this.doAddInput(c, g, "DIV", null, true, true, "dhxform_item_template");
		this.setValue(c, g.value || "");
		return this
	},
	destruct: function(a) {
		a.format = null;
		this.d2(a);
		a = null
	},
	setValue: function(a, c) {
		a._value = c;
		a.childNodes[a._ll ? 1 : 0].childNodes[0].innerHTML = a.format(a._idd, a._value)
	},
	getValue: function(a) {
		return a._value
	},
	enable: function(a) {
		if (String(a.className).search("disabled") >= 0) {
			a.className = String(a.className).replace(/disabled/gi, "")
		}
		a._enabled = true
	},
	disable: function(a) {
		if (String(a.className).search("disabled") < 0) {
			a.className += " disabled"
		}
		a._enabled = false
	}
};
(function() {
	dhtmlXForm.prototype.items.template.d2 = dhtmlXForm.prototype.items.input.destruct;
	for (var c in {
			doAddLabel: 1,
			doAddInput: 1,
			doUnloadNestedLists: 1,
			setText: 1,
			getText: 1,
			isEnabled: 1,
			setWidth: 1
		}) {
		dhtmlXForm.prototype.items.template[c] = dhtmlXForm.prototype.items.select[c]
	}
})();
dhtmlXForm.prototype._ulToObject = function(m, s) {
	var o = [];
	for (var c = 0; c < m.childNodes.length; c++) {
		if (String(m.childNodes[c].tagName || "").toLowerCase() == "li") {
			var g = {};
			var v = m.childNodes[c];
			for (var u = 0; u < s.length; u++) {
				if (v.getAttribute(s[u]) != null) {
					g[String(s[u]).replace("ftype", "type")] = v.getAttribute(s[u])
				}
			}
			if (!g.label) {
				try {
					g.label = v.firstChild.nodeValue
				} catch (r) {}
			}
			var l = v.getElementsByTagName("UL");
			if (l[0] != null) {
				g[(g.type == "select" ? "options" : "list")] = dhtmlXForm.prototype._ulToObject(l[0], s)
			}
			for (var u = 0; u < v.childNodes.length; u++) {
				if (String(v.childNodes[u].tagName || "").toLowerCase() == "userdata") {
					if (!g.userdata) {
						g.userdata = {}
					}
					g.userdata[v.childNodes[u].getAttribute("name")] = v.childNodes[u].firstChild.nodeValue
				}
			}
			o[o.length] = g
		}
		if (String(m.childNodes[c].tagName || "").toLowerCase() == "div") {
			var g = {};
			g.type = "label";
			try {
				g.label = m.childNodes[c].firstChild.nodeValue
			} catch (r) {}
			o[o.length] = g
		}
	}
	return o
};
dhtmlXForm.prototype.setUserData = function(m, g, l, a) {
	if (typeof(a) != "undefined") {
		var c = this.doWithItem([m, g], "_getId");
		if (c != null) {
			m = c;
			g = l;
			l = a
		}
	}
	if (!this._userdata) {
		this._userdata = {}
	}
	this._userdata[m] = (this._userdata[m] || {});
	this._userdata[m][g] = l
};
dhtmlXForm.prototype.getUserData = function(l, g, a) {
	if (typeof(a) != "undefined") {
		var c = this.doWithItem([l, g], "_getId");
		if (c != null) {
			l = c;
			g = a
		}
	}
	if (this._userdata != null && typeof(this._userdata[l]) != "undefined" && typeof(this._userdata[l][g]) != "undefined") {
		return this._userdata[l][g]
	}
	return ""
};
dhtmlXForm.prototype.setRTL = function(a) {
	this._rtl = (a === true ? true : false);
	if (this._rtl) {
		if (String(this.cont).search(/dhxform_rtl/gi) < 0) {
			this.cont.className += " dhxform_rtl"
		}
	} else {
		if (String(this.cont).search(/dhxform_rtl/gi) >= 0) {
			this.cont.className = String(this.cont.className).replace(/dhxform_rtl/gi, "")
		}
	}
};
_dhxForm_doClick = function(l, c) {
	if (typeof(c) == "object") {
		var a = c[1];
		c = c[0]
	}
	if (document.createEvent) {
		var g = document.createEvent("MouseEvents");
		g.initEvent(c, true, false);
		l.dispatchEvent(g)
	} else {
		if (document.createEventObject) {
			var g = document.createEventObject();
			g.button = 1;
			l.fireEvent("on" + c, g)
		}
	}
	if (a) {
		window.setTimeout(function() {
			_dhxForm_doClick(l, a)
		}, 100)
	}
};
dhtmlXForm.prototype.setFormData = function(g) {
	for (var c in g) {
		var l = this.getItemType(c);
		switch (l) {
			case "checkbox":
				this[g[c] == true || parseInt(g[c]) == 1 || g[c] == "true" || g[c] == this.getItemValue(c, "realvalue") ? "checkItem" : "uncheckItem"](c);
				break;
			case "radio":
				this.checkItem(c, g[c]);
				break;
			case "input":
			case "textarea":
			case "password":
			case "select":
			case "multiselect":
			case "hidden":
			case "template":
			case "combo":
			case "calendar":
			case "colorpicker":
			case "editor":
				this.setItemValue(c, g[c]);
				break;
			default:
				if (this["setFormData_" + l]) {
					this["setFormData_" + l](c, g[c])
				} else {
					if (!this.hId) {
						this.hId = this._genStr(12)
					}
					this.setUserData(this.hId, c, g[c])
				}
				break
		}
	}
};
dhtmlXForm.prototype.getFormData = function(x, n) {
	var c = {};
	var u = this;
	for (var w in this.itemPull) {
		var s = this.itemPull[w]._idd;
		var y = this.itemPull[w]._type;
		if (y == "ch") {
			c[s] = (this.isItemChecked(s) ? this.getItemValue(s) : 0)
		}
		if (y == "ra" && !c[this.itemPull[w]._group]) {
			c[this.itemPull[w]._group] = this.getCheckedValue(this.itemPull[w]._group)
		}
		if (y in {
				se: 1,
				ta: 1,
				pw: 1,
				hd: 1,
				tp: 1,
				fl: 1,
				calendar: 1,
				combo: 1,
				editor: 1,
				colorpicker: 1
			}) {
			c[s] = this.getItemValue(s, x)
		}
		if (this["getFormData_" + y]) {
			c[s] = this["getFormData_" + y](s)
		}
		if (y == "up") {
			var m = this.getItemValue(s);
			for (var l in m) {
				c[l] = m[l]
			}
		}
		if (this.itemPull[w]._list) {
			for (var g = 0; g < this.itemPull[w]._list.length; g++) {
				var o = this.itemPull[w]._list[g].getFormData(x, n);
				for (var v in o) {
					c[v] = o[v]
				}
			}
		}
	}
	if (!n && this.hId && this._userdata[this.hId]) {
		for (var w in this._userdata[this.hId]) {
			if (!c[w]) {
				c[w] = this._userdata[this.hId][w]
			}
		}
	}
	return c
};
dhtmlXForm.prototype.adjustParentSize = function() {
	var m = 0;
	var l = -1;
	for (var n = 0; n < this.base.length; n++) {
		m += this.base[n].firstChild.offsetWidth;
		if (this.base[n].offsetHeight > l) {
			l = this.base[n].offsetHeight
		}
	}
	var g = false;
	try {
		g = (this.cont.parentNode.parentNode.parentNode.parentNode._isCell == true);
		if (g) {
			var a = this.cont.parentNode.parentNode.parentNode.parentNode
		}
	} catch (o) {}
	if (g && typeof(a) != "undefined") {
		if (m > 0) {
			a.setWidth(m + 10)
		}
		if (l > 0) {
			a.setHeight(l + a.firstChild.firstChild.offsetHeight + 5)
		}
		g = a = null;
		return
	}
	var c = false;
	try {
		c = (this.cont.parentNode.parentNode.parentNode._isWindow == true);
		if (c) {
			var r = this.cont.parentNode.parentNode;
			if (typeof(r.callEvent) == "function") {
				this.cont.style.display = "none";
				r.callEvent("_setCellSize", [m + 15, l + 15]);
				this.cont.style.display = ""
			}
		}
	} catch (o) {}
};
dhtmlXForm.prototype.reset = function() {
	if (this.callEvent("onBeforeReset", [this.formId, this.getFormData()])) {
		if (this._last_load_data) {
			this.setFormData(this._last_load_data)
		}
		this.callEvent("onAfterReset", [this.formId])
	}
};
dhtmlXForm.prototype.send = function(c, o, q, l) {
	if (typeof o == "function") {
		q = o;
		o = "post"
	} else {
		o = (o == "get" ? "get" : "post")
	}
	if (l !== true && !this.validate()) {
		return
	}
	var n = this.getFormData(true);
	var m = [];
	for (var g in n) {
		m.push(g + "=" + encodeURIComponent(n[g]))
	}
	var a = function(r) {
		if (q) {
			q.call(this, r, r.xmlDoc.responseText)
		}
	};
	if (o == "get") {
		window.dhx4.ajax.get(c + (c.indexOf("?") == -1 ? "?" : "&") + m.join("&"), a)
	} else {
		window.dhx4.ajax.post(c, m.join("&"), a)
	}
};
dhtmlXForm.prototype.save = function(a, c) {};
dhtmlXForm.prototype.dummy = function() {};
dhtmlXForm.prototype._changeFormId = function(c, a) {
	this.formId = a
};
dhtmlXForm.prototype._dp_init = function(a) {
	a._methods = ["dummy", "dummy", "_changeFormId", "dummy"];
	a._getRowData = function(l, c) {
		var g = this.obj.getFormData(true);
		g[this.action_param] = this.obj.getUserData(l, this.action_param);
		return g
	};
	a._clearUpdateFlag = function() {};
	a.attachEvent("onAfterUpdate", function(g, l, m, c) {
		if (l == "inserted" || l == "updated") {
			this.obj.resetDataProcessor("updated");
			this.obj._last_load_data = this.obj.getFormData(true)
		}
		this.obj.callEvent("onAfterSave", [this.obj.formId, c]);
		return true
	});
	a.autoUpdate = false;
	a.setTransactionMode("POST", true);
	this.dp = a;
	this.formId = (new Date()).valueOf();
	this.resetDataProcessor("inserted");
	this.save = function() {
		if (!this.callEvent("onBeforeSave", [this.formId, this.getFormData()])) {
			return
		}
		if (!this.validate()) {
			return
		}
		a.sendData()
	}
};
dhtmlXForm.prototype.resetDataProcessor = function(a) {
	if (!this.dp) {
		return
	}
	this.dp.updatedRows = [];
	this.dp._in_progress = [];
	this.dp.setUpdated(this.formId, true, a)
};
dhtmlXForm.prototype._ccActivate = function(g, a, c) {
	if (!this._formLS) {
		this._formLS = {}
	}
	if (!this._formLS[g]) {
		this._formLS[g] = {
			input: a,
			value: c
		}
	}
	if (!this._ccActive) {
		this._ccActive = true;
		this._ccDo()
	}
	a = null
};
dhtmlXForm.prototype._ccDeactivate = function(a) {
	if (this._ccTm) {
		window.clearTimeout(this._ccTm)
	}
	this._ccActive = false;
	if (this._formLS != null && this._formLS[a] != null) {
		this._formLS[a].input = null;
		this._formLS[a] = null;
		delete this._formLS[a]
	}
};
dhtmlXForm.prototype._ccDo = function() {
	if (this._ccTm) {
		window.clearTimeout(this._ccTm)
	}
	for (var c in this._formLS) {
		var m = this._formLS[c].input;
		if (String(m.tagName).toLowerCase() == "select") {
			var g = "";
			if (m.selectedIndex >= 0 && m.selectedIndex < m.options.length) {
				g = m.options[m.selectedIndex].value
			}
		} else {
			var g = m.value
		}
		if (g != this._formLS[c].value) {
			this._formLS[c].value = g;
			this.callEvent("onInputChange", [m._idd, g, this])
		}
		m = null
	}
	if (this._ccActive) {
		var l = this;
		this._ccTm = window.setTimeout(function() {
			l._ccDo();
			l = null
		}, 100)
	}
};
dhtmlXForm.prototype._ccReload = function(c, a) {
	if (this._formLS && this._formLS[c]) {
		this._formLS[c].value = a
	}
};
dhtmlXForm.prototype._autoload = function() {
	var c = ["ftype", "name", "value", "label", "check", "checked", "disabled", "text", "rows", "select", "selected", "width", "style", "className", "labelWidth", "labelHeight", "labelLeft", "labelTop", "inputWidth", "inputHeight", "inputLeft", "inputTop", "position", "size"];
	var g = document.getElementsByTagName("UL");
	var l = [];
	for (var o = 0; o < g.length; o++) {
		if (g[o].className == "dhtmlxForm") {
			var n = document.createElement("DIV");
			l[l.length] = {
				nodeUL: g[o],
				nodeForm: n,
				data: dhtmlXForm.prototype._ulToObject(g[o], c),
				name: (g[o].getAttribute("name") || null)
			}
		}
	}
	for (var o = 0; o < l.length; o++) {
		l[o].nodeUL.parentNode.insertBefore(l[o].nodeForm, l[o].nodeUL);
		var r = new dhtmlXForm(l[o].nodeForm, l[o].data);
		if (l[o].name !== null) {
			window[l[o].name] = r
		}
		var m = (l[o].nodeUL.getAttribute("oninit") || null);
		l[o].nodeUL.parentNode.removeChild(l[o].nodeUL);
		l[o].nodeUL = null;
		l[o].nodeForm = null;
		l[o].data = null;
		l[o] = null;
		if (m) {
			if (typeof(m) == "function") {
				m()
			} else {
				if (typeof(window[m]) == "function") {
					window[m]()
				}
			}
		}
	}
	if (typeof(window.addEventListener) == "function") {
		window.removeEventListener("load", dhtmlXForm.prototype._autoload, false)
	} else {
		window.detachEvent("onload", dhtmlXForm.prototype._autoload)
	}
};
if (typeof(window.addEventListener) == "function") {
	window.addEventListener("load", dhtmlXForm.prototype._autoload, false)
} else {
	window.attachEvent("onload", dhtmlXForm.prototype._autoload)
}
if (typeof(window.dhtmlXCellObject) != "undefined") {
	dhtmlXCellObject.prototype.attachForm = function(a) {
		this.callEvent("_onBeforeContentAttach", ["form"]);
		var c = document.createElement("DIV");
		c.style.width = "100%";
		c.style.height = "100%";
		c.style.position = "relative";
		if (window.dhtmlx && dhtmlx.$customScroll) {
			dhtmlx.CustomScroll.enable(c)
		} else {
			c.style.overflow = "auto"
		}
		this._attachObject(c);
		this.dataType = "form";
		this.dataObj = new dhtmlXForm(c, a);
		this.dataObj.setSkin(this.conf.skin);
		c = null;
		this.callEvent("_onContentAttach", []);
		return this.dataObj
	}
}
dhtmlXForm.prototype.items.combo = {
	render: function(c, g) {
		c._type = "combo";
		c._enabled = true;
		c._value = null;
		c._newValue = null;
		this.doAddLabel(c, g);
		this.doAddInput(c, g, "SELECT", null, true, true, "dhxform_select");
		this.doAttachEvents(c);
		this.doLoadOpts(c, g);
		c.onselectstart = function(l) {
			return true
		};
		c.childNodes[c._ll ? 1 : 0].childNodes[0].setAttribute("mode", g.comboType || "");
		if (g.comboImagePath) {
			c.childNodes[c._ll ? 1 : 0].childNodes[0].setAttribute("imagePath", g.comboImagePath)
		}
		if (g.comboDefaultImage) {
			c.childNodes[c._ll ? 1 : 0].childNodes[0].setAttribute("defaultImage", g.comboDefaultImage)
		}
		if (g.comboDefaultImageDis) {
			c.childNodes[c._ll ? 1 : 0].childNodes[0].setAttribute("defaultImageDis", g.comboDefaultImageDis)
		}
		c._combo = new dhtmlXComboFromSelect(c.childNodes[c._ll ? 1 : 0].childNodes[0]);
		c._combo.setSkin(c.getForm().skin);
		c._combo._currentComboValue = c._combo.getSelectedValue();
		c._combo.getInput().id = g.uid;
		var a = this;
		c._combo.attachEvent("onChange", function() {
			a.doOnChange(this)
		});
		if (g.connector) {
			this.doLoadOptsConnector(c, g.connector)
		}
		if (g.filtering) {
			c._combo.enableFilteringMode(true)
		} else {
			if (g.serverFiltering) {
				c._combo.enableFilteringMode(true, g.serverFiltering, g.filterCache, g.filterSubLoad)
			}
		}
		if (g.readonly == true) {
			this.setReadonly(c, true)
		}
		if (g.style) {
			c._combo.DOMelem_input.style.cssText += g.style
		}
		c._combo.attachEvent("onFocus", function() {
			var l = this.cont.parentNode.parentNode;
			var m = l.getForm();
			if (m.skin == "dhx_terrace" && this.cont.className.search(/combo_in_focus/) < 0) {
				this.cont.className += " combo_in_focus"
			}
			m.callEvent("onFocus", [l._idd]);
			m = l = null
		});
		c._combo.attachEvent("onBlur", function() {
			var l = this.cont.parentNode.parentNode;
			var m = l.getForm();
			if (m.skin == "dhx_terrace" && this.cont.className.search(/combo_in_focus/) >= 0) {
				this.cont.className = this.cont.className.replace(/\s{0,}combo_in_focus/gi, "")
			}
			m.callEvent("onBlur", [l._idd]);
			m = l = null
		});
		return this
	},
	destruct: function(a) {
		a.childNodes[a._ll ? 1 : 0].childNodes[0].onchange = null;
		a._combo._currentComboValue = null;
		a._combo.unload();
		a._combo = null;
		a._apiChange = null;
		this.d2(a);
		a = null
	},
	doAttachEvents: function(c) {
		var a = this;
		c.childNodes[c._ll ? 1 : 0].childNodes[0].onchange = function() {
			a.doOnChange(this);
			a.doValidate(this.DOMParent.parentNode.parentNode)
		}
	},
	doValidate: function(a) {
		if (a.getForm().hot_validate) {
			this._validate(a)
		}
	},
	doOnChange: function(c) {
		var a = c.base.parentNode.parentNode.parentNode;
		if (a._apiChange) {
			return
		}
		c._newComboValue = c.getSelectedValue();
		if (c._newComboValue != c._currentComboValue) {
			if (a.checkEvent("onBeforeChange")) {
				if (a.callEvent("onBeforeChange", [a._idd, c._currentComboValue, c._newComboValue]) !== true) {
					window.setTimeout(function() {
						c.setComboValue(c._currentComboValue)
					}, 1);
					return false
				}
			}
			c._currentComboValue = c._newComboValue;
			a.callEvent("onChange", [a._idd, c._currentComboValue])
		}
		a._autoCheck(a._enabled)
	},
	doLoadOptsConnector: function(l, a) {
		var g = this;
		var c = l;
		l._connector_working = true;
		l._apiChange = true;
		l._combo.load(a, function() {
			c.callEvent("onOptionsLoaded", [c._idd]);
			c._connector_working = false;
			if (c._connector_value != null) {
				g.setValue(c, c._connector_value);
				c._connector_value = null
			}
			c._apiChange = false;
			g = c = null
		})
	},
	enable: function(a) {
		if (String(a.className).search("disabled") >= 0) {
			a.className = String(a.className).replace(/disabled/gi, "")
		}
		a._enabled = true;
		a._combo.enable()
	},
	disable: function(a) {
		if (String(a.className).search("disabled") < 0) {
			a.className += " disabled"
		}
		a._enabled = false;
		a._combo.disable()
	},
	getCombo: function(a) {
		return a._combo
	},
	setValue: function(a, c) {
		if (a._connector_working) {
			a._connector_value = c;
			return
		}
		a._apiChange = true;
		a._combo.setComboValue(c);
		a._combo._currentComboValue = a._combo.getActualValue();
		a._apiChange = false
	},
	getValue: function(a) {
		return a._combo.getActualValue()
	},
	setWidth: function(c, a) {
		c.childNodes[c._ll ? 1 : 0].childNodes[0].style.width = a + "px"
	},
	setReadonly: function(a, c) {
		if (!a._combo) {
			return
		}
		a._combo_ro = c;
		a._combo.readonly(a._combo_ro)
	},
	isReadonly: function(a, c) {
		return a._combo_ro || false
	},
	setFocus: function(a) {
		if (a._enabled) {
			a._combo.setFocus()
		}
	},
	_setCss: function(a, g, c) {
		a._combo.setFontSize(c, c)
	}
};
(function() {
	for (var c in {
			doAddLabel: 1,
			doAddInput: 1,
			doLoadOpts: 1,
			doUnloadNestedLists: 1,
			setText: 1,
			getText: 1,
			isEnabled: 1,
			_checkNoteWidth: 1
		}) {
		dhtmlXForm.prototype.items.combo[c] = dhtmlXForm.prototype.items.select[c]
	}
})();
dhtmlXForm.prototype.items.combo.d2 = dhtmlXForm.prototype.items.select.destruct;
dhtmlXForm.prototype.getCombo = function(a) {
	return this.doWithItem(a, "getCombo")
};
dhtmlXForm.prototype.items.calendar = {
	render: function(g, m) {
		var c = this;
		g._type = "calendar";
		g._enabled = true;
		var o = navigator.userAgent;
		var a = (o.indexOf("MSIE 6.0") >= 0 || o.indexOf("MSIE 7.0") >= 0 || o.indexOf("MSIE 8.0") >= 0);
		this.doAddLabel(g, m);
		this.doAddInput(g, m, "INPUT", "TEXT", true, true, "dhxform_textarea calendar");
		this.doAttachChangeLS(g);
		if (a) {
			g.childNodes[g._ll ? 1 : 0].childNodes[0].onfocus2 = g.childNodes[g._ll ? 1 : 0].childNodes[0].onfocus;
			g.childNodes[g._ll ? 1 : 0].childNodes[0].onfocus = function() {
				if (this._skipOnFocus == true) {
					this._skipOnFocus = false;
					return
				}
				this.onfocus2.apply(this, arguments)
			}
		}
		g.childNodes[g._ll ? 1 : 0].childNodes[0]._idd = g._idd;
		g.childNodes[g._ll ? 1 : 0].childNodes[0].onblur = function() {
			var n = this.parentNode.parentNode;
			if (n._c.base._formMouseDown) {
				n._c.base._formMouseDown = false;
				this._skipOnFocus = true;
				this.focus();
				this.value = this.value;
				n = null;
				return true
			}
			var q = n.getForm();
			q._ccDeactivate(n._idd);
			c.checkEnteredValue(this.parentNode.parentNode);
			if (q.live_validate) {
				c._validate(n)
			}
			q.callEvent("onBlur", [n._idd]);
			q = n = null
		};
		g._f = (m.dateFormat || null);
		g._f0 = (m.serverDateFormat || g._f);
		var l = g.getForm();
		g._c = new dhtmlXCalendarObject(g.childNodes[g._ll ? 1 : 0].childNodes[0], m.skin || l.skin || "dhx_skyblue");
		g._c._nullInInput = true;
		g._c.enableListener(g.childNodes[g._ll ? 1 : 0].childNodes[0]);
		if (g._f != null) {
			g._c.setDateFormat(g._f)
		}
		if (!window.dhx4.s2b(m.enableTime)) {
			g._c.hideTime()
		}
		if (window.dhx4.s2b(m.showWeekNumbers)) {
			g._c.showWeekNumbers()
		}
		if (!isNaN(m.weekStart)) {
			g._c.setWeekStartDay(m.weekStart)
		}
		if (typeof(m.calendarPosition) != "undefined") {
			g._c.setPosition(m.calendarPosition)
		}
		if (m.minutesInterval != null) {
			g._c.setMinutesInterval(m.minutesInterval)
		}
		g._c._itemIdd = g._idd;
		g._c.attachEvent("onBeforeChange", function(n) {
			if (g._value != n) {
				if (g.checkEvent("onBeforeChange")) {
					if (g.callEvent("onBeforeChange", [g._idd, g._value, n]) !== true) {
						return false
					}
				}
				g._tempValue = g._value = n;
				c.setValue(g, n, false);
				g.callEvent("onChange", [this._itemIdd, g._value])
			}
			return true
		});
		g._c.attachEvent("onClick", function() {
			g._tempValue = null
		});
		if (a) {
			g._c.base.onmousedown = function() {
				this._formMouseDown = true;
				return false
			}
		}
		this.setValue(g, m.value);
		l = null;
		return this
	},
	getCalendar: function(a) {
		return a._c
	},
	setSkin: function(a, c) {
		a._c.setSkin(c)
	},
	setValue: function(c, g, a) {
		if (!g || g == null || typeof(g) == "undefined" || g == "") {
			c._value = null;
			c.childNodes[c._ll ? 1 : 0].childNodes[0].value = ""
		} else {
			c._value = (g instanceof Date ? g : c._c._strToDate(g, c._f0 || c._c._dateFormat));
			c.childNodes[c._ll ? 1 : 0].childNodes[0].value = c._c._dateToStr(c._value, c._f || c._c._dateFormat)
		}
		if (a !== false) {
			c._c.setDate(c._value)
		}
	},
	getValue: function(c, a) {
		var g = c._tempValue || c._c.getDate();
		if (a === true && g == null) {
			return ""
		}
		return (a === true ? c._c._dateToStr(g, c._f0 || c._c._dateFormat) : g)
	},
	setDateFormat: function(c, a, g) {
		c._f = a;
		c._f0 = (g || c._f);
		c._c.setDateFormat(c._f);
		this.setValue(c, this.getValue(c))
	},
	destruct: function(a) {
		a._c.disableListener(a.childNodes[a._ll ? 1 : 0].childNodes[0]);
		a._c.unload();
		a._c = null;
		try {
			delete a._c
		} catch (c) {}
		a._f = null;
		try {
			delete a._f
		} catch (c) {}
		a._f0 = null;
		try {
			delete a._f0
		} catch (c) {}
		a.childNodes[a._ll ? 1 : 0].childNodes[0]._idd = null;
		a.childNodes[a._ll ? 1 : 0].childNodes[0].onblur = null;
		this.d2(a);
		a = null
	},
	checkEnteredValue: function(a) {
		this.setValue(a, a._c.getDate())
	}
};
(function() {
	for (var c in {
			doAddLabel: 1,
			doAddInput: 1,
			doUnloadNestedLists: 1,
			setText: 1,
			getText: 1,
			enable: 1,
			disable: 1,
			isEnabled: 1,
			setWidth: 1,
			setReadonly: 1,
			isReadonly: 1,
			setFocus: 1,
			getInput: 1
		}) {
		dhtmlXForm.prototype.items.calendar[c] = dhtmlXForm.prototype.items.input[c]
	}
})();
dhtmlXForm.prototype.items.calendar.doAttachChangeLS = dhtmlXForm.prototype.items.select.doAttachChangeLS;
dhtmlXForm.prototype.items.calendar.d2 = dhtmlXForm.prototype.items.input.destruct;
dhtmlXForm.prototype.getCalendar = function(a) {
	return this.doWithItem(a, "getCalendar")
};
dhtmlXForm.prototype.setCalendarDateFormat = function(c, a, g) {
	this.doWithItem(c, "setDateFormat", a, g)
};
dhtmlXForm.prototype.items.btn2state = {
	setChecked: function(a, c) {
		a._checked = (c === true ? true : false);
		a.childNodes[a._ll ? 1 : 0].lastChild.className = "dhxform_img " + a._cssName + "_" + (a._checked ? "1" : "0");
		this.doCheckValue(a)
	}
};
(function() {
	for (var c in dhtmlXForm.prototype.items.checkbox) {
		if (!dhtmlXForm.prototype.items.btn2state[c]) {
			dhtmlXForm.prototype.items.btn2state[c] = dhtmlXForm.prototype.items.checkbox[c]
		}
	}
})();
dhtmlXForm.prototype.items.btn2state.render2 = dhtmlXForm.prototype.items.btn2state.render;
dhtmlXForm.prototype.items.btn2state.render = function(a, c) {
	c._autoInputWidth = false;
	this.render2(a, c);
	a._type = "btn2state";
	a._cssName = (typeof(c.cssName) == "undefined" ? "btn2state" : c.cssName);
	a._updateImgNode = function() {};
	a._doOnFocus = function() {
		a.getForm().callEvent("onFocus", [a._idd])
	};
	a._doOnBlur = function() {
		a.getForm().callEvent("onBlur", [a._idd])
	};
	a._doOnKeyUpDown = function(l, g, m) {
		this.callEvent(l, [this.childNodes[this._ll ? 0 : 1].childNodes[0], g, this._idd])
	};
	this.setChecked(a, a._checked);
	return this
};
dhtmlXForm.prototype.setFormData_btn2state = function(a, c) {
	this[c == true || parseInt(c) == 1 || c == "true" || c == this.getItemValue(a) ? "checkItem" : "uncheckItem"](a)
};
dhtmlXForm.prototype.getFormData_btn2state = function(a) {
	return (this.isItemChecked(a) ? this.getItemValue(a) : 0)
};
dhtmlXForm.prototype.items.colorpicker = {
	colorpicker: {},
	render: function(g, l) {
		var c = this;
		g._type = "colorpicker";
		g._enabled = true;
		this.doAddLabel(g, l);
		this.doAddInput(g, l, "INPUT", "TEXT", true, true, "dhxform_textarea");
		g._value = (l.value || "");
		g.childNodes[g._ll ? 1 : 0].childNodes[0].value = g._value;
		var a = {
			input: g.childNodes[g._ll ? 1 : 0].childNodes[0],
			custom_colors: (window.dhx4.s2b(l.enableCustomColors) == true),
			skin: g.getForm().skin
		};
		this.colorpicker[g._idd] = new dhtmlXColorPicker(a);
		this.colorpicker[g._idd]._nodes[0].valueColor = null;
		this.colorpicker[g._idd].base.className += " dhtmlxcp_in_form";
		if (typeof(l.customColors) != "undefined") {
			this.colorpicker[g._idd].setCustomColors(l.customColors)
		}
		if (typeof(l.cpPosition) == "string") {
			this.colorpicker[g._idd].setPosition(l.cpPosition)
		}
		this.colorpicker[g._idd].attachEvent("onSelect", function(m) {
			if (g._value != m) {
				if (g.checkEvent("onBeforeChange")) {
					if (g.callEvent("onBeforeChange", [g._idd, g._value, m]) !== true) {
						g.childNodes[g._ll ? 1 : 0].childNodes[0].value = g._value;
						return
					}
				}
				g._value = m;
				c.setValue(g, m);
				g.callEvent("onChange", [g._idd, g._value])
			}
		});
		this.colorpicker[g._idd].attachEvent("onHide", function(m) {
			var n = g.childNodes[g._ll ? 1 : 0].childNodes[0];
			if (n.value != g._value) {
				n.value = g._value
			}
			n = null
		});
		g.childNodes[g._ll ? 1 : 0].childNodes[0]._idd = g._idd;
		return this
	},
	getColorPicker: function(a) {
		return this.colorpicker[a._idd]
	},
	destruct: function(a) {
		if (this.colorpicker[a._idd].unload) {
			this.colorpicker[a._idd].unload()
		}
		this.colorpicker[a._idd] = null;
		try {
			delete this.colorpicker[a._idd]
		} catch (c) {}
		a.childNodes[a._ll ? 1 : 0].childNodes[0]._idd = null;
		this.d2(a);
		a = null
	},
	setSkin: function(a, c) {
		this.colorpicker[a._idd].setSkin(c)
	}
};
(function() {
	for (var c in {
			doAddLabel: 1,
			doAddInput: 1,
			doUnloadNestedLists: 1,
			setText: 1,
			getText: 1,
			enable: 1,
			disable: 1,
			isEnabled: 1,
			setWidth: 1,
			setReadonly: 1,
			isReadonly: 1,
			setValue: 1,
			getValue: 1,
			updateValue: 1,
			setFocus: 1,
			getInput: 1
		}) {
		dhtmlXForm.prototype.items.colorpicker[c] = dhtmlXForm.prototype.items.input[c]
	}
})();
dhtmlXForm.prototype.items.colorpicker.d2 = dhtmlXForm.prototype.items.input.destruct;
dhtmlXForm.prototype.getColorPicker = function(a) {
	return this.doWithItem(a, "getColorPicker")
};
dhtmlXForm.prototype.items.container = {
	render: function(a, c) {
		a._type = "container";
		a._enabled = true;
		this.doAddLabel(a, c);
		this.doAddInput(a, c, "DIV", null, true, true, "dhxform_container");
		return this
	},
	getContainer: function(a) {
		return a.childNodes[a._ll ? 1 : 0].childNodes[0]
	},
	enable: function(a) {
		a._enabled = true;
		if (String(a.className).search("disabled") >= 0) {
			a.className = String(a.className).replace(/disabled/gi, "")
		}
		a.callEvent("onEnable", [a._idd])
	},
	disable: function(a) {
		a._enabled = false;
		if (String(a.className).search("disabled") < 0) {
			a.className += " disabled"
		}
		a.callEvent("onDisable", [a._idd])
	},
	doAttachEvents: function() {},
	setValue: function() {},
	getValue: function() {
		return null
	}
};
dhtmlXForm.prototype.getContainer = function(a) {
	return this.doWithItem(a, "getContainer")
};
(function() {
	for (var c in dhtmlXForm.prototype.items.input) {
		if (!dhtmlXForm.prototype.items.container[c]) {
			dhtmlXForm.prototype.items.container[c] = dhtmlXForm.prototype.items.input[c]
		}
	}
})();
dhtmlXForm.prototype.items.editor = {
	editor: {},
	render: function(g, l) {
		var a = (!isNaN(l.rows));
		g._type = "editor";
		g._enabled = true;
		g._editor_id = g.getForm().idPrefix + g._idd;
		this.doAddLabel(g, l);
		this.doAddInput(g, l, "DIV", null, true, true, "dhxform_item_template");
		g._value = (l.value || "");
		var c = this;
		this.editor[g._editor_id] = new dhtmlXEditor({
			parent: g.childNodes[g._ll ? 1 : 0].childNodes[0],
			content: g._value,
			iconsPath: l.iconsPath,
			toolbar: l.toolbar
		});
		this.editor[g._editor_id].attachEvent("onAccess", function(n, o) {
			g.callEvent("_onBeforeEditorAccess", []);
			_dhxForm_doClick(document.body, "click");
			if (n == "blur") {
				c.doOnBlur(g, this);
				g.callEvent("onBlur", [g._idd]);
				if (g.getForm().skin == "dhx_terrace") {
					var m = g.childNodes[g._ll ? 1 : 0].className;
					if (m.indexOf("dhxeditor_focus") >= 0) {
						g.childNodes[g._ll ? 1 : 0].className = (m).replace(/\s{0,}dhxeditor_focus/gi, "")
					}
				}
			} else {
				g.callEvent("onEditorAccess", [g._idd, n, o, this, g.getForm()]);
				g.callEvent("onFocus", [g._idd]);
				if (g.getForm().skin == "dhx_terrace") {
					var m = g.childNodes[g._ll ? 1 : 0].className;
					if (m.indexOf("dhxeditor_focus") == -1) {
						g.childNodes[g._ll ? 1 : 0].className += " dhxeditor_focus"
					}
				}
			}
		});
		this.editor[g._editor_id].attachEvent("onToolbarClick", function(m) {
			g.callEvent("onEditorToolbarClick", [g._idd, m, this, g.getForm()])
		});
		if (l.readonly) {
			this.setReadonly(g, true)
		}
		g.childNodes[g._ll ? 0 : 1].childNodes[0].removeAttribute("for");
		g.childNodes[g._ll ? 0 : 1].childNodes[0].onclick = function() {
			c.editor[g._editor_id]._focus()
		};
		return this
	},
	doOnBlur: function(g, c) {
		var a = c.getContent();
		if (g._value != a) {
			if (g.checkEvent("onBeforeChange")) {
				if (g.callEvent("onBeforeChange", [g._idd, g._value, a]) !== true) {
					c.setContent(g._value);
					return
				}
			}
			g._value = a;
			g.callEvent("onChange", [g._idd, a])
		}
	},
	setValue: function(a, c) {
		if (a._value == c) {
			return
		}
		a._value = c;
		this.editor[a._editor_id].setContent(a._value)
	},
	getValue: function(a) {
		a._value = this.editor[a._editor_id].getContent();
		return a._value
	},
	enable: function(a) {
		if (this.isEnabled(a) != true) {
			this.editor[a._editor_id].setReadonly(false);
			this.doEn(a)
		}
	},
	disable: function(a) {
		if (this.isEnabled(a) == true) {
			this.editor[a._editor_id].setReadonly(true);
			this.doDis(a)
		}
	},
	setReadonly: function(a, c) {
		this.editor[a._editor_id].setReadonly(c)
	},
	getEditor: function(a) {
		return (this.editor[a._editor_id] || null)
	},
	destruct: function(a) {
		a.childNodes[a._ll ? 0 : 1].childNodes[0].onclick = null;
		this.editor[a._editor_id].unload();
		this.editor[a._editor_id] = null;
		this.d2(a);
		a = null
	},
	setFocus: function(a) {
		this.editor[a._editor_id]._focus()
	}
};
(function() {
	for (var c in {
			doAddLabel: 1,
			doAddInput: 1,
			doUnloadNestedLists: 1,
			setText: 1,
			getText: 1,
			setWidth: 1,
			isEnabled: 1
		}) {
		dhtmlXForm.prototype.items.editor[c] = dhtmlXForm.prototype.items.template[c]
	}
})();
dhtmlXForm.prototype.items.editor.d2 = dhtmlXForm.prototype.items.select.destruct;
dhtmlXForm.prototype.items.editor.doEn = dhtmlXForm.prototype.items.select.enable;
dhtmlXForm.prototype.items.editor.doDis = dhtmlXForm.prototype.items.select.disable;
dhtmlXForm.prototype.getEditor = function(a) {
	return this.doWithItem(a, "getEditor")
};
dhtmlXForm.prototype.items.upload = {
	render: function(c, g) {
		c._type = "up";
		c._enabled = true;
		c._checked = true;
		c.className = g.position + (typeof(g.className) == "string" ? " " + g.className : "");
		var a = document.createElement("DIV");
		c.appendChild(a);
		if (!isNaN(g.inputLeft)) {
			c.style.left = parseInt(g.inputLeft) + "px"
		}
		if (!isNaN(g.inputTop)) {
			c.style.top = parseInt(g.inputTop) + "px"
		}
		if (g.inputWidth != "auto") {
			if (!isNaN(g.inputWidth)) {
				a.style.width = parseInt(g.inputWidth) + "px"
			}
		}
		c._uploader = new dhtmlXFileUploader(a, g.swfPath || "", g.swfUrl || "", g.mode || null, g.swfLogs, g.slXap || "", g.slUrl || "", g.slLogs || "", g.multiple);
		c._uploader.setURL(g.url || "");
		c._uploader.callEvent = c.callEvent;
		if (typeof(g.autoStart) != "undefined") {
			c._uploader.setAutoStart(g.autoStart)
		}
		if (typeof(g.autoRemove) != "undefined") {
			c._uploader.setAutoRemove(g.autoRemove)
		}
		if (typeof(g.titleScreen) != "undefined") {
			c._uploader.enableTitleScreen(g.titleScreen)
		}
		if (typeof(g.titleText) != "undefined") {
			c._uploader.setTitleText(g.titleText)
		}
		if (g.hidden == true) {
			this.hide(c)
		}
		if (g.disabled == true) {
			this.userDisable(c)
		}
		if (!(g.inputHeight == "auto" || parseInt(g.inputHeight) == NaN)) {
			c._uploader.p_files.style.height = parseInt(g.inputHeight) + "px"
		}
		return this
	},
	destruct: function(a) {
		this.doUnloadNestedLists(a);
		a._uploader.callEvent = function() {
			return true
		};
		a._uploader.unload();
		a._uploader.callEvent = null;
		a._uploader = null;
		a._checked = null;
		a._enabled = null;
		a._idd = null;
		a._type = null;
		a.onselectstart = null;
		a._autoCheck = null;
		a.callEvent = null;
		a.checkEvent = null;
		a.getForm = null;
		while (a.childNodes.length > 0) {
			a.removeChild(a.childNodes[0])
		}
		a.parentNode.removeChild(a);
		a = null
	},
	setText: function(a, c) {},
	getText: function(a) {},
	enable: function(a) {
		a._enabled = true;
		if (String(a.className).search("disabled") >= 0) {
			a.className = String(a.className).replace(/disabled/gi, "")
		}
		a._uploader.enable()
	},
	disable: function(a) {
		a._enabled = false;
		if (String(a.className).search("disabled") < 0) {
			a.className += " disabled"
		}
		a._uploader.disable()
	},
	setWidth: function(c, a) {
		c.childNodes[0].style.width = a + "px";
		c._width = a
	},
	getWidth: function(a) {
		return a._width || parseInt(a.childNodes[0].style.width)
	},
	setValue: function(a) {
		a._uploader.clear()
	},
	getValue: function(n) {
		var l = n._uploader.getData();
		var m = {};
		var g = 0;
		for (var c in l) {
			m[n._idd + "_r_" + g] = l[c].realName;
			m[n._idd + "_s_" + g] = l[c].serverName;
			g++
		}
		m[n._idd + "_count"] = g;
		return m
	},
	getUploader: function(a) {
		return a._uploader
	},
	getStatus: function(a) {
		return a._uploader.getStatus()
	}
};
(function() {
	for (var c in {
			doUnloadNestedLists: 1,
			isEnabled: 1
		}) {
		dhtmlXForm.prototype.items.upload[c] = dhtmlXForm.prototype.items.checkbox[c]
	}
})();
dhtmlXForm.prototype.setFormData_upload = function(a) {
	this.doWithItem(a, "setValue")
};
dhtmlXForm.prototype.getUploader = function(a) {
	return this.doWithItem(a, "getUploader")
};
dhtmlXForm.prototype.getUploaderStatus = function(a) {
	return this.doWithItem(a, "getStatus")
};

function dhtmlXFileUploader(c, o, n, q, u, m, w, l, x) {
	var r = this;
	if (typeof(q) == "string" && typeof(this[q]) == "function") {
		this.engine = q
	} else {
		this.engine = "html4";
		var g = null;
		if (typeof(window.FormData) != "undefined" && typeof(window.XMLHttpRequest) != "undefined") {
			g = new XMLHttpRequest();
			if (typeof(g.upload) == "undefined") {
				g = null
			}
		}
		if (g != null) {
			this.engine = "html5"
		} else {
			if (typeof(window.swfobject) != "undefined" || g === false) {
				var g = swfobject.getFlashPlayerVersion();
				if (g.major >= 10) {
					this.engine = "flash"
				}
			} else {
				this._sl_v = this.getSLVersion();
				if (this._sl_v) {
					this.engine = "sl"
				}
			}
		}
		g = null
	}
	if (typeof(c) == "string") {
		c = document.getElementById(c)
	}
	this._upload_mp = (typeof(x) != "undefined" ? x == true : true);
	this._upload_dnd = true;
	this._swf_file_url = o || "";
	this._swf_upolad_url = n || "";
	this._swf_logs = u;
	this._sl_xap = m;
	this._sl_upload_url = w;
	this._sl_logs = l;
	this.p = document.createElement("DIV");
	this.p.className += " dhx_file_uploader";
	c.appendChild(this.p);
	this.p_files = document.createElement("DIV");
	this.p_files.className = "dhx_upload_files";
	this.p.appendChild(this.p_files);
	this.p_controls = document.createElement("DIV");
	this.p_controls.className = "dhx_upload_controls";
	this.p.appendChild(this.p_controls);
	this._files = {};
	this._items = {};
	this._data = {};
	this._autoStart = false;
	this._autoRemove = false;
	this._titleScreen = true;
	this._enabled = true;
	this._uploaded_count = 0;
	this._initToolbar = function() {
		this.b_opts = {
			info: {
				onclick: null
			},
			browse: {
				onclick: null,
				tooltip: "Browse"
			},
			upload: {
				onclick: function() {
					if (!r._enabled) {
						return
					}
					if (!r._uploading) {
						r._uploadStart()
					}
				},
				tooltip: "Upload"
			},
			cancel: {
				onclick: function() {
					if (!r._enabled) {
						return
					}
					r._uploadStop();
					r._switchButton(false)
				},
				tooltip: "Stop"
			},
			clear: {
				onclick: function() {
					if (!r._enabled) {
						return
					}
					r.clear()
				},
				tooltip: "Clear list"
			}
		};
		this.buttons = {};
		for (var y in this.b_opts) {
			var A = document.createElement("DIV");
			A.innerHTML = "&nbsp;";
			A.className = "dhx_file_uploader_button button_" + y;
			A.onclick = this.b_opts[y].onclick;
			if (this.b_opts[y].tooltip) {
				A.title = this.b_opts[y].tooltip
			}
			this.p_controls.appendChild(A);
			this.buttons[y] = A;
			A = null
		}
		this.buttons.cancel.style.display = "none"
	};
	this._readableSize = function(A) {
		var y = false;
		var a = ["b", "Kb", "Mb", "Gb", "Tb", "Pb", "Eb"];
		for (var C = 0; C < a.length; C++) {
			if (A > 1024) {
				A = A / 1024
			} else {
				if (y === false) {
					y = C
				}
			}
		}
		if (y === false) {
			y = a.length - 1
		}
		return Math.round(A * 100) / 100 + " " + a[y]
	};
	this._beforeAddFileToList = function(a, y) {
		return (this.callEvent("onBeforeFileAdd", [a, y]) === true)
	};
	this._addFileToList = function(E, y, C, D, a) {
		this._checkTitleScreen();
		var A = document.createElement("DIV");
		A._idd = E;
		A.className = "dhx_file dhx_file_" + D;
		A.innerHTML = "<div class='dhx_file_param dhx_file_name'>&nbsp;</div><div class='dhx_file_param dhx_file_progress'>" + a + "%</div><div class='dhx_file_param dhx_file_delete' title='Remove from list'>&nbsp;</div>";
		this.p_files.appendChild(A);
		A.childNodes[0].style.width = A.offsetWidth - 127 + "px";
		this._items[E] = A;
		this._updateFileNameSize(E);
		A.childNodes[2].onclick = function() {
			if (!r._enabled) {
				return
			}
			var F = this.parentNode._idd;
			r._removeFileFromQueue(F)
		};
		this.callEvent("onFileAdd", [y])
	};
	this._removeFileFromList = function(a) {
		if (!this._items[a]) {
			return
		}
		this._items[a].childNodes[2].onclick = null;
		this._items[a].parentNode.removeChild(this._items[a]);
		this._items[a] = null;
		delete this._items[a];
		if (this._data[a]) {
			this._data[a] = null;
			delete this._data[a]
		}
		this._checkTitleScreen()
	};
	this._updateFileNameSize = function(a) {
		this._items[a].childNodes[0].innerHTML = this._files[a].name + (!isNaN(this._files[a].size) ? " (" + this._readableSize(this._files[a].size) + ")" : "&nbsp;");
		this._items[a].childNodes[0].title = this._files[a].name + (!isNaN(this._files[a].size) ? " (" + this._readableSize(this._files[a].size) + ")" : "")
	};
	this._updateFileInList = function(A, y, a) {
		if (!this._items[A]) {
			return
		}
		this._items[A].className = "dhx_file dhx_file_" + y;
		this._updateProgress(A, y, a);
		this._updateFileNameSize(A)
	};
	this._updateProgress = function(A, y, a) {
		if (y == "uploading" && a < 100 && this._progress_type == "loader") {
			this._items[A].childNodes[1].className = "dhx_file_param dhx_file_uploading";
			this._items[A].childNodes[1].innerHTML = "&nbsp;"
		} else {
			this._items[A].childNodes[1].className = "dhx_file_param dhx_file_progress";
			this._items[A].childNodes[1].innerHTML = a + "%"
		}
		this._updateFileNameSize(A)
	};
	this._removeFilesByState = function(A) {
		for (var y in this._files) {
			if (A === true || this._files[y].state == A) {
				this._removeFileFromQueue(y)
			}
		}
	};
	this._switchButton = function(y) {
		if (y == true) {
			this.buttons.upload.style.display = "none";
			this.buttons.cancel.style.display = ""
		} else {
			var a = this._uploaded_count;
			this.buttons.upload.style.display = "";
			this.buttons.cancel.style.display = "none";
			this._uploaded_count = 0;
			if (a > 0) {
				this.callEvent("onUploadComplete", [a])
			}
		}
	};
	this._uploadStart = function() {
		this._switchButton(true);
		if (!this._uploading) {
			for (var y in this._files) {
				if (this._files[y].state == "fail") {
					this._files[y].state = "added";
					this._updateFileInList(y, "added", 0)
				}
			}
		}
		this._uploading = true;
		var A = false;
		for (var y in this._files) {
			if (!A && [this._files[y].state] == "added") {
				A = true;
				this._files[y].state = "uploading";
				this._updateFileInList(y, "uploading", 0);
				this._doUploadFile(y)
			}
		}
		if (!A) {
			this._uploading = false;
			this._switchButton(false)
		}
	};
	this._onUploadSuccess = function(D, C, A, a) {
		if (typeof(A) != "undefined" && this.engine == "flash") {
			var y = dhx4.s2j(A.data);
			if (y != null && y.state == true && y.name != null) {
				C = y.name;
				if (y.extra != null) {
					a = y.extra
				}
			} else {
				this._onUploadFail(D, (y != null && y.extra != null ? y.extra : null));
				return
			}
		}
		this._uploaded_count++;
		this._data[D] = {
			realName: this._files[D].name,
			serverName: C
		};
		this._files[D].state = "uploaded";
		this._updateFileInList(D, "uploaded", 100);
		this.callEvent("onUploadFile", [this._files[D].name, C, a]);
		if (this._autoRemove) {
			this._removeFileFromQueue(D)
		}
		if (this._uploading) {
			this._uploadStart()
		}
	};
	this._onUploadFail = function(y, a) {
		this._files[y].state = "fail";
		this._updateFileInList(y, "fail", 0);
		this.callEvent("onUploadFail", [this._files[y].name, a]);
		if (this._uploading) {
			this._uploadStart()
		}
	};
	this._onUploadAbort = function(a) {
		this._uploading = false;
		this._files[a].state = "added";
		this._updateFileInList(a, "added", 0);
		this.callEvent("onUploadCancel", [this._files[a].name])
	};
	this._checkTitleScreen = function() {
		var A = 0;
		for (var y in this._files) {
			A++
		}
		if (A == 0 && this.p.className.search("dhx_file_uploader_title") < 0 && this._titleScreen) {
			this.p.className += " dhx_file_uploader_title";
			this.buttons.info.innerHTML = this._titleText;
			this.buttons.info.style.width = Math.max(this.p_controls.offsetWidth - 134, 0) + "px"
		}
		if ((A > 0 || !this._titleScreen) && this.p.className.search("dhx_file_uploader_title") >= 0) {
			this.p.className = this.p.className.replace(/dhx_file_uploader_title/g, "");
			this.buttons.info.innerHTML = ""
		}
	};
	this.callEvent = function() {};
	this.upload = function() {
		if (!this._uploading) {
			this._uploadStart()
		}
	};
	this.setAutoStart = function(a) {
		this._autoStart = (a == true)
	};
	this.setAutoRemove = function(a) {
		this._autoRemove = (a == true)
	};
	this.enableTitleScreen = function(a) {
		this._titleScreen = (a == true);
		this._checkTitleScreen()
	};
	this.setTitleText = function(a) {
		this._titleText = a;
		if (this.p.className.search("dhx_file_uploader_title") >= 0) {
			this.buttons.info.innerHTML = this._titleText
		}
	};
	this.setURL = function(a) {
		this._url = a
	};
	this.setSWFURL = function(a) {
		this._swf_upolad_url = a
	};
	this.enable = function() {
		this._enabled = true;
		this.p_files.className = "dhx_upload_files";
		this.p_controls.className = "dhx_upload_controls"
	};
	this.disable = function() {
		this._enabled = false;
		this.p_files.className = "dhx_upload_files dhx_uploader_dis";
		this.p_controls.className = "dhx_upload_controls dhx_uploader_dis"
	};
	this.getStatus = function() {
		var A = 0;
		for (var y in this._files) {
			if (this._files[y].state != "uploaded") {
				return -1
			}
			A = 1
		}
		return A
	};
	this.getData = function() {
		return this._data
	};
	this.clear = function() {
		if (this.callEvent("onBeforeClear", []) !== true) {
			return
		}
		if (this._uploading) {
			r._uploadStop()
		}
		r._switchButton(false);
		r._removeFilesByState(true);
		this.callEvent("onClear", [])
	};
	this.unload = function() {
		this._removeFilesByState(true);
		this._data = null;
		this._files = null;
		this._items = null;
		this._unloadEngine();
		for (var y in this.buttons) {
			this.buttons[y].onclick = null;
			this.buttons[y].parentNode.removeChild(this.buttons[y]);
			this.buttons[y] = null;
			delete this.buttons[y]
		}
		this.buttons = null;
		for (var y in this.b_opts) {
			this.b_opts[y].onclick = null;
			this.b_opts[y] = null;
			delete this.b_opts[y]
		}
		this.b_opts = null;
		this.p_controls.parentNode.removeChild(this.p_controls);
		this.p_files.parentNode.removeChild(this.p_files);
		this.p.className = this.p.className.replace(/dhx_file_uploader_title/gi, "").replace(/dhx_file_uploader/gi, "");
		for (var y in this) {
			this[y] = null
		}
		r = y = null
	};
	var s = new this[this.engine]();
	for (var v in s) {
		this[v] = s[v];
		s[v] = null
	}
	v = s = c = null;
	this._initToolbar();
	this._initEngine();
	this._checkTitleScreen();
	return this
}
dhtmlXFileUploader.prototype.html5 = function() {};
dhtmlXFileUploader.prototype.html5.prototype = {
	_initEngine: function() {
		var c = this;
		this.buttons.browse.onclick = function() {
			if (c._enabled) {
				c.f.click()
			}
		};
		this._progress_type = "percentage";
		var a = window.navigator.userAgent;
		if (a.match(/Windows/gi) != null && a.match(/AppleWebKit/gi) != null && a.match(/Safari/gi) != null) {
			if (a.match(/Version\/5\.1\.5/gi)) {
				this._upload_mp = false
			}
			if (a.match(/Version\/5\.1[^\.\d{1,}]/gi)) {
				this._upload_dnd = false
			}
			if (a.match(/Version\/5\.1\.1/gi)) {
				this._upload_mp = false;
				this._upload_dnd = false
			}
			if (a.match(/Version\/5\.1\.2/gi)) {
				this._upload_dnd = false
			}
			if (a.match(/Version\/5\.1\.7/gi)) {
				this._upload_mp = false
			}
		}
		this._addFileInput();
		if (this._upload_dnd) {
			this.p.ondragenter = function(g) {
				if (!g.dataTransfer) {
					return
				}
				g.stopPropagation();
				g.preventDefault()
			};
			this.p.ondragover = function(g) {
				if (!g.dataTransfer) {
					return
				}
				g.stopPropagation();
				g.preventDefault()
			};
			this.p.ondrop = function(g) {
				if (!g.dataTransfer) {
					return
				}
				g.stopPropagation();
				g.preventDefault();
				if (c._enabled) {
					c._parseFilesInInput(g.dataTransfer.files)
				}
			};
			this._titleText = "Drag-n-Drop files here or<br>click to select files for upload."
		} else {
			this._titleText = "Click to select files for upload."
		}
	},
	_addFileInput: function() {
		if (this.f != null) {
			this.f.onchange = null;
			this.f.parentNode.removeChild(this.f);
			this.f = null
		}
		var a = this;
		this.f = document.createElement("INPUT");
		this.f.type = "file";
		if (this._upload_mp) {
			this.f.multiple = "1"
		}
		this.f.className = "dhx_uploader_input";
		this.p_controls.appendChild(this.f);
		this.f.onchange = function() {
			a._parseFilesInInput(this.files);
			if (window.dhx4.isOpera) {
				a._addFileInput()
			} else {
				this.value = ""
			}
		}
	},
	_doUploadFile: function(g) {
		var c = this;
		if (!this._loader) {
			this._loader = new XMLHttpRequest();
			this._loader.upload.onprogress = function(l) {
				if (c._files[this._idd].state == "uploading") {
					c._updateFileInList(this._idd, "uploading", Math.round(l.loaded * 100 / l.total))
				}
			};
			this._loader.onload = function(m) {
				var l = dhx4.s2j(this.responseText);
				if (typeof(l) == "object" && l != null && typeof(l.state) != "undefined" && l.state == true) {
					c._onUploadSuccess(this.upload._idd, l.name, null, l.extra);
					l = null
				} else {
					c._onUploadFail(this.upload._idd, (l != null && l.extra != null ? l.extra : null))
				}
			};
			this._loader.onerror = function(l) {
				c._onUploadFail(this.upload._idd)
			};
			this._loader.onabort = function(l) {
				c._onUploadAbort(this.upload._idd)
			}
		}
		this._loader.upload._idd = g;
		var a = new FormData();
		a.append("file", this._files[g].file);
		this._loader.open("POST", this._url + (String(this._url).indexOf("?") < 0 ? "?" : "&") + "mode=html5&dhxr" + new Date().getTime(), true);
		this._loader.setRequestHeader("X-Requested-With", "XMLHttpRequest");
		this._loader.send(a)
	},
	_uploadStop: function() {
		if (!this._uploading || !this._loader) {
			return
		}
		this._loader.abort()
	},
	_parseFilesInInput: function(c) {
		for (var a = 0; a < c.length; a++) {
			this._addFileToQueue(c[a])
		}
	},
	_addFileToQueue: function(a) {
		if (!this._beforeAddFileToList(a.name, a.size)) {
			return
		}
		var c = (a._idd || window.dhx4.newId());
		this._files[c] = {
			file: a,
			name: a.name,
			size: a.size,
			state: "added"
		};
		this._addFileToList(c, a.name, a.size, "added", 0);
		if (this._autoStart && !this._uploading) {
			this._uploadStart(true)
		}
	},
	_removeFileFromQueue: function(l) {
		if (!this._files[l]) {
			return
		}
		var c = this._files[l].name;
		var g = (this._data != null && this._data[l] != null ? this._data[l].serverName : null);
		if (this.callEvent("onBeforeFileRemove", [c, g]) !== true) {
			return
		}
		var a = false;
		if (this._uploading && l == this._loader.upload._idd && this._files[l].state == "uploading") {
			this._uploadStop();
			a = true
		}
		this._files[l].file = null;
		this._files[l].name = null;
		this._files[l].size = null;
		this._files[l].state = null;
		this._files[l] = null;
		delete this._files[l];
		this._removeFileFromList(l);
		this.callEvent("onFileRemove", [c, g]);
		if (a) {
			this._uploadStart()
		}
	},
	_unloadEngine: function() {
		this.buttons.browse.onclick = null;
		this.f.onchange = null;
		this.f.parentNode.removeChild(this.f);
		this.f = null;
		this.p.ondragenter = null;
		this.p.ondragover = null;
		this.p.ondrop = null;
		if (this._loader) {
			this._loader.upload.onprogress = null;
			this._loader.onload = null;
			this._loader.onerror = null;
			this._loader.onabort = null;
			this._loader.upload._idd = null;
			this._loader = null
		}
		this._initEngine = null;
		this._doUploadFile = null;
		this._uploadStop = null;
		this._parseFilesInInput = null;
		this._addFileToQueue = null;
		this._removeFileFromQueue = null;
		this._unloadEngine = null
	}
};
dhtmlXFileUploader.prototype.html4 = function() {};
dhtmlXFileUploader.prototype.html4.prototype = {
	_initEngine: function() {
		this._addForm();
		this._progress_type = "loader";
		this._titleText = "Click button<br>to select files for upload."
	},
	_addForm: function() {
		var a = this;
		var g = window.dhx4.newId();
		if (!this.k) {
			this.k = document.createElement("DIV");
			this.k.className = "dhx_file_form_cont";
			this.buttons.browse.appendChild(this.k);
			this.fr_name = "dhx_file_" + window.dhx4.newId();
			this.k.innerHTML = '<iframe name="' + this.fr_name + '" style="height:0px;width:0px;" frameBorder="0"></iframe>';
			this.fr = this.k.firstChild;
			if (window.navigator.userAgent.indexOf("MSIE") >= 0) {
				this.fr.onreadystatechange = function() {
					if (this.readyState == "complete") {
						a._onLoad()
					}
				}
			} else {
				this.fr.onload = function() {
					a._onLoad()
				}
			}
		}
		var c = document.createElement("DIV");
		c.innerHTML = "<form method='POST' enctype='multipart/form-data' target='" + this.fr_name + "' class='dhx_file_form' name='dhx_file_form_" + window.dhx4.newId() + "'><input type='hidden' name='mode' value='html4'><input type='hidden' name='uid' value='" + g + "'><input type='file' name='file' class='dhx_file_input'></form>";
		this.k.appendChild(c);
		c.firstChild.lastChild._idd = g;
		c.firstChild.lastChild.onchange = function() {
			if (!a._beforeAddFileToList(this.value, null)) {
				return
			}
			a._addFileToQueue(this);
			this.onchange = null;
			this.parentNode.parentNode.style.display = "none";
			a._addForm()
		};
		c = null
	},
	_onLoad: function() {
		if (this._uploading) {
			var a = dhx4.s2j(this.fr.contentWindow.document.body.innerHTML);
			if (typeof(a) == "object" && a != null) {
				if (typeof(a.state) != "undefined") {
					if (a.state == "cancelled") {
						this._onUploadAbort(this.fr._idd);
						a = null;
						return
					} else {
						if (a.state == true) {
							if (typeof(a.size) != "undefined" && !isNaN(a.size)) {
								this._files[this.fr._idd].size = a.size
							}
							this._onUploadSuccess(this.fr._idd, a.name, null, a.extra);
							a = null;
							return
						}
					}
				}
			}
			this._onUploadFail(this.fr._idd, (a != null && a.extra != null ? a.extra : null))
		}
	},
	_addFileToQueue: function(c) {
		var a = c.value.match(/[^\\\/]*$/g);
		if (a[0] != null) {
			a = a[0]
		} else {
			a = c.value
		}
		this._files[c._idd] = {
			name: a,
			form: c.parentNode,
			node: c.parentNode.parentNode,
			input: c,
			state: "added"
		};
		this._addFileToList(c._idd, c.value, false, "added", 0);
		if (this._autoStart && !this._uploading) {
			this._uploadStart(true)
		}
	},
	_removeFileFromQueue: function(g) {
		var a = this._files[g].name;
		var c = (this._data != null && this._data[g] != null ? this._data[g].serverName : null);
		if (this.callEvent("onBeforeFileRemove", [a, c]) !== true) {
			return
		}
		this._files[g].input.onchange = null;
		this._files[g].form.removeChild(this._files[g].input);
		this._files[g].node.removeChild(this._files[g].form);
		this._files[g].node.parentNode.removeChild(this._files[g].node);
		this._files[g].input = null;
		this._files[g].name = null;
		this._files[g].form = null;
		this._files[g].node = null;
		this._files[g].size = null;
		this._files[g].state = null;
		this._files[g] = null;
		delete this._files[g];
		this._removeFileFromList(g);
		this.callEvent("onFileRemove", [a, c])
	},
	_doUploadFile: function(a) {
		this.fr._idd = a;
		this._files[a].form.action = this._url;
		this._files[a].form.submit()
	},
	_uploadStop: function() {
		if (!this._uploading) {
			return
		}
		this.fr.contentWindow.location.href = (this._url) + (this._url.indexOf("?") < 0 ? "?" : "&") + "mode=html4&action=cancel&dhxr" + new Date().getTime()
	},
	_unloadEngine: function() {
		if (this.k) {
			this.fr_name = null;
			this.fr.onreadystatechange = null;
			this.fr.onload = null;
			this.fr.parentNode.removeChild(this.fr);
			this.fr = null;
			this.k.firstChild.firstChild.lastChild.onchange = null;
			this.k.parentNode.removeChild(this.k);
			this.k = null
		}
		this._initEngine = null;
		this._addForm = null;
		this._onLoad = null;
		this._addFileToQueue = null;
		this._removeFileFromQueue = null;
		this._doUploadFile = null;
		this._uploadStop = null;
		this._unloadEngine = null
	}
};
dhtmlXFileUploader.prototype.flash = function() {};
dhtmlXFileUploader.prototype.flash.prototype = {
	_initEngine: function() {
		if (!window.dhtmlXFileUploaderSWFObjects) {
			window.dhtmlXFileUploaderSWFObjects = {
				items: {},
				callEvent: function(m, g, l) {
					return window.dhtmlXFileUploaderSWFObjects.items[m].uploader[g].apply(window.dhtmlXFileUploaderSWFObjects.items[m].uploader, l)
				}
			}
		}
		var c = this;
		this._swf_obj_id = "dhtmlXFileUploaderSWFObject_" + window.dhx4.newId();
		this._swf_file_url = this._swf_file_url + (this._swf_file_url.indexOf("?") >= 0 ? "&" : "?") + "dhxr" + new Date().getTime();
		this.buttons.browse.innerHTML = "<div id='" + this._swf_obj_id + "' style='width:100%;height:100%;'></div>";
		swfobject.embedSWF(this._swf_file_url, this._swf_obj_id, "100%", "100%", "9", null, {
			ID: this._swf_obj_id,
			enableLogs: this._swf_logs
		}, {
			wmode: "transparent"
		});
		var a = swfobject.getFlashPlayerVersion();
		this._titleText = "Engine successfuly inited<br>Flash Player: " + a.major + "." + a.minor + "." + a.release;
		this._progress_type = "percentage";
		window.dhtmlXFileUploaderSWFObjects.items[this._swf_obj_id] = {
			id: this._swf_obj_id,
			uploader: this
		}
	},
	_beforeAddFileToQueue: function(a, c) {
		return (this.callEvent("onBeforeFileAdd", [a, c]) === true)
	},
	_addFileToQueue: function(l, c, g) {
		if (window.dhx4.isIE) {
			var a = document.createElement("INPUT");
			a.type = "TEXT";
			a.style.position = "absolute";
			a.style.left = "0px";
			a.style.top = window.dhx4.absTop(this.buttons.browse) + "px";
			a.style.width = "10px";
			document.body.appendChild(a);
			a.focus();
			document.body.removeChild(a);
			a = null
		}
		this._files[l] = {
			name: c,
			size: g,
			state: "added"
		};
		this._addFileToList(l, c, g, "added", 0);
		if (this._autoStart && !this._uploading) {
			this._uploadStart(true)
		}
	},
	_removeFileFromQueue: function(l) {
		if (!this._files[l]) {
			return
		}
		var c = this._files[l].name;
		var g = (this._data != null && this._data[l] != null ? this._data[l].serverName : null);
		if (this.callEvent("onBeforeFileRemove", [c, g]) !== true) {
			return
		}
		var a = false;
		if (this._uploading && this._files[l].state == "uploading") {
			this._uploadStop();
			a = true
		}
		swfobject.getObjectById(this._swf_obj_id).removeFileById(l);
		this._files[l].name = null;
		this._files[l].size = null;
		this._files[l].state = null;
		this._files[l] = null;
		delete this._files[l];
		this._removeFileFromList(l);
		this.callEvent("onFileRemove", [c, g]);
		if (a) {
			this._uploadStart()
		}
	},
	_doUploadFile: function(a) {
		swfobject.getObjectById(this._swf_obj_id).upload(a, this._swf_upolad_url)
	},
	_uploadStop: function(g) {
		for (var c in this._files) {
			if (this._files[c].state == "uploading") {
				swfobject.getObjectById(this._swf_obj_id).uploadStop(c)
			}
		}
	},
	_unloadEngine: function() {
		if (window.dhtmlXFileUploaderSWFObjects.items[this._swf_obj_id]) {
			window.dhtmlXFileUploaderSWFObjects.items[this._swf_obj_id].id = null;
			window.dhtmlXFileUploaderSWFObjects.items[this._swf_obj_id].uploader = null;
			window.dhtmlXFileUploaderSWFObjects.items[this._swf_obj_id] = null;
			delete window.dhtmlXFileUploaderSWFObjects.items[this._swf_obj_id]
		}
		this._swf_obj_id = null;
		this._initEngine = null;
		this._addFileToQueue = null;
		this._removeFileFromQueue = null;
		this._doUploadFile = null;
		this._uploadStop = null;
		this._unloadEngine = null
	}
};
dhtmlXFileUploader.prototype.sl = function() {};
dhtmlXFileUploader.prototype.sl.prototype = {
	_initEngine: function() {
		if (typeof(this._sl_v) == "undefined") {
			this._sl_v = this.getSLVersion()
		}
		if (!window.dhtmlXFileUploaderSLObjects) {
			window.dhtmlXFileUploaderSLObjects = {
				items: {},
				callEvent: function(g, a, c) {
					window.dhtmlXFileUploaderSLObjects.items[g].uploader[a].apply(window.dhtmlXFileUploaderSLObjects.items[g].uploader, c)
				}
			}
		}
		this._sl_obj_id = "dhtmlXFileUploaderSLObject_" + window.dhx4.newId();
		if (this._sl_v != false) {
			this._titleText = "Engine successfuly inited<br>Silverlight version: " + this._sl_v[0] + "." + this._sl_v[1];
			this.buttons.browse.innerHTML = '<div style="width:100%;height:100%;"><object data="data:application/x-silverlight-2," type="application/x-silverlight-2" width="100%" height="100%" id="' + this._sl_obj_id + '"><param name="source" value="' + this._sl_xap + '"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="initParams" value="SLID=' + this._sl_obj_id + ",LOGS=" + this._sl_logs + '"/><param name="minRuntimeVersion" value="5.0"/></object></div>'
		} else {
			this._titleText = "Silverlight plugin not found<br>or version less than 4.0";
			this.buttons.browse.style.cursor = "wait";
			this.buttons.browse.title = ""
		}
		this._progress_type = "percentage";
		window.dhtmlXFileUploaderSLObjects.items[this._sl_obj_id] = {
			id: this._sl_obj_id,
			uploader: this
		}
	},
	_addFileToQueue: function(g, a, c) {
		this._files[g] = {
			name: a,
			size: c,
			state: "added"
		};
		this._addFileToList(g, a, c, "added", 0);
		if (this._autoStart && !this._uploading) {
			this._uploadStart(true)
		}
	},
	_removeFileFromQueue: function(c) {
		if (!this._files[c]) {
			return
		}
		var a = false;
		if (this._uploading && this._files[c].state == "uploading") {
			this._uploadStop();
			a = true
		}
		document.getElementById([this._sl_obj_id]).Content.a.removeFileById(c);
		this._files[c].name = null;
		this._files[c].size = null;
		this._files[c].state = null;
		this._files[c] = null;
		delete this._files[c];
		this._removeFileFromList(c);
		if (a) {
			this._uploadStart()
		}
	},
	_doUploadFile: function(c) {
		var a = this._sl_upload_url.split("?");
		a = (a[1] != null ? "&" + a[1] : "");
		document.getElementById(this._sl_obj_id).Content.a.upload(c, this._sl_upload_url, a + "&mode=sl&dhxr" + new Date().getTime())
	},
	_uploadStop: function(g) {
		this._uploading = false;
		for (var c in this._files) {
			if (this._files[c].state == "uploading") {
				document.getElementById(this._sl_obj_id).Content.a.uploadStop(c)
			}
		}
	},
	_unloadEngine: function() {
		if (window.dhtmlXFileUploaderSLObjects.items[this._sl_obj_id]) {
			window.dhtmlXFileUploaderSLObjects.items[this._sl_obj_id].id = null;
			window.dhtmlXFileUploaderSLObjects.items[this._sl_obj_id].uploader = null;
			window.dhtmlXFileUploaderSLObjects.items[this._sl_obj_id] = null;
			delete window.dhtmlXFileUploaderSLObjects.items[this._sl_obj_id]
		}
		this._sl_obj_id = null;
		this._initEngine = null;
		this._addFileToQueue = null;
		this._removeFileFromQueue = null;
		this._doUploadFile = null;
		this._uploadStop = null;
		this._unloadEngine = null
	}
};
dhtmlXFileUploader.prototype.setSLURL = function(a) {
	this._sl_upload_url = a
};
dhtmlXFileUploader.prototype.getSLVersion = function() {
	var a = false;
	if (window.dhx4.isIE) {
		try {
			var c = new ActiveXObject("AgControl.AgControl");
			if (c != null) {
				var m = 4,
					l = 0;
				while (c.isVersionSupported([m, l].join("."))) {
					a = [m, l];
					if (++l > 9) {
						m++;
						l = 0
					}
				}
			}
			c = null
		} catch (g) {}
	} else {
		if (navigator.plugins["Silverlight Plug-In"] != null) {
			a = navigator.plugins["Silverlight Plug-In"].description.split(".")
		}
	}
	return a
};
dhtmlXForm.prototype.saveBackup = function() {
	if (!this._backup) {
		this._backup = {};
		this._backupId = new Date().getTime()
	}
	this._backup[++this._backupId] = this.getFormData();
	return this._backupId
};
dhtmlXForm.prototype.restoreBackup = function(a) {
	if (this._backup != null && this._backup[a] != null) {
		this.setFormData(this._backup[a])
	}
};
dhtmlXForm.prototype.clearBackup = function(a) {
	if (this._backup != null && this._backup[a] != null) {
		this._backup[a] = null;
		delete this._backup[a]
	}
};
dhtmlXForm.prototype.addItem = function(g, a, n, l) {
	var c = null;
	if (g instanceof Array) {
		c = g[1];
		g = g[0]
	}
	var m = null;
	if (g != null) {
		var m = this._getParentForm(g, c);
		if (m != null) {
			if (m.item._list == null) {
				if (!a.listParent) {
					a.listParent = m.item._idd
				}
				m.form._addItem("list", m.item._idd, [a], null, m.item._idd, n, l)
			} else {
				m.item._list[0].addItem(null, a, n, l)
			}
			m.form = m.item = null;
			m = null;
			this._autoCheck();
			return
		}
	}
	this._prepareItem(a, n, l);
	this._autoCheck()
};
dhtmlXForm.prototype.removeItem = function(c, a) {
	this._removeItem(c, a)
};
dhtmlXForm.prototype.removeColumn = function(o, n, l, g) {
	var s = null;
	if (o instanceof Array) {
		s = o[1];
		o = o[0]
	}
	if (o != null) {
		var m = this._getParentForm(o, s);
		if (m != null) {
			if (m.item._list != null && m.item._list[0] != null) {
				m.item._list[0].removeColumn(null, n, l, g)
			}
			m.form = m.item = null;
			m = null
		}
		return
	}
	n = Math.min(Math.max(n, 0), this.cont.childNodes.length - 1);
	if (this.cont.childNodes.length == 1) {
		if (l == true) {
			this._removeItemsInColumn(this.cont.childNodes[n])
		}
	} else {
		if (l == true) {
			this._removeItemsInColumn(this.cont.childNodes[n])
		} else {
			if (!g) {
				var a = n - 1;
				if (a < 0) {
					a = n + 1
				}
			} else {
				var a = n + 1;
				if (a > this.cont.childNodes.length - 1) {
					a = n - 1
				}
			}
			while (this.cont.childNodes[n].childNodes.length > 0) {
				this.cont.childNodes[a].appendChild(this.cont.childNodes[n].childNodes[0])
			}
		}
		var r = [];
		for (var c = 0; c < this.base.length; c++) {
			if (this.cont.childNodes[n] != this.base[c]) {
				r.push(this.base[c])
			}
		}
		this.base = r;
		this.cont.removeChild(this.cont.childNodes[n]);
		this.b_index--;
		r = null
	}
};
dhtmlXForm.prototype.getColumnNode = function(g, c) {
	var l = null;
	var a = null;
	if (g instanceof Array) {
		a = g[1];
		g = g[0]
	}
	if (g != null) {
		var m = this._getParentForm(g, a);
		if (m != null) {
			if (m.item._list != null && m.item._list[0] != null && l == null) {
				l = m.item._list[0].getColumnNode(null, c)
			}
			m.form = m.item = null;
			m = null
		}
		return l
	}
	if (c < 0 || c > this.cont.childNodes.length - 1) {
		return null
	}
	return this.cont.childNodes[c]
};
dhtmlXForm.prototype._removeItemsInColumn = function(l) {
	var a = [];
	for (var g = 0; g < l.childNodes.length; g++) {
		var c = l.childNodes[g];
		if (c._idd != null && c._type != null) {
			a.push([c._idd, (c._type == "ra" ? c._value : null)])
		}
		c = null
	}
	for (var g = 0; g < a.length; g++) {
		this.removeItem(a[g][0], a[g][1])
	}
};
dhtmlXForm.prototype._getParentForm = function(n, m) {
	if (this.itemPull[this.idPrefix + n] != null) {
		return {
			form: this,
			item: this.itemPull[this.idPrefix + n]
		}
	}
	for (var c in this.itemPull) {
		if (this.itemPull[c]._type == "ra" && this.itemPull[c]._group == n && this.itemPull[c]._value == m) {
			return {
				form: this,
				item: this.itemPull[c]
			}
		}
	}
	var l = null;
	for (var c in this.itemPull) {
		if (!l && this.itemPull[c]._list != null) {
			for (var g = 0; g < this.itemPull[c]._list.length; g++) {
				if (!l) {
					l = this.itemPull[c]._list[g]._getParentForm(n, m)
				}
			}
		}
	}
	return l
};
(function() {
	for (var c in dhtmlXForm.prototype.items) {
		if (!dhtmlXForm.prototype.items[c]._getItemNode) {
			dhtmlXForm.prototype.items[c]._getItemNode = function(a) {
				return a
			}
		}
	}
})();
dhtmlXForm.prototype._getItemNode = function(c, a) {
	if (a != null) {
		c = [c, a]
	}
	return this.doWithItem(c, "_getItemNode")
};
dhtmlXForm.prototype.setRequired = function(r, n, m) {
	if (typeof(m) == "undefined") {
		m = n
	} else {
		r = [r, n]
	}
	var g = this._getItemNode(r);
	if (!g) {
		return
	}
	m = window.dhx4.s2b(m);
	g._required = (m == true);
	if (g._required) {
		if (!g._validate) {
			g._validate = []
		}
		var c = false;
		for (var l = 0; l < g._validate.length; l++) {
			c = (g._validate[l] == "NotEmpty" || c)
		}
		if (!c) {
			g._validate.push("NotEmpty")
		}
		var o = g.childNodes[g._ll ? 0 : 1].childNodes[0];
		if (!(o.lastChild && o.lastChild.className && o.lastChild.className.search(/required/) >= 0)) {
			var a = document.createElement("SPAN");
			a.className = "dhxform_item_required";
			a.innerHTML = "*";
			o.appendChild(a);
			a = o = null
		}
	} else {
		if (g._validate != null) {
			var c = g._validate;
			g._validate = [];
			for (var l = 0; l < c.length; l++) {
				if (c[l] != "NotEmpty") {
					g._validate.push(c[l])
				}
			}
			if (g._validate.length == 0) {
				g._validate = null
			}
		}
		var o = g.childNodes[g._ll ? 0 : 1].childNodes[0];
		if (o.lastChild && o.lastChild.className && o.lastChild.className.search(/required/) >= 0) {
			o.removeChild(o.lastChild);
			o = null
		}
	}
	this._resetValidateCss(g);
	g = null
};
dhtmlXForm.prototype.setNote = function(m, g, a) {
	if (typeof(a) == "undefined") {
		a = g
	} else {
		m = [m, g]
	}
	var c = this._getItemNode(m);
	if (!c) {
		return
	}
	var l = this._getNoteNode(c);
	if (!l) {
		if (!a.width) {
			a.width = c.childNodes[c._ll ? 1 : 0].childNodes[0].offsetWidth
		}
		l = document.createElement("DIV");
		l.className = "dhxform_note";
		if ({
				ch: 1,
				ra: 1
			}[c._type]) {
			c.childNodes[c._ll ? 1 : 0].insertBefore(l, c.childNodes[c._ll ? 1 : 0].lastChild)
		} else {
			c.childNodes[c._ll ? 1 : 0].appendChild(l)
		}
	}
	l.innerHTML = a.text;
	if (a.width != null) {
		l.style.width = a.width + "px";
		l._w = a.width
	}
	l = null
};
dhtmlXForm.prototype.clearNote = function(l, c) {
	if (typeof(c) != "undefined") {
		l = [l, c]
	}
	var a = this._getItemNode(l);
	if (!a) {
		return
	}
	var g = this._getNoteNode(a);
	if (g != null) {
		g.parentNode.removeChild(g);
		g = null
	}
};
dhtmlXForm.prototype._getNoteNode = function(a) {
	var g = null;
	for (var c = 0; c < a.childNodes[a._ll ? 1 : 0].childNodes.length; c++) {
		if (String(a.childNodes[a._ll ? 1 : 0].childNodes[c].className).search(/dhxform_note/) >= 0) {
			g = a.childNodes[a._ll ? 1 : 0].childNodes[c]
		}
	}
	a = null;
	return g
};
dhtmlXForm.prototype.setValidation = function(n, l, m) {
	if (typeof(note) == "undefined") {
		m = l
	} else {
		n = [n, l]
	}
	var c = this._getItemNode(n);
	if (!c) {
		return
	}
	if (c._validate != null) {
		for (var g = 0; g < c._validate.length; g++) {
			c._validate[g] = null
		}
	}
	c._validate = [];
	if (typeof(m) == "function" || typeof(window[m]) == "function") {
		c._validate = [m]
	} else {
		c._validate = String(m).split(this.separator)
	}
	if (c._required) {
		var a = false;
		for (var g = 0; g < c._validate.length; g++) {
			a = (c._validate[g] == "NotEmpty" || a)
		}
		if (!a) {
			c._validate.push("NotEmpty")
		}
	}
	c = null
};
dhtmlXForm.prototype.clearValidation = function(l, g) {
	if (typeof(g) != "undefined") {
		l = [l, g]
	}
	var a = this._getItemNode(l);
	if (!a) {
		return
	}
	if (a._validate != null) {
		for (var c = 0; c < a._validate.length; c++) {
			a._validate[c] = null
		}
	}
	a._validate = a._required ? ["NotEmpty"] : null;
	a = null
};
dhtmlXForm.prototype.reloadOptions = function(a, n) {
	var c = this.getItemType(a);
	if (!{
			select: 1,
			multiselect: 1,
			combo: 1
		}[c]) {
		return
	}
	if (c == "select" || c == "multiselect") {
		var l = this.getOptions(a);
		while (l.length > 0) {
			l.remove(0)
		}
		l.length = 0;
		l = null;
		if (typeof(n) == "string") {
			this.doWithItem(a, "doLoadOptsConnector", n)
		} else {
			if (n instanceof Array) {
				this.doWithItem(a, "doLoadOpts", {
					options: n
				})
			}
		}
	}
	if (c == "combo") {
		var o = this.getCombo(a);
		o.clearAll();
		o.setComboValue("");
		if (typeof(n) == "string") {
			this.doWithItem(a, "doLoadOptsConnector", n)
		} else {
			if (n instanceof Array) {
				var g = null;
				for (var m = 0; m < n.length; m++) {
					if (window.dhx4.s2b(n[m].selected)) {
						g = n[m].value
					}
				}
				o.addOption(n);
				if (g != null) {
					this.setItemValue(a, g)
				}
				o = null
			}
		}
	}
};
dhtmlXForm.prototype.setTooltip = function(n, m, l) {
	if (typeof(l) == "undefined") {
		l = m
	} else {
		n = [n, m]
	}
	var c = this._getItemNode(n);
	if (!c) {
		return
	}
	var a = null;
	if (c.childNodes.length == 1) {
		a = c.childNodes[0]
	} else {
		for (var g = 0; g < c.childNodes.length; g++) {
			if (c.childNodes[g].className != null && c.childNodes[g].className.search("dhxform_label") >= 0) {
				a = c.childNodes[g]
			}
		}
	}
	if (a != null) {
		if (l == null || l.length == 0) {
			a.removeAttribute("title")
		} else {
			a.title = l
		}
	}
	a = null
};

function dhtmlXAccordion(m, o) {
	var l = this;
	var g = window.dhx4.transDetect();
	this.conf = {
		skin: (o || window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhxacc") || "dhx_skyblue"),
		css: "dhxacc",
		icons_path: "",
		multi_mode: false,
		last_opened: null,
		on_active_id: null,
		on_active_click: false,
		size_changed: true,
		def_height: 90,
		total_count: 0,
		hiden_count: 0,
		cont_w: null
	};
	this.conf.tr = {
		prop: g.transProp,
		ev: g.transEv,
		height_open: "height 0.2s cubic-bezier(0.25,0.1,0.25,1)",
		height_close: "height 0.18s cubic-bezier(0.25,0.1,0.25,1)",
		op_open: "opacity 0.16s ease-in",
		op_close: "opacity 0.2s ease-out",
		op_v_open: "1",
		op_v_close: "0.4",
		dnd_top: "top 0.16s"
	};
	this.ofs = {
		m: {},
		s: {},
		def: {
			m: {
				left: 0,
				right: 0,
				first: 0,
				between: 8
			},
			s: {
				left: 0,
				right: 0,
				first: 0,
				between: -1,
				last: 0
			}
		},
		base: {
			s: {},
			m: {}
		},
		skin: {
			dhx_web: {
				s: {
					between: 3
				},
				m: {
					between: 3
				}
			},
			dhx_terrace: {
				m: {
					between: 12,
					left: 0,
					right: 0
				}
			}
		}
	};
	if (navigator.userAgent.indexOf("MSIE") >= 0 || navigator.userAgent.indexOf("Trident") >= 0) {
		this.conf.tr.height_open = this.conf.tr.height_close
	} else {
		this.conf.tr.height_open = this.conf.tr.height_close
	}
	var n = null;
	if (typeof(m) == "object" && !m.tagName) {
		n = {};
		for (var c in m) {
			n[c] = m[c];
			m[c] = null
		}
		m = n.parent;
		n.parent = null
	}
	window.dhtmlXCellTop.apply(this, [m, m._ofs]);
	this._adjustCont();
	if (this.base._ofs != null) {
		for (var q in this.ofs.base) {
			if (this.base._ofs[q] != null) {
				for (var c in this.base._ofs[q]) {
					this.ofs.base[q][c] = this.base._ofs[q][c]
				}
			}
		}
	}
	this._applyOffsets = function() {
		for (var w in this.ofs.def) {
			var u = this.ofs.def[w];
			var v = (this.ofs.skin[this.conf.skin] != null && this.ofs.skin[this.conf.skin][w] != null ? this.ofs.skin[this.conf.skin][w] : null);
			var s = (this.base._ofs != null ? this.base._ofs[w] : null);
			for (var r in u) {
				if (v != null && v[r] != null) {
					this.ofs[w][r] = v[r]
				} else {
					if (s != null && s[r] != null) {
						this.ofs[w][r] = s[r]
					} else {
						this.ofs[w][r] = u[r]
					}
				}
			}
		}
	};
	this._applyOffsets();
	this.t = {};
	this.addItem = function(y, x, s, r, w) {
		if (y == null) {
			y = "a" + window.dhx4.newId()
		}
		while (this.t[y] != null) {
			y = "a" + window.dhx4.newId()
		}
		var a = new dhtmlXAccordionCell(y, this);
		a.conf.skin = this.conf.skin;
		a.setText(x);
		if (w != null) {
			a.setIcon(w)
		}
		a.cell._accId = y;
		a.cell.childNodes[a.conf.idx.hdr].onselectstart = function(A) {
			A = A || event;
			if (A.preventDefault) {
				A.preventDefault()
			} else {
				A.returnValue = false
			}
			return false
		};
		a.cell.childNodes[a.conf.idx.hdr].onclick = function(C) {
			C = C || event;
			if (C.preventDefault) {
				C.preventDefault()
			} else {
				C.returnValue = false
			}
			if (l._dnd != null && l._dnd.ofs == true) {
				return
			}
			var A = (C.target || C.srcElement);
			var D = null;
			while (A._accId != this && D == null) {
				if (A._accId != null) {
					D = A._accId
				} else {
					A = A.parentNode
				}
			}
			if (D != null) {
				l._hdrClick(D)
			}
		};
		this.t[y] = {
			cell: a
		};
		this.conf.total_count++;
		if (this.conf.multi_mode) {
			if (typeof(s) == "undefined") {
				s = true
			}
			this.cont.appendChild(a.cell);
			a.conf.opened = (s == true);
			if (typeof(r) == "undefined" || r == null || r == "*") {
				if (r == "*") {
					a.conf.h_auto = true
				}
				r = this.conf.def_height
			} else {
				r = Math.max(parseInt(r), 30)
			}
			a._setSize(this.ofs.m.left, 0, this.conf.cont_w || this._getAvailItemWidth(), a.conf.opened ? r : a._getHdrHeight());
			a.cell.style.marginTop = (a.cell == this.cont.firstChild ? this.ofs.m.first : this.ofs.m.between) + "px";
			if (s != true) {
				a.conf.size.h = r;
				a._adjustCell();
				a.cell.className += " dhx_cell_closed"
			}
			this._adjustOpened();
			if (this._dnd != null) {
				this._dndAttachEvent(y)
			}
		} else {
			s = (this.conf.last_opened == null ? true : window.dhx4.s2b(s));
			var v = this._updateCellsHeight();
			if (this.conf.last_opened != null) {
				if (s) {
					this._closeItem(this.conf.last_opened, false)
				} else {
					var u = this.t[this.conf.last_opened].cell;
					u._setSize(u.conf.size.x, u.conf.size.y, u.conf.size.w, v);
					u = null
				}
			}
			this.cont.appendChild(a.cell);
			a.conf.opened = s;
			a.cell.style.marginTop = String(a.cell == this.cont.firstChild ? this.ofs.s.first : this.ofs.s.between) + "px";
			a._setSize(this.ofs.s.left, 0, this.conf.cont_w || this._getAvailItemWidth(), s ? v : a._getHdrHeight());
			if (s) {
				this.conf.last_opened = y
			} else {
				a.conf.size.h = v;
				a._adjustCell();
				a.cell.className += " dhx_cell_closed"
			}
		}
		a = null;
		return this.t[y].cell
	};
	this.removeItem = function(a) {
		if (!this.t[a]) {
			return
		}
		if (this.conf.last_opened == a) {
			this.conf.last_opened = null
		}
		if (this.conf.on_active_id == a) {
			this.conf.on_active_id = null
		}
		if (this._dnd != null) {
			this._dndClearCell(a)
		}
		this.conf.total_count--;
		if (!this.conf.multi_mode && !this.t[a].cell.conf.visible) {
			this.conf.hiden_count--
		}
		this.t[a].cell._unload();
		this.t[a].cell = null;
		this.t[a] = null;
		delete this.t[a];
		if (!this.conf.unloading) {
			if (!this.conf.multi_mode) {
				this._updateCellsMargin()
			}
			this.setSizes()
		}
	};
	this.cells = function(a) {
		return this.t[a].cell
	};
	this.enableMultiMode = function(a, r) {
		this.conf.multi_mode = true;
		if (!isNaN(r)) {
			this.conf.def_height = r
		}
		if (a == "auto" || a == "scroll") {
			this.cont.style.overflowX = "hidden";
			this.cont.style.overflowY = a
		} else {
			this.cont.style.overflow = "visible"
		}
	};
	this.forEachItem = function(s) {
		for (var r in this.t) {
			if (typeof(s) == "function") {
				s.apply(this, [this.t[r].cell])
			} else {
				if (typeof(s) == "string" && typeof(window[s]) == "function") {
					window[s].apply(this, [this.t[r].cell])
				}
			}
		}
	};
	this._openItem = function(r, a) {
		if (typeof(a) == "undefined") {
			a = true
		}
		if (this.t[r].cell.conf.opened == false) {
			if (this.conf.multi_mode) {
				this.t[r].cell._open(a)
			} else {
				if (this.conf.tr.prop == false) {
					if (this.conf.last_opened != null) {
						this.t[this.conf.last_opened].cell._close(false)
					}
					this.t[r].cell._open(false);
					this.conf.last_opened = r
				} else {
					this.conf.on_active_id = r;
					this.t[r].cell._open(a);
					if (this.conf.last_opened != null) {
						this.t[this.conf.last_opened].cell._close(a)
					}
					this.conf.last_opened = r
				}
			}
		}
	};
	this._closeItem = function(r, a) {
		if (typeof(a) == "undefined") {
			a = true
		}
		if (this.t[r].cell.conf.opened == true) {
			this.t[r].cell._close(a);
			this.conf.last_opened = null
		}
	};
	this._adjustOpened = function() {
		if (this.conf.multi_mode == true) {
			if (this._openCache == null) {
				var v = this._getDynData();
				for (var s in v) {
					this.t[s].cell.conf.size.h = v[s];
					this.t[s].cell.cell.style.height = v[s] + "px"
				}
			} else {
				var w = false;
				for (var s in this._openCache) {
					w = (w || this._openCache[s])
				}
				if (w == true) {
					return
				}
				this._openCache = this._openId = null
			}
			var r = this._getAvailItemWidth();
			for (var s in this.t) {
				var u = true;
				if (r == this.t[s].cell.conf.size.w && (this._openMode == "close" || this.t[s].cell.conf.opened == false)) {
					u = false
				}
				if (u) {
					this.t[s].cell._setWidth(r)
				}
			}
			this._openMode = null
		} else {
			if (this.conf.last_opened != null) {
				var x = this.conf.last_opened;
				this.t[x].cell._setSize(this.t[x].cell.conf.size.x, this.t[x].cell.conf.size.y, this.t[x].cell.conf.size.w, this.t[x].cell.conf.size.h)
			}
		}
	};
	this._getDynData = function(E, D) {
		if (typeof(E) == "undefined" || E == null) {
			E = {}
		}
		if (typeof(D) == "undefined" || D == null) {
			D = {}
		}
		var x = {};
		var C = 0;
		var w = 0;
		var u = 0;
		for (var r = 0; r < this.cont.childNodes.length; r++) {
			var s = this.cont.childNodes[r]._accId;
			var H = this.t[s].cell;
			if (H.conf.visible == true) {
				var y = this.ofs.m[u == 0 ? "first" : "between"];
				if (E[s] == true || D[s] == true || (H.conf.opened == true && H.conf.h_auto == true)) {
					if (D[s] == true) {
						var A = H._getHdrHeight();
						x[s] = A;
						w += A + y
					} else {
						if (H.conf.h_auto == true) {
							x[s] = true;
							w += y;
							C++
						} else {
							if (E[s] == true) {
								x[s] = H.conf.size.h;
								w += H.conf.size.h + y
							}
						}
					}
				} else {
					w += H.cell.offsetHeight + y
				}
				u++
			}
			H = null
		}
		if (C > 0) {
			var v = this.cont.offsetHeight - w;
			var w = Math.floor(v / C);
			for (var F in x) {
				if (x[F] == true) {
					if (C > 1) {
						v -= w
					} else {
						w = v
					}
					x[F] = w;
					C--
				}
			}
		}
		return x
	};
	this.setSizes = function() {
		this._adjustCont();
		if (this.conf.multi_mode == true) {
			this._adjustOpened()
		} else {
			this.conf.cont_w = null;
			var s = this._updateCellsHeight();
			for (var r in this.t) {
				this.t[r].cell._setSize(this.ofs.s.left, 0, this.conf.cont_w || this._getAvailItemWidth(), this.t[r].cell.conf.opened ? s : this.t[r].cell._getHdrHeight());
				if (!this.t[r].cell.conf.opened) {
					this.t[r].cell.conf.size.h = s;
					this.t[r].cell._adjustCell()
				}
			}
			this.conf.size_changed = true
		}
		this.callEvent("_onSetSizes", [])
	};
	this.setSkin = function(s) {
		this._setBaseSkin(s);
		this.conf.skin = s;
		for (var r in this.t) {
			this.t[r].cell.conf.cells_cont = null;
			this.t[r].cell.conf.skin = this.conf.skin
		}
		this._applyOffsets();
		this._updateCellsMargin();
		this.setSizes()
	};
	this.setIconsPath = function(a) {
		this.conf.icons_path = a
	};
	this._getAvailItemWidth = function() {
		var r = this.ofs[(this.conf.multi_mode ? "m" : "s")];
		var a = Math.max(this.cont.clientWidth - r.left - r.right, 10);
		this.conf.cont_w = a;
		r = null;
		return a
	};
	this._updateCellsHeight = function() {
		if (this.conf.multi_mode == true) {
			return
		}
		var s = this.conf.total_count - this.conf.hiden_count;
		var u = this.cont.offsetHeight - this.ofs.s.last;
		if (s == 0) {
			return u
		}
		var w = false;
		for (var v = 0; v < this.cont.childNodes.length; v++) {
			if (w == false) {
				var x = this.cont.childNodes[v]._accId;
				if (this.t[x].cell.conf.visible) {
					u -= this.t[x].cell._getHdrHeight() * (s - 1);
					w = true
				}
			}
		}
		u -= (s - 1) * this.ofs.s.between + this.ofs.s.first;
		for (var r in this.t) {
			if (this.t[r].cell.conf.size != null) {
				this.t[r].cell.conf.size.h = u;
				this.t[r].cell._adjustCell()
			}
		}
		return u
	};
	this._updateCellsMargin = function() {
		var a = 0;
		for (var r = 0; r < this.cont.childNodes.length; r++) {
			var s = this.cont.childNodes[r]._accId;
			if (this.t[s].cell.conf.visible) {
				this.t[s].cell.cell.style.marginTop = String(this.ofs[this.conf.multi_mode ? "m" : "s"][a++ == 0 ? "first" : "between"]) + "px"
			}
		}
	};
	this._hdrClick = function(r) {
		if (!this.conf.multi_mode && this.t[r].cell.conf.opened) {
			return
		}
		var a = this.t[r].cell.conf.opened;
		if (this.callEvent("onBeforeActive", [r, (a ? false : true)]) !== true) {
			return
		}
		this.conf.on_active_click = true;
		this[a ? "_closeItem" : "_openItem"](r);
		if (this.conf.multi_mode && this.conf.tr.prop == false) {
			this._adjustOpened()
		}
	};
	this.unload = function() {
		this.conf.unloading = true;
		for (var r in this.t) {
			this.removeItem(r)
		}
		this.t = null;
		if (typeof(this._unloadDND) == "function") {
			this._unloadDND()
		}
		if (this.conf.fs_mode) {
			if (this.conf.fs_tm) {
				window.clearTimeout(this.conf.fs_tm)
			}
			if (window.addEventListener) {
				window.removeEventListener("resize", this._doOnResizeStart, false)
			} else {
				window.detachEvent("onresize", this._doOnResizeStart)
			}
			this._doOnResizeStart = null;
			this._doOnResizeEnd = null;
			this.conf.fs_tm = null
		}
		if (this.dhxWins) {
			this.dhxWins.unload();
			this.dhxWins = null
		}
		this._unloadTop();
		window.dhx4._enableDataLoading(this, null, null, null, "clear");
		window.dhx4._eventable(this, "clear");
		this.ofs = this.conf = null;
		for (var r in this) {
			this[r] = null
		}
		l = null
	};
	this.setOffset = function(a) {
		this.ofs.s.between = a;
		this.ofs.m.between = a;
		this._updateCellsMargin();
		this.setSizes()
	};
	this._initObj = function(r) {
		if (r.skin != null) {
			this.setSkin(r.skin)
		}
		if (window.dhx4.s2b(r.multi_mode)) {
			this.enableMultiMode()
		}
		if (r.icons_path != null) {
			this.setIconsPath(r.icons_path)
		}
		if (r.icon_path != null) {
			this.setIconsPath(r.icon_path)
		}
		if (r.items != null) {
			for (var a = 0; a < r.items.length; a++) {
				this.addItem(r.items[a].id, r.items[a].text, r.items[a].open, r.items[a].height, r.items[a].icon || r.items[a].img)
			}
		}
		if (window.dhx4.s2b(r.dnd) == true && typeof(this.enableDND) == "function") {
			this.enableDND()
		}
	};
	this._xmlToObj = function(v) {
		var s = {
			items: []
		};
		var a = v.getElementsByTagName("accordion")[0];
		if (a.getAttribute("skin") != null) {
			s.skin = a.getAttribute("skin")
		}
		if (a.getAttribute("mode") == "multi") {
			s.multi_mode = true
		}
		if (a.getAttribute("multiMode") != null) {
			s.multi_mode = window.dhx4.s2b(a.getAttribute("multiMode"))
		}
		if (a.getAttribute("iconsPath") != null) {
			s.icons_path = a.getAttribute("iconsPath")
		}
		for (var u = 0; u < a.childNodes.length; u++) {
			var w = a.childNodes[u];
			if (typeof(w.tagName) != "undefined" && String(w.tagName).toLowerCase() == "cell") {
				var r = {};
				if (w.getAttribute("id") != null) {
					r.id = w.getAttribute("id")
				}
				if (w.getAttribute("icon") != null) {
					r.icon = w.getAttribute("icon")
				}
				if (w.getAttribute("height") != null) {
					r.height = w.getAttribute("height")
				}
				if (w.getAttribute("open") != null) {
					r.open = window.dhx4.s2b(w.getAttribute("open"))
				}
				r.text = w.firstChild.nodeValue;
				s.items.push(r)
			}
			w = null
		}
		return s
	};
	window.dhx4._enableDataLoading(this, "_initObj", "_xmlToObj", "accordion", {
		struct: true
	});
	window.dhx4._eventable(this);
	this._callMainEvent = function(r, a) {
		return this.callEvent(r, a)
	};
	this.attachEvent("onActive", function(a) {
		if (this.t[a].cell.dataObj != null && this.t[a].cell.dataType == "editor") {
			this.t[a].cell.dataObj._prepareContent(true)
		}
		if (this.t[a].cell.conf.opened == true) {
			this.t[a].cell._adjustProgress()
		}
	});
	if (typeof(window.dhtmlXWindows) == "function") {
		this.dhxWins = new dhtmlXWindows();
		this.dhxWins.setSkin(this.conf.skin)
	}
	if (n != null) {
		this._initObj(n);
		n = null
	}
	return this
}
dhtmlXAccordion.prototype = new dhtmlXCellTop();

function dhtmlXAccordionCell(l, g) {
	dhtmlXCellObject.apply(this, [l, "_acc"]);
	this.acc = g;
	this.conf.visible = true;
	this.conf.docked = true;
	this.attachEvent("_onCellUnload", function() {
		this._trDetachEv();
		this._unloadDocking();
		this.acc = null;
		this.cell._accObj = null;
		this.cell.childNodes[this.conf.idx.hdr].onselectstart = null;
		this.cell.childNodes[this.conf.idx.hdr].onclick = null;
		this._initHeader = null;
		this._getHdrHeight = null;
		this._setWidth = null;
		this._adjustCell = null;
		this._open = null;
		this._close = null;
		this._isOpened = null;
		this._trInitEv = null;
		this._trAttachEv = null;
		this._trDetachEv = null;
		this._trOnEnd = null;
		this._onActiveCall = null;
		this.setText = null;
		this.getText = null;
		this.setIcon = null;
		this.clearIcon = null;
		this.show = null;
		this.hide = null;
		this.isVisible = null;
		this.setHeight = null;
		this.moveOnTop = null
	});
	this.acc.attachEvent("onBeforeDrag", function(n) {
		if (this.t[n].cell.dataObj != null && this.t[n].cell.dataType == "editor") {
			if (this.conf.editor_data == null) {
				this.conf.editor_data = {}
			}
			this.conf.editor_data[n] = this.t[n].cell.dataObj.getContent()
		}
		for (var m in this.t) {
			this.t[m].cell._showCellCover()
		}
		return true
	});
	this.acc.attachEvent("onDrop", function(n) {
		if (this.t[n].cell.dataObj != null && this.t[n].cell.dataType == "editor") {
			this.t[n].cell.dataObj._prepareContent(true);
			if (this.conf.editor_data != null && this.conf.editor_data[n] != null) {
				this.t[n].cell.dataObj.setContent(this.conf.editor_data[n]);
				this.conf.editor_data[n] = null
			}
		}
		for (var m in this.t) {
			this.t[m].cell._hideCellCover()
		}
	});
	this.attachEvent("_onContentLoaded", function() {
		this.acc._callMainEvent("onContentLoaded", arguments)
	});
	this.attachEvent("_onBeforeContentAttach", function(a) {
		if (a == "sidebar") {
			this._hideBorders()
		}
	});
	this._initHeader();
	this.conf.tr = {};
	for (var c in this.acc.conf.tr) {
		this.conf.tr[c] = this.acc.conf.tr[c]
	}
	if (this.conf.tr.prop != false) {
		this.attachEvent("_onIdxUpdated", function() {
			this._cellSetOpacity((this.conf.opened ? "open" : "close"), false)
		})
	}
	this.open = function() {
		this.acc._openItem(this._idd)
	};
	this.close = function() {
		this.acc._closeItem(this._idd)
	};
	this._setWidth = function(a) {
		if (a != this.conf.size.w) {
			this.conf.size.w = a;
			this.cell.style.width = a + "px"
		}
		this._adjustCell()
	};
	this._adjustCell = function() {
		this._adjustCont();
		if (this.dataObj != null && typeof(this.dataObj.setSizes) == "function") {
			this.dataObj.setSizes()
		}
	};
	this._initDocking();
	return this
}
dhtmlXAccordionCell.prototype = new dhtmlXCellObject();
dhtmlXAccordionCell.prototype._initHeader = function() {
	var a = document.createElement("DIV");
	a.className = "dhx_cell_hdr";
	a.innerHTML = "<div class='dhx_cell_hdr_text'></div><div class='dhx_cell_hdr_arrow'></div>";
	this.cell.insertBefore(a, this.cell.childNodes[this.conf.idx.cont]);
	a = null;
	this.conf.ofs_nodes.t._getHdrHeight = "func";
	this.conf.hdr = {
		visible: true
	};
	this.conf.idx_data.hdr = "dhx_cell_hdr";
	this._updateIdx()
};
dhtmlXAccordionCell.prototype._getHdrHeight = function() {
	return this.cell.childNodes[this.conf.idx.hdr].offsetHeight
};
dhtmlXAccordionCell.prototype.setText = function(a) {
	this.conf.text = a;
	this.cell.childNodes[this.conf.idx.hdr].firstChild.innerHTML = "<span>" + a + "</span>"
};
dhtmlXAccordionCell.prototype.getText = function() {
	return this.conf.text
};
dhtmlXAccordionCell.prototype.setIcon = function(g) {
	var c = this.cell.childNodes[this.conf.idx.hdr];
	if (c.firstChild.className != "dhx_cell_hdr_icon") {
		c.firstChild.className += " dhx_cell_hdr_icon";
		var a = document.createElement("IMG");
		a.className = "dhx_cell_hdr_icon";
		c.insertBefore(a, c.firstChild);
		a = null
	}
	c.firstChild.src = this.acc.conf.icons_path + g;
	c = null
};
dhtmlXAccordionCell.prototype.clearIcon = function() {
	var a = this.cell.childNodes[this.conf.idx.hdr];
	if (a.firstChild.className == "dhx_cell_hdr_icon") {
		a.removeChild(a.firstChild);
		a.firstChild.className = String(a.firstChild.className).replace(/\s{1,}dhx_cell_hdr_icon/gi, "")
	}
	a = null
};
dhtmlXAccordionCell.prototype._open = function(c) {
	var m = {};
	if (this.acc.conf.multi_mode) {
		var l = {};
		l[this._idd] = true;
		m = this.acc._getDynData(l);
		this.acc._openId = this._idd;
		this.acc._openCache = {};
		this.acc._openMode = "open"
	} else {
		m[this._idd] = this.conf.size.h
	}
	for (var g in m) {
		if (this.acc._openCache != null) {
			this.acc._openCache[g] = true
		}
		var n = this.acc.t[g].cell;
		n.cell.className = String(n.cell.className).replace(/\s{1,}dhx_cell_closed/gi, "");
		n.conf.opened = true;
		n._trInitEv("open", c);
		n.conf.size.h = m[g];
		n.cell.style.height = n.conf.size.h + "px";
		n = null
	}
	if (this.conf.tr.prop == false) {
		this.acc._openId = this.acc._openCache = this.acc._openMode = null;
		this._onActiveCall(true)
	}
};
dhtmlXAccordionCell.prototype._close = function(c) {
	var l = {};
	if (this.acc.conf.multi_mode) {
		var m = {};
		m[this._idd] = true;
		l = this.acc._getDynData(null, m);
		this.acc._openId = this._idd;
		this.acc._openCache = {};
		this.acc._openMode = "close"
	} else {
		l[this._idd] = this._getHdrHeight()
	}
	for (var g in l) {
		var n = this.acc.t[g].cell;
		if (this.acc._openCache != null) {
			this.acc._openCache[g] = true
		}
		if (g == this._idd) {
			n.cell.className += " dhx_cell_closed";
			n.conf.opened = false;
			n._trInitEv("close", c)
		} else {
			n.conf.size.h = l[g];
			n._adjustCell();
			n._trInitEv("open", c)
		}
		n.cell.style.height = l[g] + "px";
		n = null
	}
	if (this.conf.tr.prop == false) {
		this.acc._openId = this.acc._openCache = this.acc._openMode = null;
		this._onActiveCall(false)
	}
};
dhtmlXAccordionCell.prototype.isOpened = function() {
	return (this.conf.opened == true)
};
dhtmlXAccordionCell.prototype._trInitEv = function(c, a) {
	if (this.conf.tr.prop == false) {
		return
	}
	this._trAttachEv();
	if (!this.cell._accObj) {
		this.cell._accObj = this.acc
	}
	if (a) {
		this.cell.style[this.conf.tr.prop] = this.conf.tr["height_" + c]
	}
	this._cellSetOpacity(c, a)
};
dhtmlXAccordionCell.prototype._trAttachEv = function() {
	if (!this.conf.tr.ev_attached) {
		this.cell._trProp = this.conf.tr.prop;
		this.cell.addEventListener(this.conf.tr.ev, this._trOnEnd, false);
		this.conf.tr.ev_attached = true
	}
};
dhtmlXAccordionCell.prototype._trDetachEv = function() {
	if (this.conf.tr.ev_attached) {
		this.cell.addEventListener(this.conf.tr.ev, this._trOnEnd, false);
		this.conf.tr.ev_attached = false
	}
};
dhtmlXAccordionCell.prototype._trOnEnd = function(a) {
	if (a.stopPropagation) {
		a.stopPropagation()
	}
	if (a.propertyName == "height" && this._accObj != null) {
		this.style[this._trProp] = "";
		if (this._accObj.conf.multi_mode) {
			if (this._accObj._openCache != null) {
				this._accObj._openCache[this._accId] = false
			}
			this._accObj._adjustOpened()
		}
		if (this._accObj.conf.on_active_click == true) {
			if (this._accObj.conf.multi_mode) {
				this._accObj._callMainEvent("onActive", [this._accId, this._accObj.t[this._accId].cell.conf.opened]);
				this._accObj.conf.on_active_click = false
			} else {
				this._accObj._callMainEvent("onActive", [this._accObj.conf.on_active_id, true]);
				this._accObj.conf.on_active_id = null;
				this._accObj.conf.on_active_click = false
			}
		}
		this._accObj = null
	}
};
dhtmlXAccordionCell.prototype._cellSetOpacity = function(l, c) {
	for (var g in this.conf.idx) {
		if ({
				hdr: true,
				pr1: true,
				pr2: true,
				cover: true
			}[g] != true) {
			if (c) {
				this.cell.childNodes[this.conf.idx[g]].style[this.conf.tr.prop] = this.conf.tr["op_" + l]
			}
			this.cell.childNodes[this.conf.idx[g]].style.opacity = this.conf.tr["op_v_" + l]
		}
	}
};
dhtmlXAccordionCell.prototype._onActiveCall = function(a) {
	if (this.acc.conf.on_active_click == false) {
		return
	}
	if (this.acc.conf.multi_mode == true) {
		this.acc._callMainEvent("onActive", [this._idd, this.conf.opened]);
		this.acc.conf.on_active_click = false
	} else {
		if (a == true) {
			this.acc._callMainEvent("onActive", [this._idd, true]);
			this.acc.conf.on_active_click = false
		}
	}
};
dhtmlXAccordionCell.prototype.show = function() {
	if (this.conf.visible) {
		return
	}
	if (this.conf.docked == false) {
		this.dock();
		return
	}
	this.cell.style.display = "";
	this.conf.visible = true;
	if (!this.acc.conf.multi_mode) {
		this.acc.conf.hiden_count--;
		this.acc._updateCellsHeight();
		this.acc._updateCellsMargin()
	}
	if (this.acc.conf.size_changed) {
		this.acc.setSizes();
		this.acc.conf.size_changed = false
	} else {
		this.acc._adjustOpened()
	}
};
dhtmlXAccordionCell.prototype.hide = function() {
	if (!this.conf.visible) {
		return
	}
	if (!this.acc.conf.multi_mode && this.conf.opened) {
		this._close(false);
		this.acc.conf.last_opened = null
	}
	this.cell.style.display = "none";
	this.conf.visible = false;
	if (!this.acc.conf.multi_mode) {
		this.acc.conf.hiden_count++;
		this.acc._updateCellsHeight();
		this.acc._updateCellsMargin()
	}
	this.acc._adjustOpened()
};
dhtmlXAccordionCell.prototype.isVisible = function() {
	return (this.conf.visible == true)
};
dhtmlXAccordionCell.prototype.setHeight = function(a) {
	if (!this.acc.conf.multi_mode) {
		return
	}
	if (a == "*") {
		this.conf.h_auto = true
	} else {
		this.conf.h_auto = false;
		this.conf.size.h = a
	}
	if (this.conf.opened) {
		if (a != "*") {
			this.cell.style.height = a + "px"
		}
		this.acc._adjustOpened()
	}
};
dhtmlXAccordionCell.prototype.moveOnTop = function() {
	if (this.cell.parentNode.firstChild == this.cell) {
		return
	}
	this.cell.parentNode.insertBefore(this.cell, this.cell.parentNode.firstChild);
	this.acc._updateCellsMargin()
};
dhtmlXAccordionCell.prototype._initDocking = function() {
	var a = this;
	this.dock = function() {
		if (this.acc.dhxWins == null || this.conf.docked == true) {
			return
		}
		var c = this.acc.dhxWins.window(this._idd);
		c.close();
		this._attachFromCell(c);
		this.conf.docked = true;
		this.show();
		if (this.conf.dock_opened) {
			this.open()
		}
		c = null;
		this.acc._callMainEvent("onDock", [this._idd])
	};
	this.undock = function(c, n, l, m) {
		if (this.acc.dhxWins == null || this.conf.docked == false) {
			return
		}
		this.conf.dock_opened = this.conf.opened;
		if (this.acc.dhxWins.window(this._idd) != null) {
			var g = this.acc.dhxWins.window(this._idd);
			g.show()
		} else {
			if (c == null) {
				c = 20
			}
			if (n == null) {
				n = 20
			}
			if (l == null) {
				l = 320
			}
			if (m == null) {
				m = 200
			}
			var g = this.acc.dhxWins.createWindow(this._idd, c, n, l, m);
			g.button("close").hide();
			g.addUserButton("dock", 99, "Dock");
			g.button("dock").show();
			g.button("dock").attachEvent("onClick", this._doOnDockClick);
			g.setText(this.getText());
			g.attachEvent("onClose", this._doOnDockWinClose)
		}
		this.conf.docked = false;
		this.hide();
		g._attachFromCell(this);
		g = null;
		this.acc._callMainEvent("onUnDock", [this._idd])
	};
	this._doOnDockClick = function() {
		a.dock()
	};
	this._doOnDockWinClose = function(c) {
		c.hide();
		return false
	};
	this._unloadDocking = function() {
		a = null
	}
};
dhtmlXCellObject.prototype.attachAccordion = function(a) {
	this.callEvent("_onBeforeContentAttach", ["acc"]);
	var c = document.createElement("DIV");
	c.style.width = "100%";
	c.style.height = "100%";
	c.style.position = "relative";
	this._attachObject(c);
	if (typeof(a) == "undefined") {
		a = {}
	}
	if (typeof(a.skin) == "undefined") {
		a.skin = this.conf.skin
	}
	a.parent = c;
	if (typeof(window.dhtmlXAccordionCell) != "undefined" && (this instanceof window.dhtmlXAccordionCell)) {
		c._ofs = {
			s: {
				first: -1
			},
			m: {
				first: 4
			}
		}
	}
	if (typeof(window.dhtmlXSideBarCell) != "undefined" && (this instanceof window.dhtmlXSideBarCell)) {
		if (this.conf.skin == "dhx_web") {
			c._ofs = {
				l: 2
			}
		} else {
			c._ofs = {
				l: -1
			}
		}
	}
	this.dataType = "acc";
	this.dataObj = new dhtmlXAccordion(a);
	a.obj = null;
	c = a = null;
	this.callEvent("_onContentAttach", []);
	return this.dataObj
};
dhtmlXAccordion.prototype.enableDND = function() {
	if (this.conf.multi_mode == false || this._dnd != null) {
		return
	}
	var g = this;
	this._dnd = {
		tr_count: 0,
		tr_items: {}
	};
	this._dndAttachEvent = function(l) {
		var a = this.t[l].cell;
		if (a.conf.dnd_inited != true) {
			if (typeof(window.addEventListener) == "function") {
				a.cell.childNodes[a.conf.idx.hdr].addEventListener("mousedown", this._dndOnMouseDown, false)
			} else {
				a.cell.childNodes[a.conf.idx.hdr].attachEvent("onmousedown", this._dndOnMouseDown)
			}
			a.conf.dnd_inited = true
		}
		a = null
	};
	this._dndDetachEvent = function(l) {
		var a = this.t[l].cell;
		if (a.conf.dnd_inited == true) {
			if (typeof(window.addEventListener) == "function") {
				a.cell.childNodes[a.conf.idx.hdr].removeEventListener("mousedown", this._dndOnMouseDown, false)
			} else {
				a.cell.childNodes[a.conf.idx.hdr].detachEvent("onmousedown", this._dndOnMouseDown)
			}
			a.conf.dnd_inited = false
		}
		a = null
	};
	this._dndOnMouseDown = function(l) {
		l = l || event;
		if (l.preventDefault) {
			l.preventDefault()
		}
		var a = (l.target || l.srcElement);
		while (a != null && a.parentNode != g.cont) {
			a = a.parentNode
		}
		if (a != null) {
			g._dndDragStart(l, a)
		}
		a = null
	};
	this._dndDragStart = function(o, m) {
		if (this._dnd.tr_waiting == true) {
			return
		}
		var a = -1;
		for (var n = 0; n < m.parentNode.childNodes.length; n++) {
			if (m.parentNode.childNodes[n] == m) {
				a = n
			}
		}
		if (this.callEvent("onBeforeDrag", [m._accId, a]) !== true) {
			return
		}
		if (typeof(window.addEventListener) == "function") {
			document.body.addEventListener("mousemove", this._dndOnMouseMove, false);
			document.body.addEventListener("mouseup", this._dndOnMouseUp, false)
		} else {
			document.body.attachEvent("onmousemove", this._dndOnMouseMove, false);
			document.body.attachEvent("onmouseup", this._dndOnMouseUp, false)
		}
		this._dnd.dragObj = m;
		this._dnd.dy = o.clientY;
		var l = 0;
		for (var n = 0; n < this._dnd.dragObj.parentNode.childNodes.length; n++) {
			this._dnd.dragObj.parentNode.childNodes[n]._ind = n;
			if (this._dnd.dragObj.parentNode.childNodes[n] == this._dnd.dragObj) {
				this._dnd.dragObj._k0 = l;
				if (n > 0) {
					this._dnd.dragObj._k0 += this.ofs.m.between - this.ofs.m.first
				}
				l = 0
			} else {
				l += this._dnd.dragObj.parentNode.childNodes[n].offsetHeight + parseInt(this._dnd.dragObj.parentNode.childNodes[n].style.marginTop)
			}
		}
		this._dnd.dragObj._k1 = l;
		this._dnd.h = this._dnd.dragObj.offsetHeight;
		this._dnd.ofs = false
	};
	this._dndDoDrag = function(w) {
		if (!this._dnd.dragObj) {
			return
		}
		if (this._dnd.tr_waiting == true) {
			return
		}
		var o = w.clientY - this._dnd.dy;
		if (this._dnd.ofs == false && Math.abs(o) > 5) {
			this._dnd.dragObj.className += " acc_cell_dragged";
			this._dnd.ofs = true
		}
		if (o < 0) {
			if (o < -this._dnd.dragObj._k0) {
				o = -this._dnd.dragObj._k0
			}
		} else {
			if (o > this._dnd.dragObj._k1) {
				o = this._dnd.dragObj._k1
			}
		}
		this._dnd.dragObj.style.top = o + "px";
		var v = w.clientY - this._dnd.dy;
		var n = 0;
		var l = 0;
		for (var u = this._dnd.dragObj._ind + 1; u <= this._dnd.dragObj.parentNode.lastChild._ind; u++) {
			var a = this._dnd.dragObj.parentNode.childNodes[u].offsetHeight;
			if (v > n + a * 2 / 3) {
				l++
			}
			n += a
		}
		var m = this._dnd.dragObj.nextSibling;
		var u = 0;
		while (m != null) {
			if (++u <= l && m != null) {
				if (!m._ontop) {
					if (m._tm) {
						window.clearTimeout(m._tm)
					}
					this._dndAnim(m, false, parseInt(m.style.top || 0), -this._dnd.h - this.ofs.m.between);
					m._ontop = true
				}
			} else {
				if (m._ontop) {
					if (m._tm) {
						window.clearTimeout(m._tm)
					}
					this._dndAnim(m, true, parseInt(m.style.top || 0), 0);
					m._ontop = false
				}
			}
			m = m.nextSibling
		}
		var v = this._dnd.dy - w.clientY;
		var n = 0;
		var l = 0;
		for (var u = this._dnd.dragObj._ind - 1; u >= this._dnd.dragObj.parentNode.firstChild._ind; u--) {
			var a = this._dnd.dragObj.parentNode.childNodes[u].offsetHeight;
			if (v > n + a * 2 / 3) {
				l++
			}
			n += a
		}
		var m = this._dnd.dragObj.previousSibling;
		var u = 0;
		while (m != null) {
			if (++u <= l && m != null) {
				if (!m._onbottom) {
					if (m._tm) {
						window.clearTimeout(m._tm)
					}
					this._dndAnim(m, true, parseInt(m.style.top || 0), this._dnd.h + this.ofs.m.between);
					m._onbottom = true
				}
			} else {
				if (m._onbottom) {
					if (m._tm) {
						window.clearTimeout(m._tm)
					}
					this._dndAnim(m, false, parseInt(m.style.top), 0);
					m._onbottom = false
				}
			}
			m = m.previousSibling
		}
	};
	this._dndDragStop = function(u, o) {
		if (o) {} else {
			if (this._dnd.tr_count > 0) {
				this._dnd.tr_waiting = true;
				return
			}
		}
		if (!this._dnd.dragObj) {
			return
		}
		this._dnd.dragObj.className = String(this._dnd.dragObj.className).replace(/\s{0,}acc_cell_dragged/gi, "");
		this._dnd.dragObj.style.top = "0px";
		var r = false;
		for (var n = 0; n < this._dnd.dragObj.parentNode.childNodes.length; n++) {
			var m = this._dnd.dragObj.parentNode.childNodes[n];
			if (m != this._dnd.dragObj) {
				if (m._tm) {
					window.clearTimeout(m._tm)
				}
				m.style.top = "0px";
				if (m._ontop && ((m.nextSibling != null && m.nextSibling._ontop != true) || !m.nextSibling)) {
					r = (m.nextSibling || null)
				}
				if (m._onbottom && ((m.previousSibling != null && m.previousSibling._onbottom != true) || !m.previousSibling)) {
					r = m
				}
			}
			m = null
		}
		for (var n = 0; n < this._dnd.dragObj.parentNode.childNodes.length; n++) {
			this._dnd.dragObj.parentNode.childNodes[n]._ontop = null;
			this._dnd.dragObj.parentNode.childNodes[n]._onbottom = null
		}
		if (r !== false) {
			if (r == null) {
				this._dnd.dragObj.parentNode.appendChild(this._dnd.dragObj)
			} else {
				this._dnd.dragObj.parentNode.insertBefore(this._dnd.dragObj, r)
			}
		}
		var v = this._dnd.dragObj._accId;
		var l = this._dnd.dragObj._ind;
		var a = l;
		for (var n = 0; n < this._dnd.dragObj.parentNode.childNodes.length; n++) {
			if (this._dnd.dragObj.parentNode.childNodes[n] == this._dnd.dragObj) {
				a = n
			}
		}
		this._dnd.dragObj = null;
		this._dnd.tr_waiting = false;
		this._updateCellsMargin();
		if (l != a) {
			this.setSizes();
			this.callEvent("onDrop", [v, l, a])
		}
		if (typeof(window.addEventListener) == "function") {
			document.body.removeEventListener("mousemove", this._dndOnMouseMove, false);
			document.body.removeEventListener("mouseup", this._dndOnMouseUp, false)
		} else {
			document.body.detachEvent("onmousemove", this._dndOnMouseMove, false);
			document.body.detachEvent("onmouseup", this._dndOnMouseUp, false)
		}
	};
	this._dndAnim = function(o, a, n, m) {
		if (this.conf.tr.prop != false) {
			if (!o._dnd_ev) {
				o._dnd_ev = true;
				o._dnd_tr_prop = this.conf.tr.prop;
				o.addEventListener(this.conf.tr.ev, this._dndOnTrEnd, false)
			}
			if (this._dnd.tr_items[o._accId] != true) {
				this._dnd.tr_items[o._accId] = true;
				this._dnd.tr_count++
			}
			o.style[this.conf.tr.prop] = this.conf.tr.dnd_top;
			o.style.top = m + "px";
			return
		}
		var l = false;
		if (a) {
			n += 5;
			if (n >= m) {
				n = m;
				l = true
			}
		} else {
			n -= 5;
			if (n <= m) {
				n = m;
				l = true
			}
		}
		o.style.top = n + "px";
		if (o._tm) {
			window.clearTimeout(o._tm)
		}
		if (!l) {
			o._tm = window.setTimeout(function() {
				g._dndAnim(o, a, n, m)
			}, 5)
		} else {
			o._tm = null
		}
	};
	this._dndOnTrEnd = function(a) {
		if (a.stopPropagation) {
			a.stopPropagation()
		}
		if (a.propertyName == "top") {
			if (g._dnd.tr_items[this._accId] == true) {
				g._dnd.tr_count--;
				g._dnd.tr_items[this._accId] = false
			}
			this.style[this._dnd_tr_prop] = "";
			if (g._dnd.tr_count == 0 && g._dnd.tr_waiting == true) {
				g._dndDragStop(null, true)
			}
		}
	};
	this._dndOnMouseMove = function(a) {
		g._dndDoDrag(a || event)
	};
	this._dndOnMouseUp = function(a) {
		g._dndDragStop(a || event)
	};
	this._dndClearCell = function(a) {
		if (this.t[a].cell.cell._dnd_ev) {
			this.t[a].cell.cell.addEventListener(this.conf.tr.ev, this._dndOnTrEnd, false)
		}
		this._dndDetachEvent(a)
	};
	this._unloadDND = function() {
		for (var l in this) {
			if (String(l).indexOf("_dnd") == 0 && typeof(this[l]) == "function") {
				this[l] = null
			}
		}
		this._dnd = null;
		g = null
	};
	for (var c in this.t) {
		this._dndAttachEvent(c)
	}
};

function dhtmlXLayoutObject(g, r, x) {
	var v = null;
	if (g != null && typeof(g) == "object" && typeof(g.tagName) == "undefined" && g._isCell != true) {
		v = {};
		if (g.autosize != null) {
			v.autosize = g.autosize
		}
		if (g.cells != null) {
			v.cells = g.cells
		}
		if (g.pattern != null) {
			r = g.pattern
		}
		if (g.skin != null) {
			x = g.skin
		}
		if (g.offsets != null) {
			v.offsets = g.offsets
		}
		g = g.parent
	}
	this.cdata = {};
	this.conf = {
		skin: (x || window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhxlayout") || "dhx_skyblue"),
		css: "dhxlayout",
		hh: 20,
		autosize: "b",
		nextCell: {
			a: "b",
			b: "a"
		},
		inited: false,
		b_size: {
			w: -1,
			h: -1
		}
	};
	if (typeof(g) == "object" && g._isCell == true) {
		var o = (typeof(v) != "undefined" && v != null ? v : {});
		if (o.pattern == null && r != null) {
			o.pattern = r
		}
		if (o.skin == null && x != null) {
			o.skin = x
		}
		var m = g.attachLayout(o);
		return m
	}
	window.dhtmlXCellTop.apply(this, [g, (v == null ? null : v.offsets)]);
	this.conf.sw = this._detectSW();
	var n = this;
	this._getLayout = function() {
		return this
	};
	this.mainInst = (g._layoutMainInst != null ? g._layoutMainInst : null);
	this._getMainInst = function() {
		if (this.mainInst != null) {
			return this.mainInst._getMainInst()
		}
		return this
	};
	this._init = function(C) {
		var A = (typeof(C) == "string" ? this.tplData[C] : C);
		this.conf.mode = A.mode;
		if (this.conf.mode == "c") {
			this.cdata.a = new dhtmlXLayoutCell("a", this)
		} else {
			this.cdata.a = new dhtmlXLayoutCell("a", this);
			this.cdata.b = new dhtmlXLayoutCell("b", this)
		}
		for (var y in this.cdata) {
			this.cont.appendChild(this.cdata[y].cell);
			this.cdata[y].conf.init = {
				w: 0.5,
				h: 0.5
			}
		}
		if (this.conf.mode != "c") {
			var q = this._getMainInst();
			if (q.conf.sep_idx == null) {
				q.conf.sep_idx = 1
			} else {
				q.conf.sep_idx++
			}
			this.sep = new dhtmlXLayoutSepObject(this.conf.mode, q.conf.sep_idx);
			this.cont.appendChild(this.sep.sep);
			this.sep._getLayout = function() {
				return n._getLayout()
			};
			q = null
		}
		if (A.cells != null) {
			for (var y in A.cells) {
				if (A.cells[y].width != null) {
					this.cdata[y].conf.init.w = A.cells[y].width
				}
				if (A.cells[y].height != null) {
					this.cdata[y].conf.init.h = A.cells[y].height
				}
				if (A.cells[y].name != null) {
					this.cdata[y].conf.name = A.cells[y].name;
					this.cdata[y].setText(A.cells[y].name)
				}
				if (A.cells[y].fsize != null) {
					this.cdata[y].conf.fsize = A.cells[y].fsize
				}
			}
		}
		this.setSizes();
		for (var y in this.cdata) {
			this.cdata[y].conf.init = {}
		}
		if (A.cells != null) {
			for (var y in A.cells) {
				if (A.cells[y].layout != null) {
					this.cdata[y].dataNested = true;
					this.cdata[y]._layoutMainInst = this;
					this.cdata[y].attachLayout({
						pattern: A.cells[y].layout
					});
					this.cdata[y]._layoutMainInst = null
				}
			}
		}
	};
	this.setSizes = function(F, N, J, y) {
		var H = (this.conf.inited == true && this._getMainInst() == this && this.checkEvent("onResizeFinish") == true ? {} : false);
		this._adjustCont();
		var M = this.cont.offsetWidth;
		var D = this.cont.offsetHeight;
		if (this.conf.mode == "c") {
			var a = 0;
			var O = 0;
			var q = M;
			var L = D;
			this.cdata.a._setSize(a, O, q, L, F, J, y);
			this.callEvent("_onSetSizes", []);
			if (H && (!(this.conf.b_size.w == M && this.conf.b_size.h == D))) {
				this._callMainEvent("onResizeFinish", [])
			}
			this.conf.b_size = {
				w: M,
				h: D
			};
			return
		}
		if (typeof(N) == "undefined") {
			var A = (this.conf.mode == "v" ? "w" : "h");
			N = this.conf.autosize;
			if (this.cdata.a.conf.collapsed) {
				N = "b"
			} else {
				if (this.cdata.b.conf.collapsed) {
					N = "a"
				} else {
					if (F == "a" || F == "b") {
						N = this.conf.nextCell[F]
					}
				}
			}
		} else {}
		if (this.conf.mode == "v") {
			if (N == "a") {
				if (this.cdata.b.conf.init.w != null) {
					var K = Math.round(M * this.cdata.b.conf.init.w - this.conf.sw / 2)
				} else {
					var K = this.cdata.b.conf.size.w
				}
				var I = M - K;
				var E = 0;
				var C = D;
				var a = 0;
				var O = E;
				var q = I - a - this.conf.sw;
				var L = C
			} else {
				var a = 0;
				var O = 0;
				if (this.cdata.a.conf.init.w != null) {
					var q = Math.round(M * this.cdata.a.conf.init.w - this.conf.sw / 2) - a
				} else {
					var q = this.cdata.a.conf.size.w
				}
				var L = D - O;
				var I = a + q + this.conf.sw;
				var E = O;
				var K = M - I;
				var C = L
			}
			this.cdata.a._setSize(a, O, q, L, F, J, y);
			this.cdata.b._setSize(I, E, K, C, F, J, y);
			this.sep._setSize(a + q, O, this.conf.sw, L)
		} else {
			if (N == "a") {
				if (this.cdata.b.conf.init.h != null) {
					var C = Math.round(D * this.cdata.b.conf.init.h - this.conf.sw / 2)
				} else {
					var C = this.cdata.b.conf.size.h
				}
				var I = 0;
				var E = D - C;
				var K = M - I;
				var a = I;
				var O = 0;
				var q = K;
				var L = E - O - this.conf.sw
			} else {
				var a = 0;
				var O = 0;
				var q = M - a;
				if (this.cdata.a.conf.init.h != null) {
					var L = Math.round(D * this.cdata.a.conf.init.h - this.conf.sw / 2)
				} else {
					var L = this.cdata.a.conf.size.h
				}
				var I = a;
				var E = O + L + this.conf.sw;
				var K = q;
				var C = D - E
			}
			this.cdata.a._setSize(a, O, q, L, F, J, y);
			this.cdata.b._setSize(I, E, K, C, F, J, y);
			this.sep._setSize(a, O + L, q, this.conf.sw)
		}
		this.callEvent("_onSetSizes", []);
		if (H && (!(this.conf.b_size.w == M && this.conf.b_size.h == D))) {
			this._callMainEvent("onResizeFinish", [])
		}
		this.conf.b_size = {
			w: M,
			h: D
		}
	};
	this._getAvailWidth = function() {
		var C = [];
		for (var F = 0; F < this.conf.as_cells.h.length; F++) {
			var y = this.cells(this.conf.as_cells.h[F]);
			var D = y.layout;
			var A = D.conf.autosize;
			if (y.conf.collapsed) {
				y = D.cdata[D.conf.nextCell[y._idd]];
				A = D.conf.nextCell[A]
			}
			C.push(Math.max(0, y.getWidth() - y._getMinWidth(A)));
			D = y = null
		}
		var E = (C.length > 0 ? Math.min.apply(window, C) : 0);
		return this.cont.offsetWidth - E
	};
	this._getAvailHeight = function() {
		var D = [];
		for (var F = 0; F < this.conf.as_cells.v.length; F++) {
			var y = this.cells(this.conf.as_cells.v[F]);
			var C = y.layout;
			var A = C.conf.autosize;
			if (y.conf.collapsed) {
				y = C.cdata[C.conf.nextCell[y._idd]];
				A = C.conf.nextCell[A]
			}
			D.push(Math.max(0, y.getHeight() - y._getHdrHeight() - y._getMinHeight(A)));
			C = y = null
		}
		var E = Math.min.apply(window, D);
		return this.cont.offsetHeight - E
	};
	this.setSkin = function(a) {
		this._setBaseSkin(a);
		this.conf.skin = a
	};
	this.unload = function() {
		this.conf.unloading = true;
		this.mainInst = null;
		this.parentLayout = null;
		if (this.items != null) {
			for (var A = 0; A < this.items.length; A++) {
				this.items[A] = null
			}
			this.items = null
		}
		if (this.dhxWins != null) {
			this.dhxWins.unload();
			this.dhxWins = null
		}
		if (this.sep != null) {
			this.sep._unload();
			this.sep = null
		}
		for (var y in this.cdata) {
			this.cdata[y]._unload();
			this.cdata[y] = null
		}
		this._unloadTop();
		window.dhx4._eventable(this, "clear");
		for (var y in this) {
			this[y] = null
		}
		n = null
	};
	this._getWindowMinDimension = function(A) {
		var a = n._getAvailWidth() + 7 + 7;
		var y = n._getAvailHeight() + 7 + 31;
		var q = {
			w: Math.max(a, 200),
			h: Math.max(y, 140)
		};
		A = null;
		return q
	};
	window.dhx4._eventable(this);
	this._callMainEvent = function(q, a) {
		return this.callEvent(q, a)
	};
	this._init(r || "3E");
	var s = this._availAutoSize[r];
	if (s != null) {
		this.conf.pattern = r;
		this.setAutoSize(s.h[s.h.length - 1], s.v[s.v.length - 1])
	}
	if (typeof(window.dhtmlXWindows) == "function") {
		this.dhxWins = new dhtmlXWindows();
		this.dhxWins.setSkin(this.conf.skin)
	}
	this.conf.inited = true;
	if (this == this._getMainInst()) {
		var u = 0;
		this.items = [];
		this.forEachItem(function(a) {
			n.items.push(a);
			a.conf.index = u++
		})
	}
	if (this == this._getMainInst() && v != null) {
		if (v.autosize != null) {
			this.setAutoSize.apply(this, v.autosize)
		}
		if (v.cells != null) {
			for (var c = 0; c < v.cells.length; c++) {
				var l = v.cells[c];
				var w = this.cells(l.id);
				if (l.width) {
					w.setWidth(l.width)
				}
				if (l.height) {
					w.setHeight(l.height)
				}
				if (l.text) {
					w.setText(l.text)
				}
				if (l.collapsed_text) {
					w.setCollapsedText(l.collapsed_text)
				}
				if (l.collapse) {
					w.collapse()
				}
				if (l.fix_size) {
					w.fixSize(l.fix_size[0], l.fix_size[1])
				}
				if (typeof(l.header) != "undefined" && window.dhx4.s2b(l.header) == false) {
					w.hideHeader()
				}
			}
		}
	}
	v = null;
	return this
}
dhtmlXLayoutObject.prototype = new dhtmlXCellTop();
dhtmlXLayoutObject.prototype.cells = function(l) {
	for (var c in this.cdata) {
		if (this.cdata[c].conf.name == l) {
			return this.cdata[c]
		}
		if (this.cdata[c].dataType == "layout" && this.cdata[c].dataNested == true && this.cdata[c].dataObj != null) {
			var g = this.cdata[c].dataObj.cells(l);
			if (g != null) {
				return g
			}
		}
	}
	return null
};
dhtmlXLayoutObject.prototype.forEachItem = function(l, g) {
	if (typeof(l) != "function") {
		return
	}
	if (typeof(g) == "undefined") {
		g = this
	}
	for (var c in this.cdata) {
		if (typeof(this.cdata[c].conf.name) != "undefined") {
			l.apply(g, [this.cdata[c]])
		}
		if (this.cdata[c].dataType == "layout" && this.cdata[c].dataNested == true && this.cdata[c].dataObj != null) {
			this.cdata[c].dataObj.forEachItem(l, g)
		}
	}
	g = null
};
dhtmlXLayoutObject.prototype._forEachSep = function(l, g) {
	if (typeof(l) != "function") {
		return
	}
	if (typeof(g) == "undefined") {
		g = this
	}
	if (this.sep != null) {
		l.apply(g, [this.sep])
	}
	for (var c in this.cdata) {
		if (this.cdata[c].dataType == "layout" && this.cdata[c].dataNested == true && this.cdata[c].dataObj != null) {
			this.cdata[c].dataObj._forEachSep(l, g)
		}
	}
	g = null
};
dhtmlXLayoutObject.prototype._detectSW = function() {
	if (this._confGlob.sw == null) {
		this._confGlob.sw = {}
	}
	if (this._confGlob.sw[this.conf.skin] == null) {
		this._confGlob.sw[this.conf.skin] = window.dhx4.readFromCss("dhxlayout_sep_sw_" + this.conf.skin)
	}
	return this._confGlob.sw[this.conf.skin]
};
dhtmlXLayoutObject.prototype._confGlob = {};
dhtmlXLayoutObject.prototype.listPatterns = function() {
	var g = [];
	for (var c in this.tplData) {
		g.push(c)
	}
	return g
};
dhtmlXLayoutObject.prototype.listAutoSizes = function() {
	var l = (this.conf.as_cells != null ? (this.conf.as_cells.h).join(";") : "");
	var g = (this.conf.as_cells != null ? (this.conf.as_cells.v).join(";") : "");
	var c = this._availAutoSize[this.conf.pattern].h;
	var a = this._availAutoSize[this.conf.pattern].v;
	return [l, g, c, a]
};
dhtmlXLayoutObject.prototype._getCellsNames = function(l) {
	var m = {};
	if (this.cdata[l].conf.name != null) {
		m[this.cdata[l].conf.name] = true
	}
	if (this.cdata[l].dataType == "layout" && this.cdata[l].dataObj != null && this.cdata[l].dataObj.mainInst == this) {
		var c = this.cdata[l].dataObj._getCellsNames("a");
		var n = this.cdata[l].dataObj._getCellsNames("b");
		for (var g in c) {
			m[g] = c[g]
		}
		for (var g in n) {
			m[g] = n[g]
		}
	}
	return m
};
dhtmlXLayoutObject.prototype.setAutoSize = function(c, u, v) {
	if (v !== true) {
		var x = this.listAutoSizes();
		if (x[0] == c && x[1] == u) {
			return
		}
		var r = false;
		var o = false;
		for (var g = 0; g < x[2].length; g++) {
			r = r || x[2][g] == c
		}
		for (var g = 0; g < x[3].length; g++) {
			o = o || x[3][g] == u
		}
		if (!r || !o) {
			return
		}
	}
	this.conf.as_cells = {
		h: c.split(";"),
		v: u.split(";")
	};
	var l = (this.conf.mode == "v" ? "h" : "v");
	for (var w in this.cdata) {
		var n = this._getCellsNames(w);
		var y = false;
		for (var g = 0; g < this.conf.as_cells[l].length; g++) {
			y = y || n[this.conf.as_cells[l][g]]
		}
		if (y) {
			this.conf.autosize = w
		}
		if (this.cdata[w].dataType == "layout" && this.cdata[w].dataObj != null) {
			this.cdata[w].dataObj.setAutoSize(c, u, true)
		}
	}
};
dhtmlXLayoutObject.prototype.tplData = {
	"1C": {
		mode: "c",
		cells: {
			a: {
				name: "a"
			}
		}
	},
	"2E": {
		mode: "h",
		cells: {
			a: {
				name: "a",
				fsize: {
					v: 1
				}
			},
			b: {
				name: "b",
				fsize: {
					v: 1
				}
			}
		}
	},
	"2U": {
		mode: "v",
		cells: {
			a: {
				name: "a",
				fsize: {
					h: 1
				}
			},
			b: {
				name: "b",
				fsize: {
					h: 1
				}
			}
		}
	},
	"3E": {
		mode: "h",
		cells: {
			a: {
				name: "a",
				height: 1 / 3,
				fsize: {
					v: 1
				}
			},
			b: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "b",
							fsize: {
								v: [1, 2]
							}
						},
						b: {
							name: "c",
							fsize: {
								v: 2
							}
						}
					}
				}
			}
		}
	},
	"3W": {
		mode: "v",
		cells: {
			a: {
				name: "a",
				width: 1 / 3,
				fsize: {
					h: 1
				}
			},
			b: {
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "b",
							fsize: {
								h: [1, 2]
							}
						},
						b: {
							name: "c",
							fsize: {
								h: 2
							}
						}
					}
				}
			}
		}
	},
	"3J": {
		mode: "v",
		cells: {
			a: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "a",
							fsize: {
								h: 1,
								v: 2
							}
						},
						b: {
							name: "c",
							fsize: {
								h: 1,
								v: 2
							}
						}
					}
				}
			},
			b: {
				name: "b",
				fsize: {
					h: 1
				}
			}
		}
	},
	"3L": {
		mode: "v",
		cells: {
			a: {
				name: "a",
				fsize: {
					h: 1
				}
			},
			b: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "b",
							fsize: {
								h: 1,
								v: 2
							}
						},
						b: {
							name: "c",
							fsize: {
								h: 1,
								v: 2
							}
						}
					}
				}
			}
		}
	},
	"3T": {
		mode: "h",
		cells: {
			a: {
				name: "a",
				fsize: {
					v: 1
				}
			},
			b: {
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "b",
							fsize: {
								h: 2,
								v: 1
							}
						},
						b: {
							name: "c",
							fsize: {
								h: 2,
								v: 1
							}
						}
					}
				}
			}
		}
	},
	"3U": {
		mode: "h",
		cells: {
			a: {
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "a",
							fsize: {
								h: 2,
								v: 1
							}
						},
						b: {
							name: "b",
							fsize: {
								h: 2,
								v: 1
							}
						}
					}
				}
			},
			b: {
				name: "c",
				fsize: {
					v: 1
				}
			}
		}
	},
	"4H": {
		mode: "v",
		cells: {
			a: {
				name: "a",
				width: 1 / 3,
				fsize: {
					h: 1
				}
			},
			b: {
				layout: {
					mode: "v",
					cells: {
						a: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "b",
										fsize: {
											h: [1, 2],
											v: 3
										}
									},
									b: {
										name: "c",
										fsize: {
											h: [1, 2],
											v: 3
										}
									}
								}
							}
						},
						b: {
							name: "d",
							fsize: {
								h: 2
							}
						}
					}
				}
			}
		}
	},
	"4I": {
		mode: "h",
		cells: {
			a: {
				name: "a",
				height: 1 / 3,
				fsize: {
					v: 1
				}
			},
			b: {
				layout: {
					mode: "h",
					cells: {
						a: {
							layout: {
								mode: "v",
								cells: {
									a: {
										name: "b",
										fsize: {
											h: 3,
											v: [1, 2]
										}
									},
									b: {
										name: "c",
										fsize: {
											h: 3,
											v: [1, 2]
										}
									}
								}
							}
						},
						b: {
							name: "d",
							fsize: {
								v: 2
							}
						}
					}
				}
			}
		}
	},
	"4T": {
		mode: "h",
		cells: {
			a: {
				name: "a",
				fsize: {
					v: 1
				}
			},
			b: {
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "b",
							width: 1 / 3,
							fsize: {
								h: 2,
								v: 1
							}
						},
						b: {
							layout: {
								mode: "v",
								cells: {
									a: {
										name: "c",
										fsize: {
											h: [2, 3],
											v: 1
										}
									},
									b: {
										name: "d",
										fsize: {
											h: 3,
											v: 1
										}
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"4U": {
		mode: "h",
		cells: {
			a: {
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "a",
							width: 1 / 3,
							fsize: {
								h: 2,
								v: 1
							}
						},
						b: {
							layout: {
								mode: "v",
								cells: {
									a: {
										name: "b",
										fsize: {
											h: [2, 3],
											v: 1
										}
									},
									b: {
										name: "c",
										fsize: {
											h: 3,
											v: 1
										}
									}
								}
							}
						}
					}
				}
			},
			b: {
				name: "d",
				fsize: {
					v: 1
				}
			}
		}
	},
	"4E": {
		mode: "h",
		cells: {
			a: {
				name: "a",
				height: 1 / 4,
				fsize: {
					v: 1
				}
			},
			b: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "b",
							height: 1 / 3,
							fsize: {
								v: [1, 2]
							}
						},
						b: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "c",
										fsize: {
											v: [2, 3]
										}
									},
									b: {
										name: "d",
										fsize: {
											v: 3
										}
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"4W": {
		mode: "v",
		cells: {
			a: {
				name: "a",
				width: 1 / 4,
				fsize: {
					h: 1
				}
			},
			b: {
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "b",
							width: 1 / 3,
							fsize: {
								h: [1, 2]
							}
						},
						b: {
							layout: {
								mode: "v",
								cells: {
									a: {
										name: "c",
										fsize: {
											h: [2, 3]
										}
									},
									b: {
										name: "d",
										fsize: {
											h: 3
										}
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"4A": {
		mode: "v",
		cells: {
			a: {
				width: 1 / 3,
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "a",
							fsize: {
								h: 1,
								v: 2
							}
						},
						b: {
							name: "b",
							fsize: {
								h: 1,
								v: 2
							}
						}
					}
				}
			},
			b: {
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "c",
							fsize: {
								h: [1, 3]
							}
						},
						b: {
							name: "d",
							fsize: {
								h: 3
							}
						}
					}
				}
			}
		}
	},
	"4L": {
		mode: "v",
		cells: {
			a: {
				name: "a",
				width: 1 / 3,
				fsize: {
					h: 1
				}
			},
			b: {
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "b",
							fsize: {
								h: [1, 2]
							}
						},
						b: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "c",
										fsize: {
											h: 2,
											v: 3
										}
									},
									b: {
										name: "d",
										fsize: {
											h: 2,
											v: 3
										}
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"4J": {
		mode: "h",
		cells: {
			a: {
				name: "a",
				height: 1 / 3,
				fsize: {
					v: 1
				}
			},
			b: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "b",
							fsize: {
								v: [1, 2]
							}
						},
						b: {
							layout: {
								mode: "v",
								cells: {
									a: {
										name: "c",
										fsize: {
											h: 3,
											v: 2
										}
									},
									b: {
										name: "d",
										fsize: {
											h: 3,
											v: 2
										}
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"4F": {
		mode: "h",
		cells: {
			a: {
				height: 1 / 3,
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "a",
							fsize: {
								h: 2,
								v: 1
							}
						},
						b: {
							name: "b",
							fsize: {
								h: 2,
								v: 1
							}
						}
					}
				}
			},
			b: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "c",
							fsize: {
								v: [1, 3]
							}
						},
						b: {
							name: "d",
							fsize: {
								v: 3
							}
						}
					}
				}
			}
		}
	},
	"4G": {
		mode: "v",
		cells: {
			a: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "a",
							height: 1 / 3,
							fsize: {
								h: 1,
								v: 2
							}
						},
						b: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "b",
										fsize: {
											h: 1,
											v: [2, 3]
										}
									},
									b: {
										name: "c",
										fsize: {
											h: 1,
											v: 3
										}
									}
								}
							}
						}
					}
				}
			},
			b: {
				name: "d",
				fsize: {
					h: 1
				}
			}
		}
	},
	"4C": {
		mode: "v",
		cells: {
			a: {
				name: "a",
				fsize: {
					h: 1
				}
			},
			b: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "b",
							height: 1 / 3,
							fsize: {
								h: 1,
								v: 2
							}
						},
						b: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "c",
										fsize: {
											h: 1,
											v: [2, 3]
										}
									},
									b: {
										name: "d",
										fsize: {
											h: 1,
											v: 3
										}
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"5H": {
		mode: "v",
		cells: {
			a: {
				width: 1 / 3,
				name: "a",
				fsize: {
					h: 1
				}
			},
			b: {
				layout: {
					mode: "v",
					cells: {
						a: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "b",
										height: 1 / 3,
										fsize: {
											h: [1, 2],
											v: 3
										}
									},
									b: {
										layout: {
											mode: "h",
											cells: {
												a: {
													name: "c",
													fsize: {
														h: [1, 2],
														v: [3, 4]
													}
												},
												b: {
													name: "d",
													fsize: {
														h: [1, 2],
														v: 4
													}
												}
											}
										}
									}
								}
							}
						},
						b: {
							name: "e",
							fsize: {
								h: 2
							}
						}
					}
				}
			}
		}
	},
	"5I": {
		mode: "h",
		cells: {
			a: {
				height: 1 / 3,
				name: "a",
				fsize: {
					v: 1
				}
			},
			b: {
				layout: {
					mode: "h",
					cells: {
						a: {
							layout: {
								mode: "v",
								cells: {
									a: {
										name: "b",
										width: 1 / 3,
										fsize: {
											h: 3,
											v: [1, 2]
										}
									},
									b: {
										layout: {
											mode: "v",
											cells: {
												a: {
													name: "c",
													fsize: {
														h: [3, 4],
														v: [1, 2]
													}
												},
												b: {
													name: "d",
													fsize: {
														h: 4,
														v: [1, 2]
													}
												}
											}
										}
									}
								}
							}
						},
						b: {
							name: "e",
							fsize: {
								v: 2
							}
						}
					}
				}
			}
		}
	},
	"5U": {
		mode: "h",
		cells: {
			a: {
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "a",
							width: 1 / 4,
							fsize: {
								h: 2,
								v: 1
							}
						},
						b: {
							layout: {
								mode: "v",
								cells: {
									a: {
										name: "b",
										width: 1 / 3,
										fsize: {
											h: [2, 3],
											v: 1
										}
									},
									b: {
										layout: {
											mode: "v",
											cells: {
												a: {
													name: "c",
													fsize: {
														h: [3, 4],
														v: 1
													}
												},
												b: {
													name: "d",
													fsize: {
														h: 4,
														v: 1
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			},
			b: {
				name: "e",
				fsize: {
					v: 1
				}
			}
		}
	},
	"5E": {
		mode: "h",
		cells: {
			a: {
				name: "a",
				height: 1 / 5,
				fsize: {
					v: 1
				}
			},
			b: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "b",
							height: 1 / 4,
							fsize: {
								v: [1, 2]
							}
						},
						b: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "c",
										height: 1 / 3,
										fsize: {
											v: [2, 3]
										}
									},
									b: {
										layout: {
											mode: "h",
											cells: {
												a: {
													name: "d",
													fsize: {
														v: [3, 4]
													}
												},
												b: {
													name: "e",
													fsize: {
														v: 4
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"5W": {
		mode: "v",
		cells: {
			a: {
				name: "a",
				width: 1 / 5,
				fsize: {
					h: 1
				}
			},
			b: {
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "b",
							width: 1 / 4,
							fsize: {
								h: [1, 2]
							}
						},
						b: {
							layout: {
								mode: "v",
								cells: {
									a: {
										name: "c",
										width: 1 / 3,
										fsize: {
											h: [2, 3]
										}
									},
									b: {
										layout: {
											mode: "v",
											cells: {
												a: {
													name: "d",
													fsize: {
														h: [3, 4]
													}
												},
												b: {
													name: "e",
													fsize: {
														h: 4
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"5K": {
		mode: "v",
		cells: {
			a: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "a",
							height: 1 / 3,
							fsize: {
								h: 1,
								v: 2
							}
						},
						b: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "b",
										fsize: {
											h: 1,
											v: [2, 3]
										}
									},
									b: {
										name: "c",
										fsize: {
											h: 1,
											v: 3
										}
									}
								}
							}
						}
					}
				}
			},
			b: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "d",
							fsize: {
								h: 1,
								v: 4
							}
						},
						b: {
							name: "e",
							fsize: {
								h: 1,
								v: 4
							}
						}
					}
				}
			}
		}
	},
	"5S": {
		mode: "v",
		cells: {
			a: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "a",
							fsize: {
								h: 1,
								v: 2
							}
						},
						b: {
							name: "b",
							fsize: {
								h: 1,
								v: 2
							}
						}
					}
				}
			},
			b: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "c",
							height: 1 / 3,
							fsize: {
								h: 1,
								v: 3
							}
						},
						b: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "d",
										fsize: {
											h: 1,
											v: [3, 2]
										}
									},
									b: {
										name: "e",
										fsize: {
											h: 1,
											v: 4
										}
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"5G": {
		mode: "v",
		cells: {
			a: {
				width: 1 / 3,
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "a",
							height: 1 / 3,
							fsize: {
								h: 1,
								v: 2
							}
						},
						b: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "b",
										fsize: {
											h: 1,
											v: [2, 3]
										}
									},
									b: {
										name: "c",
										fsize: {
											h: 1,
											v: 3
										}
									}
								}
							}
						}
					}
				}
			},
			b: {
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "d",
							fsize: {
								h: [1, 4]
							}
						},
						b: {
							name: "e",
							fsize: {
								h: 4
							}
						}
					}
				}
			}
		}
	},
	"5C": {
		mode: "v",
		cells: {
			a: {
				width: 2 / 3,
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "a",
							fsize: {
								h: 2
							}
						},
						b: {
							name: "b",
							fsize: {
								h: [2, 1]
							}
						}
					}
				}
			},
			b: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "c",
							height: 1 / 3,
							fsize: {
								h: 1,
								v: 3
							}
						},
						b: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "d",
										fsize: {
											h: 1,
											v: [3, 4]
										}
									},
									b: {
										name: "e",
										fsize: {
											h: 1,
											v: 4
										}
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"6H": {
		mode: "v",
		cells: {
			a: {
				width: 1 / 3,
				name: "a",
				fsize: {
					h: 1
				}
			},
			b: {
				layout: {
					mode: "v",
					cells: {
						a: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "b",
										height: 1 / 4,
										fsize: {
											h: [1, 2],
											v: 3
										}
									},
									b: {
										layout: {
											mode: "h",
											cells: {
												a: {
													name: "c",
													height: 1 / 3,
													fsize: {
														h: [1, 2],
														v: [3, 4]
													}
												},
												b: {
													layout: {
														mode: "h",
														cells: {
															a: {
																name: "d",
																fsize: {
																	h: [1, 2],
																	v: [4, 5]
																}
															},
															b: {
																name: "e",
																fsize: {
																	h: [1, 2],
																	v: 5
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						},
						b: {
							name: "f",
							fsize: {
								h: 2
							}
						}
					}
				}
			}
		}
	},
	"6I": {
		mode: "h",
		cells: {
			a: {
				height: 1 / 3,
				name: "a",
				fsize: {
					v: 1
				}
			},
			b: {
				layout: {
					mode: "h",
					cells: {
						a: {
							layout: {
								mode: "v",
								cells: {
									a: {
										name: "b",
										width: 1 / 4,
										fsize: {
											h: 3,
											v: [1, 2]
										}
									},
									b: {
										layout: {
											mode: "v",
											cells: {
												a: {
													name: "c",
													width: 1 / 3,
													fsize: {
														h: [3, 4],
														v: [1, 2]
													}
												},
												b: {
													layout: {
														mode: "v",
														cells: {
															a: {
																name: "d",
																fsize: {
																	h: [4, 5],
																	v: [1, 2]
																}
															},
															b: {
																name: "e",
																fsize: {
																	h: 5,
																	v: [1, 2]
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						},
						b: {
							name: "f",
							fsize: {
								v: 2
							}
						}
					}
				}
			}
		}
	},
	"6A": {
		mode: "v",
		cells: {
			a: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "a",
							height: 1 / 5,
							fsize: {
								h: 1,
								v: 2
							}
						},
						b: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "b",
										height: 1 / 4,
										fsize: {
											h: 1,
											v: [2, 3]
										}
									},
									b: {
										layout: {
											mode: "h",
											cells: {
												a: {
													name: "c",
													height: 1 / 3,
													fsize: {
														h: 1,
														v: [3, 4]
													}
												},
												b: {
													layout: {
														mode: "h",
														cells: {
															a: {
																name: "d",
																fsize: {
																	h: 1,
																	v: [4, 5]
																}
															},
															b: {
																name: "e",
																fsize: {
																	h: 1,
																	v: 5
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			},
			b: {
				name: "f",
				fsize: {
					h: 1
				}
			}
		}
	},
	"6C": {
		mode: "v",
		cells: {
			a: {
				name: "a",
				fsize: {
					h: 1
				}
			},
			b: {
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "b",
							height: 1 / 5,
							fsize: {
								h: 1,
								v: 2
							}
						},
						b: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "c",
										height: 1 / 4,
										fsize: {
											h: 1,
											v: [2, 3]
										}
									},
									b: {
										layout: {
											mode: "h",
											cells: {
												a: {
													name: "d",
													height: 1 / 3,
													fsize: {
														h: 1,
														v: [3, 4]
													}
												},
												b: {
													layout: {
														mode: "h",
														cells: {
															a: {
																name: "e",
																fsize: {
																	h: 1,
																	v: [4, 5]
																}
															},
															b: {
																name: "f",
																fsize: {
																	h: 1,
																	v: 5
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"6J": {
		mode: "v",
		cells: {
			a: {
				width: 1 / 3,
				layout: {
					mode: "h",
					cells: {
						a: {
							name: "a",
							height: 1 / 4,
							fsize: {
								h: 1,
								v: 2
							}
						},
						b: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "b",
										height: 1 / 3,
										fsize: {
											h: 1,
											v: [2, 3]
										}
									},
									b: {
										layout: {
											mode: "h",
											cells: {
												a: {
													name: "c",
													fsize: {
														h: 1,
														v: [3, 4]
													}
												},
												b: {
													name: "d",
													fsize: {
														h: 1,
														v: 4
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			},
			b: {
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "e",
							fsize: {
								h: [1, 5]
							}
						},
						b: {
							name: "f",
							fsize: {
								h: 5
							}
						}
					}
				}
			}
		}
	},
	"6E": {
		mode: "v",
		cells: {
			a: {
				name: "a",
				width: 1 / 3,
				fsize: {
					h: 1
				}
			},
			b: {
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "b",
							fsize: {
								h: [1, 2]
							}
						},
						b: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "c",
										height: 1 / 4,
										fsize: {
											h: 2,
											v: 3
										}
									},
									b: {
										layout: {
											mode: "h",
											cells: {
												a: {
													name: "d",
													height: 1 / 3,
													fsize: {
														h: 2,
														v: [3, 4]
													}
												},
												b: {
													layout: {
														mode: "h",
														cells: {
															a: {
																name: "e",
																fsize: {
																	h: 2,
																	v: [4, 5]
																}
															},
															b: {
																name: "f",
																fsize: {
																	h: 2,
																	v: 5
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"6W": {
		mode: "v",
		cells: {
			a: {
				name: "a",
				width: 1 / 6,
				fsize: {
					h: 1
				}
			},
			b: {
				layout: {
					mode: "v",
					cells: {
						a: {
							name: "b",
							width: 1 / 5,
							fsize: {
								h: [1, 2]
							}
						},
						b: {
							layout: {
								mode: "v",
								cells: {
									a: {
										name: "c",
										width: 1 / 4,
										fsize: {
											h: [2, 3]
										}
									},
									b: {
										layout: {
											mode: "v",
											cells: {
												a: {
													name: "d",
													width: 1 / 3,
													fsize: {
														h: [3, 4]
													}
												},
												b: {
													layout: {
														mode: "v",
														cells: {
															a: {
																name: "e",
																fsize: {
																	h: [4, 5]
																}
															},
															b: {
																name: "f",
																fsize: {
																	h: 5
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"7H": {
		mode: "v",
		cells: {
			a: {
				name: "a",
				width: 1 / 3,
				fsize: {
					h: 1
				}
			},
			b: {
				layout: {
					mode: "v",
					cells: {
						a: {
							layout: {
								mode: "h",
								cells: {
									a: {
										name: "b",
										height: 1 / 5,
										fsize: {
											h: [1, 2],
											v: 3
										}
									},
									b: {
										layout: {
											mode: "h",
											cells: {
												a: {
													name: "c",
													height: 1 / 4,
													fsize: {
														h: [1, 2],
														v: [3, 4]
													}
												},
												b: {
													layout: {
														mode: "h",
														cells: {
															a: {
																name: "d",
																height: 1 / 3,
																fsize: {
																	h: [1, 2],
																	v: [4, 5]
																}
															},
															b: {
																layout: {
																	mode: "h",
																	cells: {
																		a: {
																			name: "e",
																			fsize: {
																				h: [1, 2],
																				v: [5, 6]
																			}
																		},
																		b: {
																			name: "f",
																			fsize: {
																				h: [1, 2],
																				v: 6
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						},
						b: {
							name: "g",
							fsize: {
								h: 2
							}
						}
					}
				}
			}
		}
	},
	"7I": {
		mode: "h",
		cells: {
			a: {
				name: "a",
				height: 1 / 3,
				fsize: {
					v: 1
				}
			},
			b: {
				layout: {
					mode: "h",
					cells: {
						a: {
							layout: {
								mode: "v",
								cells: {
									a: {
										name: "b",
										width: 1 / 5,
										fsize: {
											h: 3,
											v: [1, 2]
										}
									},
									b: {
										layout: {
											mode: "v",
											cells: {
												a: {
													name: "c",
													width: 1 / 4,
													fsize: {
														h: [3, 4],
														v: [1, 2]
													}
												},
												b: {
													layout: {
														mode: "v",
														cells: {
															a: {
																name: "d",
																width: 1 / 3,
																fsize: {
																	h: [4, 5],
																	v: [1, 2]
																}
															},
															b: {
																layout: {
																	mode: "v",
																	cells: {
																		a: {
																			name: "e",
																			fsize: {
																				h: [5, 6],
																				v: [1, 2]
																			}
																		},
																		b: {
																			name: "f",
																			fsize: {
																				h: 6,
																				v: [1, 2]
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						},
						b: {
							name: "g",
							fsize: {
								v: 2
							}
						}
					}
				}
			}
		}
	}
};
dhtmlXLayoutObject.prototype._availAutoSize = {
	"1C": {
		h: ["a"],
		v: ["a"]
	},
	"2E": {
		h: ["a;b"],
		v: ["a", "b"]
	},
	"2U": {
		h: ["a", "b"],
		v: ["a;b"]
	},
	"3E": {
		h: ["a;b;c"],
		v: ["a", "b", "c"]
	},
	"3W": {
		h: ["a", "b", "c"],
		v: ["a;b;c"]
	},
	"3J": {
		h: ["a;c", "b"],
		v: ["a;b", "b;c"]
	},
	"3L": {
		h: ["a", "b;c"],
		v: ["a;b", "a;c"]
	},
	"3T": {
		h: ["a;b", "a;c"],
		v: ["a", "b;c"]
	},
	"3U": {
		h: ["a;c", "b;c"],
		v: ["a;b", "c"]
	},
	"4H": {
		h: ["a", "b;c", "d"],
		v: ["a;b;d", "a;c;d"]
	},
	"4I": {
		h: ["a;b;d", "a;c;d"],
		v: ["a", "b;c", "d"]
	},
	"4T": {
		h: ["a;b", "a;c", "a;d"],
		v: ["a", "b;c;d"]
	},
	"4U": {
		h: ["a;d", "b;d", "c;d"],
		v: ["a;b;c", "d"]
	},
	"4E": {
		h: ["a;b;c;d"],
		v: ["a", "b", "c", "d"]
	},
	"4W": {
		h: ["a", "b", "c", "d"],
		v: ["a;b;c;d"]
	},
	"4A": {
		h: ["a;b", "c", "d"],
		v: ["a;c;d", "b;c;d"]
	},
	"4L": {
		h: ["a", "b", "c;d"],
		v: ["a;b;c", "a;b;d"]
	},
	"4J": {
		h: ["a;b;c", "a;b;d"],
		v: ["a", "b", "c;d"]
	},
	"4F": {
		h: ["a;c;d", "b;c;d"],
		v: ["a;b", "c", "d"]
	},
	"4G": {
		h: ["a;b;c", "d"],
		v: ["a;d", "b;d", "c;d"]
	},
	"4C": {
		h: ["a", "b;c;d"],
		v: ["a;b", "a;c", "a;d"]
	},
	"5H": {
		h: ["a", "b;c;d", "e"],
		v: ["a;b;e", "a;c;e", "a;d;e"]
	},
	"5I": {
		h: ["a;b;e", "a;c;e", "a;d;e"],
		v: ["a", "b;c;d", "e"]
	},
	"5U": {
		h: ["a;e", "b;e", "c;e", "d;e"],
		v: ["a;b;c;d", "e"]
	},
	"5E": {
		h: ["a;b;c;d;e"],
		v: ["a", "b", "c", "d", "e"]
	},
	"5W": {
		h: ["a", "b", "c", "d", "e"],
		v: ["a;b;c;d;e"]
	},
	"5K": {
		h: ["a;b;c", "d;e"],
		v: ["a;d", "b;d", "c;d", "a;e", "b;e", "c;e"]
	},
	"5S": {
		h: ["a;b", "c;d;e"],
		v: ["a;c", "a;d", "a;e", "b;c", "b;d", "b;e"]
	},
	"5G": {
		h: ["a;b;c", "d", "e"],
		v: ["a;d;e", "b;d;e", "c;d;e"]
	},
	"5C": {
		h: ["a", "b", "c;d;e"],
		v: ["a;b;c", "a;b;d", "a;b;e"]
	},
	"6H": {
		h: ["a", "b;c;d;e", "f"],
		v: ["a;b;f", "a;c;f", "a;d;f", "a;e;f"]
	},
	"6I": {
		h: ["a;b;f", "a;c;f", "a;d;f", "a;e;f"],
		v: ["a", "b;c;d;e", "f"]
	},
	"6A": {
		h: ["a;b;c;d;e", "f"],
		v: ["a;f", "b;f", "c;f", "d;f", "e;f"]
	},
	"6C": {
		h: ["a", "b;c;d;e;f"],
		v: ["a;b", "a;c", "a;d", "a;e", "a;f"]
	},
	"6J": {
		h: ["a;b;c;d", "e", "f"],
		v: ["a;e;f", "b;e;f", "c;e;f", "d;e;f"]
	},
	"6E": {
		h: ["a", "b", "c;d;e;f"],
		v: ["a;b;c", "a;b;d", "a;b;e", "a;b;f"]
	},
	"6W": {
		h: ["a", "b", "c", "d", "e", "f"],
		v: ["a;b;c;d;e;f"]
	},
	"7H": {
		h: ["a", "b;c;d;e;f", "g"],
		v: ["a;b;g", "a;c;g", "a;d;g", "a;e;g", "a;f;g"]
	},
	"7I": {
		h: ["a;b;g", "a;c;g", "a;d;g", "a;e;g", "a;f;g"],
		v: ["a", "b;c;d;e;f", "g"]
	}
};

function dhtmlXLayoutSepObject(g, a) {
	var c = this;
	this.conf = {
		mode: g,
		idx: a,
		blocked: false,
		locked: false,
		btn_left: ((window.dhx4.isIE6 || window.dhx4.isIE7 || window.dhx4.isIE8) && typeof(window.addEventListener) == "undefined" ? 1 : 0)
	};
	if (window.dhx4.isIE && navigator.userAgent.indexOf("MSIE 7.0") >= 0 && navigator.userAgent.indexOf("Trident") >= 0) {
		this.conf.btn_left = 1
	}
	this.sep = document.createElement("DIV");
	this.sep.className = "dhxlayout_sep";
	if (window.dhx4.isIE == true) {
		this.sep.onselectstart = function() {
			return false
		}
	}
	this.sep.className = "dhxlayout_sep dhxlayout_sep_resize_" + this.conf.mode;
	this._setSize = function(l, o, m, n) {
		this.sep.style.left = l + "px";
		this.sep.style.top = o + "px";
		this.sep.style.width = Math.max(m, 0) + "px";
		this.sep.style.height = Math.max(n, 0) + "px"
	};
	this._lockSep = function(l) {
		this.conf.locked = (l == true);
		this._blockSep()
	};
	this._setWH = function(l) {
		var m = this._getLayout();
		m.conf.sw = (l == null ? m._detectSW() : Math.max(parseInt(l) || -1, -1));
		m._getMainInst().setSizes();
		m = null
	};
	this._blockSep = function() {
		var l = this._getLayout();
		var m = l.cdata.a.conf.collapsed || l.cdata.b.conf.collapsed || this.conf.locked;
		l = null;
		if (this.conf.blocked == m) {
			return
		}
		this.sep.className = "dhxlayout_sep" + (m ? "" : " dhxlayout_sep_resize_" + this.conf.mode);
		this.conf.blocked = m
	};
	this._beforeResize = function(m) {
		if (this.conf.blocked) {
			return
		}
		if (this.conf.resize != null && this.conf.resize.active == true) {
			return
		}
		if (m.type == "touchstart") {
			this.sep.className += " dhxlayout_sep_resize_actv";
			var o = (m.pageX || m.touches[0].pageX);
			var n = (m.pageY || m.touches[0].pageY)
		} else {
			if (m.button !== this.conf.btn_left) {
				return
			}
			var o = m.clientX;
			var n = m.clientY
		}
		var l = this._getLayout();
		this.conf.resize = {
			sx: o,
			sy: n,
			tx: m.layerX,
			ty: m.layerY,
			sep_x: parseInt(this.sep.style.left),
			sep_y: parseInt(this.sep.style.top),
			min_wa: l.cdata.a._getAvailWidth("a"),
			min_wb: l.cdata.b._getAvailWidth("b"),
			min_ha: l.cdata.a._getAvailHeight("a"),
			min_hb: l.cdata.b._getAvailHeight("b")
		};
		this.conf.resize.nx = this.conf.resize.sep_x;
		this.conf.resize.ny = this.conf.resize.sep_y;
		if (typeof(window.addEventListener) == "function") {
			window.addEventListener("mousemove", this._doOnMouseMove, false);
			window.addEventListener("mouseup", this._doOnMouseUp, false);
			window.addEventListener("touchmove", this._doOnMouseMove, false);
			window.addEventListener("touchend", this._doOnMouseUp, false)
		} else {
			document.body.attachEvent("onmousemove", this._doOnMouseMove);
			document.body.attachEvent("onmouseup", this._doOnMouseUp)
		}
		l = null
	};
	this._onResize = function(n) {
		if (!this.conf.resize.active) {
			this._initResizeArea();
			this.conf.resize.active = true
		}
		if (this.conf.mode == "v") {
			var l = (n.type == "mousemove" ? n.clientX : (n.pageX || n.touches[0].pageX));
			var m = this.conf.resize.sx - l;
			this.conf.resize.nx = this.conf.resize.sep_x - m;
			if (this.conf.resize.nx > this.conf.resize.sep_x + this.conf.resize.min_wb) {
				this.conf.resize.nx = this.conf.resize.sep_x + this.conf.resize.min_wb
			} else {
				if (this.conf.resize.nx < this.conf.resize.sep_x - this.conf.resize.min_wa) {
					this.conf.resize.nx = this.conf.resize.sep_x - this.conf.resize.min_wa
				}
			}
			this.r_sep.style.left = this.conf.resize.nx + "px"
		} else {
			var o = (n.type == "mousemove" ? n.clientY : (n.pageY || n.touches[0].pageY));
			var m = this.conf.resize.sy - o;
			this.conf.resize.ny = this.conf.resize.sep_y - m;
			if (this.conf.resize.ny > this.conf.resize.sep_y + this.conf.resize.min_hb) {
				this.conf.resize.ny = this.conf.resize.sep_y + this.conf.resize.min_hb
			} else {
				if (this.conf.resize.ny < this.conf.resize.sep_y - this.conf.resize.min_ha) {
					this.conf.resize.ny = this.conf.resize.sep_y - this.conf.resize.min_ha
				}
			}
			this.r_sep.style.top = this.conf.resize.ny + "px"
		}
	};
	this._afterResize = function(s) {
		if (typeof(window.addEventListener) == "function") {
			window.removeEventListener("mousemove", this._doOnMouseMove, false);
			window.removeEventListener("mouseup", this._doOnMouseUp, false);
			window.removeEventListener("touchmove", this._doOnMouseMove, false);
			window.removeEventListener("touchend", this._doOnMouseUp, false)
		} else {
			document.body.detachEvent("onmousemove", this._doOnMouseMove);
			document.body.detachEvent("onmouseup", this._doOnMouseUp)
		}
		if (!this.conf.resize.active) {
			this.conf.resize = null;
			return
		}
		if (s.type == "touchend") {
			this.sep.className = this.sep.className.replace(/\s{0,}dhxlayout_sep_resize_actv/gi, "")
		} else {
			if (s.button !== this.conf.btn_left) {
				return
			}
		}
		var o = this._getLayout();
		var m = o._getMainInst();
		var q = (m.checkEvent("onPanelResizeFinish") == true ? {} : false);
		if (q !== false) {
			m.forEachItem(function(v) {
				q[v.conf.name] = {
					w: v.conf.size.w,
					h: v.conf.size.h
				};
				v = null
			})
		}
		var n = this.conf.resize.nx - this.conf.resize.sep_x;
		var l = this.conf.resize.ny - this.conf.resize.sep_y;
		o.cdata.a._setSize(o.cdata.a.conf.size.x, o.cdata.a.conf.size.y, o.cdata.a.conf.size.w + n, o.cdata.a.conf.size.h + l, "a");
		o.cdata.b._setSize(o.cdata.b.conf.size.x + n, o.cdata.b.conf.size.y + l, o.cdata.b.conf.size.w - n, o.cdata.b.conf.size.h - l, "b");
		this._setSize(parseInt(this.r_sep.style.left), parseInt(this.r_sep.style.top), parseInt(this.r_sep.style.width), parseInt(this.r_sep.style.height));
		if (window.dhx4.isIE) {
			var u = this;
			window.setTimeout(function() {
				u._removeResizeArea();
				u = null
			}, 1)
		} else {
			this._removeResizeArea()
		}
		if (q !== false) {
			var r = [];
			m.forEachItem(function(v) {
				var w = q[v.conf.name];
				if (!(w.w == v.conf.size.w && w.h == v.conf.size.h)) {
					r.push(v.conf.name)
				}
				v = null
			});
			m._callMainEvent("onPanelResizeFinish", [r])
		}
		m = o = null;
		this.conf.resize.active = false;
		this.conf.resize = null
	};
	this._initResizeArea = function() {
		if (this.r_sep == null) {
			this.r_sep = document.createElement("DIV");
			this.r_sep.className = "dhxlayout_resize_sep";
			this.r_sep.style.left = this.sep.style.left;
			this.r_sep.style.top = this.sep.style.top;
			this.r_sep.style.width = this.sep.style.width;
			this.r_sep.style.height = this.sep.style.height;
			this.sep.parentNode.appendChild(this.r_sep);
			if (window.dhx4.isIE) {
				this.r_sep.onselectstart = function() {
					return false
				}
			}
		}
		if (this.r_area == null) {
			this.r_area = document.createElement("DIV");
			this.r_area.className = "dhxlayout_resize_area";
			this.sep.parentNode.appendChild(this.r_area);
			if (window.dhx4.isIE) {
				this.r_area.onselectstart = function() {
					return false
				}
			}
			if (this.conf.mode == "v") {
				var l = parseInt(this.r_sep.style.left) - this.conf.resize.min_wa;
				var o = parseInt(this.r_sep.style.top);
				var m = this.conf.resize.min_wa + this.conf.resize.min_wb + parseInt(this.r_sep.style.width);
				var n = parseInt(this.r_sep.style.height)
			} else {
				var l = parseInt(this.r_sep.style.left);
				var o = parseInt(this.r_sep.style.top) - this.conf.resize.min_ha;
				var m = parseInt(this.r_sep.style.width);
				var n = this.conf.resize.min_ha + this.conf.resize.min_hb + parseInt(this.r_sep.style.height)
			}
			this.r_area.style.left = l + "px";
			this.r_area.style.top = o + "px";
			if (!dhtmlXLayoutObject.prototype._confGlob.reszieCover) {
				dhtmlXLayoutObject.prototype._confGlob.reszieCover = {};
				this.r_area.style.width = m + "px";
				this.r_area.style.height = n + "px";
				dhtmlXLayoutObject.prototype._confGlob.reszieCover.w = parseInt(this.r_area.style.width) - this.r_area.offsetWidth;
				dhtmlXLayoutObject.prototype._confGlob.reszieCover.h = parseInt(this.r_area.style.height) - this.r_area.offsetHeight
			}
			this.r_area.style.width = m + dhtmlXLayoutObject.prototype._confGlob.reszieCover.w + "px";
			this.r_area.style.height = n + dhtmlXLayoutObject.prototype._confGlob.reszieCover.h + "px"
		}
		document.body.className += " dhxlayout_resize_" + this.conf.mode
	};
	this._removeResizeArea = function() {
		this.r_sep.onselectstart = null;
		this.r_sep.parentNode.removeChild(this.r_sep);
		this.r_sep = null;
		this.r_area.onselectstart = null;
		this.r_area.parentNode.removeChild(this.r_area);
		this.r_area = null;
		document.body.className = String(document.body.className).replace(/\s{0,}dhxlayout_resize_[vh]/gi, "")
	};
	this._doOnMouseDown = function(l) {
		l = l || event;
		if (l.preventDefault) {
			l.preventDefault()
		} else {
			l.cancelBubble = true
		}
		c._beforeResize(l)
	};
	this._doOnMouseMove = function(l) {
		l = l || event;
		if (l.preventDefault) {
			l.preventDefault()
		} else {
			l.cancelBubble = true
		}
		c._onResize(l)
	};
	this._doOnMouseUp = function(l) {
		l = l || event;
		c._afterResize(l)
	};
	if (typeof(window.addEventListener) == "function") {
		this.sep.addEventListener("mousedown", this._doOnMouseDown, false);
		this.sep.addEventListener("touchstart", this._doOnMouseDown, false)
	} else {
		this.sep.attachEvent("onmousedown", this._doOnMouseDown)
	}
	this._unload = function() {
		if (typeof(window.addEventListener) == "function") {
			this.sep.removeEventListener("mousedown", this._doOnMouseDown, false);
			this.sep.removeEventListener("touchstart", this._doOnMouseDown, false)
		} else {
			this.sep.detachEvent("onmousedown", this._doOnMouseDown)
		}
		if (window.dhx4.isIE == true) {
			this.sep.onselectstart = null
		}
		this.sep.parentNode.removeChild(this.sep);
		this.sep = null;
		for (var l in this) {
			this[l] = null
		}
		c = null
	};
	return this
}
dhtmlXLayoutObject.prototype.setSeparatorSize = function(g, l) {
	if (typeof(g) == "number") {
		var m = this.setSeparatorSize({
			index: g,
			current: -1
		}, l);
		if (m.sep != null) {
			m.sep._setWH(l)
		}
		return
	}
	for (var c in this.cdata) {
		if (this.cdata[c].dataType == "layout" && this.cdata[c].dataNested == true && this.cdata[c].dataObj != null) {
			g = this.cdata[c].dataObj.setSeparatorSize(g, l);
			if (g.sep != null) {
				return g
			}
		}
		if (c == "a" && this.sep != null) {
			g.current++;
			if (g.index == g.current) {
				return {
					sep: this.sep
				}
			}
		}
	}
	return g
};
window.dhtmlXLayoutCell = function(l, g) {
	dhtmlXCellObject.apply(this, [l, "_layout"]);
	var c = this;
	this.layout = g;
	this.conf.skin = this.layout.conf.skin;
	this.conf.mode = this.layout.conf.mode;
	this.conf.collapsed = false;
	this.conf.fixed = {
		w: false,
		h: false
	};
	this.conf.docked = true;
	this.conf.min_width = 26;
	this.conf.min_height = 26;
	this.attachEvent("_onCellUnload", function() {
		this.cell.childNodes[this.conf.idx.hdr].ondblclick = null;
		if (this.conf.mode != "c") {
			this.cell.childNodes[this.conf.idx.hdr].lastChild.ondblclick = null
		}
		this._unloadDocking();
		this.layout = null;
		c = null
	});
	this._hdrInit();
	this.cell.childNodes[this.conf.idx.hdr].ondblclick = function() {
		var m = c.layout._getMainInst();
		m._callMainEvent("onDblClick", [c.conf.name]);
		m = null
	};
	this.attachEvent("_onContentLoaded", function() {
		var m = this.layout._getMainInst();
		m._callMainEvent("onContentLoaded", [this.conf.name]);
		m = null
	});
	if (this.conf.mode != "c") {
		var a = document.createElement("DIV");
		a.className = "dhxlayout_arrow dhxlayout_arrow_" + this.conf.mode + this._idd;
		this.cell.childNodes[this.conf.idx.hdr].appendChild(a);
		a.onclick = function(m) {
			if (c.conf.collapsed) {
				c.expand()
			} else {
				c.collapse()
			}
		};
		a = null
	}
	this.attachEvent("_onBeforeContentAttach", function(m) {
		if (m == "tabbar" || m == "layout" || m == "acc") {
			this._hideBorders()
		}
		if (m == "sidebar") {
			this._hideBorders();
			this.showHeader()
		}
	});
	this._initDocking();
	return this
};
dhtmlXLayoutCell.prototype = new dhtmlXCellObject();
dhtmlXLayoutCell.prototype.getId = function() {
	return this.conf.name
};
dhtmlXLayoutCell.prototype._initDocking = function() {
	var a = this;
	this.dock = function() {
		var g = this.layout._getMainInst();
		if (g.dhxWins == null || this.conf.docked) {
			g = null;
			return
		}
		var c = g.dhxWins.window(this.conf.name);
		c.close();
		this._attachFromCell(c);
		this.conf.docked = true;
		if (!this.conf.dock_collapsed) {
			this.expand()
		}
		g._callMainEvent("onDock", [this.conf.name]);
		g = c = null
	};
	this.undock = function(c, o, m, n) {
		var l = this.layout._getMainInst();
		if (l.dhxWins == null || this.conf.docked == false) {
			l = null;
			return
		}
		this.conf.dock_collapsed = this.conf.collapsed;
		if (!this.conf.collapsed) {
			this.collapse()
		}
		if (l.dhxWins.window(this.conf.name) != null) {
			var g = l.dhxWins.window(this.conf.name);
			g.show()
		} else {
			if (c == null) {
				c = 20
			}
			if (o == null) {
				o = 20
			}
			if (m == null) {
				m = 320
			}
			if (n == null) {
				n = 200
			}
			var g = l.dhxWins.createWindow(this.conf.name, c, o, m, n);
			g.button("close").hide();
			g.addUserButton("dock", 99, "Dock");
			g.button("dock").show();
			g.button("dock").attachEvent("onClick", this._doOnDockClick);
			g.setText(this.getText());
			g.attachEvent("onClose", this._doOnDockWinClose)
		}
		this.conf.docked = false;
		g._attachFromCell(this);
		l._callMainEvent("onUnDock", [this.conf.name]);
		l = g = null
	};
	this._doOnDockClick = function() {
		a.dock()
	};
	this._doOnDockWinClose = function(c) {
		c.hide();
		return false
	};
	this._unloadDocking = function() {
		a = null
	}
};
dhtmlXLayoutCell.prototype._hdrInit = function() {
	var c = "";
	if (window.dhx4.isIE) {
		if (navigator.userAgent.indexOf("MSIE 9.0") != -1) {
			c = " dhx_cell_hdr_text_ie9"
		} else {
			if (window.dhx4.isIE8) {
				c = " dhx_cell_hdr_text_ie8"
			} else {
				if (window.dhx4.isIE7) {
					c = " dhx_cell_hdr_text_ie7"
				} else {
					if (window.dhx4.isIE6) {
						c = " dhx_cell_hdr_text_ie6"
					}
				}
			}
		}
	} else {
		if (window.dhx4.isChrome || window.dhx4.isKHTML) {
			c = " dhx_cell_hdr_text_chrome"
		}
	}
	var a = document.createElement("DIV");
	a.className = "dhx_cell_hdr";
	a.innerHTML = "<div class='dhx_cell_hdr_text" + c + "'></div>";
	this.cell.insertBefore(a, this.cell.childNodes[this.conf.idx.cont]);
	a = null;
	this.conf.ofs_nodes.t._getHdrHeight = "func";
	this.conf.hdr = {
		visible: true
	};
	this.conf.idx_data.hdr = "dhx_cell_hdr";
	this._updateIdx();
	this.attachEvent("_onSetSize", this._hdrOnSetSize);
	this.attachEvent("_onBorderChange", this._hdrOnBorderChange);
	this.attachEvent("_onViewSave", this._hdrOnViewSave);
	this.attachEvent("_onViewRestore", this._hdrOnViewRestore)
};
dhtmlXLayoutCell.prototype.showHeader = function(a) {
	if (this.conf.hdr.visible || this.conf.collapsed) {
		return
	}
	if (this.conf.hdr.w_saved > this._getAvailWidth() || this.conf.hdr.h_saved > this._getAvailHeight()) {
		return
	}
	this.conf.hdr.w_saved = this.conf.hdr.h_saved = null;
	this.conf.hdr.visible = true;
	this.cell.childNodes[this.conf.idx.hdr].className = "dhx_cell_hdr";
	if (a !== true) {
		this._adjustCont(this._idd)
	}
};
dhtmlXLayoutCell.prototype.hideHeader = function(a) {
	if (!this.conf.hdr.visible || this.conf.collapsed) {
		return
	}
	this.conf.hdr.w_saved = this._getMinWidth();
	this.conf.hdr.h_saved = this._getMinHeight();
	this.conf.hdr.visible = false;
	this.cell.childNodes[this.conf.idx.hdr].className = "dhx_cell_hdr dhx_cell_hdr_hidden";
	this._hdrUpdBorder();
	this._mtbUpdBorder();
	if (a !== true) {
		this._adjustCont(this._idd)
	}
};
dhtmlXLayoutCell.prototype.isHeaderVisible = function() {
	return (this.conf.hdr.visible == true)
};
dhtmlXLayoutCell.prototype.showArrow = function() {
	this.cell.childNodes[this.conf.idx.hdr].childNodes[1].style.display = ""
};
dhtmlXLayoutCell.prototype.hideArrow = function() {
	this.cell.childNodes[this.conf.idx.hdr].childNodes[1].style.display = "none"
};
dhtmlXLayoutCell.prototype.isArrowVisible = function() {
	return (this.cell.childNodes[this.conf.idx.hdr].childNodes[1].style.display == "")
};
dhtmlXLayoutCell.prototype.setText = function(a) {
	this.conf.hdr.text = a;
	this._hdrUpdText()
};
dhtmlXLayoutCell.prototype.getText = function() {
	return this.conf.hdr.text
};
dhtmlXLayoutCell.prototype.setCollapsedText = function(a) {
	this.conf.hdr.text_collapsed = a;
	this._hdrUpdText()
};
dhtmlXLayoutCell.prototype.getCollapsedText = function() {
	return (this.conf.hdr.text_collapsed != null ? this.conf.hdr.text_collapsed : this.conf.hdr.text)
};
dhtmlXLayoutCell.prototype._hdrUpdText = function() {
	var a = (this.conf.collapsed == true && this.conf.hdr.text_collapsed != null ? this.conf.hdr.text_collapsed : this.conf.hdr.text);
	this.cell.childNodes[this.conf.idx.hdr].firstChild.innerHTML = "<span>" + a + "</span>"
};
dhtmlXLayoutCell.prototype._hdrUpdBorder = function() {
	if (this.conf.borders == true) {
		this.cell.childNodes[this.conf.idx.hdr].className = "dhx_cell_hdr" + (this.conf.hdr.visible ? "" : " dhx_cell_hdr_hidden")
	} else {
		if (!this.conf.hdr.visible) {
			this.cell.childNodes[this.conf.idx.hdr].className = "dhx_cell_hdr dhx_cell_hdr_hidden_no_borders"
		}
	}
};
dhtmlXLayoutCell.prototype._hdrOnSetSize = function() {
	if (this.conf.collapsed && this.conf.mode == "v") {
		this._fitHdr()
	}
};
dhtmlXLayoutCell.prototype._hdrOnBorderChange = function() {
	this.hideHeader(true);
	this._hdrUpdBorder()
};
dhtmlXLayoutCell.prototype._hdrOnViewSave = function(a) {
	this.views[a].hdr_vis = this.conf.hdr.visible
};
dhtmlXLayoutCell.prototype._hdrOnViewRestore = function(a) {
	if (this.conf.hdr.visible != this.views[a].hdr_vis) {
		this[this.views[a].hdr_vis ? "showHeader" : "hideHeader"](true)
	}
	this.views[a].hdr_vis = null;
	delete this.views[a].hdr_vis
};
dhtmlXLayoutCell.prototype._getHdrHeight = function(a) {
	if (this.conf.collapsed && this.conf.mode == "v" && a !== true) {
		return 27
	}
	return this.cell.childNodes[this.conf.idx.hdr].offsetHeight
};
dhtmlXLayoutCell.prototype._fitHdr = function() {
	if (this.conf.collapsed) {
		if (typeof(dhtmlXLayoutObject.prototype._confGlob.hdrColH) == "undefined") {
			this.cell.childNodes[this.conf.idx.hdr].style.height = this.cell.offsetHeight + "px";
			dhtmlXLayoutObject.prototype._confGlob.hdrColH = parseInt(this.cell.childNodes[this.conf.idx.hdr].style.height) - this._getHdrHeight(true)
		}
		this.cell.childNodes[this.conf.idx.hdr].style.height = this.cell.offsetHeight + dhtmlXLayoutObject.prototype._confGlob.hdrColH + "px"
	} else {
		this.cell.childNodes[this.conf.idx.hdr].style.height = null
	}
};
dhtmlXLayoutCell.prototype.expand = function(o) {
	if (!this.conf.collapsed) {
		return true
	}
	var g = this.layout;
	if (this.conf.mode == "v") {
		var n = (o ? g.conf.hh : g.cdata[g.conf.nextCell[this._idd]]._getMinWidth(this._idd));
		var l = g.cont.offsetWidth - g.conf.sw;
		if (n + this.conf.size.w_avl > l) {
			g = null;
			return false
		}
	} else {
		var m = (o ? g.conf.hh : g.cdata[g.conf.nextCell[this._idd]]._getMinHeight(this._idd) + g.cdata[g.conf.nextCell[this._idd]]._getHdrHeight());
		var c = g.cont.offsetHeight - g.conf.sw;
		if (m + this.conf.size.h_avl > c) {
			g = null;
			return false
		}
	}
	if (this.conf.docked == false) {
		this.dock();
		return
	}
	this.cell.className = String(this.cell.className).replace(/\s{0,}dhxlayout_collapsed_[hv]/gi, "");
	this.conf.collapsed = false;
	if (this.conf.mode == "v") {
		this.conf.size.w = Math.min(l - n, this.conf.size.w_saved);
		this.conf.size.w_saved = this.conf.size.w_avl = null
	} else {
		this.conf.size.h = Math.min(c - m, this.conf.size.h_saved);
		this.conf.size.h_saved = this.conf.size.h_avl = null
	}
	if (this.conf.mode == "v") {
		this._fitHdr()
	}
	g.setSizes(g.conf.nextCell[this._idd], g.conf.nextCell[this._idd], o == true, "expand");
	g.sep._blockSep();
	g = null;
	this._hdrUpdText();
	var a = this.layout._getMainInst();
	a._callMainEvent("onExpand", [this.conf.name]);
	a = null;
	return true
};
dhtmlXLayoutCell.prototype.collapse = function() {
	if (this.conf.collapsed) {
		return false
	}
	var c = this.layout;
	if (c.cdata[c.conf.nextCell[this._idd]].expand(true) == false) {
		return false
	}
	if (this.conf.mode == "v") {
		this.conf.size.w_saved = this.conf.size.w;
		this.conf.size.w_avl = this._getMinWidth(this._idd)
	} else {
		this.conf.size.h_saved = this.conf.size.h;
		this.conf.size.h_avl = this._getMinHeight(this._idd) + this._getHdrHeight()
	}
	this.cell.className += " dhxlayout_collapsed_" + this.conf.mode;
	this.conf.collapsed = true;
	if (this.conf.mode == "v") {
		this.conf.size.w = c.conf.hh
	} else {
		this.conf.size.h = this._getHdrHeight()
	}
	c.setSizes(c.conf.nextCell[this._idd], c.conf.nextCell[this._idd], false, "collapse");
	c.sep._blockSep();
	c = null;
	this._hdrUpdText();
	var a = this.layout._getMainInst();
	a._callMainEvent("onCollapse", [this.conf.name]);
	a = null;
	return true
};
dhtmlXLayoutCell.prototype.isCollapsed = function() {
	return (this.conf.collapsed == true)
};
dhtmlXLayoutCell.prototype.setMinWidth = function(a) {
	this.conf.min_height = parseInt(h) || 0
};
dhtmlXLayoutCell.prototype.setMinHeight = function(a) {
	this.conf.min_height = parseInt(a) || 0
};
dhtmlXLayoutCell.prototype._getMinWidth = function(c) {
	if (this.dataType == "layout" && this.dataObj != null) {
		if (this.dataObj.conf.pattern == "1C") {
			return Math.max(this.conf.min_width, this.dataObj.cdata.a._getMinWidth(c))
		} else {
			if (this.dataObj.conf.mode == "v") {
				var a = c || this._idd;
				if (this.dataObj.cdata[a].conf.collapsed) {
					a = this.dataObj.conf.nextCell[a]
				}
				return Math.max(this.conf.min_width, this.dataObj.cdata[a]._getMinWidth(c) + this.dataObj.cdata[this.dataObj.conf.nextCell[a]]._getWidth() + this.dataObj.conf.sw)
			} else {
				return Math.max(this.conf.min_width, this.dataObj.cdata.a._getMinWidth(c), this.dataObj.cdata.b._getMinWidth(c))
			}
		}
	}
	return Math.max(this.conf.min_width, 1)
};
dhtmlXLayoutCell.prototype._getMinHeight = function(g) {
	var c = 0;
	if (this.conf.idx.menu != null) {
		c += this.cell.childNodes[this.conf.idx.menu].offsetHeight
	}
	if (this.dataType == "layout" && this.dataObj != null) {
		if (this.dataObj.conf.pattern == "1C") {
			return Math.max(this.conf.min_height, this.dataObj.cdata.a._getMinHeight(g))
		} else {
			if (this.dataObj.conf.mode == "h") {
				var a = g;
				if (this.dataObj.cdata[a].conf.collapsed) {
					a = this.dataObj.conf.nextCell[a]
				}
				return Math.max(this.conf.min_height, this.dataObj.cdata[a]._getMinHeight(g) + this.dataObj.cdata[a]._getHdrHeight() + this.dataObj.cdata[this.dataObj.conf.nextCell[a]]._getHeight() + this.dataObj.conf.sw)
			} else {
				return Math.max(this.conf.min_height, this.dataObj.cdata.a._getMinHeight(g) + this.dataObj.cdata.a._getHdrHeight(), this.dataObj.cdata.b._getMinHeight(g) + this.dataObj.cdata.b._getHdrHeight())
			}
		}
	}
	return Math.max(this.conf.min_height, c)
};
dhtmlXLayoutCell.prototype._getAvailWidth = function(g) {
	if (this.dataType == "layout" && this.dataObj != null) {
		if (this.dataObj.conf.pattern == "1C") {
			return this.dataObj.cdata.a._getAvailWidth(g)
		} else {
			if (this.dataObj.conf.mode == "v") {
				var a = (this.dataObj.cdata.a.conf.collapsed == true);
				var c = (this.dataObj.cdata.b.conf.collapsed == true);
				if (g == "a") {
					return this.dataObj.cdata[c ? "a" : "b"]._getAvailWidth(g)
				} else {
					return this.dataObj.cdata[a ? "b" : "a"]._getAvailWidth(g)
				}
			} else {
				return Math.min(this.dataObj.cdata.a._getAvailWidth(g), this.dataObj.cdata.b._getAvailWidth(g))
			}
		}
	}
	return this.cell.offsetWidth - this._getMinWidth()
};
dhtmlXLayoutCell.prototype._getAvailHeight = function(l) {
	if (this.dataType == "layout" && this.dataObj != null) {
		if (this.dataObj.conf.pattern == "1C") {
			return this.dataObj.cdata.a._getAvailHeight(l)
		} else {
			if (this.dataObj.conf.mode == "h") {
				var c = (this.dataObj.cdata.a.conf.collapsed == true);
				var g = (this.dataObj.cdata.b.conf.collapsed == true);
				if (l == "a") {
					return this.dataObj.cdata[g ? "a" : "b"]._getAvailHeight(l)
				} else {
					return this.dataObj.cdata[c ? "b" : "a"]._getAvailHeight(l)
				}
			} else {
				return Math.min(this.dataObj.cdata.a._getAvailHeight(l), this.dataObj.cdata.b._getAvailHeight(l))
			}
		}
	}
	var a = this._getHdrHeight();
	if (this.conf.mode == "v" && this.conf.collapsed) {
		a = this.conf.hh
	}
	return this.cell.offsetHeight - a - this._getMinHeight()
};
dhtmlXLayoutCell.prototype.setWidth = function(l) {
	if (this.conf.mode == "v") {
		if (this.conf.collapsed) {
			return
		}
		var m = this.layout;
		var n = m.cdata[m.conf.nextCell[this._idd]];
		if (n.conf.collapsed) {
			l = l + m.conf.sw + n._getWidth();
			o = m = n = null;
			return
		}
		var g = this._getMinWidth(this._idd);
		var q = m.cont.offsetWidth - n._getMinWidth(this._idd) - m.conf.sw;
		l = Math.max(g, Math.min(l, q));
		this.conf.size.w = l;
		m.setSizes(n._idd, n._idd);
		m = n = null
	} else {
		if (this.layout == null || this.layout.parentLayout == null) {
			return
		}
		var o = this.layout.parentLayout;
		var m = this.layout;
		var n = m.cdata[m.conf.nextCell[this._idd]];
		for (var c in o.cdata) {
			if (o.cdata[c].dataObj == m) {
				o.cdata[c].setWidth(l)
			}
		}
		o = m = null
	}
};
dhtmlXLayoutCell.prototype.setHeight = function(o) {
	if (this.conf.mode == "h") {
		if (this.conf.collapsed) {
			return
		}
		var l = this.layout;
		var n = l.cdata[l.conf.nextCell[this._idd]];
		if (n.conf.collapsed) {
			o = o + l.conf.sw + n._getHeight();
			var q = (this.layout != null && this.layout.parentLayout != null ? this.layout.parentLayout : null);
			if (q != null) {
				for (var c in q.cdata) {
					if (q.cdata[c].dataObj == l) {
						q.cdata[c].setHeight(o)
					}
				}
			}
			q = l = n = null;
			return
		}
		var m = this._getMinHeight(this._idd) + this._getHdrHeight();
		var g = l.cont.offsetHeight - n._getMinHeight(this._idd) - n._getHdrHeight() - l.conf.sw;
		o = Math.max(m, Math.min(o, g));
		this.conf.size.h = o;
		l.setSizes(n._idd, n._idd);
		l = n = null
	} else {
		if (this.layout == null || this.layout.parentLayout == null) {
			return
		}
		var q = this.layout.parentLayout;
		var l = this.layout;
		var n = l.cdata[l.conf.nextCell[this._idd]];
		for (var c in q.cdata) {
			if (q.cdata[c].dataObj == l) {
				q.cdata[c].setHeight(o)
			}
		}
		q = l = null
	}
};
dhtmlXLayoutCell.prototype.getWidth = function() {
	return this.conf.size.w
};
dhtmlXLayoutCell.prototype.getHeight = function() {
	return this.conf.size.h
};
dhtmlXLayoutCell.prototype.fixSize = function(c, l) {
	this.conf.fixed.w = window.dhx4.s2b(c);
	this.conf.fixed.h = window.dhx4.s2b(l);
	var a = this.layout._getMainInst();
	var g = {};
	a.forEachItem(function(m) {
		if (m.conf.fsize != null) {
			var s = m.getId();
			var r = {
				h: (m.conf.fixed.w == true),
				v: (m.conf.fixed.h == true)
			};
			for (var n in r) {
				if (r[n] == true && m.conf.fsize[n] != null) {
					if (!(m.conf.fsize[n] instanceof Array)) {
						m.conf.fsize[n] = [m.conf.fsize[n]]
					}
					for (var o = 0; o < m.conf.fsize[n].length; o++) {
						g[m.conf.fsize[n][o]] = true
					}
				}
			}
		}
		m = null
	});
	a._forEachSep(function(m) {
		m._lockSep(g[m.conf.idx] == true);
		m = null
	});
	a = null
};
dhtmlXCellObject.prototype.attachLayout = function(a) {
	this.callEvent("_onBeforeContentAttach", ["layout"]);
	var c = document.createElement("DIV");
	c.style.width = "100%";
	c.style.height = "100%";
	c.style.position = "relative";
	c.style.overflow = "hidden";
	this._attachObject(c);
	if (typeof(this._layoutMainInst) != "undefined") {
		c._layoutMainInst = this._layoutMainInst
	}
	if (typeof(window.dhtmlXLayoutCell) != "undefined" && this instanceof dhtmlXLayoutCell) {
		c._isParentCell = true
	}
	if (typeof(window.dhtmlXAccordionCell) != "undefined" && (this instanceof window.dhtmlXAccordionCell)) {
		c._ofs = {
			t: -1,
			r: -1,
			l: -1,
			b: -1
		}
	}
	if (typeof(window.dhtmlXSideBarCell) != "undefined" && (this instanceof window.dhtmlXSideBarCell)) {
		if (this.conf.skin == "dhx_web") {
			c._ofs = {
				l: 8
			}
		}
		if (this.conf.skin == "dhx_terrace") {
			c._ofs = {
				l: 11
			}
		} else {
			c._ofs = {
				l: -1
			}
		}
	}
	if (typeof(a) == "string") {
		a = {
			pattern: a
		}
	}
	if (typeof(a.skin) == "undefined") {
		a.skin = this.conf.skin
	}
	a.parent = c;
	this.dataType = "layout";
	this.dataObj = new dhtmlXLayoutObject(a);
	if (this instanceof dhtmlXLayoutCell) {
		this.dataObj.parentLayout = this.layout
	}
	c._layoutMainInst = null;
	a.parent = null;
	c = a = null;
	this.callEvent("_onContentAttach", []);
	return this.dataObj
};

function dhtmlXTabBar(c, m) {
	var g = this;
	this.conf = {
		skin: (window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhxtabbar") || "dhx_skyblue"),
		css: "dhxtabbar",
		lastActive: null,
		closeButton: false,
		align: "left",
		tabsMode: (m == "bottom" ? "bottom" : "top"),
		tabsContCss: (navigator.userAgent.indexOf("Safari") >= 0 && navigator.userAgent.indexOf("5.1.7") >= 0 ? " safari_517_fix" : ""),
		contZone: true,
		transSpeed: "0.15s",
		arwMode: "always",
		tabsOfs: 1,
		tabsTop: 0,
		url_demand: false,
		urls: {},
		autoload: {}
	};
	var l;
	if (c != null && typeof(c) == "object" && typeof(c.tagName) == "undefined") {
		l = c.parent;
		if (typeof(c.skin) != "undefined") {
			this.conf.skin = c.skin
		}
		if (typeof(c.mode) != "undefined") {
			this.conf.tabsMode = (c.mode == "bottom" ? "bottom" : "top")
		}
		if (typeof(c.align) != "undefined") {
			this.conf.align = (c.align == "right" ? "right" : "left")
		}
		if (typeof(c.close_button) != "undefined") {
			this.conf.closeButton = window.dhx4.s2b(c.close_button)
		}
		if (typeof(c.content_zone) != "undefined") {
			this.conf.contZone = window.dhx4.s2b(c.content_zone)
		}
		if (typeof(c.xml) != "undefined") {
			this.conf.autoload.xml = c.xml
		}
		if (typeof(c.json) != "undefined") {
			this.conf.autoload.xml = c.json
		}
		if (typeof(c.tabs) != "undefined") {
			this.conf.autoload.tabs = c.tabs
		}
		if (typeof(c.onload) != "undefined") {
			this.conf.autoload.tabs = c.tabs
		}
		if (typeof(c.arrows_mode) != "undefined") {
			this.conf.autoload.arrows_mode = c.arrows_mode
		}
	} else {
		l = c
	}
	window.dhtmlXCellTop.apply(this, [l, c.offsets]);
	if (this.base._ofs != null && this.base._ofs.t != null) {
		this.conf.tabsTop = this.base._ofs.t
	}
	this.tabsMode = document.createElement("DIV");
	this.tabsMode.className = "dhxtabbar_tabs_" + this.conf.tabsMode;
	this.cont.appendChild(this.tabsMode);
	this.tabsArea = document.createElement("DIV");
	this.tabsArea.className = "dhxtabbar_tabs dhxtabbar_tabs_" + this.conf.tabsMode;
	this.tabsArea.innerHTML = "<div class='dhxtabbar_tabs_ar_left'><div class='dhxtabbar_arrow_img'></div></div><div class='dhxtabbar_tabs_base'><div class='dhxtabbar_tabs_cont_" + this.conf.align + this.conf.tabsContCss + "'><div class='dhxtabbar_tabs_line'></div></div></div><div class='dhxtabbar_tabs_ar_right'><div class='dhxtabbar_arrow_img'></div></div>";
	this.tabsArea.style.top = (this.conf.tabsMode == "top" ? this.conf.tabsTop + "px" : "auto");
	this.tabsMode.appendChild(this.tabsArea);
	this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align] = "0px";
	this.tabsArea.childNodes[0].onclick = function() {
		if (g.conf.align == "left") {
			g._moveTabs(1)
		} else {
			g._moveTabs(-1)
		}
	};
	this.tabsArea.childNodes[2].onclick = function() {
		if (g.conf.align == "left") {
			g._moveTabs(-1)
		} else {
			g._moveTabs(1)
		}
	};
	this._onTabsAreaClick = function(n) {
		return this._callMainEvent("onTabClose", [n])
	};
	this.tabsArea.onclick = function(o) {
		o = o || event;
		var n = (o.target || o.srcElement);
		while (n != null) {
			if (typeof(n._tabCloseId) != "undefined") {
				if (g._onTabsAreaClick(n._tabCloseId) !== true) {
					return
				}
				g.t[n._tabCloseId].conf.remove = true;
				g._hideTab(n._tabCloseId);
				n = null
			} else {
				if (typeof(n._tabId) != "undefined") {
					g._doOnClick(n._tabId);
					n = null
				}
			}
			if (n != null) {
				n = n.parentNode;
				if (n == this) {
					n = null
				}
			}
		}
	};
	this.tabsArea.onselectstart = function(n) {
		n = n || event;
		if (n.preventDefault) {
			n.preventDefault()
		} else {
			n.returnValue = false
		}
	};
	this._doOnClick = function(n) {
		this.callEvent("onTabClick", [n, this.conf.lastActive]);
		if (this.t[n].conf.enabled) {
			this._setTabActive(n)
		}
	};
	this.t = {};
	this.addTab = function(n, w, q, u, s, x) {
		if (typeof(x) != "boolean") {
			x = (this.conf.closeButton == true)
		}
		s = window.dhx4.s2b(s);
		var r = document.createElement("DIV");
		r.className = "dhxtabbar_tab";
		r.innerHTML = "<div class='dhxtabbar_tab_text" + (x ? " dhxtabbar_tab_text_close" : "") + "'>" + w + "</div>" + (x ? "<div class='dhxtabbar_tab_close'></div>" : "");
		r._tabId = n;
		if (x) {
			r.childNodes[1]._tabCloseId = n
		}
		var o = this.tabsArea.childNodes[1].firstChild;
		if (u != null && u + 1 > 0 && u + 1 < o.childNodes.length) {
			o.insertBefore(r, o.childNodes[u + 1])
		} else {
			o.appendChild(r)
		}
		var y = false;
		if (typeof(q) == "undefined" || q == null || q == "*") {
			q = this._getLabelWidth(w, x);
			y = true
		} else {
			q = parseInt(q)
		}
		r.style.width = q + "px";
		var v = new dhtmlXTabBarCell(n, this);
		this.tabsMode.appendChild(v.cell);
		this.t[n] = {
			tab: r,
			cell: v,
			conf: {
				text: w,
				visible: true,
				active: false,
				enabled: true,
				close: x,
				width: q,
				autowidth: y
			}
		};
		o = v = null;
		if (s) {
			this._setTabActive(n)
		} else {
			this._adjustCell(n)
		}
		if (this.conf.initSeq != true && this.conf.arwMode == "auto") {
			this.setSizes()
		}
	};
	this.setSizes = function() {
		this._adjustCont();
		if (this.conf.tabsAreaOfs == null) {
			this.tabsArea.style.width = this.cont.offsetWidth + "px";
			this.conf.tabsAreaOfs = parseInt(this.tabsArea.style.width) - this.tabsArea.offsetWidth
		}
		this.tabsArea.style.width = this.cont.offsetWidth + this.conf.tabsAreaOfs + "px";
		this._adjustCell(this.conf.lastActive);
		this._adjustTabs(true);
		this.callEvent("_onSetSizes", [])
	};
	this._adjustCell = function(r) {
		if (!this.conf.contZone || r == null) {
			return
		}
		var q = (this.conf.tabsMode == "top" ? this.tabsArea.offsetHeight : 0) + this.conf.tabsTop;
		var o = this.cont.offsetHeight - this.tabsArea.offsetHeight - this.conf.tabsTop;
		var n = this.t[r].cell.dataType;
		if (this.conf.skin == "dhx_skyblue" && (n == "layout" || n == "tabbar" || n == "acc")) {
			if (this.conf.tabsMode == "top") {
				q = q - 1
			}
			o = o + 1
		}
		if (r != this.conf.lastActive) {
			q = -5000;
			this.t[r].cell.cell.style.visibility = "hidden";
			this.t[r].cell.cell.style.zIndex = 0
		}
		this.t[r].cell._setSize(0, q, this.cont.offsetWidth, o)
	};
	this.setTabsMode = function(n) {
		this.conf.tabsMode = (n == "bottom" ? "bottom" : "top");
		this.tabsMode.className = "dhxtabbar_tabs_" + this.conf.tabsMode;
		this.tabsArea.className = "dhxtabbar_tabs dhxtabbar_tabs_" + this.conf.tabsMode;
		this.tabsArea.style.top = (this.conf.tabsMode == "top" ? this.conf.tabsTop + "px" : "auto");
		this.setSizes()
	};
	this._tabCss = function(s, q) {
		var n = this.t[s].conf.active;
		var r = !this.t[s].conf.enabled;
		var o = !this.t[s].conf.visible;
		return "dhxtabbar_tab" + (o ? " dhxtabbar_tab_hidden" : (n || r ? " dhxtabbar_tab" + (n ? "_actv" : "") + (r ? "_dis" : "") : ""))
	};
	this._getLabelWidth = function(q, o) {
		if (this.tabsTextTest == null) {
			this.tabsTextTest = document.createElement("SPAN");
			this.tabsTextTest.className = "dhxtabbar_tabs_text_test_" + this.conf.skin
		}
		document.body.appendChild(this.tabsTextTest);
		this.tabsTextTest.innerHTML = q;
		var n = this.tabsTextTest.offsetWidth;
		if (window.dhx4.isIE && n == 0) {
			n = this.tabsTextTest.offsetWidth
		}
		n += (this.conf.skin == "dhx_terrace" ? 44 : 35);
		n += (o ? (this.conf.skin == "dhx_terrace" ? 14 : 9) : 0);
		document.body.removeChild(this.tabsTextTest);
		return n
	};
	this._adjustTabs = function(s) {
		if (this._checkArrows() == true || s == true) {
			this.tabsArea.childNodes[1].style.left = this.tabsArea.childNodes[0].offsetWidth - 1 + "px";
			this.tabsArea.childNodes[1].style.width = Math.max(0, this.tabsArea.offsetWidth - this.tabsArea.childNodes[0].offsetWidth - this.tabsArea.childNodes[2].offsetWidth) + 1 + "px"
		}
		var v = this.tabsArea.childNodes[1];
		if (v.offsetWidth < 5) {
			v = null;
			return
		}
		var n = parseInt(v.childNodes[0].style[this.conf.align]);
		var r = null;
		for (var u = 0; u < v.childNodes[0].childNodes.length; u++) {
			var y = v.childNodes[0].childNodes[u]._tabId;
			if (y != null && this.t[y].conf.visible) {
				var o = this.t[y].tab.offsetWidth - this.conf.tabsOfs;
				if (this.t[y].conf.active) {
					if (n < 0 || v.offsetWidth < o) {
						r = {
							d: 1,
							id: y
						}
					} else {
						if (n + o > v.offsetWidth) {
							r = {
								d: -1,
								id: y
							}
						}
					}
				}
				n += o
			}
		}
		if (r != null) {
			this._moveTabs(r.d, r.id)
		} else {
			if (v.offsetWidth > n + 1) {
				v.childNodes[0].style[this.conf.align] = Math.min(0, parseInt(v.childNodes[0].style[this.conf.align]) + (v.offsetWidth - n)) + "px"
			}
		}
		v = r = null
	};
	this._moveTabs = function(A, s) {
		var r = this.tabsArea.childNodes[1].childNodes[0];
		var w = 0;
		var C = [];
		var E = null;
		for (var n = 0; n < r.childNodes.length; n++) {
			var o = r.childNodes[n]._tabId;
			if (o != null && this.t[o].conf.visible) {
				C.push({
					id: o,
					w: this.t[o].tab.offsetWidth - this.conf.tabsOfs,
					ind: w
				});
				if (o == s) {
					E = w
				}
				w++
			}
		}
		var D = parseInt(this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align]);
		var v = this.tabsArea.offsetWidth - this.tabsArea.childNodes[0].offsetWidth - this.tabsArea.childNodes[2].offsetWidth;
		var y = null;
		var u = null;
		for (var n = 0; n < C.length; n++) {
			C[n].x = D;
			if (y == null && D >= 0 && D + C[n].w > 0) {
				y = C[n]
			}
			if (D < v && D + C[n].w <= v) {
				u = C[n]
			}
			D += C[n].w
		}
		if (E != null) {
			var F = C[E]
		} else {
			var F = null;
			if (A > 0) {
				if (y == null) {
					if (C.length > 0) {
						F = C[C.length - 1]
					}
				} else {
					if (y.ind > 0 && C.length >= y.ind) {
						F = C[y.ind - 1]
					}
				}
			} else {
				if (u == null) {
					if (C.length > 0) {
						F = C[0]
					}
				} else {
					if (C.length > u.ind) {
						F = C[u.ind + 1]
					}
				}
			}
		}
		if (F != null) {
			if (A > 0) {
				if (D < v) {
					r.style[this.conf.align] = Math.min(0, parseInt(r.style[this.conf.align]) + (v - D)) + "px"
				} else {
					r.style[this.conf.align] = parseInt(r.style[this.conf.align]) - F.x + "px"
				}
			} else {
				r.style[this.conf.align] = parseInt(r.style[this.conf.align]) - F.x + v - F.w + "px"
			}
		}
		r = F = C = null
	};
	this._getNextVisible = function(o, n) {
		return this._getNearVisible(o, n, "next")
	};
	this._getPrevVisible = function(o, n) {
		return this._getNearVisible(o, n, "previous")
	};
	this._getFirstVisible = function() {
		return this._getNearVisible(null, false, "first")
	};
	this._getNearVisible = function(u, q, s) {
		if (s == "first") {
			var r = this.tabsArea.childNodes[1].childNodes[0].childNodes[1];
			s = "next"
		} else {
			if (u == null || this.t[u] == null) {
				return (q ? this._getFirstVisible() : null)
			}
			var r = this.t[u].tab[s + "Sibling"]
		}
		var o = null;
		while (r != null && o == null) {
			var n = r._tabId;
			if (n != null && o == null && this.t[n].conf.visible) {
				o = n
			} else {
				r = r[s + "Sibling"]
			}
		}
		r = null;
		return o
	};
	this._showTab = function(o, n) {
		if (this.t[o] == null) {
			return
		}
		if (this.t[o].conf.transActv == true) {
			if (this.t[o].conf.transMode == "show") {
				return
			}
		} else {
			if (this.t[o].conf.visible == true) {
				return
			}
		}
		if (this.conf.transProp !== false) {
			this.t[o].conf.transActv = true;
			this.t[o].conf.transMode = "show";
			this.t[o].conf.transProp = this.conf.transProp;
			this.t[o].conf.transActvId = (n ? o : null);
			if (!this.t[o].conf.transEv) {
				this.t[o].tab.addEventListener(this.conf.transEv, this._doOnTrEnd);
				this.t[o].conf.transEv = true
			}
			this.t[o].conf.visible = true;
			this.t[o].tab.className = this._tabCss(o);
			this.t[o].tab.style[this.conf.transProp] = this.conf.transValueWidth;
			this.t[o].tab.style.width = this.t[o].conf.width + "px";
			if (this.t[o].tab.clientWidth >= this.t[o].conf.width) {
				this.t[o].tab.style.visibility = "visible"
			}
		} else {
			this.t[o].conf.visible = true;
			this.t[o].tab.style.display = "";
			if (n) {
				this._setTabActive(o)
			} else {
				this._adjustTabs()
			}
		}
	};
	this._hideTab = function(u, n) {
		if (this.t[u] == null) {
			return
		}
		if (this.t[u].conf.transActv == true) {
			if (this.t[u].conf.transMode == "hide") {
				return
			}
		} else {
			if (this.t[u].conf.visible != true) {
				return
			}
		}
		var o = false;
		if (this.conf.lastActive == u) {
			this.conf.lastActive = null;
			this.t[u].conf.active = false;
			this.t[u].tab.className = this._tabCss(u);
			o = true
		}
		var r = this._getPrevVisible(u);
		var q = this._getNextVisible(u);
		var s = (o && n !== false ? (n == true ? null : n) || q || r : null);
		if (this.conf.transProp !== false) {
			this.t[u].conf.transActv = true;
			this.t[u].conf.transMode = "hide";
			this.t[u].conf.transProp = this.conf.transProp;
			this.t[u].conf.transActvId = s;
			this.t[u].conf.visible = false;
			if (!this.t[u].conf.transEv) {
				this.t[u].tab.addEventListener(this.conf.transEv, this._doOnTrEnd);
				this.t[u].conf.transEv = true
			}
			this.t[u].tab.style.visibility = "hidden";
			this.t[u].tab.className = g._tabCss(u);
			this.t[u].tab.style[this.conf.transProp] = this.conf.transValueWidth;
			this.t[u].tab.style.width = "0px"
		} else {
			this.t[u].tab.style.display = "none";
			this.t[u].conf.visible = false;
			if (this.conf.contZone) {
				this.t[u].cell.cell.style.visibility = "hidden";
				this.t[u].cell.cell.style.top = "-5000px"
			}
			if (s != null) {
				this._setTabActive(s)
			}
			this._adjustTabs();
			if (this.t[u].conf.remove) {
				this._removeTab(u)
			}
		}
	};
	this._isTabVisible = function(n) {
		return (this.t[n].conf.visible == true)
	};
	this._doOnTrEnd = function() {
		var q = this._tabId;
		if (g.t[q] == null) {
			return
		}
		var n = g.t[q];
		var o = n.conf.transActvId;
		if (n.conf.transMode == "hide") {
			if (n.conf.remove) {
				g._removeTab(q)
			} else {
				n.tab.style[n.conf.transProp] = "";
				if (g.conf.contZone) {
					n.cell.cell.style.visibility = "hidden";
					n.cell.cell.style.top = "-5000px"
				}
				n.conf.transActv = false
			}
		} else {
			if (n.conf.transMode == "show") {
				n.tab.style[n.conf.transProp] = "";
				n.tab.style.visibility = "visible";
				n.conf.transMode = null;
				n.conf.transActv = false
			}
		}
		if (o != null) {
			g._setTabActive(o)
		} else {
			g._adjustTabs()
		}
		n = null
	};
	this.enableTabCloseButton = function(n) {
		this.conf.closeButton = window.dhx4.s2b(n)
	};
	this.unload = function() {
		this.conf.unloading = true;
		this.clearAll();
		this.t = null;
		if (this.tabsTextTest != null) {
			if (this.tabsTextTest.parentNode) {
				this.tabsTextTest.parentNode.removeChild(this.tabsTextTest)
			}
			this.tabsTextTest = null
		}
		window.dhx4._enableDataLoading(this, null, null, null, "clear");
		this.tabsArea.childNodes[0].onclick = null;
		this.tabsArea.childNodes[2].onclick = null;
		this.tabsArea.onclick = null;
		this.tabsArea.onselectstart = null;
		this.tabsArea.parentNode.removeChild(this.tabsArea);
		this.tabsArea = null;
		this.tabsMode.parentNode.removeChild(this.tabsMode);
		this.tabsMode = null;
		this._unloadTop();
		window.dhx4._eventable(this, "clear");
		for (var n in this) {
			this[n] = null
		}
		g = null
	};
	this.enableContentZone = function(n) {
		this.conf.contZone = (n == true)
	};
	this.setSkin = function(o) {
		this._setBaseSkin(o);
		this.conf.skin = o;
		if (this.tabsTextTest != null) {
			this.tabsTextTest.className = "dhxtabbar_tabs_text_test_" + this.conf.skin
		}
		for (var n in this.t) {
			this.t[n].cell._resetSizeState();
			if (this.t[n].conf.autowidth == true) {
				this.t[n].conf.width = this._getLabelWidth(this.t[n].conf.text, this.t[n].conf.close);
				if (this.t[n].conf.visible) {
					this.t[n].tab.style.width = this.t[n].conf.width + "px"
				}
			}
		}
		this.conf.tabsAreaOfs = null;
		this._fixTabsOfs();
		this.setSizes()
	};
	this.setAlign = function(n) {
		n = (n == "left" ? "left" : "right");
		if (n == this.conf.align) {
			this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align] = "0px";
			return
		}
		if (this.conf.transProp !== false) {
			this.tabsArea.childNodes[1].childNodes[0].style[this.conf.transProp] = ""
		}
		this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align] = "";
		this.conf.align = n;
		this.tabsArea.childNodes[1].childNodes[0].className = "dhxtabbar_tabs_cont_" + this.conf.align + this.conf.tabsContCss;
		this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align] = "0px";
		if (this.conf.transProp !== false) {
			this.conf.transValuePos = this.conf.align + " " + this.conf.transSpeed;
			this.tabsArea.childNodes[1].childNodes[0].style[this.conf.transProp] = this.conf.transValuePos
		}
	};
	this._initObj = function(s) {
		this.conf.initSeq = true;
		this.clearAll();
		var n = false;
		if (s.settings != null) {
			if (s.settings.skin != null) {
				this.setSkin(s.settings.skin)
			}
			if (s.settings.closeButton != null) {
				this.enableTabCloseButton(window.dhx4.s2b(s.settings.closeButton))
			}
			if (s.settings.align != null) {
				this.setAlign(s.settings.align)
			}
			if (s.settings.hrefmode == "ajax") {
				n = true
			}
			if (s.settings.hrefmode == "ajax-html") {
				n = true;
				this.conf.url_demand = true
			}
		}
		if (s.tabs != null) {
			for (var r = 0; r < s.tabs.length; r++) {
				var o = s.tabs[r];
				if (typeof(o.id) == "undefined") {
					o.id = window.dhx4.newId()
				}
				if (!isNaN(parseInt(o.width))) {
					o.width = parseInt(o.width)
				} else {
					o.width = null
				}
				this.addTab(o.id, o.text || o.label || "", o.width, o.index, window.dhx4.s2b(o.selected) || window.dhx4.s2b(o.active), o.close);
				if (o.content != null) {
					this.cells(o.id).attachHTMLString(o.content)
				} else {
					if (o.href != null) {
						if (this.conf.url_demand == true) {
							this.conf.urls[o.id] = {
								href: o.href,
								ajax: n
							}
						} else {
							this.cells(o.id).attachURL(o.href, n)
						}
					}
				}
				if (typeof(o.enabled) != "undefined" && window.dhx4.s2b(o.enabled) == false) {
					this.tabs(o.id).disable()
				} else {
					if (typeof(o.disabled) != "undefined" && window.dhx4.s2b(o.disabled) == true) {
						this.tabs(o.id).disable()
					}
				}
			}
		}
		this.conf.initSeq = false;
		if (this.conf.arwMode == "auto") {
			this.setSizes()
		}
		if (this.conf.url_demand == true) {
			this._loadURLOnDemand(this.conf.lastActive)
		}
	};
	this._xmlToObj = function(v) {
		var u = {
			settings: {},
			tabs: []
		};
		var n = v.getElementsByTagName("tabbar")[0];
		if (n != null) {
			for (var x in {
					skin: 1,
					align: 1,
					closeButton: 1,
					hrefmode: 1
				}) {
				if (n.getAttribute(x) != null) {
					u.settings[x] = n.getAttribute(x)
				}
			}
			var A = n.getElementsByTagName("tab");
			for (var o = 0; o < A.length; o++) {
				var s = {
					text: (A[o].firstChild.nodeValue || "")
				};
				for (var x in {
						id: 1,
						width: 1,
						close: 1,
						selected: 1,
						active: 1,
						enabled: 1,
						disabled: 1,
						href: 1
					}) {
					if (A[o].getAttribute(x) != null) {
						s[x] = A[o].getAttribute(x)
					}
				}
				var C = A[o].getElementsByTagName("content")[0];
				if (C != null) {
					s.content = "";
					for (var y = 0; y < C.childNodes.length; y++) {
						s.content += (C.childNodes[y].nodeValue || "")
					}
				}
				u.tabs.push(s)
			}
		}
		return u
	};
	dhx4._enableDataLoading(this, "_initObj", "_xmlToObj", "tabbar", {
		struct: true
	});
	var a = window.dhx4.transDetect();
	this.conf.transProp = a.transProp;
	this.conf.transEv = a.transEv;
	this.conf.transValueWidth = "width " + this.conf.transSpeed;
	a = null;
	if (this.conf.transProp !== false) {
		this.conf.transValuePos = this.conf.align + " " + this.conf.transSpeed;
		this.tabsArea.childNodes[1].childNodes[0].style[this.conf.transProp] = this.conf.transValuePos
	}
	this._callMainEvent = function(o, n) {
		return this.callEvent(o, n)
	};
	window.dhx4._eventable(this);
	if (this.conf.autoload.json != null) {
		this.loadStruct(this.conf.autoload.json, this.conf.autoload.onload)
	} else {
		if (this.conf.autoload.xml != null) {
			this.loadStruct(this.conf.autoload.xml, this.conf.autoload.onload)
		} else {
			if (this.conf.autoload.tabs != null) {
				this.loadStruct({
					tabs: this.conf.autoload.tabs
				})
			}
		}
	}
	if (this.conf.autoload.arrows_mode != null) {
		this.setArrowsMode(this.conf.autoload.arrows_mode)
	}
	this._fixTabsOfs();
	this.setSizes();
	return this
}
dhtmlXTabBar.prototype = new dhtmlXCellTop();
dhtmlXTabBar.prototype._fixTabsOfs = function() {
	this.conf.tabsOfs = (this.conf.skin == "dhx_web" ? 0 : 1)
};
dhtmlXTabBar.prototype.cells = dhtmlXTabBar.prototype.tabs = function(a) {
	if (this.t[a]) {
		return this.t[a].cell
	}
	return null
};
dhtmlXTabBar.prototype.getAllTabs = function() {
	var g = [];
	for (var c in this.t) {
		g.push(c)
	}
	return g
};
dhtmlXTabBar.prototype._setTabActive = function(c, a) {
	if (!this.t[c] || !this.t[c].conf.visible || this.t[c].conf.active) {
		return
	}
	if (typeof(a) == "undefined") {
		a = true
	}
	if (a == true && this.callEvent("onSelect", [c, this.conf.lastActive]) !== true) {
		return
	}
	this.setTabInActive();
	this.t[c].conf.active = true;
	if (this.conf.contZone) {
		this.t[c].cell.cell.style.visibility = "visible";
		this.t[c].cell.cell.style.top = "0px";
		this.t[c].cell.cell.style.zIndex = 1
	}
	this.t[c].tab.className = this._tabCss(c);
	this.conf.lastActive = c;
	this.setSizes();
	if (this.conf.url_demand == true) {
		this._loadURLOnDemand(c)
	}
};
dhtmlXTabBar.prototype.setTabInActive = function() {
	if (this.conf.lastActive && this.t[this.conf.lastActive]) {
		this.t[this.conf.lastActive].conf.active = false;
		if (this.conf.contZone) {
			this.t[this.conf.lastActive].cell.cell.style.visibility = "hidden";
			this.t[this.conf.lastActive].cell.cell.style.top = "-5000px";
			this.t[this.conf.lastActive].cell.cell.style.zIndex = 0
		}
		this.t[this.conf.lastActive].tab.className = this._tabCss(this.conf.lastActive);
		this.conf.lastActive = null
	}
};
dhtmlXTabBar.prototype._isTabActive = function(a) {
	return (a == this.conf.lastActive && this.conf.lastActive != null)
};
dhtmlXTabBar.prototype.getActiveTab = function() {
	return this.conf.lastActive
};
dhtmlXTabBar.prototype.goToNextTab = function() {
	var a = this._getNextVisible(this.conf.lastActive, true);
	if (a != null) {
		this._setTabActive(a)
	}
};
dhtmlXTabBar.prototype.goToPrevTab = function() {
	var a = this._getPrevVisible(this.conf.lastActive, true);
	if (a != null) {
		this._setTabActive(a)
	}
};
dhtmlXTabBar.prototype._enableTab = function(c, a) {
	if (!this.t[c] || this.t[c].conf.enabled) {
		return
	}
	this.t[c].conf.enabled = true;
	this.t[c].tab.className = this._tabCss(c);
	if (a == true) {
		this._setTabActive(c)
	}
};
dhtmlXTabBar.prototype._disableTab = function(c, a) {
	if (!this.t[c] || !this.t[c].conf.enabled) {
		return
	}
	this.t[c].conf.enabled = false;
	this.t[c].tab.className = this._tabCss(c);
	if (a !== false && this.conf.lastActive == c) {
		if (a == true) {
			a = this._getNextVisible(c) || this._getPrevVisible(c)
		}
		this._setTabActive(a)
	}
};
dhtmlXTabBar.prototype._isTabEnabled = function(a) {
	return (this.t[a] != null && this.t[a].conf.enabled == true)
};
dhtmlXTabBar.prototype._setTabText = function(l, g, c) {
	if (!this.t[l]) {
		return
	}
	var a = false;
	if (typeof(c) == "undefined" || c == null) {
		c = this._getLabelWidth(g, this.t[l].conf.close);
		a = true
	}
	this.t[l].tab.style.width = c + "px";
	this.t[l].tab.childNodes[0].innerHTML = g;
	this.t[l].conf.text = g;
	this.t[l].conf.width = c;
	this.t[l].conf.autowidth = a
};
dhtmlXTabBar.prototype._getTabText = function(a) {
	if (!this.t[a]) {
		return null
	}
	return this.t[a].conf.text
};
dhtmlXTabBar.prototype._removeTab = function(q, g, n) {
	if (!this.t[q]) {
		return
	}
	if (n != true && this.t[q].conf.remove != true) {
		this.t[q].conf.remove = true;
		this._hideTab(q, g);
		return
	}
	if (typeof(g) == "undefined") {
		g = true
	}
	var l = this._getNextVisible(q);
	var m = this._getPrevVisible(q);
	if (this.t[q].conf.transEv == true) {
		this.t[q].tab.removeEventListener(this.conf.transEv, this._doOnTrEnd);
		this.t[q].conf.transEv = false
	}
	for (var c in this.t[q].conf) {
		this.t[q].conf[c] = null
	}
	this.t[q].conf = null;
	delete this.t[q].conf;
	this.t[q].cell._unload();
	this.t[q].cell = null;
	this.t[q].tab.parentNode.removeChild(this.t[q].tab);
	this.t[q].tab = null;
	this.t[q] = null;
	delete this.t[q];
	if (this.conf.lastActive == q && g != false) {
		this.conf.lastActive = null;
		var o = (g == true ? (l || m || this._getFirstVisible()) : g);
		if (o != null) {
			this._setTabActive(o)
		}
	} else {
		if (n != true) {
			this._adjustTabs()
		}
	}
};
dhtmlXTabBar.prototype.clearAll = function() {
	for (var c in this.t) {
		this._removeTab(c, false, true)
	}
	this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align] = "0px"
};
dhtmlXTabBar.prototype.moveTab = function(g, a) {
	if (!this.t[g] || a < 0) {
		return
	}
	a += 1;
	var c = this.tabsArea.childNodes[1].firstChild;
	if (c.childNodes[a] != this.t[g].tab) {
		c.removeChild(this.t[g].tab);
		if (a >= c.childNodes.length) {
			c.appendChild(this.t[g].tab)
		} else {
			c.insertBefore(this.t[g].tab, c.childNodes[a])
		}
	}
	c = null
};
dhtmlXTabBar.prototype._getIndex = function(l) {
	var a = -1;
	var g = this.tabsArea.childNodes[1].firstChild;
	for (var c = 1; c < g.childNodes.length; c++) {
		if (g.childNodes[c]._tabId == l) {
			a = c - 1
		}
	}
	g = null;
	return a
};
dhtmlXTabBar.prototype.getNumberOfTabs = function(l) {
	var g = 0;
	for (var c in this.t) {
		g += (l != true ? 1 : (this.t[c].conf.visible == true ? 1 : 0))
	}
	return g
};
dhtmlXTabBar.prototype.forEachCell = dhtmlXTabBar.prototype.forEachTab = function(g) {
	for (var c in this.t) {
		g.apply(window, [this.t[c].cell])
	}
};
dhtmlXTabBar.prototype.enableAutoReSize = function() {
	this._initFSResize()
};
dhtmlXTabBar.prototype.setArrowsMode = function(a) {
	a = {
		auto: "auto",
		always: "always"
	}[String(a)];
	if (a == null || a == this.conf.mode) {
		return
	}
	this.conf.arwMode = a;
	if (a == "always") {
		this.tabsArea.childNodes[0].className = "dhxtabbar_tabs_ar_left";
		this.tabsArea.childNodes[2].className = "dhxtabbar_tabs_ar_right"
	}
	this.setSizes()
};
dhtmlXTabBar.prototype._checkArrows = function() {
	var m = false;
	if (this.conf.arwMode == "auto") {
		var l = 0;
		for (var g in this.t) {
			l += this.t[g].tab.offsetWidth
		}
		var c = this.tabsArea.childNodes[0];
		var n = this.tabsArea.childNodes[2];
		if (l > this.cont.offsetWidth) {
			if (c.className.search(/dhxtabbar_tabs_ar_hidden/) >= 0) {
				c.className = c.className.replace(/\s{0,}dhxtabbar_tabs_ar_hidden/, "");
				n.className = n.className.replace(/\s{0,}dhxtabbar_tabs_ar_hidden/, "");
				m = true
			}
		} else {
			if (c.className.search(/dhxtabbar_tabs_ar_hidden/) < 1) {
				c.className += " dhxtabbar_tabs_ar_hidden";
				n.className += " dhxtabbar_tabs_ar_hidden";
				m = true
			}
		}
		c = n = null
	}
	return m
};
dhtmlXTabBar.prototype._loadURLOnDemand = function(a) {
	if (a != null && this.conf.urls[a] != null) {
		this.cells(a).attachURL(this.conf.urls[a].href, this.conf.urls[a].ajax);
		this.conf.urls[a] = null
	}
};
window.dhtmlXTabBarCell = function(l, g) {
	dhtmlXCellObject.apply(this, [l, "_tabbar"]);
	this.tabbar = g;
	this.conf.skin = this.tabbar.conf.skin;
	this.conf.tabbar_funcs = {
		show: "_showTab",
		hide: "_hideTab",
		isVisible: "_isTabVisible",
		enable: "_enableTab",
		disable: "_disableTab",
		isEnabled: "_isTabEnabled",
		getIndex: "_getIndex",
		getText: "_getTabText",
		setText: "_setTabText",
		setActive: "_setTabActive",
		isActive: "_isTabActive",
		close: "_removeTab"
	};
	this._tabbarCall = function(a) {
		return function() {
			var m = [this._idd];
			for (var n = 0; n < arguments.length; n++) {
				m.push(arguments[n])
			}
			return this.tabbar[a].apply(this.tabbar, m)
		}
	};
	for (var c in this.conf.tabbar_funcs) {
		this[c] = this._tabbarCall(this.conf.tabbar_funcs[c])
	}
	this.attachEvent("_onCellUnload", function() {
		this.tabbar = null;
		for (var m in this.conf.tabbar_funcs) {
			this[m] = null;
			this.conf.tabbar_funcs[m] = null
		}
		this.conf.tabbar_funcs = null
	});
	this.attachEvent("_onContentLoaded", function() {
		this.tabbar._callMainEvent("onContentLoaded", arguments);
		this.tabbar._callMainEvent("onTabContentLoaded", arguments)
	});
	this.attachEvent("_onContentAttach", function() {
		this.tabbar._adjustCell(this.tabbar.conf.lastActive)
	});
	this.attachEvent("_onBeforeContentAttach", function(a) {
		if (a == "sidebar") {
			this._hideBorders()
		}
	})
};
window.dhtmlXTabBarCell.prototype = new dhtmlXCellObject();
dhtmlXCellObject.prototype.attachTabbar = function(a) {
	this.callEvent("_onBeforeContentAttach", ["tabbar"]);
	if (typeof(a) == "string") {
		a = {
			mode: a
		}
	} else {
		if (typeof(a) != "object" || a == null) {
			a = {}
		}
	}
	var c = document.createElement("DIV");
	c.style.width = "100%";
	c.style.height = "100%";
	c.style.position = "relative";
	c.style.overflow = "hidden";
	if (typeof(window.dhtmlXAccordionCell) != "undefined" && (this instanceof window.dhtmlXAccordionCell)) {
		c._ofs = {
			t: -1
		}
	}
	if (typeof(window.dhtmlXSideBarCell) != "undefined" && (this instanceof window.dhtmlXSideBarCell)) {
		c._ofs = {
			l: -1
		}
	}
	this._attachObject(c);
	a.skin = this.conf.skin;
	a.parent = c;
	this.dataType = "tabbar";
	this.dataObj = new dhtmlXTabBar(a);
	a.parent = c = null;
	a = null;
	this.callEvent("_onContentAttach", []);
	return this.dataObj
};

function dhtmlXTabBarInitFromHTML() {
	var z = document.getElementsByTagName("div");
	for (var i = 0; i < z.length; i++) {
		if (z[i].className.indexOf("dhtmlxTabBar") != -1) {
			var conf = {
				settings: {},
				tabs: []
			};
			var n = z[i];
			var id = n.id;
			n.className = "";
			var k = new Array();
			for (var j = 0; j < n.childNodes.length; j++) {
				if (n.childNodes[j].tagName && n.childNodes[j].tagName != "!") {
					k[k.length] = n.childNodes[j]
				}
			}
			var skin = n.getAttribute("skin");
			if (skin != null) {
				conf.settings.skin = skin
			}
			var w = new dhtmlXTabBar({
				parent: id,
				mode: n.getAttribute("mode")
			});
			window[id] = w;
			acs = n.getAttribute("onbeforeinit");
			if (acs) {
				eval(acs)
			}
			align = n.getAttribute("align");
			if (align) {
				conf.settings.align = align
			}
			var cont = {};
			for (var j = 0; j < k.length; j++) {
				var m = k[j];
				var tab = {
					id: m.id,
					text: m.getAttribute("name"),
					width: m.getAttribute("width"),
					selected: m.getAttribute("selected"),
					active: m.getAttribute("active"),
					close: m.getAttribute("close")
				};
				var href = m.getAttribute("href");
				if (href) {
					cont[m.id] = {
						href: href
					}
				} else {
					cont[m.id] = {
						cont: m
					}
				}
				conf.tabs.push(tab)
			}
			w.loadStruct(conf);
			for (var a in cont) {
				if (cont[a].href) {
					w.cells(a).attachURL(cont[a].href);
					cont[a].href = null
				} else {
					w.cells(a).attachObject(cont[a].cont);
					if (cont[a].cont.style.display == "none") {
						cont[a].cont.style.display = ""
					}
					cont[a].cont = null
				}
				cont[a] = null
			}
			var selId = n.getAttribute("select");
			if (selId != null) {
				w.tabs(selId).setActive()
			} else {
				if (w.getActiveTab() == null) {
					var v = w._getFirstVisible();
					if (v != null) {
						w.cells(v).setActive()
					}
				}
			}
			acs = n.getAttribute("oninit");
			if (acs) {
				eval(acs)
			}
		}
	}
	if (typeof(window.addEventListener) == "function") {
		window.removeEventListener("load", dhtmlXTabBarInitFromHTML, false)
	} else {
		window.detachEvent("onload", dhtmlXTabBarInitFromHTML)
	}
}
if (typeof(window.addEventListener) == "function") {
	window.addEventListener("load", dhtmlXTabBarInitFromHTML, false)
} else {
	window.attachEvent("onload", dhtmlXTabBarInitFromHTML)
}

function dhtmlXSideBar(c) {
	var g = this;
	this.conf = {
		skin: (c.skin || window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhxsidebar") || "dhx_skyblue"),
		css: "dhxsidebar",
		width: c.width || 200,
		scroll_size: 12,
		scroll_mult: 20,
		close_button: false,
		icons_path: c.icons_path || "",
		selected: null
	};
	this.setTemplate(c.template);
	window.dhtmlXCellTop.apply(this, [c.parent, (c == null ? null : c.offsets)]);
	window.dhx4._eventable(this);
	if (window.navigator.msPointerEnabled == true) {
		this.conf.touch_ms = true;
		this.conf.touch_start = "MSPointerDown", this.conf.touch_end = "MSPointerUp"
	} else {
		this.conf.touch_ms = false;
		this.conf.touch_start = "touchstart", this.conf.touch_end = "touchend"
	}
	this.side = document.createElement("DIV");
	this.side.className = "dhxsidebar_side dhxsidebar_tpl_" + this.conf.tpl_name;
	this.side.innerHTML = "<div class='dhxsidebar_side_items'></div>";
	this.cont.appendChild(this.side);
	window.setTimeout(function() {
		if (g != null && g.side != null) {
			g.side.firstChild.style.top = "0px"
		}
	}, 1);
	this.arw = document.createElement("DIV");
	this.arw.className = "dhxsidebar_arrows dhxsidebar_arrows_hidden";
	this.arw.innerHTML = "<div class='dhxsidebar_arrow dhxsidebar_arrow_left'><div class='dhxsidebar_arrow_image'></div></div><div class='dhxsidebar_arrow dhxsidebar_arrow_right'><div class='dhxsidebar_arrow_image'></div></div>";
	this.cont.appendChild(this.arw);
	this._doOnArwClick = function(m) {
		m = m || event;
		if (m.type != "click" && m.preventDefault) {
			m.preventDefault()
		}
		var l = m.target || m.srcElement;
		if (l.className.match(/dhxsidebar_arrow_image/) != null) {
			l = l.parentNode
		}
		if (l.className.match(/dhxsidebar_arrow_left/) != null) {
			g._scrollSide(-g.conf.scroll_size)
		} else {
			if (l.className.match(/dhxsidebar_arrow_right/) != null) {
				g._scrollSide(g.conf.scroll_size)
			}
		}
		l = null
	};
	if (typeof(window.addEventListener) == "function") {
		this.arw.addEventListener(this.conf.touch_start, this._doOnArwClick, false);
		this.arw.addEventListener("click", this._doOnArwClick, false)
	} else {
		this.arw.attachEvent("onclick", this._doOnArwClick)
	}
	this._doOnSideClick = function(m) {
		m = m || event;
		var l = m.target || m.srcElement;
		var n = null;
		if (m.type == "touchstart" || m.type == "pointerdown" || m.type == "MSPointerDown") {
			if (m.preventDefault) {
				m.preventDefault()
			}
			if (this.className.match(/dhxsidebar_touch/gi) == null) {
				if (m.type == "touchstart" || (m.type == "pointerdown" && m.pointerType == "touch")) {
					this.className += " dhxsidebar_touch"
				}
			}
		}
		while (l != null && n == null && m.type != "pointerdown" && m.type != "MSPointerDown") {
			if (typeof(l.className) != "undefined" && l.className.match(/^dhxsidebar_item/) != null && typeof(l._idd) != "undefined") {
				n = l._idd
			} else {
				l = l.parentNode
			}
		}
		if (n != null) {
			g._setItemActive(n, true)
		}
		l = null
	};
	if (typeof(window.addEventListener) == "function") {
		this.side.addEventListener(this.conf.touch_start, this._doOnSideClick, false);
		this.side.addEventListener(this.conf.touch_end, this._doOnSideClick, false);
		this.side.addEventListener("mouseup", this._doOnSideClick, false)
	} else {
		this.side.attachEvent("onclick", this._doOnSideClick)
	}
	this.side.onmouseover = function() {
		this.className = this.className.replace(/\s*dhxsidebar_touch/gi, "")
	};
	this._doOnSideScroll = function(l) {
		l = l || event;
		var m = (l.type == "mousewheel" ? -l.wheelDelta : l.deltaY);
		g._scrollSide(m / Math.abs(m) * 3)
	};
	this._scrollSide = function(l) {
		var m = parseInt(this.side.firstChild.style.top || 0) - l * this.conf.scroll_mult;
		if (m + this.side.firstChild.offsetHeight < this.side.clientHeight) {
			m = this.side.clientHeight - this.side.firstChild.offsetHeight
		}
		if (m > 0) {
			m = 0
		}
		this.side.firstChild.style.top = m + "px"
	};
	if (typeof(window.addEventListener) == "function") {
		this.side.addEventListener("wheel", this._doOnSideScroll, false)
	} else {
		this.side.attachEvent("onmousewheel", this._doOnSideScroll)
	}
	this.t = {};
	this.s = {};
	this._adjustCell = function(q) {
		if (q == null) {
			return
		}
		var l = this.conf.width;
		var m = this.cont.offsetWidth - l;
		var o = 0;
		var n = this.cont.offsetHeight;
		if (q != this.conf.selected) {
			o = -5000;
			this.t[q].cell.cell.style.visibility = "hidden";
			this.t[q].cell.cell.style.zIndex = 0
		}
		this.t[q].cell._setSize(l, o, m, n)
	};
	var a = window.dhx4.transDetect();
	this.conf.transProp = a.transProp;
	this.conf.transEv = a.transEv;
	this.conf.transValue = "all 0.1s";
	this._doOnTrEnd = function(m) {
		var o = this._idd;
		if (g.t[o] == null) {
			return
		}
		var l = g.t[o];
		var n = l.conf.transActvId;
		if (l.conf.transMode == "hide") {
			if (l.conf.remove == true) {
				g._removeItem(o)
			} else {
				l.item.style[l.conf.transProp] = "";
				l.cell.cell.style.visibility = "hidden";
				l.cell.cell.style.top = "-5000px";
				l.conf.transActv = false
			}
		} else {
			if (l.conf.transMode == "show") {
				l.item.style[l.conf.transProp] = "";
				l.item.style.visibility = "visible";
				l.conf.transMode = null;
				l.conf.transActv = false
			}
		}
		if (n != null) {
			g._setItemActive(n)
		} else {
			g._checkHeight()
		}
		l = null
	};
	this._initObj = function(l) {
		this.clearAll();
		if (l.items != null) {
			this.addItem(l.items)
		}
	};
	this._xmlToObj = function(v) {
		var m = [];
		var s = v.getElementsByTagName("sidebar");
		if (s != null && s[0] != null) {
			var n = s[0].getElementsByTagName("item");
			for (var u = 0; u < n.length; u++) {
				var o = {};
				for (var l = 0; l < n[u].attributes.length; l++) {
					o[n[u].attributes[l].nodeName] = n[u].attributes[l].nodeValue
				}
				m.push(o)
			}
		}
		return {
			items: m
		}
	};
	dhx4._enableDataLoading(this, "_initObj", "_xmlToObj", "sidebar", {
		struct: true
	});
	this.unload = function() {
		this.conf.unloading = true;
		if (typeof(window.addEventListener) == "function") {
			this.side.removeEventListener("wheel", this._doOnSideScroll, false)
		} else {
			this.side.detachEvent("onmousewheel", this._doOnSideScroll)
		}
		this.clearAll();
		this.s = this.t = null;
		if (typeof(window.addEventListener) == "function") {
			this.arw.removeEventListener(this.conf.touch_start, this._doOnArwClick, false);
			this.arw.removeEventListener("click", this._doOnArwClick, false)
		} else {
			this.arw.detachEvent("onclick", this._doOnArwClick)
		}
		this.arw.parentNode.removeChild(this.arw);
		this.arw = null;
		if (typeof(window.addEventListener) == "function") {
			this.side.removeEventListener(this.conf.touch_start, this._doOnSideClick, false);
			this.side.removeEventListener(this.conf.touch_end, this._doOnSideClick, false);
			this.side.removeEventListener("click", this._doOnSideClick, false)
		} else {
			this.side.detachEvent("onclick", this._doOnSideClick)
		}
		this.side.onmouseover = null;
		this.side.parentNode.removeChild(this.side);
		this.side = null;
		this._unloadTop();
		window.dhx4._eventable(this, "clear");
		window.dhx4._enableDataLoading(this, null, null, null, "clear");
		g = null
	};
	this.setSizes();
	if (c.items != null) {
		this._initObj(c)
	} else {
		if (c.json != null) {
			this.loadStruct(c.json, c.onload)
		} else {
			if (c.xml != null) {
				this.loadStruct(c.xml, c.onload)
			}
		}
	}
	return this
}
dhtmlXSideBar.prototype = new dhtmlXCellTop();
dhtmlXSideBar.prototype._addItem = function(c) {
	var l = (typeof(c.id) != "undefined" ? c.id : window.dhx4.newId());
	if (c.type == "separator") {
		var g = document.createElement("DIV");
		g.className = "dhxsidebar_sep";
		this.side.firstChild.appendChild(g);
		this.s[l] = {
			sep: g
		};
		g = null;
		return
	}
	c.icons_path = this.conf.icons_path;
	var g = document.createElement("DIV");
	g.className = "dhxsidebar_item";
	g.innerHTML = window.dhx4.template(this.conf.tpl_str, c);
	g._idd = l;
	this.side.firstChild.appendChild(g);
	g.ondragstart = function() {
		return false
	};
	var a = new dhtmlXSideBarCell(l, this);
	this.cont.appendChild(a.cell);
	this.t[l] = {
		item: g,
		cell: a,
		init: c,
		conf: {
			selected: false,
			visible: true,
			close: close
		}
	};
	g = null;
	if (window.dhx4.s2b(c.selected) == true) {
		this._setItemActive(l)
	} else {
		this._adjustCell(l)
	}
	this._checkHeight()
};
dhtmlXSideBar.prototype.addItem = function(a) {
	if (!(a instanceof Array)) {
		a = [a]
	}
	for (var c = 0; c < a.length; c++) {
		this._addItem(a[c])
	}
};
dhtmlXSideBar.prototype.items = dhtmlXSideBar.prototype.cells = function(a) {
	if (this.t[a] != null) {
		return this.t[a].cell
	}
	return null
};
dhtmlXSideBar.prototype.forEachCell = dhtmlXSideBar.prototype.forEachItem = function(g) {
	for (var c in this.t) {
		if (typeof(g) == "function") {
			g.apply(window, [this.t[c].cell])
		} else {
			if (typeof(g) == "string" && typeof(window[g]) == "function") {
				window[g].apply(window, [this.t[c].cell])
			}
		}
	}
};
dhtmlXSideBar.prototype.getAllItems = function() {
	var g = [];
	for (var c in this.t) {
		g.push(c)
	}
	return g
};
dhtmlXSideBar.prototype.getNumberOfItems = function() {
	return this.getAllItems().length
};
dhtmlXSideBar.prototype.clearAll = function() {
	for (var c in this.t) {
		this._removeItem(c, false, true)
	}
	for (var c in this.s) {
		this.removeSep(c)
	}
};
dhtmlXSideBar.prototype.setSizes = function() {
	this._adjustCont();
	this._adjustSide();
	this._checkHeight();
	this._adjustCell(this.conf.selected);
	this.callEvent("_onSetSizes", [])
};
dhtmlXSideBar.prototype.setSideWidth = function(a) {
	this.conf.width = a;
	this.setSizes()
};
dhtmlXSideBar.prototype._adjustSide = function() {
	if (this.conf.side_ofs == null) {
		this.conf.side_ofs = {};
		this.side.style.width = this.conf.width + "px";
		this.side.style.height = this.cont.offsetHeight + "px";
		this.conf.side_ofs.w = this.side.offsetWidth - parseInt(this.side.style.width);
		this.conf.side_ofs.h = this.side.offsetHeight - parseInt(this.side.style.height)
	}
	this.side.style.width = this.conf.width - this.conf.side_ofs.w + "px";
	this.side.style.height = this.cont.offsetHeight - this.arw.offsetHeight - this.conf.side_ofs.h + "px";
	this.arw.style.width = this.side.style.width;
	this._scrollSide(0)
};
dhtmlXSideBar.prototype._checkHeight = function() {
	var a = (this.arw.className.match(/dhxsidebar_arrows_hidden/) != null);
	if (this.conf.side_hfix == null) {
		this.conf.side_hfix = this.side.offsetHeight - this.side.clientHeight
	}
	if (this.side.firstChild.offsetHeight > this.cont.clientHeight - this.conf.side_hfix) {
		if (a == true) {
			this.arw.className = "dhxsidebar_arrows";
			this._adjustSide()
		}
	} else {
		if (a == false) {
			this.arw.className = "dhxsidebar_arrows dhxsidebar_arrows_hidden";
			this.side.firstChild.style.top = "0px";
			this._adjustSide()
		}
	}
};
dhtmlXSideBar.prototype.removeSep = function(c) {
	if (this.s[c] == null) {
		return
	}
	this.side.firstChild.removeChild(this.s[c].sep);
	this.s[c].sep = null;
	this.s[c] = null;
	try {
		delete this.s[c]
	} catch (a) {}
};
dhtmlXSideBar.prototype._setItemActive = function(g, c) {
	if (this.conf.selected == g) {
		return
	}
	if (typeof(c) == "undefined") {
		c = false
	}
	if (c == true && this.callEvent("onBeforeSelect", [g, this.conf.selected]) !== true) {
		return
	}
	var a = null;
	if (this.conf.selected != null) {
		a = this.conf.selected;
		this._setItemInactive(this.conf.selected)
	}
	if (this.t[g] != null) {
		this.conf.selected = g;
		this.t[g].selected = true;
		this.t[g].item.className += " dhxsidebar_item_selected";
		this.t[g].cell.cell.style.visibility = "visible";
		this.t[g].cell.cell.style.top = "0px";
		this.t[g].cell.cell.style.zIndex = 1
	} else {
		this.conf.selected = null
	}
	this._adjustCell(g);
	if (c == true) {
		this.callEvent("onSelect", [g, a])
	}
};
dhtmlXSideBar.prototype._setItemInactive = function(a) {
	if (this.t[a] == null) {
		return
	}
	this.t[a].selected = false;
	this.t[a].item.className = this.t[a].item.className.replace(/\s{0,}dhxsidebar_item_selected/gi, "");
	this.t[a].cell.cell.style.visibility = "hidden";
	this.t[a].cell.cell.style.top = "-5000px";
	this.t[a].cell.cell.style.zIndex = 0
};
dhtmlXSideBar.prototype._isItemActive = function(a) {
	return (this.conf.selected == a)
};
dhtmlXSideBar.prototype._getNextVisible = function(c, a) {
	return this._getNearVisible(c, a, "next")
};
dhtmlXSideBar.prototype._getPrevVisible = function(c, a) {
	return this._getNearVisible(c, a, "previous")
};
dhtmlXSideBar.prototype._getFirstVisible = function() {
	return this._getNearVisible(null, false, "first")
};
dhtmlXSideBar.prototype._getNearVisible = function(n, c, m) {
	if (m == "first") {
		var g = this.side.firstChild.firstChild;
		m = "next"
	} else {
		if (n == null || this.t[n] == null) {
			return (c ? this._getFirstVisible() : null)
		}
		var g = this.t[n].item[m + "Sibling"]
	}
	var l = null;
	while (g != null && l == null) {
		var a = g._idd;
		if (a != null && l == null && this.t[a].conf.visible) {
			l = a
		} else {
			g = g[m + "Sibling"]
		}
	}
	g = null;
	return l
};
dhtmlXSideBar.prototype.goToNextItem = function(a) {
	var c = this._getNextVisible(this.conf.selected, true);
	if (c != null) {
		this._setItemActive(c, a)
	}
};
dhtmlXSideBar.prototype.goToPrevItem = function(a) {
	var c = this._getPrevVisible(this.conf.selected, true);
	if (c != null) {
		this._setItemActive(c, a)
	}
};
dhtmlXSideBar.prototype.getActiveItem = function() {
	return this.conf.selected
};
dhtmlXSideBar.prototype.setTemplate = function(l, c) {
	this.conf.tpl_name = (l != null && this.templates[l] != null ? l : "details");
	this.conf.tpl_str = this.templates[this.conf.tpl_name];
	if (c != null) {
		this.conf.icons_path = c
	}
	for (var g in this.t) {
		this.t[g].init.icons_path = this.conf.icons_path;
		this.t[g].item.innerHTML = window.dhx4.template(this.conf.tpl_str, this.t[g].init)
	}
	if (this.side != null) {
		this.side.className = "dhxsidebar_side dhxsidebar_tpl_" + this.conf.tpl_name
	}
	if (this._scrollSide != null) {
		this._scrollSide(0);
		this._checkHeight()
	}
};
dhtmlXSideBar.prototype.templates = {
	details: "<img class='dhxsidebar_item_icon' src='#icons_path##icon#' border='0'><div class='dhxsidebar_item_text'>#text#</div>",
	tiles: "<img class='dhxsidebar_item_icon' src='#icons_path##icon#' border='0'><div class='dhxsidebar_item_text'>#text#</div>",
	icons: "<img class='dhxsidebar_item_icon' src='#icons_path##icon#' border='0'>",
	icons_text: "<div class='dhxsidebar_item_icon'><img class='dhxsidebar_item_icon' src='#icons_path##icon#' border='0'></div><div class='dhxsidebar_item_text'>#text#</div>",
	text: "<div class='dhxsidebar_item_text'>#text#</div>"
};
window.dhtmlXSideBarCell = function(l, g) {
	dhtmlXCellObject.apply(this, [l, "_sidebar"]);
	this.sidebar = g;
	this.conf.skin = this.sidebar.conf.skin;
	this.conf.sidebar_funcs = {
		show: "_showItem",
		hide: "_hideItem",
		isVisible: "_isItemVisible",
		setActive: "_setItemActive",
		isActive: "_isItemActive",
		setText: "_setItemText",
		getText: "_getItemText",
		remove: "_removeItem"
	};
	this._sidebarCall = function(a) {
		return function() {
			var m = [this._idd];
			for (var n = 0; n < arguments.length; n++) {
				m.push(arguments[n])
			}
			return this.sidebar[a].apply(this.sidebar, m)
		}
	};
	for (var c in this.conf.sidebar_funcs) {
		this[c] = this._sidebarCall(this.conf.sidebar_funcs[c])
	}
	this.attachEvent("_onCellUnload", function() {
		this.sidebar = null;
		for (var m in this.conf.sidebar_funcs) {
			this[m] = this.conf.sidebar_funcs[m] = null
		}
		this.conf.sidebar_funcs = null
	});
	this.attachEvent("_onContentLoaded", function() {
		this.sidebar.callEvent("onContentLoaded", arguments)
	});
	this.attachEvent("_onBeforeContentAttach", function(a) {
		if (a == "tabbar" || a == "layout" || a == "acc" || a == "sidebar") {
			this._hideBorders()
		}
		if ((this.conf.skin == "dhx_web" || this.conf.skin == "dhx_terrace") && (a == "menu" || a == "toolbar" || a == "ribbon")) {
			if (this.cell.className.match(/dhx_cell_cont_no_top/gi) == null) {
				this.cell.className += " dhx_cell_cont_no_top"
			}
		}
	})
};
dhtmlXSideBarCell.prototype = new dhtmlXCellObject();
dhtmlXSideBar.prototype._setItemText = function(l, g) {
	if (this.t[l] != null) {
		for (var c in g) {
			this.t[l].init[c] = g[c]
		}
		this.t[l].init.icons_path = this.conf.icons_path;
		this.t[l].item.innerHTML = window.dhx4.template(this.conf.tpl_str, this.t[l].init)
	}
};
dhtmlXSideBar.prototype._getItemText = function(l) {
	var g = {};
	if (this.t[l] != null) {
		for (var c in this.t[l].init) {
			g[c] = this.t[l].init[c]
		}
	}
	return g
};
dhtmlXSideBar.prototype._removeItem = function(q, o, m) {
	if (this.t[q] == null) {
		return
	}
	if (m != true && this.t[q].conf.remove != true) {
		this.t[q].conf.remove = true;
		this._hideItem(q, o);
		return
	}
	if (typeof(o) == "undefined") {
		o = true
	}
	var g = this._getNextVisible(q);
	var l = this._getPrevVisible(q);
	if (this.t[q].conf.transEv == true) {
		this.t[q].item.removeEventListener(this.conf.transEv, this._doOnTrEnd);
		this.t[q].conf.transEv = false
	}
	this.t[q].cell._unload();
	this.t[q].cell = null;
	this.t[q].item.parentNode.removeChild(this.t[q].item);
	this.t[q].item = null;
	for (var c in this.t[q]) {
		this.t[q][c] = null
	}
	this.t[q] = null;
	try {
		delete this.t[q]
	} catch (n) {}
	if (this.conf.selected == q && o != false) {
		this.conf.selected = null;
		var o = (o == true ? (g || l || this._getFirstVisible()) : o);
		if (o != null) {
			this._setItemActive(o)
		}
	} else {
		if (m != true) {
			this._checkHeight()
		}
	}
};
dhtmlXSideBar.prototype._showItem = function(c, a) {
	if (this.t[c] == null || this.t[c].conf.visible == true || this.t[c].conf.transActv == true) {
		return
	}
	if (this.conf.transProp !== false) {
		this.t[c].conf.transActv = true;
		this.t[c].conf.transMode = "show";
		this.t[c].conf.transProp = this.conf.transProp;
		this.t[c].conf.transActvId = (a ? c : null);
		if (this.t[c].conf.transEv != true) {
			this.t[c].item.addEventListener(this.conf.transEv, this._doOnTrEnd);
			this.t[c].conf.transEv = true
		}
		this.t[c].conf.visible = true;
		this.t[c].item.style[this.conf.transProp] = this.conf.transValue;
		this.t[c].item.className = "dhxsidebar_item"
	} else {
		this.t[c].conf.visible = true;
		this.t[c].item.style.display = "";
		if (a == true) {
			this._setItemActive(c)
		} else {
			this._checkHeight()
		}
	}
};
dhtmlXSideBar.prototype._hideItem = function(m, l) {
	if (this.t[m] == null || this.t[m].conf.visible != true || this.t[m].conf.transActv == true) {
		return
	}
	var g = false;
	if (this.conf.selected == m) {
		this.conf.selected = null;
		this.t[m].conf.active = false;
		this.t[m].item.className = "dhxsidebar_item";
		g = true
	}
	var c = this._getPrevVisible(m);
	var a = this._getNextVisible(m);
	var l = (g && l !== false ? (l == true ? null : l) || a || c : null);
	if (this.conf.transProp !== false) {
		this.t[m].conf.transActv = true;
		this.t[m].conf.transMode = "hide";
		this.t[m].conf.transProp = this.conf.transProp;
		this.t[m].conf.transActvId = l;
		this.t[m].conf.visible = false;
		if (this.t[m].conf.transEv != true) {
			this.t[m].item.addEventListener(this.conf.transEv, this._doOnTrEnd);
			this.t[m].conf.transEv = true
		}
		this.t[m].item.style[this.conf.transProp] = this.conf.transValue;
		this.t[m].item.className = "dhxsidebar_item dhxsidebar_item_hidden"
	} else {
		this.t[m].item.style.display = "none";
		this.t[m].conf.visible = false;
		this.t[m].cell.cell.style.visibility = "hidden";
		this.t[m].cell.cell.style.top = "-5000px";
		if (l != null) {
			this._setItemActive(l)
		}
		this._checkHeight();
		if (this.t[m].conf.remove == true) {
			this._removeItem(m)
		}
	}
};
dhtmlXSideBar.prototype._isItemVisible = function(a) {
	return (this.t[a].conf.visible == true)
};
dhtmlXCellObject.prototype.attachSidebar = function(a) {
	this.callEvent("_onBeforeContentAttach", ["sidebar"]);
	if (a == null) {
		a = {}
	}
	var c = document.createElement("DIV");
	c.style.width = "100%";
	c.style.height = "100%";
	c.style.position = "relative";
	c.style.overflow = "hidden";
	if (typeof(window.dhtmlXWindowsCell) != "undefined" && (this instanceof window.dhtmlXWindowsCell)) {} else {
		if (this.conf.skin == "dhx_skyblue") {
			c._ofs = {
				t: -1,
				r: -1,
				b: -1,
				l: -1
			}
		}
		if (this.conf.skin == "dhx_web") {
			if (typeof(window.dhtmlXSideBarCell) != "undefined" && (this instanceof window.dhtmlXSideBarCell)) {
				c._ofs = {
					l: 8
				}
			}
			if (typeof(window.dhtmlXLayoutCell) != "undefined" && (this instanceof window.dhtmlXLayoutCell)) {
				c._ofs = {
					t: 2
				}
			}
			if (typeof(window.dhtmlXTabBarCell) != "undefined" && (this instanceof window.dhtmlXTabBarCell)) {
				c._ofs = {
					t: 8
				}
			}
			if (typeof(window.dhtmlXAccordionCell) != "undefined" && (this instanceof window.dhtmlXAccordionCell)) {
				c._ofs = {
					t: 2
				}
			}
		}
		if (this.conf.skin == "dhx_terrace") {
			if (typeof(window.dhtmlXSideBarCell) != "undefined" && (this instanceof window.dhtmlXSideBarCell)) {
				c._ofs = {
					l: -1
				}
			}
			if (typeof(window.dhtmlXLayoutCell) != "undefined" && (this instanceof window.dhtmlXLayoutCell)) {
				c._ofs = {
					t: -1
				}
			}
			if (typeof(window.dhtmlXTabBarCell) != "undefined" && (this instanceof window.dhtmlXTabBarCell)) {
				c._ofs = {
					t: -1
				}
			}
			if (typeof(window.dhtmlXAccordionCell) != "undefined" && (this instanceof window.dhtmlXAccordionCell)) {
				c._ofs = {
					t: -1,
					r: -1,
					b: -1,
					l: -1
				}
			}
		}
	}
	this._attachObject(c);
	a.skin = this.conf.skin;
	a.parent = c;
	this.dataType = "sidebar";
	this.dataObj = new dhtmlXSideBar(a);
	a.parent = c = null;
	a = null;
	this.callEvent("_onContentAttach", []);
	return this.dataObj
};

function dhtmlXWindows(s) {
	var n = this;
	var l = {};
	if (typeof(s) != "undefined") {
		for (var g in s) {
			l[g] = s[g]
		}
	}
	s = null;
	this.conf = {
		skin: window.dhx4.skin || (typeof(dhtmlx) != "undefined" ? dhtmlx.skin : null) || window.dhx4.skinDetect("dhxwins") || "dhx_skyblue",
		vp_pos_ofs: 20,
		vp_custom: false,
		ofs_w: null,
		ofs_h: null,
		button_last: null,
		dblclick_tm: 300,
		dblclick_last: null,
		dblclick_id: null,
		dblclick_mode: "minmax",
		dblclick_active: false,
		dblclick_ev: (navigator.userAgent.indexOf("MSIE 6.0") >= 0 || navigator.userAgent.indexOf("MSIE 7.0") >= 0 || navigator.userAgent.indexOf("MSIE 8.0") >= 0),
		fr_cover: (navigator.userAgent.indexOf("MSIE 6.0") >= 0)
	};
	var c = window.dhx4.transDetect();
	this.conf.tr = {
		prop: c.transProp,
		ev: c.transEv,
		height_open: "height 0.2s cubic-bezier(0.25,0.1,0.25,1)",
		height_close: "height 0.18s cubic-bezier(0.25,0.1,0.25,1)",
		op_open: "opacity 0.16s ease-in",
		op_close: "opacity 0.2s ease-out",
		op_v_open: "1",
		op_v_close: "0.4"
	};
	if (!l.viewport) {
		this.attachViewportTo(document.body)
	} else {
		if (l.viewport.object != null) {
			this.attachViewportTo(l.viewport.object)
		} else {
			if (l.viewport.left != null && l.viewport.top != null && l.viewport.width != null && l.viewport.height != null) {
				this.setViewport(l.viewport.left, l.viewport.top, l.viewport.width, l.viewport.height, l.viewport.parent)
			} else {
				this.attachViewportTo(document.body)
			}
		}
	}
	this.w = {};
	this.createWindow = function(u, I, F, v, K) {
		var q = {};
		if (arguments.length == 1 && typeof(u) == "object") {
			q = u
		} else {
			q.id = u;
			q.left = I;
			q.top = F;
			q.width = v;
			q.height = K;
			if (typeof(q.id) == "undefined" || q.id == null) {
				q.id = window.dhx4.newId()
			}
			while (this.w[q.id] != null) {
				q.id = window.dhx4.newId()
			}
		}
		if (q.left == null) {
			q.left = 0
		}
		if (q.top == null) {
			q.top = 0
		}
		q.move = (q.move != null && window.dhx4.s2b(q.move) == false ? false : (q.deny_move != null && window.dhx4.s2b(q.deny_move) == true ? false : true));
		q.park = (q.park != null && window.dhx4.s2b(q.park) == false ? false : (q.deny_park != null && window.dhx4.s2b(q.deny_park) == true ? false : true));
		q.resize = (q.resize != null && window.dhx4.s2b(q.resize) == false ? false : (q.deny_resize != null && window.dhx4.s2b(q.deny_resize) == true ? false : true));
		q.keep_in_viewport = (q.keep_in_viewport != null && window.dhx4.s2b(q.keep_in_viewport));
		q.modal = (q.modal != null && window.dhx4.s2b(q.modal));
		q.center = (q.center != null && window.dhx4.s2b(q.center));
		q.text = (q.text != null ? q.text : (q.caption != null ? q.caption : "dhtmlxWindow"));
		q.header = (!(q.header != null && window.dhx4.s2b(q.header) == false));
		var L = document.createElement("DIV");
		L.className = "dhxwin_active";
		this.vp.appendChild(L);
		L._isWindow = true;
		L._idd = q.id;
		var C = document.createElement("DIV");
		C.className = "dhxwin_hdr";
		C.style.zIndex = 0;
		C.innerHTML = "<div class='dhxwin_icon'></div><div class='dhxwin_text'><div class='dhxwin_text_inside'>" + q.text + "</div></div><div class='dhxwin_btns'></div>";
		L.appendChild(C);
		C.onselectstart = function(a) {
			a = a || event;
			if (a.preventDefault) {
				a.preventDefault()
			} else {
				a.returnValue = false
			}
			return false
		};
		C.oncontextmenu = function(a) {
			a = a || event;
			a.cancelBubble = true;
			return false
		};
		C._isWinHdr = true;
		C.firstChild._isWinIcon = true;
		var w = document.createElement("DIV");
		w.className = "dhxwin_brd";
		L.appendChild(w);
		var E = document.createElement("DIV");
		E.className = "dhxwin_fr_cover";
		E.innerHTML = "<iframe class='dhxwin_fr_cover_inner' frameborder='0' border='0'></iframe><div class='dhxwin_fr_cover_inner'></div>";
		L.appendChild(E);
		this.w[q.id] = {
			win: L,
			hdr: C,
			brd: w,
			fr_cover: E,
			b: {},
			conf: {
				z_id: window.dhx4.newId(),
				actv: false,
				modal: false,
				maxed: false,
				parked: false,
				sticked: false,
				visible: true,
				header: true,
				text: q.text,
				keep_in_vp: q.keep_in_viewport,
				allow_move: q.move,
				allow_park: q.park,
				allow_resize: q.resize,
				max_w: null,
				max_h: null,
				min_w: 80,
				min_h: 80
			}
		};
		var A = {
			help: {
				title: "Help",
				visible: false
			},
			stick: {
				title: "Stick",
				visible: false
			},
			park: {
				title: "Park",
				visible: true
			},
			minmax: {
				title: "Min/Max",
				visible: true
			},
			close: {
				title: "Close",
				visible: true
			}
		};
		for (var H in A) {
			var D = new dhtmlXWindowsButton(this, q.id, H, A[H].title, false);
			if (A[H].visible == false) {
				D.hide()
			}
			C.lastChild.appendChild(D.button);
			this.w[q.id].b[H] = D;
			D = null
		}
		this._winAdjustTitle(q.id);
		this.w[q.id].win.style.zIndex = window.dhx4.zim.reserve(this.w[q.id].conf.z_id);
		var J = new dhtmlXWindowsCell(q.id, this);
		this.w[q.id].win.insertBefore(J.cell, E);
		this.w[q.id].cell = J;
		if (typeof(window.addEventListener) == "function") {
			this.w[q.id].win.addEventListener("mousedown", this._winOnMouseDown, false);
			this.w[q.id].win.addEventListener("mouseup", this._winOnMouseDown, false);
			if (this.conf.dblclick_ev) {
				this.w[q.id].win.addEventListener("dblclick", this._winOnMouseDown, false)
			}
			if (this.conf.dnd_evs != null) {
				this.w[q.id].win.addEventListener(this.conf.dnd_evs.start, this._winOnMouseDown, false);
				if (window.navigator.msPointerEnabled != true) {
					this.w[q.id].win.addEventListener(this.conf.dnd_evs.start, this._winOnMouseDown, false);
					this.w[q.id].win.addEventListener(this.conf.dnd_evs.end, this._winOnMouseDown, false)
				}
			}
		} else {
			this.w[q.id].win.attachEvent("onmousedown", this._winOnMouseDown);
			this.w[q.id].win.attachEvent("onmouseup", this._winOnMouseDown);
			if (this.conf.dblclick_ev) {
				this.w[q.id].win.attachEvent("ondblclick", this._winOnMouseDown)
			}
		}
		this._winInitFRM(q.id);
		this._winSetPosition(q.id, q.left, q.top);
		this._winSetSize(q.id, q.width, q.height);
		this._winMakeActive(q.id);
		if (q.center == true) {
			this.w[q.id].cell.center()
		}
		if (q.modal == true) {
			this.w[q.id].cell.setModal(true)
		}
		if (q.header == false) {
			this.w[q.id].cell.hideHeader()
		}
		f = L = C = w = E = J = null;
		return this.w[q.id].cell
	};
	this._winOnMouseDown = function(r) {
		r = r || event;
		var a = r.target || r.srcElement;
		var q = {
			press_type: r.type
		};
		if (r.type == "MSPointerDown") {
			n.conf.ev_skip = true
		} else {
			if (n.conf.ev_skip == true) {
				n.conf.ev_skip = false;
				a = null;
				return
			}
		}
		while (a != null && a._isWindow != true) {
			if (typeof(a.className) != "undefined" && q.mode == null) {
				if (typeof(a._buttonName) != "undefined") {
					q.mode = "button";
					q.button_name = a._buttonName
				} else {
					if (a._isWinHdr == true) {
						q.mode = "hdr"
					} else {
						if (a._isWinIcon == true) {
							q.mode = "icon"
						}
					}
				}
			}
			a = a.parentNode
		}
		if (q.mode == null) {
			q.mode = "win"
		}
		q.id = (a != null && a._isWindow == true ? a._idd : null);
		a = null;
		if (q.id != null) {
			n.callEvent("_winMouseDown", [r, q])
		}
	};
	this._winOnParkTrans = function(q) {
		if (q.stopPropagation) {
			q.stopPropagation()
		}
		var a = n.w[this._idd];
		if (q.propertyName == "opacity") {
			n._winCellClearOpacity(this._idd)
		}
		if (q.propertyName == "height" && a.conf.tr_mode == "park") {
			if (a.conf.tr_mode == "park") {
				a.win.style[n.conf.tr.prop] = "";
				if (!a.conf.parked) {
					n._winAdjustCell(this._idd);
					n._callMainEvent("onParkDown", this._idd);
					if (a.conf.keep_in_vp) {
						n._winAdjustPosition(this._idd, a.conf.x, a.conf.y)
					}
				} else {
					a.hdr.style.zIndex = 3;
					n._callMainEvent("onParkUp", this._idd)
				}
			}
		}
		a = null
	};
	this.unload = function() {
		this.conf.unloading = true;
		if (this._dndInitModule) {
			this._dndUnloadModule()
		}
		for (var q in this.w) {
			this._winClose(q)
		}
		this.w = null;
		if (this.cm != null && typeof(this._unloadContextMenu) == "function") {
			this._unloadContextMenu()
		}
		window.dhx4._eventable(this, "clear");
		this.attachViewportTo(null);
		for (var q in this.conf) {
			this.conf[q] = null;
			delete this.conf[q]
		}
		for (var q in this) {
			this[q] = null
		}
		n = q = null
	};
	window.dhx4._eventable(this);
	this.attachEvent("_winMouseDown", this._winMouseDownHandler);
	if (this._dndInitModule) {
		this._dndInitModule()
	}
	if (l.wins != null) {
		for (var o = 0; o < l.wins.length; o++) {
			var m = l.wins[o];
			this.createWindow(m)
		}
	}
	l = null;
	return this
}
dhtmlXWindows.prototype.forEachWindow = function(g) {
	for (var c in this.w) {
		g.apply(window, [this.w[c].cell])
	}
};
dhtmlXWindows.prototype.window = function(a) {
	if (this.w[a] != null) {
		return this.w[a].cell
	}
	return null
};
dhtmlXWindows.prototype.isWindow = function(a) {
	return (this.w[a] != null)
};
dhtmlXWindows.prototype.findByText = function(l) {
	var g = [];
	for (var c in this.w) {
		if ((this.w[c].cell.getText()).indexOf(String(l)) >= 0) {
			g.push(this.w[c])
		}
	}
	return g
};
dhtmlXWindows.prototype.setSkin = function(g) {
	if (g == this.conf.skin) {
		return
	}
	if (this.vp != null) {
		this.vp.className = String(this.vp.className).replace("dhxwins_vp_" + this.conf.skin, " dhxwins_vp_" + g)
	}
	for (var c in this.w) {
		this.w[c].cell._resetSizeState();
		this._winAdjustCell(c);
		this._winAdjustTitle(c)
	}
	this.conf.skin = g
};
dhtmlXWindows.prototype.getBottommostWindow = function() {
	return this._getTopBottomWin(false)
};
dhtmlXWindows.prototype.getTopmostWindow = function() {
	return this._getTopBottomWin(true)
};
dhtmlXWindows.prototype._getTopBottomWin = function(m) {
	var l = null;
	for (var c in this.w) {
		if (this.w[c].conf.visible) {
			var g = false;
			if (l != null) {
				g = l.z > this.w[c].win.style.zIndex;
				if (m) {
					g = !g
				}
			}
			if (l == null || g) {
				l = {
					win: this.w[c].cell,
					z: this.w[c].win.style.zIndex
				}
			}
		}
	}
	return (l ? l.win : null)
};
dhtmlXWindows.prototype._winMakeActive = function(g, m) {
	if (g != null && m !== true && this.w[g].conf.actv == true) {
		return
	}
	var y = [];
	var s = [{
		name: "modal",
		value: true
	}, {
		name: "sticked",
		value: true
	}, {
		name: "sticked",
		value: false
	}];
	var r = {};
	for (var c = 0; c < s.length; c++) {
		var o = s[c].name;
		var l = s[c].value;
		var A = [];
		for (var v in this.w) {
			var x = this.w[v];
			if (r[v] == null && x.conf[o] === l && x.conf.visible == true) {
				if (g != v) {
					window.dhx4.zim.clear(x.conf.z_id);
					A.push([v, Number(x.win.style.zIndex)]);
					r[v] = true
				}
			}
			x = null
		}
		A.sort(function(w, q) {
			return (w[1] < q[1] ? 1 : -1)
		});
		if (g != null && this.w[g].conf[o] === l && r[g] == null) {
			window.dhx4.zim.clear(this.w[g].conf.z_id);
			var n = [
				[g, Number(this.w[g].win.style.zIndex)]
			];
			A = n.concat(A);
			r[g] = true
		}
		y = y.concat(A)
	}
	for (var c = y.length - 1; c >= 0; c--) {
		var v = y[c][0];
		var x = this.w[v];
		x.win.style.zIndex = window.dhx4.zim.reserve(x.conf.z_id);
		if (x.conf.modal && this.mcover != null) {
			for (var u in this.mcover) {
				this.mcover[u].style.zIndex = x.win.style.zIndex
			}
		}
		this._winAdjustFRMZIndex(v);
		if (g == null && c == 0) {
			g = v
		}
		x.conf.actv = (g == v);
		x.win.className = (x.conf.actv ? "dhxwin_active" : "dhxwin_inactive");
		x = null
	}
	if (g != null && this.conf.last_active != g) {
		this._callMainEvent("onFocus", g)
	}
	this.conf.last_active = g
};
dhtmlXWindows.prototype._vpPull = {};
dhtmlXWindows.prototype._vpPullAdd = function() {
	if (this.vp == null) {
		return
	}
	var g = null;
	for (var c in this._vpPull) {
		if (this._vpPull[c].vp == this.vp) {
			this._vpPull[c].count++;
			g = c
		}
	}
	if (g == null) {
		this._vpPull[window.dhx4.newId()] = {
			vp: this.vp,
			count: 1
		}
	}
};
dhtmlXWindows.prototype._vpPullRemove = function() {
	if (this.vp == null) {
		return 0
	}
	var g = 0;
	for (var c in this._vpPull) {
		if (this._vpPull[c].vp == this.vp) {
			g = --this._vpPull[c].count;
			if (g == 0) {
				this._vpPull[c].vp = null;
				this._vpPull[c].count = null;
				delete this._vpPull[c]
			}
		}
	}
	return g
};
dhtmlXWindows.prototype.attachViewportTo = function(m) {
	var g = this._vpPullRemove();
	if (this.conf.vp_custom) {
		while (this.vp.childNodes.length > 0) {
			this.vp.removeChild(this.vp.lastChild)
		}
		this.vp.parentNode.removeChild(this.vp);
		this.vp = null
	} else {
		if (this.vp != null && g == 0) {
			this.vp.className = String(this.vp.className).replace(new RegExp("\\s{1,}dhxwins_vp_" + this.conf.skin), "")
		}
	}
	if (m == null) {
		this.vp = null
	} else {
		this.vp = (typeof(m) == "string" ? document.getElementById(m) : m);
		var l = "dhxwins_vp_" + this.conf.skin;
		if (this.vp.className.indexOf(l) < 0) {
			this.vp.className += " " + l
		}
		m = null;
		for (var c in this.w) {
			this.vp.appendChild(this.w[c].win)
		}
		this.conf.vp_custom = false
	}
	if (this.vp == document.body) {
		document.body.style.position = "static"
	}
	this._vpPullAdd()
};
dhtmlXWindows.prototype.setViewport = function(c, n, l, a, m) {
	var g = document.createElement("DIV");
	g.style.position = "absolute";
	g.style.left = c + "px";
	g.style.top = n + "px";
	g.style.width = l + "px";
	g.style.height = a + "px";
	if (typeof(m) == "undefined" || m == null) {
		m = document.body
	} else {
		if (typeof(m) == "string") {
			m = document.getElementById(m)
		}
	}
	m.appendChild(g);
	this.attachViewportTo(g);
	this.conf.vp_custom = true;
	m = g = null
};
dhtmlXWindows.prototype._winSetPosition = function(l, a, g) {
	var c = this.w[l];
	if (c.conf.maxed) {
		c.conf.lastMX += (a - c.conf.x);
		c.conf.lastMY += (g - c.conf.y)
	}
	c.conf.x = a;
	c.conf.y = g;
	c.win.style.left = c.conf.x + "px";
	c.win.style.top = c.conf.y + "px";
	this._winAdjustFRMPosition(l);
	c = null
};
dhtmlXWindows.prototype._winAdjustPosition = function(o, c, n) {
	var g = this.w[o];
	if (typeof(c) == "undefined") {
		c = g.conf.x
	}
	if (typeof(n) == "undefined") {
		n = g.conf.y
	}
	var a = (g.conf.keep_in_vp ? 0 : -g.conf.w + this.conf.vp_pos_ofs);
	var m = (g.conf.keep_in_vp ? this.vp.clientWidth - g.conf.w : this.vp.clientWidth - this.conf.vp_pos_ofs);
	if (c < a) {
		c = a
	} else {
		if (c > m) {
			c = m
		}
	}
	var l = (g.conf.keep_in_vp ? this.vp.clientHeight - g.conf.h : this.vp.clientHeight - this.conf.vp_pos_ofs);
	if (n < 0) {
		n = 0
	} else {
		if (n > l) {
			n = l
		}
	}
	if (c != g.conf.x || n != g.conf.y) {
		this._winSetPosition(o, c, n)
	}
	g = null
};
dhtmlXWindows.prototype._winSetSize = function(q, n, g, o, c) {
	var l = this.w[q];
	var a = (n != null ? n : l.conf.w);
	var m = (g != null ? g : l.conf.h);
	if (this.conf.ofs_w == null) {
		l.win.style.width = a + "px";
		l.win.style.height = m + "px";
		this.conf.ofs_w = l.win.offsetWidth - a;
		this.conf.ofs_h = l.win.offsetHeight - m
	}
	if (l.conf.min_w != null && a < l.conf.min_w) {
		a = l.conf.min_w
	}
	if (l.conf.max_w != null && a > l.conf.max_w) {
		a = l.conf.max_w
	}
	if (!l.conf.parked && l.conf.min_h != null && m < l.conf.min_h) {
		m = l.conf.min_h
	}
	if (l.conf.max_h != null && m > l.conf.max_h) {
		m = l.conf.max_h
	}
	if (l.conf.keep_in_vp) {
		if (a > this.vp.clientWidth) {
			a = this.vp.clientWidth
		}
		if (m > this.vp.clientHeight) {
			m = this.vp.clientHeight
		}
	}
	l.win.style.width = a - this.conf.ofs_w + "px";
	l.win.style.height = m - this.conf.ofs_h + "px";
	l.conf.w = a;
	l.conf.h = m;
	this._winAdjustFRMSize(q);
	if (c) {
		this._winAdjustPosition(q, l.conf.x, l.conf.y)
	}
	if (!l.conf.parked && o != true) {
		this._winAdjustCell(q)
	}
	l = null
};
dhtmlXWindows.prototype._winMinmax = function(m, g) {
	if (typeof(g) != "undefined" && this.w[m].conf.maxed == g) {
		return
	}
	if (this.w[m].conf.allow_resize == false) {
		return
	}
	var c = this.w[m];
	if (c.conf.parked) {
		this._winPark(m, false)
	}
	if (c.conf.maxed) {
		this._winSetSize(m, c.conf.lastMW, c.conf.lastMH);
		this._winAdjustPosition(m, c.conf.lastMX, c.conf.lastMY);
		c.conf.maxed = false
	} else {
		var a = 0;
		var l = 0;
		if (c.conf.max_w != null) {
			a = c.conf.x + Math.round(c.conf.w - c.conf.max_w) / 2
		}
		if (c.conf.max_h != null) {
			l = Math.max(c.conf.y + Math.round(c.conf.h - c.conf.max_h) / 2, 0)
		}
		c.conf.lastMX = c.conf.x;
		c.conf.lastMY = c.conf.y;
		c.conf.lastMW = c.conf.w;
		c.conf.lastMH = c.conf.h;
		this._winSetSize(m, this.vp.clientWidth, this.vp.clientHeight);
		this._winAdjustPosition(m, a, l);
		c.conf.maxed = true
	}
	c.b.minmax.setCss(c.conf.maxed ? "minmaxed" : "minmax");
	if (c.conf.maxed) {
		this._callMainEvent("onMaximize", m)
	} else {
		this._callMainEvent("onMinimize", m)
	}
	c = null
};
dhtmlXWindows.prototype._winShow = function(c, a) {
	if (this.w[c].conf.visible == true) {
		return
	}
	this.w[c].win.style.display = "";
	this.w[c].conf.visible = true;
	if (a == true || this.conf.last_active == null) {
		this._winMakeActive(c, true)
	}
	this._callMainEvent("onShow", c)
};
dhtmlXWindows.prototype._winHide = function(c, a) {
	if (this.w[c].conf.visible == false) {
		return
	}
	this.w[c].win.style.display = "none";
	this.w[c].conf.visible = false;
	if (this.w[c].conf.actv) {
		this.w[c].conf.actv = false;
		this.w[c].win.className = "dhxwin_inactive";
		this._winMakeActive(null, true)
	}
	this._callMainEvent("onHide", c)
};
dhtmlXWindows.prototype._winPark = function(g, a) {
	if (this.w[g].conf.allow_park == false) {
		return
	}
	if (this.w[g].conf.header == false) {
		return
	}
	var c = this.w[g];
	if (a == true && this.conf.tr.prop !== false) {
		c.win.style[this.conf.tr.prop] = this.conf.tr[c.conf.parked ? "height_open" : "height_close"];
		if (!c.conf.tr_ev) {
			c.win.addEventListener(this.conf.tr.ev, this._winOnParkTrans, false);
			c.conf.tr_ev = true
		}
	}
	if (c.conf.parked) {
		c.hdr.className = String(c.hdr.className).replace(/\s{1,}dhxwin_hdr_parked/gi, "");
		c.hdr.style.zIndex = 0;
		c.conf.parked = false;
		c.conf.tr_mode = "park";
		this._winCellSetOpacity(g, "open", a);
		this._winSetSize(g, c.conf.w, c.conf.lastPH, (a == true && this.conf.tr.prop !== false));
		if (!(a == true && this.conf.tr.prop !== false)) {
			this._callMainEvent("onParkDown", g);
			if (c.conf.keep_in_vp) {
				this._winAdjustPosition(g, c.conf.x, c.conf.y)
			}
		}
		if (window.dhx4.isIE8 == true && this.conf.tr.prop == false && c.cell.cell.className.match(/dhxwin_parked/) != null) {
			c.cell.cell.className = c.cell.cell.className.replace(/\s{0,}dhxwin_parked/gi, "")
		}
	} else {
		c.conf.lastPH = c.conf.h;
		c.hdr.className += " dhxwin_hdr_parked";
		if (a == false || this.conf.tr.prop == false) {
			c.hdr.style.zIndex = 3
		}
		c.conf.parked = true;
		c.conf.tr_mode = "park";
		this._winCellSetOpacity(g, "close", a);
		this._winSetSize(g, c.conf.w, c.hdr.offsetHeight + this.conf.ofs_h, (a == true && this.conf.tr.prop !== false));
		if (!(a == true && this.conf.tr.prop !== false)) {
			this._callMainEvent("onParkUp", g)
		}
		if (window.dhx4.isIE8 == true && this.conf.tr.prop == false && c.cell.cell.className.match(/dhxwin_parked/) == null) {
			c.cell.cell.className += " dhxwin_parked"
		}
	}
	c = null
};
dhtmlXWindows.prototype._winCellSetOpacity = function(o, n, g, m) {
	var c = this.w[o].cell;
	for (var l in c.conf.idx) {
		if ({
				pr1: true,
				pr2: true
			}[l] != true) {
			if (g == true && this.conf.tr.prop != false) {
				c.cell.childNodes[c.conf.idx[l]].style[this.conf.tr.prop] = this.conf.tr["op_" + n]
			}
			c.cell.childNodes[c.conf.idx[l]].style.opacity = this.conf.tr["op_v_" + n]
		}
	}
	c = null
};
dhtmlXWindows.prototype._winCellClearOpacity = function(l) {
	var c = this.w[l].cell;
	for (var g in c.conf.idx) {
		if ({
				pr1: true,
				pr2: true
			}[g] != true) {
			if (this.conf.tr.prop != false) {
				c.cell.childNodes[c.conf.idx[g]].style[this.conf.tr.prop] = ""
			}
		}
	}
	c = null
};
dhtmlXWindows.prototype._winStick = function(c, a) {
	if (typeof(a) != "undefined" && this.w[c].conf.sticked == a) {
		return
	}
	this.w[c].conf.sticked = !this.w[c].conf.sticked;
	this.w[c].b.stick.setCss(this.w[c].conf.sticked ? "sticked" : "stick");
	this._winMakeActive(this.conf.last_active, true);
	if (this.w[c].conf.sticked) {
		this._callMainEvent("onStick", c)
	} else {
		this._callMainEvent("onUnStick", c)
	}
};
dhtmlXWindows.prototype._winClose = function(l) {
	if (this._callMainEvent("onClose", l) !== true && this.conf.unloading != true) {
		return
	}
	var g = this.w[l];
	if (g.conf.fs_mode) {
		g.cell.setToFullScreen(false)
	}
	if (g.conf.modal) {
		this._winSetModal(l, false)
	}
	window.dhx4.zim.clear(g.conf.z_id);
	if (this.cm != null && this.cm.icon[l] != null) {
		this._detachContextMenu("icon", l, null)
	}
	if (typeof(window.addEventListener) == "function") {
		g.win.removeEventListener("mousedown", this._winOnMouseDown, false);
		g.win.removeEventListener("mouseup", this._winOnMouseDown, false);
		if (this.conf.dblclick_ev) {
			g.win.removeEventListener("dblclick", this._winOnMouseDown, false)
		}
		if (this.conf.dnd_evs != null) {
			g.win.removeEventListener(this.conf.dnd_evs.start, this._winOnMouseDown, false);
			if (window.navigator.msPointerEnabled != true) {
				g.win.removeEventListener(this.conf.dnd_evs.start, this._winOnMouseDown, false);
				g.win.removeEventListener(this.conf.dnd_evs.end, this._winOnMouseDown, false)
			}
		}
	} else {
		g.win.detachEvent("onmousedown", this._winOnMouseDown);
		g.win.detachEvent("onmouseup", this._winOnMouseDown);
		if (this.conf.dblclick_ev) {
			g.win.attachEvent("ondblclick", this._winOnMouseDown)
		}
	}
	for (var c in g.b) {
		this._winRemoveButton(l, c, true)
	}
	g.b = null;
	g.cell._unload();
	g.cell = null;
	g.brd.parentNode.removeChild(g.brd);
	g.brd = null;
	if (g.fr_cover != null) {
		g.fr_cover.parentNode.removeChild(g.fr_cover);
		g.fr_cover = null
	}
	if (g.fr_m_cover != null) {
		g.fr_m_cover.parentNode.removeChild(g.fr_m_cover);
		g.fr_m_cover = null
	}
	g.hdr._isWinHdr = true;
	g.hdr.firstChild._isWinIcon = true;
	g.hdr.onselectstart = null;
	g.hdr.parentNode.removeChild(g.hdr);
	g.hdr = null;
	for (var c in g.conf) {
		g.conf[c] = null;
		delete g.conf[c]
	}
	g.conf = null;
	g.win._idd = null;
	g.win._isWindow = null;
	g.win.parentNode.removeChild(g.win);
	g.win = null;
	g = null;
	this.w[l] = null;
	delete this.w[l];
	if (!this.conf.unloading) {
		this._winMakeActive(null, true)
	}
};
dhtmlXWindows.prototype._winSetModal = function(o, l, n) {
	if (this.w[o].conf.modal == l) {
		return
	}
	if (typeof(n) == "undefined") {
		n = true
	}
	var g = this.w[o];
	if (l == true && g.conf.modal == false) {
		if (this.conf.last_modal != null) {
			this._winSetModal(this.conf.last_modal, false, false)
		}
		if (this.mcover == null) {
			var m = document.createElement("DIV");
			m.className = "dhxwins_mcover";
			this.vp.insertBefore(m, g.fr_m_cover || g.win);
			this.mcover = {
				d: m
			};
			if (this.conf.fr_cover) {
				this.mcover.f = document.createElement("IFRAME");
				this.mcover.f.className = "dhxwins_mcover";
				this.mcover.f.border = 0;
				this.mcover.f.frameBorder = 0;
				this.vp.insertBefore(this.mcover.f, m)
			}
			m = null
		} else {
			if (this.mcover.d.nextSibling != (g.fr_m_cover || g.win)) {
				this.vp.insertBefore(this.mcover.d, g.fr_m_cover || g.win);
				if (this.mcover.f != null) {
					this.vp.insertBefore(this.mcover.f, this.mcover.d)
				}
			}
		}
		g.conf.modal = true;
		this.conf.last_modal = o;
		this._winMakeActive(o, true)
	} else {
		if (l == false && g.conf.modal == true) {
			g.conf.modal = false;
			this.conf.last_modal = null;
			if (n && this.mcover != null) {
				for (var c in this.mcover) {
					this.vp.removeChild(this.mcover[c]);
					this.mcover[c] = null
				}
				this.mcover = null
			}
		}
	}
	g = null
};
dhtmlXWindows.prototype._winMouseDownHandler = function(g, c) {
	var a = g.target || g.srcElement;
	if (g.button >= 2) {
		return
	}
	if (c.mode == "button") {
		if (c.press_type == "mousedown") {
			this.conf.button_last = c.button_name
		} else {
			if ((c.press_type == "mouseup" && c.button_name == this.conf.button_last) || c.press_type == "MSPointerDown") {
				this.conf.button_last = null;
				if (this._winButtonClick(c.id, c.button_name, g) !== true) {
					return
				}
			}
		}
	}
	if ((c.press_type == "mousedown" || c.press_type == "dblclick") && c.mode == "hdr") {
		this.conf.dblclick_active = false;
		if (this.conf.dblclick_ev == true) {
			if (c.press_type == "dblclick") {
				this.conf.dblclick_active = true
			}
		} else {
			if (this.conf.dblclick_last == null) {
				this.conf.dblclick_last = new Date().getTime();
				this.dblclick_id = c.id
			} else {
				var a = new Date().getTime();
				if (this.conf.dblclick_last + this.conf.dblclick_tm > a && this.dblclick_id == c.id) {
					this.conf.dblclick_active = true;
					this.conf.dblclick_last = null;
					this.dblclick_id = null
				} else {
					this.conf.dblclick_last = a;
					this.dblclick_id = c.id
				}
			}
		}
		if (this.conf.dblclick_active) {
			this._winDoHeaderDblClick(c.id);
			return
		}
	}
	if (c.press_type == "mousedown" || (this.conf.dnd_evs != null && c.press_type == this.conf.dnd_evs.start)) {
		this._winMakeActive(c.id)
	}
	if (c.press_type == "touchend") {}
};
dhtmlXWindows.prototype._winDoHeaderDblClick = function(a) {
	if (this.conf.dblclick_mode == "minmax") {
		this._winMinmax(a);
		return
	}
	if (this.conf.dblclick_mode == "park") {
		this._winPark(a, true);
		return
	}
	if (typeof(this.conf.dblclick_mode) == "function") {
		this.conf.dblclick_mode.apply(window, [a]);
		return
	}
	if (typeof(window[this.conf.dblclick_mode]) == "function") {
		window[this.conf.dblclick_mode].apply(window, [a]);
		return
	}
};
dhtmlXWindows.prototype._winAdjustCell = function(c) {
	var s = this.w[c];
	var r = 1;
	var q = (s.conf.header ? s.hdr.offsetHeight : 1);
	var l = s.win.clientWidth - 2;
	var u = s.win.clientHeight - q - 1;
	s.brd.style.left = r + "px";
	s.brd.style.top = q + "px";
	if (s.conf.brd == null) {
		s.brd.style.width = l + "px";
		s.brd.style.height = u + "px";
		s.conf.brd = {
			w: l - s.brd.offsetWidth,
			h: u - s.brd.offsetHeight
		}
	}
	s.brd.style.width = l + s.conf.brd.w + "px";
	s.brd.style.height = u + s.conf.brd.h + "px";
	var g = 5;
	var a = 1 + g;
	var o = (s.conf.header ? q : q + g);
	var m = s.brd.clientWidth;
	var n = s.brd.clientHeight;
	s.cell._setSize(a, o, m, n);
	s.fr_cover.style.left = a + "px";
	s.fr_cover.style.top = o + "px";
	s.fr_cover.style.width = m + "px";
	s.fr_cover.style.height = n + "px";
	s = null
};
dhtmlXWindows.prototype._winAdjustTitle = function(l) {
	var a = this.w[l].hdr.childNodes[0];
	var g = this.w[l].hdr.childNodes[1];
	var c = this.w[l].hdr.childNodes[2];
	g.style.paddingLeft = a.offsetWidth + 12 + "px";
	g.style.paddingRight = c.offsetWidth + 10 + "px";
	g = c = a = null
};
dhtmlXWindows.prototype._callMainEvent = function(c, l) {
	var a = this.w[l];
	if (a.cell.checkEvent(c)) {
		var g = a.cell._callMainEvent(c, [a.cell])
	} else {
		var g = this.callEvent(c, [a.cell])
	}
	a = null;
	return g
};
dhtmlXWindows.prototype._winInitFRM = function(g) {
	if (this.conf.fr_cover != true) {
		return
	}
	var a = this.w[g];
	var c = document.createElement("IFRAME");
	c.className = "dhxwin_main_fr_cover";
	c.border = 0;
	c.frameBorder = 0;
	c.style.zIndex = a.win.style.zIndex;
	a.win.parentNode.insertBefore(c, a.win);
	a.fr_m_cover = c;
	c = null
};
dhtmlXWindows.prototype._winAdjustFRMSize = function(c) {
	var a = this.w[c];
	if (a.fr_m_cover != null) {
		a.fr_m_cover.style.width = a.conf.w + "px";
		a.fr_m_cover.style.height = a.conf.h + "px"
	}
	a = null
};
dhtmlXWindows.prototype._winAdjustFRMPosition = function(c) {
	var a = this.w[c];
	if (a.fr_m_cover != null) {
		a.fr_m_cover.style.left = a.win.style.left;
		a.fr_m_cover.style.top = a.win.style.top
	}
	a = null
};
dhtmlXWindows.prototype._winAdjustFRMZIndex = function(c) {
	var a = this.w[c];
	if (a.fr_m_cover != null) {
		a.fr_m_cover.style.zIndex = a.win.style.zIndex
	}
	a = null
};

function dhtmlXWindowsCell(m, l) {
	dhtmlXCellObject.apply(this, [m, "_wins"]);
	this.wins = l;
	this.cell._winId = m;
	this.conf.skin = this.wins.conf.skin;
	this.attachEvent("_onCellUnload", function() {
		if (this._unloadResize) {
			this._unloadResize()
		}
		window.dhx4._eventable(this.cell, "clear");
		this.cell._winId = null;
		this.wins = null;
		this.setText = null;
		this.getText = null;
		this.allowMove = null;
		this.denyMove = null;
		this.isMovable = null;
		this.allowResize = null;
		this.denyResize = null;
		this.isResizable = null;
		this.maximize = null;
		this.minimize = null;
		this.isMaximized = null;
		this.setPosition = null;
		this.getPosition = null;
		this.adjustPosition = null;
		this.park = null;
		this.isParked = null;
		this.allowPark = null;
		this.denyPark = null;
		this.isParkable = null;
		this.show = null;
		this.hide = null;
		this.isHidden = null;
		this.stick = null;
		this.unstick = null;
		this.isSticked = null;
		this.setDimension = null;
		this.getDimension = null;
		this.setMinDimension = null;
		this.getMinDimension = null;
		this.setMaxDimension = null;
		this.getMaxDimension = null;
		this.keepInViewport = null;
		this.center = null;
		this.centerOnScreen = null;
		this.bringToTop = null;
		this.bringToBottom = null;
		this.isOnTop = null;
		this.isOnBottom = null;
		this.showHeader = null;
		this.hideHeader = null;
		this.setModal = null;
		this.isModal = null;
		this.close = null;
		this._adjustByCont = null;
		this.button = null;
		this.addUserButton = null;
		this.removeUserButton = null;
		g = null
	});
	this.attachEvent("_onContentLoaded", function() {
		this.wins._callMainEvent("onContentLoaded", this._idd)
	});
	this.attachEvent("_onContentMouseDown", function(n, a) {
		this.wins.callEvent("_winMouseDown", [a, {
			id: n,
			mode: "win"
		}])
	});
	this._callMainEvent = function(n, a) {
		return this.callEvent(n, a)
	};
	this.conf.tr = {};
	for (var c in this.wins.conf.tr) {
		this.conf.tr[c] = this.wins.conf.tr[c]
	}
	if (this.conf.tr.prop != false) {}
	if (this._initResize) {
		this._initResize()
	}
	window.dhx4._eventable(this.cell);
	var g = this;
	this.cell.attachEvent("_setCellSize", function(a, q) {
		var n = g.wins.w[this._winId].conf.w - g.conf.size.w;
		var o = g.wins.w[this._winId].conf.h - g.conf.size.h;
		g.setDimension(a + n, q + o)
	});
	return this
}
dhtmlXWindowsCell.prototype = new dhtmlXCellObject();
dhtmlXWindowsCell.prototype.setText = function(a) {
	this.wins.w[this._idd].conf.text = a;
	this.wins.w[this._idd].hdr.childNodes[1].firstChild.innerHTML = a
};
dhtmlXWindowsCell.prototype.getText = function() {
	return this.wins.w[this._idd].conf.text
};
dhtmlXWindowsCell.prototype.allowMove = function() {
	this.wins.w[this._idd].conf.allow_move = true
};
dhtmlXWindowsCell.prototype.denyMove = function() {
	this.wins.w[this._idd].conf.allow_move = false
};
dhtmlXWindowsCell.prototype.isMovable = function() {
	return (this.wins.w[this._idd].conf.allow_move == true)
};
dhtmlXWindowsCell.prototype.allowResize = function() {
	this.wins.w[this._idd].conf.allow_resize = true;
	this.wins.w[this._idd].b.minmax.enable()
};
dhtmlXWindowsCell.prototype.denyResize = function() {
	this.wins.w[this._idd].conf.allow_resize = false;
	this.wins.w[this._idd].b.minmax.disable()
};
dhtmlXWindowsCell.prototype.isResizable = function() {
	return (this.wins.w[this._idd].conf.allow_resize == true)
};
dhtmlXWindowsCell.prototype.maximize = function() {
	this.wins._winMinmax(this._idd, true)
};
dhtmlXWindowsCell.prototype.minimize = function() {
	this.wins._winMinmax(this._idd, false)
};
dhtmlXWindowsCell.prototype.isMaximized = function() {
	return (this.wins.w[this._idd].conf.maxed == true)
};
dhtmlXWindowsCell.prototype.setPosition = function(a, c) {
	this.wins._winSetPosition(this._idd, a, c)
};
dhtmlXWindowsCell.prototype.getPosition = function() {
	var a = this.wins.w[this._idd];
	var c = [a.conf.x, a.conf.y];
	a = null;
	return c
};
dhtmlXWindowsCell.prototype.adjustPosition = function() {
	this.wins._winAdjustPosition(this._idd)
};
dhtmlXWindowsCell.prototype.park = function() {
	this.wins._winPark(this._idd, true)
};
dhtmlXWindowsCell.prototype.isParked = function() {
	return (this.wins.w[this._idd].conf.parked == true)
};
dhtmlXWindowsCell.prototype.allowPark = function() {
	this.wins.w[this._idd].conf.allow_park = true;
	this.wins.w[this._idd].b.park.enable()
};
dhtmlXWindowsCell.prototype.denyPark = function() {
	this.wins.w[this._idd].conf.allow_park = false;
	this.wins.w[this._idd].b.park.disable()
};
dhtmlXWindowsCell.prototype.isParkable = function() {
	return (this.wins.w[this._idd].conf.allow_park == true)
};
dhtmlXWindowsCell.prototype.show = function(a) {
	this.wins._winShow(this._idd, window.dhx4.s2b(a))
};
dhtmlXWindowsCell.prototype.hide = function() {
	this.wins._winHide(this._idd)
};
dhtmlXWindowsCell.prototype.isHidden = function() {
	return (this.wins.w[this._idd].conf.visible != true)
};
dhtmlXWindowsCell.prototype.stick = function() {
	this.wins._winStick(this._idd, true)
};
dhtmlXWindowsCell.prototype.unstick = function() {
	this.wins._winStick(this._idd, false)
};
dhtmlXWindowsCell.prototype.isSticked = function() {
	return (this.wins.w[this._idd].conf.sticked == true)
};
dhtmlXWindowsCell.prototype.setDimension = function(g, a) {
	var c = this.wins.w[this._idd];
	if (c.conf.parked) {
		this.wins._winPark(this._idd, false)
	}
	if (c.conf.maxed) {
		if (g != null) {
			c.conf.lastMW = g
		}
		if (a != null) {
			c.conf.lastMH = a
		}
		this.wins._winMinmax(this._idd)
	} else {
		this.wins._winSetSize(this._idd, g, a, false, true)
	}
	c = null
};
dhtmlXWindowsCell.prototype.getDimension = function() {
	var a = this.wins.w[this._idd];
	var c = [a.conf.w, a.conf.h];
	a = null;
	return c
};
dhtmlXWindowsCell.prototype.setMinDimension = function(g, a) {
	var c = this.wins.w[this._idd];
	c.conf.min_w = g;
	c.conf.min_h = a;
	this.wins._winSetSize(this._idd, c.conf.w, c.conf.h);
	c = null
};
dhtmlXWindowsCell.prototype.getMinDimension = function() {
	var a = this.wins.w[this._idd];
	var c = [a.conf.min_w, a.conf.min_h];
	a = null;
	return c
};
dhtmlXWindowsCell.prototype.setMaxDimension = function(g, a) {
	var c = this.wins.w[this._idd];
	c.conf.max_w = g;
	c.conf.max_h = a;
	this.wins._winSetSize(this._idd, c.conf.w, c.conf.h);
	c = null
};
dhtmlXWindowsCell.prototype.getMaxDimension = function() {
	var a = this.wins.w[this._idd];
	var c = [a.conf.max_w, a.conf.max_h];
	a = null;
	return c
};
dhtmlXWindowsCell.prototype.keepInViewport = function(a) {
	this.wins.w[this._idd].conf.keep_in_vp = window.dhx4.s2b(a)
};
dhtmlXWindowsCell.prototype.center = function() {
	var g = this.wins.vp;
	var c = this.wins.w[this._idd];
	var a = Math.round((g.clientWidth - c.conf.w) / 2);
	var l = Math.round((g.clientHeight - c.conf.h) / 2);
	this.wins._winSetPosition(this._idd, a, l);
	g = c = null
};
dhtmlXWindowsCell.prototype.centerOnScreen = function() {
	var c = this.wins.w[this._idd];
	var n = window.dhx4.screenDim();
	var m = window.dhx4.absLeft(this.wins.vp);
	var l = window.dhx4.absTop(this.wins.vp);
	var g = this.wins.vp.parentNode;
	while (g != null) {
		if (g.scrollLeft) {
			m = m - g.scrollLeft
		}
		if (g.scrollTop) {
			l = l - g.scrollTop
		}
		g = g.parentNode
	}
	var a = Math.round((n.right - n.left - c.conf.w) / 2);
	var o = Math.round((n.bottom - n.top - c.conf.h) / 2);
	this.wins._winAdjustPosition(this._idd, a - m, o - l);
	d = c = null
};
dhtmlXWindowsCell.prototype.bringToTop = function() {
	this.wins._winMakeActive(this._idd, true)
};
dhtmlXWindowsCell.prototype.bringToBottom = function() {
	var a = (this.wins.w[this._idd].conf.actv ? null : this.wins.conf.last_active);
	window.dhx4.zim.clear(this.wins.w[this._idd].conf.z_id);
	this.wins.w[this._idd].win.style.zIndex = 0;
	this.wins._winMakeActive(a, true)
};
dhtmlXWindowsCell.prototype.isOnTop = function() {
	return (this.wins.w[this._idd].conf.actv == true)
};
dhtmlXWindowsCell.prototype.isOnBottom = function() {
	var g = {
		id: null,
		z: +Infinity
	};
	for (var c in this.wins.w) {
		if (this.wins.w[c].conf.visible && this.wins.w[c].win.style.zIndex < g.z) {
			g.id = c;
			g.z = this.wins.w[c].win.style.zIndex
		}
	}
	return (g.id == this._idd)
};
dhtmlXWindowsCell.prototype.showHeader = function() {
	var a = this.wins.w[this._idd];
	if (a.conf.header == false) {
		a.hdr.className = String(a.hdr.className).replace(/\s{0,}dhxwin_hdr_hidden/gi, "");
		a.brd.className = String(a.brd.className).replace(/\s{0,}dhxwin_hdr_hidden/gi, "");
		this.conf.cells_cont = null;
		a.conf.brd = null;
		a.conf.header = true;
		this.wins._winAdjustCell(this._idd)
	}
	a = null
};
dhtmlXWindowsCell.prototype.hideHeader = function() {
	var a = this.wins.w[this._idd];
	if (a.conf.header == true) {
		if (a.conf.parked) {
			this.wins._winPark(this._idd, false)
		}
		a.hdr.className += " dhxwin_hdr_hidden";
		a.brd.className += " dhxwin_hdr_hidden";
		this.conf.cells_cont = null;
		a.conf.brd = null;
		a.conf.header = false;
		this.wins._winAdjustCell(this._idd)
	}
	a = null
};
dhtmlXWindowsCell.prototype.setModal = function(a) {
	this.wins._winSetModal(this._idd, window.dhx4.s2b(a))
};
dhtmlXWindowsCell.prototype.isModal = function() {
	return (this.wins.w[this._idd].conf.modal == true)
};
dhtmlXWindowsCell.prototype._adjustByCont = function(a, c) {
	a += this.wins.w[this._idd].conf.w - this.conf.size.w;
	c += this.wins.w[this._idd].conf.h - this.conf.size.h;
	this.wins._winSetSize(this._idd, a, c)
};
dhtmlXWindowsCell.prototype.close = function() {
	this.wins._winClose(this._idd)
};
dhtmlXWindowsCell.prototype.setIconCss = function(a) {
	this.wins.w[this._idd].hdr.firstChild.className = "dhxwin_icon " + a;
	this.wins._winAdjustTitle(this._idd)
};
dhtmlXWindowsCell.prototype.setToFullScreen = function(c) {
	c = window.dhx4.s2b(c);
	var a = this.wins.w[this._idd];
	if (a.conf.fs_mode == c) {
		a = null;
		return
	}
	if (this.wins.fsn == null) {
		this.wins.fsn = document.createElement("DIV");
		this.wins.fsn.className = this.wins.vp.className + " dhxwins_vp_fs";
		document.body.appendChild(this.wins.fsn)
	}
	if (c) {
		this.wins.fsn.appendChild(a.win);
		this.maximize();
		this.hideHeader()
	} else {
		this.wins.vp.appendChild(a.win);
		this.minimize();
		this.showHeader();
		if (this.wins.fsn.childNodes.length == 0) {
			this.wins.fsn.parentNode.removeChild(this.wins.fsn);
			this.wins.fsn = null
		}
	}
	a.conf.fs_mode = c;
	a = null
};
dhtmlXWindowsCell.prototype.button = function(a) {
	if (a == "minmax1" || a == "minmax2") {
		a = "minmax"
	}
	return this.wins.w[this._idd].b[a]
};
dhtmlXWindowsCell.prototype.addUserButton = function(o, m, g) {
	var a = new dhtmlXWindowsButton(this.wins, this._idd, o, g, true);
	var l = null;
	var c = this.wins.w[this._idd].hdr.lastChild;
	if (isNaN(m)) {
		m = 0
	} else {
		if (m < 0) {
			m = 0
		}
	}
	if (c.childNodes[m] != null) {
		l = c.childNodes[m]
	}
	if (l != null) {
		c.insertBefore(a.button, l)
	} else {
		c.appendChild(a.button)
	}
	this.wins.w[this._idd].b[o] = a;
	a = l = c = null;
	this.wins._winAdjustTitle(this._idd)
};
dhtmlXWindowsCell.prototype.removeUserButton = function(a) {
	if (this.wins.w[this._idd].b[a] == null || this.wins.w[this._idd].b[a].conf.custom != true) {
		return
	}
	this.wins._winRemoveButton(this._idd, a)
};
window.dhtmlXWindowsButton = function(m, c, a, l, g) {
	this.conf = {
		wins: m,
		winId: c,
		name: a,
		enabled: true,
		visible: true,
		custom: true
	};
	this.button = document.createElement("DIV");
	this.button._buttonName = a;
	this.button.title = l;
	this.enable = function() {
		this.conf.enabled = true;
		this.setCss(this.conf.css)
	};
	this.disable = function() {
		this.conf.enabled = false;
		this.setCss(this.conf.css)
	};
	this.isEnabled = function() {
		return (this.conf.enabled == true)
	};
	this.show = function() {
		this.button.style.display = "";
		this.conf.visible = true;
		this.conf.wins._winAdjustTitle(this.conf.winId)
	};
	this.hide = function() {
		this.button.style.display = "none";
		this.conf.visible = false;
		this.conf.wins._winAdjustTitle(this.conf.winId)
	};
	this.isHidden = function() {
		return (this.conf.visible == false)
	};
	this.setCss = function(o) {
		this.conf.css = o;
		var n = (this.conf.enabled ? "" : "_dis");
		this.button.className = "dhxwin_button" + n + " dhxwin_button_" + this.conf.css + n
	};
	this._doOnClick = function(n) {
		return this.callEvent("onClick", [this.conf.wins.w[this.conf.winId].cell, this])
	};
	this.unload = function(n) {
		dhx4._eventable(this, "clear");
		this.button._buttonName = null;
		this.button.parentNode.removeChild(this.button);
		if (this.conf.wins.cm != null && this.conf.wins.cm.button[this.conf.winId] != null && this.conf.wins.cm.button[this.conf.winId][this.conf.name] != null) {
			this.conf.wins._detachContextMenu("button", this.conf.winId, this.conf.name)
		}
		this.button = null;
		this.enable = null;
		this.disable = null;
		this.isEnabled = null;
		this.show = null;
		this.hide = null;
		this.isHidden = null;
		this.setCss = null;
		this.unload = null;
		if (n != true) {
			this.conf.wins._winAdjustTitle(this.conf.winId)
		}
		this.conf.wins = null;
		this.conf.winId = null;
		this.conf = null
	};
	this.setCss(a);
	dhx4._eventable(this);
	return this
};
dhtmlXWindows.prototype._winButtonClick = function(g, a, c) {
	if (!this.w[g].b[a].isEnabled()) {
		return true
	}
	if (this.w[g].b[a]._doOnClick() !== true) {
		return
	}
	if (a == "help") {
		this._callMainEvent("onHelp", g)
	}
	if (a == "park") {
		this._winPark(g, true)
	}
	if (a == "minmax") {
		this._winMinmax(g)
	}
	if (a == "stick") {
		this._winStick(g);
		return false
	}
	if (a == "close") {
		this._winClose(g);
		return false
	}
	return true
};
dhtmlXWindows.prototype._winRemoveButton = function(g, a, c) {
	this.w[g].b[a].unload(c);
	this.w[g].b[a] = null;
	delete this.w[g].b[a]
};
dhtmlXWindows.prototype._dndInitModule = function() {
	var a = this;
	this.conf.dnd_tm = null;
	this.conf.dnd_time = 0;
	if (window.navigator.msPointerEnabled == true) {
		this.conf.dnd_evs = {
			start: "MSPointerDown",
			move: "MSPointerMove",
			end: "MSPointerUp"
		}
	} else {
		this.conf.dnd_evs = {
			start: "touchstart",
			move: "touchmove",
			end: "touchend"
		}
	}
	this._dndOnMouseDown = function(l, m) {
		if (a.conf.dblclick_active) {
			return
		}
		if (l.preventDefault) {
			l.preventDefault()
		} else {
			l.returnValue = false
		}
		if (a._callMainEvent("onBeforeMoveStart", m) !== true) {
			return
		}
		a.conf.dnd = {
			id: m,
			x: a._dndPos(l, "X"),
			y: a._dndPos(l, "Y"),
			ready: true,
			css: false,
			css_touch: false,
			css_vp: false,
			tr: null,
			mode: "def",
			moved: false,
			prevent: false
		};
		if (a.w[m].conf.keep_in_vp) {
			a.conf.dnd.minX = 0;
			a.conf.dnd.maxX = a.vp.clientWidth - a.w[m].conf.w;
			a.conf.dnd.minY = 0;
			a.conf.dnd.maxY = a.vp.clientHeight - a.w[m].conf.h
		} else {
			a.conf.dnd.minX = -a.w[m].conf.w + a.conf.vp_pos_ofs;
			a.conf.dnd.maxX = a.vp.clientWidth - a.conf.vp_pos_ofs;
			a.conf.dnd.minY = 0;
			a.conf.dnd.maxY = a.vp.clientHeight - a.conf.vp_pos_ofs
		}
		var c = ["MozTransform", "WebkitTransform", "OTransform", "msTransform", "transform"];
		for (var g = 0; g < c.length; g++) {
			if (document.documentElement.style[c[g]] != null && a.conf.dnd.tr == null) {
				a.conf.dnd.tr = c[g];
				a.conf.dnd.mode = "tr"
			}
		}
		if (a.conf.dnd.mode == "tr") {
			a.w[m].win.style[a.conf.dnd.tr] = "translate(0px,0px)"
		}
		if (l.type == a.conf.dnd_evs.start) {
			if (a.conf.dnd.css_touch == false) {
				a.w[m].win.className += " dhxwin_dnd_touch";
				a.conf.dnd.css_touch = true
			}
			if (a.conf.dnd.css_vp == false) {
				a.vp.className += " dhxwins_vp_dnd";
				a.conf.dnd.css_vp = true
			}
		} else {
			a._dndInitEvents()
		}
	};
	this._dndOnMouseMove = function(m) {
		m = m || event;
		var l = a.conf.dnd;
		var c = a._dndPos(m, "X") - l.x;
		var n = a._dndPos(m, "Y") - l.y;
		if (m.type == a.conf.dnd_evs.move) {
			if (l.moved != true && (Math.abs(c) > 20 || Math.abs(n) > 20)) {
				if (a.conf.dnd_tm != null) {
					window.clearTimeout(a.conf.dnd_tm);
					a.conf.dnd_tm = null
				}
				window.removeEventListener(a.conf.dnd_evs.start, a._dndOnMouseMove, false);
				return
			}
		}
		if (l.ready != true) {
			return
		}
		var g = a.w[l.id];
		if (m.preventDefault) {
			m.preventDefault()
		} else {
			m.returnValue = false
		}
		if (l.css != true) {
			if (l.css_touch == false) {
				g.win.className += " dhxwin_dnd"
			}
			g.fr_cover.className += " dhxwin_fr_cover_dnd";
			l.css = true
		}
		if (l.css_vp != true) {
			a.vp.className += " dhxwins_vp_dnd";
			l.css_vp = true
		}
		l.newX = g.conf.x + c;
		l.newY = g.conf.y + n;
		if (l.mode == "tr") {
			l.newX = Math.min(Math.max(l.newX, l.minX), l.maxX);
			c = l.newX - g.conf.x;
			l.newY = Math.min(Math.max(l.newY, l.minY), l.maxY);
			n = l.newY - g.conf.y;
			g.win.style[l.tr] = "translate(" + c + "px," + n + "px)"
		} else {
			if (l.newX < l.minX || l.newX > l.maxX) {
				l.newX = Math.min(Math.max(l.newX, l.minX), l.maxX)
			} else {
				l.x = a._dndPos(m, "X")
			}
			if (l.newY < l.minY || l.newY > l.maxY) {
				l.newY = Math.min(Math.max(l.newY, l.minY), l.maxY)
			} else {
				l.y = a._dndPos(m, "Y")
			}
			a._winSetPosition(l.id, l.newX, l.newY)
		}
		l.moved = true;
		g = l = null
	};
	this._dndOnMouseUp = function(l) {
		l = l || event;
		if (a.conf.dnd != null) {
			var g = a.conf.dnd;
			var c = a.w[g.id];
			if (g.newX != null) {
				if (g.mode == "tr") {
					a._winSetPosition(g.id, g.newX, g.newY);
					c.win.style[g.tr] = "translate(0px,0px)"
				}
			}
			if (g.css == true) {
				if (g.css_touch == false) {
					c.win.className = String(c.win.className).replace(/\s{0,}dhxwin_dnd/gi, "")
				}
				c.fr_cover.className = String(c.fr_cover.className).replace(/\s{0,}dhxwin_fr_cover_dnd/gi, "")
			}
			if (g.css_touch == true) {
				c.win.className = String(c.win.className).replace(/\s{0,}dhxwin_dnd_touch/gi, "")
			}
			if (g.css_vp == true) {
				a.vp.className = String(a.vp.className).replace(/\s{0,}dhxwins_vp_dnd/gi, "")
			}
			a._dndUnloadEvents();
			if (g.moved == true) {
				a._callMainEvent("onMoveFinish", g.id)
			} else {
				a._callMainEvent("onMoveCancel", g.id)
			}
			c = g = a.conf.dnd = null
		}
		if (window.dhx4.isIE == true && l.type == a.conf.dnd_evs.end && window.navigator.msPointerEnabled == true) {
			document.body.style.msTouchAction = "";
			window.removeEventListener(a.conf.dnd_evs.end, a._dndOnMouseUp, false);
			window.removeEventListener(a.conf.dnd_evs.move, a._dndOnMouseMove, false);
			if (a.conf.dnd_tm != null) {
				window.clearTimeout(a.conf.dnd_tm)
			}
			a.conf.dnd_tm = null
		}
	};
	this._dndOnSelectStart = function(c) {
		c = c || event;
		if (c.preventDefault) {
			c.preventDefault()
		} else {
			c.returnValue = false
		}
		return false
	};
	this._dndInitEvents = function() {
		if (typeof(window.addEventListener) == "function") {
			window.addEventListener("mousemove", this._dndOnMouseMove, false);
			window.addEventListener("mouseup", this._dndOnMouseUp, false);
			window.addEventListener("selectstart", this._dndOnSelectStart, false)
		} else {
			document.body.attachEvent("onmousemove", this._dndOnMouseMove);
			document.body.attachEvent("onmouseup", this._dndOnMouseUp);
			document.body.attachEvent("onselectstart", this._dndOnSelectStart)
		}
	};
	this._dndUnloadEvents = function() {
		if (typeof(window.addEventListener) == "function") {
			window.removeEventListener("mousemove", this._dndOnMouseMove, false);
			window.removeEventListener("mouseup", this._dndOnMouseUp, false);
			window.removeEventListener("selectstart", this._dndOnSelectStart, false)
		} else {
			document.body.detachEvent("onmousemove", this._dndOnMouseMove);
			document.body.detachEvent("onmouseup", this._dndOnMouseUp);
			document.body.detachEvent("onselectstart", this._dndOnSelectStart)
		}
	};
	this._dndUnloadModule = function() {
		this.detachEvent(this.conf.dnd_evid);
		this.conf.dnd_evid = null;
		this._dndOnMouseDown = null;
		this._dndOnMouseMove = null;
		this._dndOnMouseUp = null;
		this._dndOnSelectStart = null;
		this._dndInitEvents = null;
		this._dndUnloadEvents = null;
		this._dndInitModule = null;
		this._dndUnloadModule = null;
		a = null
	};
	this._dndPos = function(g, c) {
		var l = g[this.conf.dnd_ev_prefix + c];
		if (l == null) {
			l = e.touches[0][this.conf.dnd_ev_prefix + c]
		}
		return l
	};
	this.conf.dnd_evid = this.attachEvent("_winMouseDown", function(g, c) {
		if (g.type == this.conf.dnd_evs.start) {
			if (c.mode == "hdr") {
				if (this.w[c.id].conf.maxed && this.w[c.id].conf.max_w == null && this.w[c.id].conf.max_h == null) {
					return
				}
				this.conf.dnd_ev_prefix = "page";
				this.conf.dnd = {
					x: this._dndPos(g, "X"),
					y: this._dndPos(g, "Y")
				};
				if (this.conf.dnd_time < 1) {
					this._dndOnMouseDown(g, c.id)
				} else {
					if (this.conf.dnd_tm != null) {
						window.clearTimeout(this.conf.dnd_tm)
					}
					this.conf.dnd_tm = window.setTimeout(function() {
						a._dndOnMouseDown(g, c.id)
					}, this.conf.dnd_time)
				}
				if (window.dhx4.isIE == true && window.navigator.msPointerEnabled == true) {
					document.body.style.msTouchAction = "none";
					window.addEventListener(this.conf.dnd_evs.end, this._dndOnMouseUp, false)
				}
				window.addEventListener(this.conf.dnd_evs.move, this._dndOnMouseMove, false)
			}
			return false
		}
		if (g.type == this.conf.dnd_evs.end) {
			if (this.conf.dnd_tm != null) {
				window.clearTimeout(this.conf.dnd_tm);
				this.conf.dnd_tm = null
			}
			this._dndOnMouseUp();
			window.removeEventListener(this.conf.dnd_evs.move, this._dndOnMouseMove, false);
			return false
		}
		if (g.button >= 2) {
			return
		}
		this.conf.dnd_ev_prefix = "client";
		if (!(c.mode == "hdr" && g.type == "mousedown" && this.w[c.id].conf.allow_move == true)) {
			return
		}
		if (this.w[c.id].conf.maxed && this.w[c.id].conf.max_w == null && this.w[c.id].conf.max_h == null) {
			return
		}
		if (g.preventDefault) {
			g.preventDefault()
		} else {
			g.returnValue = false
		}
		this._dndOnMouseDown(g, c.id);
		return false
	})
};
dhtmlXWindowsCell.prototype._initResize = function() {
	var a = this;
	var c = navigator.userAgent;
	this.conf.resize = {
		b_width: 6,
		c_type: (c.indexOf("MSIE 10.0") > 0 || c.indexOf("MSIE 9.0") > 0 || c.indexOf("MSIE 8.0") > 0 || c.indexOf("MSIE 7.0") > 0 || c.indexOf("MSIE 6.0") > 0)
	};
	this._rOnCellMouseMove = function(o) {
		if (a.wins.conf.resize_actv == true || a.wins.w[a._idd].conf.allow_resize == false || a.conf.progress == true || a.wins.w[a._idd].conf.maxed == true || a.wins.w[a._idd].conf.fs_mode == true) {
			var m = a.wins.w[a._idd].brd;
			if (m.style.cursor != "default") {
				m.style.cursor = "default"
			}
			m = null;
			return
		}
		o = o || event;
		var w = a.wins.w[a._idd].brd;
		var g = a.conf.resize;
		var s = (a.wins.w[a._idd].conf.header == false);
		var u = o.clientX;
		var q = o.clientY;
		var l = window.dhx4.absLeft(w);
		var v = window.dhx4.absTop(w);
		var n = "";
		if (u <= l + g.b_width) {
			n = "w"
		} else {
			if (u >= l + w.offsetWidth - g.b_width) {
				n = "e"
			}
		}
		if (q >= v + w.offsetHeight - g.b_width) {
			n = "s" + n
		} else {
			if (s && q <= v + g.b_width) {
				n = "n" + n
			}
		}
		if (n == "") {
			n = false
		}
		if (g.mode != n) {
			g.mode = n;
			if (n == false) {
				w.style.cursor = "default"
			} else {
				w.style.cursor = n + "-resize"
			}
		}
		w = g = null
	};
	this._rOnCellMouseDown = function(n) {
		if (a.conf.resize.mode == false) {
			return
		}
		if (a.conf.progress == true) {
			return
		}
		if (a.wins.w[a._idd].conf.allow_resize == false) {
			return
		}
		if (a.wins.w[a._idd].conf.fs_mode == true) {
			return
		}
		if (n.preventDefault) {
			n.preventDefault()
		} else {
			n.returnValue = false
		}
		if (a.wins._callMainEvent("onBeforeResizeStart", a._idd) !== true) {
			return
		}
		var g = a.wins.w[a._idd];
		var m = a.conf.resize;
		a.wins.conf.resize_actv = true;
		m.min_w = g.conf.min_w;
		m.min_h = g.conf.min_h;
		m.max_w = g.conf.max_w || +Infinity;
		m.max_h = g.conf.max_h || +Infinity;
		if (g.cell.dataType == "layout" && g.cell.dataObj != null && typeof(g.cell.dataObj._getWindowMinDimension) == "function") {
			var l = g.cell.dataObj._getWindowMinDimension(g.cell);
			m.min_w = Math.max(l.w, m.min_w);
			m.min_h = Math.max(l.h, m.min_h)
		}
		m.vp_l = a.wins.conf.vp_pos_ofs;
		m.vp_r = a.wins.vp.clientWidth - a.wins.conf.vp_pos_ofs;
		m.vp_b = a.wins.vp.clientHeight - a.wins.conf.vp_pos_ofs;
		m.x = n.clientX;
		m.y = n.clientY;
		if (typeof(window.addEventListener) == "function") {
			window.addEventListener("mousemove", a._rOnWinMouseMove, false);
			window.addEventListener("mouseup", a._rOnWinMouseUp, false);
			window.addEventListener("selectstart", a._rOnSelectStart, false)
		} else {
			document.body.attachEvent("onmousemove", a._rOnWinMouseMove);
			document.body.attachEvent("onmouseup", a._rOnWinMouseUp);
			document.body.attachEvent("onselectstart", a._rOnSelectStart)
		}
		m.resized = false;
		m.vp_cursor = a.wins.vp.style.cursor;
		a.wins.vp.style.cursor = m.mode + "-resize";
		g = m = null
	};
	this._rOnWinMouseMove = function(n) {
		n = n || event;
		var l = a.wins.w[a._idd];
		var m = a.conf.resize;
		if (!m.resized) {
			l.fr_cover.className += " dhxwin_fr_cover_resize";
			m.resized = true
		}
		var g = n.clientX - m.x;
		var o = n.clientY - m.y;
		if (m.mode.indexOf("e") >= 0) {
			m.rw = Math.min(Math.max(l.conf.w + g, m.min_w), m.max_w);
			m.rx = null;
			if (l.conf.x + m.rw < m.vp_l) {
				m.rw = m.vp_l - l.conf.x
			} else {
				if (l.conf.x + m.rw > a.wins.vp.clientWidth) {
					m.rw = a.wins.vp.clientWidth - l.conf.x
				}
			}
		} else {
			if (m.mode.indexOf("w") >= 0) {
				m.rw = Math.min(Math.max(l.conf.w - g, m.min_w), m.max_w);
				m.rx = l.conf.x + l.conf.w - m.rw;
				if (m.rx < 0) {
					m.rw = m.rw + m.rx;
					m.rx = 0
				} else {
					if (m.rx > m.vp_r) {
						m.rw = m.rw - m.vp_r;
						m.rx = m.vp_r
					}
				}
			}
		}
		if (m.mode.indexOf("s") >= 0) {
			m.rh = Math.min(Math.max(l.conf.h + o, m.min_h), m.max_h);
			m.ry = null;
			if (l.conf.y + m.rh > a.wins.vp.clientHeight) {
				m.rh = a.wins.vp.clientHeight - l.conf.y
			}
		} else {
			if (m.mode.indexOf("n") >= 0) {
				m.rh = Math.min(Math.max(l.conf.h - o, m.min_h), m.max_h);
				m.ry = l.conf.y + l.conf.h - m.rh;
				if (m.ry < 0) {
					m.rh = m.rh + m.ry;
					m.ry = 0
				} else {
					if (m.ry > m.vp_b) {
						m.rh = m.rh - m.vp_b;
						m.ry = m.vp_b
					}
				}
			}
		}
		a._rAdjustSizer();
		l = m = null
	};
	this._rOnWinMouseUp = function() {
		var l = a.conf.resize;
		var g = a.wins.w[a._idd];
		a.wins.conf.resize_actv = false;
		a.wins.vp.style.cursor = l.vp_cursor;
		g.fr_cover.className = String(g.fr_cover.className).replace(/\s{0,}dhxwin_fr_cover_resize/gi, "");
		if (l.resized) {
			a.wins._winSetSize(a._idd, l.rw, l.rh);
			if (l.rx == null) {
				l.rx = g.conf.x
			}
			if (l.ry == null) {
				l.ry = g.conf.y
			}
			if (l.rx != g.conf.x || l.ry != g.conf.y) {
				a.wins._winSetPosition(a._idd, l.rx, l.ry)
			}
		}
		if (l.obj != null) {
			l.obj.parentNode.removeChild(l.obj);
			l.obj = null
		}
		if (l.objFR != null) {
			l.objFR.parentNode.removeChild(l.objFR);
			l.objFR = null
		}
		if (typeof(window.addEventListener) == "function") {
			window.removeEventListener("mousemove", a._rOnWinMouseMove, false);
			window.removeEventListener("mouseup", a._rOnWinMouseUp, false);
			window.removeEventListener("selectstart", a._rOnSelectStart, false)
		} else {
			document.body.detachEvent("onmousemove", a._rOnWinMouseMove);
			document.body.detachEvent("onmouseup", a._rOnWinMouseUp);
			document.body.detachEvent("onselectstart", a._rOnSelectStart)
		}
		if (l.resized == true) {
			if (a.dataType == "layout" && a.dataObj != null) {
				a.dataObj.callEvent("onResize", [])
			}
			a.wins._callMainEvent("onResizeFinish", a._idd)
		} else {
			a.wins._callMainEvent("onResizeCancel", a._idd)
		}
		l.mode = "";
		g = l = null
	};
	this._rOnSelectStart = function(g) {
		g = g || event;
		if (g.preventDefault) {
			g.preventDefault()
		} else {
			g.returnValue = false
		}
		return false
	};
	this._rInitSizer = function() {
		var l = a.conf.resize;
		var g = a.wins.w[a._idd];
		l.obj = document.createElement("DIV");
		l.obj.className = "dhxwin_resize";
		l.obj.style.zIndex = g.win.style.zIndex;
		l.obj.style.cursor = l.mode + "-resize";
		a.wins.vp.appendChild(l.obj);
		if (a.wins.conf.fr_cover == true) {
			l.objFR = document.createElement("IFRAME");
			l.objFR.className = "dhxwin_resize_fr_cover";
			l.objFR.style.zIndex = l.obj.style.zIndex;
			a.wins.vp.insertBefore(l.objFR, l.obj)
		}
		l.rx = g.conf.x;
		l.ry = g.conf.y;
		l.rw = g.conf.w;
		l.rh = g.conf.h;
		l = null
	};
	this._rAdjustSizer = function() {
		var g = a.conf.resize;
		if (!g.obj) {
			this._rInitSizer()
		}
		g.obj.style.width = g.rw + "px";
		g.obj.style.height = g.rh + "px";
		if (g.rx != null) {
			g.obj.style.left = g.rx + "px"
		}
		if (g.ry != null) {
			g.obj.style.top = g.ry + "px"
		}
		if (g.objFR != null) {
			g.objFR.style.width = g.obj.style.width;
			g.objFR.style.height = g.obj.style.height;
			if (g.rx != null) {
				g.objFR.style.left = g.obj.style.left
			}
			if (g.ry != null) {
				g.objFR.style.top = g.obj.style.top
			}
		}
		g = null
	};
	if (typeof(window.addEventListener) == "function") {
		this.wins.w[this._idd].brd.addEventListener("mousemove", this._rOnCellMouseMove, false);
		this.wins.w[this._idd].brd.addEventListener("mousedown", this._rOnCellMouseDown, false)
	} else {
		this.wins.w[this._idd].brd.attachEvent("onmousemove", this._rOnCellMouseMove);
		this.wins.w[this._idd].brd.attachEvent("onmousedown", this._rOnCellMouseDown)
	}
	this._unloadResize = function() {
		if (typeof(window.addEventListener) == "function") {
			this.wins.w[this._idd].brd.removeEventListener("mousemove", this._rOnCellMouseMove, false);
			this.wins.w[this._idd].brd.removeEventListener("mousedown", this._rOnCellMouseDown, false)
		} else {
			this.wins.w[this._idd].brd.detachEvent("onmousemove", this._rOnCellMouseMove);
			this.wins.w[this._idd].brd.detachEvent("onmousedown", this._rOnCellMouseDown)
		}
		this._initResize = null;
		this._rOnCellMouseMove = null;
		this._rOnCellMouseDown = null;
		this._rOnWinMouseMove = null;
		this._rOnWinMouseUp = null;
		this._rOnSelectStart = null;
		this._rInitSizer = null;
		this._rAdjustSizer = null;
		this._unloadResize = null;
		this.conf.resize = null;
		a = null
	}
};
dhtmlXWindows.prototype.attachContextMenu = function(a) {
	return this._renderContextMenu("icon", null, null, a)
};
dhtmlXWindows.prototype.getContextMenu = function() {
	if (this.cm != null && this.cm.global != null) {
		return this.cm.global
	}
	return null
};
dhtmlXWindows.prototype.detachContextMenu = function() {
	this._detachContextMenu("icon", null, null)
};
dhtmlXWindowsCell.prototype.attachContextMenu = function(a) {
	return this.wins._renderContextMenu("icon", this._idd, null, a)
};
dhtmlXWindowsCell.prototype.getContextMenu = function() {
	if (this.wins.cm != null && this.wins.cm.icon[this._idd] != null) {
		return this.wins.cm.icon[this._idd]
	}
	return null
};
dhtmlXWindowsCell.prototype.detachContextMenu = function() {
	this.wins._detachContextMenu("icon", this._idd, null)
};
dhtmlXWindowsButton.prototype.attachContextMenu = function(a) {
	return this.conf.wins._renderContextMenu("button", this.conf.winId, this.conf.name, a)
};
dhtmlXWindowsButton.prototype.getContextMenu = function() {
	if (this.conf.wins.cm == null || this.conf.wins.cm.button[this.conf.winId] == null) {
		return null
	}
	if (this.conf.wins.cm.button[this.conf.winId][this.conf.name] != null) {
		return this.conf.wins.cm.button[this.conf.winId][this.conf.name]
	}
	return null
};
dhtmlXWindowsButton.prototype.detachContextMenu = function() {
	this.conf.wins._detachContextMenu("button", this.conf.winId, this.conf.name)
};
dhtmlXWindows.prototype._renderContextMenu = function(o, n, g, c) {
	var l = this;
	var a = false;
	if (this.cm == null) {
		this.cm = {
			global: null,
			icon: {},
			button: {}
		};
		a = true
	}
	if (n == null) {
		if (this.cm.global != null) {
			return
		}
	} else {
		if (o == "icon") {
			if (this.cm.icon[n] != null) {
				return
			}
		} else {
			if (o == "button") {
				if (this.cm.button[n] != null && this.cm.button[n][g] != null) {
					return
				}
			}
		}
	}
	if (c == null) {
		c = {}
	}
	c.parent = null;
	c.context = true;
	var m = new dhtmlXMenuObject(c);
	m.setAutoHideMode(false);
	m.attachEvent("onShow", function() {
		this.conf.wins_menu_open = true
	});
	m.attachEvent("onHide", function() {
		this.conf.wins_menu_open = false;
		l.conf.opened_menu = null
	});
	if (n == null) {
		this.cm.global = m
	} else {
		if (o == "icon") {
			this.cm.icon[n] = m
		} else {
			if (o == "button") {
				if (this.cm.button[n] == null) {
					this.cm.button[n] = {}
				}
				this.cm.button[n][g] = m
			}
		}
	}
	if (a) {
		this._showContextMenu = function(u, s) {
			if (u.button >= 2) {
				return
			}
			if (s.mode == "icon" && s.id != null && s.press_type == "mousedown") {
				var v = this.cm.icon[s.id] || this.cm.global;
				if (v == null) {
					return
				}
				u.cancelBubble = true;
				var r = this.w[s.id].hdr.firstChild;
				if (v.conf.wins_menu_open && this.conf.opened_menu == s.id) {
					v.hideContextMenu()
				} else {
					this._hideContextMenu();
					v.showContextMenu(window.dhx4.absLeft(r), window.dhx4.absTop(r) + r.offsetHeight);
					this.conf.opened_menu = s.id
				}
				v = r = null
			}
			if (s.mode == "button" && s.id != null && s.press_type == "mousedown") {
				if (this.cm.button[s.id] == null || this.cm.button[s.id][s.button_name] == null) {
					return
				}
				u.cancelBubble = true;
				this.conf.button_last = null;
				var v = this.cm.button[s.id][s.button_name];
				var q = this.w[s.id].b[s.button_name].button;
				if (v.conf.wins_menu_open && this.conf.opened_menu == s.id) {
					v.hideContextMenu()
				} else {
					this._hideContextMenu();
					v.showContextMenu(window.dhx4.absLeft(q), window.dhx4.absTop(q) + q.offsetHeight);
					this.conf.opened_menu = s.id
				}
				v = q = null
			}
		};
		this._hideContextMenu = function(v) {
			if (v != null) {
				v = v || event;
				if (v.type == "keydown" && v.keyCode != 27) {
					return
				}
				var u = v.target || v.srcElement;
				var r = true;
				while (u != null && r == true) {
					if (u.className != null && u.className.search(/SubLevelArea_Polygon/) >= 0) {
						r = false
					} else {
						u = u.parentNode
					}
				}
			}
			if (r || v == null) {
				if (l.cm.global != null) {
					l.cm.global.hideContextMenu()
				}
				for (var s in l.cm.icon) {
					if (l.cm.icon[s] != null) {
						l.cm.icon[s].hideContextMenu()
					}
				}
				for (var s in l.cm.button) {
					for (var q in l.cm.button[s]) {
						if (l.cm.button[s][q] != null) {
							l.cm.button[s][q].hideContextMenu()
						}
					}
				}
			}
		};
		this._detachContextMenu = function(s, r, q) {
			if (this.cm == null) {
				return
			}
			if (r == null) {
				if (this.cm.global != null) {
					this.cm.global.unload();
					this.cm.global = null
				}
			} else {
				if (s == "icon") {
					if (this.cm.icon[r] != null) {
						this.cm.icon[r].unload();
						this.cm.icon[r] = null
					}
				} else {
					if (s == "button") {
						if (this.cm.button[r] != null && this.cm.button[r][q] != null) {
							this.cm.button[r][q].unload();
							this.cm.button[r][q] = null
						}
					}
				}
			}
		};
		this.attachEvent("_winMouseDown", this._showContextMenu);
		if (typeof(window.addEventListener) == "function") {
			window.addEventListener("mousedown", this._hideContextMenu, false);
			window.addEventListener("keydown", this._hideContextMenu, false)
		} else {
			document.body.attachEvent("onmousedown", this._hideContextMenu);
			document.body.attachEvent("onkeydown", this._hideContextMenu)
		}
		this._unloadContextMenu = function() {
			this._detachContextMenu("icon", null, null);
			this.cm = null;
			if (typeof(window.addEventListener) == "function") {
				window.removeEventListener("mousedown", this._hideContextMenu, false);
				window.removeEventListener("keydown", this._hideContextMenu, false)
			} else {
				document.body.detachEvent("onmousedown", this._hideContextMenu);
				document.body.detachEvent("onkeydown", this._hideContextMenu)
			}
			l = null
		}
	}
	return m
};
if (!window.dhtmlx) {
	window.dhtmlx = {}
}(function() {
	var s = null;

	function v(C, y) {
		var A = C.callback;
		u(false);
		C.box.parentNode.removeChild(C.box);
		s = C.box = null;
		if (A) {
			A(y)
		}
	}

	function a(A) {
		if (s) {
			A = A || event;
			var y = A.which || event.keyCode;
			if (dhtmlx.message.keyboard) {
				if (y == 13 || y == 32) {
					v(s, true)
				}
				if (y == 27) {
					v(s, false)
				}
			}
			if (A.preventDefault) {
				A.preventDefault()
			}
			return !(A.cancelBubble = true)
		}
	}
	if (document.attachEvent) {
		document.attachEvent("onkeydown", a)
	} else {
		document.addEventListener("keydown", a, true)
	}

	function u(A) {
		if (!u.cover) {
			u.cover = document.createElement("DIV");
			u.cover.onkeydown = a;
			u.cover.className = "dhx_modal_cover";
			document.body.appendChild(u.cover)
		}
		var y = document.body.scrollHeight;
		u.cover.style.display = A ? "inline-block" : "none"
	}

	function n(A, y) {
		return "<div class='dhtmlx_popup_button' result='" + y + "' ><div>" + A + "</div></div>"
	}

	function g(A) {
		if (!w.area) {
			w.area = document.createElement("DIV");
			w.area.className = "dhtmlx_message_area";
			w.area.style[w.position] = "5px";
			document.body.appendChild(w.area)
		}
		w.hide(A.id);
		var y = document.createElement("DIV");
		y.innerHTML = "<div>" + A.text + "</div>";
		y.className = "dhtmlx-info dhtmlx-" + A.type;
		y.onclick = function() {
			if (A) {
				w.hide(A.id)
			}
			A = null
		};
		if (w.position == "bottom" && w.area.firstChild) {
			w.area.insertBefore(y, w.area.firstChild)
		} else {
			w.area.appendChild(y)
		}
		if (A.expire > 0) {
			w.timers[A.id] = window.setTimeout(function() {
				w.hide(A.id)
			}, A.expire)
		}
		w.pull[A.id] = y;
		y = null;
		return A.id
	}

	function o(A, D, H) {
		var F = document.createElement("DIV");
		F.className = " dhtmlx_modal_box dhtmlx-" + A.type;
		F.setAttribute("dhxbox", 1);
		var y = "";
		if (A.width) {
			F.style.width = A.width
		}
		if (A.height) {
			F.style.height = A.height
		}
		if (A.title) {
			y += '<div class="dhtmlx_popup_title">' + A.title + "</div>"
		}
		y += '<div class="dhtmlx_popup_text"><span>' + (A.content ? "" : A.text) + '</span></div><div  class="dhtmlx_popup_controls">';
		if (D) {
			y += n(A.ok || "OK", true)
		}
		if (H) {
			y += n(A.cancel || "Cancel", false)
		}
		if (A.buttons) {
			for (var C = 0; C < A.buttons.length; C++) {
				y += n(A.buttons[C], C)
			}
		}
		y += "</div>";
		F.innerHTML = y;
		if (A.content) {
			var E = A.content;
			if (typeof E == "string") {
				E = document.getElementById(E)
			}
			if (E.style.display == "none") {
				E.style.display = ""
			}
			F.childNodes[A.title ? 1 : 0].appendChild(E)
		}
		F.onclick = function(K) {
			K = K || event;
			var J = K.target || K.srcElement;
			if (!J.className) {
				J = J.parentNode
			}
			if (J.className == "dhtmlx_popup_button") {
				var I = J.getAttribute("result");
				I = (I == "true") || (I == "false" ? false : I);
				v(A, I)
			}
		};
		A.box = F;
		if (D || H) {
			s = A
		}
		return F
	}

	function x(C, D, F) {
		var E = C.tagName ? C : o(C, D, F);
		if (!C.hidden) {
			u(true)
		}
		document.body.appendChild(E);
		var A = C.left || Math.abs(Math.floor(((window.innerWidth || document.documentElement.offsetWidth) - E.offsetWidth) / 2));
		var H = C.top || Math.abs(Math.floor(((window.innerHeight || document.documentElement.offsetHeight) - E.offsetHeight) / 2));
		if (C.position == "top") {
			E.style.top = "-3px"
		} else {
			E.style.top = H + "px"
		}
		E.style.left = A + "px";
		E.onkeydown = a;
		E.focus();
		if (C.hidden) {
			dhtmlx.modalbox.hide(E)
		}
		return E
	}

	function r(y) {
		return x(y, true, false)
	}

	function c(y) {
		return x(y, true, true)
	}

	function m(y) {
		return x(y)
	}

	function q(A, y, C) {
		if (typeof A != "object") {
			if (typeof y == "function") {
				C = y;
				y = ""
			}
			A = {
				text: A,
				type: y,
				callback: C
			}
		}
		return A
	}

	function l(C, A, y, D) {
		if (typeof C != "object") {
			C = {
				text: C,
				type: A,
				expire: y,
				id: D
			}
		}
		C.id = C.id || w.uid();
		C.expire = C.expire || w.expire;
		return C
	}
	dhtmlx.alert = function() {
		var y = q.apply(this, arguments);
		y.type = y.type || "confirm";
		return r(y)
	};
	dhtmlx.confirm = function() {
		var y = q.apply(this, arguments);
		y.type = y.type || "alert";
		return c(y)
	};
	dhtmlx.modalbox = function() {
		var y = q.apply(this, arguments);
		y.type = y.type || "alert";
		return m(y)
	};
	dhtmlx.modalbox.hide = function(y) {
		while (y && y.getAttribute && !y.getAttribute("dhxbox")) {
			y = y.parentNode
		}
		if (y) {
			y.parentNode.removeChild(y);
			u(false);
			s = null
		}
	};
	var w = dhtmlx.message = function(D, C, A, E) {
		D = l.apply(this, arguments);
		D.type = D.type || "info";
		var y = D.type.split("-")[0];
		switch (y) {
			case "alert":
				return r(D);
			case "confirm":
				return c(D);
			case "modalbox":
				return m(D);
			default:
				return g(D);
				break
		}
	};
	w.seed = (new Date()).valueOf();
	w.uid = function() {
		return w.seed++
	};
	w.expire = 4000;
	w.keyboard = true;
	w.position = "top";
	w.pull = {};
	w.timers = {};
	w.hideAll = function() {
		for (var y in w.pull) {
			w.hide(y)
		}
	};
	w.hide = function(A) {
		var y = w.pull[A];
		if (y && y.parentNode) {
			window.setTimeout(function() {
				y.parentNode.removeChild(y);
				y = null
			}, 2000);
			y.className += " hidden";
			if (w.timers[A]) {
				window.clearTimeout(w.timers[A])
			}
			delete w.pull[A]
		}
	}
})();
if (!window.dhx) {
	dhx = {}
}
dhx.assert = function(c, a) {
	if (!c) {
		dhx.assert_error(a)
	}
};
dhx.assert_error = function(message) {
	dhx.log("error", message);
	if (dhx.message && typeof message == "string") {
		dhx.message({
			type: "debug",
			text: message,
			expire: -1
		})
	}
	if (dhx.debug !== false) {
		eval("debugger;")
	}
};
dhx.assert_core_ready = function() {
	if (window.dhx_on_core_ready) {
		dhx_on_core_ready()
	}
};
dhx.version = "3.0";
dhx.codebase = "./";
dhx.name = "Core";
dhx.clone = function(c) {
	var a = dhx.clone._function;
	a.prototype = c;
	return new a()
};
dhx.clone._function = function() {};
dhx.extend = function(g, c, a) {
	dhx.assert(g, "Invalid mixing target");
	dhx.assert(c, "Invalid mixing source");
	if (g._dhx_proto_wait) {
		dhx.PowerArray.insertAt.call(g._dhx_proto_wait, c, 1);
		return g
	}
	for (var l in c) {
		if (!g[l] || a) {
			g[l] = c[l]
		}
	}
	if (c.defaults) {
		dhx.extend(g.defaults, c.defaults)
	}
	if (c.$init) {
		c.$init.call(g)
	}
	return g
};
dhx.copy = function(a) {
	dhx.assert(a, "Invalid mixing target");
	if (arguments.length > 1) {
		var c = arguments[0];
		a = arguments[1]
	} else {
		var c = (dhx.isArray(a) ? [] : {})
	}
	for (var g in a) {
		if (a[g] && typeof a[g] == "object" && !dhx.isDate(a[g])) {
			c[g] = (dhx.isArray(a[g]) ? [] : {});
			dhx.copy(c[g], a[g])
		} else {
			c[g] = a[g]
		}
	}
	return c
};
dhx.single = function(g) {
	var a = null;
	var c = function(l) {
		if (!a) {
			a = new g({})
		}
		if (a._reinit) {
			a._reinit.apply(a, arguments)
		}
		return a
	};
	return c
};
dhx.protoUI = function() {
	if (dhx.debug_proto) {
		dhx.log("UI registered: " + arguments[0].name)
	}
	var g = arguments;
	var a = g[0].name;
	var c = function(m) {
		if (!c) {
			return dhx.ui[a].prototype
		}
		var o = c._dhx_proto_wait;
		if (o) {
			var n = [o[0]];
			for (var l = 1; l < o.length; l++) {
				n[l] = o[l];
				if (n[l]._dhx_proto_wait) {
					n[l] = n[l].call(dhx, n[l].name)
				}
				if (n[l].prototype && n[l].prototype.name) {
					dhx.ui[n[l].prototype.name] = n[l]
				}
			}
			dhx.ui[a] = dhx.proto.apply(dhx, n);
			if (c._dhx_type_wait) {
				for (var l = 0; l < c._dhx_type_wait.length; l++) {
					dhx.Type(dhx.ui[a], c._dhx_type_wait[l])
				}
			}
			c = o = null
		}
		if (this != dhx) {
			return new dhx.ui[a](m)
		} else {
			return dhx.ui[a]
		}
	};
	c._dhx_proto_wait = Array.prototype.slice.call(arguments, 0);
	return dhx.ui[a] = c
};
dhx.proto = function() {
	if (dhx.debug_proto) {
		dhx.log("Proto chain:" + arguments[0].name + "[" + arguments.length + "]")
	}
	var n = arguments;
	var m = n[0];
	var c = !!m.$init;
	var q = [];
	dhx.assert(m, "Invalid mixing target");
	for (var l = n.length - 1; l > 0; l--) {
		dhx.assert(n[l], "Invalid mixing source");
		if (typeof n[l] == "function") {
			n[l] = n[l].prototype
		}
		if (n[l].$init) {
			q.push(n[l].$init)
		}
		if (n[l].defaults) {
			var g = n[l].defaults;
			if (!m.defaults) {
				m.defaults = {}
			}
			for (var a in g) {
				if (dhx.isUndefined(m.defaults[a])) {
					m.defaults[a] = g[a]
				}
			}
		}
		if (n[l].type && m.type) {
			for (var a in n[l].type) {
				if (!m.type[a]) {
					m.type[a] = n[l].type[a]
				}
			}
		}
		for (var o in n[l]) {
			if (!m[o]) {
				m[o] = n[l][o]
			}
		}
	}
	if (c) {
		q.push(m.$init)
	}
	m.$init = function() {
		for (var s = 0; s < q.length; s++) {
			q[s].apply(this, arguments)
		}
	};
	var r = function(s) {
		this.$ready = [];
		dhx.assert(this.$init, "object without init method");
		this.$init(s);
		if (this._parseSettings) {
			this._parseSettings(s, this.defaults)
		}
		for (var u = 0; u < this.$ready.length; u++) {
			this.$ready[u].call(this)
		}
	};
	r.prototype = m;
	m = n = null;
	return r
};
dhx.bind = function(c, a) {
	return function() {
		return c.apply(a, arguments)
	}
};
dhx.require = function(c, q, o) {
	if (typeof c != "string") {
		var n = c.length || 0;
		var m = q;
		if (!n) {
			for (var a in c) {
				n++
			}
			q = function() {
				n--;
				if (n === 0) {
					m.apply(this, arguments)
				}
			};
			for (var a in c) {
				dhx.require(a, q, o)
			}
		} else {
			q = function() {
				if (n) {
					n--;
					dhx.require(c[c.length - n - 1], q, o)
				} else {
					return m.apply(this, arguments)
				}
			};
			q()
		}
		return
	}
	if (dhx._modules[c] !== true) {
		if (c.substr(-4) == ".css") {
			var l = dhx.html.create("LINK", {
				type: "text/css",
				rel: "stylesheet",
				href: dhx.codebase + c
			});
			document.head.appendChild(l);
			if (q) {
				q.call(o || window)
			}
			return
		}
		var g = arguments[4];
		if (!q) {
			dhx.exec(dhx.ajax().sync().get(dhx.codebase + c).responseText);
			dhx._modules[c] = true
		} else {
			if (!dhx._modules[c]) {
				dhx._modules[c] = [
					[q, o]
				];
				dhx.ajax(dhx.codebase + c, function(u) {
					dhx.exec(u);
					var s = dhx._modules[c];
					dhx._modules[c] = true;
					for (var r = 0; r < s.length; r++) {
						s[r][0].call(s[r][1] || window, !r)
					}
				})
			} else {
				dhx._modules[c].push([q, o])
			}
		}
	}
};
dhx._modules = {};
dhx.exec = function(code) {
	if (window.execScript) {
		window.execScript(code)
	} else {
		window.eval(code)
	}
};
dhx.wrap = function(c, a) {
	if (!c) {
		return a
	}
	return function() {
		var g = c.apply(this, arguments);
		a.apply(this, arguments);
		return g
	}
};
dhx.isUndefined = function(c) {
	return typeof c == "undefined"
};
dhx.delay = function(l, c, g, a) {
	return window.setTimeout(function() {
		var m = l.apply(c, (g || []));
		l = c = g = null;
		return m
	}, a || 1)
};
dhx.uid = function() {
	if (!this._seed) {
		this._seed = (new Date).valueOf()
	}
	this._seed++;
	return this._seed
};
dhx.toNode = function(a) {
	if (typeof a == "string") {
		return document.getElementById(a)
	}
	return a
};
dhx.toArray = function(a) {
	return dhx.extend((a || []), dhx.PowerArray, true)
};
dhx.toFunctor = function(str) {
	return (typeof(str) == "string") ? eval(str) : str
};
dhx.isArray = function(a) {
	return Array.isArray ? Array.isArray(a) : (Object.prototype.toString.call(a) === "[object Array]")
};
dhx.isDate = function(a) {
	return a instanceof Date
};
dhx._events = {};
dhx.event = function(l, g, a, c) {
	l = dhx.toNode(l);
	var m = dhx.uid();
	if (c) {
		a = dhx.bind(a, c)
	}
	dhx._events[m] = [l, g, a];
	if (l.addEventListener) {
		l.addEventListener(g, a, false)
	} else {
		if (l.attachEvent) {
			l.attachEvent("on" + g, a)
		}
	}
	return m
};
dhx.eventRemove = function(c) {
	if (!c) {
		return
	}
	dhx.assert(this._events[c], "Removing non-existing event");
	var a = dhx._events[c];
	if (a[0].removeEventListener) {
		a[0].removeEventListener(a[1], a[2], false)
	} else {
		if (a[0].detachEvent) {
			a[0].detachEvent("on" + a[1], a[2])
		}
	}
	delete this._events[c]
};
dhx.log = function(c, g, a) {
	if (arguments.length == 1) {
		g = c;
		c = "log"
	}
	if (window.console && console.log) {
		c = c.toLowerCase();
		if (window.console[c]) {
			window.console[c](g || "unknown error")
		} else {
			window.console.log(c + ": " + g)
		}
		if (a) {
			window.console.log(a)
		}
	}
};
dhx.log_full_time = function(a) {
	dhx._start_time_log = new Date();
	dhx.log("Timing start [" + a + "]");
	window.setTimeout(function() {
		var c = new Date();
		dhx.log("Timing end [" + a + "]:" + (c.valueOf() - dhx._start_time_log.valueOf()) / 1000 + "s")
	}, 1)
};
dhx.log_time = function(a) {
	var g = "_start_time_log" + a;
	if (!dhx[g]) {
		dhx[g] = new Date();
		dhx.log("Info", "Timing start [" + a + "]")
	} else {
		var c = new Date();
		dhx.log("Info", "Timing end [" + a + "]:" + (c.valueOf() - dhx[g].valueOf()) / 1000 + "s");
		dhx[g] = null
	}
};
dhx.debug_code = function(a) {
	a.call(dhx)
};
dhx.EventSystem = {
	$init: function() {
		if (!this._evs_events) {
			this._evs_events = {};
			this._evs_handlers = {};
			this._evs_map = {}
		}
	},
	blockEvent: function() {
		this._evs_events._block = true
	},
	unblockEvent: function() {
		this._evs_events._block = false
	},
	mapEvent: function(a) {
		dhx.extend(this._evs_map, a, true)
	},
	on_setter: function(a) {
		if (a) {
			for (var c in a) {
				if (typeof a[c] == "function") {
					this.attachEvent(c, a[c])
				}
			}
		}
	},
	callEvent: function(g, m) {
		if (this._evs_events._block) {
			return true
		}
		g = g.toLowerCase();
		var l = this._evs_events[g.toLowerCase()];
		var a = true;
		if (dhx.debug) {
			dhx.log("info", "[" + this.name + "] event:" + g, m)
		}
		if (l) {
			for (var c = 0; c < l.length; c++) {
				if (l[c].apply(this, (m || [])) === false) {
					a = false
				}
			}
		}
		if (this._evs_map[g] && !this._evs_map[g].callEvent(g, m)) {
			a = false
		}
		return a
	},
	attachEvent: function(c, a, l) {
		dhx.assert(a, "Invalid event handler for " + c);
		c = c.toLowerCase();
		l = l || dhx.uid();
		a = dhx.toFunctor(a);
		var g = this._evs_events[c] || dhx.toArray();
		g.push(a);
		this._evs_events[c] = g;
		this._evs_handlers[l] = {
			f: a,
			t: c
		};
		return l
	},
	detachEvent: function(l) {
		if (!this._evs_handlers[l]) {
			return
		}
		var c = this._evs_handlers[l].t;
		var a = this._evs_handlers[l].f;
		var g = this._evs_events[c];
		g.remove(a);
		delete this._evs_handlers[l]
	},
	hasEvent: function(a) {
		a = a.toLowerCase();
		return this._evs_events[a] ? true : false
	}
};
dhx.extend(dhx, dhx.EventSystem);
dhx.PowerArray = {
	removeAt: function(c, a) {
		if (c >= 0) {
			this.splice(c, (a || 1))
		}
	},
	remove: function(a) {
		this.removeAt(this.find(a))
	},
	insertAt: function(c, g) {
		if (!g && g !== 0) {
			this.push(c)
		} else {
			var a = this.splice(g, (this.length - g));
			this[g] = c;
			this.push.apply(this, a)
		}
	},
	find: function(c) {
		for (var a = 0; a < this.length; a++) {
			if (c == this[a]) {
				return a
			}
		}
		return -1
	},
	each: function(a, g) {
		for (var c = 0; c < this.length; c++) {
			a.call((g || this), this[c])
		}
	},
	map: function(a, g) {
		for (var c = 0; c < this.length; c++) {
			this[c] = a.call((g || this), this[c])
		}
		return this
	},
	filter: function(a, g) {
		for (var c = 0; c < this.length; c++) {
			if (!a.call((g || this), this[c])) {
				this.splice(c, 1);
				c--
			}
		}
		return this
	}
};
dhx.env = {};
(function() {
	if (navigator.userAgent.indexOf("Mobile") != -1) {
		dhx.env.mobile = true
	}
	if (dhx.env.mobile || navigator.userAgent.indexOf("iPad") != -1 || navigator.userAgent.indexOf("Android") != -1) {
		dhx.env.touch = true
	}
	if (navigator.userAgent.indexOf("Opera") != -1) {
		dhx.env.isOpera = true
	} else {
		dhx.env.isIE = !!document.all;
		dhx.env.isFF = !document.all;
		dhx.env.isWebKit = (navigator.userAgent.indexOf("KHTML") != -1);
		dhx.env.isSafari = dhx.env.isWebKit && (navigator.userAgent.indexOf("Mac") != -1)
	}
	if (navigator.userAgent.toLowerCase().indexOf("android") != -1) {
		dhx.env.isAndroid = true
	}
	dhx.env.transform = false;
	dhx.env.transition = false;
	var g = {};
	g.names = ["transform", "transition"];
	g.transform = ["transform", "WebkitTransform", "MozTransform", "OTransform", "msTransform"];
	g.transition = ["transition", "WebkitTransition", "MozTransition", "OTransition", "msTransition"];
	var o = document.createElement("DIV");
	for (var m = 0; m < g.names.length; m++) {
		var l = g[g.names[m]];
		for (var c = 0; c < l.length; c++) {
			if (typeof o.style[l[c]] != "undefined") {
				dhx.env[g.names[m]] = l[c];
				break
			}
		}
	}
	o.style[dhx.env.transform] = "translate3d(0,0,0)";
	dhx.env.translate = (o.style[dhx.env.transform]) ? "translate3d" : "translate";
	var n = "";
	var a = false;
	if (dhx.env.isOpera) {
		n = "-o-";
		a = "O"
	}
	if (dhx.env.isFF) {
		n = "-Moz-"
	}
	if (dhx.env.isWebKit) {
		n = "-webkit-"
	}
	if (dhx.env.isIE) {
		n = "-ms-"
	}
	dhx.env.transformCSSPrefix = n;
	dhx.env.transformPrefix = a || (dhx.env.transformCSSPrefix.replace(/-/gi, ""));
	dhx.env.transitionEnd = ((dhx.env.transformCSSPrefix == "-Moz-") ? "transitionend" : (dhx.env.transformPrefix + "TransitionEnd"))
})();
dhx.env.svg = (function() {
	return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure", "1.1")
})();
dhx.html = {
	_native_on_selectstart: 0,
	denySelect: function() {
		if (!dhx._native_on_selectstart) {
			dhx._native_on_selectstart = document.onselectstart
		}
		document.onselectstart = dhx.html.stopEvent
	},
	allowSelect: function() {
		if (dhx._native_on_selectstart !== 0) {
			document.onselectstart = dhx._native_on_selectstart || null
		}
		dhx._native_on_selectstart = 0
	},
	index: function(c) {
		var a = 0;
		while (c = c.previousSibling) {
			a++
		}
		return a
	},
	_style_cache: {},
	createCss: function(g) {
		var l = "";
		for (var c in g) {
			l += c + ":" + g[c] + ";"
		}
		var a = this._style_cache[l];
		if (!a) {
			a = "s" + dhx.uid();
			this.addStyle("." + a + "{" + l + "}");
			this._style_cache[l] = a
		}
		return a
	},
	addStyle: function(c) {
		var a = document.createElement("style");
		a.setAttribute("type", "text/css");
		a.setAttribute("media", "screen");
		if (a.styleSheet) {
			a.styleSheet.cssText = c
		} else {
			a.appendChild(document.createTextNode(c))
		}
		document.getElementsByTagName("head")[0].appendChild(a)
	},
	create: function(c, a, g) {
		a = a || {};
		var l = document.createElement(c);
		for (var m in a) {
			l.setAttribute(m, a[m])
		}
		if (a.style) {
			l.style.cssText = a.style
		}
		if (a["class"]) {
			l.className = a["class"]
		}
		if (g) {
			l.innerHTML = g
		}
		return l
	},
	getValue: function(a) {
		a = dhx.toNode(a);
		if (!a) {
			return ""
		}
		return dhx.isUndefined(a.value) ? a.innerHTML : a.value
	},
	remove: function(c) {
		if (c instanceof Array) {
			for (var a = 0; a < c.length; a++) {
				this.remove(c[a])
			}
		} else {
			if (c && c.parentNode) {
				c.parentNode.removeChild(c)
			}
		}
	},
	insertBefore: function(c, g, a) {
		if (!c) {
			return
		}
		if (g && g.parentNode) {
			g.parentNode.insertBefore(c, g)
		} else {
			a.appendChild(c)
		}
	},
	locate: function(c, l) {
		if (c.tagName) {
			var a = c
		} else {
			c = c || event;
			var a = c.target || c.srcElement
		}
		while (a) {
			if (a.getAttribute) {
				var g = a.getAttribute(l);
				if (g) {
					return g
				}
			}
			a = a.parentNode
		}
		return null
	},
	offset: function(l) {
		if (l.getBoundingClientRect) {
			var o = l.getBoundingClientRect();
			var q = document.body;
			var c = document.documentElement;
			var a = window.pageYOffset || c.scrollTop || q.scrollTop;
			var m = window.pageXOffset || c.scrollLeft || q.scrollLeft;
			var n = c.clientTop || q.clientTop || 0;
			var r = c.clientLeft || q.clientLeft || 0;
			var s = o.top + a - n;
			var g = o.left + m - r;
			return {
				y: Math.round(s),
				x: Math.round(g)
			}
		} else {
			var s = 0,
				g = 0;
			while (l) {
				s = s + parseInt(l.offsetTop, 10);
				g = g + parseInt(l.offsetLeft, 10);
				l = l.offsetParent
			}
			return {
				y: s,
				x: g
			}
		}
	},
	posRelative: function(a) {
		a = a || event;
		if (!dhx.isUndefined(a.offsetX)) {
			return {
				x: a.offsetX,
				y: a.offsetY
			}
		} else {
			return {
				x: a.layerX,
				y: a.layerY
			}
		}
	},
	pos: function(a) {
		a = a || event;
		if (a.pageX || a.pageY) {
			return {
				x: a.pageX,
				y: a.pageY
			}
		}
		var c = ((dhx.env.isIE) && (document.compatMode != "BackCompat")) ? document.documentElement : document.body;
		return {
			x: a.clientX + c.scrollLeft - c.clientLeft,
			y: a.clientY + c.scrollTop - c.clientTop
		}
	},
	preventEvent: function(a) {
		if (a && a.preventDefault) {
			a.preventDefault()
		}
		return dhx.html.stopEvent(a)
	},
	stopEvent: function(a) {
		(a || event).cancelBubble = true;
		return false
	},
	addCss: function(c, a) {
		c.className += " " + a
	},
	removeCss: function(c, a) {
		c.className = c.className.replace(RegExp(" " + a, "g"), "")
	}
};
dhx.ready = function(a) {
	if (this._ready) {
		a.call()
	} else {
		this._ready_code.push(a)
	}
};
dhx._ready_code = [];
(function() {
	var a = document.getElementsByTagName("SCRIPT");
	dhx.assert(a.length, "Can't locate codebase");
	if (a.length) {
		a = (a[a.length - 1].getAttribute("src") || "").split("/");
		a.splice(a.length - 1, 1);
		dhx.codebase = a.slice(0, a.length).join("/") + "/"
	}
	dhx.event(window, "load", function() {
		dhx4.callEvent("onReady", []);
		dhx.delay(function() {
			dhx._ready = true;
			for (var c = 0; c < dhx._ready_code.length; c++) {
				dhx._ready_code[c].call()
			}
			dhx._ready_code = []
		})
	})
})();
dhx.locale = dhx.locale || {};
dhx.assert_core_ready();
dhx.ready(function() {
	dhx.event(document.body, "click", function(a) {
		dhx4.callEvent("onClick", [a || event])
	})
});
(function() {
	var g = {};
	var c = new RegExp("(\\r\\n|\\n)", "g");
	var a = new RegExp('(\\")', "g");
	dhx.Template = function(m) {
		if (typeof m == "function") {
			return m
		}
		if (g[m]) {
			return g[m]
		}
		m = (m || "").toString();
		if (m.indexOf("->") != -1) {
			m = m.split("->");
			switch (m[0]) {
				case "html":
					m = dhx.html.getValue(m[1]);
					break;
				case "http":
					m = new dhx.ajax().sync().get(m[1], {
						uid: dhx.uid()
					}).responseText;
					break;
				default:
					break
			}
		}
		m = (m || "").toString();
		m = m.replace(c, "\\n");
		m = m.replace(a, '\\"');
		m = m.replace(/\{obj\.([^}?]+)\?([^:]*):([^}]*)\}/g, '"+(obj.$1?"$2":"$3")+"');
		m = m.replace(/\{common\.([^}\(]*)\}/g, "\"+(common.$1||'')+\"");
		m = m.replace(/\{common\.([^\}\(]*)\(\)\}/g, '"+(common.$1?common.$1.apply(this, arguments):"")+"');
		m = m.replace(/\{obj\.([^}]*)\}/g, '"+(obj.$1)+"');
		m = m.replace("{obj}", '"+obj+"');
		m = m.replace(/#([^#'";, ]+)#/gi, '"+(obj.$1)+"');
		try {
			g[m] = Function("obj", "common", 'return "' + m + '";')
		} catch (l) {
			dhx.assert_error("Invalid template:" + m)
		}
		return g[m]
	};
	dhx.Template.empty = function() {
		return ""
	};
	dhx.Template.bind = function(l) {
		return dhx.bind(dhx.Template(l), this)
	};
	dhx.Type = function(q, o) {
		if (q._dhx_proto_wait) {
			if (!q._dhx_type_wait) {
				q._dhx_type_wait = []
			}
			q._dhx_type_wait.push(o);
			return
		}
		if (typeof q == "function") {
			q = q.prototype
		}
		if (!q.types) {
			q.types = {
				"default": q.type
			};
			q.type.name = "default"
		}
		var l = o.name;
		var n = q.type;
		if (l) {
			n = q.types[l] = dhx.clone(o.baseType ? q.types[o.baseType] : q.type)
		}
		for (var m in o) {
			if (m.indexOf("template") === 0) {
				n[m] = dhx.Template(o[m])
			} else {
				n[m] = o[m]
			}
		}
		return l
	}
})();
dhx.Settings = {
	$init: function() {
		this._settings = this.config = {}
	},
	define: function(c, a) {
		if (typeof c == "object") {
			return this._parseSeetingColl(c)
		}
		return this._define(c, a)
	},
	_define: function(c, a) {
		var g = this[c + "_setter"];
		return this._settings[c] = g ? g.call(this, a, c) : a
	},
	_parseSeetingColl: function(g) {
		if (g) {
			for (var c in g) {
				this._define(c, g[c])
			}
		}
	},
	_parseSettings: function(g, a) {
		var c = {};
		if (a) {
			c = dhx.extend(c, a)
		}
		if (typeof g == "object" && !g.tagName) {
			dhx.extend(c, g, true)
		}
		this._parseSeetingColl(c)
	},
	_mergeSettings: function(a, g) {
		for (var c in g) {
			switch (typeof a[c]) {
				case "object":
					a[c] = this._mergeSettings((a[c] || {}), g[c]);
					break;
				case "undefined":
					a[c] = g[c];
					break;
				default:
					break
			}
		}
		return a
	},
	debug_freid_c_id: true,
	debug_freid_a_name: true
};
dhx.ajax = function(a, c, g) {
	if (arguments.length !== 0) {
		var l = new dhx.ajax();
		if (g) {
			l.master = g
		}
		return l.get(a, null, c)
	}
	if (!this.getXHR) {
		return new dhx.ajax()
	}
	return this
};
dhx.ajax.count = 0;
dhx.ajax.prototype = {
	master: null,
	getXHR: function() {
		if (dhx.env.isIE) {
			return new ActiveXObject("Microsoft.xmlHTTP")
		} else {
			return new XMLHttpRequest()
		}
	},
	send: function(m, r, o) {
		var c = this.getXHR();
		if (!dhx.isArray(o)) {
			o = [o]
		}
		if (typeof r == "object") {
			var n = [];
			for (var g in r) {
				var q = r[g];
				if (q === null || q === dhx.undefined) {
					q = ""
				}
				n.push(g + "=" + encodeURIComponent(q))
			}
			r = n.join("&")
		}
		if (r && this.request === "GET") {
			m = m + (m.indexOf("?") != -1 ? "&" : "?") + r;
			r = null
		}
		c.open(this.request, m, !this._sync);
		if (this.request === "POST") {
			c.setRequestHeader("Content-type", "application/x-www-form-urlencoded")
		}
		var l = this;
		c.onreadystatechange = function() {
			if (!c.readyState || c.readyState == 4) {
				if (dhx.debug_time) {
					dhx.log_full_time("data_loading")
				}
				dhx.ajax.count++;
				if (o && l) {
					for (var a = 0; a < o.length; a++) {
						if (o[a]) {
							var s = (o[a].success || o[a]);
							if (c.status >= 400 || (!c.status && !c.responseText)) {
								s = o[a].error
							}
							if (s) {
								s.call((l.master || l), c.responseText, c.responseXML, c)
							}
						}
					}
				}
				if (l) {
					l.master = null
				}
				o = l = null
			}
		};
		c.send(r || null);
		return c
	},
	get: function(a, g, c) {
		if (arguments.length == 2) {
			c = g;
			g = null
		}
		this.request = "GET";
		return this.send(a, g, c)
	},
	post: function(a, g, c) {
		this.request = "POST";
		return this.send(a, g, c)
	},
	put: function(a, g, c) {
		this.request = "PUT";
		return this.send(a, g, c)
	},
	del: function(a, g, c) {
		this.request = "DELETE";
		return this.send(a, g, c)
	},
	sync: function() {
		this._sync = true;
		return this
	},
	bind: function(a) {
		this.master = a;
		return this
	}
};
dhx.send = function(g, c, o, n) {
	var l = dhx.html.create("FORM", {
		target: (n || "_self"),
		action: g,
		method: (o || "POST")
	}, "");
	for (var a in c) {
		var m = dhx.html.create("INPUT", {
			type: "hidden",
			name: a,
			value: c[a]
		}, "");
		l.appendChild(m)
	}
	l.style.display = "none";
	document.body.appendChild(l);
	l.submit();
	document.body.removeChild(l)
};
dhx.AtomDataLoader = {
	$init: function(a) {
		this.data = {};
		if (a) {
			this._settings.datatype = a.datatype || "json";
			this.$ready.push(this._load_when_ready)
		}
	},
	_load_when_ready: function() {
		this._ready_for_data = true;
		if (this._settings.url) {
			this.url_setter(this._settings.url)
		}
		if (this._settings.data) {
			this.data_setter(this._settings.data)
		}
	},
	url_setter: function(a) {
		if (!this._ready_for_data) {
			return a
		}
		this.load(a, this._settings.datatype);
		return a
	},
	data_setter: function(a) {
		if (!this._ready_for_data) {
			return a
		}
		this.parse(a, this._settings.datatype);
		return true
	},
	debug_freid_c_datatype: true,
	debug_freid_c_dataFeed: true,
	load: function(a, c) {
		if (a.$proxy) {
			a.load(this, typeof c == "string" ? c : "json");
			return
		}
		this.callEvent("onXLS", []);
		if (typeof c == "string") {
			this.data.driver = dhx.DataDriver[c];
			c = arguments[2]
		} else {
			if (!this.data.driver) {
				this.data.driver = dhx.DataDriver.json
			}
		}
		var g = [{
			success: this._onLoad,
			error: this._onLoadError
		}];
		if (c) {
			if (dhx.isArray(c)) {
				g.push.apply(g, c)
			} else {
				g.push(c)
			}
		}
		return dhx.ajax(a, g, this)
	},
	parse: function(c, a) {
		this.callEvent("onXLS", []);
		this.data.driver = dhx.DataDriver[a || "json"];
		this._onLoad(c, null)
	},
	_onLoad: function(o, c, a, g) {
		var m = this.data.driver;
		var l = m.toObject(o, c);
		if (l) {
			var n = m.getRecords(l)[0];
			this.data = (m ? m.getDetails(n) : o)
		} else {
			this._onLoadError(o, c, a)
		}
		this.callEvent("onXLE", [])
	},
	_onLoadError: function(g, a, c) {
		this.callEvent("onXLE", []);
		this.callEvent("onLoadError", arguments);
		dhx4.callEvent("onLoadError", [g, a, c, this])
	},
	_check_data_feed: function(c) {
		if (!this._settings.dataFeed || this._ignore_feed || !c) {
			return true
		}
		var a = this._settings.dataFeed;
		if (typeof a == "function") {
			return a.call(this, (c.id || c), c)
		}
		a = a + (a.indexOf("?") == -1 ? "?" : "&") + "action=get&id=" + encodeURIComponent(c.id || c);
		this.callEvent("onXLS", []);
		dhx.ajax(a, function(n, l, g) {
			this._ignore_feed = true;
			var m = dhx.DataDriver.toObject(n, l);
			if (m) {
				this.setValues(m.getDetails(m.getRecords()[0]))
			} else {
				this._onLoadError(n, l, g)
			}
			this._ignore_feed = false;
			this.callEvent("onXLE", [])
		}, this);
		return false
	}
};
dhx.DataDriver = {};
dhx.DataDriver.json = {
	toObject: function(data) {
		if (!data) {
			data = "[]"
		}
		if (typeof data == "string") {
			try {
				eval("dhx.temp=" + data)
			} catch (e) {
				dhx.assert_error(e);
				return null
			}
			data = dhx.temp
		}
		if (data.data) {
			var t = data.data.config = {};
			for (var key in data) {
				if (key != "data") {
					t[key] = data[key]
				}
			}
			data = data.data
		}
		return data
	},
	getRecords: function(a) {
		if (a && !dhx.isArray(a)) {
			return [a]
		}
		return a
	},
	getDetails: function(a) {
		if (typeof a == "string") {
			return {
				id: dhx.uid(),
				value: a
			}
		}
		return a
	},
	getInfo: function(c) {
		var a = c.config;
		if (!a) {
			return {}
		}
		return {
			_size: (a.total_count || 0),
			_from: (a.pos || 0),
			_parent: (a.parent || 0),
			_config: (a.config),
			_key: (a.dhx_security)
		}
	},
	child: "data"
};
dhx.DataDriver.html = {
	toObject: function(c) {
		if (typeof c == "string") {
			var a = null;
			if (c.indexOf("<") == -1) {
				a = dhx.toNode(c)
			}
			if (!a) {
				a = document.createElement("DIV");
				a.innerHTML = c
			}
			return a.getElementsByTagName(this.tag)
		}
		return c
	},
	getRecords: function(c) {
		var g = [];
		for (var a = 0; a < c.childNodes.length; a++) {
			var l = c.childNodes[a];
			if (l.nodeType == 1) {
				g.push(l)
			}
		}
		return g
	},
	getDetails: function(a) {
		return dhx.DataDriver.xml.tagToObject(a)
	},
	getInfo: function(a) {
		return {
			_size: 0,
			_from: 0
		}
	},
	tag: "LI"
};
dhx.DataDriver.jsarray = {
	toObject: function(data) {
		if (typeof data == "string") {
			eval("dhx.temp=" + data);
			return dhx.temp
		}
		return data
	},
	getRecords: function(a) {
		return a
	},
	getDetails: function(g) {
		var a = {};
		for (var c = 0; c < g.length; c++) {
			a["data" + c] = g[c]
		}
		return a
	},
	getInfo: function(a) {
		return {
			_size: 0,
			_from: 0
		}
	}
};
dhx.DataDriver.csv = {
	toObject: function(a) {
		return a
	},
	getRecords: function(a) {
		return a.split(this.row)
	},
	getDetails: function(g) {
		g = this.stringToArray(g);
		var a = {};
		for (var c = 0; c < g.length; c++) {
			a["data" + c] = g[c]
		}
		return a
	},
	getInfo: function(a) {
		return {
			_size: 0,
			_from: 0
		}
	},
	stringToArray: function(c) {
		c = c.split(this.cell);
		for (var a = 0; a < c.length; a++) {
			c[a] = c[a].replace(/^[ \t\n\r]*(\"|)/g, "").replace(/(\"|)[ \t\n\r]*$/g, "")
		}
		return c
	},
	row: "\n",
	cell: ","
};
dhx.DataDriver.xml = {
	_isValidXML: function(a) {
		if (!a || !a.documentElement) {
			return null
		}
		if (a.getElementsByTagName("parsererror").length) {
			return null
		}
		return a
	},
	toObject: function(g, a) {
		if (this._isValidXML(c)) {
			return c
		}
		if (typeof g == "string") {
			var c = this.fromString(g.replace(/^[\s]+/, ""))
		} else {
			c = g
		}
		if (this._isValidXML(c)) {
			return c
		}
		return null
	},
	getRecords: function(a) {
		return this.xpath(a, this.records)
	},
	records: "/*/item",
	child: "item",
	config: "/*/config",
	getDetails: function(a) {
		return this.tagToObject(a, {})
	},
	getInfo: function(c) {
		var a = this.xpath(c, this.config);
		if (a.length) {
			a = this.assignTypes(this.tagToObject(a[0], {}))
		} else {
			a = null
		}
		return {
			_size: (c.documentElement.getAttribute("total_count") || 0),
			_from: (c.documentElement.getAttribute("pos") || 0),
			_parent: (c.documentElement.getAttribute("parent") || 0),
			_config: a,
			_key: (c.documentElement.getAttribute("dhx_security") || null)
		}
	},
	xpath: function(l, r) {
		if (window.XPathResult) {
			var g = l;
			if (l.nodeName.indexOf("document") == -1) {
				l = l.ownerDocument
			}
			var o = [];
			var c = l.evaluate(r, g, null, XPathResult.ANY_TYPE, null);
			var q = c.iterateNext();
			while (q) {
				o.push(q);
				q = c.iterateNext()
			}
			return o
		} else {
			var n = true;
			try {
				if (typeof(l.selectNodes) == "undefined") {
					n = false
				}
			} catch (m) {}
			if (n) {
				return l.selectNodes(r)
			} else {
				var a = r.split("/").pop();
				return l.getElementsByTagName(a)
			}
		}
	},
	assignTypes: function(c) {
		for (var a in c) {
			var g = c[a];
			if (typeof g == "object") {
				this.assignTypes(g)
			} else {
				if (typeof g == "string") {
					if (g === "") {
						continue
					}
					if (g == "true") {
						c[a] = true
					} else {
						if (g == "false") {
							c[a] = false
						} else {
							if (g == g * 1) {
								c[a] = c[a] * 1
							}
						}
					}
				}
			}
		}
		return c
	},
	tagToObject: function(g, r) {
		r = r || {};
		var m = false;
		var l = g.attributes;
		if (l && l.length) {
			for (var o = 0; o < l.length; o++) {
				r[l[o].name] = l[o].value
			}
			m = true
		}
		var c = g.childNodes;
		var q = {};
		for (var o = 0; o < c.length; o++) {
			if (c[o].nodeType == 1) {
				var n = c[o].tagName;
				if (typeof r[n] != "undefined") {
					if (!dhx.isArray(r[n])) {
						r[n] = [r[n]]
					}
					r[n].push(this.tagToObject(c[o], {}))
				} else {
					r[c[o].tagName] = this.tagToObject(c[o], {})
				}
				m = true
			}
		}
		if (!m) {
			return this.nodeValue(g)
		}
		r.value = r.value || this.nodeValue(g);
		return r
	},
	nodeValue: function(a) {
		if (a.firstChild) {
			return a.firstChild.data
		}
		return ""
	},
	fromString: function(g) {
		try {
			if (window.DOMParser) {
				return (new DOMParser()).parseFromString(g, "text/xml")
			}
			if (window.ActiveXObject) {
				var a = new ActiveXObject("Microsoft.xmlDOM");
				a.loadXML(g);
				return a
			}
		} catch (c) {
			dhx.assert_error(c);
			return null
		}
		dhx.assert_error("Load from xml string is not supported")
	}
};
dhx.DataLoader = dhx.proto({
	$init: function(a) {
		a = a || "";
		this._ajax_queue = dhx.toArray();
		this.data = new dhx.DataStore();
		this.data.attachEvent("onClearAll", dhx.bind(this._call_onclearall, this));
		this.data.attachEvent("onServerConfig", dhx.bind(this._call_on_config, this));
		this.data.feed = this._feed
	},
	_feed: function(g, a, c) {
		if (this._load_count) {
			return this._load_count = [g, a, c]
		} else {
			this._load_count = true
		}
		this._feed_last = [g, a];
		this._feed_common.call(this, g, a, c)
	},
	_feed_common: function(l, c, g) {
		var a = this.data.url;
		if (l < 0) {
			l = 0
		}
		this.load(a + ((a.indexOf("?") == -1) ? "?" : "&") + (this.dataCount() ? ("continue=true&") : "") + "start=" + l + "&count=" + c, [this._feed_callback, g])
	},
	_feed_callback: function() {
		var a = this._load_count;
		var c = this._feed_last;
		this._load_count = false;
		if (typeof a == "object" && (a[0] != c[0] || a[1] != c[1])) {
			this.data.feed.apply(this, a)
		}
	},
	load: function(a, c) {
		var g = dhx.AtomDataLoader.load.apply(this, arguments);
		this._ajax_queue.push(g);
		if (!this.data.url) {
			this.data.url = a
		}
	},
	loadNext: function(g, m, l, c, a) {
		if (this._settings.datathrottle && !a) {
			if (this._throttle_request) {
				window.clearTimeout(this._throttle_request)
			}
			this._throttle_request = dhx.delay(function() {
				this.loadNext(g, m, l, c, true)
			}, this, 0, this._settings.datathrottle);
			return
		}
		if (!m && m !== 0) {
			m = this.dataCount()
		}
		this.data.url = this.data.url || c;
		if (this.callEvent("onDataRequest", [m, g, l, c]) && this.data.url) {
			this.data.feed.call(this, m, g, l)
		}
	},
	_maybe_loading_already: function(c, g) {
		var a = this._feed_last;
		if (this._load_count && a) {
			if (a[0] <= g && (a[1] + a[0] >= c + g)) {
				return true
			}
		}
		return false
	},
	_onLoad: function(l, c, a) {
		this._ajax_queue.remove(a);
		var g = this.data.driver.toObject(l, c);
		if (g) {
			this.data._parse(g)
		} else {
			return this._onLoadError(l, c, a)
		}
		this._call_onready();
		this.callEvent("onXLE", [])
	},
	removeMissed_setter: function(a) {
		return this.data._removeMissed = a
	},
	scheme_setter: function(a) {
		this.data.scheme(a)
	},
	dataFeed_setter: function(a) {
		this.data.attachEvent("onBeforeFilter", dhx.bind(function(o, n) {
			if (this._settings.dataFeed) {
				var m = {};
				if (!o && !n) {
					return
				}
				if (typeof o == "function") {
					if (!n) {
						return
					}
					o(n, m)
				} else {
					m = {
						text: n
					}
				}
				this.clearAll();
				var c = this._settings.dataFeed;
				var l = [];
				if (typeof c == "function") {
					return c.call(this, n, m)
				}
				for (var g in m) {
					l.push("dhx_filter[" + g + "]=" + encodeURIComponent(m[g]))
				}
				this.load(c + (c.indexOf("?") < 0 ? "?" : "&") + l.join("&"), this._settings.datatype);
				return false
			}
		}, this));
		return a
	},
	debug_freid_c_ready: true,
	debug_freid_c_datathrottle: true,
	_call_onready: function() {
		if (this._settings.ready && !this._ready_was_used) {
			var a = dhx.toFunctor(this._settings.ready);
			if (a) {
				dhx.delay(a, this, arguments)
			}
			this._ready_was_used = true
		}
	},
	_call_onclearall: function() {
		for (var a = 0; a < this._ajax_queue.length; a++) {
			this._ajax_queue[a].abort()
		}
		this._ajax_queue = dhx.toArray()
	},
	_call_on_config: function(a) {
		this._parseSeetingColl(a)
	}
}, dhx.AtomDataLoader);
dhx.DataStore = function() {
	this.name = "DataStore";
	dhx.extend(this, dhx.EventSystem);
	this.setDriver("json");
	this.pull = {};
	this.order = dhx.toArray();
	this._marks = {}
};
dhx.DataStore.prototype = {
	setDriver: function(a) {
		dhx.assert(dhx.DataDriver[a], "incorrect DataDriver");
		this.driver = dhx.DataDriver[a]
	},
	_parse: function(g, a) {
		this.callEvent("onParse", [this.driver, g]);
		if (this._filter_order) {
			this.filter()
		}
		var l = this.driver.getInfo(g);
		if (l._key) {
			dhx.securityKey = l._key
		}
		if (l._config) {
			this.callEvent("onServerConfig", [l._config])
		}
		var c = this.driver.getRecords(g);
		this._inner_parse(l, c);
		if (this._scheme_group && this._group_processing) {
			this._group_processing(this._scheme_group)
		}
		if (this._scheme_sort) {
			this.blockEvent();
			this.sort(this._scheme_sort);
			this.unblockEvent()
		}
		this.callEvent("onStoreLoad", [this.driver, g]);
		this.refresh()
	},
	_inner_parse: function(c, o) {
		var r = (c._from || 0) * 1;
		var n = true;
		var q = false;
		if (r === 0 && this.order[0]) {
			if (this._removeMissed) {
				q = {};
				for (var l = 0; l < this.order.length; l++) {
					q[this.order[l]] = true
				}
			}
			n = false;
			r = this.order.length
		}
		var g = 0;
		for (var l = 0; l < o.length; l++) {
			var s = this.driver.getDetails(o[l]);
			var a = this.id(s);
			if (!this.pull[a]) {
				this.order[g + r] = a;
				g++
			} else {
				if (n && this.order[g + r]) {
					g++
				}
			}
			if (this.pull[a]) {
				dhx.extend(this.pull[a], s, true);
				if (this._scheme_update) {
					this._scheme_update(this.pull[a])
				}
				if (q) {
					delete q[a]
				}
			} else {
				this.pull[a] = s;
				if (this._scheme_init) {
					this._scheme_init(s)
				}
			}
		}
		if (q) {
			this.blockEvent();
			for (var m in q) {
				this.remove(m)
			}
			this.unblockEvent()
		}
		if (!this.order[c._size - 1]) {
			this.order[c._size - 1] = dhx.undefined
		}
	},
	id: function(a) {
		return a.id || (a.id = dhx.uid())
	},
	changeId: function(c, a) {
		if (this.pull[c]) {
			this.pull[a] = this.pull[c]
		}
		this.pull[a].id = a;
		this.order[this.order.find(c)] = a;
		if (this._filter_order) {
			this._filter_order[this._filter_order.find(c)] = a
		}
		if (this._marks[c]) {
			this._marks[a] = this._marks[c];
			delete this._marks[c]
		}
		this.callEvent("onIdChange", [c, a]);
		if (this._render_change_id) {
			this._render_change_id(c, a)
		}
		delete this.pull[c]
	},
	item: function(a) {
		return this.pull[a]
	},
	update: function(c, a) {
		if (dhx.isUndefined(a)) {
			a = this.item(c)
		}
		if (this._scheme_update) {
			this._scheme_update(a)
		}
		if (this.callEvent("onBeforeUpdate", [c, a]) === false) {
			return false
		}
		this.pull[c] = a;
		this.callEvent("onStoreUpdated", [c, a, "update"])
	},
	refresh: function(a) {
		if (this._skip_refresh) {
			return
		}
		if (a) {
			this.callEvent("onStoreUpdated", [a, this.pull[a], "paint"])
		} else {
			this.callEvent("onStoreUpdated", [null, null, null])
		}
	},
	silent: function(c, a) {
		this._skip_refresh = true;
		c.call(a || this);
		this._skip_refresh = false
	},
	getRange: function(l, g) {
		if (l) {
			l = this.indexById(l)
		} else {
			l = (this.$min || this.startOffset) || 0
		}
		if (g) {
			g = this.indexById(g)
		} else {
			g = Math.min(((this.$max || this.endOffset) || Infinity), (this.dataCount() - 1));
			if (g < 0) {
				g = 0
			}
		}
		if (l > g) {
			var c = g;
			g = l;
			l = c
		}
		return this.getIndexRange(l, g)
	},
	getIndexRange: function(l, g) {
		g = Math.min((g || Infinity), this.dataCount() - 1);
		var a = dhx.toArray();
		for (var c = (l || 0); c <= g; c++) {
			a.push(this.item(this.order[c]))
		}
		return a
	},
	dataCount: function() {
		return this.order.length
	},
	exists: function(a) {
		return !!(this.pull[a])
	},
	move: function(a, l) {
		dhx.assert(a >= 0 && l >= 0, "DataStore::move", "Incorrect indexes");
		var g = this.idByIndex(a);
		var c = this.item(g);
		this.order.removeAt(a);
		this.order.insertAt(g, Math.min(this.order.length, l));
		this.callEvent("onStoreUpdated", [g, c, "move"])
	},
	scheme: function(a) {
		this._scheme = {};
		this._scheme_init = a.$init;
		this._scheme_update = a.$update;
		this._scheme_serialize = a.$serialize;
		this._scheme_group = a.$group;
		this._scheme_sort = a.$sort;
		for (var c in a) {
			if (c.substr(0, 1) != "$") {
				this._scheme[c] = a[c]
			}
		}
	},
	sync: function(l, g, a) {
		if (typeof l == "string") {
			l = $$("source")
		}
		if (typeof g != "function") {
			a = g;
			g = null
		}
		if (dhx.debug_bind) {
			this.debug_sync_master = l;
			dhx.log("[sync] " + this.debug_bind_master.name + "@" + this.debug_bind_master._settings.id + " <= " + this.debug_sync_master.name + "@" + this.debug_sync_master._settings.id)
		}
		this._backbone_source = false;
		if (l.name != "DataStore") {
			if (l.data && l.data.name == "DataStore") {
				l = l.data
			} else {
				this._backbone_source = true
			}
		}
		var c = dhx.bind(function(q, m, o) {
			if (this._backbone_source) {
				if (!q) {
					return
				}
				if (q.indexOf("change") === 0) {
					if (q == "change") {
						this.pull[m.id] = m.attributes;
						this.refresh(m.id);
						return
					} else {
						return
					}
				}
				if (q == "reset") {
					o = m
				}
				this.order = [];
				this.pull = {};
				this._filter_order = null;
				for (var n = 0; n < o.models.length; n++) {
					var r = o.models[n].id;
					this.order.push(r);
					this.pull[r] = o.models[n].attributes
				}
			} else {
				this._filter_order = null;
				this.order = dhx.toArray([].concat(l.order));
				this.pull = l.pull
			}
			if (g) {
				this.silent(g)
			}
			if (this._on_sync) {
				this._on_sync()
			}
			if (dhx.debug_bind) {
				dhx.log("[sync:request] " + this.debug_sync_master.name + "@" + this.debug_sync_master._settings.id + " <= " + this.debug_bind_master.name + "@" + this.debug_bind_master._settings.id)
			}
			this.callEvent("onSyncApply", []);
			if (!a) {
				this.refresh()
			} else {
				a = false
			}
		}, this);
		if (this._backbone_source) {
			l.bind("all", c)
		} else {
			this._sync_events = [l.attachEvent("onStoreUpdated", c), l.attachEvent("onIdChange", dhx.bind(function(m, n) {
				this.changeId(m, n)
			}, this))]
		}
		c()
	},
	add: function(n, c) {
		if (this._scheme) {
			for (var g in this._scheme) {
				if (dhx.isUndefined(n[g])) {
					n[g] = this._scheme[g]
				}
			}
		}
		if (this._scheme_init) {
			this._scheme_init(n)
		}
		var o = this.id(n);
		var a = arguments[2] || this.order;
		var m = a.length;
		if (dhx.isUndefined(c) || c < 0) {
			c = m
		}
		if (c > m) {
			dhx.log("Warning", "DataStore:add", "Index of out of bounds");
			c = Math.min(a.length, c)
		}
		if (this.callEvent("onBeforeAdd", [o, n, c]) === false) {
			return false
		}
		dhx.assert(!this.exists(o), "Not unique ID");
		this.pull[o] = n;
		a.insertAt(o, c);
		if (this._filter_order) {
			var l = this._filter_order.length;
			if (!c && this.order.length) {
				l = 0
			}
			this._filter_order.insertAt(o, l)
		}
		this.callEvent("onAfterAdd", [o, c]);
		this.callEvent("onStoreUpdated", [o, n, "add"]);
		return o
	},
	remove: function(g) {
		if (dhx.isArray(g)) {
			for (var a = 0; a < g.length; a++) {
				this.remove(g[a])
			}
			return
		}
		if (this.callEvent("onBeforeDelete", [g]) === false) {
			return false
		}
		dhx.assert(this.exists(g), "Not existing ID in remove command" + g);
		var c = this.item(g);
		this.order.remove(g);
		if (this._filter_order) {
			this._filter_order.remove(g)
		}
		delete this.pull[g];
		if (this._marks[g]) {
			delete this._marks[g]
		}
		this.callEvent("onAfterDelete", [g]);
		this.callEvent("onStoreUpdated", [g, c, "delete"])
	},
	clearAll: function() {
		this.pull = {};
		this.order = dhx.toArray();
		this._filter_order = this.url = null;
		this.callEvent("onClearAll", []);
		this.refresh()
	},
	idByIndex: function(a) {
		if (a >= this.order.length || a < 0) {
			dhx.log("Warning", "DataStore::idByIndex Incorrect index")
		}
		return this.order[a]
	},
	indexById: function(c) {
		var a = this.order.find(c);
		if (!this.pull[c]) {
			dhx.log("Warning", "DataStore::indexById Non-existing ID: " + c)
		}
		return a
	},
	next: function(c, a) {
		return this.order[this.indexById(c) + (a || 1)]
	},
	first: function() {
		return this.order[0]
	},
	last: function() {
		return this.order[this.order.length - 1]
	},
	previous: function(c, a) {
		return this.order[this.indexById(c) - (a || 1)]
	},
	sort: function(m, c, a) {
		var g = m;
		if (typeof m == "function") {
			g = {
				as: m,
				dir: c
			}
		} else {
			if (typeof m == "string") {
				g = {
					by: m.replace(/#/g, ""),
					dir: c,
					as: a
				}
			}
		}
		var l = [g.by, g.dir, g.as];
		if (!this.callEvent("onBeforeSort", l)) {
			return
		}
		this._sort_core(g);
		this.refresh();
		this.callEvent("onAfterSort", l)
	},
	_sort_core: function(a) {
		if (this.order.length) {
			var g = this._sort._create(a);
			var c = this.getRange(this.first(), this.last());
			c.sort(g);
			this.order = c.map(function(l) {
				dhx.assert(l, "Client sorting can't be used with dynamic loading");
				return this.id(l)
			}, this)
		}
	},
	_filter_reset: function(a) {
		if (this._filter_order && !a) {
			this.order = this._filter_order;
			delete this._filter_order
		}
	},
	_filter_core: function(g, m, c) {
		var l = dhx.toArray();
		for (var a = 0; a < this.order.length; a++) {
			var n = this.order[a];
			if (g(this.item(n), m)) {
				l.push(n)
			}
		}
		if (!c || !this._filter_order) {
			this._filter_order = this.order
		}
		this.order = l
	},
	filter: function(l, g, a) {
		if (!this.callEvent("onBeforeFilter", [l, g])) {
			return
		}
		this._filter_reset(a);
		if (!this.order.length) {
			return
		}
		if (l) {
			var c = l;
			g = g || "";
			if (typeof l == "string") {
				l = l.replace(/#/g, "");
				if (typeof g == "function") {
					c = function(m) {
						return g(m[l])
					}
				} else {
					g = g.toString().toLowerCase();
					c = function(n, m) {
						dhx.assert(n, "Client side filtering can't be used with dynamic loading");
						return (n[l] || "").toString().toLowerCase().indexOf(m) != -1
					}
				}
			}
			this._filter_core(c, g, a, this._filterMode)
		}
		this.refresh();
		this.callEvent("onAfterFilter", [])
	},
	each: function(g, c) {
		for (var a = 0; a < this.order.length; a++) {
			g.call((c || this), this.item(this.order[a]))
		}
	},
	_methodPush: function(a, c) {
		return function() {
			return a[c].apply(a, arguments)
		}
	},
	addMark: function(m, l, a, c) {
		var g = this._marks[m] || {};
		this._marks[m] = g;
		if (!g[l]) {
			g[l] = c || true;
			if (a) {
				this.item(m).$css = (this.item(m).$css || "") + " " + l;
				this.refresh(m)
			}
		}
		return g[l]
	},
	removeMark: function(m, l, a) {
		var g = this._marks[m];
		if (g && g[l]) {
			delete g[l]
		}
		if (a) {
			var c = this.item(m).$css;
			if (c) {
				this.item(m).$css = c.replace(l, "");
				this.refresh(m)
			}
		}
	},
	hasMark: function(g, c) {
		var a = this._marks[g];
		return (a && a[c])
	},
	provideApi: function(l, c) {
		this.debug_bind_master = l;
		if (c) {
			this.mapEvent({
				onbeforesort: l,
				onaftersort: l,
				onbeforeadd: l,
				onafteradd: l,
				onbeforedelete: l,
				onafterdelete: l,
				onbeforeupdate: l
			})
		}
		var g = ["sort", "add", "remove", "exists", "idByIndex", "indexById", "item", "update", "refresh", "dataCount", "filter", "next", "previous", "clearAll", "first", "last", "serialize", "sync", "addMark", "removeMark", "hasMark"];
		for (var a = 0; a < g.length; a++) {
			l[g[a]] = this._methodPush(this, g[a])
		}
	},
	serialize: function() {
		var l = this.order;
		var a = [];
		for (var c = 0; c < l.length; c++) {
			var g = this.pull[l[c]];
			if (this._scheme_serialize) {
				g = this._scheme_serialize(g);
				if (g === false) {
					continue
				}
			}
			a.push(g)
		}
		return a
	},
	_sort: {
		_create: function(a) {
			return this._dir(a.dir, this._by(a.by, a.as))
		},
		_as: {
			date: function(g, c) {
				g = g - 0;
				c = c - 0;
				return g > c ? 1 : (g < c ? -1 : 0)
			},
			"int": function(g, c) {
				g = g * 1;
				c = c * 1;
				return g > c ? 1 : (g < c ? -1 : 0)
			},
			string_strict: function(g, c) {
				g = g.toString();
				c = c.toString();
				return g > c ? 1 : (g < c ? -1 : 0)
			},
			string: function(g, c) {
				if (!c) {
					return 1
				}
				if (!g) {
					return -1
				}
				g = g.toString().toLowerCase();
				c = c.toString().toLowerCase();
				return g > c ? 1 : (g < c ? -1 : 0)
			}
		},
		_by: function(c, a) {
			if (!c) {
				return a
			}
			if (typeof a != "function") {
				a = this._as[a || "string"]
			}
			dhx.assert(a, "Invalid sorting method");
			return function(l, g) {
				return a(l[c], g[c])
			}
		},
		_dir: function(c, a) {
			if (c == "asc" || !c) {
				return a
			}
			return function(l, g) {
				return a(l, g) * -1
			}
		}
	}
};
dhx.BaseBind = {
	debug_freid_ignore: {
		id: true
	},
	bind: function(m, l, g) {
		if (typeof m == "string") {
			m = dhx.ui.get(m)
		}
		if (m._initBindSource) {
			m._initBindSource()
		}
		if (this._initBindSource) {
			this._initBindSource()
		}
		if (!m.getBindData) {
			dhx.extend(m, dhx.BindSource)
		}
		if (!this._bind_ready) {
			var n = this.render;
			if (this.filter) {
				var c = this._settings.id;
				this.data._on_sync = function() {
					m._bind_updated[c] = false
				}
			}
			this.render = function() {
				if (this._in_bind_processing) {
					return
				}
				this._in_bind_processing = true;
				var o = this.callEvent("onBindRequest");
				this._in_bind_processing = false;
				return n.apply(this, ((o === false) ? arguments : []))
			};
			if (this.getValue || this.getValues) {
				this.save = function() {
					if (this.validate && !this.validate()) {
						return
					}
					m.setBindData((this.getValue ? this.getValue : this.getValues()), this._settings.id)
				}
			}
			this._bind_ready = true
		}
		m.addBind(this._settings.id, l, g);
		if (dhx.debug_bind) {
			dhx.log("[bind] " + this.name + "@" + this._settings.id + " <= " + m.name + "@" + m._settings.id)
		}
		var a = this._settings.id;
		this.attachEvent(this.touchable ? "onAfterRender" : "onBindRequest", function() {
			return m.getBindData(a)
		});
		if (!this._settings.dataFeed && this.loadNext) {
			this.data.attachEvent("onStoreLoad", function() {
				m._bind_updated[a] = false
			})
		}
		if (this.isVisible(this._settings.id)) {
			this.refresh()
		}
	},
	unbind: function(a) {
		return this._unbind(a)
	},
	_unbind: function(g) {
		g.removeBind(this._settings.id);
		var c = (this._sync_events || (this.data ? this.data._sync_events : 0));
		if (c && g.data) {
			for (var a = 0; a < c.length; a++) {
				g.data.detachEvent(c[a])
			}
		}
	}
};
dhx.BindSource = {
	$init: function() {
		this._bind_hash = {};
		this._bind_updated = {};
		this._ignore_binds = {};
		this._bind_specific_rules(this)
	},
	saveBatch: function(a) {
		this._do_not_update_binds = true;
		a.call(this);
		this._do_not_update_binds = false;
		this._update_binds()
	},
	setBindData: function(c, a) {
		if (a) {
			this._ignore_binds[a] = true
		}
		if (dhx.debug_bind) {
			dhx.log("[bind:save] " + this.name + "@" + this._settings.id + " <= @" + a)
		}
		if (this.setValue) {
			this.setValue(c)
		} else {
			if (this.setValues) {
				this.setValues(c)
			} else {
				var g = this.getCursor();
				if (g) {
					c = dhx.extend(this.item(g), c, true);
					this.update(g, c)
				}
			}
		}
		this.callEvent("onBindUpdate", [c, a]);
		if (this.save) {
			this.save()
		}
		if (a) {
			this._ignore_binds[a] = false
		}
	},
	getBindData: function(a, g) {
		if (this._bind_updated[a]) {
			return false
		}
		var c = dhx.ui.get(a);
		if (c.isVisible(c._settings.id)) {
			this._bind_updated[a] = true;
			if (dhx.debug_bind) {
				dhx.log("[bind:request] " + this.name + "@" + this._settings.id + " => " + c.name + "@" + c._settings.id)
			}
			this._bind_update(c, this._bind_hash[a][0], this._bind_hash[a][1]);
			if (g && c.filter) {
				c.refresh()
			}
		}
	},
	addBind: function(a, g, c) {
		this._bind_hash[a] = [g, c]
	},
	removeBind: function(a) {
		delete this._bind_hash[a];
		delete this._bind_updated[a];
		delete this._ignore_binds[a]
	},
	_bind_specific_rules: function(a) {
		if (a.filter) {
			dhx.extend(this, dhx.CollectionBind)
		} else {
			if (a.setValue) {
				dhx.extend(this, dhx.ValueBind)
			} else {
				dhx.extend(this, dhx.RecordBind)
			}
		}
	},
	_update_binds: function() {
		if (!this._do_not_update_binds) {
			for (var a in this._bind_hash) {
				if (this._ignore_binds[a]) {
					continue
				}
				this._bind_updated[a] = false;
				this.getBindData(a, true)
			}
		}
	},
	_bind_update_common: function(g, c, a) {
		if (g.setValue) {
			g.setValue(a ? a[c] : a)
		} else {
			if (!g.filter) {
				if (!a && g.clear) {
					g.clear()
				} else {
					if (g._check_data_feed(a)) {
						g.setValues(dhx.clone(a))
					}
				}
			} else {
				g.data.silent(function() {
					this.filter(c, a)
				})
			}
		}
		g.callEvent("onBindApply", [a, c, this])
	}
};
dhx.DataValue = dhx.proto({
	name: "DataValue",
	isVisible: function() {
		return true
	},
	$init: function(a) {
		this.data = "" || a;
		var c = (a && a.id) ? a.id : dhx.uid();
		this._settings = {
			id: c
		};
		dhx.ui.views[c] = this
	},
	setValue: function(a) {
		this.data = a;
		this.callEvent("onChange", [a])
	},
	getValue: function() {
		return this.data
	},
	refresh: function() {
		this.callEvent("onBindRequest")
	}
}, dhx.EventSystem, dhx.BaseBind);
dhx.DataRecord = dhx.proto({
	name: "DataRecord",
	isVisible: function() {
		return true
	},
	$init: function(a) {
		this.data = a || {};
		var c = (a && a.id) ? a.id : dhx.uid();
		this._settings = {
			id: c
		};
		dhx.ui.views[c] = this
	},
	getValues: function() {
		return this.data
	},
	setValues: function(a) {
		this.data = a;
		this.callEvent("onChange", [a])
	},
	refresh: function() {
		this.callEvent("onBindRequest")
	}
}, dhx.EventSystem, dhx.BaseBind, dhx.AtomDataLoader, dhx.Settings);
dhx.DataCollection = dhx.proto({
	name: "DataCollection",
	isVisible: function() {
		if (!this.data.order.length && !this.data._filter_order && !this._settings.dataFeed) {
			return false
		}
		return true
	},
	$init: function(a) {
		this.data.provideApi(this, true);
		var c = (a && a.id) ? a.id : dhx.uid();
		this._settings.id = c;
		dhx.ui.views[c] = this;
		this.data.attachEvent("onStoreLoad", dhx.bind(function() {
			this.callEvent("onBindRequest", [])
		}, this))
	},
	refresh: function() {
		this.callEvent("onBindRequest", [])
	}
}, dhx.DataLoader, dhx.EventSystem, dhx.BaseBind, dhx.Settings);
dhx.ValueBind = {
	$init: function() {
		this.attachEvent("onChange", this._update_binds)
	},
	_bind_update: function(m, l, g) {
		var c = this.getValue() || "";
		if (g) {
			c = g(c)
		}
		if (m.setValue) {
			m.setValue(c)
		} else {
			if (!m.filter) {
				var a = {};
				a[l] = c;
				if (m._check_data_feed(c)) {
					m.setValues(a)
				}
			} else {
				m.data.silent(function() {
					this.filter(l, c)
				})
			}
		}
		m.callEvent("onBindApply", [c, l, this])
	}
};
dhx.RecordBind = {
	$init: function() {
		this.attachEvent("onChange", this._update_binds)
	},
	_bind_update: function(g, c) {
		var a = this.getValues() || null;
		this._bind_update_common(g, c, a)
	}
};
dhx.CollectionBind = {
	$init: function() {
		this._cursor = null;
		this.attachEvent("onSelectChange", function(c) {
			var a = this.getSelected();
			this.setCursor(a ? (a.id || a) : null)
		});
		this.attachEvent("onAfterCursorChange", this._update_binds);
		this.data.attachEvent("onStoreUpdated", dhx.bind(function(g, a, c) {
			if (g && g == this.getCursor() && c != "paint") {
				this._update_binds()
			}
		}, this));
		this.data.attachEvent("onClearAll", dhx.bind(function() {
			this._cursor = null
		}, this));
		this.data.attachEvent("onIdChange", dhx.bind(function(c, a) {
			if (this._cursor == c) {
				this._cursor = a
			}
		}, this))
	},
	setCursor: function(a) {
		if (a == this._cursor || (a !== null && !this.item(a))) {
			return
		}
		this.callEvent("onBeforeCursorChange", [this._cursor]);
		this._cursor = a;
		this.callEvent("onAfterCursorChange", [a])
	},
	getCursor: function() {
		return this._cursor
	},
	_bind_update: function(g, c) {
		var a = this.item(this.getCursor()) || this._settings.defaultData || null;
		this._bind_update_common(g, c, a)
	}
};
if (!dhx.ui) {
	dhx.ui = {}
}
if (!dhx.ui.views) {
	dhx.ui.views = {};
	dhx.ui.get = function(a) {
		if (a._settings) {
			return a
		}
		return dhx.ui.views[a]
	}
}
dhtmlXDataStore = function(c) {
	var g = new dhx.DataCollection(c);
	var a = "_dp_init";
	g[a] = function(m) {
		var l = "_methods";
		m[l] = ["dummy", "dummy", "changeId", "dummy"];
		this.data._old_names = {
			add: "inserted",
			update: "updated",
			"delete": "deleted"
		};
		this.data.attachEvent("onStoreUpdated", function(q, n, o) {
			if (q && !m._silent) {
				m.setUpdated(q, true, this._old_names[o])
			}
		});
		l = "_getRowData";
		m[l] = function(s, n) {
			var q = this.obj.data.item(s);
			var r = {
				id: s
			};
			r[this.action_param] = this.obj.getUserData(s);
			if (q) {
				for (var o in q) {
					r[o] = q[o]
				}
			}
			return r
		};
		this.changeId = function(o, n) {
			this.data.changeId(o, n);
			m._silent = true;
			this.data.callEvent("onStoreUpdated", [n, this.item(n), "update"]);
			m._silent = false
		};
		l = "_clearUpdateFlag";
		m[l] = function() {};
		this._userdata = {}
	};
	g.dummy = function() {};
	g.setUserData = function(n, l, m) {
		this._userdata[n] = m
	};
	g.getUserData = function(m, l) {
		return this._userdata[m]
	};
	g.dataFeed = function(l) {
		this.define("dataFeed", l)
	};
	dhx.extend(g, dhx.BindSource);
	return g
};
if (window.dhtmlXDataView) {
	dhtmlXDataView.prototype._initBindSource = function() {
		this.isVisible = function() {
			if (!this.data.order.length && !this.data._filter_order && !this._settings.dataFeed) {
				return false
			}
			return true
		};
		var a = "_settings";
		this._settings = this._settings || this[a];
		if (!this._settings.id) {
			this._settings.id = dhx.uid()
		}
		this.unbind = dhx.BaseBind.unbind;
		this.unsync = dhx.BaseBind.unsync;
		dhx.ui.views[this._settings.id] = this
	}
}
if (window.dhtmlXChart) {
	dhtmlXChart.prototype._initBindSource = function() {
		this.isVisible = function() {
			if (!this.data.order.length && !this.data._filtered_state && !this._settings.dataFeed) {
				return false
			}
			return true
		};
		var a = "_settings";
		this._settings = this._settings || this[a];
		if (!this._settings.id) {
			this._settings.id = dhx.uid()
		}
		this.unbind = dhx.BaseBind.unbind;
		this.unsync = dhx.BaseBind.unsync;
		dhx.ui.views[this._settings.id] = this
	}
}
dhx.BaseBind.unsync = function(a) {
	return dhx.BaseBind._unbind.call(this, a)
};
dhx.BaseBind.unbind = function(a) {
	return dhx.BaseBind._unbind.call(this, a)
};
dhx.BaseBind.legacyBind = function() {
	return dhx.BaseBind.bind.apply(this, arguments)
};
dhx.BaseBind.legacySync = function(a, c) {
	if (this._initBindSource) {
		this._initBindSource()
	}
	if (a._initBindSource) {
		a._initBindSource()
	}
	this.attachEvent("onAfterEditStop", function(g) {
		this.save(g);
		return true
	});
	this.attachEvent("onDataRequest", function(m, l) {
		for (var g = m; g < m + l; g++) {
			if (!a.data.order[g]) {
				a.loadNext(l, m);
				return false
			}
		}
	});
	this.save = function(n) {
		if (!n) {
			n = this.getCursor()
		}
		var m = this.item(n);
		var g = a.item(n);
		for (var l in m) {
			if (l.indexOf("$") !== 0) {
				g[l] = m[l]
			}
		}
		a.refresh(n)
	};
	if (a && a.name == "DataCollection") {
		return a.data.sync.apply(this.data, arguments)
	} else {
		return this.data.sync.apply(this.data, arguments)
	}
};
if (window.dhtmlXForm) {
	dhtmlXForm.prototype.bind = function(a) {
		dhx.BaseBind.bind.apply(this, arguments);
		a.getBindData(this._settings.id)
	};
	dhtmlXForm.prototype.unbind = function(a) {
		dhx.BaseBind._unbind.call(this, a)
	};
	dhtmlXForm.prototype._initBindSource = function() {
		if (dhx.isUndefined(this._settings)) {
			this._settings = {
				id: dhx.uid(),
				dataFeed: this._server_feed
			};
			dhx.ui.views[this._settings.id] = this
		}
	};
	dhtmlXForm.prototype._check_data_feed = function(c) {
		if (!this._settings.dataFeed || this._ignore_feed || !c) {
			return true
		}
		var a = this._settings.dataFeed;
		if (typeof a == "function") {
			return a.call(this, (c.id || c), c)
		}
		a = a + (a.indexOf("?") == -1 ? "?" : "&") + "action=get&id=" + encodeURIComponent(c.id || c);
		this.load(a);
		return false
	};
	dhtmlXForm.prototype.setValues = dhtmlXForm.prototype.setFormData;
	dhtmlXForm.prototype.getValues = function() {
		return this.getFormData(false, true)
	};
	dhtmlXForm.prototype.dataFeed = function(a) {
		if (this._settings) {
			this._settings.dataFeed = a
		} else {
			this._server_feed = a
		}
	};
	dhtmlXForm.prototype.refresh = dhtmlXForm.prototype.isVisible = function(a) {
		return true
	}
}
if (window.scheduler) {
	if (!window.Scheduler) {
		window.Scheduler = {}
	}
	Scheduler.$syncFactory = function(a) {
		a.sync = function(g, m) {
			if (this._initBindSource) {
				this._initBindSource()
			}
			if (g._initBindSource) {
				g._initBindSource()
			}
			var l = "_process_loading";
			var c = function(s) {
				a.clearAll();
				var n = g.data.order;
				var r = g.data.pull;
				var o = [];
				for (var q = 0; q < n.length; q++) {
					if (m && m.copy) {
						o[q] = dhx.clone(r[n[q]])
					} else {
						o[q] = r[n[q]]
					}
				}
				a[l](o);
				a.callEvent("onSyncApply", [])
			};
			this.save = function(q) {
				if (!q) {
					q = this.getCursor()
				}
				var o = this.item(q);
				var n = g.item(q);
				if (this.callEvent("onStoreSave", [q, o, n])) {
					dhx.extend(g.item(q), o, true);
					g.update(q)
				}
			};
			this.item = function(n) {
				return this.getEvent(n)
			};
			this._sync_events = [g.data.attachEvent("onStoreUpdated", function(q, n, o) {
				c.call(this)
			}), g.data.attachEvent("onIdChange", function(o, n) {
				combo.changeOptionId(o, n)
			})];
			this.attachEvent("onEventChanged", function(n) {
				this.save(n)
			});
			this.attachEvent("onEventAdded", function(o, n) {
				if (!g.data.pull[o]) {
					g.add(n)
				}
			});
			this.attachEvent("onEventDeleted", function(n) {
				if (g.data.pull[n]) {
					g.remove(n)
				}
			});
			c()
		};
		a.unsync = function(c) {
			dhx.BaseBind._unbind.call(this, c)
		};
		a._initBindSource = function() {
			if (!this._settings) {
				this._settings = {
					id: dhx.uid()
				}
			}
		}
	};
	Scheduler.$syncFactory(window.scheduler)
}
if (window.dhtmlXCombo) {
	dhtmlXCombo.prototype.bind = function() {
		dhx.BaseBind.bind.apply(this, arguments)
	};
	dhtmlXCombo.unbind = function(a) {
		dhx.BaseBind._unbind.call(this, a)
	};
	dhtmlXCombo.unsync = function(a) {
		dhx.BaseBind._unbind.call(this, a)
	};
	dhtmlXCombo.prototype.dataFeed = function(a) {
		if (this._settings) {
			this._settings.dataFeed = a
		} else {
			this._server_feed = a
		}
	};
	dhtmlXCombo.prototype.sync = function(c, l) {
		if (this._initBindSource) {
			this._initBindSource()
		}
		if (c._initBindSource) {
			c._initBindSource()
		}
		var g = this;
		var a = function(m) {
			g.clearAll();
			g.addOption(this.serialize());
			g.callEvent("onSyncApply", [])
		};
		this._sync_events = [c.data.attachEvent("onStoreUpdated", function(o, m, n) {
			a.call(this)
		}), c.data.attachEvent("onIdChange", function(n, m) {
			g.changeOptionId(n, m)
		})];
		a.call(c)
	};
	dhtmlXCombo.prototype._initBindSource = function() {
		if (dhx.isUndefined(this._settings)) {
			this._settings = {
				id: dhx.uid(),
				dataFeed: this._server_feed
			};
			dhx.ui.views[this._settings.id] = this;
			this.data = {
				silent: dhx.bind(function(a) {
					a.call(this)
				}, this)
			};
			dhx4._eventable(this.data);
			this.attachEvent("onChange", function() {
				this.callEvent("onSelectChange", [this.getSelectedValue()])
			});
			this.attachEvent("onXLE", function() {
				this.callEvent("onBindRequest", [])
			})
		}
	};
	dhtmlXCombo.prototype.item = function(a) {
		return this.getOption(a)
	};
	dhtmlXCombo.prototype.getSelected = function() {
		return this.getSelectedValue()
	};
	dhtmlXCombo.prototype.isVisible = function() {
		if (!this.optionsArr.length && !this._settings.dataFeed) {
			return false
		}
		return true
	};
	dhtmlXCombo.prototype.refresh = function() {
		this.render(true)
	}
}
if (window.dhtmlXGridObject) {
	dhtmlXGridObject.prototype.bind = function(a, g, c) {
		dhx.BaseBind.bind.apply(this, arguments)
	};
	dhtmlXGridObject.prototype.unbind = function(a) {
		dhx.BaseBind._unbind.call(this, a)
	};
	dhtmlXGridObject.prototype.unsync = function(a) {
		dhx.BaseBind._unbind.call(this, a)
	};
	dhtmlXGridObject.prototype.dataFeed = function(a) {
		if (this._settings) {
			this._settings.dataFeed = a
		} else {
			this._server_feed = a
		}
	};
	dhtmlXGridObject.prototype.sync = function(a, r) {
		if (this._initBindSource) {
			this._initBindSource()
		}
		if (a._initBindSource) {
			a._initBindSource()
		}
		var c = this;
		var q = "_parsing";
		var g = "_parser";
		var n = "_locator";
		var l = "_process_store_row";
		var o = "_get_store_data";
		this.save = function(s) {
			if (!s) {
				s = this.getCursor()
			}
			dhx.extend(a.item(s), this.item(s), true);
			a.update(s)
		};
		var m = function(y) {
			var v = c.getCursor ? c.getCursor() : null;
			var x = 0;
			if (c._legacy_ignore_next) {
				x = c._legacy_ignore_next;
				c._legacy_ignore_next = false
			} else {
				c.clearAll()
			}
			var u = this.dataCount();
			if (u) {
				c[q] = true;
				for (var s = x; s < u; s++) {
					var w = this.order[s];
					if (!w) {
						continue
					}
					if (x && c.rowsBuffer[s]) {
						continue
					}
					c.rowsBuffer[s] = {
						idd: w,
						data: this.pull[w]
					};
					c.rowsBuffer[s][g] = c[l];
					c.rowsBuffer[s][n] = c[o];
					c.rowsAr[w] = this.pull[w]
				}
				if (!c.rowsBuffer[u - 1]) {
					c.rowsBuffer[u - 1] = dhtmlx.undefined;
					c.xmlFileUrl = c.xmlFileUrl || this.url
				}
				if (c.pagingOn) {
					c.changePage()
				} else {
					if (c._srnd && c._fillers) {
						c._update_srnd_view()
					} else {
						c.render_dataset();
						c.callEvent("onXLE", [])
					}
				}
				c[q] = false
			}
			if (v && c.setCursor) {
				c.setCursor(c.rowsAr[v] ? v : null)
			}
			c.callEvent("onSyncApply", [])
		};
		this._sync_events = [a.data.attachEvent("onStoreUpdated", function(v, s, u) {
			if (u == "delete") {
				c.deleteRow(v);
				c.data.callEvent("onStoreUpdated", [v, s, u])
			} else {
				if (u == "update") {
					c.callEvent("onSyncUpdate", [s, u]);
					c.update(v, s);
					c.data.callEvent("onStoreUpdated", [v, s, u])
				} else {
					if (u == "add") {
						c.callEvent("onSyncUpdate", [s, u]);
						c.add(v, s, this.indexById(v));
						c.data.callEvent("onStoreUpdated", [v, s, u])
					} else {
						m.call(this)
					}
				}
			}
		}), a.data.attachEvent("onStoreLoad", function(u, s) {
			c.xmlFileUrl = a.data.url;
			c._legacy_ignore_next = u.getInfo(s)._from
		}), a.data.attachEvent("onIdChange", function(u, s) {
			c.changeRowId(u, s)
		})];
		c.attachEvent("onDynXLS", function(v, u) {
			for (var s = v; s < v + u; s++) {
				if (!a.data.order[s]) {
					a.loadNext(u, v);
					return false
				}
			}
			c._legacy_ignore_next = v;
			m.call(a.data)
		});
		m.call(a.data);
		c.attachEvent("onEditCell", function(s, x, v, u, w) {
			if (s == 2 && u != w) {
				this.save(x)
			}
			return true
		});
		c.attachEvent("onClearAll", function() {
			var s = "_f_rowsBuffer";
			this[s] = null
		});
		if (r && r.sort) {
			c.attachEvent("onBeforeSorting", function(v, u, s) {
				if (u == "connector") {
					return false
				}
				var w = this.getColumnId(v);
				a.sort("#" + w + "#", (s == "asc" ? "asc" : "desc"), (u == "int" ? u : "string"));
				c.setSortImgState(true, v, s);
				return false
			})
		}
		if (r && r.filter) {
			c.attachEvent("onFilterStart", function(v, s) {
				var u = "_con_f_used";
				if (c[u] && c[u].length) {
					return false
				}
				a.data.silent(function() {
					a.filter();
					for (var w = 0; w < v.length; w++) {
						if (s[w] == "") {
							continue
						}
						var x = c.getColumnId(v[w]);
						a.filter("#" + x + "#", s[w], w != 0)
					}
				});
				a.refresh();
				return false
			});
			c.collectValues = function(s) {
				var u = this.getColumnId(s);
				return (function(x) {
					var v = [];
					var w = {};
					this.data.each(function(A) {
						var y = A[x];
						if (!w[y]) {
							w[y] = true;
							v.push(y)
						}
					});
					v.sort();
					return v
				}).call(a, u)
			}
		}
		if (r && r.select) {
			c.attachEvent("onRowSelect", function(s) {
				a.setCursor(s)
			})
		}
		c.clearAndLoad = function(s) {
			a.clearAll();
			a.load(s)
		}
	};
	dhtmlXGridObject.prototype._initBindSource = function() {
		if (dhx.isUndefined(this._settings)) {
			this._settings = {
				id: dhx.uid(),
				dataFeed: this._server_feed
			};
			dhx.ui.views[this._settings.id] = this;
			this.data = {
				silent: dhx.bind(function(g) {
					g.call(this)
				}, this)
			};
			dhx4._eventable(this.data);
			var a = "_cCount";
			for (var c = 0; c < this[a]; c++) {
				if (!this.columnIds[c]) {
					this.columnIds[c] = "cell" + c
				}
			}
			this.attachEvent("onSelectStateChanged", function(g) {
				this.callEvent("onSelectChange", [g])
			});
			this.attachEvent("onSelectionCleared", function() {
				this.callEvent("onSelectChange", [null])
			});
			this.attachEvent("onEditCell", function(g, l) {
				if (g === 2 && this.getCursor) {
					if (l && l == this.getCursor()) {
						this._update_binds()
					}
				}
				return true
			});
			this.attachEvent("onXLE", function() {
				this.callEvent("onBindRequest", [])
			})
		}
	};
	dhtmlXGridObject.prototype.item = function(n) {
		if (n === null) {
			return null
		}
		var m = this.getRowById(n);
		if (!m) {
			return null
		}
		var a = "_attrs";
		var l = dhx.copy(m[a]);
		l.id = n;
		var g = this.getColumnsNum();
		for (var c = 0; c < g; c++) {
			l[this.columnIds[c]] = this.cells(n, c).getValue()
		}
		return l
	};
	dhtmlXGridObject.prototype.update = function(n, m) {
		for (var l = 0; l < this.columnIds.length; l++) {
			var g = this.columnIds[l];
			if (!dhx.isUndefined(m[g])) {
				this.cells(n, l).setValue(m[g])
			}
		}
		var c = "_attrs";
		var a = this.getRowById(n)[c];
		for (var g in m) {
			a[g] = m[g]
		}
		this.callEvent("onBindUpdate", [n])
	};
	dhtmlXGridObject.prototype.add = function(o, n, g) {
		var a = [];
		for (var m = 0; m < this.columnIds.length; m++) {
			var l = this.columnIds[m];
			a[m] = dhx.isUndefined(n[l]) ? "" : n[l]
		}
		this.addRow(o, a, g);
		var c = "_attrs";
		this.getRowById(o)[c] = dhx.copy(n)
	};
	dhtmlXGridObject.prototype.getSelected = function() {
		return this.getSelectedRowId()
	};
	dhtmlXGridObject.prototype.isVisible = function() {
		var a = "_f_rowsBuffer";
		if (!this.rowsBuffer.length && !this[a] && !this._settings.dataFeed) {
			return false
		}
		return true
	};
	dhtmlXGridObject.prototype.refresh = function() {
		this.render_dataset()
	};
	dhtmlXGridObject.prototype.filter = function(n, m) {
		if (this._settings.dataFeed) {
			var l = {};
			if (!n && !m) {
				return
			}
			if (typeof n == "function") {
				if (!m) {
					return
				}
				n(m, l)
			} else {
				if (dhx.isUndefined(n)) {
					l = m
				} else {
					l[n] = m
				}
			}
			this.clearAll();
			var a = this._settings.dataFeed;
			if (typeof a == "function") {
				return a.call(this, m, l)
			}
			var g = [];
			for (var c in l) {
				g.push("dhx_filter[" + c + "]=" + encodeURIComponent(l[c]))
			}
			this.load(a + (a.indexOf("?") < 0 ? "?" : "&") + g.join("&"));
			return false
		}
		if (m === null) {
			return this.filterBy(0, function() {
				return false
			})
		}
		this.filterBy(0, function(o, q) {
			return n.call(this, q, m)
		})
	}
}
if (window.dhtmlXTreeObject) {
	dhtmlXTreeObject.prototype.bind = function() {
		dhx.BaseBind.bind.apply(this, arguments)
	};
	dhtmlXTreeObject.prototype.unbind = function(a) {
		dhx.BaseBind._unbind.call(this, a)
	};
	dhtmlXTreeObject.prototype.dataFeed = function(a) {
		if (this._settings) {
			this._settings.dataFeed = a
		} else {
			this._server_feed = a
		}
	};
	dhtmlXTreeObject.prototype._initBindSource = function() {
		if (dhx.isUndefined(this._settings)) {
			this._settings = {
				id: dhx.uid(),
				dataFeed: this._server_feed
			};
			dhx.ui.views[this._settings.id] = this;
			this.data = {
				silent: dhx.bind(function(a) {
					a.call(this)
				}, this)
			};
			dhx4._eventable(this.data);
			this.attachEvent("onSelect", function(a) {
				this.callEvent("onSelectChange", [a])
			});
			this.attachEvent("onEdit", function(a, c) {
				if (a === 2) {
					if (c && c == this.getCursor()) {
						this._update_binds()
					}
				}
				return true
			})
		}
	};
	dhtmlXTreeObject.prototype.item = function(a) {
		if (a === null) {
			return null
		}
		return {
			id: a,
			text: this.getItemText(a)
		}
	};
	dhtmlXTreeObject.prototype.getSelected = function() {
		return this.getSelectedItemId()
	};
	dhtmlXTreeObject.prototype.isVisible = function() {
		return true
	};
	dhtmlXTreeObject.prototype.refresh = function() {};
	dhtmlXTreeObject.prototype.filter = function(n, m) {
		if (this._settings.dataFeed) {
			var l = {};
			if (!n && !m) {
				return
			}
			if (typeof n == "function") {
				if (!m) {
					return
				}
				n(m, l)
			} else {
				if (dhx.isUndefined(n)) {
					l = m
				} else {
					l[n] = m
				}
			}
			this.deleteChildItems(0);
			var a = this._settings.dataFeed;
			if (typeof a == "function") {
				return a.call(this, [(data.id || data), data])
			}
			var g = [];
			for (var c in l) {
				g.push("dhx_filter[" + c + "]=" + encodeURIComponent(l[c]))
			}
			this.loadXML(a + (a.indexOf("?") < 0 ? "?" : "&") + g.join("&"));
			return false
		}
	};
	dhtmlXTreeObject.prototype.update = function(c, a) {
		if (!dhx.isUndefined(a.text)) {
			this.setItemText(c, a.text)
		}
	}
}

function dataProcessor(a) {
	this.serverProcessor = a;
	this.action_param = "!nativeeditor_status";
	this.object = null;
	this.updatedRows = [];
	this.autoUpdate = true;
	this.updateMode = "cell";
	this._tMode = "GET";
	this._headers = null;
	this._payload = null;
	this.post_delim = "_";
	this._waitMode = 0;
	this._in_progress = {};
	this._invalid = {};
	this.mandatoryFields = [];
	this.messages = [];
	this.styles = {
		updated: "font-weight:bold;",
		inserted: "font-weight:bold;",
		deleted: "text-decoration : line-through;",
		invalid: "background-color:FFE0E0;",
		invalid_cell: "border-bottom:2px solid red;",
		error: "color:red;",
		clear: "font-weight:normal;text-decoration:none;"
	};
	this.enableUTFencoding(true);
	dhx4._eventable(this);
	return this
}
dataProcessor.prototype = {
	setTransactionMode: function(c, a) {
		if (typeof c == "object") {
			this._tMode = c.mode || this._tMode;
			this._headers = this._headers || c.headers;
			this._payload = this._payload || c.payload
		} else {
			this._tMode = c;
			this._tSend = a
		}
		if (this._tMode == "REST") {
			this._tSend = false;
			this._endnm = true
		}
	},
	escape: function(a) {
		if (this._utf) {
			return encodeURIComponent(a)
		} else {
			return escape(a)
		}
	},
	enableUTFencoding: function(a) {
		this._utf = dhx4.s2b(a)
	},
	setDataColumns: function(a) {
		this._columns = (typeof a == "string") ? a.split(",") : a
	},
	getSyncState: function() {
		return !this.updatedRows.length
	},
	enableDataNames: function(a) {
		this._endnm = dhx4.s2b(a)
	},
	enablePartialDataSend: function(a) {
		this._changed = dhx4.s2b(a)
	},
	setUpdateMode: function(c, a) {
		this.autoUpdate = (c == "cell");
		this.updateMode = c;
		this.dnd = a
	},
	ignore: function(c, a) {
		this._silent_mode = true;
		c.call(a || window);
		this._silent_mode = false
	},
	setUpdated: function(l, g, m) {
		if (this._silent_mode) {
			return
		}
		var c = this.findRow(l);
		m = m || "updated";
		var a = this.obj.getUserData(l, this.action_param);
		if (a && m == "updated") {
			m = a
		}
		if (g) {
			this.set_invalid(l, false);
			this.updatedRows[c] = l;
			this.obj.setUserData(l, this.action_param, m);
			if (this._in_progress[l]) {
				this._in_progress[l] = "wait"
			}
		} else {
			if (!this.is_invalid(l)) {
				this.updatedRows.splice(c, 1);
				this.obj.setUserData(l, this.action_param, "")
			}
		}
		if (!g) {
			this._clearUpdateFlag(l)
		}
		this.markRow(l, g, m);
		if (g && this.autoUpdate) {
			this.sendData(l)
		}
	},
	_clearUpdateFlag: function(a) {},
	markRow: function(n, g, m) {
		var l = "";
		var c = this.is_invalid(n);
		if (c) {
			l = this.styles[c];
			g = true
		}
		if (this.callEvent("onRowMark", [n, g, m, c])) {
			l = this.styles[g ? m : "clear"] + l;
			this.obj[this._methods[0]](n, l);
			if (c && c.details) {
				l += this.styles[c + "_cell"];
				for (var a = 0; a < c.details.length; a++) {
					if (c.details[a]) {
						this.obj[this._methods[1]](n, a, l)
					}
				}
			}
		}
	},
	getState: function(a) {
		return this.obj.getUserData(a, this.action_param)
	},
	is_invalid: function(a) {
		return this._invalid[a]
	},
	set_invalid: function(g, c, a) {
		if (a) {
			c = {
				value: c,
				details: a,
				toString: function() {
					return this.value.toString()
				}
			}
		}
		this._invalid[g] = c
	},
	checkBeforeUpdate: function(a) {
		return true
	},
	sendData: function(a) {
		if (this._waitMode && (this.obj.mytype == "tree" || this.obj._h2)) {
			return
		}
		if (this.obj.editStop) {
			this.obj.editStop()
		}
		if (typeof a == "undefined" || this._tSend) {
			return this.sendAllData()
		}
		if (this._in_progress[a]) {
			return false
		}
		this.messages = [];
		if (this.getState(a) !== "deleted") {
			if (!this.checkBeforeUpdate(a) && this.callEvent("onValidationError", [a, this.messages])) {
				return false
			}
		}
		this._beforeSendData(this._getRowData(a), a)
	},
	_beforeSendData: function(a, c) {
		if (!this.callEvent("onBeforeUpdate", [c, this.getState(c), a])) {
			return false
		}
		this._sendData(a, c)
	},
	serialize: function(l, m) {
		if (typeof l == "string") {
			return l
		}
		if (typeof m != "undefined") {
			return this.serialize_one(l, "")
		} else {
			var a = [];
			var g = [];
			for (var c in l) {
				if (l.hasOwnProperty(c)) {
					a.push(this.serialize_one(l[c], c + this.post_delim));
					g.push(c)
				}
			}
			a.push("ids=" + this.escape(g.join(",")));
			if (dhtmlx.security_key) {
				a.push("dhx_security=" + dhtmlx.security_key)
			}
			return a.join("&")
		}
	},
	serialize_one: function(l, c) {
		if (typeof l == "string") {
			return l
		}
		var a = [];
		for (var g in l) {
			if (l.hasOwnProperty(g)) {
				if ((g == "id" || g == this.action_param) && this._tMode == "REST") {
					continue
				}
				a.push(this.escape((c || "") + g) + "=" + this.escape(l[g]))
			}
		}
		return a.join("&")
	},
	_sendData: function(m, n) {
		if (!m) {
			return
		}
		if (!this.callEvent("onBeforeDataSending", n ? [n, this.getState(n), m] : [null, null, m])) {
			return false
		}
		if (n) {
			this._in_progress[n] = (new Date()).valueOf()
		}
		var s = this;
		var r = function(v) {
			var x = [];
			if (n) {
				x.push(n)
			} else {
				if (m) {
					for (var w in m) {
						x.push(w)
					}
				}
			}
			return s.afterUpdate(s, v, x)
		};
		var c = this.serverProcessor + (this._user ? (dhtmlx.url(this.serverProcessor) + ["dhx_user=" + this._user, "dhx_version=" + this.obj.getUserData(0, "version")].join("&")) : "");
		if (this._tMode == "GET") {
			dhx4.ajax.get(c + ((c.indexOf("?") != -1) ? "&" : "?") + this.serialize(m, n), r)
		} else {
			if (this._tMode == "POST") {
				dhx4.ajax.post(c, this.serialize(m, n), r)
			} else {
				if (this._tMode == "REST") {
					var g = this.getState(n);
					var l = c.replace(/(\&|\?)editing\=true/, "");
					var o = l.split("?");
					if (o[1]) {
						o[1] = "?" + o[1]
					}
					var q = "";
					var a = "post";
					if (g == "inserted") {
						q = this.serialize(m, n)
					} else {
						if (g == "deleted") {
							a = "DELETE";
							l = o[0] + n + o[1]
						} else {
							a = "PUT";
							q = this.serialize(m, n);
							l = o[0] + n + o[1]
						}
					}
					if (this._payload) {
						for (var u in this._payload) {
							l = l + (l.indexOf("?") === -1 ? "?" : "&") + this.escape(u) + "=" + this.escape(this._payload[u])
						}
					}
					dhx4.ajax.query({
						url: l,
						method: a,
						headers: this._headers,
						data: q,
						callback: r
					})
				}
			}
		}
		this._waitMode++
	},
	sendAllData: function() {
		if (!this.updatedRows.length) {
			return
		}
		this.messages = [];
		var c = true;
		for (var a = 0; a < this.updatedRows.length; a++) {
			if (this.getState(this.updatedRows[a]) !== "deleted") {
				c &= this.checkBeforeUpdate(this.updatedRows[a])
			}
		}
		if (!c && !this.callEvent("onValidationError", ["", this.messages])) {
			return false
		}
		if (this._tSend) {
			this._sendData(this._getAllData())
		} else {
			for (var a = 0; a < this.updatedRows.length; a++) {
				if (!this._in_progress[this.updatedRows[a]]) {
					if (this.is_invalid(this.updatedRows[a])) {
						continue
					}
					this._beforeSendData(this._getRowData(this.updatedRows[a]), this.updatedRows[a]);
					if (this._waitMode && (this.obj.mytype == "tree" || this.obj._h2)) {
						return
					}
				}
			}
		}
	},
	_getAllData: function(l) {
		var c = {};
		var a = false;
		for (var g = 0; g < this.updatedRows.length; g++) {
			var m = this.updatedRows[g];
			if (this._in_progress[m] || this.is_invalid(m)) {
				continue
			}
			if (!this.callEvent("onBeforeUpdate", [m, this.getState(m), this._getRowData(m)])) {
				continue
			}
			c[m] = this._getRowData(m, m + this.post_delim);
			a = true;
			this._in_progress[m] = (new Date()).valueOf()
		}
		return a ? c : null
	},
	setVerificator: function(c, a) {
		this.mandatoryFields[c] = a || (function(g) {
			return (g !== "")
		})
	},
	clearVerificator: function(a) {
		this.mandatoryFields[a] = false
	},
	findRow: function(c) {
		var a = 0;
		for (a = 0; a < this.updatedRows.length; a++) {
			if (c == this.updatedRows[a]) {
				break
			}
		}
		return a
	},
	defineAction: function(a, c) {
		if (!this._uActions) {
			this._uActions = []
		}
		this._uActions[a] = c
	},
	afterUpdateCallback: function(c, o, n, m) {
		var a = c;
		var l = (n != "error" && n != "invalid");
		if (!l) {
			this.set_invalid(c, n)
		}
		if ((this._uActions) && (this._uActions[n]) && (!this._uActions[n](m))) {
			return (delete this._in_progress[a])
		}
		if (this._in_progress[a] != "wait") {
			this.setUpdated(c, false)
		}
		var g = c;
		switch (n) {
			case "inserted":
			case "insert":
				if (o != c) {
					this.obj[this._methods[2]](c, o);
					c = o
				}
				break;
			case "delete":
			case "deleted":
				this.obj.setUserData(c, this.action_param, "true_deleted");
				this.obj[this._methods[3]](c);
				delete this._in_progress[a];
				return this.callEvent("onAfterUpdate", [c, n, o, m]);
				break
		}
		if (this._in_progress[a] != "wait") {
			if (l) {
				this.obj.setUserData(c, this.action_param, "")
			}
			delete this._in_progress[a]
		} else {
			delete this._in_progress[a];
			this.setUpdated(o, true, this.obj.getUserData(c, this.action_param))
		}
		this.callEvent("onAfterUpdate", [g, n, o, m])
	},
	afterUpdate: function(q, o, a) {
		if (window.JSON) {
			try {
				var v = JSON.parse(o.xmlDoc.responseText);
				var l = v.action || this.getState(a) || "updated";
				var c = v.sid || a[0];
				var g = v.tid || a[0];
				q.afterUpdateCallback(c, g, l, v);
				q.finalizeUpdate();
				return
			} catch (r) {}
		}
		var u = dhx4.ajax.xmltop("data", o.xmlDoc);
		if (!u || u.tagName == "DIV") {
			return this.cleanUpdate(a)
		}
		var s = dhx4.ajax.xpath("//data/action", u);
		if (!s.length) {
			return this.cleanUpdate(a)
		}
		for (var n = 0; n < s.length; n++) {
			var m = s[n];
			var l = m.getAttribute("type");
			var c = m.getAttribute("sid");
			var g = m.getAttribute("tid");
			q.afterUpdateCallback(c, g, l, m)
		}
		q.finalizeUpdate()
	},
	cleanUpdate: function(c) {
		if (c) {
			for (var a = 0; a < c.length; a++) {
				delete this._in_progress[c[a]]
			}
		}
	},
	finalizeUpdate: function() {
		if (this._waitMode) {
			this._waitMode--
		}
		if ((this.obj.mytype == "tree" || this.obj._h2) && this.updatedRows.length) {
			this.sendData()
		}
		this.callEvent("onAfterUpdateFinish", []);
		if (!this.updatedRows.length) {
			this.callEvent("onFullSync", [])
		}
	},
	init: function(a) {
		this.obj = a;
		if (this.obj._dp_init) {
			this.obj._dp_init(this)
		}
	},
	setOnAfterUpdate: function(a) {
		this.attachEvent("onAfterUpdate", a)
	},
	enableDebug: function(a) {},
	setOnBeforeUpdateHandler: function(a) {
		this.attachEvent("onBeforeDataSending", a)
	},
	setAutoUpdate: function(g, c) {
		g = g || 2000;
		this._user = c || (new Date()).valueOf();
		this._need_update = false;
		this._loader = null;
		this._update_busy = false;
		this.attachEvent("onAfterUpdate", function(l, n, o, m) {
			this.afterAutoUpdate(l, n, o, m)
		});
		this.attachEvent("onFullSync", function() {
			this.fullSync()
		});
		var a = this;
		window.setInterval(function() {
			a.loadUpdate()
		}, g)
	},
	afterAutoUpdate: function(a, g, l, c) {
		if (g == "collision") {
			this._need_update = true;
			return false
		} else {
			return true
		}
	},
	fullSync: function() {
		if (this._need_update == true) {
			this._need_update = false;
			this.loadUpdate()
		}
		return true
	},
	getUpdates: function(a, c) {
		if (this._update_busy) {
			return false
		} else {
			this._update_busy = true
		}
		this._loader = this._loader || new dtmlXMLLoaderObject(true);
		this._loader.async = true;
		this._loader.waitCall = c;
		this._loader.loadXML(a)
	},
	_v: function(a) {
		if (a.firstChild) {
			return a.firstChild.nodeValue
		}
		return ""
	},
	_a: function(a) {
		var g = [];
		for (var c = 0; c < a.length; c++) {
			g[c] = this._v(a[c])
		}
		return g
	},
	loadUpdate: function() {
		var c = this;
		var a = this.obj.getUserData(0, "version");
		var g = this.serverProcessor + dhtmlx.url(this.serverProcessor) + ["dhx_user=" + this._user, "dhx_version=" + a].join("&");
		g = g.replace("editing=true&", "");
		this.getUpdates(g, function() {
			var n = c._loader.doXPath("//userdata");
			c.obj.setUserData(0, "version", c._v(n[0]));
			var l = c._loader.doXPath("//update");
			if (l.length) {
				c._silent_mode = true;
				for (var o = 0; o < l.length; o++) {
					var m = l[o].getAttribute("status");
					var r = l[o].getAttribute("id");
					var q = l[o].getAttribute("parent");
					switch (m) {
						case "inserted":
							c.callEvent("insertCallback", [l[o], r, q]);
							break;
						case "updated":
							c.callEvent("updateCallback", [l[o], r, q]);
							break;
						case "deleted":
							c.callEvent("deleteCallback", [l[o], r, q]);
							break
					}
				}
				c._silent_mode = false
			}
			c._update_busy = false;
			c = null
		})
	}
};
if (window.dataProcessor && !dataProcessor.prototype.init_original) {
	dataProcessor.prototype.init_original = dataProcessor.prototype.init;
	dataProcessor.prototype.init = function(a) {
		this.init_original(a);
		a._dataprocessor = this;
		this.setTransactionMode("POST", true);
		this.serverProcessor += (this.serverProcessor.indexOf("?") != -1 ? "&" : "?") + "editing=true"
	}
};